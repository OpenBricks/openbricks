#!/bin/sh

. config/options

if [ "$XORG" = yes ]; then
  WITH_X="--with-x \
          --enable-ecore-evas-software-x11 \
          --enable-ecore-evas-software-16-x11 \
          --enable-ecore-evas-xrender-x11 \
          --enable-ecore-evas-opengl-x11"
else
  WITH_X="--disable-ecore-x"
fi

if [ "$TOUCHSCREEN" = yes ]; then
  CFG_TS="--enable-tslib"
else
  CFG_TS="--disable-tslib"
fi

if [ "$DIRECTFB" = yes ]; then
  CFG_DFB="--enable-ecore-directfb --enable-ecore-evas-directfb"
else
  CFG_DFB="--disable-ecore-directfb --disable-ecore-evas-directfb"
fi

if [ "$SDL" = yes ]; then
  CFG_SDL="--with-sdl-config=$SDL_CONFIG --enable-ecore-sdl --enable-ecore-evas-software-sdl --disable-ecore-evas-opengl-sdl"
else
  CFG_SDL="--disable-ecore-sdl --disable-ecore-evas-software-sdl --disable-ecore-evas-opengl-sdl"
fi

EXTRA_OPTS=""
[ "$TARGET_LIBC" = "uClibc" ] && EXTRA_OPTS="--with-iconv-link=\"-liconv\""

cd $BUILD/$1*
do_configure \
            --disable-doc \
            --disable-tests \
            --enable-curl \
            --disable-openssl \
            --enable-gnutls \
            --enable-poll \
            --enable-inotify \
            --enable-ecore-fb \
            --enable-ecore-evas-fb \
            --disable-ecore-x-xcb \
            --disable-ecore-evas-xrender-xcb \
            --disable-ecore-evas-software-gdi \
            --disable-ecore-evas-software-ddraw \
            --disable-ecore-evas-direct3d \
            --disable-ecore-evas-opengl-glew \
            --disable-ecore-evas-software-16-ddraw \
            --disable-ecore-evas-software-16-wince \
            --enable-ecore-evas \
            --enable-ecore-evas-software-buffer \
            --enable-glib \
            $CFG_DFB \
            $CFG_SDL \
            $CFG_TS \
            $WITH_X \
            $EXTRA_OPTS \

make
make_install
