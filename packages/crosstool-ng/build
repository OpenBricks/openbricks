#!/bin/sh

. config/options

cd $BUILD/$1*

do_configure host \
  --prefix=$ROOT/$TOOLCHAIN/ct-ng \

make
make_install

# fix install path
mkdir -p .install/usr/bin
mv .install/$ROOT/$TOOLCHAIN/ct-ng/ .install/usr

# Hack! ct-ng is in fact a Makefile script. As such, it accepts all
# make options, such as -C, which makes it uneeded to chdir prior
# to calling ct-ng.
# (courtesy of Buildroot)
cat > .install/usr/bin/ct-ng <<EOF
#!/bin/sh
$ROOT/$TOOLCHAIN/ct-ng/bin/ct-ng -C $ROOT/$TOOLCHAIN/ct-ng --no-print-directory \$*
EOF
chmod +x .install/usr/bin/ct-ng
