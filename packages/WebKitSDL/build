#!/bin/sh

. config/options

cd $BUILD/$1*

sed -i Source/ThirdParty/skia/Makefile \
  -e "s|^CFLAGS :=\(.*\)$|CFLAGS := $CFLAGS \1|" \
  -e "s|-I/usr/include/freetype2|-I$LIB_PREFIX/include/freetype2|"
(cd Source/ThirdParty/skia; make CC="$CC" GPP="$CXX")

mkdir -p WebKitBuild
cd WebKitBuild
cmake \
  -DCMAKE_FIND_ROOT_PATH=$LIB_PREFIX \
  -DCMAKE_INSTALL_PREFIX=/usr \
  -DPORT=SDL \
  ../Source

make
make_install

mkdir -p .install/usr/bin
cp -P Programs/SDLWebLauncher .install/usr/bin
