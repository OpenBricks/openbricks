#!/bin/sh

. config/options

ENABLED_PLUGINS="cardclient constcw sc-conax sc-cryptoworks sc-irdeto sc-nagra sc-seca sc-viaccess sc-videoguard2"

mkdir -p $INSTALL/usr/lib/vdr
cp -a $BUILD/$1*/lib$1*.so.* $INSTALL/usr/lib/vdr
for plugin in $ENABLED_PLUGINS; do
  cp $BUILD/$1*/systems/$plugin/libsc-*.so.* $INSTALL/usr/lib/vdr
done

for loc in $INCLUDED_LOCALES; do
  LOCALE=`echo $loc|cut -f1 -d.`
  if [ -d $BUILD/$1*/locale/$LOCALE ]; then
    mkdir -p $INSTALL/usr/share/locale/$LOCALE
    cp -a $BUILD/$1*/locale/$LOCALE/* $INSTALL/usr/share/locale/$LOCALE/
  fi
done

mkdir -p $INSTALL/etc/vdr/plugins/$1
touch $INSTALL/etc/vdr/plugins/$1/cardslot.conf
touch $INSTALL/etc/vdr/plugins/$1/smartcard.conf
touch $INSTALL/etc/vdr/plugins/$1/override.conf
touch $INSTALL/etc/vdr/plugins/$1/SoftCam.key
touch $INSTALL/etc/vdr/plugins/$1/cardclient.conf

#NAME=`echo $1 | sed s/vdr-//`
#mkdir -p $INSTALL/etc/vdr/plugins.d
#echo "PLUGIN=${NAME}" > $INSTALL/etc/vdr/plugins.d/50_$NAME
