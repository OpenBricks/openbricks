#!/bin/sh

. config/options

get_meta $1
cd $PKG_BUILD_DIR

rm -rf .build
mkdir -p .build
cd .build

cmake \
  -DCMAKE_SYSTEM_NAME=Linux \
  -DCMAKE_FIND_ROOT_PATH=$LIB_PREFIX \
  -DCMAKE_FIND_ROOT_PATH_MODE_INCLUDE=ONLY \
  -DCMAKE_FIND_ROOT_PATH_MODE_LIBRARY=ONLY \
  -DCMAKE_FIND_ROOT_PATH_MODE_PROGRAM=NEVER \
  -DCMAKE_FIND_NO_INSTALL_PREFIX=1 \
  -DCMAKE_INSTALL_PREFIX=/usr \
  -DBUILD_STATIC_LIBS=1 \
  ..

make glm_static

cd ..

rm -rf .install/usr
mkdir -p .install/usr/include .install/usr/lib

cp -R glm .install/usr/include
cp -R .build/glm/libglm_static.a .install/usr/lib
rm -f .install/usr/include/glm/*.txt
