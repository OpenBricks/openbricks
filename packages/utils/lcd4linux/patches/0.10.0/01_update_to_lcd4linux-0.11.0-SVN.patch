diff -urN lcd4linux-0.10.0/aclocal.m4 lcd4linux-0.11.0-SVN/aclocal.m4
--- lcd4linux-0.10.0/aclocal.m4	2005-06-10 13:21:47.000000000 +0200
+++ lcd4linux-0.11.0-SVN/aclocal.m4	2009-01-13 06:04:32.000000000 +0100
@@ -1,183 +1,332 @@
-dnl aclocal.m4 generated automatically by aclocal 1.4-p6
+# generated automatically by aclocal 1.10.1 -*- Autoconf -*-
 
-dnl Copyright (C) 1994, 1995-8, 1999, 2001 Free Software Foundation, Inc.
-dnl This file is free software; the Free Software Foundation
-dnl gives unlimited permission to copy and/or distribute it,
-dnl with or without modifications, as long as this notice is preserved.
+# Copyright (C) 1996, 1997, 1998, 1999, 2000, 2001, 2002, 2003, 2004,
+# 2005, 2006, 2007, 2008  Free Software Foundation, Inc.
+# This file is free software; the Free Software Foundation
+# gives unlimited permission to copy and/or distribute it,
+# with or without modifications, as long as this notice is preserved.
 
-dnl This program is distributed in the hope that it will be useful,
-dnl but WITHOUT ANY WARRANTY, to the extent permitted by law; without
-dnl even the implied warranty of MERCHANTABILITY or FITNESS FOR A
-dnl PARTICULAR PURPOSE.
+# This program is distributed in the hope that it will be useful,
+# but WITHOUT ANY WARRANTY, to the extent permitted by law; without
+# even the implied warranty of MERCHANTABILITY or FITNESS FOR A
+# PARTICULAR PURPOSE.
+
+m4_ifndef([AC_AUTOCONF_VERSION],
+  [m4_copy([m4_PACKAGE_VERSION], [AC_AUTOCONF_VERSION])])dnl
+m4_if(AC_AUTOCONF_VERSION, [2.61],,
+[m4_warning([this file was generated for autoconf 2.61.
+You have another version of autoconf.  It may work, but is not guaranteed to.
+If you have problems, you may need to regenerate the build system entirely.
+To do so, use the procedure documented by the package, typically `autoreconf'.])])
 
-# lib-prefix.m4 serial 4 (gettext-0.14.2)
-dnl Copyright (C) 2001-2005 Free Software Foundation, Inc.
+# iconv.m4 serial AM6 (gettext-0.17)
+dnl Copyright (C) 2000-2002, 2007 Free Software Foundation, Inc.
 dnl This file is free software; the Free Software Foundation
 dnl gives unlimited permission to copy and/or distribute it,
 dnl with or without modifications, as long as this notice is preserved.
 
 dnl From Bruno Haible.
 
-dnl AC_LIB_ARG_WITH is synonymous to AC_ARG_WITH in autoconf-2.13, and
-dnl similar to AC_ARG_WITH in autoconf 2.52...2.57 except that is doesn't
-dnl require excessive bracketing.
-ifdef([AC_HELP_STRING],
-[AC_DEFUN([AC_LIB_ARG_WITH], [AC_ARG_WITH([$1],[[$2]],[$3],[$4])])],
-[AC_DEFUN([AC_][LIB_ARG_WITH], [AC_ARG_WITH([$1],[$2],[$3],[$4])])])
-
-dnl AC_LIB_PREFIX adds to the CPPFLAGS and LDFLAGS the flags that are needed
-dnl to access previously installed libraries. The basic assumption is that
-dnl a user will want packages to use other packages he previously installed
-dnl with the same --prefix option.
-dnl This macro is not needed if only AC_LIB_LINKFLAGS is used to locate
-dnl libraries, but is otherwise very convenient.
-AC_DEFUN([AC_LIB_PREFIX],
+AC_DEFUN([AM_ICONV_LINKFLAGS_BODY],
 [
-  AC_BEFORE([$0], [AC_LIB_LINKFLAGS])
-  AC_REQUIRE([AC_PROG_CC])
-  AC_REQUIRE([AC_CANONICAL_HOST])
+  dnl Prerequisites of AC_LIB_LINKFLAGS_BODY.
   AC_REQUIRE([AC_LIB_PREPARE_PREFIX])
-  dnl By default, look in $includedir and $libdir.
-  use_additional=yes
-  AC_LIB_WITH_FINAL_PREFIX([
-    eval additional_includedir=\"$includedir\"
-    eval additional_libdir=\"$libdir\"
-  ])
-  AC_LIB_ARG_WITH([lib-prefix],
-[  --with-lib-prefix[=DIR] search for libraries in DIR/include and DIR/lib
-  --without-lib-prefix    don't search for libraries in includedir and libdir],
-[
-    if test "X$withval" = "Xno"; then
-      use_additional=no
-    else
-      if test "X$withval" = "X"; then
-        AC_LIB_WITH_FINAL_PREFIX([
-          eval additional_includedir=\"$includedir\"
-          eval additional_libdir=\"$libdir\"
-        ])
-      else
-        additional_includedir="$withval/include"
-        additional_libdir="$withval/lib"
-      fi
-    fi
-])
-  if test $use_additional = yes; then
-    dnl Potentially add $additional_includedir to $CPPFLAGS.
-    dnl But don't add it
-    dnl   1. if it's the standard /usr/include,
-    dnl   2. if it's already present in $CPPFLAGS,
-    dnl   3. if it's /usr/local/include and we are using GCC on Linux,
-    dnl   4. if it doesn't exist as a directory.
-    if test "X$additional_includedir" != "X/usr/include"; then
-      haveit=
-      for x in $CPPFLAGS; do
-        AC_LIB_WITH_FINAL_PREFIX([eval x=\"$x\"])
-        if test "X$x" = "X-I$additional_includedir"; then
-          haveit=yes
-          break
-        fi
-      done
-      if test -z "$haveit"; then
-        if test "X$additional_includedir" = "X/usr/local/include"; then
-          if test -n "$GCC"; then
-            case $host_os in
-              linux* | gnu* | k*bsd*-gnu) haveit=yes;;
-            esac
-          fi
-        fi
-        if test -z "$haveit"; then
-          if test -d "$additional_includedir"; then
-            dnl Really add $additional_includedir to $CPPFLAGS.
-            CPPFLAGS="${CPPFLAGS}${CPPFLAGS:+ }-I$additional_includedir"
-          fi
-        fi
-      fi
-    fi
-    dnl Potentially add $additional_libdir to $LDFLAGS.
-    dnl But don't add it
-    dnl   1. if it's the standard /usr/lib,
-    dnl   2. if it's already present in $LDFLAGS,
-    dnl   3. if it's /usr/local/lib and we are using GCC on Linux,
-    dnl   4. if it doesn't exist as a directory.
-    if test "X$additional_libdir" != "X/usr/lib"; then
-      haveit=
-      for x in $LDFLAGS; do
-        AC_LIB_WITH_FINAL_PREFIX([eval x=\"$x\"])
-        if test "X$x" = "X-L$additional_libdir"; then
-          haveit=yes
-          break
-        fi
-      done
-      if test -z "$haveit"; then
-        if test "X$additional_libdir" = "X/usr/local/lib"; then
-          if test -n "$GCC"; then
-            case $host_os in
-              linux*) haveit=yes;;
-            esac
-          fi
-        fi
-        if test -z "$haveit"; then
-          if test -d "$additional_libdir"; then
-            dnl Really add $additional_libdir to $LDFLAGS.
-            LDFLAGS="${LDFLAGS}${LDFLAGS:+ }-L$additional_libdir"
-          fi
-        fi
-      fi
-    fi
-  fi
+  AC_REQUIRE([AC_LIB_RPATH])
+
+  dnl Search for libiconv and define LIBICONV, LTLIBICONV and INCICONV
+  dnl accordingly.
+  AC_LIB_LINKFLAGS_BODY([iconv])
 ])
 
-dnl AC_LIB_PREPARE_PREFIX creates variables acl_final_prefix,
-dnl acl_final_exec_prefix, containing the values to which $prefix and
-dnl $exec_prefix will expand at the end of the configure script.
-AC_DEFUN([AC_LIB_PREPARE_PREFIX],
+AC_DEFUN([AM_ICONV_LINK],
 [
-  dnl Unfortunately, prefix and exec_prefix get only finally determined
-  dnl at the end of configure.
-  if test "X$prefix" = "XNONE"; then
-    acl_final_prefix="$ac_default_prefix"
+  dnl Some systems have iconv in libc, some have it in libiconv (OSF/1 and
+  dnl those with the standalone portable GNU libiconv installed).
+  AC_REQUIRE([AC_CANONICAL_HOST]) dnl for cross-compiles
+
+  dnl Search for libiconv and define LIBICONV, LTLIBICONV and INCICONV
+  dnl accordingly.
+  AC_REQUIRE([AM_ICONV_LINKFLAGS_BODY])
+
+  dnl Add $INCICONV to CPPFLAGS before performing the following checks,
+  dnl because if the user has installed libiconv and not disabled its use
+  dnl via --without-libiconv-prefix, he wants to use it. The first
+  dnl AC_TRY_LINK will then fail, the second AC_TRY_LINK will succeed.
+  am_save_CPPFLAGS="$CPPFLAGS"
+  AC_LIB_APPENDTOVAR([CPPFLAGS], [$INCICONV])
+
+  AC_CACHE_CHECK([for iconv], am_cv_func_iconv, [
+    am_cv_func_iconv="no, consider installing GNU libiconv"
+    am_cv_lib_iconv=no
+    AC_TRY_LINK([#include <stdlib.h>
+#include <iconv.h>],
+      [iconv_t cd = iconv_open("","");
+       iconv(cd,NULL,NULL,NULL,NULL);
+       iconv_close(cd);],
+      am_cv_func_iconv=yes)
+    if test "$am_cv_func_iconv" != yes; then
+      am_save_LIBS="$LIBS"
+      LIBS="$LIBS $LIBICONV"
+      AC_TRY_LINK([#include <stdlib.h>
+#include <iconv.h>],
+        [iconv_t cd = iconv_open("","");
+         iconv(cd,NULL,NULL,NULL,NULL);
+         iconv_close(cd);],
+        am_cv_lib_iconv=yes
+        am_cv_func_iconv=yes)
+      LIBS="$am_save_LIBS"
+    fi
+  ])
+  if test "$am_cv_func_iconv" = yes; then
+    AC_CACHE_CHECK([for working iconv], am_cv_func_iconv_works, [
+      dnl This tests against bugs in AIX 5.1 and HP-UX 11.11.
+      am_save_LIBS="$LIBS"
+      if test $am_cv_lib_iconv = yes; then
+        LIBS="$LIBS $LIBICONV"
+      fi
+      AC_TRY_RUN([
+#include <iconv.h>
+#include <string.h>
+int main ()
+{
+  /* Test against AIX 5.1 bug: Failures are not distinguishable from successful
+     returns.  */
+  {
+    iconv_t cd_utf8_to_88591 = iconv_open ("ISO8859-1", "UTF-8");
+    if (cd_utf8_to_88591 != (iconv_t)(-1))
+      {
+        static const char input[] = "\342\202\254"; /* EURO SIGN */
+        char buf[10];
+        const char *inptr = input;
+        size_t inbytesleft = strlen (input);
+        char *outptr = buf;
+        size_t outbytesleft = sizeof (buf);
+        size_t res = iconv (cd_utf8_to_88591,
+                            (char **) &inptr, &inbytesleft,
+                            &outptr, &outbytesleft);
+        if (res == 0)
+          return 1;
+      }
+  }
+#if 0 /* This bug could be worked around by the caller.  */
+  /* Test against HP-UX 11.11 bug: Positive return value instead of 0.  */
+  {
+    iconv_t cd_88591_to_utf8 = iconv_open ("utf8", "iso88591");
+    if (cd_88591_to_utf8 != (iconv_t)(-1))
+      {
+        static const char input[] = "\304rger mit b\366sen B\374bchen ohne Augenma\337";
+        char buf[50];
+        const char *inptr = input;
+        size_t inbytesleft = strlen (input);
+        char *outptr = buf;
+        size_t outbytesleft = sizeof (buf);
+        size_t res = iconv (cd_88591_to_utf8,
+                            (char **) &inptr, &inbytesleft,
+                            &outptr, &outbytesleft);
+        if ((int)res > 0)
+          return 1;
+      }
+  }
+#endif
+  /* Test against HP-UX 11.11 bug: No converter from EUC-JP to UTF-8 is
+     provided.  */
+  if (/* Try standardized names.  */
+      iconv_open ("UTF-8", "EUC-JP") == (iconv_t)(-1)
+      /* Try IRIX, OSF/1 names.  */
+      && iconv_open ("UTF-8", "eucJP") == (iconv_t)(-1)
+      /* Try AIX names.  */
+      && iconv_open ("UTF-8", "IBM-eucJP") == (iconv_t)(-1)
+      /* Try HP-UX names.  */
+      && iconv_open ("utf8", "eucJP") == (iconv_t)(-1))
+    return 1;
+  return 0;
+}], [am_cv_func_iconv_works=yes], [am_cv_func_iconv_works=no],
+        [case "$host_os" in
+           aix* | hpux*) am_cv_func_iconv_works="guessing no" ;;
+           *)            am_cv_func_iconv_works="guessing yes" ;;
+         esac])
+      LIBS="$am_save_LIBS"
+    ])
+    case "$am_cv_func_iconv_works" in
+      *no) am_func_iconv=no am_cv_lib_iconv=no ;;
+      *)   am_func_iconv=yes ;;
+    esac
   else
-    acl_final_prefix="$prefix"
+    am_func_iconv=no am_cv_lib_iconv=no
   fi
-  if test "X$exec_prefix" = "XNONE"; then
-    acl_final_exec_prefix='${prefix}'
+  if test "$am_func_iconv" = yes; then
+    AC_DEFINE(HAVE_ICONV, 1,
+      [Define if you have the iconv() function and it works.])
+  fi
+  if test "$am_cv_lib_iconv" = yes; then
+    AC_MSG_CHECKING([how to link with libiconv])
+    AC_MSG_RESULT([$LIBICONV])
   else
-    acl_final_exec_prefix="$exec_prefix"
+    dnl If $LIBICONV didn't lead to a usable library, we don't need $INCICONV
+    dnl either.
+    CPPFLAGS="$am_save_CPPFLAGS"
+    LIBICONV=
+    LTLIBICONV=
   fi
-  acl_save_prefix="$prefix"
-  prefix="$acl_final_prefix"
-  eval acl_final_exec_prefix=\"$acl_final_exec_prefix\"
-  prefix="$acl_save_prefix"
+  AC_SUBST(LIBICONV)
+  AC_SUBST(LTLIBICONV)
 ])
 
-dnl AC_LIB_WITH_FINAL_PREFIX([statement]) evaluates statement, with the
-dnl variables prefix and exec_prefix bound to the values they will have
-dnl at the end of the configure script.
-AC_DEFUN([AC_LIB_WITH_FINAL_PREFIX],
+AC_DEFUN([AM_ICONV],
 [
-  acl_save_prefix="$prefix"
-  prefix="$acl_final_prefix"
-  acl_save_exec_prefix="$exec_prefix"
-  exec_prefix="$acl_final_exec_prefix"
-  $1
-  exec_prefix="$acl_save_exec_prefix"
-  prefix="$acl_save_prefix"
+  AM_ICONV_LINK
+  if test "$am_cv_func_iconv" = yes; then
+    AC_MSG_CHECKING([for iconv declaration])
+    AC_CACHE_VAL(am_cv_proto_iconv, [
+      AC_TRY_COMPILE([
+#include <stdlib.h>
+#include <iconv.h>
+extern
+#ifdef __cplusplus
+"C"
+#endif
+#if defined(__STDC__) || defined(__cplusplus)
+size_t iconv (iconv_t cd, char * *inbuf, size_t *inbytesleft, char * *outbuf, size_t *outbytesleft);
+#else
+size_t iconv();
+#endif
+], [], am_cv_proto_iconv_arg1="", am_cv_proto_iconv_arg1="const")
+      am_cv_proto_iconv="extern size_t iconv (iconv_t cd, $am_cv_proto_iconv_arg1 char * *inbuf, size_t *inbytesleft, char * *outbuf, size_t *outbytesleft);"])
+    am_cv_proto_iconv=`echo "[$]am_cv_proto_iconv" | tr -s ' ' | sed -e 's/( /(/'`
+    AC_MSG_RESULT([$]{ac_t:-
+         }[$]am_cv_proto_iconv)
+    AC_DEFINE_UNQUOTED(ICONV_CONST, $am_cv_proto_iconv_arg1,
+      [Define as const if the declaration of iconv() needs const.])
+  fi
 ])
 
-# lib-link.m4 serial 6 (gettext-0.14.3)
-dnl Copyright (C) 2001-2005 Free Software Foundation, Inc.
+# lib-ld.m4 serial 3 (gettext-0.13)
+dnl Copyright (C) 1996-2003 Free Software Foundation, Inc.
+dnl This file is free software; the Free Software Foundation
+dnl gives unlimited permission to copy and/or distribute it,
+dnl with or without modifications, as long as this notice is preserved.
+
+dnl Subroutines of libtool.m4,
+dnl with replacements s/AC_/AC_LIB/ and s/lt_cv/acl_cv/ to avoid collision
+dnl with libtool.m4.
+
+dnl From libtool-1.4. Sets the variable with_gnu_ld to yes or no.
+AC_DEFUN([AC_LIB_PROG_LD_GNU],
+[AC_CACHE_CHECK([if the linker ($LD) is GNU ld], acl_cv_prog_gnu_ld,
+[# I'd rather use --version here, but apparently some GNU ld's only accept -v.
+case `$LD -v 2>&1 </dev/null` in
+*GNU* | *'with BFD'*)
+  acl_cv_prog_gnu_ld=yes ;;
+*)
+  acl_cv_prog_gnu_ld=no ;;
+esac])
+with_gnu_ld=$acl_cv_prog_gnu_ld
+])
+
+dnl From libtool-1.4. Sets the variable LD.
+AC_DEFUN([AC_LIB_PROG_LD],
+[AC_ARG_WITH(gnu-ld,
+[  --with-gnu-ld           assume the C compiler uses GNU ld [default=no]],
+test "$withval" = no || with_gnu_ld=yes, with_gnu_ld=no)
+AC_REQUIRE([AC_PROG_CC])dnl
+AC_REQUIRE([AC_CANONICAL_HOST])dnl
+# Prepare PATH_SEPARATOR.
+# The user is always right.
+if test "${PATH_SEPARATOR+set}" != set; then
+  echo "#! /bin/sh" >conf$$.sh
+  echo  "exit 0"   >>conf$$.sh
+  chmod +x conf$$.sh
+  if (PATH="/nonexistent;."; conf$$.sh) >/dev/null 2>&1; then
+    PATH_SEPARATOR=';'
+  else
+    PATH_SEPARATOR=:
+  fi
+  rm -f conf$$.sh
+fi
+ac_prog=ld
+if test "$GCC" = yes; then
+  # Check if gcc -print-prog-name=ld gives a path.
+  AC_MSG_CHECKING([for ld used by GCC])
+  case $host in
+  *-*-mingw*)
+    # gcc leaves a trailing carriage return which upsets mingw
+    ac_prog=`($CC -print-prog-name=ld) 2>&5 | tr -d '\015'` ;;
+  *)
+    ac_prog=`($CC -print-prog-name=ld) 2>&5` ;;
+  esac
+  case $ac_prog in
+    # Accept absolute paths.
+    [[\\/]* | [A-Za-z]:[\\/]*)]
+      [re_direlt='/[^/][^/]*/\.\./']
+      # Canonicalize the path of ld
+      ac_prog=`echo $ac_prog| sed 's%\\\\%/%g'`
+      while echo $ac_prog | grep "$re_direlt" > /dev/null 2>&1; do
+	ac_prog=`echo $ac_prog| sed "s%$re_direlt%/%"`
+      done
+      test -z "$LD" && LD="$ac_prog"
+      ;;
+  "")
+    # If it fails, then pretend we aren't using GCC.
+    ac_prog=ld
+    ;;
+  *)
+    # If it is relative, then search for the first ld in PATH.
+    with_gnu_ld=unknown
+    ;;
+  esac
+elif test "$with_gnu_ld" = yes; then
+  AC_MSG_CHECKING([for GNU ld])
+else
+  AC_MSG_CHECKING([for non-GNU ld])
+fi
+AC_CACHE_VAL(acl_cv_path_LD,
+[if test -z "$LD"; then
+  IFS="${IFS= 	}"; ac_save_ifs="$IFS"; IFS="${IFS}${PATH_SEPARATOR-:}"
+  for ac_dir in $PATH; do
+    test -z "$ac_dir" && ac_dir=.
+    if test -f "$ac_dir/$ac_prog" || test -f "$ac_dir/$ac_prog$ac_exeext"; then
+      acl_cv_path_LD="$ac_dir/$ac_prog"
+      # Check to see if the program is GNU ld.  I'd rather use --version,
+      # but apparently some GNU ld's only accept -v.
+      # Break only if it was the GNU/non-GNU ld that we prefer.
+      case `"$acl_cv_path_LD" -v 2>&1 < /dev/null` in
+      *GNU* | *'with BFD'*)
+	test "$with_gnu_ld" != no && break ;;
+      *)
+	test "$with_gnu_ld" != yes && break ;;
+      esac
+    fi
+  done
+  IFS="$ac_save_ifs"
+else
+  acl_cv_path_LD="$LD" # Let the user override the test with a path.
+fi])
+LD="$acl_cv_path_LD"
+if test -n "$LD"; then
+  AC_MSG_RESULT($LD)
+else
+  AC_MSG_RESULT(no)
+fi
+test -z "$LD" && AC_MSG_ERROR([no acceptable ld found in \$PATH])
+AC_LIB_PROG_LD_GNU
+])
+
+# lib-link.m4 serial 13 (gettext-0.17)
+dnl Copyright (C) 2001-2007 Free Software Foundation, Inc.
 dnl This file is free software; the Free Software Foundation
 dnl gives unlimited permission to copy and/or distribute it,
 dnl with or without modifications, as long as this notice is preserved.
 
 dnl From Bruno Haible.
 
-AC_PREREQ(2.50)
+AC_PREREQ(2.54)
 
 dnl AC_LIB_LINKFLAGS(name [, dependencies]) searches for libname and
 dnl the libraries corresponding to explicit and implicit dependencies.
 dnl Sets and AC_SUBSTs the LIB${NAME} and LTLIB${NAME} variables and
 dnl augments the CPPFLAGS variable.
+dnl Sets and AC_SUBSTs the LIB${NAME}_PREFIX variable to nonempty if libname
+dnl was found in ${LIB${NAME}_PREFIX}/$acl_libdirstem.
 AC_DEFUN([AC_LIB_LINKFLAGS],
 [
   AC_REQUIRE([AC_LIB_PREPARE_PREFIX])
@@ -190,13 +339,16 @@
     ac_cv_lib[]Name[]_libs="$LIB[]NAME"
     ac_cv_lib[]Name[]_ltlibs="$LTLIB[]NAME"
     ac_cv_lib[]Name[]_cppflags="$INC[]NAME"
+    ac_cv_lib[]Name[]_prefix="$LIB[]NAME[]_PREFIX"
   ])
   LIB[]NAME="$ac_cv_lib[]Name[]_libs"
   LTLIB[]NAME="$ac_cv_lib[]Name[]_ltlibs"
   INC[]NAME="$ac_cv_lib[]Name[]_cppflags"
+  LIB[]NAME[]_PREFIX="$ac_cv_lib[]Name[]_prefix"
   AC_LIB_APPENDTOVAR([CPPFLAGS], [$INC]NAME)
   AC_SUBST([LIB]NAME)
   AC_SUBST([LTLIB]NAME)
+  AC_SUBST([LIB]NAME[_PREFIX])
   dnl Also set HAVE_LIB[]NAME so that AC_LIB_HAVE_LINKFLAGS can reuse the
   dnl results of this search when this library appears as a dependency.
   HAVE_LIB[]NAME=yes
@@ -212,6 +364,8 @@
 dnl LTLIB${NAME} variables and augments the CPPFLAGS variable, and
 dnl #defines HAVE_LIB${NAME} to 1. Otherwise, it sets and AC_SUBSTs
 dnl HAVE_LIB${NAME}=no and LIB${NAME} and LTLIB${NAME} to empty.
+dnl Sets and AC_SUBSTs the LIB${NAME}_PREFIX variable to nonempty if libname
+dnl was found in ${LIB${NAME}_PREFIX}/$acl_libdirstem.
 AC_DEFUN([AC_LIB_HAVE_LINKFLAGS],
 [
   AC_REQUIRE([AC_LIB_PREPARE_PREFIX])
@@ -248,17 +402,23 @@
     CPPFLAGS="$ac_save_CPPFLAGS"
     LIB[]NAME=
     LTLIB[]NAME=
+    LIB[]NAME[]_PREFIX=
   fi
   AC_SUBST([HAVE_LIB]NAME)
   AC_SUBST([LIB]NAME)
   AC_SUBST([LTLIB]NAME)
+  AC_SUBST([LIB]NAME[_PREFIX])
   undefine([Name])
   undefine([NAME])
 ])
 
 dnl Determine the platform dependent parameters needed to use rpath:
-dnl libext, shlibext, hardcode_libdir_flag_spec, hardcode_libdir_separator,
-dnl hardcode_direct, hardcode_minus_L.
+dnl   acl_libext,
+dnl   acl_shlibext,
+dnl   acl_hardcode_libdir_flag_spec,
+dnl   acl_hardcode_libdir_separator,
+dnl   acl_hardcode_direct,
+dnl   acl_hardcode_minus_L.
 AC_DEFUN([AC_LIB_RPATH],
 [
   dnl Tell automake >= 1.10 to complain if config.rpath is missing.
@@ -275,12 +435,14 @@
     acl_cv_rpath=done
   ])
   wl="$acl_cv_wl"
-  libext="$acl_cv_libext"
-  shlibext="$acl_cv_shlibext"
-  hardcode_libdir_flag_spec="$acl_cv_hardcode_libdir_flag_spec"
-  hardcode_libdir_separator="$acl_cv_hardcode_libdir_separator"
-  hardcode_direct="$acl_cv_hardcode_direct"
-  hardcode_minus_L="$acl_cv_hardcode_minus_L"
+  acl_libext="$acl_cv_libext"
+  acl_shlibext="$acl_cv_shlibext"
+  acl_libname_spec="$acl_cv_libname_spec"
+  acl_library_names_spec="$acl_cv_library_names_spec"
+  acl_hardcode_libdir_flag_spec="$acl_cv_hardcode_libdir_flag_spec"
+  acl_hardcode_libdir_separator="$acl_cv_hardcode_libdir_separator"
+  acl_hardcode_direct="$acl_cv_hardcode_direct"
+  acl_hardcode_minus_L="$acl_cv_hardcode_minus_L"
   dnl Determine whether the user wants rpath handling at all.
   AC_ARG_ENABLE(rpath,
     [  --disable-rpath         do not hardcode runtime library paths],
@@ -290,19 +452,24 @@
 dnl AC_LIB_LINKFLAGS_BODY(name [, dependencies]) searches for libname and
 dnl the libraries corresponding to explicit and implicit dependencies.
 dnl Sets the LIB${NAME}, LTLIB${NAME} and INC${NAME} variables.
+dnl Also, sets the LIB${NAME}_PREFIX variable to nonempty if libname was found
+dnl in ${LIB${NAME}_PREFIX}/$acl_libdirstem.
 AC_DEFUN([AC_LIB_LINKFLAGS_BODY],
 [
+  AC_REQUIRE([AC_LIB_PREPARE_MULTILIB])
   define([NAME],[translit([$1],[abcdefghijklmnopqrstuvwxyz./-],
                                [ABCDEFGHIJKLMNOPQRSTUVWXYZ___])])
+  dnl Autoconf >= 2.61 supports dots in --with options.
+  define([N_A_M_E],[m4_if(m4_version_compare(m4_defn([m4_PACKAGE_VERSION]),[2.61]),[-1],[translit([$1],[.],[_])],[$1])])
   dnl By default, look in $includedir and $libdir.
   use_additional=yes
   AC_LIB_WITH_FINAL_PREFIX([
     eval additional_includedir=\"$includedir\"
     eval additional_libdir=\"$libdir\"
   ])
-  AC_LIB_ARG_WITH([lib$1-prefix],
-[  --with-lib$1-prefix[=DIR]  search for lib$1 in DIR/include and DIR/lib
-  --without-lib$1-prefix     don't search for lib$1 in includedir and libdir],
+  AC_LIB_ARG_WITH([lib]N_A_M_E[-prefix],
+[  --with-lib]N_A_M_E[-prefix[=DIR]  search for lib$1 in DIR/include and DIR/lib
+  --without-lib]N_A_M_E[-prefix     don't search for lib$1 in includedir and libdir],
 [
     if test "X$withval" = "Xno"; then
       use_additional=no
@@ -314,7 +481,7 @@
         ])
       else
         additional_includedir="$withval/include"
-        additional_libdir="$withval/lib"
+        additional_libdir="$withval/$acl_libdirstem"
       fi
     fi
 ])
@@ -323,6 +490,7 @@
   LIB[]NAME=
   LTLIB[]NAME=
   INC[]NAME=
+  LIB[]NAME[]_PREFIX=
   rpathdirs=
   ltrpathdirs=
   names_already_handled=
@@ -362,22 +530,55 @@
           found_la=
           found_so=
           found_a=
+          eval libname=\"$acl_libname_spec\"    # typically: libname=lib$name
+          if test -n "$acl_shlibext"; then
+            shrext=".$acl_shlibext"             # typically: shrext=.so
+          else
+            shrext=
+          fi
           if test $use_additional = yes; then
-            if test -n "$shlibext" && test -f "$additional_libdir/lib$name.$shlibext"; then
-              found_dir="$additional_libdir"
-              found_so="$additional_libdir/lib$name.$shlibext"
-              if test -f "$additional_libdir/lib$name.la"; then
-                found_la="$additional_libdir/lib$name.la"
-              fi
-            else
-              if test -f "$additional_libdir/lib$name.$libext"; then
-                found_dir="$additional_libdir"
-                found_a="$additional_libdir/lib$name.$libext"
-                if test -f "$additional_libdir/lib$name.la"; then
-                  found_la="$additional_libdir/lib$name.la"
+            dir="$additional_libdir"
+            dnl The same code as in the loop below:
+            dnl First look for a shared library.
+            if test -n "$acl_shlibext"; then
+              if test -f "$dir/$libname$shrext"; then
+                found_dir="$dir"
+                found_so="$dir/$libname$shrext"
+              else
+                if test "$acl_library_names_spec" = '$libname$shrext$versuffix'; then
+                  ver=`(cd "$dir" && \
+                        for f in "$libname$shrext".*; do echo "$f"; done \
+                        | sed -e "s,^$libname$shrext\\\\.,," \
+                        | sort -t '.' -n -r -k1,1 -k2,2 -k3,3 -k4,4 -k5,5 \
+                        | sed 1q ) 2>/dev/null`
+                  if test -n "$ver" && test -f "$dir/$libname$shrext.$ver"; then
+                    found_dir="$dir"
+                    found_so="$dir/$libname$shrext.$ver"
+                  fi
+                else
+                  eval library_names=\"$acl_library_names_spec\"
+                  for f in $library_names; do
+                    if test -f "$dir/$f"; then
+                      found_dir="$dir"
+                      found_so="$dir/$f"
+                      break
+                    fi
+                  done
                 fi
               fi
             fi
+            dnl Then look for a static library.
+            if test "X$found_dir" = "X"; then
+              if test -f "$dir/$libname.$acl_libext"; then
+                found_dir="$dir"
+                found_a="$dir/$libname.$acl_libext"
+              fi
+            fi
+            if test "X$found_dir" != "X"; then
+              if test -f "$dir/$libname.la"; then
+                found_la="$dir/$libname.la"
+              fi
+            fi
           fi
           if test "X$found_dir" = "X"; then
             for x in $LDFLAGS $LTLIB[]NAME; do
@@ -385,21 +586,46 @@
               case "$x" in
                 -L*)
                   dir=`echo "X$x" | sed -e 's/^X-L//'`
-                  if test -n "$shlibext" && test -f "$dir/lib$name.$shlibext"; then
-                    found_dir="$dir"
-                    found_so="$dir/lib$name.$shlibext"
-                    if test -f "$dir/lib$name.la"; then
-                      found_la="$dir/lib$name.la"
-                    fi
-                  else
-                    if test -f "$dir/lib$name.$libext"; then
+                  dnl First look for a shared library.
+                  if test -n "$acl_shlibext"; then
+                    if test -f "$dir/$libname$shrext"; then
                       found_dir="$dir"
-                      found_a="$dir/lib$name.$libext"
-                      if test -f "$dir/lib$name.la"; then
-                        found_la="$dir/lib$name.la"
+                      found_so="$dir/$libname$shrext"
+                    else
+                      if test "$acl_library_names_spec" = '$libname$shrext$versuffix'; then
+                        ver=`(cd "$dir" && \
+                              for f in "$libname$shrext".*; do echo "$f"; done \
+                              | sed -e "s,^$libname$shrext\\\\.,," \
+                              | sort -t '.' -n -r -k1,1 -k2,2 -k3,3 -k4,4 -k5,5 \
+                              | sed 1q ) 2>/dev/null`
+                        if test -n "$ver" && test -f "$dir/$libname$shrext.$ver"; then
+                          found_dir="$dir"
+                          found_so="$dir/$libname$shrext.$ver"
+                        fi
+                      else
+                        eval library_names=\"$acl_library_names_spec\"
+                        for f in $library_names; do
+                          if test -f "$dir/$f"; then
+                            found_dir="$dir"
+                            found_so="$dir/$f"
+                            break
+                          fi
+                        done
                       fi
                     fi
                   fi
+                  dnl Then look for a static library.
+                  if test "X$found_dir" = "X"; then
+                    if test -f "$dir/$libname.$acl_libext"; then
+                      found_dir="$dir"
+                      found_a="$dir/$libname.$acl_libext"
+                    fi
+                  fi
+                  if test "X$found_dir" != "X"; then
+                    if test -f "$dir/$libname.la"; then
+                      found_la="$dir/$libname.la"
+                    fi
+                  fi
                   ;;
               esac
               if test "X$found_dir" != "X"; then
@@ -414,7 +640,7 @@
               dnl Linking with a shared library. We attempt to hardcode its
               dnl directory into the executable's runpath, unless it's the
               dnl standard /usr/lib.
-              if test "$enable_rpath" = no || test "X$found_dir" = "X/usr/lib"; then
+              if test "$enable_rpath" = no || test "X$found_dir" = "X/usr/$acl_libdirstem"; then
                 dnl No hardcoding is needed.
                 LIB[]NAME="${LIB[]NAME}${LIB[]NAME:+ }$found_so"
               else
@@ -433,12 +659,12 @@
                   ltrpathdirs="$ltrpathdirs $found_dir"
                 fi
                 dnl The hardcoding into $LIBNAME is system dependent.
-                if test "$hardcode_direct" = yes; then
+                if test "$acl_hardcode_direct" = yes; then
                   dnl Using DIR/libNAME.so during linking hardcodes DIR into the
                   dnl resulting binary.
                   LIB[]NAME="${LIB[]NAME}${LIB[]NAME:+ }$found_so"
                 else
-                  if test -n "$hardcode_libdir_flag_spec" && test "$hardcode_minus_L" = no; then
+                  if test -n "$acl_hardcode_libdir_flag_spec" && test "$acl_hardcode_minus_L" = no; then
                     dnl Use an explicit option to hardcode DIR into the resulting
                     dnl binary.
                     LIB[]NAME="${LIB[]NAME}${LIB[]NAME:+ }$found_so"
@@ -469,13 +695,13 @@
                     if test -z "$haveit"; then
                       LIB[]NAME="${LIB[]NAME}${LIB[]NAME:+ }-L$found_dir"
                     fi
-                    if test "$hardcode_minus_L" != no; then
+                    if test "$acl_hardcode_minus_L" != no; then
                       dnl FIXME: Not sure whether we should use
                       dnl "-L$found_dir -l$name" or "-L$found_dir $found_so"
                       dnl here.
                       LIB[]NAME="${LIB[]NAME}${LIB[]NAME:+ }$found_so"
                     else
-                      dnl We cannot use $hardcode_runpath_var and LD_RUN_PATH
+                      dnl We cannot use $acl_hardcode_runpath_var and LD_RUN_PATH
                       dnl here, because this doesn't fit in flags passed to the
                       dnl compiler. So give up. No hardcoding. This affects only
                       dnl very old systems.
@@ -500,8 +726,9 @@
             dnl Assume the include files are nearby.
             additional_includedir=
             case "$found_dir" in
-              */lib | */lib/)
-                basedir=`echo "X$found_dir" | sed -e 's,^X,,' -e 's,/lib/*$,,'`
+              */$acl_libdirstem | */$acl_libdirstem/)
+                basedir=`echo "X$found_dir" | sed -e 's,^X,,' -e "s,/$acl_libdirstem/"'*$,,'`
+                LIB[]NAME[]_PREFIX="$basedir"
                 additional_includedir="$basedir/include"
                 ;;
             esac
@@ -562,9 +789,9 @@
                     dnl   3. if it's already present in $LDFLAGS or the already
                     dnl      constructed $LIBNAME,
                     dnl   4. if it doesn't exist as a directory.
-                    if test "X$additional_libdir" != "X/usr/lib"; then
+                    if test "X$additional_libdir" != "X/usr/$acl_libdirstem"; then
                       haveit=
-                      if test "X$additional_libdir" = "X/usr/local/lib"; then
+                      if test "X$additional_libdir" = "X/usr/local/$acl_libdirstem"; then
                         if test -n "$GCC"; then
                           case $host_os in
                             linux* | gnu* | k*bsd*-gnu) haveit=yes;;
@@ -663,18 +890,18 @@
     done
   done
   if test "X$rpathdirs" != "X"; then
-    if test -n "$hardcode_libdir_separator"; then
+    if test -n "$acl_hardcode_libdir_separator"; then
       dnl Weird platform: only the last -rpath option counts, the user must
       dnl pass all path elements in one option. We can arrange that for a
       dnl single library, but not when more than one $LIBNAMEs are used.
       alldirs=
       for found_dir in $rpathdirs; do
-        alldirs="${alldirs}${alldirs:+$hardcode_libdir_separator}$found_dir"
+        alldirs="${alldirs}${alldirs:+$acl_hardcode_libdir_separator}$found_dir"
       done
-      dnl Note: hardcode_libdir_flag_spec uses $libdir and $wl.
+      dnl Note: acl_hardcode_libdir_flag_spec uses $libdir and $wl.
       acl_save_libdir="$libdir"
       libdir="$alldirs"
-      eval flag=\"$hardcode_libdir_flag_spec\"
+      eval flag=\"$acl_hardcode_libdir_flag_spec\"
       libdir="$acl_save_libdir"
       LIB[]NAME="${LIB[]NAME}${LIB[]NAME:+ }$flag"
     else
@@ -682,238 +909,1035 @@
       for found_dir in $rpathdirs; do
         acl_save_libdir="$libdir"
         libdir="$found_dir"
-        eval flag=\"$hardcode_libdir_flag_spec\"
+        eval flag=\"$acl_hardcode_libdir_flag_spec\"
         libdir="$acl_save_libdir"
         LIB[]NAME="${LIB[]NAME}${LIB[]NAME:+ }$flag"
       done
     fi
   fi
-  if test "X$ltrpathdirs" != "X"; then
-    dnl When using libtool, the option that works for both libraries and
-    dnl executables is -R. The -R options are cumulative.
-    for found_dir in $ltrpathdirs; do
-      LTLIB[]NAME="${LTLIB[]NAME}${LTLIB[]NAME:+ }-R$found_dir"
+  if test "X$ltrpathdirs" != "X"; then
+    dnl When using libtool, the option that works for both libraries and
+    dnl executables is -R. The -R options are cumulative.
+    for found_dir in $ltrpathdirs; do
+      LTLIB[]NAME="${LTLIB[]NAME}${LTLIB[]NAME:+ }-R$found_dir"
+    done
+  fi
+])
+
+dnl AC_LIB_APPENDTOVAR(VAR, CONTENTS) appends the elements of CONTENTS to VAR,
+dnl unless already present in VAR.
+dnl Works only for CPPFLAGS, not for LIB* variables because that sometimes
+dnl contains two or three consecutive elements that belong together.
+AC_DEFUN([AC_LIB_APPENDTOVAR],
+[
+  for element in [$2]; do
+    haveit=
+    for x in $[$1]; do
+      AC_LIB_WITH_FINAL_PREFIX([eval x=\"$x\"])
+      if test "X$x" = "X$element"; then
+        haveit=yes
+        break
+      fi
+    done
+    if test -z "$haveit"; then
+      [$1]="${[$1]}${[$1]:+ }$element"
+    fi
+  done
+])
+
+dnl For those cases where a variable contains several -L and -l options
+dnl referring to unknown libraries and directories, this macro determines the
+dnl necessary additional linker options for the runtime path.
+dnl AC_LIB_LINKFLAGS_FROM_LIBS([LDADDVAR], [LIBSVALUE], [USE-LIBTOOL])
+dnl sets LDADDVAR to linker options needed together with LIBSVALUE.
+dnl If USE-LIBTOOL evaluates to non-empty, linking with libtool is assumed,
+dnl otherwise linking without libtool is assumed.
+AC_DEFUN([AC_LIB_LINKFLAGS_FROM_LIBS],
+[
+  AC_REQUIRE([AC_LIB_RPATH])
+  AC_REQUIRE([AC_LIB_PREPARE_MULTILIB])
+  $1=
+  if test "$enable_rpath" != no; then
+    if test -n "$acl_hardcode_libdir_flag_spec" && test "$acl_hardcode_minus_L" = no; then
+      dnl Use an explicit option to hardcode directories into the resulting
+      dnl binary.
+      rpathdirs=
+      next=
+      for opt in $2; do
+        if test -n "$next"; then
+          dir="$next"
+          dnl No need to hardcode the standard /usr/lib.
+          if test "X$dir" != "X/usr/$acl_libdirstem"; then
+            rpathdirs="$rpathdirs $dir"
+          fi
+          next=
+        else
+          case $opt in
+            -L) next=yes ;;
+            -L*) dir=`echo "X$opt" | sed -e 's,^X-L,,'`
+                 dnl No need to hardcode the standard /usr/lib.
+                 if test "X$dir" != "X/usr/$acl_libdirstem"; then
+                   rpathdirs="$rpathdirs $dir"
+                 fi
+                 next= ;;
+            *) next= ;;
+          esac
+        fi
+      done
+      if test "X$rpathdirs" != "X"; then
+        if test -n ""$3""; then
+          dnl libtool is used for linking. Use -R options.
+          for dir in $rpathdirs; do
+            $1="${$1}${$1:+ }-R$dir"
+          done
+        else
+          dnl The linker is used for linking directly.
+          if test -n "$acl_hardcode_libdir_separator"; then
+            dnl Weird platform: only the last -rpath option counts, the user
+            dnl must pass all path elements in one option.
+            alldirs=
+            for dir in $rpathdirs; do
+              alldirs="${alldirs}${alldirs:+$acl_hardcode_libdir_separator}$dir"
+            done
+            acl_save_libdir="$libdir"
+            libdir="$alldirs"
+            eval flag=\"$acl_hardcode_libdir_flag_spec\"
+            libdir="$acl_save_libdir"
+            $1="$flag"
+          else
+            dnl The -rpath options are cumulative.
+            for dir in $rpathdirs; do
+              acl_save_libdir="$libdir"
+              libdir="$dir"
+              eval flag=\"$acl_hardcode_libdir_flag_spec\"
+              libdir="$acl_save_libdir"
+              $1="${$1}${$1:+ }$flag"
+            done
+          fi
+        fi
+      fi
+    fi
+  fi
+  AC_SUBST([$1])
+])
+
+# lib-prefix.m4 serial 5 (gettext-0.15)
+dnl Copyright (C) 2001-2005 Free Software Foundation, Inc.
+dnl This file is free software; the Free Software Foundation
+dnl gives unlimited permission to copy and/or distribute it,
+dnl with or without modifications, as long as this notice is preserved.
+
+dnl From Bruno Haible.
+
+dnl AC_LIB_ARG_WITH is synonymous to AC_ARG_WITH in autoconf-2.13, and
+dnl similar to AC_ARG_WITH in autoconf 2.52...2.57 except that is doesn't
+dnl require excessive bracketing.
+ifdef([AC_HELP_STRING],
+[AC_DEFUN([AC_LIB_ARG_WITH], [AC_ARG_WITH([$1],[[$2]],[$3],[$4])])],
+[AC_DEFUN([AC_][LIB_ARG_WITH], [AC_ARG_WITH([$1],[$2],[$3],[$4])])])
+
+dnl AC_LIB_PREFIX adds to the CPPFLAGS and LDFLAGS the flags that are needed
+dnl to access previously installed libraries. The basic assumption is that
+dnl a user will want packages to use other packages he previously installed
+dnl with the same --prefix option.
+dnl This macro is not needed if only AC_LIB_LINKFLAGS is used to locate
+dnl libraries, but is otherwise very convenient.
+AC_DEFUN([AC_LIB_PREFIX],
+[
+  AC_BEFORE([$0], [AC_LIB_LINKFLAGS])
+  AC_REQUIRE([AC_PROG_CC])
+  AC_REQUIRE([AC_CANONICAL_HOST])
+  AC_REQUIRE([AC_LIB_PREPARE_MULTILIB])
+  AC_REQUIRE([AC_LIB_PREPARE_PREFIX])
+  dnl By default, look in $includedir and $libdir.
+  use_additional=yes
+  AC_LIB_WITH_FINAL_PREFIX([
+    eval additional_includedir=\"$includedir\"
+    eval additional_libdir=\"$libdir\"
+  ])
+  AC_LIB_ARG_WITH([lib-prefix],
+[  --with-lib-prefix[=DIR] search for libraries in DIR/include and DIR/lib
+  --without-lib-prefix    don't search for libraries in includedir and libdir],
+[
+    if test "X$withval" = "Xno"; then
+      use_additional=no
+    else
+      if test "X$withval" = "X"; then
+        AC_LIB_WITH_FINAL_PREFIX([
+          eval additional_includedir=\"$includedir\"
+          eval additional_libdir=\"$libdir\"
+        ])
+      else
+        additional_includedir="$withval/include"
+        additional_libdir="$withval/$acl_libdirstem"
+      fi
+    fi
+])
+  if test $use_additional = yes; then
+    dnl Potentially add $additional_includedir to $CPPFLAGS.
+    dnl But don't add it
+    dnl   1. if it's the standard /usr/include,
+    dnl   2. if it's already present in $CPPFLAGS,
+    dnl   3. if it's /usr/local/include and we are using GCC on Linux,
+    dnl   4. if it doesn't exist as a directory.
+    if test "X$additional_includedir" != "X/usr/include"; then
+      haveit=
+      for x in $CPPFLAGS; do
+        AC_LIB_WITH_FINAL_PREFIX([eval x=\"$x\"])
+        if test "X$x" = "X-I$additional_includedir"; then
+          haveit=yes
+          break
+        fi
+      done
+      if test -z "$haveit"; then
+        if test "X$additional_includedir" = "X/usr/local/include"; then
+          if test -n "$GCC"; then
+            case $host_os in
+              linux* | gnu* | k*bsd*-gnu) haveit=yes;;
+            esac
+          fi
+        fi
+        if test -z "$haveit"; then
+          if test -d "$additional_includedir"; then
+            dnl Really add $additional_includedir to $CPPFLAGS.
+            CPPFLAGS="${CPPFLAGS}${CPPFLAGS:+ }-I$additional_includedir"
+          fi
+        fi
+      fi
+    fi
+    dnl Potentially add $additional_libdir to $LDFLAGS.
+    dnl But don't add it
+    dnl   1. if it's the standard /usr/lib,
+    dnl   2. if it's already present in $LDFLAGS,
+    dnl   3. if it's /usr/local/lib and we are using GCC on Linux,
+    dnl   4. if it doesn't exist as a directory.
+    if test "X$additional_libdir" != "X/usr/$acl_libdirstem"; then
+      haveit=
+      for x in $LDFLAGS; do
+        AC_LIB_WITH_FINAL_PREFIX([eval x=\"$x\"])
+        if test "X$x" = "X-L$additional_libdir"; then
+          haveit=yes
+          break
+        fi
+      done
+      if test -z "$haveit"; then
+        if test "X$additional_libdir" = "X/usr/local/$acl_libdirstem"; then
+          if test -n "$GCC"; then
+            case $host_os in
+              linux*) haveit=yes;;
+            esac
+          fi
+        fi
+        if test -z "$haveit"; then
+          if test -d "$additional_libdir"; then
+            dnl Really add $additional_libdir to $LDFLAGS.
+            LDFLAGS="${LDFLAGS}${LDFLAGS:+ }-L$additional_libdir"
+          fi
+        fi
+      fi
+    fi
+  fi
+])
+
+dnl AC_LIB_PREPARE_PREFIX creates variables acl_final_prefix,
+dnl acl_final_exec_prefix, containing the values to which $prefix and
+dnl $exec_prefix will expand at the end of the configure script.
+AC_DEFUN([AC_LIB_PREPARE_PREFIX],
+[
+  dnl Unfortunately, prefix and exec_prefix get only finally determined
+  dnl at the end of configure.
+  if test "X$prefix" = "XNONE"; then
+    acl_final_prefix="$ac_default_prefix"
+  else
+    acl_final_prefix="$prefix"
+  fi
+  if test "X$exec_prefix" = "XNONE"; then
+    acl_final_exec_prefix='${prefix}'
+  else
+    acl_final_exec_prefix="$exec_prefix"
+  fi
+  acl_save_prefix="$prefix"
+  prefix="$acl_final_prefix"
+  eval acl_final_exec_prefix=\"$acl_final_exec_prefix\"
+  prefix="$acl_save_prefix"
+])
+
+dnl AC_LIB_WITH_FINAL_PREFIX([statement]) evaluates statement, with the
+dnl variables prefix and exec_prefix bound to the values they will have
+dnl at the end of the configure script.
+AC_DEFUN([AC_LIB_WITH_FINAL_PREFIX],
+[
+  acl_save_prefix="$prefix"
+  prefix="$acl_final_prefix"
+  acl_save_exec_prefix="$exec_prefix"
+  exec_prefix="$acl_final_exec_prefix"
+  $1
+  exec_prefix="$acl_save_exec_prefix"
+  prefix="$acl_save_prefix"
+])
+
+dnl AC_LIB_PREPARE_MULTILIB creates a variable acl_libdirstem, containing
+dnl the basename of the libdir, either "lib" or "lib64".
+AC_DEFUN([AC_LIB_PREPARE_MULTILIB],
+[
+  dnl There is no formal standard regarding lib and lib64. The current
+  dnl practice is that on a system supporting 32-bit and 64-bit instruction
+  dnl sets or ABIs, 64-bit libraries go under $prefix/lib64 and 32-bit
+  dnl libraries go under $prefix/lib. We determine the compiler's default
+  dnl mode by looking at the compiler's library search path. If at least
+  dnl of its elements ends in /lib64 or points to a directory whose absolute
+  dnl pathname ends in /lib64, we assume a 64-bit ABI. Otherwise we use the
+  dnl default, namely "lib".
+  acl_libdirstem=lib
+  searchpath=`(LC_ALL=C $CC -print-search-dirs) 2>/dev/null | sed -n -e 's,^libraries: ,,p' | sed -e 's,^=,,'`
+  if test -n "$searchpath"; then
+    acl_save_IFS="${IFS= 	}"; IFS=":"
+    for searchdir in $searchpath; do
+      if test -d "$searchdir"; then
+        case "$searchdir" in
+          */lib64/ | */lib64 ) acl_libdirstem=lib64 ;;
+          *) searchdir=`cd "$searchdir" && pwd`
+             case "$searchdir" in
+               */lib64 ) acl_libdirstem=lib64 ;;
+             esac ;;
+        esac
+      fi
+    done
+    IFS="$acl_save_IFS"
+  fi
+])
+
+# Copyright (C) 2002, 2003, 2005, 2006, 2007  Free Software Foundation, Inc.
+#
+# This file is free software; the Free Software Foundation
+# gives unlimited permission to copy and/or distribute it,
+# with or without modifications, as long as this notice is preserved.
+
+# AM_AUTOMAKE_VERSION(VERSION)
+# ----------------------------
+# Automake X.Y traces this macro to ensure aclocal.m4 has been
+# generated from the m4 files accompanying Automake X.Y.
+# (This private macro should not be called outside this file.)
+AC_DEFUN([AM_AUTOMAKE_VERSION],
+[am__api_version='1.10'
+dnl Some users find AM_AUTOMAKE_VERSION and mistake it for a way to
+dnl require some minimum version.  Point them to the right macro.
+m4_if([$1], [1.10.1], [],
+      [AC_FATAL([Do not call $0, use AM_INIT_AUTOMAKE([$1]).])])dnl
+])
+
+# _AM_AUTOCONF_VERSION(VERSION)
+# -----------------------------
+# aclocal traces this macro to find the Autoconf version.
+# This is a private macro too.  Using m4_define simplifies
+# the logic in aclocal, which can simply ignore this definition.
+m4_define([_AM_AUTOCONF_VERSION], [])
+
+# AM_SET_CURRENT_AUTOMAKE_VERSION
+# -------------------------------
+# Call AM_AUTOMAKE_VERSION and AM_AUTOMAKE_VERSION so they can be traced.
+# This function is AC_REQUIREd by AC_INIT_AUTOMAKE.
+AC_DEFUN([AM_SET_CURRENT_AUTOMAKE_VERSION],
+[AM_AUTOMAKE_VERSION([1.10.1])dnl
+m4_ifndef([AC_AUTOCONF_VERSION],
+  [m4_copy([m4_PACKAGE_VERSION], [AC_AUTOCONF_VERSION])])dnl
+_AM_AUTOCONF_VERSION(AC_AUTOCONF_VERSION)])
+
+# AM_AUX_DIR_EXPAND                                         -*- Autoconf -*-
+
+# Copyright (C) 2001, 2003, 2005  Free Software Foundation, Inc.
+#
+# This file is free software; the Free Software Foundation
+# gives unlimited permission to copy and/or distribute it,
+# with or without modifications, as long as this notice is preserved.
+
+# For projects using AC_CONFIG_AUX_DIR([foo]), Autoconf sets
+# $ac_aux_dir to `$srcdir/foo'.  In other projects, it is set to
+# `$srcdir', `$srcdir/..', or `$srcdir/../..'.
+#
+# Of course, Automake must honor this variable whenever it calls a
+# tool from the auxiliary directory.  The problem is that $srcdir (and
+# therefore $ac_aux_dir as well) can be either absolute or relative,
+# depending on how configure is run.  This is pretty annoying, since
+# it makes $ac_aux_dir quite unusable in subdirectories: in the top
+# source directory, any form will work fine, but in subdirectories a
+# relative path needs to be adjusted first.
+#
+# $ac_aux_dir/missing
+#    fails when called from a subdirectory if $ac_aux_dir is relative
+# $top_srcdir/$ac_aux_dir/missing
+#    fails if $ac_aux_dir is absolute,
+#    fails when called from a subdirectory in a VPATH build with
+#          a relative $ac_aux_dir
+#
+# The reason of the latter failure is that $top_srcdir and $ac_aux_dir
+# are both prefixed by $srcdir.  In an in-source build this is usually
+# harmless because $srcdir is `.', but things will broke when you
+# start a VPATH build or use an absolute $srcdir.
+#
+# So we could use something similar to $top_srcdir/$ac_aux_dir/missing,
+# iff we strip the leading $srcdir from $ac_aux_dir.  That would be:
+#   am_aux_dir='\$(top_srcdir)/'`expr "$ac_aux_dir" : "$srcdir//*\(.*\)"`
+# and then we would define $MISSING as
+#   MISSING="\${SHELL} $am_aux_dir/missing"
+# This will work as long as MISSING is not called from configure, because
+# unfortunately $(top_srcdir) has no meaning in configure.
+# However there are other variables, like CC, which are often used in
+# configure, and could therefore not use this "fixed" $ac_aux_dir.
+#
+# Another solution, used here, is to always expand $ac_aux_dir to an
+# absolute PATH.  The drawback is that using absolute paths prevent a
+# configured tree to be moved without reconfiguration.
+
+AC_DEFUN([AM_AUX_DIR_EXPAND],
+[dnl Rely on autoconf to set up CDPATH properly.
+AC_PREREQ([2.50])dnl
+# expand $ac_aux_dir to an absolute path
+am_aux_dir=`cd $ac_aux_dir && pwd`
+])
+
+# AM_CONDITIONAL                                            -*- Autoconf -*-
+
+# Copyright (C) 1997, 2000, 2001, 2003, 2004, 2005, 2006
+# Free Software Foundation, Inc.
+#
+# This file is free software; the Free Software Foundation
+# gives unlimited permission to copy and/or distribute it,
+# with or without modifications, as long as this notice is preserved.
+
+# serial 8
+
+# AM_CONDITIONAL(NAME, SHELL-CONDITION)
+# -------------------------------------
+# Define a conditional.
+AC_DEFUN([AM_CONDITIONAL],
+[AC_PREREQ(2.52)dnl
+ ifelse([$1], [TRUE],  [AC_FATAL([$0: invalid condition: $1])],
+	[$1], [FALSE], [AC_FATAL([$0: invalid condition: $1])])dnl
+AC_SUBST([$1_TRUE])dnl
+AC_SUBST([$1_FALSE])dnl
+_AM_SUBST_NOTMAKE([$1_TRUE])dnl
+_AM_SUBST_NOTMAKE([$1_FALSE])dnl
+if $2; then
+  $1_TRUE=
+  $1_FALSE='#'
+else
+  $1_TRUE='#'
+  $1_FALSE=
+fi
+AC_CONFIG_COMMANDS_PRE(
+[if test -z "${$1_TRUE}" && test -z "${$1_FALSE}"; then
+  AC_MSG_ERROR([[conditional "$1" was never defined.
+Usually this means the macro was only invoked conditionally.]])
+fi])])
+
+# Copyright (C) 1999, 2000, 2001, 2002, 2003, 2004, 2005, 2006
+# Free Software Foundation, Inc.
+#
+# This file is free software; the Free Software Foundation
+# gives unlimited permission to copy and/or distribute it,
+# with or without modifications, as long as this notice is preserved.
+
+# serial 9
+
+# There are a few dirty hacks below to avoid letting `AC_PROG_CC' be
+# written in clear, in which case automake, when reading aclocal.m4,
+# will think it sees a *use*, and therefore will trigger all it's
+# C support machinery.  Also note that it means that autoscan, seeing
+# CC etc. in the Makefile, will ask for an AC_PROG_CC use...
+
+
+# _AM_DEPENDENCIES(NAME)
+# ----------------------
+# See how the compiler implements dependency checking.
+# NAME is "CC", "CXX", "GCJ", or "OBJC".
+# We try a few techniques and use that to set a single cache variable.
+#
+# We don't AC_REQUIRE the corresponding AC_PROG_CC since the latter was
+# modified to invoke _AM_DEPENDENCIES(CC); we would have a circular
+# dependency, and given that the user is not expected to run this macro,
+# just rely on AC_PROG_CC.
+AC_DEFUN([_AM_DEPENDENCIES],
+[AC_REQUIRE([AM_SET_DEPDIR])dnl
+AC_REQUIRE([AM_OUTPUT_DEPENDENCY_COMMANDS])dnl
+AC_REQUIRE([AM_MAKE_INCLUDE])dnl
+AC_REQUIRE([AM_DEP_TRACK])dnl
+
+ifelse([$1], CC,   [depcc="$CC"   am_compiler_list=],
+       [$1], CXX,  [depcc="$CXX"  am_compiler_list=],
+       [$1], OBJC, [depcc="$OBJC" am_compiler_list='gcc3 gcc'],
+       [$1], UPC,  [depcc="$UPC"  am_compiler_list=],
+       [$1], GCJ,  [depcc="$GCJ"  am_compiler_list='gcc3 gcc'],
+                   [depcc="$$1"   am_compiler_list=])
+
+AC_CACHE_CHECK([dependency style of $depcc],
+               [am_cv_$1_dependencies_compiler_type],
+[if test -z "$AMDEP_TRUE" && test -f "$am_depcomp"; then
+  # We make a subdir and do the tests there.  Otherwise we can end up
+  # making bogus files that we don't know about and never remove.  For
+  # instance it was reported that on HP-UX the gcc test will end up
+  # making a dummy file named `D' -- because `-MD' means `put the output
+  # in D'.
+  mkdir conftest.dir
+  # Copy depcomp to subdir because otherwise we won't find it if we're
+  # using a relative directory.
+  cp "$am_depcomp" conftest.dir
+  cd conftest.dir
+  # We will build objects and dependencies in a subdirectory because
+  # it helps to detect inapplicable dependency modes.  For instance
+  # both Tru64's cc and ICC support -MD to output dependencies as a
+  # side effect of compilation, but ICC will put the dependencies in
+  # the current directory while Tru64 will put them in the object
+  # directory.
+  mkdir sub
+
+  am_cv_$1_dependencies_compiler_type=none
+  if test "$am_compiler_list" = ""; then
+     am_compiler_list=`sed -n ['s/^#*\([a-zA-Z0-9]*\))$/\1/p'] < ./depcomp`
+  fi
+  for depmode in $am_compiler_list; do
+    # Setup a source with many dependencies, because some compilers
+    # like to wrap large dependency lists on column 80 (with \), and
+    # we should not choose a depcomp mode which is confused by this.
+    #
+    # We need to recreate these files for each test, as the compiler may
+    # overwrite some of them when testing with obscure command lines.
+    # This happens at least with the AIX C compiler.
+    : > sub/conftest.c
+    for i in 1 2 3 4 5 6; do
+      echo '#include "conftst'$i'.h"' >> sub/conftest.c
+      # Using `: > sub/conftst$i.h' creates only sub/conftst1.h with
+      # Solaris 8's {/usr,}/bin/sh.
+      touch sub/conftst$i.h
     done
-  fi
-])
+    echo "${am__include} ${am__quote}sub/conftest.Po${am__quote}" > confmf
 
-dnl AC_LIB_APPENDTOVAR(VAR, CONTENTS) appends the elements of CONTENTS to VAR,
-dnl unless already present in VAR.
-dnl Works only for CPPFLAGS, not for LIB* variables because that sometimes
-dnl contains two or three consecutive elements that belong together.
-AC_DEFUN([AC_LIB_APPENDTOVAR],
-[
-  for element in [$2]; do
-    haveit=
-    for x in $[$1]; do
-      AC_LIB_WITH_FINAL_PREFIX([eval x=\"$x\"])
-      if test "X$x" = "X$element"; then
-        haveit=yes
+    case $depmode in
+    nosideeffect)
+      # after this tag, mechanisms are not by side-effect, so they'll
+      # only be used when explicitly requested
+      if test "x$enable_dependency_tracking" = xyes; then
+	continue
+      else
+	break
+      fi
+      ;;
+    none) break ;;
+    esac
+    # We check with `-c' and `-o' for the sake of the "dashmstdout"
+    # mode.  It turns out that the SunPro C++ compiler does not properly
+    # handle `-M -o', and we need to detect this.
+    if depmode=$depmode \
+       source=sub/conftest.c object=sub/conftest.${OBJEXT-o} \
+       depfile=sub/conftest.Po tmpdepfile=sub/conftest.TPo \
+       $SHELL ./depcomp $depcc -c -o sub/conftest.${OBJEXT-o} sub/conftest.c \
+         >/dev/null 2>conftest.err &&
+       grep sub/conftst1.h sub/conftest.Po > /dev/null 2>&1 &&
+       grep sub/conftst6.h sub/conftest.Po > /dev/null 2>&1 &&
+       grep sub/conftest.${OBJEXT-o} sub/conftest.Po > /dev/null 2>&1 &&
+       ${MAKE-make} -s -f confmf > /dev/null 2>&1; then
+      # icc doesn't choke on unknown options, it will just issue warnings
+      # or remarks (even with -Werror).  So we grep stderr for any message
+      # that says an option was ignored or not supported.
+      # When given -MP, icc 7.0 and 7.1 complain thusly:
+      #   icc: Command line warning: ignoring option '-M'; no argument required
+      # The diagnosis changed in icc 8.0:
+      #   icc: Command line remark: option '-MP' not supported
+      if (grep 'ignoring option' conftest.err ||
+          grep 'not supported' conftest.err) >/dev/null 2>&1; then :; else
+        am_cv_$1_dependencies_compiler_type=$depmode
         break
       fi
-    done
-    if test -z "$haveit"; then
-      [$1]="${[$1]}${[$1]:+ }$element"
     fi
   done
+
+  cd ..
+  rm -rf conftest.dir
+else
+  am_cv_$1_dependencies_compiler_type=none
+fi
+])
+AC_SUBST([$1DEPMODE], [depmode=$am_cv_$1_dependencies_compiler_type])
+AM_CONDITIONAL([am__fastdep$1], [
+  test "x$enable_dependency_tracking" != xno \
+  && test "$am_cv_$1_dependencies_compiler_type" = gcc3])
 ])
 
-# lib-ld.m4 serial 3 (gettext-0.13)
-dnl Copyright (C) 1996-2003 Free Software Foundation, Inc.
-dnl This file is free software; the Free Software Foundation
-dnl gives unlimited permission to copy and/or distribute it,
-dnl with or without modifications, as long as this notice is preserved.
 
-dnl Subroutines of libtool.m4,
-dnl with replacements s/AC_/AC_LIB/ and s/lt_cv/acl_cv/ to avoid collision
-dnl with libtool.m4.
+# AM_SET_DEPDIR
+# -------------
+# Choose a directory name for dependency files.
+# This macro is AC_REQUIREd in _AM_DEPENDENCIES
+AC_DEFUN([AM_SET_DEPDIR],
+[AC_REQUIRE([AM_SET_LEADING_DOT])dnl
+AC_SUBST([DEPDIR], ["${am__leading_dot}deps"])dnl
+])
 
-dnl From libtool-1.4. Sets the variable with_gnu_ld to yes or no.
-AC_DEFUN([AC_LIB_PROG_LD_GNU],
-[AC_CACHE_CHECK([if the linker ($LD) is GNU ld], acl_cv_prog_gnu_ld,
-[# I'd rather use --version here, but apparently some GNU ld's only accept -v.
-case `$LD -v 2>&1 </dev/null` in
-*GNU* | *'with BFD'*)
-  acl_cv_prog_gnu_ld=yes ;;
-*)
-  acl_cv_prog_gnu_ld=no ;;
-esac])
-with_gnu_ld=$acl_cv_prog_gnu_ld
+
+# AM_DEP_TRACK
+# ------------
+AC_DEFUN([AM_DEP_TRACK],
+[AC_ARG_ENABLE(dependency-tracking,
+[  --disable-dependency-tracking  speeds up one-time build
+  --enable-dependency-tracking   do not reject slow dependency extractors])
+if test "x$enable_dependency_tracking" != xno; then
+  am_depcomp="$ac_aux_dir/depcomp"
+  AMDEPBACKSLASH='\'
+fi
+AM_CONDITIONAL([AMDEP], [test "x$enable_dependency_tracking" != xno])
+AC_SUBST([AMDEPBACKSLASH])dnl
+_AM_SUBST_NOTMAKE([AMDEPBACKSLASH])dnl
 ])
 
-dnl From libtool-1.4. Sets the variable LD.
-AC_DEFUN([AC_LIB_PROG_LD],
-[AC_ARG_WITH(gnu-ld,
-[  --with-gnu-ld           assume the C compiler uses GNU ld [default=no]],
-test "$withval" = no || with_gnu_ld=yes, with_gnu_ld=no)
-AC_REQUIRE([AC_PROG_CC])dnl
-AC_REQUIRE([AC_CANONICAL_HOST])dnl
-# Prepare PATH_SEPARATOR.
-# The user is always right.
-if test "${PATH_SEPARATOR+set}" != set; then
-  echo "#! /bin/sh" >conf$$.sh
-  echo  "exit 0"   >>conf$$.sh
-  chmod +x conf$$.sh
-  if (PATH="/nonexistent;."; conf$$.sh) >/dev/null 2>&1; then
-    PATH_SEPARATOR=';'
+# Generate code to set up dependency tracking.              -*- Autoconf -*-
+
+# Copyright (C) 1999, 2000, 2001, 2002, 2003, 2004, 2005
+# Free Software Foundation, Inc.
+#
+# This file is free software; the Free Software Foundation
+# gives unlimited permission to copy and/or distribute it,
+# with or without modifications, as long as this notice is preserved.
+
+#serial 3
+
+# _AM_OUTPUT_DEPENDENCY_COMMANDS
+# ------------------------------
+AC_DEFUN([_AM_OUTPUT_DEPENDENCY_COMMANDS],
+[for mf in $CONFIG_FILES; do
+  # Strip MF so we end up with the name of the file.
+  mf=`echo "$mf" | sed -e 's/:.*$//'`
+  # Check whether this is an Automake generated Makefile or not.
+  # We used to match only the files named `Makefile.in', but
+  # some people rename them; so instead we look at the file content.
+  # Grep'ing the first line is not enough: some people post-process
+  # each Makefile.in and add a new line on top of each file to say so.
+  # Grep'ing the whole file is not good either: AIX grep has a line
+  # limit of 2048, but all sed's we know have understand at least 4000.
+  if sed -n 's,^#.*generated by automake.*,X,p' "$mf" | grep X >/dev/null 2>&1; then
+    dirpart=`AS_DIRNAME("$mf")`
   else
-    PATH_SEPARATOR=:
+    continue
+  fi
+  # Extract the definition of DEPDIR, am__include, and am__quote
+  # from the Makefile without running `make'.
+  DEPDIR=`sed -n 's/^DEPDIR = //p' < "$mf"`
+  test -z "$DEPDIR" && continue
+  am__include=`sed -n 's/^am__include = //p' < "$mf"`
+  test -z "am__include" && continue
+  am__quote=`sed -n 's/^am__quote = //p' < "$mf"`
+  # When using ansi2knr, U may be empty or an underscore; expand it
+  U=`sed -n 's/^U = //p' < "$mf"`
+  # Find all dependency output files, they are included files with
+  # $(DEPDIR) in their names.  We invoke sed twice because it is the
+  # simplest approach to changing $(DEPDIR) to its actual value in the
+  # expansion.
+  for file in `sed -n "
+    s/^$am__include $am__quote\(.*(DEPDIR).*\)$am__quote"'$/\1/p' <"$mf" | \
+       sed -e 's/\$(DEPDIR)/'"$DEPDIR"'/g' -e 's/\$U/'"$U"'/g'`; do
+    # Make sure the directory exists.
+    test -f "$dirpart/$file" && continue
+    fdir=`AS_DIRNAME(["$file"])`
+    AS_MKDIR_P([$dirpart/$fdir])
+    # echo "creating $dirpart/$file"
+    echo '# dummy' > "$dirpart/$file"
+  done
+done
+])# _AM_OUTPUT_DEPENDENCY_COMMANDS
+
+
+# AM_OUTPUT_DEPENDENCY_COMMANDS
+# -----------------------------
+# This macro should only be invoked once -- use via AC_REQUIRE.
+#
+# This code is only required when automatic dependency tracking
+# is enabled.  FIXME.  This creates each `.P' file that we will
+# need in order to bootstrap the dependency handling code.
+AC_DEFUN([AM_OUTPUT_DEPENDENCY_COMMANDS],
+[AC_CONFIG_COMMANDS([depfiles],
+     [test x"$AMDEP_TRUE" != x"" || _AM_OUTPUT_DEPENDENCY_COMMANDS],
+     [AMDEP_TRUE="$AMDEP_TRUE" ac_aux_dir="$ac_aux_dir"])
+])
+
+
+# Copyright (C) 1996, 1998, 1999, 2000, 2001, 2002, 2003, 2005
+# Free Software Foundation, Inc.
+#
+# This file is free software; the Free Software Foundation
+# gives unlimited permission to copy and/or distribute it,
+# with or without modifications, as long as this notice is preserved.
+
+# serial 3
+
+AC_DEFUN([AM_WITH_DMALLOC],
+[AC_MSG_CHECKING([if malloc debugging is wanted])
+AC_ARG_WITH(dmalloc,
+[  --with-dmalloc          use dmalloc, as in
+			  http://www.dmalloc.com/dmalloc.tar.gz],
+[if test "$withval" = yes; then
+  AC_MSG_RESULT(yes)
+  AC_DEFINE(WITH_DMALLOC,1,
+	    [Define if using the dmalloc debugging malloc package])
+  LIBS="$LIBS -ldmalloc"
+  LDFLAGS="$LDFLAGS -g"
+else
+  AC_MSG_RESULT(no)
+fi], [AC_MSG_RESULT(no)])
+])
+
+AU_DEFUN([fp_WITH_DMALLOC], [AM_WITH_DMALLOC])
+
+# Copyright (C) 1996, 1997, 2000, 2001, 2003, 2005
+# Free Software Foundation, Inc.
+#
+# This file is free software; the Free Software Foundation
+# gives unlimited permission to copy and/or distribute it,
+# with or without modifications, as long as this notice is preserved.
+
+# serial 8
+
+# AM_CONFIG_HEADER is obsolete.  It has been replaced by AC_CONFIG_HEADERS.
+AU_DEFUN([AM_CONFIG_HEADER], [AC_CONFIG_HEADERS($@)])
+
+# Do all the work for Automake.                             -*- Autoconf -*-
+
+# Copyright (C) 1996, 1997, 1998, 1999, 2000, 2001, 2002, 2003, 2004,
+# 2005, 2006, 2008 Free Software Foundation, Inc.
+#
+# This file is free software; the Free Software Foundation
+# gives unlimited permission to copy and/or distribute it,
+# with or without modifications, as long as this notice is preserved.
+
+# serial 13
+
+# This macro actually does too much.  Some checks are only needed if
+# your package does certain things.  But this isn't really a big deal.
+
+# AM_INIT_AUTOMAKE(PACKAGE, VERSION, [NO-DEFINE])
+# AM_INIT_AUTOMAKE([OPTIONS])
+# -----------------------------------------------
+# The call with PACKAGE and VERSION arguments is the old style
+# call (pre autoconf-2.50), which is being phased out.  PACKAGE
+# and VERSION should now be passed to AC_INIT and removed from
+# the call to AM_INIT_AUTOMAKE.
+# We support both call styles for the transition.  After
+# the next Automake release, Autoconf can make the AC_INIT
+# arguments mandatory, and then we can depend on a new Autoconf
+# release and drop the old call support.
+AC_DEFUN([AM_INIT_AUTOMAKE],
+[AC_PREREQ([2.60])dnl
+dnl Autoconf wants to disallow AM_ names.  We explicitly allow
+dnl the ones we care about.
+m4_pattern_allow([^AM_[A-Z]+FLAGS$])dnl
+AC_REQUIRE([AM_SET_CURRENT_AUTOMAKE_VERSION])dnl
+AC_REQUIRE([AC_PROG_INSTALL])dnl
+if test "`cd $srcdir && pwd`" != "`pwd`"; then
+  # Use -I$(srcdir) only when $(srcdir) != ., so that make's output
+  # is not polluted with repeated "-I."
+  AC_SUBST([am__isrc], [' -I$(srcdir)'])_AM_SUBST_NOTMAKE([am__isrc])dnl
+  # test to see if srcdir already configured
+  if test -f $srcdir/config.status; then
+    AC_MSG_ERROR([source directory already configured; run "make distclean" there first])
   fi
-  rm -f conf$$.sh
 fi
-ac_prog=ld
-if test "$GCC" = yes; then
-  # Check if gcc -print-prog-name=ld gives a path.
-  AC_MSG_CHECKING([for ld used by GCC])
-  case $host in
-  *-*-mingw*)
-    # gcc leaves a trailing carriage return which upsets mingw
-    ac_prog=`($CC -print-prog-name=ld) 2>&5 | tr -d '\015'` ;;
-  *)
-    ac_prog=`($CC -print-prog-name=ld) 2>&5` ;;
-  esac
-  case $ac_prog in
-    # Accept absolute paths.
-    [[\\/]* | [A-Za-z]:[\\/]*)]
-      [re_direlt='/[^/][^/]*/\.\./']
-      # Canonicalize the path of ld
-      ac_prog=`echo $ac_prog| sed 's%\\\\%/%g'`
-      while echo $ac_prog | grep "$re_direlt" > /dev/null 2>&1; do
-	ac_prog=`echo $ac_prog| sed "s%$re_direlt%/%"`
-      done
-      test -z "$LD" && LD="$ac_prog"
-      ;;
-  "")
-    # If it fails, then pretend we aren't using GCC.
-    ac_prog=ld
-    ;;
-  *)
-    # If it is relative, then search for the first ld in PATH.
-    with_gnu_ld=unknown
-    ;;
+
+# test whether we have cygpath
+if test -z "$CYGPATH_W"; then
+  if (cygpath --version) >/dev/null 2>/dev/null; then
+    CYGPATH_W='cygpath -w'
+  else
+    CYGPATH_W=echo
+  fi
+fi
+AC_SUBST([CYGPATH_W])
+
+# Define the identity of the package.
+dnl Distinguish between old-style and new-style calls.
+m4_ifval([$2],
+[m4_ifval([$3], [_AM_SET_OPTION([no-define])])dnl
+ AC_SUBST([PACKAGE], [$1])dnl
+ AC_SUBST([VERSION], [$2])],
+[_AM_SET_OPTIONS([$1])dnl
+dnl Diagnose old-style AC_INIT with new-style AM_AUTOMAKE_INIT.
+m4_if(m4_ifdef([AC_PACKAGE_NAME], 1)m4_ifdef([AC_PACKAGE_VERSION], 1), 11,,
+  [m4_fatal([AC_INIT should be called with package and version arguments])])dnl
+ AC_SUBST([PACKAGE], ['AC_PACKAGE_TARNAME'])dnl
+ AC_SUBST([VERSION], ['AC_PACKAGE_VERSION'])])dnl
+
+_AM_IF_OPTION([no-define],,
+[AC_DEFINE_UNQUOTED(PACKAGE, "$PACKAGE", [Name of package])
+ AC_DEFINE_UNQUOTED(VERSION, "$VERSION", [Version number of package])])dnl
+
+# Some tools Automake needs.
+AC_REQUIRE([AM_SANITY_CHECK])dnl
+AC_REQUIRE([AC_ARG_PROGRAM])dnl
+AM_MISSING_PROG(ACLOCAL, aclocal-${am__api_version})
+AM_MISSING_PROG(AUTOCONF, autoconf)
+AM_MISSING_PROG(AUTOMAKE, automake-${am__api_version})
+AM_MISSING_PROG(AUTOHEADER, autoheader)
+AM_MISSING_PROG(MAKEINFO, makeinfo)
+AM_PROG_INSTALL_SH
+AM_PROG_INSTALL_STRIP
+AC_REQUIRE([AM_PROG_MKDIR_P])dnl
+# We need awk for the "check" target.  The system "awk" is bad on
+# some platforms.
+AC_REQUIRE([AC_PROG_AWK])dnl
+AC_REQUIRE([AC_PROG_MAKE_SET])dnl
+AC_REQUIRE([AM_SET_LEADING_DOT])dnl
+_AM_IF_OPTION([tar-ustar], [_AM_PROG_TAR([ustar])],
+              [_AM_IF_OPTION([tar-pax], [_AM_PROG_TAR([pax])],
+	      		     [_AM_PROG_TAR([v7])])])
+_AM_IF_OPTION([no-dependencies],,
+[AC_PROVIDE_IFELSE([AC_PROG_CC],
+                  [_AM_DEPENDENCIES(CC)],
+                  [define([AC_PROG_CC],
+                          defn([AC_PROG_CC])[_AM_DEPENDENCIES(CC)])])dnl
+AC_PROVIDE_IFELSE([AC_PROG_CXX],
+                  [_AM_DEPENDENCIES(CXX)],
+                  [define([AC_PROG_CXX],
+                          defn([AC_PROG_CXX])[_AM_DEPENDENCIES(CXX)])])dnl
+AC_PROVIDE_IFELSE([AC_PROG_OBJC],
+                  [_AM_DEPENDENCIES(OBJC)],
+                  [define([AC_PROG_OBJC],
+                          defn([AC_PROG_OBJC])[_AM_DEPENDENCIES(OBJC)])])dnl
+])
+])
+
+
+# When config.status generates a header, we must update the stamp-h file.
+# This file resides in the same directory as the config header
+# that is generated.  The stamp files are numbered to have different names.
+
+# Autoconf calls _AC_AM_CONFIG_HEADER_HOOK (when defined) in the
+# loop where config.status creates the headers, so we can generate
+# our stamp files there.
+AC_DEFUN([_AC_AM_CONFIG_HEADER_HOOK],
+[# Compute $1's index in $config_headers.
+_am_arg=$1
+_am_stamp_count=1
+for _am_header in $config_headers :; do
+  case $_am_header in
+    $_am_arg | $_am_arg:* )
+      break ;;
+    * )
+      _am_stamp_count=`expr $_am_stamp_count + 1` ;;
   esac
-elif test "$with_gnu_ld" = yes; then
-  AC_MSG_CHECKING([for GNU ld])
+done
+echo "timestamp for $_am_arg" >`AS_DIRNAME(["$_am_arg"])`/stamp-h[]$_am_stamp_count])
+
+# Copyright (C) 2001, 2003, 2005  Free Software Foundation, Inc.
+#
+# This file is free software; the Free Software Foundation
+# gives unlimited permission to copy and/or distribute it,
+# with or without modifications, as long as this notice is preserved.
+
+# AM_PROG_INSTALL_SH
+# ------------------
+# Define $install_sh.
+AC_DEFUN([AM_PROG_INSTALL_SH],
+[AC_REQUIRE([AM_AUX_DIR_EXPAND])dnl
+install_sh=${install_sh-"\$(SHELL) $am_aux_dir/install-sh"}
+AC_SUBST(install_sh)])
+
+# Copyright (C) 2003, 2005  Free Software Foundation, Inc.
+#
+# This file is free software; the Free Software Foundation
+# gives unlimited permission to copy and/or distribute it,
+# with or without modifications, as long as this notice is preserved.
+
+# serial 2
+
+# Check whether the underlying file-system supports filenames
+# with a leading dot.  For instance MS-DOS doesn't.
+AC_DEFUN([AM_SET_LEADING_DOT],
+[rm -rf .tst 2>/dev/null
+mkdir .tst 2>/dev/null
+if test -d .tst; then
+  am__leading_dot=.
 else
-  AC_MSG_CHECKING([for non-GNU ld])
+  am__leading_dot=_
 fi
-AC_CACHE_VAL(acl_cv_path_LD,
-[if test -z "$LD"; then
-  IFS="${IFS= 	}"; ac_save_ifs="$IFS"; IFS="${IFS}${PATH_SEPARATOR-:}"
-  for ac_dir in $PATH; do
-    test -z "$ac_dir" && ac_dir=.
-    if test -f "$ac_dir/$ac_prog" || test -f "$ac_dir/$ac_prog$ac_exeext"; then
-      acl_cv_path_LD="$ac_dir/$ac_prog"
-      # Check to see if the program is GNU ld.  I'd rather use --version,
-      # but apparently some GNU ld's only accept -v.
-      # Break only if it was the GNU/non-GNU ld that we prefer.
-      case `"$acl_cv_path_LD" -v 2>&1 < /dev/null` in
-      *GNU* | *'with BFD'*)
-	test "$with_gnu_ld" != no && break ;;
-      *)
-	test "$with_gnu_ld" != yes && break ;;
-      esac
-    fi
-  done
-  IFS="$ac_save_ifs"
-else
-  acl_cv_path_LD="$LD" # Let the user override the test with a path.
-fi])
-LD="$acl_cv_path_LD"
-if test -n "$LD"; then
-  AC_MSG_RESULT($LD)
-else
-  AC_MSG_RESULT(no)
+rmdir .tst 2>/dev/null
+AC_SUBST([am__leading_dot])])
+
+# Check to see how 'make' treats includes.	            -*- Autoconf -*-
+
+# Copyright (C) 2001, 2002, 2003, 2005  Free Software Foundation, Inc.
+#
+# This file is free software; the Free Software Foundation
+# gives unlimited permission to copy and/or distribute it,
+# with or without modifications, as long as this notice is preserved.
+
+# serial 3
+
+# AM_MAKE_INCLUDE()
+# -----------------
+# Check to see how make treats includes.
+AC_DEFUN([AM_MAKE_INCLUDE],
+[am_make=${MAKE-make}
+cat > confinc << 'END'
+am__doit:
+	@echo done
+.PHONY: am__doit
+END
+# If we don't find an include directive, just comment out the code.
+AC_MSG_CHECKING([for style of include used by $am_make])
+am__include="#"
+am__quote=
+_am_result=none
+# First try GNU make style include.
+echo "include confinc" > confmf
+# We grep out `Entering directory' and `Leaving directory'
+# messages which can occur if `w' ends up in MAKEFLAGS.
+# In particular we don't look at `^make:' because GNU make might
+# be invoked under some other name (usually "gmake"), in which
+# case it prints its new name instead of `make'.
+if test "`$am_make -s -f confmf 2> /dev/null | grep -v 'ing directory'`" = "done"; then
+   am__include=include
+   am__quote=
+   _am_result=GNU
 fi
-test -z "$LD" && AC_MSG_ERROR([no acceptable ld found in \$PATH])
-AC_LIB_PROG_LD_GNU
+# Now try BSD make style include.
+if test "$am__include" = "#"; then
+   echo '.include "confinc"' > confmf
+   if test "`$am_make -s -f confmf 2> /dev/null`" = "done"; then
+      am__include=.include
+      am__quote="\""
+      _am_result=BSD
+   fi
+fi
+AC_SUBST([am__include])
+AC_SUBST([am__quote])
+AC_MSG_RESULT([$_am_result])
+rm -f confinc confmf
 ])
 
-# Do all the work for Automake.  This macro actually does too much --
-# some checks are only needed if your package does certain things.
-# But this isn't really a big deal.
+# Fake the existence of programs that GNU maintainers use.  -*- Autoconf -*-
 
-# serial 1
+# Copyright (C) 1997, 1999, 2000, 2001, 2003, 2004, 2005
+# Free Software Foundation, Inc.
+#
+# This file is free software; the Free Software Foundation
+# gives unlimited permission to copy and/or distribute it,
+# with or without modifications, as long as this notice is preserved.
 
-dnl Usage:
-dnl AM_INIT_AUTOMAKE(package,version, [no-define])
+# serial 5
 
-AC_DEFUN([AM_INIT_AUTOMAKE],
-[AC_REQUIRE([AM_SET_CURRENT_AUTOMAKE_VERSION])dnl
-AC_REQUIRE([AC_PROG_INSTALL])
-PACKAGE=[$1]
-AC_SUBST(PACKAGE)
-VERSION=[$2]
-AC_SUBST(VERSION)
-dnl test to see if srcdir already configured
-if test "`cd $srcdir && pwd`" != "`pwd`" && test -f $srcdir/config.status; then
-  AC_MSG_ERROR([source directory already configured; run "make distclean" there first])
-fi
-ifelse([$3],,
-AC_DEFINE_UNQUOTED(PACKAGE, "$PACKAGE", [Name of package])
-AC_DEFINE_UNQUOTED(VERSION, "$VERSION", [Version number of package]))
-AC_REQUIRE([AM_SANITY_CHECK])
-AC_REQUIRE([AC_ARG_PROGRAM])
-dnl FIXME This is truly gross.
-missing_dir=`cd $ac_aux_dir && pwd`
-AM_MISSING_PROG(ACLOCAL, aclocal-${am__api_version}, $missing_dir)
-AM_MISSING_PROG(AUTOCONF, autoconf, $missing_dir)
-AM_MISSING_PROG(AUTOMAKE, automake-${am__api_version}, $missing_dir)
-AM_MISSING_PROG(AUTOHEADER, autoheader, $missing_dir)
-AM_MISSING_PROG(MAKEINFO, makeinfo, $missing_dir)
-AC_REQUIRE([AC_PROG_MAKE_SET])])
-
-# Copyright 2002  Free Software Foundation, Inc.
-
-# This program is free software; you can redistribute it and/or modify
-# it under the terms of the GNU General Public License as published by
-# the Free Software Foundation; either version 2, or (at your option)
-# any later version.
+# AM_MISSING_PROG(NAME, PROGRAM)
+# ------------------------------
+AC_DEFUN([AM_MISSING_PROG],
+[AC_REQUIRE([AM_MISSING_HAS_RUN])
+$1=${$1-"${am_missing_run}$2"}
+AC_SUBST($1)])
 
-# This program is distributed in the hope that it will be useful,
-# but WITHOUT ANY WARRANTY; without even the implied warranty of
-# MERCHANTABILITY or FITNESS FOR A PARTICULAR PURPOSE.  See the
-# GNU General Public License for more details.
-
-# You should have received a copy of the GNU General Public License
-# along with this program; if not, write to the Free Software
-# Foundation, Inc., 59 Temple Place - Suite 330, Boston, MA
 
-# AM_AUTOMAKE_VERSION(VERSION)
-# ----------------------------
-# Automake X.Y traces this macro to ensure aclocal.m4 has been
-# generated from the m4 files accompanying Automake X.Y.
-AC_DEFUN([AM_AUTOMAKE_VERSION],[am__api_version="1.4"])
+# AM_MISSING_HAS_RUN
+# ------------------
+# Define MISSING if not defined so far and test if it supports --run.
+# If it does, set am_missing_run to use it, otherwise, to nothing.
+AC_DEFUN([AM_MISSING_HAS_RUN],
+[AC_REQUIRE([AM_AUX_DIR_EXPAND])dnl
+AC_REQUIRE_AUX_FILE([missing])dnl
+test x"${MISSING+set}" = xset || MISSING="\${SHELL} $am_aux_dir/missing"
+# Use eval to expand $SHELL
+if eval "$MISSING --run true"; then
+  am_missing_run="$MISSING --run "
+else
+  am_missing_run=
+  AC_MSG_WARN([`missing' script is too old or missing])
+fi
+])
 
-# AM_SET_CURRENT_AUTOMAKE_VERSION
-# -------------------------------
-# Call AM_AUTOMAKE_VERSION so it can be traced.
-# This function is AC_REQUIREd by AC_INIT_AUTOMAKE.
-AC_DEFUN([AM_SET_CURRENT_AUTOMAKE_VERSION],
-	 [AM_AUTOMAKE_VERSION([1.4-p6])])
+# Copyright (C) 2003, 2004, 2005, 2006  Free Software Foundation, Inc.
+#
+# This file is free software; the Free Software Foundation
+# gives unlimited permission to copy and/or distribute it,
+# with or without modifications, as long as this notice is preserved.
+
+# AM_PROG_MKDIR_P
+# ---------------
+# Check for `mkdir -p'.
+AC_DEFUN([AM_PROG_MKDIR_P],
+[AC_PREREQ([2.60])dnl
+AC_REQUIRE([AC_PROG_MKDIR_P])dnl
+dnl Automake 1.8 to 1.9.6 used to define mkdir_p.  We now use MKDIR_P,
+dnl while keeping a definition of mkdir_p for backward compatibility.
+dnl @MKDIR_P@ is magic: AC_OUTPUT adjusts its value for each Makefile.
+dnl However we cannot define mkdir_p as $(MKDIR_P) for the sake of
+dnl Makefile.ins that do not define MKDIR_P, so we do our own
+dnl adjustment using top_builddir (which is defined more often than
+dnl MKDIR_P).
+AC_SUBST([mkdir_p], ["$MKDIR_P"])dnl
+case $mkdir_p in
+  [[\\/$]]* | ?:[[\\/]]*) ;;
+  */*) mkdir_p="\$(top_builddir)/$mkdir_p" ;;
+esac
+])
 
+# Helper functions for option handling.                     -*- Autoconf -*-
+
+# Copyright (C) 2001, 2002, 2003, 2005  Free Software Foundation, Inc.
 #
-# Check to make sure that the build environment is sane.
+# This file is free software; the Free Software Foundation
+# gives unlimited permission to copy and/or distribute it,
+# with or without modifications, as long as this notice is preserved.
+
+# serial 3
+
+# _AM_MANGLE_OPTION(NAME)
+# -----------------------
+AC_DEFUN([_AM_MANGLE_OPTION],
+[[_AM_OPTION_]m4_bpatsubst($1, [[^a-zA-Z0-9_]], [_])])
+
+# _AM_SET_OPTION(NAME)
+# ------------------------------
+# Set option NAME.  Presently that only means defining a flag for this option.
+AC_DEFUN([_AM_SET_OPTION],
+[m4_define(_AM_MANGLE_OPTION([$1]), 1)])
+
+# _AM_SET_OPTIONS(OPTIONS)
+# ----------------------------------
+# OPTIONS is a space-separated list of Automake options.
+AC_DEFUN([_AM_SET_OPTIONS],
+[AC_FOREACH([_AM_Option], [$1], [_AM_SET_OPTION(_AM_Option)])])
+
+# _AM_IF_OPTION(OPTION, IF-SET, [IF-NOT-SET])
+# -------------------------------------------
+# Execute IF-SET if OPTION is set, IF-NOT-SET otherwise.
+AC_DEFUN([_AM_IF_OPTION],
+[m4_ifset(_AM_MANGLE_OPTION([$1]), [$2], [$3])])
+
+# Check to make sure that the build environment is sane.    -*- Autoconf -*-
+
+# Copyright (C) 1996, 1997, 2000, 2001, 2003, 2005
+# Free Software Foundation, Inc.
 #
+# This file is free software; the Free Software Foundation
+# gives unlimited permission to copy and/or distribute it,
+# with or without modifications, as long as this notice is preserved.
+
+# serial 4
 
+# AM_SANITY_CHECK
+# ---------------
 AC_DEFUN([AM_SANITY_CHECK],
 [AC_MSG_CHECKING([whether build environment is sane])
 # Just in case
 sleep 1
-echo timestamp > conftestfile
+echo timestamp > conftest.file
 # Do `set' in a subshell so we don't clobber the current shell's
 # arguments.  Must try -L first in case configure is actually a
 # symlink; some systems play weird games with the mod time of symlinks
 # (eg FreeBSD returns the mod time of the symlink's containing
 # directory).
 if (
-   set X `ls -Lt $srcdir/configure conftestfile 2> /dev/null`
-   if test "[$]*" = "X"; then
+   set X `ls -Lt $srcdir/configure conftest.file 2> /dev/null`
+   if test "$[*]" = "X"; then
       # -L didn't work.
-      set X `ls -t $srcdir/configure conftestfile`
+      set X `ls -t $srcdir/configure conftest.file`
    fi
-   if test "[$]*" != "X $srcdir/configure conftestfile" \
-      && test "[$]*" != "X conftestfile $srcdir/configure"; then
+   rm -f conftest.file
+   if test "$[*]" != "X $srcdir/configure conftest.file" \
+      && test "$[*]" != "X conftest.file $srcdir/configure"; then
 
       # If neither matched, then we have a broken ls.  This can happen
       # if, for instance, CONFIG_SHELL is bash and it inherits a
@@ -923,7 +1947,7 @@
 alias in your environment])
    fi
 
-   test "[$]2" = conftestfile
+   test "$[2]" = conftest.file
    )
 then
    # Ok.
@@ -932,64 +1956,141 @@
    AC_MSG_ERROR([newly created file is older than distributed files!
 Check your system clock])
 fi
-rm -f conftest*
 AC_MSG_RESULT(yes)])
 
-dnl AM_MISSING_PROG(NAME, PROGRAM, DIRECTORY)
-dnl The program must properly implement --version.
-AC_DEFUN([AM_MISSING_PROG],
-[AC_MSG_CHECKING(for working $2)
-# Run test in a subshell; some versions of sh will print an error if
-# an executable is not found, even if stderr is redirected.
-# Redirect stdin to placate older versions of autoconf.  Sigh.
-if ($2 --version) < /dev/null > /dev/null 2>&1; then
-   $1=$2
-   AC_MSG_RESULT(found)
-else
-   $1="$3/missing $2"
-   AC_MSG_RESULT(missing)
+# Copyright (C) 2001, 2003, 2005  Free Software Foundation, Inc.
+#
+# This file is free software; the Free Software Foundation
+# gives unlimited permission to copy and/or distribute it,
+# with or without modifications, as long as this notice is preserved.
+
+# AM_PROG_INSTALL_STRIP
+# ---------------------
+# One issue with vendor `install' (even GNU) is that you can't
+# specify the program used to strip binaries.  This is especially
+# annoying in cross-compiling environments, where the build's strip
+# is unlikely to handle the host's binaries.
+# Fortunately install-sh will honor a STRIPPROG variable, so we
+# always use install-sh in `make install-strip', and initialize
+# STRIPPROG with the value of the STRIP variable (set by the user).
+AC_DEFUN([AM_PROG_INSTALL_STRIP],
+[AC_REQUIRE([AM_PROG_INSTALL_SH])dnl
+# Installed binaries are usually stripped using `strip' when the user
+# run `make install-strip'.  However `strip' might not be the right
+# tool to use in cross-compilation environments, therefore Automake
+# will honor the `STRIP' environment variable to overrule this program.
+dnl Don't test for $cross_compiling = yes, because it might be `maybe'.
+if test "$cross_compiling" != no; then
+  AC_CHECK_TOOL([STRIP], [strip], :)
 fi
-AC_SUBST($1)])
+INSTALL_STRIP_PROGRAM="\$(install_sh) -c -s"
+AC_SUBST([INSTALL_STRIP_PROGRAM])])
 
-# Like AC_CONFIG_HEADER, but automatically create stamp file.
+# Copyright (C) 2006  Free Software Foundation, Inc.
+#
+# This file is free software; the Free Software Foundation
+# gives unlimited permission to copy and/or distribute it,
+# with or without modifications, as long as this notice is preserved.
+
+# _AM_SUBST_NOTMAKE(VARIABLE)
+# ---------------------------
+# Prevent Automake from outputting VARIABLE = @VARIABLE@ in Makefile.in.
+# This macro is traced by Automake.
+AC_DEFUN([_AM_SUBST_NOTMAKE])
+
+# Check how to create a tarball.                            -*- Autoconf -*-
 
-AC_DEFUN([AM_CONFIG_HEADER],
-[AC_PREREQ([2.12])
-AC_CONFIG_HEADER([$1])
-dnl When config.status generates a header, we must update the stamp-h file.
-dnl This file resides in the same directory as the config header
-dnl that is generated.  We must strip everything past the first ":",
-dnl and everything past the last "/".
-AC_OUTPUT_COMMANDS(changequote(<<,>>)dnl
-ifelse(patsubst(<<$1>>, <<[^ ]>>, <<>>), <<>>,
-<<test -z "<<$>>CONFIG_HEADERS" || echo timestamp > patsubst(<<$1>>, <<^\([^:]*/\)?.*>>, <<\1>>)stamp-h<<>>dnl>>,
-<<am_indx=1
-for am_file in <<$1>>; do
-  case " <<$>>CONFIG_HEADERS " in
-  *" <<$>>am_file "*<<)>>
-    echo timestamp > `echo <<$>>am_file | sed -e 's%:.*%%' -e 's%[^/]*$%%'`stamp-h$am_indx
+# Copyright (C) 2004, 2005  Free Software Foundation, Inc.
+#
+# This file is free software; the Free Software Foundation
+# gives unlimited permission to copy and/or distribute it,
+# with or without modifications, as long as this notice is preserved.
+
+# serial 2
+
+# _AM_PROG_TAR(FORMAT)
+# --------------------
+# Check how to create a tarball in format FORMAT.
+# FORMAT should be one of `v7', `ustar', or `pax'.
+#
+# Substitute a variable $(am__tar) that is a command
+# writing to stdout a FORMAT-tarball containing the directory
+# $tardir.
+#     tardir=directory && $(am__tar) > result.tar
+#
+# Substitute a variable $(am__untar) that extract such
+# a tarball read from stdin.
+#     $(am__untar) < result.tar
+AC_DEFUN([_AM_PROG_TAR],
+[# Always define AMTAR for backward compatibility.
+AM_MISSING_PROG([AMTAR], [tar])
+m4_if([$1], [v7],
+     [am__tar='${AMTAR} chof - "$$tardir"'; am__untar='${AMTAR} xf -'],
+     [m4_case([$1], [ustar],, [pax],,
+              [m4_fatal([Unknown tar format])])
+AC_MSG_CHECKING([how to create a $1 tar archive])
+# Loop over all known methods to create a tar archive until one works.
+_am_tools='gnutar m4_if([$1], [ustar], [plaintar]) pax cpio none'
+_am_tools=${am_cv_prog_tar_$1-$_am_tools}
+# Do not fold the above two line into one, because Tru64 sh and
+# Solaris sh will not grok spaces in the rhs of `-'.
+for _am_tool in $_am_tools
+do
+  case $_am_tool in
+  gnutar)
+    for _am_tar in tar gnutar gtar;
+    do
+      AM_RUN_LOG([$_am_tar --version]) && break
+    done
+    am__tar="$_am_tar --format=m4_if([$1], [pax], [posix], [$1]) -chf - "'"$$tardir"'
+    am__tar_="$_am_tar --format=m4_if([$1], [pax], [posix], [$1]) -chf - "'"$tardir"'
+    am__untar="$_am_tar -xf -"
+    ;;
+  plaintar)
+    # Must skip GNU tar: if it does not support --format= it doesn't create
+    # ustar tarball either.
+    (tar --version) >/dev/null 2>&1 && continue
+    am__tar='tar chf - "$$tardir"'
+    am__tar_='tar chf - "$tardir"'
+    am__untar='tar xf -'
+    ;;
+  pax)
+    am__tar='pax -L -x $1 -w "$$tardir"'
+    am__tar_='pax -L -x $1 -w "$tardir"'
+    am__untar='pax -r'
+    ;;
+  cpio)
+    am__tar='find "$$tardir" -print | cpio -o -H $1 -L'
+    am__tar_='find "$tardir" -print | cpio -o -H $1 -L'
+    am__untar='cpio -i -H $1 -d'
+    ;;
+  none)
+    am__tar=false
+    am__tar_=false
+    am__untar=false
     ;;
   esac
-  am_indx=`expr "<<$>>am_indx" + 1`
-done<<>>dnl>>)
-changequote([,]))])
 
+  # If the value was cached, stop now.  We just wanted to have am__tar
+  # and am__untar set.
+  test -n "${am_cv_prog_tar_$1}" && break
+
+  # tar/untar a dummy directory, and stop if the command works
+  rm -rf conftest.dir
+  mkdir conftest.dir
+  echo GrepMe > conftest.dir/file
+  AM_RUN_LOG([tardir=conftest.dir && eval $am__tar_ >conftest.tar])
+  rm -rf conftest.dir
+  if test -s conftest.tar; then
+    AM_RUN_LOG([$am__untar <conftest.tar])
+    grep GrepMe conftest.dir/file >/dev/null 2>&1 && break
+  fi
+done
+rm -rf conftest.dir
 
-# serial 1
-
-AC_DEFUN([AM_WITH_DMALLOC],
-[AC_MSG_CHECKING(if malloc debugging is wanted)
-AC_ARG_WITH(dmalloc,
-[  --with-dmalloc          use dmalloc, as in
-                          ftp://ftp.letters.com/src/dmalloc/dmalloc.tar.gz],
-[if test "$withval" = yes; then
-  AC_MSG_RESULT(yes)
-  AC_DEFINE(WITH_DMALLOC,1,
-            [Define if using the dmalloc debugging malloc package])
-  LIBS="$LIBS -ldmalloc"
-  LDFLAGS="$LDFLAGS -g"
-else
-  AC_MSG_RESULT(no)
-fi], [AC_MSG_RESULT(no)])
-])
+AC_CACHE_VAL([am_cv_prog_tar_$1], [am_cv_prog_tar_$1=$_am_tool])
+AC_MSG_RESULT([$am_cv_prog_tar_$1])])
+AC_SUBST([am__tar])
+AC_SUBST([am__untar])
+]) # _AM_PROG_TAR
 
diff -urN lcd4linux-0.10.0/ac_python_devel.m4 lcd4linux-0.11.0-SVN/ac_python_devel.m4
--- lcd4linux-0.10.0/ac_python_devel.m4	1970-01-01 01:00:00.000000000 +0100
+++ lcd4linux-0.11.0-SVN/ac_python_devel.m4	2008-12-31 08:05:54.000000000 +0100
@@ -0,0 +1,189 @@
+dnl $Id: ac_python_devel.m4 729 2007-01-14 13:44:38Z michael $
+dnl $URL: https://ssl.bulix.org/svn/lcd4linux/trunk/ac_python_devel.m4 $
+
+
+dnl @synopsis AC_PYTHON_DEVEL([version])
+dnl
+dnl Checks for Python and tries to get the include path to 'Python.h'.
+dnl It provides the $(PYTHON_CPPFLAGS) and $(PYTHON_LDFLAGS) output
+dnl variables. Also exports $(PYTHON_EXTRA_LIBS) and
+dnl $(PYTHON_EXTRA_LDFLAGS) for embedding Python in your code.
+dnl
+dnl You can search for some particular version of Python by passing a
+dnl parameter to this macro, for example ">= '2.3.1'", or "== '2.4'".
+dnl Please note that you *have* to pass also an operator along with the
+dnl version to match, and pay special attention to the single quotes
+dnl surrounding the version number.
+dnl
+dnl If the user wants to employ a particular version of Python, she can
+dnl now pass to configure the PYTHON_VERSION environment variable. This
+dnl is only limited by the macro parameter set by the packager.
+dnl
+dnl This macro should work for all versions of Python >= 2.1.0. You can
+dnl disable the check for the python version by setting the
+dnl PYTHON_NOVERSIONCHECK environment variable to something else than
+dnl the empty string.
+dnl
+dnl If you need to use this macro for an older Python version, please
+dnl contact the authors. We're always open for feedback.
+dnl
+dnl @category InstalledPackages
+dnl @author Sebastian Huber <sebastian-huber@web.de>
+dnl @author Alan W. Irwin <irwin@beluga.phys.uvic.ca>
+dnl @author Rafael Laboissiere <laboissiere@psy.mpg.de>
+dnl @author Andrew Collier <colliera@nu.ac.za>
+dnl @author Matteo Settenvini <matteo@member.fsf.org>
+dnl @version 2006-02-05
+dnl @license GPLWithACException
+
+AC_DEFUN([AC_PYTHON_DEVEL],[
+	#
+	# Allow the use of a (user set) custom python version
+	#
+	AC_ARG_VAR([PYTHON_VERSION],[The installed Python
+		version to use, for example '2.3'. This string 
+		will be appended to the Python interpreter
+		canonical name.])
+
+	AC_PATH_PROG([PYTHON],[python[$PYTHON_VERSION]])
+	if test -z "$PYTHON"; then
+	   AC_MSG_ERROR([Cannot find python$PYTHON_VERSION in your system path])
+	fi
+
+	#
+	# Check for a version of Python >= 2.1.0
+	#
+	AC_MSG_CHECKING([for a version of Python >= '2.1.0'])
+	ac_supports_python_ver=`$PYTHON -c "import sys, string; \
+		ver = string.split(sys.version)[[0]]; \
+		print ver >= '2.1.0'"`
+	if test "$ac_supports_python_ver" != "True"; then
+		if test -z "$PYTHON_NOVERSIONCHECK"; then
+			AC_MSG_RESULT([no])
+			AC_MSG_FAILURE([
+This version of the AC@&t@_PYTHON_DEVEL macro
+doesn't work properly with versions of Python before
+2.1.0. You may need to re-run configure, setting the
+variables PYTHON_CPPFLAGS, PYTHON_LDFLAGS, PYTHON_SITE_PKG,
+PYTHON_EXTRA_LIBS and PYTHON_EXTRA_LDFLAGS by hand.
+Moreover, to disable this check, set PYTHON_NOVERSIONCHECK
+to something else than an empty string.
+])dnl
+		else
+			AC_MSG_RESULT([skip at user request])
+		fi
+	else 
+		AC_MSG_RESULT([yes])
+	fi
+	
+	#
+	# if the macro parameter ``version'' is set, honour it
+	#
+	if test -n "$1"; then
+		AC_MSG_CHECKING([for a version of Python $1])
+		ac_supports_python_ver=`$PYTHON -c "import sys, string; \
+			ver = string.split(sys.version)[[0]]; \
+			print ver $1"`
+		if test "$ac_supports_python_ver" = "True"; then
+	   	   AC_MSG_RESULT([yes])
+		else
+			AC_MSG_RESULT([no])
+			AC_MSG_ERROR([this package requires Python $1. 
+If you have it installed, but it isn't the default Python
+interpreter in your system path, please pass the PYTHON_VERSION 
+variable to configure. See ``configure --help'' for reference.
+])dnl
+		fi
+	fi
+
+	#
+	# Check if you have distutils, else fail
+	#
+	AC_MSG_CHECKING([for the distutils Python package])
+	ac_distutils_result=`$PYTHON -c "import distutils" 2>&1`
+	if test -z "$ac_distutils_result"; then
+		AC_MSG_RESULT([yes])
+	else
+		AC_MSG_RESULT([no])
+		AC_MSG_ERROR([cannot import Python module "distutils".
+Please check your Python installation. The error was:
+$ac_distutils_result])
+	fi
+
+	#
+	# Check for Python include path
+	#
+	AC_MSG_CHECKING([for Python include path])
+	if test -z "$PYTHON_CPPFLAGS"; then
+		python_path=`$PYTHON -c "import distutils.sysconfig; \
+           		print distutils.sysconfig.get_python_inc();"`
+		if test -n "${python_path}"; then
+		   	python_path="-I$python_path"
+		fi
+		PYTHON_CPPFLAGS=$python_path
+	fi
+	AC_MSG_RESULT([$PYTHON_CPPFLAGS])
+	AC_SUBST([PYTHON_CPPFLAGS])
+
+	#
+	# Check for Python library path
+	#
+	AC_MSG_CHECKING([for Python library path])
+	if test -z "$PYTHON_LDFLAGS"; then
+		# (makes two attempts to ensure we've got a version number
+		# from the interpreter)
+		py_version=`$PYTHON -c "from distutils.sysconfig import *; \
+			from string import join; \
+			print join(get_config_vars('VERSION'))"`
+		if test "$py_version" == "[None]"; then
+			if test -n "$PYTHON_VERSION"; then
+				py_version=$PYTHON_VERSION
+			else
+				py_version=`$PYTHON -c "import sys; \
+					print sys.version[[:3]]"`
+			fi
+		fi
+
+		PYTHON_LDFLAGS=`$PYTHON -c "from distutils.sysconfig import *; \
+			from string import join; \
+			print '-L' + get_python_lib(0,1), \
+		      	'-lpython';"`$py_version
+	fi		
+	AC_MSG_RESULT([$PYTHON_LDFLAGS])
+	AC_SUBST([PYTHON_LDFLAGS])
+
+	#
+	# Check for site packages
+	#
+	AC_MSG_CHECKING([for Python site-packages path])
+	if test -z "$PYTHON_SITE_PKG"; then
+		PYTHON_SITE_PKG=`$PYTHON -c "import distutils.sysconfig; \
+		        print distutils.sysconfig.get_python_lib(0,0);"`
+	fi
+	AC_MSG_RESULT([$PYTHON_SITE_PKG])
+	AC_SUBST([PYTHON_SITE_PKG])
+
+	#
+	# libraries which must be linked in when embedding
+	#
+	AC_MSG_CHECKING(python extra libraries)
+	if test -z "$PYTHON_EXTRA_LIBS"; then
+	   PYTHON_EXTRA_LIBS=`$PYTHON -c "import distutils.sysconfig; \
+                conf = distutils.sysconfig.get_config_var; \
+                print conf('LOCALMODLIBS'), conf('LIBS')"`
+	fi
+	AC_MSG_RESULT([$PYTHON_EXTRA_LIBS])
+	AC_SUBST(PYTHON_EXTRA_LIBS)
+
+	#
+	# linking flags needed when embedding
+	#
+	AC_MSG_CHECKING(python extra linking flags)
+	if test -z "$PYTHON_EXTRA_LDFLAGS"; then
+		PYTHON_EXTRA_LDFLAGS=`$PYTHON -c "import distutils.sysconfig; \
+			conf = distutils.sysconfig.get_config_var; \
+			print conf('LINKFORSHARED')"`
+	fi
+	AC_MSG_RESULT([$PYTHON_EXTRA_LDFLAGS])
+	AC_SUBST(PYTHON_EXTRA_LDFLAGS)
+])
diff -urN lcd4linux-0.10.0/AUTHORS lcd4linux-0.11.0-SVN/AUTHORS
--- lcd4linux-0.10.0/AUTHORS	2005-06-01 06:37:03.000000000 +0200
+++ lcd4linux-0.11.0-SVN/AUTHORS	2008-12-31 08:05:54.000000000 +0100
@@ -1,19 +1,5 @@
-LCD4Linux development team:
+# $Id: AUTHORS 730 2007-01-14 13:50:28Z michael $
+# $URL: https://ssl.bulix.org/svn/lcd4linux/trunk/AUTHORS $
 
-Michael Reinelt <reinelt@eunet.at>
-Herbert Rosmanith <herp@wildsau.idv.uni-linz.ac.at>
-Leopold Ttsch <lt@toetsch.at>
-Axel Ehnert <axel@ehnert.net>
-Andrew Ip <aip@cwlinux.com>
-Robin Adams, Adams IT Services <info@usblcd.de>
-Xavier Vello <xavier66@free.fr>
-Martin Hejl (martin@hejl.de)
-Jesse Brook Kovach <jkovach@wam.umd.edu>
-Nico Wallmeier <nico.wallmeier@post.rwth-aachen.de>
-Luis Correia <lfcorreia@users.sf.net>
-Patrick Schemitz <schemitz@ekp.physik.uni-karlsruhe.de>
-Andy Baxter <andy@earthsong.free-online.co.uk>
-Thomas Siedentopf <thom-s@gmx.net>
-Markus Keil <markus_keil@t-online.de>
-Samuel Mimram <samuel.mimram@ens-lyon.fr>
-Luk Claes <infblue@users.sourceforge.net>
+Sorry, there is no AUTHORS anymore.
+Go to http://lcd4linux.bulix.org for a list of developers an contributors.
diff -urN lcd4linux-0.10.0/cfg.c lcd4linux-0.11.0-SVN/cfg.c
--- lcd4linux-0.10.0/cfg.c	2005-05-08 06:32:43.000000000 +0200
+++ lcd4linux-0.11.0-SVN/cfg.c	2008-12-31 08:05:54.000000000 +0100
@@ -1,8 +1,10 @@
-/* $Id: cfg.c,v 1.47 2005/05/08 04:32:43 reinelt Exp $^
+/* $Id: cfg.c 920 2008-12-31 06:12:29Z michael $
+ * $URL: https://ssl.bulix.org/svn/lcd4linux/trunk/cfg.c $
+ * $URL: https://ssl.bulix.org/svn/lcd4linux/trunk/cfg.c $
  *
  * config file stuff
  *
- * Copyright (C) 1999, 2000 Michael Reinelt <reinelt@eunet.at>
+ * Copyright (C) 1999, 2000 Michael Reinelt <michael@reinelt.co.at>
  * Copyright (C) 2004 The LCD4Linux Team <lcd4linux-devel@users.sourceforge.net>
  *
  * This file is part of LCD4Linux.
@@ -21,215 +23,6 @@
  * along with this program; if not, write to the Free Software
  * Foundation, Inc., 675 Mass Ave, Cambridge, MA 02139, USA.
  *
- *
- * $Log: cfg.c,v $
- * Revision 1.47  2005/05/08 04:32:43  reinelt
- * CodingStyle added and applied
- *
- * Revision 1.46  2005/05/02 05:15:46  reinelt
- * make busy-flag checking configurable for LCD-Linux driver
- *
- * Revision 1.45  2005/01/18 06:30:21  reinelt
- * added (C) to all copyright statements
- *
- * Revision 1.44  2005/01/17 06:29:24  reinelt
- * added software-controlled backlight support to HD44780
- *
- * Revision 1.43  2004/11/29 04:42:06  reinelt
- * removed the 99999 msec limit on widget update time (thanks to Petri Damsten)
- *
- * Revision 1.42  2004/06/26 12:04:59  reinelt
- *
- * uh-oh... the last CVS log message messed up things a lot...
- *
- * Revision 1.41  2004/06/26 09:27:20  reinelt
- *
- * added '-W' to CFLAGS
- * changed all C++ comments to C ones
- * cleaned up a lot of signed/unsigned mistakes
- *
- * Revision 1.40  2004/06/20 10:09:52  reinelt
- *
- * 'const'ified the whole source
- *
- * Revision 1.39  2004/03/11 06:39:58  reinelt
- * big patch from Martin:
- * - reuse filehandles
- * - memory leaks fixed
- * - earlier busy-flag checking with HD44780
- * - reuse memory for strings in RESULT and hash
- * - netdev_fast to wavid time-consuming regex
- *
- * Revision 1.38  2004/03/08 16:26:26  reinelt
- * re-introduced \nnn (octal) characters in strings
- * text widgets can have a 'update' speed of 0 which means 'never'
- * (may be used for static content)
- *
- * Revision 1.37  2004/03/06 20:31:16  reinelt
- * Complete rewrite of the evaluator to get rid of the code
- * from mark Morley (because of license issues).
- * The new Evaluator does a pre-compile of expressions, and
- * stores them in trees. Therefore it should be reasonable faster...
- *
- * Revision 1.36  2004/03/03 03:47:04  reinelt
- * big patch from Martin Hejl:
- * - use qprintf() where appropriate
- * - save CPU cycles on gettimeofday()
- * - add quit() functions to free allocated memory
- * - fixed lots of memory leaks
- *
- * Revision 1.35  2004/03/01 04:29:51  reinelt
- * cfg_number() returns -1 on error, 0 if value not found (but default val used),
- *  and 1 if value was used from the configuration.
- * HD44780 driver adopted to new cfg_number()
- * Crystalfontz 631 driver nearly finished
- *
- * Revision 1.34  2004/02/18 06:39:20  reinelt
- * T6963 driver for graphic displays finished
- *
- * Revision 1.33  2004/02/01 18:08:50  reinelt
- * removed strtok() from layout processing (took me hours to find this bug)
- * further strtok() removind should be done!
- *
- * Revision 1.32  2004/01/30 20:57:55  reinelt
- * HD44780 patch from Martin Hejl
- * dmalloc integrated
- *
- * Revision 1.31  2004/01/29 04:40:02  reinelt
- * every .c file includes "config.h" now
- *
- * Revision 1.30  2004/01/22 07:57:45  reinelt
- * several bugs fixed where segfaulting on layout>display
- * Crystalfontz driver optimized, 632 display already works
- *
- * Revision 1.29  2004/01/18 06:54:08  reinelt
- * bug in expr.c fixed (thanks to Xavier)
- * some progress with /proc/stat parsing
- *
- * Revision 1.28  2004/01/16 05:04:53  reinelt
- * started plugin proc_stat which should parse /proc/stat
- * which again is a paint in the a**
- * thinking over implementation methods of delta functions
- * (CPU load, ...)
- *
- * Revision 1.27  2004/01/14 11:33:00  reinelt
- * new plugin 'uname' which does what it's called
- * text widget nearly finished
- * first results displayed on MatrixOrbital
- *
- * Revision 1.26  2004/01/11 18:26:02  reinelt
- * further widget and layout processing
- *
- * Revision 1.25  2004/01/11 09:26:15  reinelt
- * layout starts to exist...
- *
- * Revision 1.24  2004/01/10 20:22:33  reinelt
- * added new function 'cfg_list()' (not finished yet)
- * added layout.c (will replace processor.c someday)
- * added widget_text.c (will be the first and most important widget)
- * modified lcd4linux.c so that old-style configs should work, too
- *
- * Revision 1.23  2004/01/09 04:16:06  reinelt
- * added 'section' argument to cfg_get(), but NULLed it on all calls by now.
- *
- * Revision 1.22  2004/01/08 06:00:28  reinelt
- * allowed '.' in key names
- * allowed empty section keys (not only "section anything {", but "anything {")
- *
- * Revision 1.21  2004/01/08 05:28:12  reinelt
- * Luk Claes added to AUTHORS
- * cfg: section handling ('{}') added
- *
- * Revision 1.20  2004/01/07 10:15:41  reinelt
- * small glitch in evaluator fixed
- * made config table sorted and access with bsearch(),
- * which should be much faster
- *
- * Revision 1.19  2003/12/19 05:35:14  reinelt
- * renamed 'client' to 'plugin'
- *
- * Revision 1.18  2003/10/11 06:01:52  reinelt
- *
- * renamed expression.{c,h} to client.{c,h}
- * added config file client
- * new functions 'AddNumericVariable()' and 'AddStringVariable()'
- * new parameter '-i' for interactive mode
- *
- * Revision 1.17  2003/10/05 17:58:50  reinelt
- * libtool junk; copyright messages cleaned up
- *
- * Revision 1.16  2003/09/09 06:54:43  reinelt
- * new function 'cfg_number()'
- *
- * Revision 1.15  2003/08/24 05:17:58  reinelt
- * liblcd4linux patch from Patrick Schemitz
- *
- * Revision 1.14  2003/08/14 03:47:40  reinelt
- * remove PID file if driver initialisation fails
- *
- * Revision 1.13  2003/02/22 07:53:10  reinelt
- * cfg_get(key,defval)
- *
- * Revision 1.12  2001/03/09 12:14:24  reinelt
- *
- * minor cleanups
- *
- * Revision 1.11  2001/03/08 15:25:38  ltoetsch
- * improved exec
- *
- * Revision 1.10  2001/03/07 18:10:21  ltoetsch
- * added e(x)ec commands
- *
- * Revision 1.9  2000/08/10 09:44:09  reinelt
- *
- * new debugging scheme: error(), info(), debug()
- * uses syslog if in daemon mode
- *
- * Revision 1.8  2000/07/31 06:46:35  reinelt
- *
- * eliminated some compiler warnings with glibc
- *
- * Revision 1.7  2000/04/15 11:13:54  reinelt
- *
- * added '-d' (debugging) switch
- * added several debugging messages
- * removed config entry 'Delay' for HD44780 driver
- * delay loop for HD44780 will be calibrated automatically
- *
- * Revision 1.6  2000/04/03 04:46:38  reinelt
- *
- * added '-c key=val' option
- *
- * Revision 1.5  2000/03/28 07:22:15  reinelt
- *
- * version 0.95 released
- * X11 driver up and running
- * minor bugs fixed
- *
- * Revision 1.4  2000/03/26 20:00:44  reinelt
- *
- * README.Raster added
- *
- * Revision 1.3  2000/03/26 19:03:52  reinelt
- *
- * more Pixmap renaming
- * quoting of '#' in config file
- *
- * Revision 1.2  2000/03/10 17:36:02  reinelt
- *
- * first unstable but running release
- *
- * Revision 1.1  2000/03/10 11:40:47  reinelt
- * *** empty log message ***
- *
- * Revision 1.3  2000/03/07 11:01:34  reinelt
- *
- * system.c cleanup
- *
- * Revision 1.2  2000/03/06 06:04:06  reinelt
- *
- * minor cleanups
- *
  */
 
 /* 
@@ -334,22 +127,29 @@
 
     while (isblank(*s))
 	s++;
+
     for (p = s; *p; p++) {
 	if (*p == '"')
 	    do
 		p++;
-	    while (*p && *p != '\n' && *p != '"');
+	    while (*p && *p != '\n' && *p != '\r' && *p != '"');
 	if (*p == '\'')
 	    do
 		p++;
-	    while (*p && *p != '\n' && *p != '\'');
+	    while (*p && *p != '\n' && *p != '\r' && *p != '\'');
 	if (*p == '\n' || (strip_comments && *p == '#' && (p == s || *(p - 1) != '\\'))) {
 	    *p = '\0';
 	    break;
 	}
+	if (*p == '\r' && *(p + 1) == '\n') {
+	    /* replace <CR> from DOS <CR><LF> with blank */
+	    *p = ' ';
+	}
     }
+
     for (p--; p > s && isblank(*p); p--)
 	*p = '\0';
+
     return s;
 }
 
@@ -391,7 +191,7 @@
 
 /* which if a string contains only valid chars */
 /* i.e. start with a char and contains chars and nums */
-static int validchars(const char *string)
+static int validchars(const char *string, const int numstart)
 {
     const char *c;
 
@@ -399,8 +199,11 @@
 	/* first and following chars */
 	if ((*c >= 'A' && *c <= 'Z') || (*c >= 'a' && *c <= 'z') || (*c == '_'))
 	    continue;
+	/* number as first or following char */
+	if ((numstart || c > string) && *c >= '0' && *c <= '9')
+	    continue;
 	/* only following chars */
-	if ((c > string) && ((*c >= '0' && *c <= '9') || (*c == '.') || (*c == '-')))
+	if ((c > string) && ((*c == '.') || (*c == '-')))
 	    continue;
 	return 0;
     }
@@ -452,9 +255,9 @@
 int cfg_cmd(const char *arg)
 {
     char *key, *val;
-    char buffer[256];
+    char *buffer;
 
-    strncpy(buffer, arg, sizeof(buffer));
+    buffer = strdup(arg);
     key = strip(buffer, 0);
     for (val = key; *val; val++) {
 	if (*val == '=') {
@@ -462,11 +265,19 @@
 	    break;
 	}
     }
-    if (*key == '\0' || *val == '\0')
+    if (*key == '\0' || *val == '\0') {
+	free(buffer);
 	return -1;
-    if (!validchars(key))
+    }
+
+    if (!validchars(key, 0)) {
+	free(buffer);
 	return -1;
+    }
+
     cfg_add("", key, val, 1);
+
+    free(buffer);
     return 0;
 }
 
@@ -544,6 +355,7 @@
 
     if (val != NULL)
 	return val;
+
     return (char *) defval;
 }
 
@@ -605,13 +417,13 @@
     DelResult(&result);
 
     if (*value < min) {
-	error("bad '%s' value '%d' in %s, minimum is %d", key, *value, cfg_source(), min);
+	error("bad '%s.%s' value '%d' in %s, minimum is %d", section, key, *value, cfg_source(), min);
 	*value = min;
 	return -1;
     }
 
     if (max > min && max != -1 && *value > max) {
-	error("bad '%s' value '%d' in %s, maximum is %d", key, *value, cfg_source(), max);
+	error("bad '%s.%s' value '%d' in %s, maximum is %d", section, key, *value, cfg_source(), max);
 	*value = max;
 	return -1;
     }
@@ -741,14 +553,14 @@
 	}
 
 	/* check key for valid chars */
-	if (!validchars(key)) {
+	if (!validchars(key, 0)) {
 	    error("error in config file '%s' line %d: key '%s' is invalid", file, lineno, key);
 	    error = 1;
 	    break;
 	}
 
 	/* on section-open, check value for valid chars */
-	if (section_open && !validchars(val)) {
+	if (section_open && !validchars(val, 1)) {
 	    error("error in config file '%s' line %d: section '%s' is invalid", file, lineno, val);
 	    error = 1;
 	    break;
diff -urN lcd4linux-0.10.0/cfg.h lcd4linux-0.11.0-SVN/cfg.h
--- lcd4linux-0.10.0/cfg.h	2005-05-08 06:32:43.000000000 +0200
+++ lcd4linux-0.11.0-SVN/cfg.h	2008-12-31 08:05:54.000000000 +0100
@@ -1,8 +1,9 @@
-/* $Id: cfg.h,v 1.13 2005/05/08 04:32:43 reinelt Exp $
+/* $Id: cfg.h 840 2007-09-09 12:17:42Z michael $
+ * $URL: https://ssl.bulix.org/svn/lcd4linux/trunk/cfg.h $
  *
  * config file stuff
  *
- * Copyright (C) 1999, 2000 Michael Reinelt <reinelt@eunet.at>
+ * Copyright (C) 1999, 2000 Michael Reinelt <michael@reinelt.co.at>
  * Copyright (C) 2004 The LCD4Linux Team <lcd4linux-devel@users.sourceforge.net>
  *
  * This file is part of LCD4Linux.
@@ -21,60 +22,6 @@
  * along with this program; if not, write to the Free Software
  * Foundation, Inc., 675 Mass Ave, Cambridge, MA 02139, USA.
  *
- *
- * $Log: cfg.h,v $
- * Revision 1.13  2005/05/08 04:32:43  reinelt
- * CodingStyle added and applied
- *
- * Revision 1.12  2005/01/18 06:30:21  reinelt
- * added (C) to all copyright statements
- *
- * Revision 1.11  2004/06/20 10:09:53  reinelt
- *
- * 'const'ified the whole source
- *
- * Revision 1.10  2004/01/30 20:57:55  reinelt
- * HD44780 patch from Martin Hejl
- * dmalloc integrated
- *
- * Revision 1.9  2004/01/14 11:33:00  reinelt
- * new plugin 'uname' which does what it's called
- * text widget nearly finished
- * first results displayed on MatrixOrbital
- *
- * Revision 1.8  2004/01/10 20:22:33  reinelt
- * added new function 'cfg_list()' (not finished yet)
- * added layout.c (will replace processor.c someday)
- * added widget_text.c (will be the first and most important widget)
- * modified lcd4linux.c so that old-style configs should work, too
- *
- * Revision 1.7  2004/01/09 04:16:06  reinelt
- * added 'section' argument to cfg_get(), but NULLed it on all calls by now.
- *
- * Revision 1.6  2003/10/05 17:58:50  reinelt
- * libtool junk; copyright messages cleaned up
- *
- * Revision 1.5  2003/09/09 06:54:43  reinelt
- * new function 'cfg_number()'
- *
- * Revision 1.4  2003/08/24 05:17:58  reinelt
- * liblcd4linux patch from Patrick Schemitz
- *
- * Revision 1.3  2003/02/22 07:53:10  reinelt
- * cfg_get(key,defval)
- *
- * Revision 1.2  2000/04/03 04:46:38  reinelt
- *
- * added '-c key=val' option
- *
- * Revision 1.1  2000/03/10 11:40:47  reinelt
- * *** empty log message ***
- *
- * Revision 1.2  2000/03/06 06:04:06  reinelt
- *
- * minor cleanups
- *
- *
  */
 
 #ifndef _CFG_H_
diff -urN lcd4linux-0.10.0/ChangeLog lcd4linux-0.11.0-SVN/ChangeLog
--- lcd4linux-0.10.0/ChangeLog	2005-06-11 06:13:35.000000000 +0200
+++ lcd4linux-0.11.0-SVN/ChangeLog	2009-01-14 12:19:59.000000000 +0100
@@ -1,2446 +1,4974 @@
-2005-06-10  Michael Reinelt  <reinelt@merlin.eth>
+2009-01-14  michael
 
-	* config.h.in, configure, configure.in:
-	double-check for X11 headers (AC_PATH_XTRA is buggy)
+	* [r964]
+	  add support for Dell M1730 LCD to the G15 driver by
+	  lcd4linux@hayward.uk.com
 
-	* depcomp: depcomp removed
+	* [r963]
+	  initial brightness fixed
 
-	* ChangeLog: ChangeLog
+2009-01-13  volker
 
-	* configure.in, Makefile.am, Makefile.in, configure:
-	version number set to 0.10.0
+	* [r962]
+	  indentation, svn-version
 
-	* ltmain.sh: removed ltmain.sh
+	* [r961]
+	  speedup X11 display
 
-	* libtool: removed libtool and ltmain.sh
+2009-01-13  michael
 
-2005-06-09  Michael Reinelt  <reinelt@merlin.eth>
+	* [r960]
+	  new example for X11 config
 
-	* drv_HD44780.c, drv_M50530.c, lcd4linux.conf.sample:
-	M50530 fixes (many thanks to Szymon Bieganski)
+	* [r959]
+	  heavy X11 reorganization to (hopefully) finally fix Tickets #141
+	  and #117
 
-2005-06-06  Michael Reinelt  <reinelt@merlin.eth>
+	* [r958]
+	  list sub-drivers for serdisplib without -v
 
-	* lcd4linux.conf.sample, plugin_mysql.c:
-	two bugs in plugin_mysql.c fixed
+	* [r957]
+	  moved 'print list of drivers and plugins' to the end of configure
 
-2005-06-03  Michael Reinelt  <reinelt@merlin.eth>
+2009-01-12  michux
 
-	* configure.in, python.m4, configure:
-	hopefully solved the AM_PYTHON_PATH issue finally
+	* [r956]
+	  update copyright
 
-	* configure.in, python.m4, configure: renamed AM_PYTHON to MY_PYTHON...
+2009-01-12  volker
 
-2005-06-01  Michael Reinelt  <reinelt@merlin.eth>
+	* [r955]
+	  additional verbose messages
 
-	* drv_generic_i2c.c: ifdef'ed unused function to avoid compiler warning
+2009-01-12  michux
 
-	* configure.in, curses.m4, plugins.m4, configure:
-	--with-python added to configure
+	* [r954]
+	  fix some compiler warnings
 
-	* lcd4linux.conf.sample, lcd4linux_i2c.h, aclocal.m4, config.h.in, configure:
-	removed ^M from lcd4linux_i2c.h; indent.sh run
+2009-01-11  michux
 
-2005-06-01  pk_richman  <pk_richman@merlin.eth>
+	* [r953]
+	  plugin_fifo: fix compile warnings
 
-	* drv_HD44780.c: marked unused parameters
+	* [r952]
+	  drv_st2205u: add verbose error message
 
-2005-05-31  lfcorreia  <lfcorreia@merlin.eth>
+2009-01-09  volker
 
-	* drv_generic_i2c.h, AUTHORS, debian/copyright: fix my email address
+	* [r951]
+	  version of linked serdisplib in long verbose output
 
-	* drv_HD44780.c: fix typo
+2009-01-08  michael
 
-	* drv_HD44780.c: fix my email address
+	* [r950]
+	  hhdtemp plugin fixed
 
-	* configure.in: replace the accidently deleted Python detection code
+2009-01-06  michael
 
-	* configure.in, drivers.m4, drv_HD44780.c, drv_generic_i2c.c, drv_generic_i2c.h, lcd4linux_i2c.h, config.h.in, configure:
-	new file: lcd4linux_i2c.h
-	avoid the problems detecting the proper I2C kernel include files
+	* [r949]
+	  hddtemp autconf bug fixed
 
-	rearrange all the other autoconf stuff to remove I2C detection
+	* [r948]
+	  compiler warnings fixed
 
-	new method by Paul Kamphuis to write to the I2C device
+	* [r947]
+	  indentation
 
-2005-05-28  Michael Reinelt  <reinelt@merlin.eth>
+	* [r946]
+	  unused array 'tokenNames' removed
 
-	* plugins.m4: fixed plugins.m4 bug found by Martin
+	* [r945]
+	  compiler warning removed
 
-	* drv_serdisplib.c, lcd4linux.conf.sample: serdisplib cosmetics
+	* [r944]
+	  initialize plugin on first use
 
-2005-05-13  Michael Reinelt  <reinelt@merlin.eth>
+	* [r943]
+	  indentation
 
-	* ChangeLog: ChangeLog updated
+	* [r942]
+	  initialize fifo on first use
 
-	* configure.in, config.h.in, configure, Makefile.am, Makefile.in:
-	added drv_LCDLinux.h to extra_sources
+	* [r941]
+	  cosmetics
 
-2005-05-12  Michael Reinelt  <reinelt@merlin.ethnet>
+2009-01-04  michael
 
-	* drv_serdisplib.c, indent.sh: plugins for serdisplib driver
+	* [r940]
+	  new string operators eq ne gt ge lt le
 
-	* drv_serdisplib.c: serdisplib GET_VERSION_MAJOR macro
+	* [r939]
+	  indentation
 
-2005-05-11  Michael Reinelt  <reinelt@merlin.ethnet>
+	* [r938]
+	  typo fixed
 
-	* drv_serdisplib.c: small serdisplib bugs fixed
+	* [r937]
+	  disable unimplemented ioctls
 
-2005-05-10  Michael Reinelt  <reinelt@merlin.ethnet>
+2009-01-01  michael
 
-	* configure.in, drivers.m4, drv.c, drv_serdisplib.c, lcd4linux.conf.sample, Makefile.am, Makefile.in, config.h.in, configure:
-	added serdisplib driver
+	* [r936]
+	  distcheck bugs fixed
 
-2005-05-08  Michael Reinelt  <reinelt@merlin.ethnet>
+	* [r935]
+	  button debugging changed
 
-	* plugin_proc_stat.c, plugin_python.c, plugin_sample.c, plugin_seti.c, plugin_statfs.c, plugin_string.c, plugin_test.c, plugin_time.c, plugin_uname.c, plugin_uptime.c, plugin_wireless.c, plugin_xmms.c, qprintf.c, thread.c, thread.h, timer.c, timer.h, udelay.c, udelay.h, widget.c, widget.h, widget_bar.c, widget_bar.h, widget_icon.c, widget_icon.h, widget_text.c, widget_text.h, drv_BeckmannEgle.c, drv_Crystalfontz.c, drv_Curses.c, drv_Cwlinux.c, drv_HD44780.c, drv_Image.c, drv_LCDLinux.c, drv_LCDLinux.h, drv_LCDTerm.c, drv_M50530.c, drv_MatrixOrbital.c, drv_MilfordInstruments.c, drv_NULL.c, drv_Noritake.c, drv_RouterBoard.c, drv_SimpleLCD.c, drv_T6963.c, drv_Trefon.c, drv_USBLCD.c, drv_X11.c, drv_generic_graphic.c, drv_generic_graphic.h, drv_generic_i2c.c, drv_generic_i2c.h, drv_generic_parport.c, drv_generic_parport.h, drv_generic_serial.c, drv_generic_serial.h, drv_generic_text.c, drv_generic_text.h, evaluator.c, evaluator.h, font_6x8.h, hash.c, hash.h, indent.sh, layout.c, lcd4linux.c, pid.c, pid.h, plugin.c, plugin.h, plugin_apm.c, plugin_cfg.c, plugin_cpuinfo.c, plugin_diskstats.c, plugin_dvb.c, plugin_exec.c, plugin_i2c_sensors.c, plugin_imon.c, plugin_isdn.c, plugin_loadavg.c, plugin_math.c, plugin_meminfo.c, plugin_mysql.c, plugin_netdev.c, plugin_pop3.c, plugin_ppp.c, CodingStyle, cfg.c, cfg.h, configure, debug.c, debug.h, drv.c, drv.h, drv_BWCT.c:
-	CodingStyle added and applied
+	* [r934]
+	  widget_bar scale debugging changed
 
-2005-05-06  Michael Reinelt  <reinelt@merlin.ethnet>
+2008-12-31  michux
 
-	* python.m4: python2.4 added to python.m4
+	* [r933]
+	  add buttons to X11 sample conf
 
-	* drv_generic_text.c, widget_bar.c, widget_bar.h:
-	hollow bar patch from geronet
+2008-12-31  michael
 
-2005-05-05  Michael Reinelt  <reinelt@merlin.ethnet>
+	* [r932]
+	  clear pixel to BG_COL (Ticket #117)
 
-	* drv_HD44780.c, drv_M50530.c, drv_Noritake.c, drv_T6963.c, drv_generic_parport.c, lcd4linux.conf.sample:
-	changed SELECT to SLCTIN
+	* [r931]
+	  version bumped to 0.11.0
 
-2005-05-04  obconseil  <obconseil@merlin.ethnet>
+	* [r930]
+	  netinfo plugin added to smoketest
 
-	* drv_Noritake.c:
-	Driver modified according to Michels's recommendations :
+	* [r929]
+	  ported r847 (new Display CW12832 128x32) from volker_dev
 
-	- Suppressed linux/parport.h depandancy. It was not needed anyway.
-	- Compile-time disable the wait_busy polling function, replaced with a time wait.
-	- Replaced the hardwire_* calls by their wire_* equivalent, to adapt other wirings.
-	- Created a "Models" structure, containing parameters for the display.
-	- Other cleanups, to remove compile-time warnings.
+	* [r928]
+	  ported r846 from volker_dev
 
-2005-05-04  Michael Reinelt  <reinelt@merlin.ethnet>
+	* [r927]
+	  ported r839 from volker_dev
 
-	* drv_generic_parport.c, drv_generic_parport.h:
-	parport_wire_status() added
+	* [r926]
+	  ported r838 from volker_dev
 
-	* drivers.m4, drv.c, drv_Noritake.c, Makefile.am, Makefile.in, config.h.in, configure:
-	Noritake driver added
+	* [r925]
+	  ported r837 from volker_dev
 
-	* plugin_python.c: * replaced fprintf(stderr,...  with error()
-	* corrected a "dangling reference" memory problem
-	* removed some PyErr_Print() spam
-	* fixed a segmentation fault that occured when python module was not
-	found
-	* improved error messages
+	* [r924]
+	  ported r835 from volker_dev
 
-2005-05-03  Michael Reinelt  <reinelt@merlin.ethnet>
+	* [r923]
+	  ported r834 from volker_dev
 
-	* drivers.m4, plugin_python.c, plugins.m4, Makefile.am, Makefile.in, configure:
-	rearranged autoconf a bit,
-	libX11 will be linked only if really needed (i.e. when the X11 driver has been selected)
-	plugin_python filled with life
+	* [r922]
+	  r828: 'additional verbose and info messages' ported from
+	  volker_dev
 
-2005-05-02  Michael Reinelt  <reinelt@merlin.ethnet>
+	* [r921]
+	  includes for umask() ported from volker_dev (r827)
 
-	* Makefile.am, Makefile.in, config.h.in, configure, configure.in, plugin.c, plugin_python.c, plugins.m4, python.m4:
-	preparations for python bindings and python plugin
+	* [r920]
+	  handle config files with <CR><LF> (DOS line ending) ported from
+	  volker_dev (r826)
 
-	* cfg.c, drv_LCDLinux.c, drv_LCDLinux.h, lcd4linux.conf.sample:
-	make busy-flag checking configurable for LCD-Linux driver
+	* [r919]
+	  netinfo plugin ported from volker_dev (r823)
 
-2005-04-30  Michael Reinelt  <reinelt@merlin.ethnet>
+	* [r918]
+	  format characters in qprintf() with optional length (r821) ported
+	  from volker_dev
 
-	* drv_LCDLinux.c, drv_LCDLinux.h, lcd4linux.conf.sample:
-	LCD-Linux display size set up from lcd4linux.conf
+	* [r917]
+	  short circuit evaluation ported from volker_dev (r820,r822,r824)
 
-2005-04-24  Michael Reinelt  <reinelt@merlin.ethnet>
+	* [r916]
+	  Fixes a buffer underrun error and possible array index issues by
+	  mcarey@...
 
-	* drv_Trefon.c, lcd4linux.conf.sample: Trefon Backlight added
+2008-12-27  michael
 
-	* ChangeLog: Changelog updated
+	* [r915]
+	  ported r819 from volker_dev
 
-	* Makefile.am, Makefile.in, config.h.in, configure, drivers.m4, drv.c, drv_Trefon.c, drv_USBLCD.c, lcd4linux.conf.sample:
-	driver for TREFON USB LCD's added
+	* [r914]
+	  ported and modified r818 from volker_dev
 
-2005-04-20  Michael Reinelt  <reinelt@merlin.ethnet>
+	* [r913]
+	  port r817 from volker_dev
 
-	* drv_SimpleLCD.c:
-	Changed the code to add some VT100-compatible control sequences (see the comments above).
-	A configfile boolean option 'VT100_Support' (default to 1) indicate if the display in
-	used support these control-sequences or not.
+	* [r912]
+	  ported (modified) r815 from voker_dev
 
-2005-04-09  Michael Reinelt  <reinelt@merlin.ethnet>
+2008-12-24  michael
 
-	* drv_LCDLinux.c, drv_LCDLinux.h:
-	updated LCD-Linux driver to version 0.8.8
+	* [r911]
+	  cleanup & cosmetics
 
-2005-04-05  Michael Reinelt  <reinelt@merlin.ethnet>
+	* [r910]
+	  driver for the PHAnderson serial-to-HD44780 adapter boards by
+	  Nicolas Weill
 
-	* configure.in, plugins.m4, configure: AC_CHECK_HEADERS corrected
+	* [r909]
+	  w1retap plugin by Jonathan Hudson
 
-	* configure.in, drv_generic_i2c.c, lcd4linux.conf.sample, configure:
-	i2c patch from Paul (still does not work here :-(
+	* [r908]
+	  Enables/controls the backlight on the Pertelian LCD device by
+	  Jonathan Hudson
 
-	* plugin_math.c: ceil/floor patch from Maxime
+2008-12-23  michael
 
-2005-04-04  nicowallmeier  <nicowallmeier@merlin.ethnet>
+	* [r907]
+	  hddtemp plugin from Scott Bronson
 
-	* plugin_imon.c: to be compatible with gcc 2.95
+	* [r906]
+	  keypad bug fixed
 
-2005-04-03  Michael Reinelt  <reinelt@merlin.ethnet>
+	* [r905]
+	  patch from a.nielsen: inverted parport signals, support GPI on
+	  HD44780
 
-	* configure.in, plugin.c, plugin_statfs.c, plugins.m4, config.h.in, configure, Makefile.am, Makefile.in:
-	added statfs plugin
+	* [r904]
+	  indent run
 
-2005-04-02  Michael Reinelt  <reinelt@merlin.ethnet>
+2008-11-25  michux
 
-	* drv_Crystalfontz.c, drv_SimpleLCD.c, drv_USBLCD.c:
-	fixed gcc4 warnings about signed/unsigned mismatches
+	* [r903]
+	  fix lcd4linux driver for multible onboard controllers
 
-2005-04-01  Michael Reinelt  <reinelt@merlin.ethnet>
+2008-11-23  michux
 
-	* lcd4linux.conf.sample, plugin_i2c_sensors.c, plugin_imon.c, plugin_mysql.c, plugin_pop3.c:
-	moved plugin init stuff to a seperate function called on first use
+	* [r902]
+	  fix automake - check for libftdi
 
-2005-03-30  Michael Reinelt  <reinelt@merlin.ethnet>
+2008-11-22  michux
 
-	* evaluator.c, lcd4linux.c, plugin_cfg.c:
-	Evaluator speedup: use bsearch for finding functions and variables
+	* [r901]
+	  update button_exec plugin - fix segfault
 
-2005-03-28  Michael Reinelt  <reinelt@merlin.ethnet>
+	* [r900]
+	  update fifo plugin - untested
 
-	* drv_HD44780.c: HD44780 multiple displays patch from geronet
+2008-10-07  bwalle
 
-	* configure.in, drivers.m4, drv_HD44780.c, drv_generic_i2c.c, drv_generic_i2c.h, config.h.in, configure, Makefile.in, Makefile.am:
-	HD44780/I2C patch from Luis merged (still does not work for me)
+	* [r899]
+	  Replace write to external variable usb_debug by calling
+	  usb_set_debug().
+	  This fixes build on openSUSE Factory.
 
-2005-03-25  Michael Reinelt  <reinelt@merlin.ethnet>
+2008-10-06  michael
 
-	* drv_HD44780.c: HD44780 Backlight fixed (thanks to geronet)
+	* [r898]
+	  adding GPI to picoLCD for reading button events by Igor Mammedov
+	  <niallain@gmail.com>
 
-2005-03-23  Michael Reinelt  <reinelt@merlin.ethnet>
+	* [r897]
+	  properties fixed
 
-	* drv_Crystalfontz.c:
-	fixed some signed/unsigned char mismatches in the Crystalfontz driver (ticket #12)
+2008-10-05  bwalle
 
-2005-02-24  Michael Reinelt  <reinelt@merlin.ethnet>
+	* [r896]
+	  Rebuild auto-generated autoconf stuff due to last change in
+	  drivers.m4.
 
-	* ChangeLog: ChangeLog
+	* [r895]
+	  Add 'ULA200' driver when --with-drivers=all is specified
 
-	* drivers.m4, drv.c, drv_Crystalfontz.c, drv_LCDLinux.c, drv_SimpleLCD.c, drv_generic_text.c, lcd4linux.conf.sample, config.h.in, configure, Makefile.am, Makefile.in:
-	SimpleLCD driver added
+2008-09-14  michael
 
-	* drv_LCDLinux.c: LCD-Linux driver GOTO_COST corrected
+	* [r894]
+	  strftime_tz patch from Bernhard Walle
 
-2005-01-30  Michael Reinelt  <reinelt@merlin.ethnet>
+2008-09-08  michael
 
-	* drv.c, drv_LCDLinux.c, drv_USBLCD.c, lcd4linux.conf.sample:
-	driver for LCD-Linux finished
+	* [r893]
+	  strftime_tz() plugin by Bernhard Walle
 
-2005-01-29  Michael Reinelt  <reinelt@merlin.ethnet>
+2008-09-03  michael
 
-	* drv_HD44780.c: minor HD44780 cleanups
+	* [r892]
+	  ULA200 driver by Bernhard Walle
 
-2005-01-22  Michael Reinelt  <reinelt@merlin.ethnet>
+	* [r891]
+	  indent
 
-	* Makefile.am, Makefile.in, config.h.in, configure, drivers.m4, drv.c, drv_LCDLinux.c, drv_LCDTerm.c, lcd4linux.conf.sample:
-	LCD-Linux driver added
+2008-08-31  sonic74
 
-	* drv_MatrixOrbital.c: MatrixOrbital backlight micro-fix
+	* [r890]
+	  Increased the maximum bps to 230400, if defined in <termios.h>.
 
-2005-01-18  Michael Reinelt  <reinelt@merlin.ethnet>
+2008-08-27  sonic74
 
-	* thread.h, timer.c, timer.h, udelay.c, udelay.h, widget.c, widget.h, widget_bar.c, widget_bar.h, widget_icon.c, widget_icon.h, widget_text.c, widget_text.h, drv_HD44780.c, drv_Image.c, drv_LCDTerm.c, drv_M50530.c, drv_MatrixOrbital.c, drv_MilfordInstruments.c, drv_NULL.c, drv_RouterBoard.c, drv_T6963.c, drv_USBLCD.c, drv_X11.c, drv_generic_graphic.c, drv_generic_graphic.h, drv_generic_parport.c, drv_generic_parport.h, drv_generic_serial.c, drv_generic_serial.h, drv_generic_text.c, drv_generic_text.h, evaluator.c, evaluator.h, font_6x8.h, hash.c, hash.h, layout.c, layout.h, lcd4linux.c, lcd4linux.xpm, pid.c, pid.h, plugin.c, plugin.h, plugin_apm.c, plugin_cfg.c, plugin_cpuinfo.c, plugin_diskstats.c, plugin_dvb.c, plugin_exec.c, plugin_i2c_sensors.c, plugin_imon.c, plugin_isdn.c, plugin_loadavg.c, plugin_math.c, plugin_meminfo.c, plugin_mysql.c, plugin_netdev.c, plugin_pop3.c, plugin_ppp.c, plugin_proc_stat.c, plugin_sample.c, plugin_seti.c, plugin_string.c, plugin_test.c, plugin_time.c, plugin_uname.c, plugin_uptime.c, plugin_wireless.c, plugin_xmms.c, plugins.m4, qprintf.c, qprintf.h, thread.c, configure.in, debug.c, debug.h, drivers.m4, drv.c, drv.h, drv_BWCT.c, drv_BeckmannEgle.c, drv_Crystalfontz.c, drv_Curses.c, drv_Cwlinux.c, cfg.c, cfg.h, configure:
-	added (C) to all copyright statements
+	* [r889]
+	  
 
-2005-01-17  Michael Reinelt  <reinelt@merlin.ethnet>
+2008-08-27  michael
 
-	* drv_HD44780.c: info about backlight and brightness
+	* [r888]
+	  D4D updates by Sven
 
-	* lcd4linux.conf.sample, cfg.c, drv_HD44780.c:
-	added software-controlled backlight support to HD44780
+2008-08-03  michael
 
-2005-01-15  Michael Reinelt  <reinelt@merlin.ethnet>
+	* [r887]
+	  driver for 4D Systems serial displays by Sven Killig
 
-	* drv_LCDTerm.c: LCDTerm driver added, take 2
+	* [r886]
+	  signed/unsigned mismatch
 
-	* lcd4linux.conf.sample: LCDTerm section added to lcd4linux.conf.sample
+2008-07-26  michux
 
-	* configure.in, drivers.m4, drv.c, lcd4linux.conf.sample, Makefile.am, Makefile.in, config.h.in, configure:
-	LCDTerm driver added
+	* [r885]
+	  added command functions
 
-2005-01-11  Michael Reinelt  <reinelt@merlin.ethnet>
+2008-07-15  michael
 
-	* lcd4linux.conf.sample: further changes to lcd4linux.conf.sample
+	* [r884]
+	  added IRLCD driver by Jean-Philippe Civade
 
-	* lcd4linux.conf.sample, plugin_proc_stat.c:
-	changes to lcd4linux.conf.sample
+	* [r883]
+	  'autoreconf -f -i' run & config.rpath added
 
-2005-01-09  Michael Reinelt  <reinelt@merlin.ethnet>
+	* [r882]
+	  forgot to add drv_picoLCDGraphic.c :-(
 
-	* ChangeLog: ChangeLog updated
+	* [r881]
+	  picoLCDGraphic driver by Nicu Pavel added
 
-	* configure.in, drv_generic_graphic.c, drv_generic_text.c, plugin_uname.c, CREDITS, README, configure:
-	small type in plugin_uname fixed
-	new homepage lcd4linux.bulix.org
+	* [r880]
+	  widget_keypad.h added to drv_HD44780
 
-2005-01-06  Michael Reinelt  <reinelt@merlin.ethnet>
+	* [r879]
+	  indent run
 
-	* drv_generic_parport.c, lcd4linux.conf.sample, drv_M50530.c:
-	M50530 fixes
+	* [r878]
+	  automake-1.10.1
 
-2004-12-22  Michael Reinelt  <reinelt@merlin.ethnet>
+2008-04-15  michux
 
-	* configure.in, drv_T6963.c, drv_USBLCD.c, configure:
-	T6963 fix for displays > 8 rows
+	* [r877]
+	  forgot include
 
-2004-11-30  Michael Reinelt  <reinelt@merlin.ethnet>
+	* [r876]
+	  add signal handler, improve error check
 
-	* drv_HD44780.c: removed compiler warnings for deactivated i2c bus
+2008-04-14  michux
 
-2004-11-29  Michael Reinelt  <reinelt@merlin.ethnet>
+	* [r875]
+	  minor update
 
-	* drv_Image.c, drv_X11.c, widget_bar.c, widget_text.c, cfg.c:
-	removed the 99999 msec limit on widget update time (thanks to Petri Damsten)
+2008-04-12  michux
 
-2004-11-28  Michael Reinelt  <reinelt@merlin.ethnet>
+	* [r874]
+	  Makefiles again, this time libiconv stuff is fixed
 
-	* drv_Cwlinux.c, drv_generic_text.c, drv_generic_text.h, lcd4linux.conf.sample, widget_icon.c:
-	Cwlinux fixes (invalidation of user-defined chars)
+	* [r873]
+	  fix error, introduced in r857
 
-2004-10-17  Michael Reinelt  <reinelt@merlin.ethnet>
+	* [r872]
+	  update Makefiles
 
-	* drv_HD44780.c, drv_generic_parport.h, lcd4linux.conf.sample:
-	I2C support for HD44780 displays by Luis (does not work by now)
+	* [r871]
+	  clean up
 
-2004-10-02  Michael Reinelt  <reinelt@merlin.ethnet>
+2008-04-10  michux
 
-	* drivers.m4, drv_USBLCD.c, lcd4linux.conf.sample, configure:
-	USBLCD driver modified to use libusb
+	* [r870]
+	  Add the year 2008 to the copyright
 
-2004-09-24  Michael Reinelt  <reinelt@merlin.ethnet>
+	* [r869]
+	  Add basic FIFO plugin
 
-	* configure.in, drivers.m4, drv.c, drv_BWCT.c, drv_USBLCD.c, lcd4linux.c, lcd4linux.conf.sample, plugin_exec.c, config.h.in, configure, Makefile.am, Makefile.in:
-	new driver for the BWCT USB LCD interface board.
+2008-04-04  michux
 
-2004-09-19  Michael Reinelt  <reinelt@merlin.ethnet>
+	* [r868]
+	  fixed autoconf
 
-	* drv_HD44780.c, lcd4linux.conf.sample, timer.c:
-	HD44780 busy flag checking improved: fall back to busy-waiting if too many errors occur
+	* [r867]
+	  update autoconf
 
-2004-09-18  Michael Reinelt  <reinelt@merlin.ethnet>
+	* [r866]
+	  Add asterisk plugin, thanks to mcarey@yostengineering.com
 
-	* drv_HD44780.c, drv_generic_parport.c, drv_generic_parport.h, lcd4linux.conf.sample:
-	even more HD44780 cleanups, hardwiring for LCM-162
+2008-04-03  michux
 
-	* drv_HD44780.c: more parport/i2c cleanups
+	* [r865]
+	  fix typo, close #114
 
-	* drv_HD44780.c, drv_generic_parport.c, lcd4linux.conf.sample, udelay.c:
-	HD44780 cleanup and prepararation for I2C backend
-	LCM-162 submodel framework
+	* [r864]
+	  update charset for Crystalfontz Model 632 and 634
 
-	* drv_HD44780.c, drv_generic_parport.c, drv_generic_parport.h, lcd4linux.conf.sample:
-	drv_generic_parport_status() to read status lines
+2008-03-05  michux
 
-2004-08-30  rjoco77  <rjoco77@merlin.ethnet>
+	* [r863]
+	  improve error messages
 
-	* drv_RouterBoard.c:  * Added backlight update immediatelly
+2008-03-03  michux
 
-2004-08-29  Michael Reinelt  <reinelt@merlin.ethnet>
+	* [r862]
+	  reformat plugin_mpd - use c style comments
 
-	* drv_RouterBoard.c:
-	Patch from Joco: Make RouterBoard Backlight configurable
+	* [r861]
+	  correct code format (indent)
 
-	* drivers.m4, drv.c, drv_HD44780.c, drv_RouterBoard.c, lcd4linux.conf.sample, Makefile.am, Makefile.in, config.h.in, configure:
-	added RouterBoard driver
+	* [r860]
+	  correct code format (indent)
 
-2004-07-14  Michael Reinelt  <reinelt@merlin.ethnet>
+	* [r859]
+	  new plugin: button_exec by Wolfgang Henerbichler
 
-	* lcd4linux.conf.sample, drv_BeckmannEgle.c:
-	Beckmann+Egle fix
-	added smaple widget for the PPP plugin
+	* [r858]
+	  add new driver (st2205) by Jeroen/Sprite_tm
 
-2004-06-29  Michael Reinelt  <reinelt@merlin.ethnet>
+	* [r857]
+	  new plugin: button_exec by Wolfgang Henerbichler
 
-	* drv_BeckmannEgle.c:
-	B+E enhanced port detection
+	* [r856]
+	  add keypad support for module lcm162
 
-2004-06-26  Michael Reinelt  <reinelt@merlin.ethnet>
+	* [r855]
+	  add new driver (st2205) by Jeroen/Sprite_tm
 
-	* plugin_cpuinfo.c, plugin_diskstats.c, plugin_dvb.c, plugin_exec.c, plugin_i2c_sensors.c, plugin_imon.c, plugin_isdn.c, plugin_loadavg.c, plugin_math.c, plugin_meminfo.c, plugin_netdev.c, plugin_pop3.c, plugin_ppp.c, plugin_proc_stat.c, plugin_sample.c, plugin_seti.c, plugin_string.c, plugin_test.c, plugin_time.c, plugin_uptime.c, plugin_wireless.c, plugin_xmms.c, qprintf.c, qprintf.h, timer.c, udelay.h, widget.c, widget.h, widget_bar.c, widget_bar.h, widget_icon.c, widget_icon.h, widget_text.c, widget_text.h, cfg.c, debug.c, drv.c, drv.h, drv_BeckmannEgle.c, drv_Crystalfontz.c, drv_Curses.c, drv_Cwlinux.c, drv_HD44780.c, drv_Image.c, drv_M50530.c, drv_MatrixOrbital.c, drv_MilfordInstruments.c, drv_NULL.c, drv_T6963.c, drv_USBLCD.c, drv_X11.c, drv_generic_graphic.c, drv_generic_graphic.h, drv_generic_parport.c, drv_generic_parport.h, drv_generic_serial.c, drv_generic_serial.h, drv_generic_text.c, drv_generic_text.h, evaluator.c, evaluator.h, hash.c, hash.h, layout.c, lcd4linux.c, pid.c, plugin.c, plugin_apm.c, plugin_cfg.c:
-	uh-oh... the last CVS log message messed up things a lot...
+2008-02-27  michux
 
-	* drv_MilfordInstruments.c, drv_NULL.c, drv_T6963.c, drv_USBLCD.c, drv_X11.c, drv_generic_graphic.c, drv_generic_graphic.h, drv_generic_parport.c, drv_generic_parport.h, drv_generic_serial.c, drv_generic_serial.h, drv_generic_text.c, drv_generic_text.h, evaluator.c, evaluator.h, hash.c, hash.h, layout.c, lcd4linux.c, pid.c, plugin.c, plugin_apm.c, plugin_cfg.c, plugin_cpuinfo.c, plugin_diskstats.c, plugin_dvb.c, plugin_exec.c, plugin_i2c_sensors.c, plugin_imon.c, plugin_isdn.c, plugin_loadavg.c, plugin_math.c, plugin_meminfo.c, plugin_netdev.c, plugin_pop3.c, plugin_ppp.c, plugin_proc_stat.c, plugin_sample.c, plugin_seti.c, plugin_string.c, plugin_test.c, plugin_time.c, plugin_uptime.c, plugin_wireless.c, plugin_xmms.c, qprintf.c, qprintf.h, timer.c, udelay.h, widget.c, widget.h, widget_bar.c, widget_bar.h, widget_icon.c, widget_icon.h, widget_text.c, widget_text.h, Makefile.am, Makefile.in, cfg.c, debug.c, drv.c, drv.h, drv_BeckmannEgle.c, drv_Crystalfontz.c, drv_Curses.c, drv_Cwlinux.c, drv_HD44780.c, drv_Image.c, drv_M50530.c, drv_MatrixOrbital.c:
-	added '-W' to CFLAGS
-	changed all C++ comments to C ones ('//' => '/* */')
-	cleaned up a lot of signed/unsigned mistakes
+	* [r854]
+	  add signal handler to plugin_mpd
 
-	* drv_BeckmannEgle.c, drv_MatrixOrbital.c, drv_USBLCD.c, drv_generic_serial.c, drv_generic_text.c, lcd4linux.conf.sample, Makefile.in:
-	support for Beckmann+Egle Compact Terminals
-	some mostly cosmetic changes in the MatrixOrbital and USBLCD driver
-	added debugging to the generic serial driver
-	fixed a bug in the generic text driver where icons could be drawn outside
-	the display bounds
+	* [r853]
+	  plugin_mpd, update to v0.81, fix connection issues
 
-2004-06-24  nicowallmeier  <nicowallmeier@merlin.ethnet>
+2008-02-25  michux
 
-	* plugin_imon.c: minor bugfix
+	* [r852]
+	  update mpd plugin to v0.8 - makefile needs some work now
 
-2004-06-20  Michael Reinelt  <reinelt@merlin.ethnet>
+2008-01-28  michux
 
-	* ChangeLog:
-	ChangeLog updated
+	* [r851]
+	  disable default emulator code
 
-	* drv_generic_text.h, evaluator.c, evaluator.h, hash.c, hash.h, layout.c, layout.h, plugin_cfg.c, plugin_exec.c, plugin_i2c_sensors.c, plugin_imon.c, plugin_isdn.c, plugin_proc_stat.c, plugin_uptime.c, plugin_wireless.c, qprintf.c, thread.c, thread.h, timer.c, timer.h, udelay.c, udelay.h, widget.c, widget.h, widget_icon.c, drv_generic_graphic.c, drv_generic_graphic.h, drv_generic_parport.c, drv_generic_parport.h, drv_generic_serial.c, drv_generic_serial.h, drv_generic_text.c, debug.c, debug.h, drv.c, drv.h, drv_BeckmannEgle.c, drv_Crystalfontz.c, drv_Curses.c, drv_Cwlinux.c, drv_HD44780.c, drv_Image.c, drv_M50530.c, drv_MatrixOrbital.c, drv_MilfordInstruments.c, drv_NULL.c, drv_T6963.c, drv_USBLCD.c, drv_X11.c, cfg.h, cfg.c:
-	'const'ified the whole source
+	* [r850]
+	  minor updates
 
-2004-06-19  Michael Reinelt  <reinelt@merlin.ethnet>
+	* [r849]
+	  added pingpong scrolling
 
-	* drv_Image.c, drv_USBLCD.c:
-	compiler warning in image driver fixed
-	bar bug in USBLCD driver fixed
+2008-01-24  michux
 
-2004-06-17  Michael Reinelt  <reinelt@merlin.ethnet>
+	* [r848]
+	  
 
-	* plugin_diskstats.c, plugin_netdev.c, lcd4linux.conf.sample:
-	changed plugin_netdev to use the new fast hash model
+2007-10-17  volker
 
-	* hash.c, hash.h, lcd4linux.conf.sample, plugin_apm.c, plugin_cpuinfo.c, plugin_diskstats.c, plugin_dvb.c, plugin_exec.c, plugin_i2c_sensors.c, plugin_imon.c, plugin_isdn.c, plugin_meminfo.c, plugin_netdev.c, plugin_ppp.c, plugin_proc_stat.c, plugin_seti.c, plugin_wireless.c, plugin_xmms.c, drv_T6963.c:
-	hash handling rewritten to solve performance issues
+	* [r847]
+	  added new display 128x32 (CW12832)
 
-2004-06-13  Michael Reinelt  <reinelt@merlin.ethnet>
+	* [r846]
+	  info about property change
 
-	* hash.c, hash.h, lcd4linux.conf.sample:
-	debug widgets changed (thanks to Andy Baxter)
+2007-10-03  michael
 
-2004-06-09  Michael Reinelt  <reinelt@merlin.ethnet>
+	* [r845]
+	  automatic marquee patch from Manuel Grot
 
-	* drv_T6963.c, drv_generic_graphic.c, lcd4linux.conf.sample:
-	splash screen for T6963 driver
+2007-10-01  michael
 
-2004-06-08  Michael Reinelt  <reinelt@merlin.ethnet>
+	* [r844]
+	  RDTSC delay and inclusion of asm/msr.h removed
 
-	* Makefile.in, drv_X11.c, drv_generic_graphic.c, drv_generic_graphic.h, lcd4linux.conf.sample:
-	splash screen for X11 driver (and generic graphic driver)
+	* [r843]
+	  driver for Pertelian display by Andy Powell
 
-	* aclocal.m4, bootstrap, config.h.in, configure, configure.in, Makefile.in:
-	autoconf/automake updates
+2007-09-15  michael
 
-2004-06-07  Michael Reinelt  <reinelt@merlin.ethnet>
+	* [r842]
+	  GPS plugin V0.3 by michu
 
-	* lcd4linux.conf.sample:
-	sample debugging widgets added
+	* [r841]
+	  GPS plugin V0.2 by michu
 
-	* Makefile.am, Makefile.in, lcd4linux.conf.sample, plugin.c, plugin_test.c:
-	added test plugin from Andy Baxter
+2007-09-09  michael
 
-2004-06-06  Michael Reinelt  <reinelt@merlin.ethnet>
+	* [r840]
+	  email address changed
 
-	* drv.c, drv.h, drv_BeckmannEgle.c, drv_Crystalfontz.c, drv_Curses.c, drv_Cwlinux.c, drv_HD44780.c, drv_Image.c, drv_M50530.c, drv_MatrixOrbital.c, drv_MilfordInstruments.c, drv_NULL.c, drv_T6963.c, drv_USBLCD.c, drv_X11.c, lcd4linux.c:
-	do not display end splash screen if quiet=1
+2007-08-25  volker
 
-2004-06-05  Michael Reinelt  <reinelt@merlin.ethnet>
+	* [r839]
+	  additional information about decision which plugin and drivers
+	  are included via configure
 
-	* drv_Cwlinux.c, drv_USBLCD.c, plugin_i2c_sensors.c:
-	Cwlinux splash screen fixed
-	USBLCD splash screen fixed
-	plugin_i2c qprintf("%f") replaced with snprintf()
+2007-08-23  volker
 
-	* drv_MilfordInstruments.c, drv_USBLCD.c, drv_generic_text.c, drv_generic_text.h, drv_BeckmannEgle.c, drv_Crystalfontz.c, drv_Curses.c, drv_Cwlinux.c, drv_HD44780.c, drv_M50530.c, drv_MatrixOrbital.c:
-	chancged splash screen again
+	* [r838]
+	  existence of netdevice corrected (less cpu load)
 
-	* drv_M50530.c, drv_MatrixOrbital.c, drv_MilfordInstruments.c, drv_USBLCD.c, drv_BeckmannEgle.c, drv_Crystalfontz.c, drv_Curses.c, drv_Cwlinux.c, drv_HD44780.c:
-	splash screen for all text-based display drivers
+	* [r837]
+	  logging info clarified
 
-2004-06-02  Michael Reinelt  <reinelt@merlin.ethnet>
+	* [r836]
+	  Indentation
 
-	* drv.c, drv_HD44780.c, drv_generic_text.c, drv_generic_text.h:
-	splash screen for HD44780
+2007-08-13  volker
 
-	* drv.c, drv.h, drv_BeckmannEgle.c, drv_Crystalfontz.c, drv_Curses.c, drv_Cwlinux.c, drv_HD44780.c, drv_Image.c, drv_M50530.c, drv_MatrixOrbital.c, drv_MilfordInstruments.c, drv_NULL.c, drv_T6963.c, drv_USBLCD.c, drv_X11.c, layout.c, lcd4linux.c, lcd4linux.conf.sample:
-	prepared support for startup splash screen
+	* [r835]
+	  Absicherung gegen Abfragen nicht vorhandener Daten
 
-	* drv_Crystalfontz.c:
-	extended contrast range for Crystalfontz
+	* [r834]
+	  erweiterte Ausgabe bei Daten ueber unterstuetzte Hardware
 
-	* lcd4linux.conf.sample:
-	added i2c_sensors example to lcd4linux.conf.sample
+2007-07-27  michael
 
-	* documentation/lcd4linux/Makefile, documentation/lcd4linux/bug_report.xml, documentation/lcd4linux/example.xml, documentation/lcd4linux/index.xml, documentation/lcd4linux/write_doc.xml, documentation/plugins/Makefile, documentation/plugins/index.xml, documentation/xsl/body.xsl, documentation/xsl/doc.xsl, documentation/xsl/head.xsl, documentation/xsl/helpers.xsl, documentation/xsl/references.xsl, documentation/xsl/xhtml.xsl, documentation/data/doc.css, documentation/data/images/note-icon.png, documentation/data/images/warn-icon.png, documentation/data/references.xml, documentation/drivers/Makefile, documentation/drivers/index.xml, documentation/dtd/doc.dtd, documentation/dtd/references.dtd, documentation/dtd/xhtml-lat1.ent, documentation/dtd/xhtml-special.ent, documentation/dtd/xhtml-symbol.ent, documentation/Makefile, documentation/Makefile.generic:
-	added documentation tree
+	* [r833]
+	  Fix compilation with kernel 2.6.22 by Guillaume LECERF
 
-	* drv_BeckmannEgle.c, lcd4linux.c:
-	fixed models listing for Beckmann+Egle driver
-	some cosmetic changes
+	* [r832]
+	  MPD plugin patch from michu
 
-2004-06-01  Michael Reinelt  <reinelt@merlin.ethnet>
+	* [r831]
+	  GPS plugin update by michu
 
-	* drv_T6963.c, drv_generic_graphic.c, drv_generic_graphic.h, drv_generic_serial.c, drv_generic_serial.h, drv_generic_text.c, drv_generic_text.h, hash.c, hash.h, plugin_i2c_sensors.c, thread.c, timer.c, timer.h, drv_Cwlinux.c, drv_HD44780.c, drv_M50530.c, drv_MatrixOrbital.c, drv_Crystalfontz.c:
-	some Fixme's processed
-	documented some code
+	* [r830]
+	  indentation
 
-	* README.Plugins, plugin_sample.c:
-	made README.Plugins and plugin_sample up to date.
+2007-07-12  volker
 
-2004-05-31  Michael Reinelt  <reinelt@merlin.ethnet>
+	* [r829]
+	  svn version updated
 
-	* drv_MatrixOrbital.c:
-	some cleanups in the MatrixOrbital driver
+	* [r828]
+	  additional verbose and info messages
 
-	* drv_Cwlinux.c, drv_generic_serial.c, lcd4linux.conf.sample, plugin_i2c_sensors.c, plugin_pop3.c:
-	fixed lots of bugs in the Cwlinux driver
-	do not emit EAGAIN error on the first retry
-	made plugin_i2c_sensors a bit less 'chatty'
-	moved init and exit functions to the bottom of plugin_pop3
+2007-07-08  volker
 
-	* config.h.in, configure, drivers.m4, drv.c, drv_Cwlinux.c, drv_MatrixOrbital.c, drv_NULL.c, hash.c, Makefile.am, Makefile.in, aclocal.m4:
-	added NULL display driver (for debugging/profiling purposes)
-	added backlight/contrast initialisation for matrixOrbital
-	added Backlight initialisation for Cwlinux
+	* [r827]
+	  includes for umask(); svnversion updated
 
-	* ChangeLog:
-	ChangeLog update
+2007-06-27  volker
 
-	* drv_Image.c, lcd4linux.conf.sample:
-	fixed symlink security issue with the image driver
+	* [r826]
+	  handle config files with <CR><LF> (DOS line ending)
 
-	* drv_BeckmannEgle.c, drv_Crystalfontz.c, drv_Cwlinux.c, drv_HD44780.c, drv_M50530.c, drv_MatrixOrbital.c, drv_MilfordInstruments.c, drv_USBLCD.c:
-	fixed possible bugs with user-defined chars (clear high bits)
-	thanks to Andy Baxter for debugging the MilfordInstruments driver!
+	* [r825]
+	  added plugin_netdev
 
-2004-05-31  andy-b  <andy-b@merlin.ethnet>
+	* [r824]
+	  copy&paste error corrected
 
-	* drv_MilfordInstruments.c:
+	* [r823]
+	  new plugin: netinfo
 
-	fixed bug in Milford Instruments driver which drew extra graphics chars in
-	odd places when drawing double bars. (the display doesn't like it if you put
-	the escape character 0xfe inside a define char sequence).
+	* [r822]
+	  indentation with ./indent.sh; short circuit evaluation modified
 
-2004-05-30  Michael Reinelt  <reinelt@merlin.ethnet>
+2007-06-25  volker
 
-	* drv_Crystalfontz.c, lcd4linux.conf.sample:
-	Crystalfontz 631 driver finished
+	* [r821]
+	  format characters in qprintf() with optional length
 
-2004-05-29  Michael Reinelt  <reinelt@merlin.ethnet>
+	* [r820]
+	  calculate only necessary elements of operands
 
-	* drv_Image.c:
-	fixed a compiler issue with drv_Image.c (thanks to Frank Stratmann)
+2007-06-24  volker
 
-	* drv_M50530.c, lcd4linux.conf.sample, plugin_ppp.c:
-	M50530: reset parport signals on exit
-	plugin_ppp: ppp() has two parameters, not three
-	lcd4linux.conf.sample: diskstats() corrected
+	* [r819]
+	  optimization on changing brightness of backlight
 
-	* lcd4linux.conf.sample, plugin_diskstats.c:
-	bug in plugin_diskstats fixed
+2007-06-22  volker
 
-	* config.h.in, configure, lcd4linux.conf.sample, plugin.c, plugin_diskstats.c, plugins.m4, Makefile.am, Makefile.in:
-	added plugin_diskstats.c
+	* [r818]
+	  list plugins
 
-2004-05-28  Michael Reinelt  <reinelt@merlin.ethnet>
+	* [r817]
+	  disable plugins where preconditions not given: compiles mostly
+	  under MacOS X
 
-	* ChangeLog, Status: Status and Changelog Update
+	* [r816]
+	  keypad support added for X11 driver
 
-	* drv_BeckmannEgle.c:
-	added drv_BeckmannEgle.c (forgotten at first check in :-)
+2007-06-21  volker
 
-	* drivers.m4, drv.c, drv_Crystalfontz.c, drv_Cwlinux.c, drv_MatrixOrbital.c, drv_MilfordInstruments.c, drv_generic_serial.c, drv_generic_serial.h, lcd4linux.conf.sample, lock.c, lock.h, BeckmannEgle.c, Makefile.am, Makefile.in, config.guess, config.sub, configure:
-	ported driver for Beckmann+Egle Mini-Terminals
-	added 'flags' parameter to serial_init()
+	* [r815]
+	  optimized layer drawing (no drawing under opaque pixel)
 
-2004-05-27  nicowallmeier  <nicowallmeier@merlin.ethnet>
+	* [r814]
+	  LCD::brightness, keypad
 
-	* plugin_imon.c: Moved variables to Plugin:imon / Plugin:telmon
+	* [r813]
+	  default for Brightness is 255
 
-2004-05-27  Michael Reinelt  <reinelt@merlin.ethnet>
+2007-06-20  volker
 
-	* Status:
-	Status update
+	* [r812]
+	  LCD::brightness in drv_X11 corrected
 
-	* drv_Crystalfontz.c, drv_Cwlinux.c, drv_HD44780.c, drv_MatrixOrbital.c, plugin_imon.c, plugin_netdev.c, plugin_proc_stat.c, plugin_wireless.c:
-	changed function naming scheme to plugin::function
+	* [r811]
+	  development of new experimental features
 
-2004-05-26  Michael Reinelt  <reinelt@merlin.ethnet>
+	* [r810]
+	  global variable for backlight color
 
-	* debug.c, drivers.m4, drv.c, drv_Crystalfontz.c, drv_Curses.c, drv_Cwlinux.c, drv_HD44780.c, drv_M50530.c, drv_MatrixOrbital.c, drv_MilfordInstruments.c, drv_USBLCD.c, drv_generic_text.c, drv_generic_text.h, lcd4linux.conf.sample, widget.c, Makefile.am, Makefile.in, Status, Text.c, config.h.in, configure:
-	Curses driver ported.
+	* [r809]
+	  keypad support completed; new property brightness implemented
 
-	* drivers.m4, drv.c, drv_MilfordInstruments.c, lcd4linux.conf.sample, Makefile.in, MilfordInstruments.c, Status, configure, Makefile.am:
-	MilfordInstruments driver ported
+	* [r808]
+	  maximum value for brightness is 8
 
-2004-05-25  Michael Reinelt  <reinelt@merlin.ethnet>
+2007-06-17  michael
 
-	* configure.in, drivers.m4, drv.c, Makefile.am, Makefile.in, config.h.in, configure:
-	'make distcheck' bugs fixed
-	release number changed to 0.10.0-RC1
+	* [r807]
+	  buttons for X11 driver (thanks to Volker Gering)
 
-	* Status, mail.c, mail.h, mail2.c, socket.c, socket.h, wifi.c, wifi.h, PalmPilot.c:
-	Status updated
-	obsolete files removed
+	* [r806]
+	  Apple has no utsbuf.domainname (thanks to Volker Gering)
 
-	* ChangeLog:
-	Changelog updated
+	* [r805]
+	  strndup() replacement
 
-	* drv_Image.c:
-	added drv_Image.c (this time really!)
+	* [r804]
+	  better usage output by Volker Gering
 
-	* drivers.m4, drv.c, drv_Crystalfontz.c, drv_X11.c, lcd4linux.conf.sample, Makefile.am, Makefile.in, Raster.c, configure:
-	added "Image" driver (was: Raster.c) for PPM and PNG creation
-	fixed some glitches in the X11 driver
+2007-06-08  michael
 
-	* lcd4linux.conf.sample.old:
-	removed old sample config lcd4linux.conf.sample.old from CVS
+	* [r803]
+	  Image driver libgd dependancy fix
 
-2004-05-23  Michael Reinelt  <reinelt@merlin.ethnet>
+2007-06-04  michael
 
-	* drv_USBLCD.c, lcd4linux.conf.sample:
-	icon bug with USBLCD fixed
+	* [r802]
+	  big MPD patch from Robert Buchholz
 
-2004-05-22  Michael Reinelt  <reinelt@merlin.ethnet>
+2007-05-19  michael
 
-	* lcd4linux.conf.sample, plugin.c, plugin_uptime.c, plugins.m4, Makefile.am, Makefile.in, config.h.in, configure:
-	added plugin 'uptime'
+	* [r801]
+	  gps plugin, code by michu / www.neophob.com
 
-	* drv_HD44780.c:
-	removed 16*x fix again (next time think before commit :-)
+2007-05-17  michael
 
-	* drv_HD44780.c:
-	fix for display RAM layout on 16x4 displays (thanks to toxicated101)
+	* [r800]
+	  backported r799 from trunk
 
-2004-05-20  Michael Reinelt  <reinelt@merlin.ethnet>
+	* [r799]
+	  compile error on m68k fixed (debian bug 405898)
 
-	* Makefile.am, Makefile.in, plugin.c, plugin_time.c: added plugin_time
+2007-05-04  michael
 
-	* plugin_pop3.c, configure, Makefile.in:
-	made all local functions static
+	* [r798]
+	  typo in LUIse driver fixed
 
-2004-05-19  Michael Reinelt  <reinelt@merlin.ethnet>
+2007-05-02  michael
 
-	* configure.in, Makefile.in, configure:
-	removed AC_PROG_CXX (C++-Compiler) from configure
+	* [r797]
+	  some compiler warnings fixed
 
-	* plugin_isdn.c:
-	plugin_isdn.c added (sorry, I forgot...)
+2007-04-30  michael
 
-2004-05-09  Michael Reinelt  <reinelt@merlin.ethnet>
+	* [r796]
+	  LCD4Linux-0.10.1-RC2
 
-	* plugin_i2c_sensors.c, ltmain.sh:
-	i2c fix for kernel 2.6.5 (temp_input1 vs. temp1_input) from Xavier
+	* [r795]
+	  ChangeLog updated
 
-2004-04-17  nicowallmeier  <nicowallmeier@merlin.ethnet>
+	* [r794]
+	  svn2cl moved and optimized
 
-	* plugin_wireless.c, plugin_pop3.c: minor bugfix
+	* [r793]
+	  svn2cl.sh added
 
-2004-04-12  Michael Reinelt  <reinelt@merlin.ethnet>
+	* [r792]
+	  port r791 from trunk
 
-	* isdn.c, isdn.h, plugin.c, plugins.m4, qprintf.c, evaluator.c, Makefile.am, Makefile.in, config.h.in, configure:
-	added plugin_isdn, removed old ISDN client
-	fixed some real bad bugs in the evaluator
+	* [r791]
+	  link Cwlinux with keypad support
 
-	* Status: Status update
+	* [r790]
+	  ported r777 from trunk
 
-	* drv_generic_parport.c, udelay.c:
-	another BIG FAT WARNING on the use of raw ports instead of ppdev
+	* [r789]
+	  ported r784-r788 from trunk
 
-	* lcd4linux.conf.sample, udelay.c, debug.h:
-	emitted a BIG FAT WARNING if msr.h could not be found (and therefore
-	the gettimeofday() delay loop would be used)
+2007-04-28  michael
 
-2004-04-11  Michael Reinelt  <reinelt@merlin.ethnet>
+	* [r788]
+	  patch from Fox: Fix a typo that prevent Bar display to work
 
-	* drivers.m4, plugins.m4: forgot these files at last checkin... sorry!
+	* [r787]
+	  patch from FoX that fixes compilation with kernel 2.6.21
 
-2004-04-09  Michael Reinelt  <reinelt@merlin.ethnet>
+2007-04-23  michael
 
-	* exec.c, exec.h: removed old exec stuff
+	* [r786]
+	  MPD plugin patch from michu
 
-	* configure.in, plugin.c, Makefile.am, Makefile.in, config.h.in, configure:
-	big configure rework from Xavier
+2007-04-20  michael
 
-2004-04-08  Michael Reinelt  <reinelt@merlin.ethnet>
+	* [r785]
+	  keypad and firmware support for Cwlinux (patch from Volker
+	  Gering)
 
-	* Makefile.am, Makefile.in, lcd4linux.conf.sample, plugin.c, plugin_pop3.c:
-	added plugin_pop3 from Javi
+	* [r784]
+	  iowait,irq and softirq added (patch from Roman Jozsef)
 
-	* plugin_exec.c, qprintf.c, thread.c, thread.h, Makefile.in, configure:
-	finished plugin_exec
-	modified thread handling
-	added '%x' format to qprintf (hexadecimal)
+2007-03-22  michael
 
-2004-04-07  hejl  <hejl@merlin.ethnet>
+	* [r783]
+	  backport r782 from trunk
 
-	* Makefile.am, plugin.c, plugin_wireless.c:
-	New plugin for wireless info
+2007-03-21  michael
 
-2004-03-21  Michael Reinelt  <reinelt@merlin.ethnet>
+	* [r782]
+	  plugin_file patch from Mark Richards
 
-	* lcd4linux.conf.sample, plugin_mysql.c: MySQL plugin fixes from Javi
+2007-03-13  michael
 
-2004-03-20  Michael Reinelt  <reinelt@merlin.ethnet>
+	* [r781]
+	  backport r780 from trunk
 
-	* lcd4linux.conf.sample, plugin_mysql.c: MySQL plugin fixes from Javi
+	* [r780]
+	  Crystalfontz keypad patch from kenson
 
-	* plugin_exec.c: forgot to add plugin_exec.c ...
+2007-03-05  michael
 
-	* thread.c, thread.h, drv_HD44780.c:
-	support for HD66712 (which has a different RAM layout)
-	further threading development
+	* [r779]
+	  ported changeset 778 from branches/0.10.1
 
-2004-03-19  Michael Reinelt  <reinelt@merlin.ethnet>
+	* [r778]
+	  picoLCD linker error fixed (libusb was missing)
 
-	* drv_Crystalfontz.c, drv_Cwlinux.c, drv_HD44780.c, drv_M50530.c, drv_MatrixOrbital.c, drv_USBLCD.c, drv_generic_text.c, drv_generic_text.h:
-	removed the extra 'goto' function, row and col are additional parameters
-	of the write() function now.
+2007-02-28  michael
 
-	* Makefile.am, Makefile.in, Status, aclocal.m4, config.h.in, configure, configure.in, pid.c, plugin.c, thread.c, thread.h:
-	asynchronous thread handling started
+	* [r777]
+	  imon::quantity and imon::status patch from Stefan Gmeiner /
+	  Christian Brueggemann
 
-2004-03-14  Michael Reinelt  <reinelt@merlin.ethnet>
+2007-02-26  michael
 
-	* Status, battery.c, battery.h:
-	old battery.[ch] files removed
+	* [r776]
+	  backported 774:775 from trunk
 
-	* Makefile.am, Makefile.in, configure, lcd4linux.c, plugin.c, plugin_apm.c, plugin_dvb.c:
-	parameter count fixed for plugin_dvb()
-	plugin_APM (battery status) ported
+	* [r775]
+	  ChangeLog refresh
 
-	* Status, configure.in: Status update.
-	Fixed bug in configure.in with X11 disabled (thanks to Kevin Liu)
+	* [r774]
+	  compiler warnings on x86_64 fixed
 
-2004-03-13  Michael Reinelt  <reinelt@merlin.ethnet>
+2007-02-25  michael
 
-	* ChangeLog, Status, plugin_seti.c:
-	ChangeLog and Status update; small glitch in plugin_seti fixed.
+	* [r773]
+	  backport 768:771 from trunk, version changed to 0.10.1-RC2
 
-2004-03-13  nicowallmeier  <nicowallmeier@merlin.ethnet>
+	* [r772]
+	  ChangeLog refreshed
 
-	* plugin_imon.c:
-	Added clean termination of imond-connection (now correctly)
+	* [r771]
+	  lots of compiler warnings removed, C++-style comments removed,
+	  changed struc initialisation from 'field:value' to '.field=value'
 
-	* plugin_imon.c: Added clean termination of imond-connection
+2007-02-24  michael
 
-2004-03-13  Michael Reinelt  <reinelt@merlin.ethnet>
+	* [r770]
+	  strstr() and substr() added to string plugin
 
-	* imon.h: (unnecessary) imon.h removed
+	* [r769]
+	  ChangeLog processed with svn2cl
 
-	* Makefile.am, Makefile.in, lcd4linux.conf.sample, plugin.c, plugin_seti.c, seti.c, seti.h:
-	seti@home plugin ported to NextGeneration
+	* [r768]
+	  LCD4Linux-0.10.1-RC1
 
-2004-03-12  Michael Reinelt  <reinelt@merlin.ethnet>
+	* [r767]
+	  trunk version incremented to 0.10.2-SVN
 
-	* imon.c: removed imon.c (has been replaced by plugin_imon.c)
+	* [r766]
+	  branch 0.10.1 created
 
-2004-03-11  Michael Reinelt  <reinelt@merlin.ethnet>
+	* [r765]
+	  tag 0.10.0 created
 
-	* evaluator.h, hash.c, hash.h, lcd4linux.c, plugin_cfg.c, plugin_cpuinfo.c, plugin_loadavg.c, plugin_meminfo.c, plugin_netdev.c, plugin_proc_stat.c, widget_bar.c, widget_icon.c, widget_text.c, cfg.c, drv_HD44780.c, evaluator.c:
-	big patch from Martin:
-	- reuse filehandles
-	- memory leaks fixed
-	- earlier busy-flag checking with HD44780
-	- reuse memory for strings in RESULT and hash
-	- netdev_fast to wavid time-consuming regex
+	* [r764]
+	  Version number changed to 0.10.1-RC1
 
-2004-03-10  Michael Reinelt  <reinelt@merlin.ethnet>
+2007-02-05  michael
 
-	* Makefile.am, Makefile.in, config.h.in, configure, configure.in, plugin.c, plugin_mysql.c:
-	MySQL plugin from Javier added
+	* [r763]
+	  only use picoLCD if libusb is available
 
-2004-03-08  hejl  <hejl@merlin.ethnet>
+2007-02-04  michael
 
-	* plugin_loadavg.c:
-	Fixed bug introduced with "caching" the loadavg values
+	* [r762]
+	  svn version bumped manually
 
-	* evaluator.c: fixed segfault when using string concatenation
+	* [r761]
+	  autoconf & smoketest bugs fixed
 
-2004-03-08  Michael Reinelt  <reinelt@merlin.ethnet>
+	* [r760]
+	  'Electronic Assembly' driver by Stefan Gmeiner
 
-	* Makefile.am, Makefile.in, cfg.c, lcd4linux.conf.sample, widget_text.c:
-	re-introduced \nnn (octal) characters in strings
-	text widgets can have a 'update' speed of 0 which means 'never'
-	(may be used for static content)
+	* [r759]
+	  picoLCD driver bugs fixed
 
-	* evaluator.c: string concatenation fixed
+2007-01-23  michael
 
-2004-03-06  Michael Reinelt  <reinelt@merlin.ethnet>
+	* [r758]
+	  drv_picoLCD was missing in distribution
 
-	* cfg.c, evaluator.c, evaluator.h, lcd4linux.c, plugin_cfg.c, plugin_math.c, widget_bar.c, widget_bar.h, widget_icon.c, widget_icon.h, widget_text.c, widget_text.h:
-	Complete rewrite of the evaluator to get rid of the code
-	from mark Morley (because of license issues).
-	The new Evaluator does a pre-compile of expressions, and
-	stores them in trees. Therefore it should be reasonable faster...
+	* [r757]
+	  removed -SVN from version string
 
-2004-03-03  hejl  <hejl@merlin.ethnet>
+	* [r756]
+	  try to add svn version
 
-	* hash.c: Fixed memory leak in hash_get_regex
+2007-01-21  michael
 
-2004-03-03  Michael Reinelt  <reinelt@merlin.ethnet>
+	* [r755]
+	  indent
 
-	* drv_generic_parport.c, drv_generic_serial.c, hash.c, hash.h, lcd4linux.c, pid.c, plugin_imon.c, plugin_netdev.c, plugin_ppp.c, plugin_proc_stat.c, qprintf.h, timer.c, widget_icon.c:
-	changes (cosmetics?) to the big patch from Martin
-	hash patch un-applied
+	* [r754]
+	  new function 'decode()'
 
-	* Raster.c, Text.c, cfg.c, drv_HD44780.c, drv_generic_graphic.c, drv_generic_parport.c, drv_generic_serial.c, drv_generic_text.c, evaluator.c, evaluator.h, exec.c, hash.c, hash.h, imon.c, layout.c, lcd4linux.c, lock.c, mail.c, mail2.c, pid.c, plugin.c, plugin.h, plugin_cfg.c, plugin_cpuinfo.c, plugin_dvb.c, plugin_i2c_sensors.c, plugin_imon.c, plugin_loadavg.c, plugin_math.c, plugin_meminfo.c, plugin_netdev.c, plugin_ppp.c, plugin_proc_stat.c, plugin_sample.c, plugin_string.c, plugin_uname.c, plugin_xmms.c, seti.c, timer.c, timer.h, widget.c, widget.h, widget_bar.c, widget_icon.c, widget_text.c, wifi.c:
-	big patch from Martin Hejl:
-	- use qprintf() where appropriate
-	- save CPU cycles on gettimeofday()
-	- add quit() functions to free allocated memory
-	- fixed lots of memory leaks
+	* [r753]
+	  removed unused variable
 
-	* drv_Crystalfontz.c: Crystalfontz Contrast issue fixed
+2007-01-20  michael
 
-2004-03-01  Michael Reinelt  <reinelt@merlin.ethnet>
+	* [r752]
+	  keypad widget cleanup
 
-	* cfg.c, drv_Crystalfontz.c, drv_HD44780.c, lcd4linux.conf.sample:
-	cfg_number() returns -1 on error, 0 if value not found (but default val used),
-	 and 1 if value was used from the configuration.
-	HD44780 driver adopted to new cfg_number()
-	Crystalfontz 631 driver nearly finished
+	* [r751]
+	  GPO cleanup
 
-2004-02-29  Michael Reinelt  <reinelt@merlin.ethnet>
+	* [r750]
+	  minor fixes to evaluator
 
-	* libtool, ChangeLog, configure, configure.in, lcd4linux.conf.sample:
-	ChangeLog updated
-	Version number bumped to 0.10.0
+	* [r749]
+	  dynamic properties for bars; new 'property_valid()' helper
 
-	* drv_generic_graphic.c:
-	icon visibility fix for generic graphics from Xavier
+	* [r748]
+	  indent
 
-2004-02-27  Michael Reinelt  <reinelt@merlin.ethnet>
+2007-01-19  michael
 
-	* qprintf.c, qprintf.h, lcd4linux.c, Makefile.am, Makefile.in:
-	new function 'qprintf()' (simple but quick snprintf() replacement)
+	* [r747]
+	  driver for picoLCD displays from mini-box.com by Nicu Pavel
 
-	* hash.c, hash.h: hash improvements from Martin
+	* [r746]
+	  dynamic properties for keypad widget
 
-2004-02-26  Michael Reinelt  <reinelt@merlin.ethnet>
+	* [r745]
+	  indent
 
-	* evaluator.c: memory leak fixes from Martin
+2007-01-18  michael
 
-2004-02-24  Michael Reinelt  <reinelt@merlin.ethnet>
+	* [r744]
+	  dynamic properties for Icon widget
 
-	* Status: Status and Todo list from Xavier
+2007-01-17  michael
 
-	* drv.c, drv_T6963.c, drv_X11.c, drv_generic_graphic.c, lcd4linux.conf.sample, configure.in, XWindow.c, configure, Makefile.am, Makefile.in:
-	X11 driver ported
+	* [r743]
+	  dynamic properties for GPO's
 
-2004-02-23  Michael Reinelt  <reinelt@merlin.ethnet>
+	* [r742]
+	  removed DOS newlines again :-(
 
-	* README.Tokens, lcd4linux.conf.sample, README.Rows:
-	"Lightning" widget from Xavier (lcd4linux.conf.sample)
-	removed obsolete Docs.
+	* [r741]
+	  indent
 
-2004-02-22  Michael Reinelt  <reinelt@merlin.ethnet>
+	* [r740]
+	  changed version number from 0.10.1-CVS to 0.10.1-SVN
 
-	* Makefile.in, drv_T6963.c, drv_generic_graphic.c, lcd4linux.conf.sample, plugin_imon.c:
-	some fixes for generic graphic driver and T6963
-	removed ^M from plugin_imon (Nico, are you editing under Windows?)
+2007-01-16  michael
 
-2004-02-18  nicowallmeier  <nicowallmeier@merlin.ethnet>
+	* [r739]
+	  new driver 'HD44780-I2C'
 
-	* plugin_imon.c, Makefile.am, plugin.c: Imon/Telmon plugin ported
+	* [r738]
+	  Fix compilation of plugin_wireless.c with linux kernel 2.6.19
+	  from Guillaume LECERF
 
-2004-02-18  Michael Reinelt  <reinelt@merlin.ethnet>
+	* [r737]
+	  Patch from Robert Buchholz: NULL driver link error fixed, m4
+	  files included in distribution
 
-	* cfg.c, drv_T6963.c, drv_generic_graphic.c, drv_generic_graphic.h, drv_generic_text.h, lcd4linux.conf.sample, widget.c, widget_text.c:
-	T6963 driver for graphic displays finished
+	* [r736]
+	  patch from Mattia Jona-Lasinio for lcd-linux 0.12.0
 
-2004-02-17  Michael Reinelt  <reinelt@merlin.ethnet>
+	* [r735]
+	  svn keywords
 
-	* configure, configure.in:
-	Namespace clash between Curses driver and general text driver resolved
-	(thanks to Martin Hejl)
+	* [r734]
+	  removed some DOS newlines
 
-2004-02-16  Michael Reinelt  <reinelt@merlin.ethnet>
+2007-01-15  michael
 
-	* plugin_dvb.c: compile problem with missing frontend.h fixed
+	* [r733]
+	  minor cosmetic changes and fixes
 
-	* plugin_i2c_sensors.c: i2c_sensors patch from Xavier
+2007-01-14  michael
 
-2004-02-15  Michael Reinelt  <reinelt@merlin.ethnet>
+	* [r732]
+	  re-bootstrapped
 
-	* Makefile.am, Makefile.in, T6963.c, configure, configure.in, drv.c, drv_HD44780.c, drv_M50530.c, drv_T6963.c, drv_generic_graphic.c, drv_generic_graphic.h, drv_generic_text.c, drv_generic_text.h, font_6x8.h, fontmap.c, fontmap.h, lcd4linux.conf.sample, libtool, pixmap.c, pixmap.h, plugin_i2c_sensors.c, widget_icon.c, widget_icon.h:
-	T6963 driver nearly finished
-	framework for graphic displays done
-	i2c_sensors patch from Xavier
-	some more old generation files removed
+	* [r731]
+	  svn keywords corrected
 
-	* M50530.c, Makefile.am, Makefile.in, USBLCD.c, configure, configure.in, drv.c, drv_M50530.c, drv_USBLCD.c, lcd4linux.conf.sample, libtool, ltmain.sh:
-	ported USBLCD driver to NextGeneration
-	added drv_M50530.c (I forgot yesterday, sorry)
-	removed old drivers M50530.c and USBLCD.c
+	* [r730]
+	  svn keywords corrected
 
-	* lcd4linux.conf.sample, plugin_netdev.c: bug in netdev parsing fixed
+	* [r729]
+	  added svn properties and keywords
 
-2004-02-14  nicowallmeier  <nicowallmeier@merlin.ethnet>
+	* [r728]
+	  changed $Revision to $Rev
 
-	* plugin_i2c_sensors.c: minor bugfix
+	* [r727]
+	  removed all tags
 
-2004-02-14  Michael Reinelt  <reinelt@merlin.ethnet>
+	* [r726]
+	  svn properties fixed
 
-	* configure.in, drv.c, drv_Crystalfontz.c, drv_Cwlinux.c, drv_HD44780.c, drv_MatrixOrbital.c, drv_generic_serial.c, drv_generic_serial.h, drv_generic_text.c, drv_generic_text.h, lcd4linux.conf.sample, plugin_i2c_sensors.c, configure, aclocal.m4, Makefile.in, Makefile.am:
-	M50530 driver ported
-	changed lots of 'char' to 'unsigned char'
+	* [r725]
+	  svn:ignore ported from .cvsignore
 
-	* plugin_i2c_sensors.c:
-	I2C Sensors for 2.4 kernels (/proc instead of /sysfs)
+	* [r724]
+	  switch from CVS to SVN
 
-2004-02-10  Michael Reinelt  <reinelt@merlin.ethnet>
+2006-10-01  reinelt
 
-	* processor.c, processor.h, system.c, system.h, Crystalfontz.c, Cwlinux.c, HD44780.c, Makefile.am, Makefile.in, MatrixOrbital.c, SIN.c, Skeleton.c, bar.c, bar.h, config.h.in, configure, configure.in, debug.c, display.c, display.h, dvb.c, dvb.h, expr.c, expr.h, filter.c, filter.h, icon.c, icon.h, lcd4linux.c, parport.c, parport.h, parser.c, parser.h, plugin.c:
-	cut off all old-style files which are no longer used with NextGeneration
+	* [r723]
+	  [lcd4linux @ 2006-10-01 11:54:38 by reinelt]
+	  timer widget uses properties
 
-	* Makefile.in, plugin.c, plugin_dvb.c, Makefile.am: DVB plugin ported
+2006-09-29  reinelt
 
-2004-02-09  nicowallmeier  <nicowallmeier@merlin.ethnet>
+	* [r722]
+	  [lcd4linux @ 2006-09-29 04:48:21 by reinelt]
+	  image widget uses properties now; new property 'reload'
 
-	* widget_text.c: Minor bugfix
+2006-10-04  root
 
-2004-02-07  Michael Reinelt  <reinelt@merlin.ethnet>
+	* [r721]
+	  image widget memory leaks fixed (thanks to Magne Torresen)
 
-	* drv_generic_text.c, widget_icon.c:
-	icon visibility patch #2 from Xavier
+2006-09-19  entropy
 
-2004-02-05  mkeil  <mkeil@merlin.ethnet>
+	* [r720]
+	  [lcd4linux @ 2006-09-19 11:20:52 by entropy]
+	  Added missing prototypes
 
-	* plugin_xmms.c: Fixed/Optimized Hashage-timings
+2006-09-15  siretart
 
-2004-02-05  Michael Reinelt  <reinelt@merlin.ethnet>
+	* [r719]
+	  [lcd4linux @ 2006-09-15 20:30:03 by siretart]
+	  rerun bootstrap on request from Ernst Bachmann
+	  <e.bachmann@xebec.de>
+	  Message-Id: <200609152109.17600.e.bachmann@xebec.de>
 
-	* drv_Crystalfontz.c, evaluator.c, lcd4linux.conf.sample:
-	evaluator function names are no longer case-sensitive
-	Crystalfontz Fan PWM control, Fan RPM monitoring, temperature monitoring
+2006-09-15  entropy
 
-2004-02-04  Michael Reinelt  <reinelt@merlin.ethnet>
+	* [r718]
+	  [lcd4linux @ 2006-09-15 19:06:47 by entropy]
+	  debug spam reduced, comment typo fixed
 
-	* widget_icon.c, widget_icon.h: icon visibility patch from Xavier
+	* [r717]
+	  [lcd4linux @ 2006-09-15 19:00:50 by entropy]
+	  iconv charset converter plugin
 
-	* drv_Crystalfontz.c, drv_HD44780.c, drv_generic_serial.c, lcd4linux.conf.sample, plugin_proc_stat.c:
-	Crystalfontz driver nearly finished
+2006-09-14  entropy
 
-2004-02-02  Michael Reinelt  <reinelt@merlin.ethnet>
+	* [r716]
+	  [lcd4linux @ 2006-09-14 20:36:39 by entropy]
+	  Improved example showing how to display network and hdd activity
+	  on an usb hub
 
-	* drv_HD44780.c: Brightness fpr Noritake Displays avaliable as a plugin
+	* [r715]
+	  [lcd4linux @ 2006-09-14 11:19:29 by entropy]
+	  New cmdline option -p to specify the pidfile location
 
-2004-02-01  Michael Reinelt  <reinelt@merlin.ethnet>
+2006-09-14  reinelt
 
-	* layout.c, plugin_cfg.c, plugin_netdev.c, plugin_proc_stat.c:
-	got rid of every strtok() incarnation.
+	* [r714]
+	  [lcd4linux @ 2006-09-14 04:08:54 by reinelt]
+	  variables use a static list, no realloc, linear search
 
-	* cfg.c, layout.c:
-	removed strtok() from layout processing (took me hours to find this bug)
-	further strtok() removind should be done!
+	* [r713]
+	  [lcd4linux @ 2006-09-14 03:49:14 by reinelt]
+	  indent run
 
-2004-02-01  hejl  <hejl@merlin.ethnet>
+2006-09-13  entropy
 
-	* drv_HD44780.c: Fixes for busy flag
+	* [r712]
+	  [lcd4linux @ 2006-09-13 20:07:59 by entropy]
+	  Fixing bug #1494773 (compiles only on i368/amd64 machines) by
+	  providing a dummy implementation for other archs
 
-2004-02-01  Michael Reinelt  <reinelt@merlin.ethnet>
+	* [r711]
+	  [lcd4linux @ 2006-09-13 20:04:57 by entropy]
+	  threads change argv[0] to their thread name, for a neat 'ps'
+	  output
 
-	* drv_Crystalfontz.c, drv_HD44780.c, drv_generic_serial.c, drv_generic_serial.h:
-	Crystalfontz 633 extensions (CRC checking and stuff)
-	Models table for HD44780
-	Noritake VFD BVrightness patch from Bill Paxton
+2006-09-13  reinelt
 
-2004-01-30  Michael Reinelt  <reinelt@merlin.ethnet>
+	* [r710]
+	  [lcd4linux @ 2006-09-13 05:33:39 by reinelt]
+	  plugin_file: return empty string if file cannot be read;
+	  widget_text: load property as 'string', not as variable
+	  (triggered an ugly bug with variable list reallocated)
 
-	* configure.in, drv_Crystalfontz.c, drv_generic_text.c, evaluator.c, filter.c, hash.c, icon.c, layout.c, lcd4linux.c, lcd4linux.conf.sample, mail2.c, pixmap.c, plugin_cfg.c, plugin_i2c_sensors.c, plugin_sample.c, timer.c, widget.c, widget_bar.c, widget_icon.c, widget_text.c, BeckmannEgle.c, Crystalfontz.c, Cwlinux.c, HD44780.c, M50530.c, MatrixOrbital.c, MilfordInstruments.c, PalmPilot.c, Raster.c, T6963.c, USBLCD.c, XWindow.c, aclocal.m4, bar.c, cfg.c, cfg.h, config.h.in, configure:
-	HD44780 patch from Martin Hejl
-	dmalloc integrated
+2006-09-08  reinelt
 
-	* drv_HD44780.c, plugin_i2c_sensors.c, plugin_loadavg.c, processor.c:
-	HD44780 busy-flag support from Martin Hejl
-	loadavg() uClibc replacement from Martin Heyl
-	round() uClibc replacement from Martin Hejl
-	warning in i2c_sensors fixed
-	[
+	* [r709]
+	  [lcd4linux @ 2006-09-08 19:00:46 by reinelt]
+	  give up after 10 write errors to serial device
 
-2004-01-29  Michael Reinelt  <reinelt@merlin.ethnet>
+2006-09-07  reinelt
 
-	* plugin_i2c_sensors.c: check for /sys mounted
+	* [r708]
+	  [lcd4linux @ 2006-09-07 09:06:25 by reinelt]
+	  lots of wrong printf formats corrected (thanks to Ernst Bachmann)
 
-	* configure.in, config.h.in, configure:
-	uClibc compatibility issues from Martin Hejl
+2006-09-06  reinelt
 
-	* seti.c, socket.c, timer.c, widget.c, widget_bar.c, widget_icon.c, widget_text.c, wifi.c, BeckmannEgle.c, Crystalfontz.c, Cwlinux.c, MatrixOrbital.c, MilfordInstruments.c, PalmPilot.c, SIN.c, Skeleton.c, Text.c, XWindow.c, bar.c, battery.c, cfg.c, drv_Crystalfontz.c, drv_Cwlinux.c, drv_HD44780.c, drv_MatrixOrbital.c, drv_generic_serial.c, drv_generic_text.c, evaluator.c, exec.c, expr.c, filter.c, fontmap.c, hash.c, icon.c, imon.c, isdn.c, lcd4linux.conf.sample, lock.c, mail.c, mail2.c, parser.c, pid.c, pixmap.c, plugin.c, plugin_cfg.c, plugin_cpuinfo.c, plugin_i2c_sensors.c, plugin_loadavg.c, plugin_math.c, plugin_meminfo.c, plugin_netdev.c, plugin_proc_stat.c, plugin_sample.c, plugin_string.c, plugin_uname.c, plugin_xmms.c, processor.c:
-	every .c file includes "config.h" now
+	* [r707]
+	  [lcd4linux @ 2006-09-06 05:22:09 by reinelt]
+	  some autoconf updates
 
-2004-01-28  Michael Reinelt  <reinelt@merlin.ethnet>
+2006-09-04  siretart
 
-	* plugin_ppp.c: plugin_ppp finished.
+	* [r706]
+	  [lcd4linux @ 2006-09-04 16:48:32 by siretart]
+	  rerun bootstrap on current debian/etch system using automake1.9
+	  to
+	  make my previous commits active
 
-2004-01-27  Michael Reinelt  <reinelt@merlin.ethnet>
+	* [r705]
+	  [lcd4linux @ 2006-09-04 16:47:39 by siretart]
+	  These changes were necessary to make lcd4linux build on current
+	  debian etch/unstable
+	  systems. I cannot really imagine how this was supposed to work,
+	  so I replaced
+	  the old modified python.m4 with an uptodate version of
+	  ac_python_devel.m4 from
+	  autoconf_archive. both .m4 files seem to have a common anchestor,
+	  but ac_python_devel.m4
+	  has clearly seen a lot of more love, so let's better stay with
+	  upstream
+	  (autoconf archive), so we can blame them if anything breaks.
+	  
+	  Moreover, this actually works
 
-	* Makefile.am, Makefile.in, lcd4linux.conf.sample, plugin.c, plugin_i2c_sensors.c, plugin_ppp.c, plugin_proc_stat.c:
-	ported PPP token to plugin_ppp
+	* [r704]
+	  [lcd4linux @ 2006-09-04 16:41:21 by siretart]
+	  removing debianisation from upstream source, as discussed with
+	  Michael on private mail.
+	  
+	  Rationale: I try to keep an updated lcd4linux in debian/sid. If
+	  you need the debinisation,
+	  please use my packages as base. If you want more updated package,
+	  please drop me a note,
+	  and I'll arrange another upload to unstable (or experimental,
+	  depending on the state
+	  of the cvs).
 
-	* Makefile.am, Makefile.in, aclocal.m4, configure, configure.in, drv.c, drv_Cwlinux.c:
-	Cwlinux driver portet to NextGeneration (compiles, but not tested!)
+	* [r703]
+	  [lcd4linux @ 2006-09-04 16:35:43 by siretart]
+	  fix linking with modular xorg. See http://bugs.debian.org/381606
+	  for reference
 
-	* plugin_i2c_sensors.c: i2c update from Xavier
+	* [r702]
+	  [lcd4linux @ 2006-09-04 16:33:21 by siretart]
+	  beautify bootstrap script
 
-	* TODO, hash.c:
-	bug with hash_age() fixed (thanks to Markus Keil for pointing this out)
+2006-08-23  harbaum
 
-2004-01-25  Michael Reinelt  <reinelt@merlin.ethnet>
+	* [r701]
+	  [lcd4linux @ 2006-08-23 17:45:37 by harbaum]
+	  Umlaut translation bugfix
 
-	* drv_Crystalfontz.c, drv_generic_serial.c, lcd4linux.conf.sample, plugin.c, plugin_meminfo.c, plugin_netdev.c, plugin_proc_stat.c, Makefile.am, Makefile.in:
-	plugin_netdev for parsing /proc/net/dev added
+2006-08-23  reinelt
 
-2004-01-23  Michael Reinelt  <reinelt@merlin.ethnet>
+	* [r700]
+	  [lcd4linux @ 2006-08-23 05:05:40 by reinelt]
+	  CF635 added to lcd4linux.conf.sample
 
-	* lcd4linux.conf.sample, widget_icon.c, widget_icon.h, drv_generic_text.h, drv_generic_text.c, drv_MatrixOrbital.c, drv_HD44780.c, drv_Crystalfontz.c:
-	icons finished!
+2006-08-17  harbaum
 
-	* widget_icon.h, widget_text.c, widget_icon.c, widget_bar.c, widget.c, drv_generic_text.h, lcd4linux.conf.sample, drv_generic_text.c, drv_MatrixOrbital.c, drv_HD44780.c, drv_Crystalfontz.c, Makefile.in, Makefile.am:
-	icon widget added (not finished yet!)
+	* [r699]
+	  [lcd4linux @ 2006-08-17 19:11:40 by harbaum]
+	  Small plugin_kvv bugfixes and new abbreviate option
 
-2004-01-22  Michael Reinelt  <reinelt@merlin.ethnet>
+2006-08-17  reinelt
 
-	* plugin_proc_stat.c: fixed unhandled kernel-2.6 entries in /prco/stat
+	* [r698]
+	  [lcd4linux @ 2006-08-17 05:06:26 by reinelt]
+	  LCD2USB driver missing keypad symbols fixed
 
-	* cfg.c, drv_Crystalfontz.c, drv_HD44780.c, drv_MatrixOrbital.c, drv_generic_text.c, drv_generic_text.h, hash.c, lcd4linux.conf.sample, widget_text.c:
-	several bugs fixed where segfaulting on layout>display
-	Crystalfontz driver optimized, 632 display already works
+2006-08-16  reinelt
 
-2004-01-21  Michael Reinelt  <reinelt@merlin.ethnet>
+	* [r697]
+	  [lcd4linux @ 2006-08-16 14:18:14 by reinelt]
+	  T6963 enhancements: soft timing, DualScan, Cell size
 
-	* hash.c, hash.h, plugin_proc_stat.c:
-	new helper 'hash_get_regex' which delivers the sum over regex matched items
-	new function 'disk()' which uses this regex matching
+2006-08-15  harbaum
 
-	* Makefile.am, Makefile.in, configure, configure.in, drv.c, drv_Crystalfontz.c, drv_MatrixOrbital.c:
-	Crystalfontz NextGeneration driver added
+	* [r696]
+	  [lcd4linux @ 2006-08-15 17:28:27 by harbaum]
+	  Cleaned up thread and error handling
 
-	* ChangeLog: changelog commited
+2006-08-14  harbaum
 
-	* plugin_proc_stat.c, plugin_xmms.c: two bugs with hash_age() ixed
+	* [r695]
+	  [lcd4linux @ 2006-08-14 19:24:22 by harbaum]
+	  Umlaut support, added KVV HTTP-User-Agent
 
-	* config.guess, config.sub, hash.c, hash.h, libtool, ltmain.sh, plugin_cpuinfo.c, plugin_meminfo.c, plugin_proc_stat.c, plugin_xmms.c:
-	hash_age function added
+2006-08-14  reinelt
 
-	* drv_HD44780.c, lcd4linux.conf.sample:
-	HD44780 missed the "clear display' sequence
-	asc255bug handling added
-	HD44780 tested, works here!
+	* [r694]
+	  [lcd4linux @ 2006-08-14 05:54:03 by reinelt]
+	  minor warnings fixed, CFLAGS changed (no-strict-aliasing)
 
-2004-01-20  Michael Reinelt  <reinelt@merlin.ethnet>
+2006-08-13  harbaum
 
-	* configure.in, drv.c, drv.h, drv_HD44780.c, drv_MatrixOrbital.c, drv_generic_parport.c, drv_generic_parport.h, lcd4linux.conf.sample, config.h.in, configure:
-	first version of Next Generation HD44780 (untested! but it compiles...)
-	some cleanup in the other drivers
+	* [r693]
+	  [lcd4linux @ 2006-08-13 18:45:25 by harbaum]
+	  Little cleanup ...
 
-	* Makefile.am, Makefile.in, drv_generic_parport.c, drv_generic_parport.h:
-	drv_generic_parport added, code from parport.c
+	* [r692]
+	  [lcd4linux @ 2006-08-13 18:14:03 by harbaum]
+	  Added KVV plugin
 
-	* drv_generic_serial.c, drv_generic_serial.h:
-	moved drv_generic to drv_generic_serial
+2006-08-13  reinelt
 
-	* Makefile.am, Makefile.in, drv_MatrixOrbital.c, drv_generic.c, drv_generic.h, drv_generic_text.c, widget_bar.c:
-	some reorganization
-	moved drv_generic to drv_generic_serial
-	moved port locking stuff to drv_generic_serial
+	* [r691]
+	  [lcd4linux @ 2006-08-13 11:38:20 by reinelt]
+	  text widget uses dynamic properties
 
-	* drv_MatrixOrbital.c, drv_generic_text.c, lcd4linux.conf.sample, plugin_proc_stat.c, widget_bar.c:
-	"Default screen" working with MatrixOrbital
+	* [r690]
+	  [lcd4linux @ 2006-08-13 09:53:10 by reinelt]
+	  dynamic properties added (used by 'style' of text widget)
 
-	* Makefile.am, Makefile.in, drv_MatrixOrbital.c, drv_generic.c, drv_generic.h, drv_generic_bar.c, drv_generic_bar.h, drv_generic_text.c, drv_generic_text.h, hash.c, lcd4linux.conf.sample:
-	moved text-display-specific stuff to drv_generic_text
-	moved all the bar stuff from drv_generic_bar to generic_text
+	* [r689]
+	  [lcd4linux @ 2006-08-13 06:46:51 by reinelt]
+	  T6963 soft-timing & enhancements; indent
 
-	* Makefile.am, Makefile.in, drv_MatrixOrbital.c, drv_generic.c, drv_generic.h, drv_generic_bar.c, drv_generic_bar.h, lcd4linux.conf.sample, widget_bar.c, widget_bar.h, widget_text.c:
-	moved generic stuff from drv_MatrixOrbital to drv_generic
-	implemented new-stylish bars which are nearly finished
+2006-08-11  reinelt
 
-2004-01-18  Michael Reinelt  <reinelt@merlin.ethnet>
+	* [r688]
+	  [lcd4linux @ 2006-08-11 11:59:29 by reinelt]
+	  M50530 minor fixes
 
-	* Makefile.am, Makefile.in, drv_MatrixOrbital.c, widget_bar.c, widget_bar.h:
-	Framework for bar widget opened
+2006-08-10  reinelt
 
-	* hash.c, hash.h, lcd4linux.conf.sample, plugin_proc_stat.c, timer.c:
-	/proc/stat parsing finished
+	* [r687]
+	  [lcd4linux @ 2006-08-10 20:40:46 by reinelt]
+	  M50530 enhancements: Timings, busy-flag checking
 
-	* cfg.c, expr.c, hash.c, plugin_proc_stat.c:
-	bug in expr.c fixed (thanks to Xavier)
-	some progress with /proc/stat parsing
+	* [r686]
+	  [lcd4linux @ 2006-08-10 19:06:52 by reinelt]
+	  new 'fuzz' parameter for timings
 
-2004-01-16  Michael Reinelt  <reinelt@merlin.ethnet>
+2006-08-09  harbaum
 
-	* hash.h, plugin_cpuinfo.c, plugin_proc_stat.c, plugin_xmms.c:
-	some bugs in plugin_xmms fixed, parsing moved to own function
-	plugin_proc_stat nearly finished
+	* [r685]
+	  [lcd4linux @ 2006-08-09 17:25:34 by harbaum]
+	  Better bar color support and new bold font
 
-2004-01-16  mkeil  <mkeil@merlin.ethnet>
+2006-08-08  harbaum
 
-	* plugin_xmms.c:   -include caching for values
+	* [r684]
+	  [lcd4linux @ 2006-08-08 20:16:28 by harbaum]
+	  Added "extracolor" (used for e.g. bar border) and RGB support for
+	  LEDMATRIX
 
-2004-01-16  Michael Reinelt  <reinelt@merlin.ethnet>
+2006-08-08  reinelt
 
-	* hash.c, hash.h, plugin_cpuinfo.c, plugin_meminfo.c, plugin_proc_stat.c:
-	moved various /proc parsing to own functions
-	made some progress with /proc/stat parsing
+	* [r683]
+	  [lcd4linux @ 2006-08-08 19:35:21 by reinelt]
+	  USBHUB driver from Ernst Bachmann
 
-	* Makefile.am, Makefile.in, cfg.c, filter.c, hash.c, hash.h, lcd4linux.conf.sample, plugin.c, plugin_proc_stat.c, system.c:
-	started plugin proc_stat which should parse /proc/stat
-	which again is a paint in the a**
-	thinking over implementation methods of delta functions
-	(CPU load, ...)
+	* [r682]
+	  [lcd4linux @ 2006-08-08 19:28:18 by reinelt]
+	  widget type checking corrected
 
-2004-01-15  Michael Reinelt  <reinelt@merlin.ethnet>
+2006-08-05  harbaum
 
-	* debian/postinst, debian/watch, widget_text.h, drv_MatrixOrbital.c, evaluator.c, lcd4linux.conf.sample, widget_text.c:
-	debian/ postinst and watch added (did CVS forget about them?)
-	evaluator: conditional expressions (a?b:c) added
-	text widget nearly finished
+	* [r681]
+	  [lcd4linux @ 2006-08-05 21:08:01 by harbaum]
+	  New LEDMATRIX driver (see http://www.harbaum.org/till/ledmatrix)
 
-	* ChangeLog: *** empty log message ***
+2006-07-31  reinelt
 
-	* Makefile.am, Makefile.in, lcd4linux.conf.sample, lcd4linux.conf.sample.old, plugin.c, plugin_cpuinfo.c, plugin_loadavg.c, plugin_meminfo.c, widget_text.c, widget_text.h:
-	moved lcd4linux.conf.sample to *.old
-	lcd4linux.conf.sample with new layout
-	new plugins 'loadavg' and 'meminfo'
-	text widget have pre- and postfix
+	* [r680]
+	  [lcd4linux @ 2006-07-31 03:48:09 by reinelt]
+	  preparations for scrolling
 
-2004-01-14  Michael Reinelt  <reinelt@merlin.ethnet>
+2006-07-30  lfcorreia
 
-	* Makefile.am, Makefile.in, cfg.c, cfg.h, drv_MatrixOrbital.c, expr.c, layout.c, lcd4linux.c, plugin.c, plugin_cfg.c, plugin_cpuinfo.c, plugin_uname.c, widget.c, widget.h, widget_text.c:
-	new plugin 'uname' which does what it's called
-	text widget nearly finished
-	first results displayed on MatrixOrbital
+	* [r679]
+	  [lcd4linux @ 2006-07-30 11:29:02 by lfcorreia]
+	  Make changes suggested by Michael, only one init function is
+	  needed
 
-2004-01-13  Michael Reinelt  <reinelt@merlin.ethnet>
+	* [r678]
+	  [lcd4linux @ 2006-07-30 11:16:27 by lfcorreia]
+	  Add back drv_generic_i2c_close function
 
-	* Makefile.am, Makefile.in, hash.c, hash.h, plugin.c, plugin_cfg.c, plugin_cpuinfo.c, plugin_sample.c:
-	new util 'hash' for associative arrays
-	new plugin 'cpuinfo'
+2006-07-29  lfcorreia
 
-	* parport.c, timer.c, timer.h, widget.c, widget.h, widget_text.c, configure.in, layout.c, lcd4linux.c, configure, Makefile.in, Makefile.am:
-	timer queues added
-	liblcd4linux deactivated turing transformation to new layout
+	* [r677]
+	  [lcd4linux @ 2006-07-29 21:12:31 by lfcorreia]
+	  Add UPPERCASE string plugin function
 
-2004-01-12  Michael Reinelt  <reinelt@merlin.ethnet>
+	* [r676]
+	  [lcd4linux @ 2006-07-29 21:04:43 by lfcorreia]
+	  Better error handling, add proper I2C SLAVE device detection (not
+	  100% finished)
 
-	* evaluator.c, evaluator.h, expr.c, layout.c, lcd4linux.c:
-	evaluating the 'Variables' section in the config file
+	* [r675]
+	  [lcd4linux @ 2006-07-29 20:59:12 by lfcorreia]
+	  Fix wrong timing at I2C initialization
 
-2004-01-11  Michael Reinelt  <reinelt@merlin.ethnet>
+2006-07-19  cmay
 
-	* Makefile.am, Makefile.in, cfg.c, drv_MatrixOrbital.c, layout.c, plugin.c, plugin_string.c, widget.c, widget.h, widget_text.c:
-	further widget and layout processing
+	* [r674]
+	  [lcd4linux @ 2006-07-19 01:57:01 by cmay]
+	  fixed double read of last line in file
 
-	* cfg.c, drv_MatrixOrbital.c, layout.c, widget.c:
-	layout starts to exist...
+	* [r673]
+	  [lcd4linux @ 2006-07-19 01:48:11 by cmay]
+	  Ran indent.sh to make pretty code.
 
-2004-01-10  Michael Reinelt  <reinelt@merlin.ethnet>
+	* [r672]
+	  [lcd4linux @ 2006-07-19 01:35:31 by cmay]
+	  Renamed keypad direction names to avoid conflict with Curses
+	  library defs.
+	  Added keypad support to Curses display driver.
 
-	* Makefile.am, Makefile.in, cfg.c, cfg.h, drv.h, drv_MatrixOrbital.c, layout.c, layout.h, lcd4linux.c, plugin.c, widget.c, widget.h, widget_text.c:
-	added new function 'cfg_list()' (not finished yet)
-	added layout.c (will replace processor.c someday)
-	added widget_text.c (will be the first and most important widget)
-	modified lcd4linux.c so that old-style configs should work, too
+2006-07-18  nicowallmeier
 
-	* lcd4linux.c, plugin.c:
-	changed initialization order so cfg() gets initialized before plugins.
-	This way a plugin's init() can use cfg_get().
-	Thanks to Xavier for reporting this one!
+	* [r671]
+	  [lcd4linux @ 2006-07-18 17:04:55 by nicowallmeier]
+	  Changed test for libmpd
 
-	* Makefile.am, Makefile.in, plugin.c, plugin_i2c_sensors.c:
-	I2C Sensors plugin from Xavier added
+2006-07-14  reinelt
 
-	* drv_MatrixOrbital.c, widget.c, widget.h:
-	further matrixOrbital changes
-	widgets initialized
+	* [r670]
+	  [lcd4linux @ 2006-07-14 20:15:11 by reinelt]
+	  buffer too small (thanks to anonymous)
 
-	* drv.c, drv_MatrixOrbital.c: new MatrixOrbital changes
+2006-07-12  reinelt
 
-2004-01-09  Michael Reinelt  <reinelt@merlin.ethnet>
+	* [r669]
+	  [lcd4linux @ 2006-07-12 21:01:41 by reinelt]
+	  thread_destroy, minor cleanups
 
-	* configure.in, display.c, display.h, drv.c, drv.h, drv_MatrixOrbital.c, lcd4linux.c, Makefile.am, Makefile.in, configure:
-	initiated transfer to new driver architecture
-	new file 'drv.c' will someday replace 'display.c'
-	new file 'drv_MatrixOrbital.c' will replace 'MatrixOrbital.c'
-	due to this 'soft' transfer lcd4linux should stay usable during the switch
-	(at least I hope so)
+	* [r668]
+	  [lcd4linux @ 2006-07-12 20:47:51 by reinelt]
+	  indent
 
-	* BeckmannEgle.c, Crystalfontz.c, Cwlinux.c, HD44780.c, M50530.c, MatrixOrbital.c, MilfordInstruments.c, PalmPilot.c, Raster.c, T6963.c, Text.c, USBLCD.c, XWindow.c, cfg.c, cfg.h, exec.c, expr.c, filter.c, icon.c, imon.c, lcd4linux.c, mail.c, mail2.c, parport.c, processor.c, seti.c, system.c, wifi.c:
-	added 'section' argument to cfg_get(), but NULLed it on all calls by now.
+	* [r667]
+	  [lcd4linux @ 2006-07-12 20:45:30 by reinelt]
+	  G15 and thread patch by Anton
 
-2004-01-08  Michael Reinelt  <reinelt@merlin.ethnet>
+2006-06-25  reinelt
 
-	* cfg.c: allowed '.' in key names
-	allowed empty group keys (not only "group anything {", but "anything {")
+	* [r666]
+	  [lcd4linux @ 2006-06-25 15:13:00 by reinelt]
+	  automake-1.9 cleanups
 
-	* AUTHORS, cfg.c, lcd4linux.c: Luk Claes added to AUTHORS
-	cfg: group handling ('{}') added
+	* [r665]
+	  [lcd4linux @ 2006-06-25 14:58:38 by reinelt]
+	  switch to automake-1.9
 
-2004-01-07  Michael Reinelt  <reinelt@merlin.ethnet>
+2006-06-21  reinelt
 
-	* cfg.c, config.h.in, evaluator.c, libtool:
-	small glitch in evaluator fixed
-	made config table sorted and access with bsearch(),
-	which should be much faster
+	* [r664]
+	  [lcd4linux @ 2006-06-21 05:12:43 by reinelt]
+	  added checks for libgd version 2 (thanks to Sam)
 
-2004-01-06  Michael Reinelt  <reinelt@merlin.ethnet>
+2006-06-20  reinelt
 
-	* AUTHORS, debian/copyright, evaluator.c: more copyright issues
+	* [r663]
+	  [lcd4linux @ 2006-06-20 08:50:58 by reinelt]
+	  widget_image linker error hopefully finally fixed
 
-	* USBLCD.c, XWindow.c, battery.c, battery.h, debian/copyright, imon.c, imon.h, plugin_xmms.c, seti.c, wifi.c, wifi.h, AUTHORS, HD44780.c, MilfordInstruments.c:
-	Copyright statements cleaned up
+2006-06-19  reinelt
 
-	* debian/control, debian/dirs, debian/rules, debian/templates:
-	more debianizing
+	* [r662]
+	  [lcd4linux @ 2006-06-19 15:12:54 by reinelt]
+	  bootstrapped
 
-	* debian/copyright: debian updates
+	* [r661]
+	  [lcd4linux @ 2006-06-19 12:02:17 by reinelt]
+	  linker error from widget_image fixed
 
-	* aclocal.m4, configure, ltmain.sh: autotools update
+	* [r660]
+	  [lcd4linux @ 2006-06-19 11:54:08 by reinelt]
+	  removed dependency to usb.h from sample driver
 
-	* ChangeLog: *** empty log message ***
+2006-04-17  reinelt
 
-	* Makefile.am, Makefile.in, README.Plugins, evaluator.c, plugin.c, plugin_sample.c:
-	Evaluator: functions with variable argument lists
-	Evaluator: plugin_sample.c and README.Plugins added
+	* [r659]
+	  [lcd4linux @ 2006-04-17 08:10:42 by reinelt]
+	  LCDLinux patch from Mattia; widget_image moved to EXTRA_SOURCE
 
-	* plugin.c, evaluator.c: Evaluator rearrangements...
+2006-04-15  reinelt
 
-2004-01-05  Michael Reinelt  <reinelt@merlin.ethnet>
+	* [r658]
+	  [lcd4linux @ 2006-04-15 05:22:52 by reinelt]
+	  mpd plugin from Stefan Kuhne
 
-	* Makefile.am, Makefile.in, expr.c, expr.h, parser.c, parser.h, processor.c:
-	added %y tokens to make the Evaluator useable
+2006-04-14  harbaum
 
-2004-01-02  Michael Reinelt  <reinelt@merlin.ethnet>
+	* [r657]
+	  [lcd4linux @ 2006-04-14 20:59:38 by harbaum]
+	  Disable inclusion of Image driver in drv.c if no gd was found.
 
-	* debian/changelog, debian/compat, debian/config, debian/control, debian/copyright, debian/dirs, debian/docs, debian/init.d, debian/rules, debian/templates:
-	debianization added
+2006-04-09  reinelt
 
-	* ChangeLog, TODO: Changelog, TODO updated
+	* [r656]
+	  [lcd4linux @ 2006-04-09 17:46:14 by reinelt]
+	  vertical bar patch fro graphic displays by Ronald Hopfer
 
-2003-12-19  Michael Reinelt  <reinelt@merlin.ethnet>
+	* [r655]
+	  [lcd4linux @ 2006-04-09 14:17:49 by reinelt]
+	  autoconf/library fixes, image and graphic display inversion
 
-	* Makefile.am, Makefile.in, plugin.c, plugin_xmms.c:
-	added XMMS plugin from Markus Keil
+2006-03-29  reinelt
 
-	* .cvsignore: added .cvsignore containing '*.lo'
+	* [r654]
+	  [lcd4linux @ 2006-03-29 08:57:58 by reinelt]
+	  vertical bar patch from Manuel Lausch
 
-	* plugin_math.c, plugin_string.c:
-	added plugin_math.c and plugin_string.c
+2006-03-18  harbaum
 
-	* Makefile.am, Makefile.in, plugin.c:
-	extracted plugin_math and plugin_string into extra files
+	* [r653]
+	  [lcd4linux @ 2006-03-18 14:54:36 by harbaum]
+	  Improved USB error recovery
 
-	* MatrixOrbital.c, cfg.c, client.c, client.h, lcd4linux.c, plugin.c, plugin.h, Makefile.am, Makefile.in:
-	renamed 'client' to 'plugin'
+2006-03-10  tooly-bln
 
-2003-12-01  Michael Reinelt  <reinelt@merlin.ethnet>
+	* [r652]
+	  [lcd4linux @ 2006-03-10 18:06:52 by tooly-bln]
+	  replace drv_generic_graphic_FB with drv_generic_graphic_black
 
-	* system.c, wifi.c, lcd4linux.c:
-	Patches from Xavier:
-	 - WiFi: make interface configurable
-	 - "quiet" as an option from the config file
-	 - ignore missing "MemShared" on Linux 2.6
+2006-02-27  reinelt
 
-2003-11-30  Michael Reinelt  <reinelt@merlin.ethnet>
+	* [r651]
+	  [lcd4linux @ 2006-02-27 08:12:34 by reinelt]
+	  use serdisplib's full color support
 
-	* Cwlinux.c:
-	Cwlinux: invalidate Framebuffer in case a char got redefined
+	* [r650]
+	  [lcd4linux @ 2006-02-27 07:53:52 by reinelt]
+	  some more graphic issues fixed
 
-2003-11-28  nicowallmeier  <nicowallmeier@merlin.ethnet>
+	* [r649]
+	  [lcd4linux @ 2006-02-27 06:15:55 by reinelt]
+	  indent...
 
-	* wifi.c: Minor bugfixes
+	* [r648]
+	  [lcd4linux @ 2006-02-27 06:14:46 by reinelt]
+	  graphic bug resulting in all black pixels solved
 
-2003-11-24  Michael Reinelt  <reinelt@merlin.ethnet>
+2006-02-25  geronet
 
-	* isdn.c, processor.c:
-	'Fixed' Rows which do not scroll by Lars Kempe
-	temporary workaround for debian kernel-header bug
+	* [r647]
+	  [lcd4linux @ 2006-02-25 13:36:33 by geronet]
+	  updated indent.sh, applied coding style
 
-2003-11-16  Michael Reinelt  <reinelt@merlin.ethnet>
+2006-02-24  geronet
 
-	* Crystalfontz.c, MatrixOrbital.c, lcd4linux.c:
-	Crystalfontz changes, small glitch in getopt() fixed
+	* [r646]
+	  [lcd4linux @ 2006-02-24 13:07:10 by geronet]
+	  hollow bars for graphic lcd's
 
-2003-11-14  Michael Reinelt  <reinelt@merlin.ethnet>
+2006-02-22  cmay
 
-	* wifi.c, wifi.h:
-	added wifi.c wifi.h which have been forgotten at the last checkin
+	* [r645]
+	  [lcd4linux @ 2006-02-22 15:59:39 by cmay]
+	  removed KEYPADSIZE cruft per harbaum's suggestion
 
-2003-11-12  Michael Reinelt  <reinelt@merlin.ethnet>
+2006-02-21  harbaum
 
-	* HD44780.c: small changes to the 16x4 handling
+	* [r644]
+	  [lcd4linux @ 2006-02-21 21:43:03 by harbaum]
+	  Keypad support for LCD2USB
 
-2003-11-11  Michael Reinelt  <reinelt@merlin.ethnet>
+2006-02-21  cmay
 
-	* Makefile.am, Makefile.in, parser.c, parser.h, processor.c:
-	WIFI patch from Xavier Vello
+	* [r643]
+	  [lcd4linux @ 2006-02-21 15:55:59 by cmay]
+	  removed new update function for keypad, consolidated it with draw
 
-	* TODO, dvb.c: very minor changes
+	* [r642]
+	  [lcd4linux @ 2006-02-21 15:52:30 by cmay]
+	  added back CF635 GPO counts in model struct lost after last merge
 
-2003-10-27  Michael Reinelt  <reinelt@merlin.ethnet>
+2006-02-21  reinelt
 
-	* README.Rows, README.Tokens, lcd4linux.conf.sample:
-	README.Rows, README.Tokens, lcd4linux.conf.sample from Thomas Siedentopf
+	* [r641]
+	  [lcd4linux @ 2006-02-21 05:50:34 by reinelt]
+	  keypad support from Cris Maj
 
-2003-10-22  Michael Reinelt  <reinelt@merlin.ethnet>
+2006-02-19  reinelt
 
-	* XWindow.c, icon.c: fixed icon bug found by Rob van Nieuwkerk
+	* [r640]
+	  [lcd4linux @ 2006-02-19 15:42:18 by reinelt]
+	  file plugin from Chris Maj
 
-	* Makefile.in, MatrixOrbital.c, icon.c, lcd4linux.c:
-	Makefile.in for imon.c/.h, some MatrixOrbital clients
+	* [r639]
+	  [lcd4linux @ 2006-02-19 15:37:38 by reinelt]
+	  CF635 GPO patch from cmaj
 
-2003-10-12  nicowallmeier  <nicowallmeier@merlin.ethnet>
+	* [r638]
+	  [lcd4linux @ 2006-02-19 07:20:53 by reinelt]
+	  image support nearly finished
 
-	* Makefile.am, imon.c, imon.h, parser.c, parser.h, processor.c:
-	imond/telmond support
+2006-02-12  harbaum
 
-2003-10-12  Michael Reinelt  <reinelt@merlin.ethnet>
+	* [r637]
+	  [lcd4linux @ 2006-02-12 14:32:24 by harbaum]
+	  Configurable bus/device id
 
-	* MatrixOrbital.c, processor.c, udelay.c:
+2006-02-09  harbaum
 
-	first try to integrate the Evaluator into a display driver (MatrixOrbital here)
-	small warning in processor.c fixed (thanks to Zachary Giles)
-	workaround for udelay() on alpha (no msr.h avaliable) (thanks to Zachary Giles)
+	* [r636]
+	  [lcd4linux @ 2006-02-09 20:32:49 by harbaum]
+	  LCD2USB bus testing, version verification ...
 
-2003-10-11  Michael Reinelt  <reinelt@merlin.ethnet>
+2006-02-08  reinelt
 
-	* evaluator.h, expression.c, expression.h, lcd4linux.c, Makefile.am, Makefile.in, cfg.c, client.c, client.h, config.guess, config.sub, evaluator.c:
-	renamed expression.{c,h} to client.{c,h}
-	added config file client
-	new functions 'AddNumericVariable()' and 'AddStringVariable()'
-	new parameter '-i' for interactive mode
+	* [r635]
+	  [lcd4linux @ 2006-02-08 04:55:03 by reinelt]
+	  moved widget registration to drv_generic_graphic
 
-2003-10-08  Michael Reinelt  <reinelt@merlin.ethnet>
+2006-02-07  reinelt
 
-	* ChangeLog, parport.c: Changelog; small type in parport.c
+	* [r634]
+	  [lcd4linux @ 2006-02-07 05:36:13 by reinelt]
+	  Layers added to Layout
 
-2003-10-08  andy-b  <andy-b@merlin.ethnet>
+2006-02-06  reinelt
 
-	* MilfordInstruments.c:
-	Cleaned up code in MilfordInstruments.c, and added descriptions for other display sizes (untested)
+	* [r633]
+	  [lcd4linux @ 2006-02-06 06:29:30 by reinelt]
+	  Image driver uses RGBA
 
-2003-10-08  nicowallmeier  <nicowallmeier@merlin.ethnet>
+2006-01-30  harbaum
 
-	* HD44780.c: special handling for 16x4 displays
+	* [r632]
+	  [lcd4linux @ 2006-01-30 20:21:51 by harbaum]
+	  LCD2USB: Added support for displays with two controllers
 
-	* HD44780.c: Support of two displays of the same size
+2006-01-30  reinelt
 
-2003-10-07  Michael Reinelt  <reinelt@merlin.ethnet>
+	* [r631]
+	  [lcd4linux @ 2006-01-30 12:53:07 by reinelt]
+	  replaced strncpy with strcpy where possible
 
-	* configure.in, Makefile.in, config.h.in, configure:
-	AM_PROG_LIBTOOL removed
+	* [r630]
+	  [lcd4linux @ 2006-01-30 06:31:25 by reinelt]
+	  ChangeLog
 
-2003-10-06  Michael Reinelt  <reinelt@merlin.ethnet>
+	* [r629]
+	  [lcd4linux @ 2006-01-30 06:25:48 by reinelt]
+	  added CVS Revision
 
-	* expression.c: functions: min(), max()
+	* [r628]
+	  [lcd4linux @ 2006-01-30 06:17:17 by reinelt]
+	  added CVS Revision
 
-	* evaluator.c, expression.c: operators: ==, \!=, <=, >=
+	* [r627]
+	  [lcd4linux @ 2006-01-30 06:11:36 by reinelt]
+	  changed Result->length to Result->size
 
-	* evaluator.c, evaluator.h, expression.c, expression.h:
-	expression evaluator added
+	* [r626]
+	  [lcd4linux @ 2006-01-30 05:47:34 by reinelt]
+	  graphic subsystem changed to full-color RGBA
 
-	* bootstrap, libtool: files 'libtool' and 'bootstrap' added
+2006-01-28  harbaum
 
-	* configure.in, Makefile.am, Makefile.in, configure:
-	libtool stuff again...
+	* [r625]
+	  [lcd4linux @ 2006-01-28 15:36:17 by harbaum]
+	  Fix: string termination bug in eval()
 
-2003-10-05  Michael Reinelt  <reinelt@merlin.ethnet>
+2006-01-26  harbaum
 
-	* BeckmannEgle.c, Crystalfontz.c, Cwlinux.c, HD44780.c, M50530.c, Makefile.am, Makefile.in, MatrixOrbital.c, MilfordInstruments.c, PalmPilot.c, Raster.c, SIN.c, Skeleton.c, T6963.c, Text.c, USBLCD.c, XWindow.c, bar.c, bar.h, battery.c, battery.h, cfg.c, cfg.h, debug.c, debug.h, display.c, display.h, dvb.c, dvb.h, exec.c, exec.h, filter.c, filter.h, fontmap.c, fontmap.h, icon.c, icon.h, isdn.c, isdn.h, lcd4linux.c, lock.c, lock.h, mail.c, mail.h, mail2.c, parport.c, parport.h, parser.c, parser.h, pid.c, pid.h, pixmap.c, pixmap.h, processor.c, processor.h, seti.c, seti.h, socket.c, socket.h, system.c, system.h, udelay.c, udelay.h, widget.c, widget.h:
-	libtool junk; copyright messages cleaned up
+	* [r624]
+	  [lcd4linux @ 2006-01-26 19:26:26 by harbaum]
+	  Added LCD2USB support
 
-2003-10-04  Michael Reinelt  <reinelt@merlin.ethnet>
+2006-01-23  reinelt
 
-	* configure.in, ltmain.sh, Makefile.am, Makefile.in, aclocal.m4, config.h.in, configure:
-	autoconf/automake/libtool fixes from Ronald Landheer-Cieslak
+	* [r623]
+	  [lcd4linux @ 2006-01-23 06:17:18 by reinelt]
+	  timer widget added
 
-2003-10-03  Michael Reinelt  <reinelt@merlin.ethnet>
+2006-01-22  reinelt
 
-	* parport.c:
-	compile error in parport fixed (thanks to Andrew from FilmCan)
+	* [r622]
+	  [lcd4linux @ 2006-01-22 10:01:09 by reinelt]
+	  allow 'static' icons with speed=0
 
-	* MatrixOrbital.c, processor.c:
-	start support for new MatrixOrbital MX2 displays
+	* [r621]
+	  [lcd4linux @ 2006-01-22 09:16:05 by reinelt]
+	  Image Widget framework added
 
-2003-09-29  Michael Reinelt  <reinelt@merlin.ethnet>
+2006-01-21  reinelt
 
-	* configure.in, display.c, Makefile.am, Makefile.in, MilfordInstruments.c, config.h.in, configure:
-	new driver for Milford Instruments MI420 by Andy Baxter
+	* [r620]
+	  [lcd4linux @ 2006-01-21 17:43:25 by reinelt]
+	  minor cosmetic fixes
 
-	* HD44780.c, MatrixOrbital.c, T6963.c:
-	changed default HD44780 wiring: unused signals are GND
+	* [r619]
+	  [lcd4linux @ 2006-01-21 15:25:02 by reinelt]
+	  GPIO subsystem in drivers.m4 added
 
-2003-09-21  Michael Reinelt  <reinelt@merlin.ethnet>
+	* [r618]
+	  [lcd4linux @ 2006-01-21 13:26:43 by reinelt]
+	  Logitech G-15 keyboard LCD driver from Dave Ingram
 
-	* HD44780.c, MatrixOrbital.c:
+	* [r617]
+	  [lcd4linux @ 2006-01-21 09:40:20 by reinelt]
+	  Big Memory Leak in Evaluator fixed (thanks to Oliver Gehrke)
 
-	MatrixOrbital: bidirectional communication
-	HD44780: special handling for 16x1 displays (thanks to anonymous bug report on sf.net)
+2006-01-20  reinelt
 
-2003-09-19  Michael Reinelt  <reinelt@merlin.ethnet>
+	* [r616]
+	  [lcd4linux @ 2006-01-20 15:58:05 by reinelt]
+	  MySQL::count() added again
 
-	* ChangeLog, configure, configure.in, lock.c:
+	* [r615]
+	  [lcd4linux @ 2006-01-20 15:43:25 by reinelt]
+	  MySQL::query() returns a value, not the number of rows
 
-	increased version number to 0.9.12
-	port locking is done as /var/lock/LCK..usb_tts_0 for /dev/usb/tts/0
+2006-01-18  reinelt
 
-	* Makefile.am, Makefile.in, TODO, icon.c, widget.c, widget.h:
-	minor fixes, widget.c added
+	* [r614]
+	  [lcd4linux @ 2006-01-18 11:49:48 by reinelt]
+	  adopted to lcd-linux-0.9.2
 
-2003-09-13  Michael Reinelt  <reinelt@merlin.ethnet>
+2006-01-16  reinelt
 
-	* ChangeLog, configure, configure.in: Changelog
+	* [r613]
+	  [lcd4linux @ 2006-01-16 15:39:58 by reinelt]
+	  MySQL::queryvalue() extension from Harald Klemm
 
-	* BeckmannEgle.c, Crystalfontz.c, Cwlinux.c, MatrixOrbital.c, PalmPilot.c, SIN.c, Skeleton.c, T6963.c, Text.c:
-	icons for all remaining drivers
+2006-01-06  tooly-bln
 
-	* HD44780.c, Makefile.am, Makefile.in, aclocal.m4, config.h.in, configure, configure.in:
-	HD44780 timings changed; deactivated libtool
+	* [r612]
+	  [lcd4linux @ 2006-01-06 16:56:49 by tooly-bln]
 
-2003-09-11  Michael Reinelt  <reinelt@merlin.ethnet>
+2006-01-06  reinelt
 
-	* config.sub, configure, configure.in:
-	missing files for autoconf/automake/libtool
+	* [r611]
+	  [lcd4linux @ 2006-01-06 08:12:19 by reinelt]
+	  GPO's for Crystalfontz
 
-	* M50530.c, MatrixOrbital.c, USBLCD.c, icon.c, processor.c, HD44780.c:
-	minor cleanups
+	* [r610]
+	  [lcd4linux @ 2006-01-06 07:06:57 by reinelt]
+	  GPO's for RouterBoard
 
-2003-09-10  Michael Reinelt  <reinelt@merlin.ethnet>
+2006-01-05  reinelt
 
-	* Makefile.in, configure, configure.in, processor.c: minor cleanups
+	* [r609]
+	  [lcd4linux @ 2006-01-05 19:27:26 by reinelt]
+	  HD44780 power supply from parport
 
-	* ChangeLog: ChangeLog
+	* [r608]
+	  [lcd4linux @ 2006-01-05 18:56:57 by reinelt]
+	  more GPO stuff
 
-	* XWindow.c, icon.c, pixmap.c, pixmap.h, processor.c, Raster.c:
-	icons nearly finished\!
+2006-01-05  nicowallmeier
 
-	* lcd4linux.c, processor.c: icons: reorganized tick_* again...
+	* [r607]
+	  [lcd4linux @ 2006-01-05 15:53:45 by nicowallmeier]
+	  fixed compatility with gcc 2.95
 
-	* MatrixOrbital.c, USBLCD.c, display.c, icon.c, processor.c, HD44780.c, M50530.c:
-	Icons for M50530, new processing scheme (Ticks.Text...)
+2006-01-03  reinelt
 
-2003-09-09  Michael Reinelt  <reinelt@merlin.ethnet>
+	* [r606]
+	  [lcd4linux @ 2006-01-03 13:20:05 by reinelt]
+	  LUIse driver added
 
-	* HD44780.c, MatrixOrbital.c, USBLCD.c: basic icon support for HD44780
+	* [r605]
+	  [lcd4linux @ 2006-01-03 06:13:44 by reinelt]
+	  GPIO's for MatrixOrbital
 
-	* Crystalfontz.c, Cwlinux.c, HD44780.c, M50530.c, MatrixOrbital.c, PalmPilot.c, Raster.c, USBLCD.c, XWindow.c, cfg.c, cfg.h, filter.c, lcd4linux.c, parport.c, processor.c:
-	new function 'cfg_number()'
+2005-12-20  reinelt
 
-	* TODO, USBLCD.c, bar.c, display.c, display.h, icon.c, icon.h, lcd4linux.c, processor.c, processor.h, MatrixOrbital.c:
-	even more icons stuff
+	* [r604]
+	  [lcd4linux @ 2005-12-20 07:07:43 by reinelt]
+	  further work on GPO's, HD44780 GPO support
 
-2003-09-01  Michael Reinelt  <reinelt@merlin.ethnet>
+2005-12-19  reinelt
 
-	* aclocal.m4, config.guess, config.h.in, configure, configure.in, ltmain.sh, Makefile.am, Makefile.in:
-	shared liblcd4linux
+	* [r603]
+	  [lcd4linux @ 2005-12-19 05:08:27 by reinelt]
+	  GPO's added to the Sample driver
 
-	* icon.h, parser.c, parser.h, processor.c, MatrixOrbital.c, bar.c, display.c, display.h, icon.c:
-	icons nearly finished, but MatrixOrbital only
+2005-12-18  reinelt
 
-2003-08-24  Michael Reinelt  <reinelt@eunet.at>
+	* [r602]
+	  [lcd4linux @ 2005-12-18 16:18:34 by reinelt]
+	  GPO's added again
 
-	* BeckmannEgle.c, Crystalfontz.c, Cwlinux.c, HD44780.c, M50530.c, Makefile.am, Makefile.in, MatrixOrbital.c, PalmPilot.c, Raster.c, SIN.c, Text.c, USBLCD.c, cfg.c, cfg.h, debug.c, debug.h, display.c, display.h, icon.c, lcd4linux.c, parport.c, processor.c, seti.c, system.c:
-	liblcd4linux patch from Patrick Schemitz
+2005-12-13  reinelt
 
-	* Makefile.am, Makefile.in, MatrixOrbital.c, display.c, icon.c, icon.h:
-	icon.c icon.h added
+	* [r601]
+	  [lcd4linux @ 2005-12-13 14:07:28 by reinelt]
+	  LPH7508 driver finished
 
-2003-08-22  Michael Reinelt  <reinelt@eunet.at>
+2005-12-12  reinelt
 
-	* parport.c, HD44780.c, MatrixOrbital.c:
-	bug in parallel port code fixed, more icons stuff
+	* [r600]
+	  [lcd4linux @ 2005-12-12 09:08:08 by reinelt]
+	  finally removed old udelay code path; read timing values from
+	  config
 
-2003-08-20  Michael Reinelt  <reinelt@eunet.at>
+	* [r599]
+	  [lcd4linux @ 2005-12-12 05:52:03 by reinelt]
+	  type of delays is 'unsigned long'
 
-	* bar.c: small bug in bar compaction fixed
+2005-12-11  reinelt
 
-2003-08-19  Michael Reinelt  <reinelt@eunet.at>
+	* [r598]
+	  [lcd4linux @ 2005-12-11 14:55:28 by reinelt]
+	  contrast range for BWCT is 0..255, not 0..100
 
-	* HD44780.c, parport.c:
-	HD44780 dual-controller patch from Jesse Brook Kovach
+2005-11-06  reinelt
 
-	* Crystalfontz.c, HD44780.c, MatrixOrbital.c, bar.c:
-	more Icon stuff, minor glitches fixed
+	* [r597]
+	  [lcd4linux @ 2005-11-06 09:54:43 by reinelt]
+	  fixed icon size removed, uses XRES & YRES (I hope this doesn't
+	  lead to problemes...)
 
-2003-08-17  Michael Reinelt  <reinelt@eunet.at>
+	* [r596]
+	  [lcd4linux @ 2005-11-06 09:17:20 by reinelt]
+	  re-use icons (thanks to Jesus de Santos Garcia)
 
-	* MatrixOrbital.c, display.c, display.h, lcd4linux.c, processor.c:
-	more icon framework
+2005-11-05  reinelt
 
-	* PalmPilot.c, Raster.c, SIN.c, Skeleton.c, display.c, display.h:
-	framework for icons prepared
+	* [r595]
+	  [lcd4linux @ 2005-11-05 06:34:09 by reinelt]
+	  README.Drivers removed
 
-	* Makefile.am, Makefile.in, SIN.c, Skeleton.c, configure, configure.in:
-	preparations for liblcd4linux; minor bugs in SIN.c and Skeleton.c
+	* [r594]
+	  [lcd4linux @ 2005-11-05 06:26:51 by reinelt]
+	  littly typo corrected
 
-	* ChangeLog, Crystalfontz.c, Crystalfontz.h, Makefile.am, Makefile.in:
-	complete rewrite of the Crystalfontz driver
+2005-11-04  reinelt
 
-	* config.guess: added config.guess
+	* [r593]
+	  [lcd4linux @ 2005-11-04 14:10:38 by reinelt]
+	  drv_Sample and drv_LPH7508
 
-2003-08-16  Michael Reinelt  <reinelt@eunet.at>
+	* [r592]
+	  [lcd4linux @ 2005-11-04 05:39:33 by reinelt]
+	  README.Plugins removed
 
-	* BeckmannEgle.c, Cwlinux.c, HD44780.c, M50530.c, MatrixOrbital.c, T6963.c, USBLCD.c, parport.c:
-	double buffering in all drivers
+	* [r591]
+	  [lcd4linux @ 2005-11-04 04:53:08 by reinelt]
+	  sample plugin activated
 
-2003-08-15  Michael Reinelt  <reinelt@eunet.at>
+	* [r590]
+	  [lcd4linux @ 2005-11-04 04:44:52 by reinelt]
+	  LPH7508 driver (not yet finished)
 
-	* HD44780.c, M50530.c, T6963.c, parport.c, parport.h:
-	HD44780 4 bit mode implemented
+2005-10-02  reinelt
 
-2003-08-14  Michael Reinelt  <reinelt@eunet.at>
+	* [r589]
+	  [lcd4linux @ 2005-10-02 07:58:48 by reinelt]
+	  HD44780 address setup time increased
 
-	* Makefile.am, Makefile.in, configure, configure.in:
-	changed version to 0.9.11, added curses.m4 to Makefile.am
+2005-09-14  reinelt
 
-	* ChangeLog: ChangeLog
+	* [r588]
+	  [lcd4linux @ 2005-09-14 15:08:32 by reinelt]
+	  fixed drivers.m4 to link generic text driver for several displays
+	  (thanks to Ludovic Gomez for pointing this out)
 
-	* cfg.c, lcd4linux.c: remove PID file if driver initialisation fails
+2005-09-07  reinelt
 
-2003-08-12  Michael Reinelt  <reinelt@eunet.at>
+	* [r587]
+	  [lcd4linux @ 2005-09-07 06:51:44 by reinelt]
+	  Support for CF635 added
 
-	* HD44780.c, config.h.in, configure:
-	first version of HD44780 4Bit-Mode patch
+2005-09-02  reinelt
 
-2003-08-11  Michael Reinelt  <reinelt@eunet.at>
+	* [r586]
+	  [lcd4linux @ 2005-09-02 05:27:08 by reinelt]
+	  double-fork daemonize patch from Petri Damsten
 
-	* configure.in: another uClibc issue: realloc
+2005-08-27  reinelt
 
-2003-08-08  Michael Reinelt  <reinelt@eunet.at>
+	* [r585]
+	  [lcd4linux @ 2005-08-27 07:02:25 by reinelt]
+	  LCD-Linux updated to 0.9.0
 
-	* ChangeLog, configure, configure.in: *** empty log message ***
+2005-08-22  reinelt
 
-	* dvb.c, dvb.h: CVS Id and Log missing from dvb.{c,h}
+	* [r584]
+	  [lcd4linux @ 2005-08-22 05:44:43 by reinelt]
+	  new driver 'WincorNixdorf'
+	  some fixes to the bar code
 
-	* Makefile.am, Makefile.in, lcd4linux.c, pid.c, pid.h:
-	added PID file handling
+2005-08-21  reinelt
 
-	* ChangeLog, configure, debug.c, lcd4linux.c: improved forking
+	* [r583]
+	  [lcd4linux @ 2005-08-21 08:18:56 by reinelt]
+	  CrystalFontz ACK processing
 
-	* ChangeLog, TODO, config.h.in, configure, configure.in, dvb.c, CREDITS:
-	uClibc compatibility issue; small glitch in dvb.c
+2005-08-20  reinelt
 
-2003-08-01  Michael Reinelt  <reinelt@eunet.at>
+	* [r582]
+	  [lcd4linux @ 2005-08-20 10:10:13 by reinelt]
+	  TREFON patch from Stephan Trautvetter:
+	  drv_TF_init: CHAR0 set to 0 instead of 1
+	  drv_TF_write: combine the GOTO and the data into one packet
+	  drv_TF_write: add GOTO-Case for resolutions 8x1/20x4 characters
+	  drv_TF_start: test for existing resolutions from TREFON USB-LCDs
+	  implemented
+	  the use of 'asc255bug 1' is recommendable
 
-	* Cwlinux.c, Makefile.am, Makefile.in, README, T6963.c:
-	last cleanups for 0.9.9
+2005-07-06  reinelt
 
-2003-07-29  Michael Reinelt  <reinelt@eunet.at>
+	* [r581]
+	  [lcd4linux @ 2005-07-06 04:40:18 by reinelt]
+	  GCC-4 fixes
 
-	* Makefile.in, Raster.c, aclocal.m4, configure, configure.in:
-	disable Raster driver automagically if gd.h not found
+2005-06-19  reinelt
 
-2003-07-28  Michael Reinelt  <reinelt@eunet.at>
+	* [r580]
+	  [lcd4linux @ 2005-06-19 17:57:06 by reinelt]
+	  cosmetics...
 
-	* README.Crystalfontz, README.HD44780, README.HD44780.GPO, README.MatrixOrbital, README.Png, README.Raster, README.Text, README.Webinterface, README.X11:
-	several README's moved to web page
+2005-06-15  reinelt
 
-2003-07-24  Michael Reinelt  <reinelt@eunet.at>
+	* [r579]
+	  [lcd4linux @ 2005-06-15 05:24:35 by reinelt]
+	  updated LCD-Linux driver to version 0.8.9
 
-	* BeckmannEgle.c, Crystalfontz.c, Cwlinux.c, HD44780.c, M50530.c, MatrixOrbital.c, PalmPilot.c, Raster.c, SIN.c, Skeleton.c, T6963.c, Text.c, USBLCD.c, XWindow.c, display.c, display.h, lcd4linux.c, processor.c:
-	'soft clear' needed for virtual rows
+2005-06-13  reinelt
 
-2003-07-21  Michael Reinelt  <reinelt@eunet.at>
+	* [r578]
+	  [lcd4linux @ 2005-06-13 03:43:46 by reinelt]
+	  undo PPEXCL activation...
 
-	* processor.c: bars on virtual rows fixed
+	* [r577]
+	  [lcd4linux @ 2005-06-13 03:38:25 by reinelt]
+	  try PPEXCL again, but ignore result
 
-	* processor.c: removed maxlen parameter from process_row()
+2005-06-11  reinelt
 
-	* dvb.c: check for HAVE_LINUX_DVB_FRONTEND_H needs config.h
+	* [r576]
+	  [lcd4linux @ 2005-06-11 10:57:45 by reinelt]
+	  changed version to 0.10.1-CVS
 
-2003-07-19  Michael Reinelt  <reinelt@eunet.at>
+	* [r575]
+	  [lcd4linux @ 2005-06-11 04:14:05 by reinelt]
+	  final 0.10.0 release, Changelog updated
 
-	* config.h.in, configure, configure.in, dvb.c:
-	check for dvb/frontend.h and disable DVB client if not found.
+2005-06-10  reinelt
 
-2003-07-18  Michael Reinelt  <reinelt@eunet.at>
+	* [r574]
+	  [lcd4linux @ 2005-06-10 11:22:28 by reinelt]
+	  double-check for X11 headers (AC_PATH_XTRA is buggy)
 
-	* udelay.c: udelay: unnecessary sanity check removed
+	* [r573]
+	  [lcd4linux @ 2005-06-10 09:51:44 by reinelt]
+	  depcomp removed
 
-2003-06-26  Michael Reinelt  <reinelt@eunet.at>
+	* [r572]
+	  [lcd4linux @ 2005-06-10 05:02:28 by reinelt]
+	  ChangeLog
 
-	* system.c: bug in /proc/net/dev parsing fixed
+	* [r571]
+	  [lcd4linux @ 2005-06-10 05:00:36 by reinelt]
+	  version number set to 0.10.0
 
-2003-06-22  Michael Reinelt  <reinelt@eunet.at>
+	* [r570]
+	  [lcd4linux @ 2005-06-10 04:54:10 by reinelt]
+	  removed ltmain.sh
 
-	* dvb.c, dvb.h: added dvb.c dvb.h
+	* [r569]
+	  [lcd4linux @ 2005-06-10 04:53:44 by reinelt]
+	  removed libtool and ltmain.sh
 
-2003-06-21  Michael Reinelt  <reinelt@eunet.at>
+2005-06-09  reinelt
 
-	* Makefile.am, Makefile.in, isdn.c, parser.c, parser.h, processor.c:
-	DVB client integrated
+	* [r568]
+	  [lcd4linux @ 2005-06-09 17:41:47 by reinelt]
+	  M50530 fixes (many thanks to Szymon Bieganski)
 
-2003-06-13  Michael Reinelt  <reinelt@eunet.at>
+2005-06-06  reinelt
 
-	* processor.c: added scrolling capability
+	* [r567]
+	  [lcd4linux @ 2005-06-06 09:24:07 by reinelt]
+	  two bugs in plugin_mysql.c fixed
 
-	* lcd4linux.c, seti.c, system.c: error message cosmetics
+2005-06-03  reinelt
 
-2003-05-19  Michael Reinelt  <reinelt@eunet.at>
+	* [r566]
+	  [lcd4linux @ 2005-06-03 17:04:52 by reinelt]
+	  hopefully solved the AM_PYTHON_PATH issue finally
 
-	* Cwlinux.c: Cwlinux sleep optimization
+	* [r565]
+	  [lcd4linux @ 2005-06-03 04:45:57 by reinelt]
+	  renamed AM_PYTHON to MY_PYTHON...
 
-2003-05-14  Michael Reinelt  <reinelt@eunet.at>
+2005-06-01  reinelt
 
-	* Cwlinux.c: added support for CW1602
+	* [r564]
+	  [lcd4linux @ 2005-06-01 12:50:25 by reinelt]
+	  ifdef'ed unused function to avoid compiler warning
 
-2003-04-12  Michael Reinelt  <reinelt@eunet.at>
+	* [r563]
+	  [lcd4linux @ 2005-06-01 12:46:31 by reinelt]
+	  --with-python added to configure
 
-	* XWindow.c: small glitch in XWindow.c (thanks to Moe Wibble)
+	* [r562]
+	  [lcd4linux @ 2005-06-01 12:09:11 by reinelt]
+	  removed ^M from lcd4linux_i2c.h; indent.sh run
 
-2003-04-07  Michael Reinelt  <reinelt@eunet.at>
+2005-06-01  pk_richman
 
-	* parport.h, parport.c, lcd4linux.c, T6963.c, M50530.c, HD44780.c:
-	further parallel port abstraction
+	* [r561]
+	  [lcd4linux @ 2005-06-01 11:17:54 by pk_richman]
+	  marked unused parameters
 
-2003-04-04  Michael Reinelt  <reinelt@eunet.at>
+2005-05-31  lfcorreia
 
-	* udelay.c, parport.c, parport.h, configure.in, configure, HD44780.c, M50530.c, USBLCD.c:
-	new parallel port abstraction scheme
+	* [r560]
+	  [lcd4linux @ 2005-05-31 21:30:56 by lfcorreia]
+	  fix my email address
 
-2003-02-27  Michael Reinelt  <reinelt@eunet.at>
+	* [r559]
+	  [lcd4linux @ 2005-05-31 21:28:42 by lfcorreia]
+	  fix typo
 
-	* configure, configure.in: changed versioning scheme from 0.99 to 0.9.9
+	* [r558]
+	  [lcd4linux @ 2005-05-31 21:26:56 by lfcorreia]
+	  fix my email address
 
-	* configure.in, curses.m4, install-sh, missing, mkinstalldirs, udelay.c, INSTALL, Makefile.in, aclocal.m4, config.h.in, configure:
-	asm/msr.h: included hard-coded definition of rdtscl() if msr.h cannot be found.
+	* [r557]
+	  [lcd4linux @ 2005-05-31 21:06:36 by lfcorreia]
+	  replace the accidently deleted Python detection code
 
-	autoconf/automake/autoanything: switched back to 1.4. Hope it works again.
+	* [r556]
+	  [lcd4linux @ 2005-05-31 20:42:54 by lfcorreia]
+	  new file: lcd4linux_i2c.h
+	  avoid the problems detecting the proper I2C kernel include files
+	  
+	  rearrange all the other autoconf stuff to remove I2C detection
+	  
+	  new method by Paul Kamphuis to write to the I2C device
 
-2003-02-24  Michael Reinelt  <reinelt@eunet.at>
+2005-05-28  reinelt
 
-	* Cwlinux.c: cwlinux fixes
+	* [r555]
+	  [lcd4linux @ 2005-05-28 09:08:30 by reinelt]
+	  fixed plugins.m4 bug found by Martin
 
-2003-02-22  Michael Reinelt  <reinelt@eunet.at>
+	* [r554]
+	  [lcd4linux @ 2005-05-28 09:06:14 by reinelt]
+	  serdisplib cosmetics
 
-	* M50530.c, MatrixOrbital.c, PalmPilot.c, Raster.c, SIN.c, T6963.c, Text.c, USBLCD.c, XWindow.c, cfg.c, cfg.h, exec.c, filter.c, lcd4linux.c, mail.c, mail2.c, processor.c, seti.c, system.c, BeckmannEgle.c, Crystalfontz.c, Cwlinux.c, HD44780.c:
-	cfg_get(key,defval)
+2005-05-13  reinelt
 
-	* Cwlinux.c: Cwlinux fixes
+	* [r553]
+	  [lcd4linux @ 2005-05-13 05:44:44 by reinelt]
+	  ChangeLog updated
 
-2003-02-18  Michael Reinelt  <reinelt@eunet.at>
+	* [r552]
+	  [lcd4linux @ 2005-05-13 05:43:25 by reinelt]
+	  added drv_LCDLinux.h to extra_sources
 
-	* README.X11, XWindow.c: X11 driver fixes and cleanup
+2005-05-12  reinelt
 
-2003-02-17  Michael Reinelt  <reinelt@eunet.at>
+	* [r551]
+	  [lcd4linux @ 2005-05-12 14:55:47 by reinelt]
+	  plugins for serdisplib driver
 
-	* XWindow.c: small bug in X11 driver: omit pixel gap between cahracters
+	* [r550]
+	  [lcd4linux @ 2005-05-12 05:52:43 by reinelt]
+	  serdisplib GET_VERSION_MAJOR macro
 
-	* Text.c: Text (curses) driver: cosmetic changes
+2005-05-11  reinelt
 
-2003-02-13  Michael Reinelt  <reinelt@eunet.at>
+	* [r549]
+	  [lcd4linux @ 2005-05-11 04:27:49 by reinelt]
+	  small serdisplib bugs fixed
 
-	* MatrixOrbital.c, lcd4linux.c:
-	changed "copyright" to "2003"
-	added slightly different protocol for MatrixOrbital "LK202" displays
+2005-05-10  reinelt
 
-2003-02-05  Michael Reinelt  <reinelt@eunet.at>
+	* [r548]
+	  [lcd4linux @ 2005-05-10 13:20:10 by reinelt]
+	  added serdisplib driver
 
-	* exec.c, processor.c:
-	T_EXEC: remove trailing CR/LF
-	T_EXEC: deactivated maxlen calculation (for I don't understand what it is for :-)
+2005-05-08  reinelt
 
-2003-01-12  Michael Reinelt  <reinelt@eunet.at>
+	* [r547]
+	  [lcd4linux @ 2005-05-08 04:32:43 by reinelt]
+	  CodingStyle added and applied
 
-	* bar.c: fixed bug in bar compaction
+2005-05-06  reinelt
 
-2002-12-08  Michael Reinelt  <reinelt@eunet.at>
+	* [r546]
+	  [lcd4linux @ 2005-05-06 06:41:53 by reinelt]
+	  python2.4 added to python.m4
 
-	* configure.in, curses.m4, depcomp, AUTHORS, ChangeLog, Makefile.am, Makefile.in, acconfig.h, aclocal.m4, config.h.in, configure:
-	autoconf/automake cleanup
+	* [r545]
+	  [lcd4linux @ 2005-05-06 06:37:34 by reinelt]
+	  hollow bar patch from geronet
 
-2002-12-06  Michael Reinelt  <reinelt@eunet.at>
+	* [r544]
+	  [lcd4linux @ 2005-05-06 05:40:02 by reinelt]
+	  remove documentation pass#2
 
-	* Makefile.in, aclocal.m4, config.h.in, configure, configure.in, CREDITS:
-	libgd/libpng bugfix: removed '-lpng -lz' from LDFLAGS
+	* [r543]
+	  [lcd4linux @ 2005-05-06 05:36:58 by reinelt]
+	  removed documentation again :-(
 
-2002-12-05  Michael Reinelt  <reinelt@eunet.at>
+2005-05-05  reinelt
 
-	* mail2.c, parser.c, processor.c:
-	fixed undefined operations found by gcc3
+	* [r542]
+	  [lcd4linux @ 2005-05-05 08:36:12 by reinelt]
+	  changed SELECT to SLCTIN
 
-	* system.c:
-	sensors factor and offset patch from Petri Damsten <petri.damsten@raketti.net>
+2005-05-04  obconseil
 
-	* Makefile.am, Makefile.in, configure, configure.in, display.c, socket.c:
-	patches for gcc-3.2
+	* [r541]
+	  [lcd4linux @ 2005-05-04 07:18:44 by obconseil]
+	  Driver modified according to Michels's recommendations :
+	  
+	  - Suppressed linux/parport.h depandancy. It was not needed
+	  anyway.
+	  - Compile-time disable the wait_busy polling function, replaced
+	  with a time wait.
+	  - Replaced the hardwire_* calls by their wire_* equivalent, to
+	  adapt other wirings.
+	  - Created a "Models" structure, containing parameters for the
+	  display.
+	  - Other cleanups, to remove compile-time warnings.
 
-2002-09-12  Michael Reinelt  <reinelt@eunet.at>
+2005-05-04  reinelt
 
-	* Cwlinux.c: code cleanup, character defining for bars
+	* [r540]
+	  [lcd4linux @ 2005-05-04 06:13:05 by reinelt]
+	  parport_wire_status() added
 
-2002-09-11  Michael Reinelt  <reinelt@eunet.at>
+	* [r539]
+	  [lcd4linux @ 2005-05-04 05:42:37 by reinelt]
+	  Noritake driver added
 
-	* Cwlinux.c: changed to use new bar functions
+	* [r538]
+	  [lcd4linux @ 2005-05-04 05:22:12 by reinelt]
+	  * replaced fprintf(stderr,... with error()
+	  * corrected a "dangling reference" memory problem
+	  * removed some PyErr_Print() spam
+	  * fixed a segmentation fault that occured when python module was
+	  not
+	  found
+	  * improved error messages
 
-	* display.c, Cwlinux.c, Makefile.am, Makefile.in, acconfig.h, config.h.in, configure, configure.in:
-	added Cwlinux driver
+2005-05-03  reinelt
 
-2002-08-30  Michael Reinelt  <reinelt@eunet.at>
+	* [r537]
+	  [lcd4linux @ 2005-05-03 11:13:23 by reinelt]
+	  rearranged autoconf a bit,
+	  libX11 will be linked only if really needed (i.e. when the X11
+	  driver has been selected)
+	  plugin_python filled with life
 
-	* Text.c: bug in curses driver fixed
+2005-05-02  reinelt
 
-2002-08-22  Michael Reinelt  <reinelt@eunet.at>
+	* [r536]
+	  [lcd4linux @ 2005-05-02 10:29:20 by reinelt]
+	  preparations for python bindings and python plugin
 
-	* BeckmannEgle.c: cosmetic changes
+	* [r535]
+	  [lcd4linux @ 2005-05-02 05:15:46 by reinelt]
+	  make busy-flag checking configurable for LCD-Linux driver
 
-2002-08-21  Michael Reinelt  <reinelt@eunet.at>
+2005-04-30  reinelt
 
-	* T6963.c, udelay.c: some T6963 fixes, ndelay wrap
+	* [r534]
+	  [lcd4linux @ 2005-04-30 06:02:09 by reinelt]
+	  LCD-Linux display size set up from lcd4linux.conf
 
-2002-08-19  Michael Reinelt  <reinelt@eunet.at>
+2005-04-24  reinelt
 
-	* BeckmannEgle.c, M50530.c:
-	M50530 driver using new generic bar functions
+	* [r533]
+	  [lcd4linux @ 2005-04-24 05:27:09 by reinelt]
+	  Trefon Backlight added
 
-	* BeckmannEgle.c: BeckmannEgle using new generic bar functions
+	* [r532]
+	  [lcd4linux @ 2005-04-24 04:41:28 by reinelt]
+	  Changelog updated
 
-	* MatrixOrbital.c: MatrixOrbital uses generic bar funnctions
+	* [r531]
+	  [lcd4linux @ 2005-04-24 04:33:46 by reinelt]
+	  driver for TREFON USB LCD's added
 
-	* HD44780.c, USBLCD.c: changed HD44780 to use generic bar functions
+2005-04-20  reinelt
 
-	* USBLCD.c, bar.c, bar.h: corrected type declaration of (*defchar)()
+	* [r530]
+	  [lcd4linux @ 2005-04-20 05:49:21 by reinelt]
+	  Changed the code to add some VT100-compatible control sequences
+	  (see the comments above).
+	  A configfile boolean option 'VT100_Support' (default to 1)
+	  indicate if the display in
+	  used support these control-sequences or not.
 
-	* BeckmannEgle.c, HD44780.c, M50530.c, MatrixOrbital.c, USBLCD.c, bar.c, bar.h:
-	finished bar.c, USBLCD is the first driver that uses the generic bar functions
+2005-04-09  reinelt
 
-	* BeckmannEgle.c, Crystalfontz.c, HD44780.c, M50530.c, Makefile.am, Makefile.in, MatrixOrbital.c, PalmPilot.c, Raster.c, T6963.c, Text.c, USBLCD.c, XWindow.c, bar.c, bar.h, display.c, display.h, parser.c, pixmap.c, processor.c:
-	introduced bar.c, moved bar stuff from display.h to bar.h
+	* [r529]
+	  [lcd4linux @ 2005-04-09 07:36:42 by reinelt]
+	  updated LCD-Linux driver to version 0.8.8
 
-2002-08-18  Michael Reinelt  <reinelt@eunet.at>
+2005-04-05  reinelt
 
-	* USBLCD.c: USBLCD buffered I/O
+	* [r528]
+	  [lcd4linux @ 2005-04-05 06:57:39 by reinelt]
+	  AC_CHECK_HEADERS corrected
 
-2002-08-17  Michael Reinelt  <reinelt@eunet.at>
+	* [r527]
+	  [lcd4linux @ 2005-04-05 05:12:48 by reinelt]
+	  i2c patch from Paul (still does not work here :-(
 
-	* HD44780.c, USBLCD.c, udelay.c:
-	USBLCD fixes
+	* [r526]
+	  [lcd4linux @ 2005-04-05 04:46:06 by reinelt]
+	  ceil/floor patch from Maxime
 
-	* configure.in, display.c, lcd4linux.conf.sample, Makefile.am, Makefile.in, USBLCD.c, acconfig.h, config.h.in, configure:
-	USBLCD driver added
+2005-04-04  nicowallmeier
 
-	* T6963.c: minor T6963 changes
+	* [r525]
+	  [lcd4linux @ 2005-04-04 20:11:14 by nicowallmeier]
+	  to be compatible with gcc 2.95
 
-2002-04-30  Michael Reinelt  <reinelt@eunet.at>
+2005-04-03  reinelt
 
-	* HD44780.c, M50530.c:
-	implemented the new ndelay(nanoseconds) in all parallel port drivers
+	* [r524]
+	  [lcd4linux @ 2005-04-03 07:07:43 by reinelt]
+	  added statfs plugin
 
-2002-04-29  Michael Reinelt  <reinelt@eunet.at>
+2005-04-02  reinelt
 
-	* configure.in, display.c, exec.c, lcd4linux.c, udelay.c, udelay.h, acconfig.h, aclocal.m4, config.h.in, configure, README, T6963.c, TODO, Makefile.in:
-	added Toshiba T6963 driver
-	added ndelay() with nanosecond resolution
+	* [r523]
+	  [lcd4linux @ 2005-04-02 05:28:58 by reinelt]
+	  fixed gcc4 warnings about signed/unsigned mismatches
 
-2001-09-14  Michael Reinelt  <reinelt@eunet.at>
+2005-04-01  reinelt
 
-	* TODO: *** empty log message ***
+	* [r522]
+	  [lcd4linux @ 2005-04-01 05:16:04 by reinelt]
+	  moved plugin init stuff to a seperate function called on first
+	  use
 
-2001-09-13  Michael Reinelt  <reinelt@eunet.at>
+2005-03-30  reinelt
 
-	* TODO: TODO update
+	* [r521]
+	  [lcd4linux @ 2005-03-30 04:57:50 by reinelt]
+	  Evaluator speedup: use bsearch for finding functions and
+	  variables
 
-2001-09-12  Michael Reinelt  <reinelt@eunet.at>
+2005-03-28  reinelt
 
-	* TODO, mail2.c: *** empty log message ***
+	* [r520]
+	  [lcd4linux @ 2005-03-28 22:29:23 by reinelt]
+	  HD44780 multiple displays patch from geronet
 
-	* mail.c, mail2.c, socket.c: fixed bug in mail2.c
+	* [r519]
+	  [lcd4linux @ 2005-03-28 19:39:14 by reinelt]
+	  HD44780/I2C patch from Luis merged (still does not work for me)
 
-	* debug.h, mail.c, seti.c, socket.c:
-	fixed a bug in seti.c (file was never closed, lcd4linux run out of fd's
+2005-03-25  reinelt
 
-	improved socket debugging
+	* [r518]
+	  [lcd4linux @ 2005-03-25 15:44:43 by reinelt]
+	  HD44780 Backlight fixed (thanks to geronet)
 
-2001-09-11  Michael Reinelt  <reinelt@eunet.at>
+2005-03-23  reinelt
 
-	* TODO: TODO items
+	* [r517]
+	  [lcd4linux @ 2005-03-23 12:23:35 by reinelt]
+	  fixed some signed/unsigned char mismatches in the Crystalfontz
+	  driver (ticket #12)
 
-	* M50530.c: M50530 driver
+2005-02-24  reinelt
 
-2001-09-10  Michael Reinelt  <reinelt@eunet.at>
+	* [r516]
+	  [lcd4linux @ 2005-02-24 07:07:55 by reinelt]
+	  ChangeLog
 
-	* Makefile.in, Raster.c, acconfig.h, config.h.in, configure, configure.in, display.c:
-	M50530 driver
+	* [r515]
+	  [lcd4linux @ 2005-02-24 07:06:45 by reinelt]
+	  SimpleLCD driver added
 
-2001-09-09  Michael Reinelt  <reinelt@eunet.at>
+	* [r514]
+	  [lcd4linux @ 2005-02-24 06:51:40 by reinelt]
+	  LCD-Linux driver GOTO_COST corrected
 
-	* HD44780.c: GPO bug: INIT is _not_ inverted
+2005-01-30  reinelt
 
-2001-09-07  Michael Reinelt  <reinelt@eunet.at>
+	* [r513]
+	  [lcd4linux @ 2005-01-30 06:43:22 by reinelt]
+	  driver for LCD-Linux finished
 
-	* README.HD44780.GPO: wrong Pin numbers
+2005-01-29  reinelt
 
-2001-09-05  Michael Reinelt  <reinelt@eunet.at>
+	* [r512]
+	  [lcd4linux @ 2005-01-29 09:30:56 by reinelt]
+	  minor HD44780 cleanups
 
-	* NEWS, README: *** empty log message ***
+2005-01-22  reinelt
 
-2001-08-08  Michael Reinelt  <reinelt@eunet.at>
+	* [r511]
+	  [lcd4linux @ 2005-01-22 22:57:57 by reinelt]
+	  LCD-Linux driver added
 
-	* udelay.c:
-	renamed CLK_TCK to CLOCKS_PER_SEC
+	* [r510]
+	  [lcd4linux @ 2005-01-22 12:44:41 by reinelt]
+	  MatrixOrbital backlight micro-fix
 
-2001-08-05  Michael Reinelt  <reinelt@eunet.at>
+2005-01-18  reinelt
 
-	* XWindow.c, battery.c, filter.c, mail.c, seti.c, system.c:
-	cleaned up inlude of sys/time.h and time.h
+	* [r509]
+	  [lcd4linux @ 2005-01-18 06:30:21 by reinelt]
+	  added (C) to all copyright statements
 
-2001-06-04  Michael Reinelt  <reinelt@eunet.at>
+2005-01-17  reinelt
 
-	* configure, configure.in:
-	configure for X11 modified
+	* [r508]
+	  [lcd4linux @ 2005-01-17 06:38:48 by reinelt]
+	  info about backlight and brightness
 
-2001-05-31  ltoetsch  <ltoetsch@lizard.reinelt>
+	* [r507]
+	  [lcd4linux @ 2005-01-17 06:29:24 by reinelt]
+	  added software-controlled backlight support to HD44780
 
-	* Makefile.in, TODO, acconfig.h, config.h.in, configure, configure.in, curses.m4:
-	added tests for X and ncurses
+2005-01-15  reinelt
 
-2001-05-27  Michael Reinelt  <reinelt@eunet.at>
+	* [r506]
+	  [lcd4linux @ 2005-01-15 13:13:57 by reinelt]
+	  LCDTerm driver added, take 2
 
-	* README:
-	updated README with the seti@home client stuff
+	* [r505]
+	  [lcd4linux @ 2005-01-15 13:13:21 by reinelt]
+	  LCDTerm section added to lcd4linux.conf.sample
 
-	* configure, configure.in, isdn.c, pixmap.c:
-	fixed a warning in pixmap.c
-	temporarily fixed a bug in isdn.c (ISDN_MAX_CHANNELS is no longer defined?)
-	fixed a bug in configure.in (--with-drivers=xyz did not work)
+	* [r504]
+	  [lcd4linux @ 2005-01-15 13:10:13 by reinelt]
+	  LCDTerm driver added
 
-2001-05-26  Michael Reinelt  <reinelt@eunet.at>
+2005-01-11  reinelt
 
-	* TODO: added TODO entry
+	* [r503]
+	  [lcd4linux @ 2005-01-11 10:25:26 by reinelt]
+	  further changes to lcd4linux.conf.sample
 
-2001-05-06  Michael Reinelt  <reinelt@eunet.at>
+	* [r502]
+	  [lcd4linux @ 2005-01-11 10:19:33 by reinelt]
+	  changes to lcd4linux.conf.sample
 
-	* processor.c:
-	fixed a bug which prevented extendet tokens to be used for GPO's
-	many thanks to Carsten Nau!
+2005-01-09  reinelt
 
-2001-04-27  Michael Reinelt  <reinelt@eunet.at>
+	* [r501]
+	  [lcd4linux @ 2005-01-09 10:57:25 by reinelt]
+	  ChangeLog updated
 
-	* BeckmannEgle.c, Crystalfontz.c, MatrixOrbital.c, PalmPilot.c, SIN.c, configure, lcd4linux.c, lock.c, pixmap.c:
-	replaced OPEN_MAX with sysconf()
-	replaced mktemp() with mkstemp()
-	unlock serial port if open() fails
+	* [r500]
+	  [lcd4linux @ 2005-01-09 10:53:22 by reinelt]
+	  small type in plugin_uname fixed
+	  new homepage lcd4linux.bulix.org
 
-2001-03-24  Michael Reinelt  <reinelt@eunet.at>
+2005-01-06  reinelt
 
-	* TODO: new TODO item
+	* [r499]
+	  [lcd4linux @ 2005-01-06 16:54:53 by reinelt]
+	  M50530 fixes
 
-2001-03-17  ltoetsch  <ltoetsch@lizard.reinelt>
+2004-12-22  reinelt
 
-	* pixmap.c: allow more then 1 BAR_T
+	* [r498]
+	  [lcd4linux @ 2004-12-22 20:24:00 by reinelt]
+	  T6963 fix for displays > 8 rows
 
-	* processor.c: bugfix: max for BAR_T
+2004-11-30  reinelt
 
-2001-03-16  ltoetsch  <ltoetsch@lizard.reinelt>
+	* [r497]
+	  [lcd4linux @ 2004-11-30 05:01:25 by reinelt]
+	  removed compiler warnings for deactivated i2c bus
 
-	* NEWS, PalmPilot.c, README, Raster.c, TODO, Text.c, XWindow.c, display.c, display.h, parser.c, pixmap.c, processor.c:
-	implemented time bar
+2004-11-29  reinelt
 
-	* README.Text, TODO, Text.c, mail2.c, processor.c: bugfixes
+	* [r496]
+	  [lcd4linux @ 2004-11-29 04:42:06 by reinelt]
+	  removed the 99999 msec limit on widget update time (thanks to
+	  Petri Damsten)
 
-2001-03-15  ltoetsch  <ltoetsch@lizard.reinelt>
+2004-11-28  reinelt
 
-	* mail.c, processor.c, HD44780.c: fixed compile HD44780.c, cosmetics
+	* [r495]
+	  [lcd4linux @ 2004-11-28 15:50:24 by reinelt]
+	  Cwlinux fixes (invalidation of user-defined chars)
 
-	* CREDITS, NEWS, README, TODO, configure, display.c, lcd4linux.conf.sample, mail.c, mail.h, mail2.c, socket.c:
-	added unread/total news
+2004-10-17  reinelt
 
-	* mail2.c: added quit/logout to pop/imap
+	* [r494]
+	  [lcd4linux @ 2004-10-17 09:24:31 by reinelt]
+	  I2C support for HD44780 displays by Luis (does not work by now)
 
-2001-03-15  Michael Reinelt  <reinelt@eunet.at>
+2004-10-02  reinelt
 
-	* HD44780.c, lcd4linux.conf.sample, processor.c:
-	some fixes to ppdef
-	off-by-one bug in processor.c fixed
+	* [r493]
+	  [lcd4linux @ 2004-10-02 09:31:55 by reinelt]
+	  USBLCD driver modified to use libusb
 
-2001-03-15  ltoetsch  <ltoetsch@lizard.reinelt>
+2004-09-24  reinelt
 
-	* exec.c: delay first exec for faster start
+	* [r492]
+	  [lcd4linux @ 2004-09-24 21:40:52 by reinelt]
+	  new driver for the BWCT USB LCD interface board.
 
-2001-03-14  Michael Reinelt  <reinelt@eunet.at>
+2004-09-19  reinelt
 
-	* CREDITS, HD44780.c, TODO: minor cleanups
+	* [r491]
+	  [lcd4linux @ 2004-09-19 09:31:19 by reinelt]
+	  HD44780 busy flag checking improved: fall back to busy-waiting if
+	  too many errors occur
 
-	* HD44780.c:
-	make ppdev compatible to earlier kernels
+2004-09-18  reinelt
 
-	* HD44780.c, NEWS, README.HD44780, TODO, config.h.in, configure, configure.in, lcd4linux.conf.sample:
-	added ppdev parallel port access
+	* [r490]
+	  [lcd4linux @ 2004-09-18 15:58:57 by reinelt]
+	  even more HD44780 cleanups, hardwiring for LCM-162
 
-2001-03-14  ltoetsch  <ltoetsch@lizard.reinelt>
+	* [r489]
+	  [lcd4linux @ 2004-09-18 10:57:29 by reinelt]
+	  more parport/i2c cleanups
 
-	* Makefile.am, Makefile.in, NEWS, README, TODO, configure, debug.h, lcd4linux.conf.sample, mail.c, mail.h, mail2.c, parser.c, parser.h, processor.c, socket.c, socket.h:
-	Added pop3/imap4 mail support
+	* [r488]
+	  [lcd4linux @ 2004-09-18 09:48:29 by reinelt]
+	  HD44780 cleanup and prepararation for I2C backend
+	  LCM-162 submodel framework
 
-2001-03-13  Michael Reinelt  <reinelt@eunet.at>
+	* [r487]
+	  [lcd4linux @ 2004-09-18 08:22:59 by reinelt]
+	  drv_generic_parport_status() to read status lines
 
-	* exec.c, lcd4linux.conf.sample, mail.c, parser.c, processor.c, system.c:
-	corrected a off-by-one bug with sensors
+2004-08-30  rjoco77
 
-	* Makefile.am, Makefile.in, acconfig.h:
-	added missing autoheader files
+	* [r486]
+	  [lcd4linux @ 2004-08-30 12:48:52 by rjoco77]
+	  * Added backlight update immediatelly
 
-	* Makefile.am, Makefile.in:
-	added several files for the distribution
+2004-08-29  reinelt
 
-	* NEWS, README, lcd4linux.c:
-	added NEWS file
+	* [r485]
+	  [lcd4linux @ 2004-08-29 20:07:55 by reinelt]
+	  Patch from Joco: Make RouterBoard Backlight configurable
 
-2001-03-12  Michael Reinelt  <reinelt@eunet.at>
+	* [r484]
+	  [lcd4linux @ 2004-08-29 13:03:40 by reinelt]
+	  added RouterBoard driver
 
-	* HD44780.c, TODO, config.h.in, configure, configure.in, lcd4linux.conf.sample, udelay.c, udelay.h:
-	new udelay() using Time Stamp Counters
+2004-07-14  reinelt
 
-	* configure, configure.in:
-	even better configure handling...
+	* [r483]
+	  [lcd4linux @ 2004-07-14 04:44:44 by reinelt]
+	  Beckmann+Egle fix
+	  added smaple widget for the PPP plugin
 
-	* HD44780.c, Makefile.in, Raster.c, TODO, aclocal.m4, config.h.in, configure, configure.in, debug.c, display.c, lcd4linux.c, system.c, udelay.c, udelay.h:
-	reworked autoconf a lot: drivers may be excluded, #define's went to config.h
+2004-06-29  reinelt
 
-2001-03-09  ltoetsch  <ltoetsch@lizard.reinelt>
+	* [r482]
+	  [lcd4linux @ 2004-06-29 04:49:30 by reinelt]
+	  B+E enhanced port detection
 
-	* configure, configure.in: disable driver in configure
+2004-06-26  reinelt
 
-2001-03-09  Michael Reinelt  <reinelt@eunet.at>
+	* [r481]
+	  [lcd4linux @ 2004-06-26 12:04:59 by reinelt]
+	  uh-oh... the last CVS log message messed up things a lot...
 
-	* TODO, Text.c, configure:
-	rename 'raster' to 'Text in Text.c
-	added TOTO item
+	* [r480]
+	  [lcd4linux @ 2004-06-26 09:27:20 by reinelt]
+	  added '-W' to CFLAGS
+	  changed all C++ comments to C ones ('//' => '/* */')
+	  cleaned up a lot of signed/unsigned mistakes
 
-	* TODO:
-	new ideas for TODO
+	* [r479]
+	  [lcd4linux @ 2004-06-26 06:12:14 by reinelt]
+	  support for Beckmann+Egle Compact Terminals
+	  some mostly cosmetic changes in the MatrixOrbital and USBLCD
+	  driver
+	  added debugging to the generic serial driver
+	  fixed a bug in the generic text driver where icons could be drawn
+	  outside
+	  the display bounds
 
-2001-03-09  ltoetsch  <ltoetsch@lizard.reinelt>
+2004-06-24  nicowallmeier
 
-	* README, exec.c, lcd4linux.conf.sample: exec: Scale_x ->Min/Max_x
+	* [r478]
+	  [lcd4linux @ 2004-06-24 20:18:08 by nicowallmeier]
+	  minor bugfix
 
-	* Makefile.am, Makefile.in, README, README.Drivers, README.Text, Skeleton.c, Text.c, configure, configure.in, debug.c, display.c, lcd4linux.conf.sample:
-	Added Text driver
+2004-06-20  reinelt
 
-2001-03-09  Michael Reinelt  <reinelt@eunet.at>
+	* [r477]
+	  [lcd4linux @ 2004-06-20 10:12:27 by reinelt]
+	  ChangeLog updated
 
-	* TODO, cfg.c, lcd4linux.conf.sample, system.c:
-	minor cleanups
+	* [r476]
+	  [lcd4linux @ 2004-06-20 10:09:52 by reinelt]
+	  'const'ified the whole source
 
-2001-03-08  ltoetsch  <ltoetsch@lizard.reinelt>
+2004-06-19  reinelt
 
-	* README, TODO, cfg.c, exec.c, exec.h, lcd4linux.c, lcd4linux.conf.sample, parser.c, processor.c:
-	improved exec
+	* [r475]
+	  [lcd4linux @ 2004-06-19 08:20:19 by reinelt]
+	  compiler warning in image driver fixed
+	  bar bug in USBLCD driver fixed
 
-2001-03-08  Michael Reinelt  <reinelt@eunet.at>
+2004-06-17  reinelt
 
-	* mail.c, mail.h, seti.c, seti.h:
-	seti client cleanup
+	* [r474]
+	  [lcd4linux @ 2004-06-17 10:58:57 by reinelt]
+	  changed plugin_netdev to use the new fast hash model
 
-	* processor.c, exec.c:
-	fixed two typos
+	* [r473]
+	  [lcd4linux @ 2004-06-17 06:23:39 by reinelt]
+	  hash handling rewritten to solve performance issues
 
-2001-03-07  ltoetsch  <ltoetsch@lizard.reinelt>
+2004-06-13  reinelt
 
-	* Makefile.am, Makefile.in, README, cfg.c, configure, exec.c, exec.h, parser.c, parser.h, processor.c:
-	added e(x)ec commands
+	* [r472]
+	  [lcd4linux @ 2004-06-13 01:12:52 by reinelt]
+	  debug widgets changed (thanks to Andy Baxter)
 
-2001-03-05  Michael Reinelt  <reinelt@eunet.at>
+2004-06-09  reinelt
 
-	* TODO, lcd4linux.conf.sample:
-	TOTO list update
+	* [r471]
+	  [lcd4linux @ 2004-06-09 06:40:29 by reinelt]
+	  splash screen for T6963 driver
 
-2001-03-04  ltoetsch  <ltoetsch@lizard.reinelt>
+2004-06-08  reinelt
 
-	* README.Raster: Added PNG
+	* [r470]
+	  [lcd4linux @ 2004-06-08 21:46:38 by reinelt]
+	  splash screen for X11 driver (and generic graphic driver)
 
-2001-03-02  Michael Reinelt  <reinelt@eunet.at>
+	* [r469]
+	  [lcd4linux @ 2004-06-08 12:35:24 by reinelt]
+	  autoconf/automake updates
 
-	* configure, configure.in, system.c:
-	allow compile on systems without net/if_ppp.h
+2004-06-07  reinelt
 
-	* README.Png:
-	README for PNG added
+	* [r468]
+	  [lcd4linux @ 2004-06-07 07:02:13 by reinelt]
+	  sample debugging widgets added
 
-	* Raster.c, configure, configure.in:
-	let configure find gd.h
+	* [r467]
+	  [lcd4linux @ 2004-06-07 06:56:55 by reinelt]
+	  added test plugin from Andy Baxter
 
-	* battery.c, battery.h:
-	cosmetic cleanups (comment headers)
+2004-06-06  reinelt
 
-2001-03-02  ltoetsch  <ltoetsch@lizard.reinelt>
+	* [r466]
+	  [lcd4linux @ 2004-06-06 06:51:59 by reinelt]
+	  do not display end splash screen if quiet=1
 
-	* Makefile.am, Makefile.in, README, lcd4linux.conf.sample, Raster.c, TODO, battery.c, battery.h, parser.c, parser.h, processor.c:
-	added /proc/apm battery stat
+2004-06-05  reinelt
 
-2001-03-01  Michael Reinelt  <reinelt@eunet.at>
+	* [r465]
+	  [lcd4linux @ 2004-06-05 14:56:48 by reinelt]
+	  Cwlinux splash screen fixed
+	  USBLCD splash screen fixed
+	  plugin_i2c qprintf("%f") replaced with snprintf()
 
-	* Raster.c, lcd4linux.conf.sample, udelay.c:
-	renamed Raster_flush() to PPM_flush()
+	* [r464]
+	  [lcd4linux @ 2004-06-05 06:41:39 by reinelt]
+	  chancged splash screen again
 
-2001-03-01  ltoetsch  <ltoetsch@lizard.reinelt>
+	* [r463]
+	  [lcd4linux @ 2004-06-05 06:13:11 by reinelt]
+	  splash screen for all text-based display drivers
 
-	* README.Webinterface, Raster.c, nph-png, png.html:
-	added PNG,Webinterface
+2004-06-02  reinelt
 
-2001-03-01  Michael Reinelt  <reinelt@eunet.at>
+	* [r462]
+	  [lcd4linux @ 2004-06-02 10:09:22 by reinelt]
+	  splash screen for HD44780
 
-	* Makefile.am, Makefile.in, Raster.c, XWindow.c, aclocal.m4, configure, configure.in, display.c:
-	reworked configure to allow selection of drivers
+	* [r461]
+	  [lcd4linux @ 2004-06-02 09:41:19 by reinelt]
+	  prepared support for startup splash screen
 
-2001-02-26  herp  <herp@lizard.reinelt>
+	* [r460]
+	  [lcd4linux @ 2004-06-02 05:56:25 by reinelt]
+	  extended contrast range for Crystalfontz
 
-	* XWindow.c: fixed X11 signal handler
+	* [r459]
+	  [lcd4linux @ 2004-06-02 05:35:55 by reinelt]
+	  added i2c_sensors example to lcd4linux.conf.sample
 
-2001-02-21  Michael Reinelt  <reinelt@eunet.at>
+	* [r458]
+	  [lcd4linux @ 2004-06-02 05:27:59 by reinelt]
+	  added documentation tree
 
-	* mail.c:
-	big mailbox patch from Axel Ehnert
-	thanks to herp for his idea to check mtime of mailbox
+	* [r457]
+	  [lcd4linux @ 2004-06-02 05:14:16 by reinelt]
+	  fixed models listing for Beckmann+Egle driver
+	  some cosmetic changes
 
-2001-02-19  Michael Reinelt  <reinelt@eunet.at>
+2004-06-01  reinelt
 
-	* Makefile.am, Makefile.in, lcd4linux.conf.sample, mail.c, parser.c, parser.h, processor.c, seti.c, seti.h:
-	integrated mail and seti client
-	major rewrite of parser and tokenizer to support double-byte tokens
+	* [r456]
+	  [lcd4linux @ 2004-06-01 06:45:28 by reinelt]
+	  some Fixme's processed
+	  documented some code
 
-2001-02-18  Michael Reinelt  <reinelt@eunet.at>
+	* [r455]
+	  [lcd4linux @ 2004-06-01 06:04:25 by reinelt]
+	  made README.Plugins and plugin_sample up to date.
 
-	* mail.c, mail.h, seti.c: *** empty log message ***
+2004-05-31  reinelt
 
-	* Makefile.am, Makefile.in, TODO, seti.c, seti.h:
-	added setiathome client
+	* [r454]
+	  [lcd4linux @ 2004-05-31 21:23:16 by reinelt]
+	  some cleanups in the MatrixOrbital driver
 
-	* CREDITS, Makefile.am, Makefile.in: *** empty log message ***
+	* [r453]
+	  [lcd4linux @ 2004-05-31 21:05:13 by reinelt]
+	  fixed lots of bugs in the Cwlinux driver
+	  do not emit EAGAIN error on the first retry
+	  made plugin_i2c_sensors a bit less 'chatty'
+	  moved init and exit functions to the bottom of plugin_pop3
 
-2001-02-16  Michael Reinelt  <reinelt@eunet.at>
+	* [r452]
+	  [lcd4linux @ 2004-05-31 16:39:05 by reinelt]
+	  added NULL display driver (for debugging/profiling purposes)
+	  added backlight/contrast initialisation for matrixOrbital
+	  added Backlight initialisation for Cwlinux
 
-	* README.HD44780.GPO, processor.c:
-	fixed type in processor.c
-	GPO documentation update from Carsten
+	* [r451]
+	  [lcd4linux @ 2004-05-31 06:27:34 by reinelt]
+	  ChangeLog update
 
-	* README, parser.c, parser.h, processor.c, system.c:
-	new token 'ic' (ISDN connected) by Carsten Nau <info@cnau.de>
+	* [r450]
+	  [lcd4linux @ 2004-05-31 06:24:42 by reinelt]
+	  fixed symlink security issue with the image driver
 
-2001-02-14  Michael Reinelt  <reinelt@eunet.at>
+	* [r449]
+	  [lcd4linux @ 2004-05-31 05:38:02 by reinelt]
+	  fixed possible bugs with user-defined chars (clear high bits)
+	  thanks to Andy Baxter for debugging the MilfordInstruments
+	  driver!
 
-	* HD44780.c, MatrixOrbital.c, display.c, display.h, lcd4linux.c, parser.c, parser.h, processor.c:
-	first (incomplete) GPO implementation
+2004-05-31  andy-b
 
-	* README.HD44780.GPO:
-	added README from Carsten Nau
+	* [r448]
+	  [lcd4linux @ 2004-05-31 01:31:01 by andy-b]
+	  fixed bug in Milford Instruments driver which drew extra graphics
+	  chars in
+	  odd places when drawing double bars. (the display doesn't like it
+	  if you put
+	  the escape character 0xfe inside a define char sequence).
 
-2001-02-13  Michael Reinelt  <reinelt@eunet.at>
+2004-05-30  reinelt
 
-	* HD44780.c:
-	HD_gpo() was missing
+	* [r447]
+	  [lcd4linux @ 2004-05-30 08:25:50 by reinelt]
+	  Crystalfontz 631 driver finished
 
-	* BeckmannEgle.c, Crystalfontz.c, HD44780.c, MatrixOrbital.c, PalmPilot.c, Raster.c, SIN.c, Skeleton.c, XWindow.c, display.c, display.h, processor.c:
-	prepared framework for GPO's (general purpose outputs)
+2004-05-29  reinelt
 
-2001-02-11  Michael Reinelt  <reinelt@eunet.at>
+	* [r446]
+	  [lcd4linux @ 2004-05-29 23:30:20 by reinelt]
+	  fixed a compiler issue with drv_Image.c (thanks to Frank
+	  Stratmann)
 
-	* TODO, processor.c:
+	* [r445]
+	  [lcd4linux @ 2004-05-29 15:53:28 by reinelt]
+	  M50530: reset parport signals on exit
+	  plugin_ppp: ppp() has two parameters, not three
+	  lcd4linux.conf.sample: diskstats() corrected
 
-	fixed a small bug where the throughput of an offline ISDN connection is displayed as '----', but the
-	online value is 5 chars long. corrected to ' ----'.
-	thanks to Carsten Nau <info@cnau.de>
+	* [r444]
+	  [lcd4linux @ 2004-05-29 01:07:56 by reinelt]
+	  bug in plugin_diskstats fixed
 
-2000-12-07  Michael Reinelt  <reinelt@eunet.at>
+	* [r443]
+	  [lcd4linux @ 2004-05-29 00:27:14 by reinelt]
+	  added plugin_diskstats.c
 
-	* SIN.c, TODO, lcd4linux.conf.sample:
-	first try for SIN bars
+2004-05-28  reinelt
 
-2000-12-01  Michael Reinelt  <reinelt@eunet.at>
+	* [r442]
+	  [lcd4linux @ 2004-05-28 14:38:10 by reinelt]
+	  Status and Changelog Update
 
-	* SIN.c, lcd4linux.conf.sample:
-	added debugging of SIN driver output, probably found the positioning bug (format %02x instead of %2x)
+	* [r441]
+	  [lcd4linux @ 2004-05-28 14:36:10 by reinelt]
+	  added drv_BeckmannEgle.c (forgotten at first check in :-)
 
-	* SIN.c:
-	modified text positioning: row starts with 0, column is hexadecimal
+	* [r440]
+	  [lcd4linux @ 2004-05-28 13:51:41 by reinelt]
+	  ported driver for Beckmann+Egle Mini-Terminals
+	  added 'flags' parameter to serial_init()
 
-2000-11-28  Michael Reinelt  <reinelt@eunet.at>
+2004-05-27  nicowallmeier
 
-	* debug.c:
-	added debug.c
-	things like that should not hapen. debug.c exists for a few months now, but was never added to CVS. Shit happens....
+	* [r439]
+	  [lcd4linux @ 2004-05-27 06:29:29 by nicowallmeier]
+	  Moved variables to Plugin:imon / Plugin:telmon
 
-	* SIN.c:
-	changed decimal values for screen, row, column to ascii values (shame on you!)
+2004-05-27  reinelt
 
-	* Makefile.am, Makefile.in, README, SIN.c, display.c:
-	first try to support display of SIN router
+	* [r438]
+	  [lcd4linux @ 2004-05-27 03:49:41 by reinelt]
+	  Status update
 
-2000-11-17  Michael Reinelt  <reinelt@eunet.at>
+	* [r437]
+	  [lcd4linux @ 2004-05-27 03:39:47 by reinelt]
+	  changed function naming scheme to plugin::function
 
-	* system.c:
-	fixed parsing of /proc/net/dev for 2.0 kernels
+2004-05-26  reinelt
 
-2000-10-25  Michael Reinelt  <reinelt@eunet.at>
+	* [r436]
+	  [lcd4linux @ 2004-05-26 11:37:35 by reinelt]
+	  Curses driver ported.
 
-	* lcd4linux.c:
-	added restart funnctionality
-	(lots of this code was stolen from sendmail.c)
+	* [r435]
+	  [lcd4linux @ 2004-05-26 05:03:24 by reinelt]
+	  MilfordInstruments driver ported
 
-2000-10-20  Michael Reinelt  <reinelt@eunet.at>
+2004-05-25  reinelt
 
-	* HD44780.c:
+	* [r434]
+	  [lcd4linux @ 2004-05-25 19:54:11 by reinelt]
+	  'make distcheck' bugs fixed
+	  release number changed to 0.10.0-RC1
 
-	corrected a bug in HD_goto()
-	Thanks to Gregor Szaktilla <gregor@szaktilla.de>
+	* [r433]
+	  [lcd4linux @ 2004-05-25 19:47:11 by reinelt]
+	  Status updated
+	  obsolete files removed
 
-2000-10-08  Michael Reinelt  <reinelt@eunet.at>
+	* [r432]
+	  [lcd4linux @ 2004-05-25 14:28:46 by reinelt]
+	  Changelog updated
 
-	* system.c:
+	* [r431]
+	  [lcd4linux @ 2004-05-25 14:27:21 by reinelt]
+	  added drv_Image.c (this time really!)
 
-	Linux-2.4.0-test9 changed the layout of /proc/stat (especially the disk_io line)
-	rearranged parsing of some /proc files and (hopefully) made it more robust in concerns of format changes
+	* [r430]
+	  [lcd4linux @ 2004-05-25 14:26:28 by reinelt]
+	  added "Image" driver (was: Raster.c) for PPM and PNG creation
+	  fixed some glitches in the X11 driver
 
-2000-08-10  Michael Reinelt  <reinelt@eunet.at>
+	* [r429]
+	  [lcd4linux @ 2004-05-25 06:42:31 by reinelt]
+	  removed old sample config lcd4linux.conf.sample.old from CVS
 
-	* XWindow.c, configure, configure.in, isdn.c, lcd4linux.c:
-	fixed some bugs with the new syslog code
+2004-05-23  reinelt
 
-	* BeckmannEgle.c, Crystalfontz.c, HD44780.c, Makefile.am, Makefile.in, MatrixOrbital.c, PalmPilot.c, README, Raster.c, Skeleton.c, XWindow.c, cfg.c, debug.h, display.c, fontmap.c, isdn.c, lcd4linux.c, lock.c, parser.c, processor.c, system.c:
-	new debugging scheme: error(), info(), debug()
-	uses syslog if in daemon mode
+	* [r428]
+	  [lcd4linux @ 2004-05-23 08:58:30 by reinelt]
+	  icon bug with USBLCD fixed
 
-2000-08-09  Michael Reinelt  <reinelt@eunet.at>
+2004-05-22  reinelt
 
-	* README, lcd4linux.c:
-	new switch -F (do not fork)
-	added automatic forking if -F not specified
+	* [r427]
+	  [lcd4linux @ 2004-05-22 18:30:01 by reinelt]
+	  added plugin 'uptime'
 
-	* system.c:
-	fixed a bug in system.c where the format of /proc/net/dev was not correctly
-	detected and parsed with different kernels
+	* [r426]
+	  [lcd4linux @ 2004-05-22 04:23:49 by reinelt]
+	  removed 16*x fix again (next time think before commit :-)
 
-	* BeckmannEgle.c, Crystalfontz.c, HD44780.c, MatrixOrbital.c, PalmPilot.c, README, XWindow.c, configure, configure.in, display.c, display.h, lcd4linux.c, system.c:
-	opened 0.98 development
-	removed driver-specific signal-handlers
-	added 'quit'-function to driver structure
-	added global signal-handler
+	* [r425]
+	  [lcd4linux @ 2004-05-22 04:21:02 by reinelt]
+	  fix for display RAM layout on 16x4 displays (thanks to
+	  toxicated101)
 
-2000-07-31  Michael Reinelt  <reinelt@eunet.at>
+2004-05-20  reinelt
 
-	* HD44780.c, configure, configure.in, lcd4linux.conf.sample, processor.c, system.c, system.h, udelay.c:
-	some changes to support kernel-2.4 (different layout of various files in /proc)
+	* [r424]
+	  [lcd4linux @ 2004-05-20 07:47:51 by reinelt]
+	  added plugin_time
 
-	* HD44780.c, Makefile.am, Makefile.in, cfg.c:
-	eliminated some compiler warnings with glibc
+	* [r423]
+	  [lcd4linux @ 2004-05-20 07:14:35 by reinelt]
+	  made all local functions static
 
-2000-06-04  herp  <herp@lizard.reinelt>
+2004-05-19  reinelt
 
-	* Crystalfontz.c: minor bugfix (zero length)
+	* [r422]
+	  [lcd4linux @ 2004-05-19 05:38:25 by reinelt]
+	  removed AC_PROG_CXX (C++-Compiler) from configure
 
-2000-05-21  Michael Reinelt  <reinelt@eunet.at>
+	* [r421]
+	  [lcd4linux @ 2004-05-19 05:23:25 by reinelt]
+	  plugin_isdn.c added (sorry, I forgot...)
 
-	* README.Drivers, lcd4linux.conf.sample, parser.c, parser.h, processor.c, system.c, system.h:
-	added ppp throughput
-	token is '%t[iomt]' at the moment, but this will change in the near future
+2004-05-09  reinelt
 
-2000-05-03  herp  <herp@lizard.reinelt>
+	* [r420]
+	  [lcd4linux @ 2004-05-09 05:41:41 by reinelt]
+	  i2c fix for kernel 2.6.5 (temp_input1 vs. temp1_input) from
+	  Xavier
 
-	* Crystalfontz.c, Crystalfontz.h, README.Crystalfontz:
-	*** empty log message ***
+2004-04-17  nicowallmeier
 
-2000-05-02  herp  <herp@lizard.reinelt>
+	* [r419]
+	  [lcd4linux @ 2004-04-17 13:03:34 by nicowallmeier]
+	  minor bugfix
 
-	* Makefile.am, Makefile.in, XWindow.c, display.c:
-	Crystalfontz initial coding
+2004-04-12  reinelt
 
-2000-05-02  Michael Reinelt  <reinelt@eunet.at>
+	* [r418]
+	  [lcd4linux @ 2004-04-12 11:12:24 by reinelt]
+	  added plugin_isdn, removed old ISDN client
+	  fixed some real bad bugs in the evaluator
 
-	* Makefile.am, Makefile.in, PalmPilot.c, display.c, lcd4linux.conf.sample:
-	driver for 3Com Palm Pilot added
+	* [r417]
+	  [lcd4linux @ 2004-04-12 05:59:24 by reinelt]
+	  Status update
 
-2000-04-30  Michael Reinelt  <reinelt@eunet.at>
+	* [r416]
+	  [lcd4linux @ 2004-04-12 05:14:42 by reinelt]
+	  another BIG FAT WARNING on the use of raw ports instead of ppdev
 
-	* BeckmannEgle.c, lcd4linux.conf.sample:
-	bars for Beckmann+Egle driver
+	* [r415]
+	  [lcd4linux @ 2004-04-12 04:55:59 by reinelt]
+	  emitted a BIG FAT WARNING if msr.h could not be found (and
+	  therefore
+	  the gettimeofday() delay loop would be used)
 
-2000-04-28  Michael Reinelt  <reinelt@eunet.at>
+2004-04-11  reinelt
 
-	* BeckmannEgle.c, Makefile.am, Makefile.in, TODO, display.c:
-	first release of the Beckmann+Egle driver
+	* [r414]
+	  [lcd4linux @ 2004-04-11 17:37:09 by reinelt]
+	  forgot these files at last checkin... sorry!
 
-2000-04-20  Michael Reinelt  <reinelt@eunet.at>
+2004-04-09  reinelt
 
-	* Makefile.am, Makefile.in:
-	added documentation to EXTRA_DIST so that they go into the tarball
+	* [r413]
+	  [lcd4linux @ 2004-04-09 06:23:28 by reinelt]
+	  removed old exec stuff
 
-2000-04-19  Michael Reinelt  <reinelt@eunet.at>
+	* [r412]
+	  [lcd4linux @ 2004-04-09 06:09:54 by reinelt]
+	  big configure rework from Xavier
 
-	* README.HD44780:
-	README for HD44780 driver
+2004-04-08  reinelt
 
-2000-04-17  Michael Reinelt  <reinelt@eunet.at>
+	* [r411]
+	  [lcd4linux @ 2004-04-08 11:59:26 by reinelt]
+	  added plugin_pop3 from Javi
 
-	* README.HD44780, lcd4linux.c, lcd4linux.conf.sample:
-	added README.44780
+	* [r410]
+	  [lcd4linux @ 2004-04-08 10:48:23 by reinelt]
+	  finished plugin_exec
+	  modified thread handling
+	  added '%x' format to qprintf (hexadecimal)
 
-2000-04-15  Michael Reinelt  <reinelt@eunet.at>
+2004-04-07  hejl
 
-	* HD44780.c, Makefile.am, Makefile.in, README, lcd4linux.c, udelay.c, udelay.h:
-	moved delay loops to udelay.c
-	renamed -d (debugging) switch to -v (verbose)
-	new switch -d to calibrate delay loop
-	'Delay' entry for HD44780 back again
-	delay loops will not calibrate automatically, because this will fail with hich CPU load
+	* [r409]
+	  [lcd4linux @ 2004-04-07 08:29:05 by hejl]
+	  New plugin for wireless info
 
-	* isdn.c, lcd4linux.c, processor.c, system.c:
-	more debug messages
+2004-03-21  reinelt
 
-	* HD44780.c, Makefile.am, Makefile.in, MatrixOrbital.c, README, cfg.c, debug.h, lcd4kde.conf, lcd4linux.c, processor.c:
-	added '-d' (debugging) switch
-	added several debugging messages
-	removed config entry 'Delay' for HD44780 driver
-	delay loop for HD44780 will be calibrated automatically
+	* [r408]
+	  [lcd4linux @ 2004-03-21 22:05:53 by reinelt]
+	  MySQL plugin fixes from Javi
 
-2000-04-13  Michael Reinelt  <reinelt@eunet.at>
+2004-03-20  reinelt
 
-	* HD44780.c, MatrixOrbital.c, lcd4linux.conf.sample, system.c, system.h:
-	added BogoMips() to system.c (not used by now, maybe sometimes we can
-	calibrate our delay loop with this value)
+	* [r407]
+	  [lcd4linux @ 2004-03-20 23:09:01 by reinelt]
+	  MySQL plugin fixes from Javi
 
-	added delay loop to HD44780 driver. It seems to be quite fast now. Hopefully
-	no compiler will optimize away the delay loop!
+	* [r406]
+	  [lcd4linux @ 2004-03-20 11:49:40 by reinelt]
+	  forgot to add plugin_exec.c ...
 
-2000-04-12  Michael Reinelt  <reinelt@eunet.at>
+	* [r405]
+	  [lcd4linux @ 2004-03-20 07:31:32 by reinelt]
+	  support for HD66712 (which has a different RAM layout)
+	  further threading development
 
-	* HD44780.c, Makefile.am, Makefile.in, MatrixOrbital.c, display.c, lcd4linux.conf.sample:
-	first version of the HD44780 driver
+2004-03-19  reinelt
 
-2000-04-10  Michael Reinelt  <reinelt@eunet.at>
+	* [r404]
+	  [lcd4linux @ 2004-03-19 09:17:46 by reinelt]
+	  removed the extra 'goto' function, row and col are additional
+	  parameters
+	  of the write() function now.
 
-	* MatrixOrbital.c, README, configure, configure.in, lcd4linux.c:
-	minor changes and cleanups
+	* [r403]
+	  [lcd4linux @ 2004-03-19 06:37:47 by reinelt]
+	  asynchronous thread handling started
 
-2000-04-07  Michael Reinelt  <reinelt@eunet.at>
+2004-03-14  reinelt
 
-	* Makefile.am, Makefile.in, MatrixOrbital.c, lcd4linux.c, lock.c, lock.h:
-	UUCP style lockfiles for the serial port
+	* [r402]
+	  [lcd4linux @ 2004-03-14 07:14:05 by reinelt]
+	  old battery.[ch] files removed
 
-2000-04-05  Michael Reinelt  <reinelt@eunet.at>
+	* [r401]
+	  [lcd4linux @ 2004-03-14 07:11:42 by reinelt]
+	  parameter count fixed for plugin_dvb()
+	  plugin_APM (battery status) ported
 
-	* Makefile.in, XWindow.c, configure, configure.in:
-	fixed bug in XWindow.c: union semun isn't defined with glibc-2.1
+	* [r400]
+	  [lcd4linux @ 2004-03-14 06:07:33 by reinelt]
+	  Status update.
+	  Fixed bug in configure.in with X11 disabled (thanks to Kevin Liu)
 
-	* TODO:
-	TODO added
+2004-03-13  reinelt
 
-2000-04-03  herp  <herp@lizard.reinelt>
+	* [r399]
+	  [lcd4linux @ 2004-03-13 19:06:01 by reinelt]
+	  ChangeLog and Status update; small glitch in plugin_seti fixed.
 
-	* XWindow.c:
-	fixed a bug that caused pixel-errors ("fliegendreck") under high load
+2004-03-13  nicowallmeier
 
-2000-04-03  Michael Reinelt  <reinelt@eunet.at>
+	* [r398]
+	  [lcd4linux @ 2004-03-13 14:58:15 by nicowallmeier]
+	  Added clean termination of imond-connection (now correctly)
 
-	* display.c, lcd4linux.c, lcd4linux.kdelnk, lcd4linux.xpm:
-	suppress welcome message if display is smaller than 20x2
-	change lcd4linux.ppm to 32 pixel high so KDE won't stretch the icon
+	* [r397]
+	  [lcd4linux @ 2004-03-13 14:55:14 by nicowallmeier]
+	  Added clean termination of imond-connection
 
-	* lcd4linux.kdelnk:
-	KDE application link
+2004-03-13  reinelt
 
-	* README.KDE, lcd4kde.conf, lcd4linux.conf.sample, lcd4linux.xpm:
-	releasing 0.96
-	annoying X11 bugs hopefully fixed
-	KDE integration
+	* [r396]
+	  [lcd4linux @ 2004-03-13 06:55:29 by reinelt]
+	  (unnecessary) imon.h removed
 
-	* README, README.Raster, README.X11, cfg.c, cfg.h, lcd4linux.c, lcd4linux.conf.sample:
-	added '-c key=val' option
+	* [r395]
+	  [lcd4linux @ 2004-03-13 06:49:20 by reinelt]
+	  seti@home plugin ported to NextGeneration
 
-	* Raster.c, XWindow.c, lcd4linux.conf.sample:
-	if 'gap' is specified as -1, a gap of (pixelsize+pixelgap) is selected automatically
+2004-03-12  reinelt
 
-2000-04-02  herp  <herp@lizard.reinelt>
+	* [r394]
+	  [lcd4linux @ 2004-03-12 13:58:14 by reinelt]
+	  removed imon.c (has been replaced by plugin_imon.c)
 
-	* XWindow.c: fixded a bug that occasionally caused Xlib errors
+2004-03-11  reinelt
 
-2000-04-01  herp  <herp@lizard.reinelt>
+	* [r393]
+	  [lcd4linux @ 2004-03-11 06:39:58 by reinelt]
+	  big patch from Martin:
+	  - reuse filehandles
+	  - memory leaks fixed
+	  - earlier busy-flag checking with HD44780
+	  - reuse memory for strings in RESULT and hash
+	  - netdev_fast to wavid time-consuming regex
 
-	* XWindow.c, lcd4linux.c: geometric correction (too many pixelgaps)
-	lcd4linux main should return int, not void
+2004-03-10  reinelt
 
-	* XWindow.c:
-	colors in format \#RRGGBB in config-file now understood
+	* [r392]
+	  [lcd4linux @ 2004-03-10 07:16:15 by reinelt]
+	  MySQL plugin from Javier added
 
-2000-04-01  Michael Reinelt  <reinelt@eunet.at>
+2004-03-08  hejl
 
-	* XWindow.c, configure, configure.in, lcd4linux.conf.sample, processor.c:
-	bug that caused a segfault in processor.c fixed (thanks to herp)
+	* [r391]
+	  [lcd4linux @ 2004-03-08 18:46:21 by hejl]
+	  Fixed bug introduced with "caching" the loadavg values
 
-2000-03-31  Michael Reinelt  <reinelt@eunet.at>
+	* [r390]
+	  [lcd4linux @ 2004-03-08 18:45:52 by hejl]
+	  fixed segfault when using string concatenation
 
-	* XWindow.c:
-	X11 driver: semaphore bug fixed
+2004-03-08  reinelt
 
-2000-03-30  Michael Reinelt  <reinelt@eunet.at>
+	* [r389]
+	  [lcd4linux @ 2004-03-08 16:26:26 by reinelt]
+	  re-introduced \nnn (octal) characters in strings
+	  text widgets can have a 'update' speed of 0 which means 'never'
+	  (may be used for static content)
 
-	* Makefile.am, Makefile.in, XWindow.c, aclocal.m4, configure, configure.in, display.c, lcd4linux.conf.sample, lcd4linux.lsm:
-	configure now handles '--with-x' and '--without-x' correct
+	* [r388]
+	  [lcd4linux @ 2004-03-08 04:33:08 by reinelt]
+	  string concatenation fixed
 
-2000-03-28  Michael Reinelt  <reinelt@eunet.at>
+2004-03-06  reinelt
 
-	* README.X11, XWindow.c:
-	README.X11 added
+	* [r387]
+	  [lcd4linux @ 2004-03-06 20:31:16 by reinelt]
+	  Complete rewrite of the evaluator to get rid of the code
+	  from mark Morley (because of license issues).
+	  The new Evaluator does a pre-compile of expressions, and
+	  stores them in trees. Therefore it should be reasonable faster...
 
-	* Makefile.am, Makefile.in, Raster.c, XWindow.c, cfg.c, configure, configure.in, lcd4linux.conf.sample, system.c:
-	version 0.95 released
-	X11 driver up and running
-	minor bugs fixed
+2004-03-03  hejl
 
-2000-03-26  Michael Reinelt  <reinelt@eunet.at>
+	* [r386]
+	  [lcd4linux @ 2004-03-03 08:40:07 by hejl]
+	  Fixed memory leak in hash_get_regex
 
-	* README.Raster, Raster.c, cfg.c, lcd4linux.conf.sample:
-	README.Raster added
+2004-03-03  reinelt
 
-	* README, Raster.c, XWindow.c, cfg.c, pixmap.h:
-	more Pixmap renaming
-	quoting of '#' in config file
+	* [r385]
+	  [lcd4linux @ 2004-03-03 04:44:16 by reinelt]
+	  changes (cosmetics?) to the big patch from Martin
+	  hash patch un-applied
 
-	* MatrixOrbital.c, README.Drivers, Raster.c, Skeleton.c, XWindow.c, display.c, display.h, lcd4linux.c, lcd4linux.conf.sample, pixmap.c:
-	bug in pixmap.c that leaded to empty bars fixed
-	name conflicts with X11 resolved
+	* [r384]
+	  [lcd4linux @ 2004-03-03 03:47:04 by reinelt]
+	  big patch from Martin Hejl:
+	  - use qprintf() where appropriate
+	  - save CPU cycles on gettimeofday()
+	  - add quit() functions to free allocated memory
+	  - fixed lots of memory leaks
 
-	* Raster.c, lcd4linux.c, lcd4linux.conf.sample:
-	enhancements to the PPM driver
+	* [r383]
+	  [lcd4linux @ 2004-03-03 03:41:02 by reinelt]
+	  Crystalfontz Contrast issue fixed
 
-2000-03-25  Michael Reinelt  <reinelt@eunet.at>
+2004-03-01  reinelt
 
-	* MatrixOrbital.c, Raster.c, Skeleton.c, XWindow.c, display.c, display.h, fontmap.c, lcd4linux.c, lcd4linux.conf.sample, pixmap.c:
-	memory leak in Raster_flush closed
-	driver family logic changed
+	* [r382]
+	  [lcd4linux @ 2004-03-01 04:29:51 by reinelt]
+	  cfg_number() returns -1 on error, 0 if value not found (but
+	  default val used),
+	  and 1 if value was used from the configuration.
+	  HD44780 driver adopted to new cfg_number()
+	  Crystalfontz 631 driver nearly finished
 
-2000-03-24  Michael Reinelt  <reinelt@eunet.at>
+2004-02-29  reinelt
 
-	* fontmap.h:
-	fontmap.h added
+	* [r381]
+	  [lcd4linux @ 2004-02-29 17:09:53 by reinelt]
+	  ChangeLog updated
+	  Version number bumped to 0.10.0
 
-	* Raster.c, XWindow.c, fontmap.c, lcd4linux.c, lcd4linux.conf.sample, parser.c, pixmap.c, pixmap.h:
-	new syntax for raster configuration
-	changed XRES and YRES to be configurable
-	PPM driver works nice
+	* [r380]
+	  [lcd4linux @ 2004-02-29 14:30:59 by reinelt]
+	  icon visibility fix for generic graphics from Xavier
 
-2000-03-23  Michael Reinelt  <reinelt@eunet.at>
+2004-02-27  reinelt
 
-	* Makefile.am, Makefile.in, MatrixOrbital.c, Raster.c, XWindow.c, display.c, filter.c, lcd4linux.c, lcd4linux.conf.sample, pixmap.c, processor.c, system.c:
-	PPM driver up and running (but slow!)
+	* [r379]
+	  [lcd4linux @ 2004-02-27 07:06:24 by reinelt]
+	  new function 'qprintf()' (simple but quick snprintf()
+	  replacement)
 
-2000-03-22  Michael Reinelt  <reinelt@eunet.at>
+	* [r378]
+	  [lcd4linux @ 2004-02-27 06:07:55 by reinelt]
+	  hash improvements from Martin
 
-	* Makefile.am, Makefile.in, XWindow.c, display.c, display.h, fontmap.c, lcd4linux.c, lcd4linux.conf.sample, pixmap.c, pixmap.h:
-	added '-l' switch (list drivers)
-	generic pixmap driver added
-	X11 Framework done
+2004-02-26  reinelt
 
-	* FAQ, Makefile.am, Makefile.in, MatrixOrbital.c, README.MatrixOrbital, Skeleton.c, configure, configure.in, filter.c, lcd4linux.c, lcd4linux.conf.sample, processor.c, processor.h:
-	FAQ added
-	new modules 'processor.c' contains all data processing
+	* [r377]
+	  [lcd4linux @ 2004-02-26 21:42:45 by reinelt]
+	  memory leak fixes from Martin
 
-2000-03-19  Michael Reinelt  <reinelt@eunet.at>
+2004-02-24  reinelt
 
-	* Makefile.am, Makefile.in, MatrixOrbital.c, README, README.Drivers, README.MatrixOrbital, Skeleton.c, display.c, lcd4linux.c, lcd4linux.conf.sample, parser.c, parser.h:
-	documentation available! README, README.MatrixOrbital, README.Drivers
-	added Skeleton.c as a starting point for new drivers
+	* [r376]
+	  [lcd4linux @ 2004-02-24 06:00:22 by reinelt]
+	  Status and Todo list from Xavier
 
-2000-03-18  Michael Reinelt  <reinelt@eunet.at>
+	* [r375]
+	  [lcd4linux @ 2004-02-24 05:54:57 by reinelt]
+	  X11 driver ported
 
-	* configure, configure.in, lcd4linux.c, lcd4linux.conf.sample, parser.c, parser.h:
-	added sensor handling (for temperature etc.)
-	made data collecting happen only if data is used
-	(reading /proc/meminfo takes a lot of CPU!)
-	released lcd4linux-0.92
+2004-02-23  reinelt
 
-	* MatrixOrbital.c, display.c, lcd4linux.c, lcd4linux.conf.sample, system.c:
-	vertical bars implemented
-	bar compaction improved
-	memory information implemented
+	* [r374]
+	  [lcd4linux @ 2004-02-23 06:44:27 by reinelt]
+	  "Lightning" widget from Xavier (lcd4linux.conf.sample)
+	  removed obsolete Docs.
 
-2000-03-17  Michael Reinelt  <reinelt@eunet.at>
+2004-02-22  reinelt
 
-	* MatrixOrbital.c, configure, configure.in, display.c, display.h, lcd4linux.c, lcd4linux.conf.sample, parser.c, parser.h, system.c, system.h:
-	various memory statistics added
+	* [r373]
+	  [lcd4linux @ 2004-02-22 17:35:41 by reinelt]
+	  some fixes for generic graphic driver and T6963
+	  removed ^M from plugin_imon (Nico, are you editing under
+	  Windows?)
 
-2000-03-13  Michael Reinelt  <reinelt@eunet.at>
+2004-02-18  nicowallmeier
 
-	* Makefile.am, Makefile.in, MatrixOrbital.c, configure, configure.in, display.c, display.h, isdn.c, isdn.h, lcd4linux.c, lcd4linux.conf.sample, lcd4linux.h, parser.c, parser.h:
-	release 0.9
-	moved row parsing to parser.c
-	all basic work finished
+	* [r372]
+	  [lcd4linux @ 2004-02-18 14:45:42 by nicowallmeier]
+	  Imon/Telmon plugin ported
 
-2000-03-10  Michael Reinelt  <reinelt@eunet.at>
+2004-02-18  reinelt
 
-	* Makefile, Makefile.am, Makefile.in, MatrixOrbital.c, cfg.c, configure, display.c, display.h, isdn.c, isdn.h, lcd4linux.c, lcd4linux.conf.sample, system.c, system.h:
-	first unstable but running release
+	* [r371]
+	  [lcd4linux @ 2004-02-18 06:39:20 by reinelt]
+	  T6963 driver for graphic displays finished
 
-	* COPYING, INSTALL, Makefile.am, Makefile.in, aclocal.m4, configure.in, install-sh, lcd2041.c, lcd2041.h, missing, mkinstalldirs:
-	autoconf/automake
+2004-02-17  reinelt
 
-	* Makefile, cfg.c, cfg.h, config.c, config.h: *** empty log message ***
+	* [r370]
+	  [lcd4linux @ 2004-02-17 05:37:20 by reinelt]
+	  Namespace clash between Curses driver and general text driver
+	  resolved
+	  (thanks to Martin Hejl)
 
-	* Makefile, MatrixOrbital.c, display.c, display.h, system.c:
-	MatrixOrbital driver finished
+2004-02-16  reinelt
 
-2000-03-07  Michael Reinelt  <reinelt@eunet.at>
+	* [r369]
+	  [lcd4linux @ 2004-02-16 13:03:37 by reinelt]
+	  compile problem with missing frontend.h fixed
 
-	* Makefile, config.c, isdn.c, isdn.h, lcd4linux.conf.sample, lcd4linux.h, system.c, system.h:
-	system.c cleanup
+	* [r368]
+	  [lcd4linux @ 2004-02-16 08:19:44 by reinelt]
+	  i2c_sensors patch from Xavier
 
-2000-03-06  Michael Reinelt  <reinelt@eunet.at>
+2004-02-15  reinelt
 
-	* MatrixOrbital.c, config.c, config.h, display.c, display.h, filter.c, filter.h, isdn.c, isdn.h, lcd2041.c, lcd4linux.h, system.c, system.h:
-	minor cleanups
+	* [r367]
+	  [lcd4linux @ 2004-02-15 21:43:43 by reinelt]
+	  T6963 driver nearly finished
+	  framework for graphic displays done
+	  i2c_sensors patch from Xavier
+	  some more old generation files removed
 
-2000-01-16  Michael Reinelt  <reinelt@eunet.at>
+	* [r366]
+	  [lcd4linux @ 2004-02-15 08:22:47 by reinelt]
+	  ported USBLCD driver to NextGeneration
+	  added drv_M50530.c (I forgot yesterday, sorry)
+	  removed old drivers M50530.c and USBLCD.c
 
-	* display.h: *** empty log message ***
+	* [r365]
+	  [lcd4linux @ 2004-02-15 07:23:04 by reinelt]
+	  bug in netdev parsing fixed
 
-	* display.c, display.h:
-	Release 0.5
-	project moved to SourceForge
-	started working with CVS
+2004-02-14  nicowallmeier
 
+	* [r364]
+	  [lcd4linux @ 2004-02-14 12:07:27 by nicowallmeier]
+	  minor bugfix
 
-	* display.c, display.h: New file.
+2004-02-14  reinelt
 
-	* Makefile:
-	Release 0.5
-	project moved to SourceForge
-	started working with CVS
+	* [r363]
+	  [lcd4linux @ 2004-02-14 11:56:11 by reinelt]
+	  M50530 driver ported
+	  changed lots of 'char' to 'unsigned char'
 
-	* MatrixOrbital.c:
-	Release 0.5
-	project moved to SourceForge
-	started working with CVS
+	* [r362]
+	  [lcd4linux @ 2004-02-14 10:09:50 by reinelt]
+	  I2C Sensors for 2.4 kernels (/proc instead of /sysfs)
 
+2004-02-10  reinelt
 
-	* MatrixOrbital.c: New file.
+	* [r361]
+	  [lcd4linux @ 2004-02-10 07:42:35 by reinelt]
+	  cut off all old-style files which are no longer used with
+	  NextGeneration
 
-	* lcd4linux.c, lcd2041.c, lcd2041.h, Makefile:
-	Release 0.4
+	* [r360]
+	  [lcd4linux @ 2004-02-10 06:54:38 by reinelt]
+	  DVB plugin ported
 
-	* system.c, lcd4linux.c, filter.c, isdn.c, isdn.h, Makefile:
-	Release 0.3
+2004-02-09  nicowallmeier
 
-	* system.c, system.h, lcd4linux.c, isdn.c, isdn.h, lcd2041.c, lcd2041.h:
-	Release 0.2
+	* [r359]
+	  [lcd4linux @ 2004-02-09 19:49:38 by nicowallmeier]
+	  Minor bugfix
 
-	* filter.c, filter.h:
-	Release 0.2
+2004-02-07  reinelt
 
+	* [r358]
+	  [lcd4linux @ 2004-02-07 13:45:23 by reinelt]
+	  icon visibility patch #2 from Xavier
 
-	* filter.c, filter.h: New file.
+2004-02-05  mkeil
 
-	* Makefile, config.c:
-	Release 0.2
+	* [r357]
+	  [lcd4linux @ 2004-02-05 23:58:18 by mkeil]
+	  Fixed/Optimized Hashage-timings
 
-	* system.c, system.h:
+2004-02-05  reinelt
 
-	* system.c, system.h: New file.
+	* [r356]
+	  [lcd4linux @ 2004-02-05 07:10:23 by reinelt]
+	  evaluator function names are no longer case-sensitive
+	  Crystalfontz Fan PWM control, Fan RPM monitoring, temperature
+	  monitoring
 
-	* lcd4linux.c, lcd4linux.h:
+2004-02-04  reinelt
 
-	* lcd4linux.c, lcd4linux.h: New file.
+	* [r355]
+	  [lcd4linux @ 2004-02-04 19:11:44 by reinelt]
+	  icon visibility patch from Xavier
 
-	* isdn.c, isdn.h, lcd2041.c, lcd2041.h:
+	* [r354]
+	  [lcd4linux @ 2004-02-04 19:10:51 by reinelt]
+	  Crystalfontz driver nearly finished
 
-	* isdn.c, isdn.h, lcd2041.c, lcd2041.h: New file.
+2004-02-02  reinelt
 
-	* Makefile, config.c, config.h:
+	* [r353]
+	  [lcd4linux @ 2004-02-02 05:22:16 by reinelt]
+	  Brightness fpr Noritake Displays avaliable as a plugin
 
-	* Makefile, config.c, config.h: New file.
+2004-02-01  reinelt
+
+	* [r352]
+	  [lcd4linux @ 2004-02-01 19:37:40 by reinelt]
+	  got rid of every strtok() incarnation.
+
+	* [r351]
+	  [lcd4linux @ 2004-02-01 18:08:50 by reinelt]
+	  removed strtok() from layout processing (took me hours to find
+	  this bug)
+	  further strtok() removind should be done!
+
+2004-02-01  hejl
+
+	* [r350]
+	  [lcd4linux @ 2004-02-01 11:51:22 by hejl]
+	  Fixes for busy flag
+
+2004-02-01  reinelt
+
+	* [r349]
+	  [lcd4linux @ 2004-02-01 08:05:12 by reinelt]
+	  Crystalfontz 633 extensions (CRC checking and stuff)
+	  Models table for HD44780
+	  Noritake VFD BVrightness patch from Bill Paxton
+
+2004-01-30  reinelt
+
+	* [r348]
+	  [lcd4linux @ 2004-01-30 20:57:55 by reinelt]
+	  HD44780 patch from Martin Hejl
+	  dmalloc integrated
+
+	* [r347]
+	  [lcd4linux @ 2004-01-30 07:12:35 by reinelt]
+	  HD44780 busy-flag support from Martin Hejl
+	  loadavg() uClibc replacement from Martin Heyl
+	  round() uClibc replacement from Martin Hejl
+	  warning in i2c_sensors fixed
+	  [
+
+2004-01-29  reinelt
+
+	* [r346]
+	  [lcd4linux @ 2004-01-29 05:55:30 by reinelt]
+	  check for /sys mounted
+
+	* [r345]
+	  [lcd4linux @ 2004-01-29 05:53:47 by reinelt]
+	  uClibc compatibility issues from Martin Hejl
+
+	* [r344]
+	  [lcd4linux @ 2004-01-29 04:40:02 by reinelt]
+	  every .c file includes "config.h" now
+
+2004-01-28  reinelt
+
+	* [r343]
+	  [lcd4linux @ 2004-01-28 06:43:31 by reinelt]
+	  plugin_ppp finished.
+
+2004-01-27  reinelt
+
+	* [r342]
+	  [lcd4linux @ 2004-01-27 08:13:39 by reinelt]
+	  ported PPP token to plugin_ppp
+
+	* [r341]
+	  [lcd4linux @ 2004-01-27 06:34:14 by reinelt]
+	  Cwlinux driver portet to NextGeneration (compiles, but not
+	  tested!)
+
+	* [r340]
+	  [lcd4linux @ 2004-01-27 05:06:10 by reinelt]
+	  i2c update from Xavier
+
+	* [r339]
+	  [lcd4linux @ 2004-01-27 04:48:57 by reinelt]
+	  bug with hash_age() fixed (thanks to Markus Keil for pointing
+	  this out)
+
+2004-01-25  reinelt
+
+	* [r338]
+	  [lcd4linux @ 2004-01-25 05:30:08 by reinelt]
+	  plugin_netdev for parsing /proc/net/dev added
+
+2004-01-23  reinelt
+
+	* [r337]
+	  [lcd4linux @ 2004-01-23 07:04:03 by reinelt]
+	  icons finished!
+
+	* [r336]
+	  [lcd4linux @ 2004-01-23 04:53:23 by reinelt]
+	  icon widget added (not finished yet!)
+
+2004-01-22  reinelt
+
+	* [r335]
+	  [lcd4linux @ 2004-01-22 08:55:30 by reinelt]
+	  fixed unhandled kernel-2.6 entries in /prco/stat
+
+	* [r334]
+	  [lcd4linux @ 2004-01-22 07:57:45 by reinelt]
+	  several bugs fixed where segfaulting on layout>display
+	  Crystalfontz driver optimized, 632 display already works
+
+2004-01-21  reinelt
+
+	* [r333]
+	  [lcd4linux @ 2004-01-21 14:29:03 by reinelt]
+	  new helper 'hash_get_regex' which delivers the sum over regex
+	  matched items
+	  new function 'disk()' which uses this regex matching
+
+	* [r332]
+	  [lcd4linux @ 2004-01-21 12:36:19 by reinelt]
+	  Crystalfontz NextGeneration driver added
+
+	* [r331]
+	  [lcd4linux @ 2004-01-21 11:32:48 by reinelt]
+	  changelog commited
+
+	* [r330]
+	  [lcd4linux @ 2004-01-21 11:31:23 by reinelt]
+	  two bugs with hash_age() ixed
+
+	* [r329]
+	  [lcd4linux @ 2004-01-21 10:48:17 by reinelt]
+	  hash_age function added
+
+	* [r328]
+	  [lcd4linux @ 2004-01-21 06:39:27 by reinelt]
+	  HD44780 missed the "clear display' sequence
+	  asc255bug handling added
+	  HD44780 tested, works here!
+
+2004-01-20  reinelt
+
+	* [r327]
+	  [lcd4linux @ 2004-01-20 15:32:48 by reinelt]
+	  first version of Next Generation HD44780 (untested! but it
+	  compiles...)
+	  some cleanup in the other drivers
+
+	* [r326]
+	  [lcd4linux @ 2004-01-20 14:35:38 by reinelt]
+	  drv_generic_parport added, code from parport.c
+
+	* [r325]
+	  [lcd4linux @ 2004-01-20 14:26:09 by reinelt]
+	  moved drv_generic to drv_generic_serial
+
+	* [r324]
+	  [lcd4linux @ 2004-01-20 14:25:12 by reinelt]
+	  some reorganization
+	  moved drv_generic to drv_generic_serial
+	  moved port locking stuff to drv_generic_serial
+
+	* [r323]
+	  [lcd4linux @ 2004-01-20 12:45:47 by reinelt]
+	  "Default screen" working with MatrixOrbital
+
+	* [r322]
+	  [lcd4linux @ 2004-01-20 05:36:59 by reinelt]
+	  moved text-display-specific stuff to drv_generic_text
+	  moved all the bar stuff from drv_generic_bar to generic_text
+
+	* [r321]
+	  [lcd4linux @ 2004-01-20 04:51:39 by reinelt]
+	  moved generic stuff from drv_MatrixOrbital to drv_generic
+	  implemented new-stylish bars which are nearly finished
+
+2004-01-18  reinelt
+
+	* [r320]
+	  [lcd4linux @ 2004-01-18 21:25:16 by reinelt]
+	  Framework for bar widget opened
+
+	* [r319]
+	  [lcd4linux @ 2004-01-18 09:01:45 by reinelt]
+	  /proc/stat parsing finished
+
+	* [r318]
+	  [lcd4linux @ 2004-01-18 06:54:08 by reinelt]
+	  bug in expr.c fixed (thanks to Xavier)
+	  some progress with /proc/stat parsing
+
+2004-01-16  reinelt
+
+	* [r317]
+	  [lcd4linux @ 2004-01-16 11:12:26 by reinelt]
+	  some bugs in plugin_xmms fixed, parsing moved to own function
+	  plugin_proc_stat nearly finished
+
+2004-01-16  mkeil
+
+	* [r316]
+	  [lcd4linux @ 2004-01-16 10:09:49 by mkeil]
+	  -include caching for values
+
+2004-01-16  reinelt
+
+	* [r315]
+	  [lcd4linux @ 2004-01-16 07:26:25 by reinelt]
+	  moved various /proc parsing to own functions
+	  made some progress with /proc/stat parsing
+
+	* [r314]
+	  [lcd4linux @ 2004-01-16 05:04:53 by reinelt]
+	  started plugin proc_stat which should parse /proc/stat
+	  which again is a paint in the a**
+	  thinking over implementation methods of delta functions
+	  (CPU load, ...)
+
+2004-01-15  reinelt
+
+	* [r313]
+	  [lcd4linux @ 2004-01-15 07:47:02 by reinelt]
+	  debian/ postinst and watch added (did CVS forget about them?)
+	  evaluator: conditional expressions (a?b:c) added
+	  text widget nearly finished
+
+	* [r312]
+	  [lcd4linux @ 2004-01-15 04:32:14 by reinelt]
+
+	* [r311]
+	  [lcd4linux @ 2004-01-15 04:29:45 by reinelt]
+	  moved lcd4linux.conf.sample to *.old
+	  lcd4linux.conf.sample with new layout
+	  new plugins 'loadavg' and 'meminfo'
+	  text widget have pre- and postfix
+
+2004-01-14  reinelt
+
+	* [r310]
+	  [lcd4linux @ 2004-01-14 11:33:00 by reinelt]
+	  new plugin 'uname' which does what it's called
+	  text widget nearly finished
+	  first results displayed on MatrixOrbital
+
+2004-01-13  reinelt
+
+	* [r309]
+	  [lcd4linux @ 2004-01-13 10:03:01 by reinelt]
+	  new util 'hash' for associative arrays
+	  new plugin 'cpuinfo'
+
+	* [r308]
+	  [lcd4linux @ 2004-01-13 08:18:07 by reinelt]
+	  timer queues added
+	  liblcd4linux deactivated turing transformation to new layout
+
+2004-01-12  reinelt
+
+	* [r307]
+	  [lcd4linux @ 2004-01-12 03:51:01 by reinelt]
+	  evaluating the 'Variables' section in the config file
+
+2004-01-11  reinelt
+
+	* [r306]
+	  [lcd4linux @ 2004-01-11 18:26:02 by reinelt]
+	  further widget and layout processing
+
+	* [r305]
+	  [lcd4linux @ 2004-01-11 09:26:15 by reinelt]
+	  layout starts to exist...
+
+2004-01-10  reinelt
+
+	* [r304]
+	  [lcd4linux @ 2004-01-10 20:22:33 by reinelt]
+	  added new function 'cfg_list()' (not finished yet)
+	  added layout.c (will replace processor.c someday)
+	  added widget_text.c (will be the first and most important widget)
+	  modified lcd4linux.c so that old-style configs should work, too
+
+	* [r303]
+	  [lcd4linux @ 2004-01-10 17:45:26 by reinelt]
+	  changed initialization order so cfg() gets initialized before
+	  plugins.
+	  This way a plugin's init() can use cfg_get().
+	  Thanks to Xavier for reporting this one!
+
+	* [r302]
+	  [lcd4linux @ 2004-01-10 17:36:56 by reinelt]
+	  I2C Sensors plugin from Xavier added
+
+	* [r301]
+	  [lcd4linux @ 2004-01-10 17:34:40 by reinelt]
+	  further matrixOrbital changes
+	  widgets initialized
+
+	* [r300]
+	  [lcd4linux @ 2004-01-10 10:20:22 by reinelt]
+	  new MatrixOrbital changes
+
+2004-01-09  reinelt
+
+	* [r299]
+	  [lcd4linux @ 2004-01-09 17:03:06 by reinelt]
+	  initiated transfer to new driver architecture
+	  new file 'drv.c' will someday replace 'display.c'
+	  new file 'drv_MatrixOrbital.c' will replace 'MatrixOrbital.c'
+	  due to this 'soft' transfer lcd4linux should stay usable during
+	  the switch
+	  (at least I hope so)
+
+	* [r298]
+	  [lcd4linux @ 2004-01-09 04:16:06 by reinelt]
+	  added 'section' argument to cfg_get(), but NULLed it on all calls
+	  by now.
+
+2004-01-08  reinelt
+
+	* [r297]
+	  [lcd4linux @ 2004-01-08 06:00:28 by reinelt]
+	  allowed '.' in key names
+	  allowed empty group keys (not only "group anything {", but
+	  "anything {")
+
+	* [r296]
+	  [lcd4linux @ 2004-01-08 05:28:12 by reinelt]
+	  Luk Claes added to AUTHORS
+	  cfg: group handling ('{}') added
+
+2004-01-07  reinelt
+
+	* [r295]
+	  [lcd4linux @ 2004-01-07 10:15:41 by reinelt]
+	  small glitch in evaluator fixed
+	  made config table sorted and access with bsearch(),
+	  which should be much faster
+
+2004-01-06  reinelt
+
+	* [r294]
+	  [lcd4linux @ 2004-01-06 23:01:37 by reinelt]
+	  more copyright issues
+
+	* [r293]
+	  [lcd4linux @ 2004-01-06 22:33:13 by reinelt]
+	  Copyright statements cleaned up
+
+	* [r292]
+	  [lcd4linux @ 2004-01-06 21:14:51 by reinelt]
+	  more debianizing
+
+	* [r291]
+	  [lcd4linux @ 2004-01-06 18:22:41 by reinelt]
+	  debian updates
+
+	* [r290]
+	  [lcd4linux @ 2004-01-06 17:56:43 by reinelt]
+	  autotools update
+
+	* [r289]
+	  [lcd4linux @ 2004-01-06 17:37:00 by reinelt]
+
+	* [r288]
+	  [lcd4linux @ 2004-01-06 17:33:45 by reinelt]
+	  Evaluator: functions with variable argument lists
+	  Evaluator: plugin_sample.c and README.Plugins added
+
+	* [r287]
+	  [lcd4linux @ 2004-01-06 15:19:12 by reinelt]
+	  Evaluator rearrangements...
+
+2004-01-05  reinelt
+
+	* [r286]
+	  [lcd4linux @ 2004-01-05 11:57:38 by reinelt]
+	  added %y tokens to make the Evaluator useable
+
+2004-01-02  reinelt
+
+	* [r285]
+	  [lcd4linux @ 2004-01-02 14:20:15 by reinelt]
+	  debianization added
+
+	* [r284]
+	  [lcd4linux @ 2004-01-02 14:18:54 by reinelt]
+	  Changelog, TODO updated
+
+2003-12-19  reinelt
+
+	* [r283]
+	  [lcd4linux @ 2003-12-19 06:27:33 by reinelt]
+	  added XMMS plugin from Markus Keil
+
+	* [r282]
+	  [lcd4linux @ 2003-12-19 05:56:13 by reinelt]
+	  added .cvsignore containing '*.lo'
+
+	* [r281]
+	  [lcd4linux @ 2003-12-19 05:50:34 by reinelt]
+	  added plugin_math.c and plugin_string.c
+
+	* [r280]
+	  [lcd4linux @ 2003-12-19 05:49:23 by reinelt]
+	  extracted plugin_math and plugin_string into extra files
+
+	* [r279]
+	  [lcd4linux @ 2003-12-19 05:35:13 by reinelt]
+	  renamed 'client' to 'plugin'
+
+2003-12-01  reinelt
+
+	* [r278]
+	  [lcd4linux @ 2003-12-01 07:08:50 by reinelt]
+	  Patches from Xavier:
+	  - WiFi: make interface configurable
+	  - "quiet" as an option from the config file
+	  - ignore missing "MemShared" on Linux 2.6
+
+2003-11-30  reinelt
+
+	* [r277]
+	  [lcd4linux @ 2003-11-30 16:18:36 by reinelt]
+	  Cwlinux: invalidate Framebuffer in case a char got redefined
+
+2003-11-28  nicowallmeier
+
+	* [r276]
+	  [lcd4linux @ 2003-11-28 18:34:55 by nicowallmeier]
+	  Minor bugfixes
+
+2003-11-24  reinelt
+
+	* [r275]
+	  [lcd4linux @ 2003-11-24 11:34:54 by reinelt]
+	  'Fixed' Rows which do not scroll by Lars Kempe
+	  temporary workaround for debian kernel-header bug
+
+2003-11-16  reinelt
+
+	* [r274]
+	  [lcd4linux @ 2003-11-16 09:45:49 by reinelt]
+	  Crystalfontz changes, small glitch in getopt() fixed
+
+2003-11-14  reinelt
+
+	* [r273]
+	  [lcd4linux @ 2003-11-14 05:59:37 by reinelt]
+	  added wifi.c wifi.h which have been forgotten at the last checkin
+
+2003-11-12  reinelt
+
+	* [r272]
+	  [lcd4linux @ 2003-11-12 05:42:35 by reinelt]
+	  small changes to the 16x4 handling
+
+2003-11-11  reinelt
+
+	* [r271]
+	  [lcd4linux @ 2003-11-11 04:40:20 by reinelt]
+	  WIFI patch from Xavier Vello
+
+	* [r270]
+	  [lcd4linux @ 2003-11-11 04:30:41 by reinelt]
+	  very minor changes
+
+2003-10-27  reinelt
+
+	* [r269]
+	  [lcd4linux @ 2003-10-27 09:05:42 by reinelt]
+	  README.Rows, README.Tokens, lcd4linux.conf.sample from Thomas
+	  Siedentopf
+
+2003-10-22  reinelt
+
+	* [r268]
+	  [lcd4linux @ 2003-10-22 04:32:25 by reinelt]
+	  fixed icon bug found by Rob van Nieuwkerk
+
+	* [r267]
+	  [lcd4linux @ 2003-10-22 04:19:16 by reinelt]
+	  Makefile.in for imon.c/.h, some MatrixOrbital clients
+
+2003-10-12  nicowallmeier
+
+	* [r266]
+	  [lcd4linux @ 2003-10-12 06:08:28 by nicowallmeier]
+	  imond/telmond support
+
+2003-10-12  reinelt
+
+	* [r265]
+	  [lcd4linux @ 2003-10-12 04:46:19 by reinelt]
+	  first try to integrate the Evaluator into a display driver
+	  (MatrixOrbital here)
+	  small warning in processor.c fixed (thanks to Zachary Giles)
+	  workaround for udelay() on alpha (no msr.h avaliable) (thanks to
+	  Zachary Giles)
+
+2003-10-11  reinelt
+
+	* [r264]
+	  [lcd4linux @ 2003-10-11 06:01:52 by reinelt]
+	  renamed expression.{c,h} to client.{c,h}
+	  added config file client
+	  new functions 'AddNumericVariable()' and 'AddStringVariable()'
+	  new parameter '-i' for interactive mode
+
+2003-10-08  reinelt
+
+	* [r263]
+	  [lcd4linux @ 2003-10-08 14:21:10 by reinelt]
+	  Changelog; small type in parport.c
+
+2003-10-08  andy-b
+
+	* [r262]
+	  [lcd4linux @ 2003-10-08 13:39:53 by andy-b]
+	  Cleaned up code in MilfordInstruments.c, and added descriptions
+	  for other display sizes (untested)
+
+2003-10-08  nicowallmeier
+
+	* [r261]
+	  [lcd4linux @ 2003-10-08 06:48:47 by nicowallmeier]
+	  special handling for 16x4 displays
+
+	* [r260]
+	  [lcd4linux @ 2003-10-08 06:45:00 by nicowallmeier]
+	  Support of two displays of the same size
+
+2003-10-07  reinelt
+
+	* [r259]
+	  [lcd4linux @ 2003-10-07 04:12:38 by reinelt]
+	  AM_PROG_LIBTOOL removed
+
+2003-10-06  reinelt
+
+	* [r258]
+	  [lcd4linux @ 2003-10-06 05:51:15 by reinelt]
+	  functions: min(), max()
+
+	* [r257]
+	  [lcd4linux @ 2003-10-06 05:47:27 by reinelt]
+	  operators: ==, \!=, <=, >=
+
+	* [r256]
+	  [lcd4linux @ 2003-10-06 04:34:06 by reinelt]
+	  expression evaluator added
+
+	* [r255]
+	  [lcd4linux @ 2003-10-06 04:33:06 by reinelt]
+	  files 'libtool' and 'bootstrap' added
+
+	* [r254]
+	  [lcd4linux @ 2003-10-06 04:30:43 by reinelt]
+	  libtool stuff again...
+
+2003-10-05  reinelt
+
+	* [r253]
+	  [lcd4linux @ 2003-10-05 17:58:50 by reinelt]
+	  libtool junk; copyright messages cleaned up
+
+2003-10-04  reinelt
+
+	* [r252]
+	  [lcd4linux @ 2003-10-04 07:54:17 by reinelt]
+	  autoconf/automake/libtool fixes from Ronald Landheer-Cieslak
+
+2003-10-03  reinelt
+
+	* [r251]
+	  [lcd4linux @ 2003-10-03 03:53:12 by reinelt]
+	  compile error in parport fixed (thanks to Andrew from FilmCan)
+
+	* [r250]
+	  [lcd4linux @ 2003-10-03 03:51:14 by reinelt]
+	  start support for new MatrixOrbital MX2 displays
+
+2003-09-29  reinelt
+
+	* [r249]
+	  [lcd4linux @ 2003-09-29 06:58:36 by reinelt]
+	  new driver for Milford Instruments MI420 by Andy Baxter
+
+	* [r248]
+	  [lcd4linux @ 2003-09-29 06:12:56 by reinelt]
+	  changed default HD44780 wiring: unused signals are GND
+
+2003-09-21  reinelt
+
+	* [r247]
+	  [lcd4linux @ 2003-09-21 06:43:02 by reinelt]
+	  MatrixOrbital: bidirectional communication
+	  HD44780: special handling for 16x1 displays (thanks to anonymous
+	  bug report on sf.net)
+
+2003-09-19  reinelt
+
+	* [r246]
+	  [lcd4linux @ 2003-09-19 08:40:32 by reinelt]
+	  increased version number to 0.9.12
+	  port locking is done as /var/lock/LCK..usb_tts_0 for
+	  /dev/usb/tts/0
+
+	* [r245]
+	  [lcd4linux @ 2003-09-19 03:51:29 by reinelt]
+	  minor fixes, widget.c added
+
+2003-09-13  reinelt
+
+	* [r244]
+	  [lcd4linux @ 2003-09-13 07:20:51 by reinelt]
+	  Changelog
+
+	* [r243]
+	  [lcd4linux @ 2003-09-13 06:45:43 by reinelt]
+	  icons for all remaining drivers
+
+	* [r242]
+	  [lcd4linux @ 2003-09-13 06:20:39 by reinelt]
+	  HD44780 timings changed; deactivated libtool
+
+2003-09-11  reinelt
+
+	* [r241]
+	  [lcd4linux @ 2003-09-11 15:05:24 by reinelt]
+	  missing files for autoconf/automake/libtool
+
+	* [r240]
+	  [lcd4linux @ 2003-09-11 04:09:52 by reinelt]
+	  minor cleanups
+
+2003-09-10  reinelt
+
+	* [r239]
+	  [lcd4linux @ 2003-09-10 15:59:39 by reinelt]
+	  minor cleanups
+
+	* [r238]
+	  [lcd4linux @ 2003-09-10 15:09:21 by reinelt]
+	  ChangeLog
+
+	* [r237]
+	  [lcd4linux @ 2003-09-10 14:01:52 by reinelt]
+	  icons nearly finished\!
+
+	* [r236]
+	  [lcd4linux @ 2003-09-10 08:37:09 by reinelt]
+	  icons: reorganized tick_* again...
+
+	* [r235]
+	  [lcd4linux @ 2003-09-10 03:48:22 by reinelt]
+	  Icons for M50530, new processing scheme (Ticks.Text...)
+
+2003-09-09  reinelt
+
+	* [r234]
+	  [lcd4linux @ 2003-09-09 11:47:47 by reinelt]
+	  basic icon support for HD44780
+
+	* [r233]
+	  [lcd4linux @ 2003-09-09 06:54:43 by reinelt]
+	  new function 'cfg_number()'
+
+	* [r232]
+	  [lcd4linux @ 2003-09-09 05:30:33 by reinelt]
+	  even more icons stuff
+
+2003-09-01  reinelt
+
+	* [r231]
+	  [lcd4linux @ 2003-09-01 07:07:03 by reinelt]
+	  shared liblcd4linux
+
+	* [r230]
+	  [lcd4linux @ 2003-09-01 04:09:34 by reinelt]
+	  icons nearly finished, but MatrixOrbital only
+
+2003-08-24  reinelt
+
+	* [r229]
+	  [lcd4linux @ 2003-08-24 05:28:31 by reinelt]
+	  ChangeLog
+
+	* [r228]
+	  [lcd4linux @ 2003-08-24 05:17:58 by reinelt]
+	  liblcd4linux patch from Patrick Schemitz
+
+	* [r227]
+	  [lcd4linux @ 2003-08-24 04:31:56 by reinelt]
+	  icon.c icon.h added
+
+2003-08-22  reinelt
+
+	* [r226]
+	  [lcd4linux @ 2003-08-22 03:45:08 by reinelt]
+	  bug in parallel port code fixed, more icons stuff
+
+2003-08-20  reinelt
+
+	* [r225]
+	  [lcd4linux @ 2003-08-20 05:26:43 by reinelt]
+	  small bug in bar compaction fixed
+
+2003-08-19  reinelt
+
+	* [r224]
+	  [lcd4linux @ 2003-08-19 05:23:55 by reinelt]
+	  HD44780 dual-controller patch from Jesse Brook Kovach
+
+	* [r223]
+	  [lcd4linux @ 2003-08-19 04:28:41 by reinelt]
+	  more Icon stuff, minor glitches fixed
+
+2003-08-17  reinelt
+
+	* [r222]
+	  [lcd4linux @ 2003-08-17 16:37:39 by reinelt]
+	  more icon framework
+
+	* [r221]
+	  [lcd4linux @ 2003-08-17 12:11:58 by reinelt]
+	  framework for icons prepared
+
+	* [r220]
+	  [lcd4linux @ 2003-08-17 08:25:30 by reinelt]
+	  preparations for liblcd4linux; minor bugs in SIN.c and Skeleton.c
+
+	* [r219]
+	  [lcd4linux @ 2003-08-17 06:57:04 by reinelt]
+	  complete rewrite of the Crystalfontz driver
+
+	* [r218]
+	  [lcd4linux @ 2003-08-17 04:38:57 by reinelt]
+	  added config.guess
+
+2003-08-16  reinelt
+
+	* [r217]
+	  [lcd4linux @ 2003-08-16 07:31:35 by reinelt]
+	  double buffering in all drivers
+
+2003-08-15  reinelt
+
+	* [r216]
+	  [lcd4linux @ 2003-08-15 07:54:07 by reinelt]
+	  HD44780 4 bit mode implemented
+
+2003-08-14  reinelt
+
+	* [r215]
+	  [lcd4linux @ 2003-08-14 04:59:30 by reinelt]
+	  changed version to 0.9.11, added curses.m4 to Makefile.am
+
+	* [r214]
+	  [lcd4linux @ 2003-08-14 03:48:54 by reinelt]
+	  ChangeLog
+
+	* [r213]
+	  [lcd4linux @ 2003-08-14 03:47:40 by reinelt]
+	  remove PID file if driver initialisation fails
+
+2003-08-12  reinelt
+
+	* [r212]
+	  [lcd4linux @ 2003-08-12 05:10:31 by reinelt]
+	  first version of HD44780 4Bit-Mode patch
+
+2003-08-11  reinelt
+
+	* [r211]
+	  [lcd4linux @ 2003-08-11 04:51:28 by reinelt]
+	  another uClibc issue: realloc
+
+2003-08-08  reinelt
+
+	* [r210]
+	  [lcd4linux @ 2003-08-08 23:11:34 by reinelt]
+
+	* [r209]
+	  [lcd4linux @ 2003-08-08 23:08:38 by reinelt]
+	  CVS Id and Log missing from dvb.{c,h}
+
+	* [r208]
+	  [lcd4linux @ 2003-08-08 08:05:23 by reinelt]
+	  added PID file handling
+
+	* [r207]
+	  [lcd4linux @ 2003-08-08 06:58:06 by reinelt]
+	  improved forking
+
+	* [r206]
+	  [lcd4linux @ 2003-08-08 05:42:51 by reinelt]
+	  uClibc compatibility issue; small glitch in dvb.c
+
+2003-08-01  reinelt
+
+	* [r205]
+	  [lcd4linux @ 2003-08-01 05:15:42 by reinelt]
+	  last cleanups for 0.9.9
+
+2003-07-29  reinelt
+
+	* [r204]
+	  [lcd4linux @ 2003-07-29 04:56:13 by reinelt]
+	  disable Raster driver automagically if gd.h not found
+
+2003-07-28  reinelt
+
+	* [r203]
+	  [lcd4linux @ 2003-07-28 08:22:17 by reinelt]
+	  several README's moved to web page
+
+2003-07-24  reinelt
+
+	* [r202]
+	  [lcd4linux @ 2003-07-24 04:48:09 by reinelt]
+	  'soft clear' needed for virtual rows
+
+2003-07-21  reinelt
+
+	* [r201]
+	  [lcd4linux @ 2003-07-21 06:34:14 by reinelt]
+	  bars on virtual rows fixed
+
+	* [r200]
+	  [lcd4linux @ 2003-07-21 06:10:11 by reinelt]
+	  removed maxlen parameter from process_row()
+
+	* [r199]
+	  [lcd4linux @ 2003-07-21 05:56:48 by reinelt]
+	  check for HAVE_LINUX_DVB_FRONTEND_H needs config.h
+
+2003-07-19  reinelt
+
+	* [r198]
+	  [lcd4linux @ 2003-07-19 09:42:42 by reinelt]
+	  check for dvb/frontend.h and disable DVB client if not found.
+
+2003-07-18  reinelt
+
+	* [r197]
+	  [lcd4linux @ 2003-07-18 04:43:14 by reinelt]
+	  udelay: unnecessary sanity check removed
+
+2003-06-26  reinelt
+
+	* [r196]
+	  [lcd4linux @ 2003-06-26 05:31:16 by reinelt]
+	  bug in /proc/net/dev parsing fixed
+
+2003-06-22  reinelt
+
+	* [r195]
+	  [lcd4linux @ 2003-06-22 19:31:24 by reinelt]
+	  added dvb.c dvb.h
+
+2003-06-21  reinelt
+
+	* [r194]
+	  [lcd4linux @ 2003-06-21 05:46:18 by reinelt]
+	  DVB client integrated
+
+2003-06-13  reinelt
+
+	* [r193]
+	  [lcd4linux @ 2003-06-13 06:35:56 by reinelt]
+	  added scrolling capability
+
+	* [r192]
+	  [lcd4linux @ 2003-06-13 05:11:10 by reinelt]
+	  error message cosmetics
+
+2003-05-19  reinelt
+
+	* [r191]
+	  [lcd4linux @ 2003-05-19 05:55:17 by reinelt]
+	  Cwlinux sleep optimization
+
+2003-05-14  reinelt
+
+	* [r190]
+	  [lcd4linux @ 2003-05-14 06:17:39 by reinelt]
+	  added support for CW1602
+
+2003-04-12  reinelt
+
+	* [r189]
+	  [lcd4linux @ 2003-04-12 16:23:10 by reinelt]
+	  small glitch in XWindow.c (thanks to Moe Wibble)
+
+2003-04-07  reinelt
+
+	* [r188]
+	  [lcd4linux @ 2003-04-07 06:02:58 by reinelt]
+	  further parallel port abstraction
+
+2003-04-04  reinelt
+
+	* [r187]
+	  [lcd4linux @ 2003-04-04 06:01:59 by reinelt]
+	  new parallel port abstraction scheme
+
+2003-02-27  reinelt
+
+	* [r186]
+	  [lcd4linux @ 2003-02-27 07:48:57 by reinelt]
+	  changed versioning scheme from 0.99 to 0.9.9
+
+	* [r185]
+	  [lcd4linux @ 2003-02-27 07:43:10 by reinelt]
+	  asm/msr.h: included hard-coded definition of rdtscl() if msr.h
+	  cannot be found.
+	  
+	  autoconf/automake/autoanything: switched back to 1.4. Hope it
+	  works again.
+
+2003-02-24  reinelt
+
+	* [r184]
+	  [lcd4linux @ 2003-02-24 04:50:57 by reinelt]
+	  cwlinux fixes
+
+2003-02-22  reinelt
+
+	* [r183]
+	  [lcd4linux @ 2003-02-22 07:53:09 by reinelt]
+	  cfg_get(key,defval)
+
+	* [r182]
+	  [lcd4linux @ 2003-02-22 07:23:24 by reinelt]
+	  Cwlinux fixes
+
+2003-02-18  reinelt
+
+	* [r181]
+	  [lcd4linux @ 2003-02-18 06:13:44 by reinelt]
+	  X11 driver fixes and cleanup
+
+2003-02-17  reinelt
+
+	* [r180]
+	  [lcd4linux @ 2003-02-17 06:06:12 by reinelt]
+	  small bug in X11 driver: omit pixel gap between cahracters
+
+	* [r179]
+	  [lcd4linux @ 2003-02-17 04:27:58 by reinelt]
+	  Text (curses) driver: cosmetic changes
+
+2003-02-13  reinelt
+
+	* [r178]
+	  [lcd4linux @ 2003-02-13 10:40:17 by reinelt]
+	  changed "copyright" to "2003"
+	  added slightly different protocol for MatrixOrbital "LK202"
+	  displays
+
+2003-02-05  reinelt
+
+	* [r177]
+	  [lcd4linux @ 2003-02-05 04:31:38 by reinelt]
+	  T_EXEC: remove trailing CR/LF
+	  T_EXEC: deactivated maxlen calculation (for I don't understand
+	  what it is for :-)
+
+2003-01-12  reinelt
+
+	* [r176]
+	  [lcd4linux @ 2003-01-12 06:51:27 by reinelt]
+	  fixed bug in bar compaction
+
+2002-12-08  reinelt
+
+	* [r175]
+	  [lcd4linux @ 2002-12-08 07:36:06 by reinelt]
+	  autoconf/automake cleanup
+
+2002-12-06  reinelt
+
+	* [r174]
+	  [lcd4linux @ 2002-12-06 07:38:43 by reinelt]
+	  libgd/libpng bugfix: removed '-lpng -lz' from LDFLAGS
+
+2002-12-05  reinelt
+
+	* [r173]
+	  [lcd4linux @ 2002-12-05 19:23:01 by reinelt]
+	  fixed undefined operations found by gcc3
+
+	* [r172]
+	  [lcd4linux @ 2002-12-05 19:12:47 by reinelt]
+	  sensors factor and offset patch from Petri Damsten
+	  <petri.damsten@raketti.net>
+
+	* [r171]
+	  [lcd4linux @ 2002-12-05 19:09:57 by reinelt]
+	  patches for gcc-3.2
+
+2002-09-12  reinelt
+
+	* [r170]
+	  [lcd4linux @ 2002-09-12 05:24:54 by reinelt]
+	  code cleanup, character defining for bars
+
+2002-09-11  reinelt
+
+	* [r169]
+	  [lcd4linux @ 2002-09-11 05:32:35 by reinelt]
+	  changed to use new bar functions
+
+	* [r168]
+	  [lcd4linux @ 2002-09-11 05:16:32 by reinelt]
+	  added Cwlinux driver
+
+2002-08-30  reinelt
+
+	* [r167]
+	  [lcd4linux @ 2002-08-30 03:54:01 by reinelt]
+	  bug in curses driver fixed
+
+2002-08-22  reinelt
+
+	* [r166]
+	  [lcd4linux @ 2002-08-22 05:51:36 by reinelt]
+	  cosmetic changes
+
+2002-08-21  reinelt
+
+	* [r165]
+	  [lcd4linux @ 2002-08-21 06:09:53 by reinelt]
+	  some T6963 fixes, ndelay wrap
+
+2002-08-19  reinelt
+
+	* [r164]
+	  [lcd4linux @ 2002-08-19 10:51:06 by reinelt]
+	  M50530 driver using new generic bar functions
+
+	* [r163]
+	  [lcd4linux @ 2002-08-19 09:43:43 by reinelt]
+	  BeckmannEgle using new generic bar functions
+
+	* [r162]
+	  [lcd4linux @ 2002-08-19 09:30:18 by reinelt]
+	  MatrixOrbital uses generic bar funnctions
+
+	* [r161]
+	  [lcd4linux @ 2002-08-19 09:11:34 by reinelt]
+	  changed HD44780 to use generic bar functions
+
+	* [r160]
+	  [lcd4linux @ 2002-08-19 07:52:19 by reinelt]
+	  corrected type declaration of (*defchar)()
+
+	* [r159]
+	  [lcd4linux @ 2002-08-19 07:36:29 by reinelt]
+	  finished bar.c, USBLCD is the first driver that uses the generic
+	  bar functions
+
+	* [r158]
+	  [lcd4linux @ 2002-08-19 04:41:20 by reinelt]
+	  introduced bar.c, moved bar stuff from display.h to bar.h
+
+2002-08-18  reinelt
+
+	* [r157]
+	  [lcd4linux @ 2002-08-18 08:11:11 by reinelt]
+	  USBLCD buffered I/O
+
+2002-08-17  reinelt
+
+	* [r156]
+	  [lcd4linux @ 2002-08-17 14:14:21 by reinelt]
+	  USBLCD fixes
+
+	* [r155]
+	  [lcd4linux @ 2002-08-17 13:10:22 by reinelt]
+	  USBLCD driver added
+
+	* [r154]
+	  [lcd4linux @ 2002-08-17 12:54:08 by reinelt]
+	  minor T6963 changes
+
+2002-04-30  reinelt
+
+	* [r153]
+	  [lcd4linux @ 2002-04-30 07:20:15 by reinelt]
+	  implemented the new ndelay(nanoseconds) in all parallel port
+	  drivers
+
+2002-04-29  reinelt
+
+	* [r152]
+	  [lcd4linux @ 2002-04-29 11:00:25 by reinelt]
+	  added Toshiba T6963 driver
+	  added ndelay() with nanosecond resolution
+
+2001-09-14  reinelt
+
+	* [r151]
+	  [lcd4linux @ 2001-09-14 05:57:06 by reinelt]
+
+2001-09-13  reinelt
+
+	* [r150]
+	  [lcd4linux @ 2001-09-13 07:40:57 by reinelt]
+	  TODO update
+
+2001-09-12  reinelt
+
+	* [r149]
+	  [lcd4linux @ 2001-09-12 06:17:22 by reinelt]
+
+	* [r148]
+	  [lcd4linux @ 2001-09-12 05:58:16 by reinelt]
+	  fixed bug in mail2.c
+
+	* [r147]
+	  [lcd4linux @ 2001-09-12 05:37:22 by reinelt]
+	  fixed a bug in seti.c (file was never closed, lcd4linux run out
+	  of fd's
+	  
+	  improved socket debugging
+
+2001-09-11  reinelt
+
+	* [r146]
+	  [lcd4linux @ 2001-09-11 06:43:43 by reinelt]
+	  TODO items
+
+	* [r145]
+	  [lcd4linux @ 2001-09-11 05:31:37 by reinelt]
+	  M50530 driver
+
+2001-09-10  reinelt
+
+	* [r144]
+	  [lcd4linux @ 2001-09-10 13:55:53 by reinelt]
+	  M50530 driver
+
+2001-09-09  reinelt
+
+	* [r143]
+	  [lcd4linux @ 2001-09-09 12:26:03 by reinelt]
+	  GPO bug: INIT is _not_ inverted
+
+2001-09-07  reinelt
+
+	* [r142]
+	  [lcd4linux @ 2001-09-07 05:58:44 by reinelt]
+	  wrong Pin numbers
+
+2001-09-05  reinelt
+
+	* [r141]
+	  [lcd4linux @ 2001-09-05 09:38:52 by reinelt]
+
+2001-08-08  reinelt
+
+	* [r140]
+	  [lcd4linux @ 2001-08-08 05:40:24 by reinelt]
+	  renamed CLK_TCK to CLOCKS_PER_SEC
+
+2001-08-05  reinelt
+
+	* [r139]
+	  [lcd4linux @ 2001-08-05 17:13:29 by reinelt]
+	  cleaned up inlude of sys/time.h and time.h
+
+2001-06-04  reinelt
+
+	* [r138]
+	  [lcd4linux @ 2001-06-04 07:49:58 by reinelt]
+	  configure for X11 modified
+
+2001-05-31  ltoetsch
+
+	* [r137]
+	  [lcd4linux @ 2001-05-31 10:26:41 by ltoetsch]
+	  added tests for X and ncurses
+
+2001-05-27  reinelt
+
+	* [r136]
+	  [lcd4linux @ 2001-05-27 17:32:35 by reinelt]
+	  updated README with the seti@home client stuff
+
+	* [r135]
+	  [lcd4linux @ 2001-05-27 07:19:28 by reinelt]
+	  fixed a warning in pixmap.c
+	  temporarily fixed a bug in isdn.c (ISDN_MAX_CHANNELS is no longer
+	  defined?)
+	  fixed a bug in configure.in (--with-drivers=xyz did not work)
+
+2001-05-26  reinelt
+
+	* [r134]
+	  [lcd4linux @ 2001-05-26 06:51:28 by reinelt]
+	  added TODO entry
+
+2001-05-06  reinelt
+
+	* [r133]
+	  [lcd4linux @ 2001-05-06 10:01:27 by reinelt]
+	  fixed a bug which prevented extendet tokens to be used for GPO's
+	  many thanks to Carsten Nau!
+
+2001-04-27  reinelt
+
+	* [r132]
+	  [lcd4linux @ 2001-04-27 05:04:57 by reinelt]
+	  replaced OPEN_MAX with sysconf()
+	  replaced mktemp() with mkstemp()
+	  unlock serial port if open() fails
+
+2001-03-24  reinelt
+
+	* [r131]
+	  [lcd4linux @ 2001-03-24 09:26:25 by reinelt]
+	  new TODO item
+
+	* [r130]
+	  [lcd4linux @ 2001-03-24 09:04:19 by reinelt]
+	  new TODO item
+
+2001-03-17  ltoetsch
+
+	* [r129]
+	  [lcd4linux @ 2001-03-17 11:44:10 by ltoetsch]
+	  allow more then 1 BAR_T
+
+	* [r128]
+	  [lcd4linux @ 2001-03-17 11:11:31 by ltoetsch]
+	  bugfix: max for BAR_T
+
+2001-03-16  ltoetsch
+
+	* [r127]
+	  [lcd4linux @ 2001-03-16 16:40:17 by ltoetsch]
+	  implemented time bar
+
+	* [r126]
+	  [lcd4linux @ 2001-03-16 09:28:08 by ltoetsch]
+	  bugfixes
+
+2001-03-15  ltoetsch
+
+	* [r125]
+	  [lcd4linux @ 2001-03-15 15:49:22 by ltoetsch]
+	  fixed compile HD44780.c, cosmetics
+
+	* [r124]
+	  [lcd4linux @ 2001-03-15 14:25:05 by ltoetsch]
+	  added unread/total news
+
+	* [r123]
+	  [lcd4linux @ 2001-03-15 11:10:53 by ltoetsch]
+	  added quit/logout to pop/imap
+
+2001-03-15  reinelt
+
+	* [r122]
+	  [lcd4linux @ 2001-03-15 09:47:13 by reinelt]
+	  some fixes to ppdef
+	  off-by-one bug in processor.c fixed
+
+2001-03-15  ltoetsch
+
+	* [r121]
+	  [lcd4linux @ 2001-03-15 09:13:22 by ltoetsch]
+	  delay first exec for faster start
+
+2001-03-14  reinelt
+
+	* [r120]
+	  [lcd4linux @ 2001-03-14 16:47:41 by reinelt]
+	  minor cleanups
+
+	* [r119]
+	  [lcd4linux @ 2001-03-14 15:30:53 by reinelt]
+	  make ppdev compatible to earlier kernels
+
+	* [r118]
+	  [lcd4linux @ 2001-03-14 15:14:59 by reinelt]
+	  added ppdev parallel port access
+
+2001-03-14  ltoetsch
+
+	* [r117]
+	  [lcd4linux @ 2001-03-14 13:19:29 by ltoetsch]
+	  Added pop3/imap4 mail support
+
+2001-03-13  reinelt
+
+	* [r116]
+	  [lcd4linux @ 2001-03-13 08:34:15 by reinelt]
+	  corrected a off-by-one bug with sensors
+
+	* [r115]
+	  [lcd4linux @ 2001-03-13 08:03:41 by reinelt]
+	  added missing autoheader files
+
+	* [r114]
+	  [lcd4linux @ 2001-03-13 07:53:00 by reinelt]
+	  added several files for the distribution
+
+	* [r113]
+	  [lcd4linux @ 2001-03-13 07:41:22 by reinelt]
+	  added NEWS file
+
+2001-03-12  reinelt
+
+	* [r112]
+	  [lcd4linux @ 2001-03-12 13:44:58 by reinelt]
+	  new udelay() using Time Stamp Counters
+
+	* [r111]
+	  [lcd4linux @ 2001-03-12 12:49:24 by reinelt]
+	  even better configure handling...
+
+	* [r110]
+	  [lcd4linux @ 2001-03-12 12:39:36 by reinelt]
+	  reworked autoconf a lot: drivers may be excluded, #define's went
+	  to config.h
+
+2001-03-09  ltoetsch
+
+	* [r109]
+	  [lcd4linux @ 2001-03-09 16:24:30 by ltoetsch]
+	  disable driver in configure
+
+2001-03-09  reinelt
+
+	* [r108]
+	  [lcd4linux @ 2001-03-09 15:04:53 by reinelt]
+	  rename 'raster' to 'Text in Text.c
+	  added TOTO item
+
+	* [r107]
+	  [lcd4linux @ 2001-03-09 14:30:01 by reinelt]
+	  new ideas for TODO
+
+2001-03-09  ltoetsch
+
+	* [r106]
+	  [lcd4linux @ 2001-03-09 14:24:49 by ltoetsch]
+	  exec: Scale_x ->Min/Max_x
+
+	* [r105]
+	  [lcd4linux @ 2001-03-09 13:08:11 by ltoetsch]
+	  Added Text driver
+
+2001-03-09  reinelt
+
+	* [r104]
+	  [lcd4linux @ 2001-03-09 12:14:24 by reinelt]
+	  minor cleanups
+
+2001-03-08  ltoetsch
+
+	* [r103]
+	  [lcd4linux @ 2001-03-08 15:25:38 by ltoetsch]
+	  improved exec
+
+2001-03-08  reinelt
+
+	* [r102]
+	  [lcd4linux @ 2001-03-08 09:02:04 by reinelt]
+	  seti client cleanup
+
+	* [r101]
+	  [lcd4linux @ 2001-03-08 08:39:54 by reinelt]
+	  fixed two typos
+
+2001-03-07  ltoetsch
+
+	* [r100]
+	  [lcd4linux @ 2001-03-07 18:10:21 by ltoetsch]
+	  added e(x)ec commands
+
+2001-03-05  reinelt
+
+	* [r99]
+	  [lcd4linux @ 2001-03-05 18:20:21 by reinelt]
+	  TOTO list update
+
+2001-03-04  ltoetsch
+
+	* [r98]
+	  [lcd4linux @ 2001-03-04 15:01:12 by ltoetsch]
+	  Added PNG
+
+2001-03-02  reinelt
+
+	* [r97]
+	  [lcd4linux @ 2001-03-02 20:18:12 by reinelt]
+	  allow compile on systems without net/if_ppp.h
+
+	* [r96]
+	  [lcd4linux @ 2001-03-02 18:06:18 by reinelt]
+	  README for PNG added
+
+	* [r95]
+	  [lcd4linux @ 2001-03-02 17:18:52 by reinelt]
+	  let configure find gd.h
+
+	* [r94]
+	  [lcd4linux @ 2001-03-02 11:04:08 by reinelt]
+	  cosmetic cleanups (comment headers)
+
+2001-03-02  ltoetsch
+
+	* [r93]
+	  [lcd4linux @ 2001-03-02 10:18:03 by ltoetsch]
+	  added /proc/apm battery stat
+
+2001-03-01  reinelt
+
+	* [r92]
+	  [lcd4linux @ 2001-03-01 22:33:50 by reinelt]
+	  renamed Raster_flush() to PPM_flush()
+
+2001-03-01  ltoetsch
+
+	* [r91]
+	  [lcd4linux @ 2001-03-01 15:11:30 by ltoetsch]
+	  added PNG,Webinterface
+
+2001-03-01  reinelt
+
+	* [r90]
+	  [lcd4linux @ 2001-03-01 11:08:16 by reinelt]
+	  reworked configure to allow selection of drivers
+
+2001-02-26  herp
+
+	* [r89]
+	  [lcd4linux @ 2001-02-26 00:33:37 by herp]
+	  fixed X11 signal handler
+
+2001-02-21  reinelt
+
+	* [r88]
+	  [lcd4linux @ 2001-02-21 04:48:13 by reinelt]
+	  big mailbox patch from Axel Ehnert
+	  thanks to herp for his idea to check mtime of mailbox
+
+2001-02-19  reinelt
+
+	* [r87]
+	  [lcd4linux @ 2001-02-19 00:15:46 by reinelt]
+	  integrated mail and seti client
+	  major rewrite of parser and tokenizer to support double-byte
+	  tokens
+
+2001-02-18  reinelt
+
+	* [r86]
+	  [lcd4linux @ 2001-02-18 22:11:34 by reinelt]
+
+	* [r85]
+	  [lcd4linux @ 2001-02-18 21:16:06 by reinelt]
+
+	* [r84]
+	  [lcd4linux @ 2001-02-18 21:15:15 by reinelt]
+	  added setiathome client
+
+	* [r83]
+	  [lcd4linux @ 2001-02-18 20:16:13 by reinelt]
+
+2001-02-16  reinelt
+
+	* [r82]
+	  [lcd4linux @ 2001-02-16 14:15:11 by reinelt]
+	  fixed type in processor.c
+	  GPO documentation update from Carsten
+
+	* [r81]
+	  [lcd4linux @ 2001-02-16 08:23:09 by reinelt]
+	  new token 'ic' (ISDN connected) by Carsten Nau <info@cnau.de>
+
+2001-02-14  reinelt
+
+	* [r80]
+	  [lcd4linux @ 2001-02-14 07:40:16 by reinelt]
+	  first (incomplete) GPO implementation
+
+	* [r79]
+	  [lcd4linux @ 2001-02-14 05:22:42 by reinelt]
+	  added README from Carsten Nau
+
+2001-02-13  reinelt
+
+	* [r78]
+	  [lcd4linux @ 2001-02-13 12:43:24 by reinelt]
+	  HD_gpo() was missing
+
+	* [r77]
+	  [lcd4linux @ 2001-02-13 09:00:13 by reinelt]
+	  prepared framework for GPO's (general purpose outputs)
+
+2001-02-11  reinelt
+
+	* [r76]
+	  [lcd4linux @ 2001-02-11 23:34:07 by reinelt]
+	  fixed a small bug where the throughput of an offline ISDN
+	  connection is displayed as '----', but the
+	  online value is 5 chars long. corrected to ' ----'.
+	  thanks to Carsten Nau <info@cnau.de>
+
+2000-12-07  reinelt
+
+	* [r75]
+	  [lcd4linux @ 2000-12-07 20:47:54 by reinelt]
+	  first try for SIN bars
+
+2000-12-01  reinelt
+
+	* [r74]
+	  [lcd4linux @ 2000-12-01 20:42:37 by reinelt]
+	  added debugging of SIN driver output, probably found the
+	  positioning bug (format %02x instead of %2x)
+
+	* [r73]
+	  [lcd4linux @ 2000-12-01 07:20:26 by reinelt]
+	  modified text positioning: row starts with 0, column is
+	  hexadecimal
+
+2000-11-28  reinelt
+
+	* [r72]
+	  [lcd4linux @ 2000-11-28 20:20:38 by reinelt]
+	  added debug.c
+	  things like that should not hapen. debug.c exists for a few
+	  months now, but was never added to CVS. Shit happens....
+
+	* [r71]
+	  [lcd4linux @ 2000-11-28 17:27:19 by reinelt]
+	  changed decimal values for screen, row, column to ascii values
+	  (shame on you!)
+
+	* [r70]
+	  [lcd4linux @ 2000-11-28 16:46:11 by reinelt]
+	  first try to support display of SIN router
+
+2000-11-17  reinelt
+
+	* [r69]
+	  [lcd4linux @ 2000-11-17 10:36:23 by reinelt]
+	  fixed parsing of /proc/net/dev for 2.0 kernels
+
+2000-10-25  reinelt
+
+	* [r68]
+	  [lcd4linux @ 2000-10-25 08:10:48 by reinelt]
+	  added restart funnctionality
+	  (lots of this code was stolen from sendmail.c)
+
+2000-10-20  reinelt
+
+	* [r67]
+	  [lcd4linux @ 2000-10-20 07:17:07 by reinelt]
+	  corrected a bug in HD_goto()
+	  Thanks to Gregor Szaktilla <gregor@szaktilla.de>
+
+2000-10-08  reinelt
+
+	* [r66]
+	  [lcd4linux @ 2000-10-08 09:16:40 by reinelt]
+	  Linux-2.4.0-test9 changed the layout of /proc/stat (especially
+	  the disk_io line)
+	  rearranged parsing of some /proc files and (hopefully) made it
+	  more robust in concerns of format changes
+
+2000-08-10  reinelt
+
+	* [r65]
+	  [lcd4linux @ 2000-08-10 18:42:20 by reinelt]
+	  fixed some bugs with the new syslog code
+
+	* [r64]
+	  [lcd4linux @ 2000-08-10 09:44:09 by reinelt]
+	  new debugging scheme: error(), info(), debug()
+	  uses syslog if in daemon mode
+
+2000-08-09  reinelt
+
+	* [r63]
+	  [lcd4linux @ 2000-08-09 14:14:11 by reinelt]
+	  new switch -F (do not fork)
+	  added automatic forking if -F not specified
+
+	* [r62]
+	  [lcd4linux @ 2000-08-09 11:03:07 by reinelt]
+	  fixed a bug in system.c where the format of /proc/net/dev was not
+	  correctly
+	  detected and parsed with different kernels
+
+	* [r61]
+	  [lcd4linux @ 2000-08-09 09:50:29 by reinelt]
+	  opened 0.98 development
+	  removed driver-specific signal-handlers
+	  added 'quit'-function to driver structure
+	  added global signal-handler
+
+2000-07-31  reinelt
+
+	* [r60]
+	  [lcd4linux @ 2000-07-31 10:43:44 by reinelt]
+	  some changes to support kernel-2.4 (different layout of various
+	  files in /proc)
+
+	* [r59]
+	  [lcd4linux @ 2000-07-31 06:46:35 by reinelt]
+	  eliminated some compiler warnings with glibc
+
+2000-06-04  herp
+
+	* [r58]
+	  [lcd4linux @ 2000-06-04 21:43:50 by herp]
+	  minor bugfix (zero length)
+
+2000-05-21  reinelt
+
+	* [r57]
+	  [lcd4linux @ 2000-05-21 06:20:35 by reinelt]
+	  added ppp throughput
+	  token is '%t[iomt]' at the moment, but this will change in the
+	  near future
+
+2000-05-03  herp
+
+	* [r56]
+	  [lcd4linux @ 2000-05-03 17:14:51 by herp]
+
+	* [r55]
+	  [lcd4linux @ 2000-05-03 09:37:32 by herp]
+
+2000-05-02  herp
+
+	* [r54]
+	  [lcd4linux @ 2000-05-02 23:07:48 by herp]
+	  Crystalfontz initial coding
+
+2000-05-02  reinelt
+
+	* [r53]
+	  [lcd4linux @ 2000-05-02 06:05:00 by reinelt]
+	  driver for 3Com Palm Pilot added
+
+2000-04-30  reinelt
+
+	* [r52]
+	  [lcd4linux @ 2000-04-30 06:40:42 by reinelt]
+	  bars for Beckmann+Egle driver
+
+2000-04-28  reinelt
+
+	* [r51]
+	  [lcd4linux @ 2000-04-28 05:19:55 by reinelt]
+	  first release of the Beckmann+Egle driver
+
+2000-04-20  reinelt
+
+	* [r50]
+	  [lcd4linux @ 2000-04-20 05:48:42 by reinelt]
+	  added documentation to EXTRA_DIST so that they go into the
+	  tarball
+
+2000-04-19  reinelt
+
+	* [r49]
+	  [lcd4linux @ 2000-04-19 04:44:20 by reinelt]
+	  README for HD44780 driver
+
+2000-04-17  reinelt
+
+	* [r48]
+	  [lcd4linux @ 2000-04-17 05:14:27 by reinelt]
+	  added README.44780
+
+2000-04-15  reinelt
+
+	* [r47]
+	  [lcd4linux @ 2000-04-15 16:56:52 by reinelt]
+	  moved delay loops to udelay.c
+	  renamed -d (debugging) switch to -v (verbose)
+	  new switch -d to calibrate delay loop
+	  'Delay' entry for HD44780 back again
+	  delay loops will not calibrate automatically, because this will
+	  fail with hich CPU load
+
+	* [r46]
+	  [lcd4linux @ 2000-04-15 11:56:35 by reinelt]
+	  more debug messages
+
+	* [r45]
+	  [lcd4linux @ 2000-04-15 11:13:54 by reinelt]
+	  added '-d' (debugging) switch
+	  added several debugging messages
+	  removed config entry 'Delay' for HD44780 driver
+	  delay loop for HD44780 will be calibrated automatically
+
+2000-04-13  reinelt
+
+	* [r44]
+	  [lcd4linux @ 2000-04-13 06:09:52 by reinelt]
+	  added BogoMips() to system.c (not used by now, maybe sometimes we
+	  can
+	  calibrate our delay loop with this value)
+	  
+	  added delay loop to HD44780 driver. It seems to be quite fast
+	  now. Hopefully
+	  no compiler will optimize away the delay loop!
+
+2000-04-12  reinelt
+
+	* [r43]
+	  [lcd4linux @ 2000-04-12 08:05:45 by reinelt]
+	  first version of the HD44780 driver
+
+2000-04-10  reinelt
+
+	* [r42]
+	  [lcd4linux @ 2000-04-10 04:40:53 by reinelt]
+	  minor changes and cleanups
+
+2000-04-07  reinelt
+
+	* [r41]
+	  [lcd4linux @ 2000-04-07 05:42:20 by reinelt]
+	  UUCP style lockfiles for the serial port
+
+2000-04-05  reinelt
+
+	* [r40]
+	  [lcd4linux @ 2000-04-05 05:58:36 by reinelt]
+	  fixed bug in XWindow.c: union semun isn't defined with glibc-2.1
+
+	* [r39]
+	  [lcd4linux @ 2000-04-05 04:12:00 by reinelt]
+	  TODO added
+
+2000-04-03  herp
+
+	* [r38]
+	  [lcd4linux @ 2000-04-03 23:53:23 by herp]
+	  fixed a bug that caused pixel-errors ("fliegendreck") under high
+	  load
+
+2000-04-03  reinelt
+
+	* [r37]
+	  [lcd4linux @ 2000-04-03 17:31:52 by reinelt]
+	  suppress welcome message if display is smaller than 20x2
+	  change lcd4linux.ppm to 32 pixel high so KDE won't stretch the
+	  icon
+
+	* [r36]
+	  [lcd4linux @ 2000-04-03 06:54:03 by reinelt]
+	  KDE application link
+
+	* [r35]
+	  [lcd4linux @ 2000-04-03 06:53:09 by reinelt]
+	  releasing 0.96
+	  annoying X11 bugs hopefully fixed
+	  KDE integration
+
+	* [r34]
+	  [lcd4linux @ 2000-04-03 04:46:38 by reinelt]
+	  added '-c key=val' option
+
+	* [r33]
+	  [lcd4linux @ 2000-04-03 04:01:31 by reinelt]
+	  if 'gap' is specified as -1, a gap of (pixelsize+pixelgap) is
+	  selected automatically
+
+2000-04-02  herp
+
+	* [r32]
+	  [lcd4linux @ 2000-04-02 22:07:10 by herp]
+	  fixded a bug that occasionally caused Xlib errors
+
+2000-04-01  herp
+
+	* [r31]
+	  [lcd4linux @ 2000-04-01 22:40:42 by herp]
+	  geometric correction (too many pixelgaps)
+	  lcd4linux main should return int, not void
+
+	* [r30]
+	  [lcd4linux @ 2000-04-01 19:33:45 by herp]
+	  colors in format \#RRGGBB in config-file now understood
+
+2000-04-01  reinelt
+
+	* [r29]
+	  [lcd4linux @ 2000-04-01 16:22:38 by reinelt]
+	  bug that caused a segfault in processor.c fixed (thanks to herp)
+
+2000-03-31  reinelt
+
+	* [r28]
+	  [lcd4linux @ 2000-03-31 04:41:22 by reinelt]
+	  X11 driver: semaphore bug fixed
+
+2000-03-30  reinelt
+
+	* [r27]
+	  [lcd4linux @ 2000-03-30 16:46:57 by reinelt]
+	  configure now handles '--with-x' and '--without-x' correct
+
+2000-03-28  reinelt
+
+	* [r26]
+	  [lcd4linux @ 2000-03-28 08:48:33 by reinelt]
+	  README.X11 added
+
+	* [r25]
+	  [lcd4linux @ 2000-03-28 07:22:15 by reinelt]
+	  version 0.95 released
+	  X11 driver up and running
+	  minor bugs fixed
+
+2000-03-26  reinelt
+
+	* [r24]
+	  [lcd4linux @ 2000-03-26 20:00:44 by reinelt]
+	  README.Raster added
+
+	* [r23]
+	  [lcd4linux @ 2000-03-26 19:03:52 by reinelt]
+	  more Pixmap renaming
+	  quoting of '#' in config file
+
+	* [r22]
+	  [lcd4linux @ 2000-03-26 18:46:28 by reinelt]
+	  bug in pixmap.c that leaded to empty bars fixed
+	  name conflicts with X11 resolved
+
+	* [r21]
+	  [lcd4linux @ 2000-03-26 12:55:03 by reinelt]
+	  enhancements to the PPM driver
+
+2000-03-25  reinelt
+
+	* [r20]
+	  [lcd4linux @ 2000-03-25 05:50:43 by reinelt]
+	  memory leak in Raster_flush closed
+	  driver family logic changed
+
+2000-03-24  reinelt
+
+	* [r19]
+	  [lcd4linux @ 2000-03-24 11:37:43 by reinelt]
+	  fontmap.h added
+
+	* [r18]
+	  [lcd4linux @ 2000-03-24 11:36:56 by reinelt]
+	  new syntax for raster configuration
+	  changed XRES and YRES to be configurable
+	  PPM driver works nice
+
+2000-03-23  reinelt
+
+	* [r17]
+	  [lcd4linux @ 2000-03-23 07:24:48 by reinelt]
+	  PPM driver up and running (but slow!)
+
+2000-03-22  reinelt
+
+	* [r16]
+	  [lcd4linux @ 2000-03-22 15:36:21 by reinelt]
+	  added '-l' switch (list drivers)
+	  generic pixmap driver added
+	  X11 Framework done
+
+	* [r15]
+	  [lcd4linux @ 2000-03-22 07:33:50 by reinelt]
+	  FAQ added
+	  new modules 'processor.c' contains all data processing
+
+2000-03-19  reinelt
+
+	* [r14]
+	  [lcd4linux @ 2000-03-19 08:41:28 by reinelt]
+	  documentation available! README, README.MatrixOrbital,
+	  README.Drivers
+	  added Skeleton.c as a starting point for new drivers
+
+2000-03-18  reinelt
+
+	* [r13]
+	  [lcd4linux @ 2000-03-18 10:31:06 by reinelt]
+	  added sensor handling (for temperature etc.)
+	  made data collecting happen only if data is used
+	  (reading /proc/meminfo takes a lot of CPU!)
+	  released lcd4linux-0.92
+
+	* [r12]
+	  [lcd4linux @ 2000-03-18 08:07:04 by reinelt]
+	  vertical bars implemented
+	  bar compaction improved
+	  memory information implemented
+
+2000-03-17  reinelt
+
+	* [r11]
+	  [lcd4linux @ 2000-03-17 09:21:42 by reinelt]
+	  various memory statistics added
+
+2000-03-13  reinelt
+
+	* [r10]
+	  [lcd4linux @ 2000-03-13 15:58:24 by reinelt]
+	  release 0.9
+	  moved row parsing to parser.c
+	  all basic work finished
+
+2000-03-10  reinelt
+
+	* [r9]
+	  [lcd4linux @ 2000-03-10 17:36:02 by reinelt]
+	  first unstable but running release
+
+	* [r8]
+	  [lcd4linux @ 2000-03-10 12:02:43 by reinelt]
+	  autoconf/automake
+
+	* [r7]
+	  [lcd4linux @ 2000-03-10 11:40:47 by reinelt]
+
+	* [r6]
+	  [lcd4linux @ 2000-03-10 10:49:53 by reinelt]
+	  MatrixOrbital driver finished
+
+2000-03-07  reinelt
+
+	* [r5]
+	  [lcd4linux @ 2000-03-07 11:01:34 by reinelt]
+	  system.c cleanup
+
+2000-03-06  reinelt
+
+	* [r4]
+	  [lcd4linux @ 2000-03-06 06:04:06 by reinelt]
+	  minor cleanups
+
+2000-01-16  reinelt
+
+	* [r3]
+	  [lcd4linux @ 2000-01-16 16:58:50 by reinelt]
+
+	* [r2]
+	  [lcd4linux @ 2000-01-16 12:17:59 by reinelt]
+	  Initial revision
+
+2000-01-16  root
+
+	* [r1]
+	  initial import
 
diff -urN lcd4linux-0.10.0/config.guess lcd4linux-0.11.0-SVN/config.guess
--- lcd4linux-0.10.0/config.guess	2004-06-08 14:33:47.000000000 +0200
+++ lcd4linux-0.11.0-SVN/config.guess	2008-12-31 08:05:54.000000000 +0100
@@ -1,9 +1,10 @@
 #! /bin/sh
 # Attempt to guess a canonical system name.
 #   Copyright (C) 1992, 1993, 1994, 1995, 1996, 1997, 1998, 1999,
-#   2000, 2001, 2002, 2003 Free Software Foundation, Inc.
+#   2000, 2001, 2002, 2003, 2004, 2005, 2006, 2007, 2008
+#   Free Software Foundation, Inc.
 
-timestamp='2004-03-12'
+timestamp='2008-01-23'
 
 # This file is free software; you can redistribute it and/or modify it
 # under the terms of the GNU General Public License as published by
@@ -17,13 +18,15 @@
 #
 # You should have received a copy of the GNU General Public License
 # along with this program; if not, write to the Free Software
-# Foundation, Inc., 59 Temple Place - Suite 330, Boston, MA 02111-1307, USA.
+# Foundation, Inc., 51 Franklin Street - Fifth Floor, Boston, MA
+# 02110-1301, USA.
 #
 # As a special exception to the GNU General Public License, if you
 # distribute this file as part of a program that contains a
 # configuration script generated by Autoconf, you may include it under
 # the same distribution terms that you use for the rest of that program.
 
+
 # Originally written by Per Bothner <per@bothner.com>.
 # Please send patches to <config-patches@gnu.org>.  Submit a context
 # diff and a properly formatted ChangeLog entry.
@@ -53,8 +56,8 @@
 GNU config.guess ($timestamp)
 
 Originally written by Per Bothner.
-Copyright (C) 1992, 1993, 1994, 1995, 1996, 1997, 1998, 1999, 2000, 2001
-Free Software Foundation, Inc.
+Copyright (C) 1992, 1993, 1994, 1995, 1996, 1997, 1998, 1999, 2000, 2001,
+2002, 2003, 2004, 2005, 2006, 2007, 2008 Free Software Foundation, Inc.
 
 This is free software; see the source for copying conditions.  There is NO
 warranty; not even for MERCHANTABILITY or FITNESS FOR A PARTICULAR PURPOSE."
@@ -66,11 +69,11 @@
 while test $# -gt 0 ; do
   case $1 in
     --time-stamp | --time* | -t )
-       echo "$timestamp" ; exit 0 ;;
+       echo "$timestamp" ; exit ;;
     --version | -v )
-       echo "$version" ; exit 0 ;;
+       echo "$version" ; exit ;;
     --help | --h* | -h )
-       echo "$usage"; exit 0 ;;
+       echo "$usage"; exit ;;
     -- )     # Stop option processing
        shift; break ;;
     - )	# Use stdin as input.
@@ -104,7 +107,7 @@
 trap "exitcode=\$?; (rm -f \$tmpfiles 2>/dev/null; rmdir \$tmp 2>/dev/null) && exit \$exitcode" 0 ;
 trap "rm -f \$tmpfiles 2>/dev/null; rmdir \$tmp 2>/dev/null; exit 1" 1 2 13 15 ;
 : ${TMPDIR=/tmp} ;
- { tmp=`(umask 077 && mktemp -d -q "$TMPDIR/cgXXXXXX") 2>/dev/null` && test -n "$tmp" && test -d "$tmp" ; } ||
+ { tmp=`(umask 077 && mktemp -d "$TMPDIR/cgXXXXXX") 2>/dev/null` && test -n "$tmp" && test -d "$tmp" ; } ||
  { test -n "$RANDOM" && tmp=$TMPDIR/cg$$-$RANDOM && (umask 077 && mkdir $tmp) ; } ||
  { tmp=$TMPDIR/cg-$$ && (umask 077 && mkdir $tmp) && echo "Warning: creating insecure temp directory" >&2 ; } ||
  { echo "$me: cannot create a temporary directory in $TMPDIR" >&2 ; exit 1 ; } ;
@@ -123,7 +126,7 @@
 	;;
  ,,*)   CC_FOR_BUILD=$CC ;;
  ,*,*)  CC_FOR_BUILD=$HOST_CC ;;
-esac ;'
+esac ; set_cc_for_build= ;'
 
 # This is needed to find uname on a Pyramid OSx when run in the BSD universe.
 # (ghazi@noc.rutgers.edu 1994-08-24)
@@ -158,6 +161,7 @@
 	    arm*) machine=arm-unknown ;;
 	    sh3el) machine=shl-unknown ;;
 	    sh3eb) machine=sh-unknown ;;
+	    sh5el) machine=sh5le-unknown ;;
 	    *) machine=${UNAME_MACHINE_ARCH}-unknown ;;
 	esac
 	# The Operating System including object format, if it has switched
@@ -196,64 +200,23 @@
 	# contains redundant information, the shorter form:
 	# CPU_TYPE-MANUFACTURER-OPERATING_SYSTEM is used.
 	echo "${machine}-${os}${release}"
-	exit 0 ;;
-    amd64:OpenBSD:*:*)
-	echo x86_64-unknown-openbsd${UNAME_RELEASE}
-	exit 0 ;;
-    amiga:OpenBSD:*:*)
-	echo m68k-unknown-openbsd${UNAME_RELEASE}
-	exit 0 ;;
-    arc:OpenBSD:*:*)
-	echo mipsel-unknown-openbsd${UNAME_RELEASE}
-	exit 0 ;;
-    cats:OpenBSD:*:*)
-	echo arm-unknown-openbsd${UNAME_RELEASE}
-	exit 0 ;;
-    hp300:OpenBSD:*:*)
-	echo m68k-unknown-openbsd${UNAME_RELEASE}
-	exit 0 ;;
-    mac68k:OpenBSD:*:*)
-	echo m68k-unknown-openbsd${UNAME_RELEASE}
-	exit 0 ;;
-    macppc:OpenBSD:*:*)
-	echo powerpc-unknown-openbsd${UNAME_RELEASE}
-	exit 0 ;;
-    mvme68k:OpenBSD:*:*)
-	echo m68k-unknown-openbsd${UNAME_RELEASE}
-	exit 0 ;;
-    mvme88k:OpenBSD:*:*)
-	echo m88k-unknown-openbsd${UNAME_RELEASE}
-	exit 0 ;;
-    mvmeppc:OpenBSD:*:*)
-	echo powerpc-unknown-openbsd${UNAME_RELEASE}
-	exit 0 ;;
-    pegasos:OpenBSD:*:*)
-	echo powerpc-unknown-openbsd${UNAME_RELEASE}
-	exit 0 ;;
-    pmax:OpenBSD:*:*)
-	echo mipsel-unknown-openbsd${UNAME_RELEASE}
-	exit 0 ;;
-    sgi:OpenBSD:*:*)
-	echo mipseb-unknown-openbsd${UNAME_RELEASE}
-	exit 0 ;;
-    sun3:OpenBSD:*:*)
-	echo m68k-unknown-openbsd${UNAME_RELEASE}
-	exit 0 ;;
-    wgrisc:OpenBSD:*:*)
-	echo mipsel-unknown-openbsd${UNAME_RELEASE}
-	exit 0 ;;
+	exit ;;
     *:OpenBSD:*:*)
-	echo ${UNAME_MACHINE}-unknown-openbsd${UNAME_RELEASE}
-	exit 0 ;;
+	UNAME_MACHINE_ARCH=`arch | sed 's/OpenBSD.//'`
+	echo ${UNAME_MACHINE_ARCH}-unknown-openbsd${UNAME_RELEASE}
+	exit ;;
     *:ekkoBSD:*:*)
 	echo ${UNAME_MACHINE}-unknown-ekkobsd${UNAME_RELEASE}
-	exit 0 ;;
+	exit ;;
+    *:SolidBSD:*:*)
+	echo ${UNAME_MACHINE}-unknown-solidbsd${UNAME_RELEASE}
+	exit ;;
     macppc:MirBSD:*:*)
-	echo powerppc-unknown-mirbsd${UNAME_RELEASE}
-	exit 0 ;;
+	echo powerpc-unknown-mirbsd${UNAME_RELEASE}
+	exit ;;
     *:MirBSD:*:*)
 	echo ${UNAME_MACHINE}-unknown-mirbsd${UNAME_RELEASE}
-	exit 0 ;;
+	exit ;;
     alpha:OSF1:*:*)
 	case $UNAME_RELEASE in
 	*4.0)
@@ -306,40 +269,43 @@
 	# A Xn.n version is an unreleased experimental baselevel.
 	# 1.2 uses "1.2" for uname -r.
 	echo ${UNAME_MACHINE}-dec-osf`echo ${UNAME_RELEASE} | sed -e 's/^[PVTX]//' | tr 'ABCDEFGHIJKLMNOPQRSTUVWXYZ' 'abcdefghijklmnopqrstuvwxyz'`
-	exit 0 ;;
-    Alpha*:OpenVMS:*:*)
-	echo alpha-hp-vms
-	exit 0 ;;
+	exit ;;
     Alpha\ *:Windows_NT*:*)
 	# How do we know it's Interix rather than the generic POSIX subsystem?
 	# Should we change UNAME_MACHINE based on the output of uname instead
 	# of the specific Alpha model?
 	echo alpha-pc-interix
-	exit 0 ;;
+	exit ;;
     21064:Windows_NT:50:3)
 	echo alpha-dec-winnt3.5
-	exit 0 ;;
+	exit ;;
     Amiga*:UNIX_System_V:4.0:*)
 	echo m68k-unknown-sysv4
-	exit 0;;
+	exit ;;
     *:[Aa]miga[Oo][Ss]:*:*)
 	echo ${UNAME_MACHINE}-unknown-amigaos
-	exit 0 ;;
+	exit ;;
     *:[Mm]orph[Oo][Ss]:*:*)
 	echo ${UNAME_MACHINE}-unknown-morphos
-	exit 0 ;;
+	exit ;;
     *:OS/390:*:*)
 	echo i370-ibm-openedition
-	exit 0 ;;
+	exit ;;
+    *:z/VM:*:*)
+	echo s390-ibm-zvmoe
+	exit ;;
     *:OS400:*:*)
         echo powerpc-ibm-os400
-	exit 0 ;;
+	exit ;;
     arm:RISC*:1.[012]*:*|arm:riscix:1.[012]*:*)
 	echo arm-acorn-riscix${UNAME_RELEASE}
-	exit 0;;
+	exit ;;
+    arm:riscos:*:*|arm:RISCOS:*:*)
+	echo arm-unknown-riscos
+	exit ;;
     SR2?01:HI-UX/MPP:*:* | SR8000:HI-UX/MPP:*:*)
 	echo hppa1.1-hitachi-hiuxmpp
-	exit 0;;
+	exit ;;
     Pyramid*:OSx*:*:* | MIS*:OSx*:*:* | MIS*:SMP_DC-OSx*:*:*)
 	# akee@wpdis03.wpafb.af.mil (Earle F. Ake) contributed MIS and NILE.
 	if test "`(/bin/universe) 2>/dev/null`" = att ; then
@@ -347,32 +313,32 @@
 	else
 		echo pyramid-pyramid-bsd
 	fi
-	exit 0 ;;
+	exit ;;
     NILE*:*:*:dcosx)
 	echo pyramid-pyramid-svr4
-	exit 0 ;;
+	exit ;;
     DRS?6000:unix:4.0:6*)
 	echo sparc-icl-nx6
-	exit 0 ;;
-    DRS?6000:UNIX_SV:4.2*:7*)
+	exit ;;
+    DRS?6000:UNIX_SV:4.2*:7* | DRS?6000:isis:4.2*:7*)
 	case `/usr/bin/uname -p` in
-	    sparc) echo sparc-icl-nx7 && exit 0 ;;
+	    sparc) echo sparc-icl-nx7; exit ;;
 	esac ;;
     sun4H:SunOS:5.*:*)
 	echo sparc-hal-solaris2`echo ${UNAME_RELEASE}|sed -e 's/[^.]*//'`
-	exit 0 ;;
+	exit ;;
     sun4*:SunOS:5.*:* | tadpole*:SunOS:5.*:*)
 	echo sparc-sun-solaris2`echo ${UNAME_RELEASE}|sed -e 's/[^.]*//'`
-	exit 0 ;;
-    i86pc:SunOS:5.*:*)
+	exit ;;
+    i86pc:SunOS:5.*:* | i86xen:SunOS:5.*:*)
 	echo i386-pc-solaris2`echo ${UNAME_RELEASE}|sed -e 's/[^.]*//'`
-	exit 0 ;;
+	exit ;;
     sun4*:SunOS:6*:*)
 	# According to config.sub, this is the proper way to canonicalize
 	# SunOS6.  Hard to guess exactly what SunOS6 will be like, but
 	# it's likely to be more like Solaris than SunOS4.
 	echo sparc-sun-solaris3`echo ${UNAME_RELEASE}|sed -e 's/[^.]*//'`
-	exit 0 ;;
+	exit ;;
     sun4*:SunOS:*:*)
 	case "`/usr/bin/arch -k`" in
 	    Series*|S4*)
@@ -381,10 +347,10 @@
 	esac
 	# Japanese Language versions have a version number like `4.1.3-JL'.
 	echo sparc-sun-sunos`echo ${UNAME_RELEASE}|sed -e 's/-/_/'`
-	exit 0 ;;
+	exit ;;
     sun3*:SunOS:*:*)
 	echo m68k-sun-sunos${UNAME_RELEASE}
-	exit 0 ;;
+	exit ;;
     sun*:*:4.2BSD:*)
 	UNAME_RELEASE=`(sed 1q /etc/motd | awk '{print substr($5,1,3)}') 2>/dev/null`
 	test "x${UNAME_RELEASE}" = "x" && UNAME_RELEASE=3
@@ -396,10 +362,10 @@
 		echo sparc-sun-sunos${UNAME_RELEASE}
 		;;
 	esac
-	exit 0 ;;
+	exit ;;
     aushp:SunOS:*:*)
 	echo sparc-auspex-sunos${UNAME_RELEASE}
-	exit 0 ;;
+	exit ;;
     # The situation for MiNT is a little confusing.  The machine name
     # can be virtually everything (everything which is not
     # "atarist" or "atariste" at least should have a processor
@@ -410,40 +376,40 @@
     # be no problem.
     atarist[e]:*MiNT:*:* | atarist[e]:*mint:*:* | atarist[e]:*TOS:*:*)
         echo m68k-atari-mint${UNAME_RELEASE}
-	exit 0 ;;
+	exit ;;
     atari*:*MiNT:*:* | atari*:*mint:*:* | atarist[e]:*TOS:*:*)
 	echo m68k-atari-mint${UNAME_RELEASE}
-        exit 0 ;;
+        exit ;;
     *falcon*:*MiNT:*:* | *falcon*:*mint:*:* | *falcon*:*TOS:*:*)
         echo m68k-atari-mint${UNAME_RELEASE}
-	exit 0 ;;
+	exit ;;
     milan*:*MiNT:*:* | milan*:*mint:*:* | *milan*:*TOS:*:*)
         echo m68k-milan-mint${UNAME_RELEASE}
-        exit 0 ;;
+        exit ;;
     hades*:*MiNT:*:* | hades*:*mint:*:* | *hades*:*TOS:*:*)
         echo m68k-hades-mint${UNAME_RELEASE}
-        exit 0 ;;
+        exit ;;
     *:*MiNT:*:* | *:*mint:*:* | *:*TOS:*:*)
         echo m68k-unknown-mint${UNAME_RELEASE}
-        exit 0 ;;
+        exit ;;
     m68k:machten:*:*)
 	echo m68k-apple-machten${UNAME_RELEASE}
-	exit 0 ;;
+	exit ;;
     powerpc:machten:*:*)
 	echo powerpc-apple-machten${UNAME_RELEASE}
-	exit 0 ;;
+	exit ;;
     RISC*:Mach:*:*)
 	echo mips-dec-mach_bsd4.3
-	exit 0 ;;
+	exit ;;
     RISC*:ULTRIX:*:*)
 	echo mips-dec-ultrix${UNAME_RELEASE}
-	exit 0 ;;
+	exit ;;
     VAX*:ULTRIX*:*:*)
 	echo vax-dec-ultrix${UNAME_RELEASE}
-	exit 0 ;;
+	exit ;;
     2020:CLIX:*:* | 2430:CLIX:*:*)
 	echo clipper-intergraph-clix${UNAME_RELEASE}
-	exit 0 ;;
+	exit ;;
     mips:*:*:UMIPS | mips:*:*:RISCos)
 	eval $set_cc_for_build
 	sed 's/^	//' << EOF >$dummy.c
@@ -467,32 +433,33 @@
 	  exit (-1);
 	}
 EOF
-	$CC_FOR_BUILD -o $dummy $dummy.c \
-	  && $dummy `echo "${UNAME_RELEASE}" | sed -n 's/\([0-9]*\).*/\1/p'` \
-	  && exit 0
+	$CC_FOR_BUILD -o $dummy $dummy.c &&
+	  dummyarg=`echo "${UNAME_RELEASE}" | sed -n 's/\([0-9]*\).*/\1/p'` &&
+	  SYSTEM_NAME=`$dummy $dummyarg` &&
+	    { echo "$SYSTEM_NAME"; exit; }
 	echo mips-mips-riscos${UNAME_RELEASE}
-	exit 0 ;;
+	exit ;;
     Motorola:PowerMAX_OS:*:*)
 	echo powerpc-motorola-powermax
-	exit 0 ;;
+	exit ;;
     Motorola:*:4.3:PL8-*)
 	echo powerpc-harris-powermax
-	exit 0 ;;
+	exit ;;
     Night_Hawk:*:*:PowerMAX_OS | Synergy:PowerMAX_OS:*:*)
 	echo powerpc-harris-powermax
-	exit 0 ;;
+	exit ;;
     Night_Hawk:Power_UNIX:*:*)
 	echo powerpc-harris-powerunix
-	exit 0 ;;
+	exit ;;
     m88k:CX/UX:7*:*)
 	echo m88k-harris-cxux7
-	exit 0 ;;
+	exit ;;
     m88k:*:4*:R4*)
 	echo m88k-motorola-sysv4
-	exit 0 ;;
+	exit ;;
     m88k:*:3*:R3*)
 	echo m88k-motorola-sysv3
-	exit 0 ;;
+	exit ;;
     AViiON:dgux:*:*)
         # DG/UX returns AViiON for all architectures
         UNAME_PROCESSOR=`/usr/bin/uname -p`
@@ -508,29 +475,29 @@
 	else
 	    echo i586-dg-dgux${UNAME_RELEASE}
 	fi
- 	exit 0 ;;
+ 	exit ;;
     M88*:DolphinOS:*:*)	# DolphinOS (SVR3)
 	echo m88k-dolphin-sysv3
-	exit 0 ;;
+	exit ;;
     M88*:*:R3*:*)
 	# Delta 88k system running SVR3
 	echo m88k-motorola-sysv3
-	exit 0 ;;
+	exit ;;
     XD88*:*:*:*) # Tektronix XD88 system running UTekV (SVR3)
 	echo m88k-tektronix-sysv3
-	exit 0 ;;
+	exit ;;
     Tek43[0-9][0-9]:UTek:*:*) # Tektronix 4300 system running UTek (BSD)
 	echo m68k-tektronix-bsd
-	exit 0 ;;
+	exit ;;
     *:IRIX*:*:*)
 	echo mips-sgi-irix`echo ${UNAME_RELEASE}|sed -e 's/-/_/g'`
-	exit 0 ;;
+	exit ;;
     ????????:AIX?:[12].1:2)   # AIX 2.2.1 or AIX 2.1.1 is RT/PC AIX.
-	echo romp-ibm-aix      # uname -m gives an 8 hex-code CPU id
-	exit 0 ;;              # Note that: echo "'`uname -s`'" gives 'AIX '
+	echo romp-ibm-aix     # uname -m gives an 8 hex-code CPU id
+	exit ;;               # Note that: echo "'`uname -s`'" gives 'AIX '
     i*86:AIX:*:*)
 	echo i386-ibm-aix
-	exit 0 ;;
+	exit ;;
     ia64:AIX:*:*)
 	if [ -x /usr/bin/oslevel ] ; then
 		IBM_REV=`/usr/bin/oslevel`
@@ -538,7 +505,7 @@
 		IBM_REV=${UNAME_VERSION}.${UNAME_RELEASE}
 	fi
 	echo ${UNAME_MACHINE}-ibm-aix${IBM_REV}
-	exit 0 ;;
+	exit ;;
     *:AIX:2:3)
 	if grep bos325 /usr/include/stdio.h >/dev/null 2>&1; then
 		eval $set_cc_for_build
@@ -553,15 +520,19 @@
 			exit(0);
 			}
 EOF
-		$CC_FOR_BUILD -o $dummy $dummy.c && $dummy && exit 0
-		echo rs6000-ibm-aix3.2.5
+		if $CC_FOR_BUILD -o $dummy $dummy.c && SYSTEM_NAME=`$dummy`
+		then
+			echo "$SYSTEM_NAME"
+		else
+			echo rs6000-ibm-aix3.2.5
+		fi
 	elif grep bos324 /usr/include/stdio.h >/dev/null 2>&1; then
 		echo rs6000-ibm-aix3.2.4
 	else
 		echo rs6000-ibm-aix3.2
 	fi
-	exit 0 ;;
-    *:AIX:*:[45])
+	exit ;;
+    *:AIX:*:[456])
 	IBM_CPU_ID=`/usr/sbin/lsdev -C -c processor -S available | sed 1q | awk '{ print $1 }'`
 	if /usr/sbin/lsattr -El ${IBM_CPU_ID} | grep ' POWER' >/dev/null 2>&1; then
 		IBM_ARCH=rs6000
@@ -574,28 +545,28 @@
 		IBM_REV=${UNAME_VERSION}.${UNAME_RELEASE}
 	fi
 	echo ${IBM_ARCH}-ibm-aix${IBM_REV}
-	exit 0 ;;
+	exit ;;
     *:AIX:*:*)
 	echo rs6000-ibm-aix
-	exit 0 ;;
+	exit ;;
     ibmrt:4.4BSD:*|romp-ibm:BSD:*)
 	echo romp-ibm-bsd4.4
-	exit 0 ;;
+	exit ;;
     ibmrt:*BSD:*|romp-ibm:BSD:*)            # covers RT/PC BSD and
 	echo romp-ibm-bsd${UNAME_RELEASE}   # 4.3 with uname added to
-	exit 0 ;;                           # report: romp-ibm BSD 4.3
+	exit ;;                             # report: romp-ibm BSD 4.3
     *:BOSX:*:*)
 	echo rs6000-bull-bosx
-	exit 0 ;;
+	exit ;;
     DPX/2?00:B.O.S.:*:*)
 	echo m68k-bull-sysv3
-	exit 0 ;;
+	exit ;;
     9000/[34]??:4.3bsd:1.*:*)
 	echo m68k-hp-bsd
-	exit 0 ;;
+	exit ;;
     hp300:4.4BSD:*:* | 9000/[34]??:4.3bsd:2.*:*)
 	echo m68k-hp-bsd4.4
-	exit 0 ;;
+	exit ;;
     9000/[34678]??:HP-UX:*:*)
 	HPUX_REV=`echo ${UNAME_RELEASE}|sed -e 's/[^.]*.[0B]*//'`
 	case "${UNAME_MACHINE}" in
@@ -657,9 +628,19 @@
 	esac
 	if [ ${HP_ARCH} = "hppa2.0w" ]
 	then
-	    # avoid double evaluation of $set_cc_for_build
-	    test -n "$CC_FOR_BUILD" || eval $set_cc_for_build
-	    if echo __LP64__ | (CCOPTS= $CC_FOR_BUILD -E -) | grep __LP64__ >/dev/null
+	    eval $set_cc_for_build
+
+	    # hppa2.0w-hp-hpux* has a 64-bit kernel and a compiler generating
+	    # 32-bit code.  hppa64-hp-hpux* has the same kernel and a compiler
+	    # generating 64-bit code.  GNU and HP use different nomenclature:
+	    #
+	    # $ CC_FOR_BUILD=cc ./config.guess
+	    # => hppa2.0w-hp-hpux11.23
+	    # $ CC_FOR_BUILD="cc +DA2.0w" ./config.guess
+	    # => hppa64-hp-hpux11.23
+
+	    if echo __LP64__ | (CCOPTS= $CC_FOR_BUILD -E - 2>/dev/null) |
+		grep __LP64__ >/dev/null
 	    then
 		HP_ARCH="hppa2.0w"
 	    else
@@ -667,11 +648,11 @@
 	    fi
 	fi
 	echo ${HP_ARCH}-hp-hpux${HPUX_REV}
-	exit 0 ;;
+	exit ;;
     ia64:HP-UX:*:*)
 	HPUX_REV=`echo ${UNAME_RELEASE}|sed -e 's/[^.]*.[0B]*//'`
 	echo ia64-hp-hpux${HPUX_REV}
-	exit 0 ;;
+	exit ;;
     3050*:HI-UX:*:*)
 	eval $set_cc_for_build
 	sed 's/^	//' << EOF >$dummy.c
@@ -699,166 +680,192 @@
 	  exit (0);
 	}
 EOF
-	$CC_FOR_BUILD -o $dummy $dummy.c && $dummy && exit 0
+	$CC_FOR_BUILD -o $dummy $dummy.c && SYSTEM_NAME=`$dummy` &&
+		{ echo "$SYSTEM_NAME"; exit; }
 	echo unknown-hitachi-hiuxwe2
-	exit 0 ;;
+	exit ;;
     9000/7??:4.3bsd:*:* | 9000/8?[79]:4.3bsd:*:* )
 	echo hppa1.1-hp-bsd
-	exit 0 ;;
+	exit ;;
     9000/8??:4.3bsd:*:*)
 	echo hppa1.0-hp-bsd
-	exit 0 ;;
+	exit ;;
     *9??*:MPE/iX:*:* | *3000*:MPE/iX:*:*)
 	echo hppa1.0-hp-mpeix
-	exit 0 ;;
+	exit ;;
     hp7??:OSF1:*:* | hp8?[79]:OSF1:*:* )
 	echo hppa1.1-hp-osf
-	exit 0 ;;
+	exit ;;
     hp8??:OSF1:*:*)
 	echo hppa1.0-hp-osf
-	exit 0 ;;
+	exit ;;
     i*86:OSF1:*:*)
 	if [ -x /usr/sbin/sysversion ] ; then
 	    echo ${UNAME_MACHINE}-unknown-osf1mk
 	else
 	    echo ${UNAME_MACHINE}-unknown-osf1
 	fi
-	exit 0 ;;
+	exit ;;
     parisc*:Lites*:*:*)
 	echo hppa1.1-hp-lites
-	exit 0 ;;
+	exit ;;
     C1*:ConvexOS:*:* | convex:ConvexOS:C1*:*)
 	echo c1-convex-bsd
-        exit 0 ;;
+        exit ;;
     C2*:ConvexOS:*:* | convex:ConvexOS:C2*:*)
 	if getsysinfo -f scalar_acc
 	then echo c32-convex-bsd
 	else echo c2-convex-bsd
 	fi
-        exit 0 ;;
+        exit ;;
     C34*:ConvexOS:*:* | convex:ConvexOS:C34*:*)
 	echo c34-convex-bsd
-        exit 0 ;;
+        exit ;;
     C38*:ConvexOS:*:* | convex:ConvexOS:C38*:*)
 	echo c38-convex-bsd
-        exit 0 ;;
+        exit ;;
     C4*:ConvexOS:*:* | convex:ConvexOS:C4*:*)
 	echo c4-convex-bsd
-        exit 0 ;;
+        exit ;;
     CRAY*Y-MP:*:*:*)
 	echo ymp-cray-unicos${UNAME_RELEASE} | sed -e 's/\.[^.]*$/.X/'
-	exit 0 ;;
+	exit ;;
     CRAY*[A-Z]90:*:*:*)
 	echo ${UNAME_MACHINE}-cray-unicos${UNAME_RELEASE} \
 	| sed -e 's/CRAY.*\([A-Z]90\)/\1/' \
 	      -e y/ABCDEFGHIJKLMNOPQRSTUVWXYZ/abcdefghijklmnopqrstuvwxyz/ \
 	      -e 's/\.[^.]*$/.X/'
-	exit 0 ;;
+	exit ;;
     CRAY*TS:*:*:*)
 	echo t90-cray-unicos${UNAME_RELEASE} | sed -e 's/\.[^.]*$/.X/'
-	exit 0 ;;
+	exit ;;
     CRAY*T3E:*:*:*)
 	echo alphaev5-cray-unicosmk${UNAME_RELEASE} | sed -e 's/\.[^.]*$/.X/'
-	exit 0 ;;
+	exit ;;
     CRAY*SV1:*:*:*)
 	echo sv1-cray-unicos${UNAME_RELEASE} | sed -e 's/\.[^.]*$/.X/'
-	exit 0 ;;
+	exit ;;
     *:UNICOS/mp:*:*)
-	echo nv1-cray-unicosmp${UNAME_RELEASE} | sed -e 's/\.[^.]*$/.X/'
-	exit 0 ;;
+	echo craynv-cray-unicosmp${UNAME_RELEASE} | sed -e 's/\.[^.]*$/.X/'
+	exit ;;
     F30[01]:UNIX_System_V:*:* | F700:UNIX_System_V:*:*)
 	FUJITSU_PROC=`uname -m | tr 'ABCDEFGHIJKLMNOPQRSTUVWXYZ' 'abcdefghijklmnopqrstuvwxyz'`
         FUJITSU_SYS=`uname -p | tr 'ABCDEFGHIJKLMNOPQRSTUVWXYZ' 'abcdefghijklmnopqrstuvwxyz' | sed -e 's/\///'`
         FUJITSU_REL=`echo ${UNAME_RELEASE} | sed -e 's/ /_/'`
         echo "${FUJITSU_PROC}-fujitsu-${FUJITSU_SYS}${FUJITSU_REL}"
-        exit 0 ;;
+        exit ;;
     5000:UNIX_System_V:4.*:*)
         FUJITSU_SYS=`uname -p | tr 'ABCDEFGHIJKLMNOPQRSTUVWXYZ' 'abcdefghijklmnopqrstuvwxyz' | sed -e 's/\///'`
         FUJITSU_REL=`echo ${UNAME_RELEASE} | tr 'ABCDEFGHIJKLMNOPQRSTUVWXYZ' 'abcdefghijklmnopqrstuvwxyz' | sed -e 's/ /_/'`
         echo "sparc-fujitsu-${FUJITSU_SYS}${FUJITSU_REL}"
-	exit 0 ;;
+	exit ;;
     i*86:BSD/386:*:* | i*86:BSD/OS:*:* | *:Ascend\ Embedded/OS:*:*)
 	echo ${UNAME_MACHINE}-pc-bsdi${UNAME_RELEASE}
-	exit 0 ;;
+	exit ;;
     sparc*:BSD/OS:*:*)
 	echo sparc-unknown-bsdi${UNAME_RELEASE}
-	exit 0 ;;
+	exit ;;
     *:BSD/OS:*:*)
 	echo ${UNAME_MACHINE}-unknown-bsdi${UNAME_RELEASE}
-	exit 0 ;;
+	exit ;;
     *:FreeBSD:*:*)
-	# Determine whether the default compiler uses glibc.
-	eval $set_cc_for_build
-	sed 's/^	//' << EOF >$dummy.c
-	#include <features.h>
-	#if __GLIBC__ >= 2
-	LIBC=gnu
-	#else
-	LIBC=
-	#endif
-EOF
-	eval `$CC_FOR_BUILD -E $dummy.c 2>/dev/null | grep ^LIBC=`
-	# GNU/KFreeBSD systems have a "k" prefix to indicate we are using
-	# FreeBSD's kernel, but not the complete OS.
-	case ${LIBC} in gnu) kernel_only='k' ;; esac
-	echo ${UNAME_MACHINE}-unknown-${kernel_only}freebsd`echo ${UNAME_RELEASE}|sed -e 's/[-(].*//'`${LIBC:+-$LIBC}
-	exit 0 ;;
+	case ${UNAME_MACHINE} in
+	    pc98)
+		echo i386-unknown-freebsd`echo ${UNAME_RELEASE}|sed -e 's/[-(].*//'` ;;
+	    amd64)
+		echo x86_64-unknown-freebsd`echo ${UNAME_RELEASE}|sed -e 's/[-(].*//'` ;;
+	    *)
+		echo ${UNAME_MACHINE}-unknown-freebsd`echo ${UNAME_RELEASE}|sed -e 's/[-(].*//'` ;;
+	esac
+	exit ;;
     i*:CYGWIN*:*)
 	echo ${UNAME_MACHINE}-pc-cygwin
-	exit 0 ;;
-    i*:MINGW*:*)
+	exit ;;
+    *:MINGW*:*)
 	echo ${UNAME_MACHINE}-pc-mingw32
-	exit 0 ;;
+	exit ;;
+    i*:windows32*:*)
+    	# uname -m includes "-pc" on this system.
+    	echo ${UNAME_MACHINE}-mingw32
+	exit ;;
     i*:PW*:*)
 	echo ${UNAME_MACHINE}-pc-pw32
-	exit 0 ;;
-    x86:Interix*:[34]*)
-	echo i586-pc-interix${UNAME_RELEASE}|sed -e 's/\..*//'
-	exit 0 ;;
+	exit ;;
+    *:Interix*:[3456]*)
+    	case ${UNAME_MACHINE} in
+	    x86)
+		echo i586-pc-interix${UNAME_RELEASE}
+		exit ;;
+	    EM64T | authenticamd)
+		echo x86_64-unknown-interix${UNAME_RELEASE}
+		exit ;;
+	    IA64)
+		echo ia64-unknown-interix${UNAME_RELEASE}
+		exit ;;
+	esac ;;
     [345]86:Windows_95:* | [345]86:Windows_98:* | [345]86:Windows_NT:*)
 	echo i${UNAME_MACHINE}-pc-mks
-	exit 0 ;;
+	exit ;;
     i*:Windows_NT*:* | Pentium*:Windows_NT*:*)
 	# How do we know it's Interix rather than the generic POSIX subsystem?
 	# It also conflicts with pre-2.0 versions of AT&T UWIN. Should we
 	# UNAME_MACHINE based on the output of uname instead of i386?
 	echo i586-pc-interix
-	exit 0 ;;
+	exit ;;
     i*:UWIN*:*)
 	echo ${UNAME_MACHINE}-pc-uwin
-	exit 0 ;;
+	exit ;;
+    amd64:CYGWIN*:*:* | x86_64:CYGWIN*:*:*)
+	echo x86_64-unknown-cygwin
+	exit ;;
     p*:CYGWIN*:*)
 	echo powerpcle-unknown-cygwin
-	exit 0 ;;
+	exit ;;
     prep*:SunOS:5.*:*)
 	echo powerpcle-unknown-solaris2`echo ${UNAME_RELEASE}|sed -e 's/[^.]*//'`
-	exit 0 ;;
+	exit ;;
     *:GNU:*:*)
 	# the GNU system
 	echo `echo ${UNAME_MACHINE}|sed -e 's,[-/].*$,,'`-unknown-gnu`echo ${UNAME_RELEASE}|sed -e 's,/.*$,,'`
-	exit 0 ;;
+	exit ;;
     *:GNU/*:*:*)
 	# other systems with GNU libc and userland
 	echo ${UNAME_MACHINE}-unknown-`echo ${UNAME_SYSTEM} | sed 's,^[^/]*/,,' | tr '[A-Z]' '[a-z]'``echo ${UNAME_RELEASE}|sed -e 's/[-(].*//'`-gnu
-	exit 0 ;;
+	exit ;;
     i*86:Minix:*:*)
 	echo ${UNAME_MACHINE}-pc-minix
-	exit 0 ;;
+	exit ;;
     arm*:Linux:*:*)
+	eval $set_cc_for_build
+	if echo __ARM_EABI__ | $CC_FOR_BUILD -E - 2>/dev/null \
+	    | grep -q __ARM_EABI__
+	then
+	    echo ${UNAME_MACHINE}-unknown-linux-gnu
+	else
+	    echo ${UNAME_MACHINE}-unknown-linux-gnueabi
+	fi
+	exit ;;
+    avr32*:Linux:*:*)
 	echo ${UNAME_MACHINE}-unknown-linux-gnu
-	exit 0 ;;
+	exit ;;
     cris:Linux:*:*)
 	echo cris-axis-linux-gnu
-	exit 0 ;;
+	exit ;;
+    crisv32:Linux:*:*)
+	echo crisv32-axis-linux-gnu
+	exit ;;
+    frv:Linux:*:*)
+    	echo frv-unknown-linux-gnu
+	exit ;;
     ia64:Linux:*:*)
 	echo ${UNAME_MACHINE}-unknown-linux-gnu
-	exit 0 ;;
+	exit ;;
     m32r*:Linux:*:*)
 	echo ${UNAME_MACHINE}-unknown-linux-gnu
-	exit 0 ;;
+	exit ;;
     m68*:Linux:*:*)
 	echo ${UNAME_MACHINE}-unknown-linux-gnu
-	exit 0 ;;
+	exit ;;
     mips:Linux:*:*)
 	eval $set_cc_for_build
 	sed 's/^	//' << EOF >$dummy.c
@@ -875,8 +882,12 @@
 	#endif
 	#endif
 EOF
-	eval `$CC_FOR_BUILD -E $dummy.c 2>/dev/null | grep ^CPU=`
-	test x"${CPU}" != x && echo "${CPU}-unknown-linux-gnu" && exit 0
+	eval "`$CC_FOR_BUILD -E $dummy.c 2>/dev/null | sed -n '
+	    /^CPU/{
+		s: ::g
+		p
+	    }'`"
+	test x"${CPU}" != x && { echo "${CPU}-unknown-linux-gnu"; exit; }
 	;;
     mips64:Linux:*:*)
 	eval $set_cc_for_build
@@ -894,15 +905,22 @@
 	#endif
 	#endif
 EOF
-	eval `$CC_FOR_BUILD -E $dummy.c 2>/dev/null | grep ^CPU=`
-	test x"${CPU}" != x && echo "${CPU}-unknown-linux-gnu" && exit 0
+	eval "`$CC_FOR_BUILD -E $dummy.c 2>/dev/null | sed -n '
+	    /^CPU/{
+		s: ::g
+		p
+	    }'`"
+	test x"${CPU}" != x && { echo "${CPU}-unknown-linux-gnu"; exit; }
 	;;
+    or32:Linux:*:*)
+	echo or32-unknown-linux-gnu
+	exit ;;
     ppc:Linux:*:*)
 	echo powerpc-unknown-linux-gnu
-	exit 0 ;;
+	exit ;;
     ppc64:Linux:*:*)
 	echo powerpc64-unknown-linux-gnu
-	exit 0 ;;
+	exit ;;
     alpha:Linux:*:*)
 	case `sed -n '/^cpu model/s/^.*: \(.*\)/\1/p' < /proc/cpuinfo` in
 	  EV5)   UNAME_MACHINE=alphaev5 ;;
@@ -916,7 +934,7 @@
 	objdump --private-headers /bin/sh | grep ld.so.1 >/dev/null
 	if test "$?" = 0 ; then LIBC="libc1" ; else LIBC="" ; fi
 	echo ${UNAME_MACHINE}-unknown-linux-gnu${LIBC}
-	exit 0 ;;
+	exit ;;
     parisc:Linux:*:* | hppa:Linux:*:*)
 	# Look for CPU level
 	case `grep '^cpu[^a-z]*:' /proc/cpuinfo 2>/dev/null | cut -d' ' -f2` in
@@ -924,25 +942,31 @@
 	  PA8*) echo hppa2.0-unknown-linux-gnu ;;
 	  *)    echo hppa-unknown-linux-gnu ;;
 	esac
-	exit 0 ;;
+	exit ;;
     parisc64:Linux:*:* | hppa64:Linux:*:*)
 	echo hppa64-unknown-linux-gnu
-	exit 0 ;;
+	exit ;;
     s390:Linux:*:* | s390x:Linux:*:*)
 	echo ${UNAME_MACHINE}-ibm-linux
-	exit 0 ;;
+	exit ;;
     sh64*:Linux:*:*)
     	echo ${UNAME_MACHINE}-unknown-linux-gnu
-	exit 0 ;;
+	exit ;;
     sh*:Linux:*:*)
 	echo ${UNAME_MACHINE}-unknown-linux-gnu
-	exit 0 ;;
+	exit ;;
     sparc:Linux:*:* | sparc64:Linux:*:*)
 	echo ${UNAME_MACHINE}-unknown-linux-gnu
-	exit 0 ;;
+	exit ;;
+    vax:Linux:*:*)
+	echo ${UNAME_MACHINE}-dec-linux-gnu
+	exit ;;
     x86_64:Linux:*:*)
 	echo x86_64-unknown-linux-gnu
-	exit 0 ;;
+	exit ;;
+    xtensa*:Linux:*:*)
+    	echo ${UNAME_MACHINE}-unknown-linux-gnu
+	exit ;;
     i*86:Linux:*:*)
 	# The BFD linker knows what the default object file format is, so
 	# first see if it will tell us. cd to the root directory to prevent
@@ -960,15 +984,15 @@
 		;;
 	  a.out-i386-linux)
 		echo "${UNAME_MACHINE}-pc-linux-gnuaout"
-		exit 0 ;;
+		exit ;;
 	  coff-i386)
 		echo "${UNAME_MACHINE}-pc-linux-gnucoff"
-		exit 0 ;;
+		exit ;;
 	  "")
 		# Either a pre-BFD a.out linker (linux-gnuoldld) or
 		# one that does not give us useful --help.
 		echo "${UNAME_MACHINE}-pc-linux-gnuoldld"
-		exit 0 ;;
+		exit ;;
 	esac
 	# Determine whether the default compiler is a.out or elf
 	eval $set_cc_for_build
@@ -985,7 +1009,7 @@
 	LIBC=gnulibc1
 	# endif
 	#else
-	#ifdef __INTEL_COMPILER
+	#if defined(__INTEL_COMPILER) || defined(__PGI) || defined(__SUNPRO_C) || defined(__SUNPRO_CC)
 	LIBC=gnu
 	#else
 	LIBC=gnuaout
@@ -995,16 +1019,23 @@
 	LIBC=dietlibc
 	#endif
 EOF
-	eval `$CC_FOR_BUILD -E $dummy.c 2>/dev/null | grep ^LIBC=`
-	test x"${LIBC}" != x && echo "${UNAME_MACHINE}-pc-linux-${LIBC}" && exit 0
-	test x"${TENTATIVE}" != x && echo "${TENTATIVE}" && exit 0
+	eval "`$CC_FOR_BUILD -E $dummy.c 2>/dev/null | sed -n '
+	    /^LIBC/{
+		s: ::g
+		p
+	    }'`"
+	test x"${LIBC}" != x && {
+		echo "${UNAME_MACHINE}-pc-linux-${LIBC}"
+		exit
+	}
+	test x"${TENTATIVE}" != x && { echo "${TENTATIVE}"; exit; }
 	;;
     i*86:DYNIX/ptx:4*:*)
 	# ptx 4.0 does uname -s correctly, with DYNIX/ptx in there.
 	# earlier versions are messed up and put the nodename in both
 	# sysname and nodename.
 	echo i386-sequent-sysv4
-	exit 0 ;;
+	exit ;;
     i*86:UNIX_SV:4.2MP:2.*)
         # Unixware is an offshoot of SVR4, but it has its own version
         # number series starting with 2...
@@ -1012,27 +1043,27 @@
 	# I just have to hope.  -- rms.
         # Use sysv4.2uw... so that sysv4* matches it.
 	echo ${UNAME_MACHINE}-pc-sysv4.2uw${UNAME_VERSION}
-	exit 0 ;;
+	exit ;;
     i*86:OS/2:*:*)
 	# If we were able to find `uname', then EMX Unix compatibility
 	# is probably installed.
 	echo ${UNAME_MACHINE}-pc-os2-emx
-	exit 0 ;;
+	exit ;;
     i*86:XTS-300:*:STOP)
 	echo ${UNAME_MACHINE}-unknown-stop
-	exit 0 ;;
+	exit ;;
     i*86:atheos:*:*)
 	echo ${UNAME_MACHINE}-unknown-atheos
-	exit 0 ;;
-	i*86:syllable:*:*)
+	exit ;;
+    i*86:syllable:*:*)
 	echo ${UNAME_MACHINE}-pc-syllable
-	exit 0 ;;
+	exit ;;
     i*86:LynxOS:2.*:* | i*86:LynxOS:3.[01]*:* | i*86:LynxOS:4.0*:*)
 	echo i386-unknown-lynxos${UNAME_RELEASE}
-	exit 0 ;;
+	exit ;;
     i*86:*DOS:*:*)
 	echo ${UNAME_MACHINE}-pc-msdosdjgpp
-	exit 0 ;;
+	exit ;;
     i*86:*:4.*:* | i*86:SYSTEM_V:4.*:*)
 	UNAME_REL=`echo ${UNAME_RELEASE} | sed 's/\/MP$//'`
 	if grep Novell /usr/include/link.h >/dev/null 2>/dev/null; then
@@ -1040,15 +1071,16 @@
 	else
 		echo ${UNAME_MACHINE}-pc-sysv${UNAME_REL}
 	fi
-	exit 0 ;;
-    i*86:*:5:[78]*)
+	exit ;;
+    i*86:*:5:[678]*)
+    	# UnixWare 7.x, OpenUNIX and OpenServer 6.
 	case `/bin/uname -X | grep "^Machine"` in
 	    *486*)	     UNAME_MACHINE=i486 ;;
 	    *Pentium)	     UNAME_MACHINE=i586 ;;
 	    *Pent*|*Celeron) UNAME_MACHINE=i686 ;;
 	esac
 	echo ${UNAME_MACHINE}-unknown-sysv${UNAME_RELEASE}${UNAME_SYSTEM}${UNAME_VERSION}
-	exit 0 ;;
+	exit ;;
     i*86:*:3.2:*)
 	if test -f /usr/options/cb.name; then
 		UNAME_REL=`sed -n 's/.*Version //p' </usr/options/cb.name`
@@ -1066,73 +1098,73 @@
 	else
 		echo ${UNAME_MACHINE}-pc-sysv32
 	fi
-	exit 0 ;;
+	exit ;;
     pc:*:*:*)
 	# Left here for compatibility:
         # uname -m prints for DJGPP always 'pc', but it prints nothing about
         # the processor, so we play safe by assuming i386.
 	echo i386-pc-msdosdjgpp
-        exit 0 ;;
+        exit ;;
     Intel:Mach:3*:*)
 	echo i386-pc-mach3
-	exit 0 ;;
+	exit ;;
     paragon:*:*:*)
 	echo i860-intel-osf1
-	exit 0 ;;
+	exit ;;
     i860:*:4.*:*) # i860-SVR4
 	if grep Stardent /usr/include/sys/uadmin.h >/dev/null 2>&1 ; then
 	  echo i860-stardent-sysv${UNAME_RELEASE} # Stardent Vistra i860-SVR4
 	else # Add other i860-SVR4 vendors below as they are discovered.
 	  echo i860-unknown-sysv${UNAME_RELEASE}  # Unknown i860-SVR4
 	fi
-	exit 0 ;;
+	exit ;;
     mini*:CTIX:SYS*5:*)
 	# "miniframe"
 	echo m68010-convergent-sysv
-	exit 0 ;;
+	exit ;;
     mc68k:UNIX:SYSTEM5:3.51m)
 	echo m68k-convergent-sysv
-	exit 0 ;;
+	exit ;;
     M680?0:D-NIX:5.3:*)
 	echo m68k-diab-dnix
-	exit 0 ;;
-    M68*:*:R3V[567]*:*)
-	test -r /sysV68 && echo 'm68k-motorola-sysv' && exit 0 ;;
-    3[345]??:*:4.0:3.0 | 3[34]??A:*:4.0:3.0 | 3[34]??,*:*:4.0:3.0 | 3[34]??/*:*:4.0:3.0 | 4400:*:4.0:3.0 | 4850:*:4.0:3.0 | SKA40:*:4.0:3.0 | SDS2:*:4.0:3.0 | SHG2:*:4.0:3.0)
+	exit ;;
+    M68*:*:R3V[5678]*:*)
+	test -r /sysV68 && { echo 'm68k-motorola-sysv'; exit; } ;;
+    3[345]??:*:4.0:3.0 | 3[34]??A:*:4.0:3.0 | 3[34]??,*:*:4.0:3.0 | 3[34]??/*:*:4.0:3.0 | 4400:*:4.0:3.0 | 4850:*:4.0:3.0 | SKA40:*:4.0:3.0 | SDS2:*:4.0:3.0 | SHG2:*:4.0:3.0 | S7501*:*:4.0:3.0)
 	OS_REL=''
 	test -r /etc/.relid \
 	&& OS_REL=.`sed -n 's/[^ ]* [^ ]* \([0-9][0-9]\).*/\1/p' < /etc/.relid`
 	/bin/uname -p 2>/dev/null | grep 86 >/dev/null \
-	  && echo i486-ncr-sysv4.3${OS_REL} && exit 0
+	  && { echo i486-ncr-sysv4.3${OS_REL}; exit; }
 	/bin/uname -p 2>/dev/null | /bin/grep entium >/dev/null \
-	  && echo i586-ncr-sysv4.3${OS_REL} && exit 0 ;;
+	  && { echo i586-ncr-sysv4.3${OS_REL}; exit; } ;;
     3[34]??:*:4.0:* | 3[34]??,*:*:4.0:*)
         /bin/uname -p 2>/dev/null | grep 86 >/dev/null \
-          && echo i486-ncr-sysv4 && exit 0 ;;
+          && { echo i486-ncr-sysv4; exit; } ;;
     m68*:LynxOS:2.*:* | m68*:LynxOS:3.0*:*)
 	echo m68k-unknown-lynxos${UNAME_RELEASE}
-	exit 0 ;;
+	exit ;;
     mc68030:UNIX_System_V:4.*:*)
 	echo m68k-atari-sysv4
-	exit 0 ;;
+	exit ;;
     TSUNAMI:LynxOS:2.*:*)
 	echo sparc-unknown-lynxos${UNAME_RELEASE}
-	exit 0 ;;
+	exit ;;
     rs6000:LynxOS:2.*:*)
 	echo rs6000-unknown-lynxos${UNAME_RELEASE}
-	exit 0 ;;
+	exit ;;
     PowerPC:LynxOS:2.*:* | PowerPC:LynxOS:3.[01]*:* | PowerPC:LynxOS:4.0*:*)
 	echo powerpc-unknown-lynxos${UNAME_RELEASE}
-	exit 0 ;;
+	exit ;;
     SM[BE]S:UNIX_SV:*:*)
 	echo mips-dde-sysv${UNAME_RELEASE}
-	exit 0 ;;
+	exit ;;
     RM*:ReliantUNIX-*:*:*)
 	echo mips-sni-sysv4
-	exit 0 ;;
+	exit ;;
     RM*:SINIX-*:*:*)
 	echo mips-sni-sysv4
-	exit 0 ;;
+	exit ;;
     *:SINIX-*:*:*)
 	if uname -p 2>/dev/null >/dev/null ; then
 		UNAME_MACHINE=`(uname -p) 2>/dev/null`
@@ -1140,68 +1172,81 @@
 	else
 		echo ns32k-sni-sysv
 	fi
-	exit 0 ;;
+	exit ;;
     PENTIUM:*:4.0*:*) # Unisys `ClearPath HMP IX 4000' SVR4/MP effort
                       # says <Richard.M.Bartel@ccMail.Census.GOV>
         echo i586-unisys-sysv4
-        exit 0 ;;
+        exit ;;
     *:UNIX_System_V:4*:FTX*)
 	# From Gerald Hewes <hewes@openmarket.com>.
 	# How about differentiating between stratus architectures? -djm
 	echo hppa1.1-stratus-sysv4
-	exit 0 ;;
+	exit ;;
     *:*:*:FTX*)
 	# From seanf@swdc.stratus.com.
 	echo i860-stratus-sysv4
-	exit 0 ;;
+	exit ;;
+    i*86:VOS:*:*)
+	# From Paul.Green@stratus.com.
+	echo ${UNAME_MACHINE}-stratus-vos
+	exit ;;
     *:VOS:*:*)
 	# From Paul.Green@stratus.com.
 	echo hppa1.1-stratus-vos
-	exit 0 ;;
+	exit ;;
     mc68*:A/UX:*:*)
 	echo m68k-apple-aux${UNAME_RELEASE}
-	exit 0 ;;
+	exit ;;
     news*:NEWS-OS:6*:*)
 	echo mips-sony-newsos6
-	exit 0 ;;
+	exit ;;
     R[34]000:*System_V*:*:* | R4000:UNIX_SYSV:*:* | R*000:UNIX_SV:*:*)
 	if [ -d /usr/nec ]; then
 	        echo mips-nec-sysv${UNAME_RELEASE}
 	else
 	        echo mips-unknown-sysv${UNAME_RELEASE}
 	fi
-        exit 0 ;;
+        exit ;;
     BeBox:BeOS:*:*)	# BeOS running on hardware made by Be, PPC only.
 	echo powerpc-be-beos
-	exit 0 ;;
+	exit ;;
     BeMac:BeOS:*:*)	# BeOS running on Mac or Mac clone, PPC only.
 	echo powerpc-apple-beos
-	exit 0 ;;
+	exit ;;
     BePC:BeOS:*:*)	# BeOS running on Intel PC compatible.
 	echo i586-pc-beos
-	exit 0 ;;
+	exit ;;
     SX-4:SUPER-UX:*:*)
 	echo sx4-nec-superux${UNAME_RELEASE}
-	exit 0 ;;
+	exit ;;
     SX-5:SUPER-UX:*:*)
 	echo sx5-nec-superux${UNAME_RELEASE}
-	exit 0 ;;
+	exit ;;
     SX-6:SUPER-UX:*:*)
 	echo sx6-nec-superux${UNAME_RELEASE}
-	exit 0 ;;
+	exit ;;
+    SX-7:SUPER-UX:*:*)
+	echo sx7-nec-superux${UNAME_RELEASE}
+	exit ;;
+    SX-8:SUPER-UX:*:*)
+	echo sx8-nec-superux${UNAME_RELEASE}
+	exit ;;
+    SX-8R:SUPER-UX:*:*)
+	echo sx8r-nec-superux${UNAME_RELEASE}
+	exit ;;
     Power*:Rhapsody:*:*)
 	echo powerpc-apple-rhapsody${UNAME_RELEASE}
-	exit 0 ;;
+	exit ;;
     *:Rhapsody:*:*)
 	echo ${UNAME_MACHINE}-apple-rhapsody${UNAME_RELEASE}
-	exit 0 ;;
+	exit ;;
     *:Darwin:*:*)
-	case `uname -p` in
-	    *86) UNAME_PROCESSOR=i686 ;;
-	    powerpc) UNAME_PROCESSOR=powerpc ;;
+	UNAME_PROCESSOR=`uname -p` || UNAME_PROCESSOR=unknown
+	case $UNAME_PROCESSOR in
+	    unknown) UNAME_PROCESSOR=powerpc ;;
 	esac
 	echo ${UNAME_PROCESSOR}-apple-darwin${UNAME_RELEASE}
-	exit 0 ;;
+	exit ;;
     *:procnto*:*:* | *:QNX:[0123456789]*:*)
 	UNAME_PROCESSOR=`uname -p`
 	if test "$UNAME_PROCESSOR" = "x86"; then
@@ -1209,22 +1254,25 @@
 		UNAME_MACHINE=pc
 	fi
 	echo ${UNAME_PROCESSOR}-${UNAME_MACHINE}-nto-qnx${UNAME_RELEASE}
-	exit 0 ;;
+	exit ;;
     *:QNX:*:4*)
 	echo i386-pc-qnx
-	exit 0 ;;
+	exit ;;
+    NSE-?:NONSTOP_KERNEL:*:*)
+	echo nse-tandem-nsk${UNAME_RELEASE}
+	exit ;;
     NSR-?:NONSTOP_KERNEL:*:*)
 	echo nsr-tandem-nsk${UNAME_RELEASE}
-	exit 0 ;;
+	exit ;;
     *:NonStop-UX:*:*)
 	echo mips-compaq-nonstopux
-	exit 0 ;;
+	exit ;;
     BS2000:POSIX*:*:*)
 	echo bs2000-siemens-sysv
-	exit 0 ;;
+	exit ;;
     DS/*:UNIX_System_V:*:*)
 	echo ${UNAME_MACHINE}-${UNAME_SYSTEM}-${UNAME_RELEASE}
-	exit 0 ;;
+	exit ;;
     *:Plan9:*:*)
 	# "uname -m" is not consistent, so use $cputype instead. 386
 	# is converted to i386 for consistency with other x86
@@ -1235,31 +1283,47 @@
 	    UNAME_MACHINE="$cputype"
 	fi
 	echo ${UNAME_MACHINE}-unknown-plan9
-	exit 0 ;;
+	exit ;;
     *:TOPS-10:*:*)
 	echo pdp10-unknown-tops10
-	exit 0 ;;
+	exit ;;
     *:TENEX:*:*)
 	echo pdp10-unknown-tenex
-	exit 0 ;;
+	exit ;;
     KS10:TOPS-20:*:* | KL10:TOPS-20:*:* | TYPE4:TOPS-20:*:*)
 	echo pdp10-dec-tops20
-	exit 0 ;;
+	exit ;;
     XKL-1:TOPS-20:*:* | TYPE5:TOPS-20:*:*)
 	echo pdp10-xkl-tops20
-	exit 0 ;;
+	exit ;;
     *:TOPS-20:*:*)
 	echo pdp10-unknown-tops20
-	exit 0 ;;
+	exit ;;
     *:ITS:*:*)
 	echo pdp10-unknown-its
-	exit 0 ;;
+	exit ;;
     SEI:*:*:SEIUX)
         echo mips-sei-seiux${UNAME_RELEASE}
-	exit 0 ;;
+	exit ;;
     *:DragonFly:*:*)
 	echo ${UNAME_MACHINE}-unknown-dragonfly`echo ${UNAME_RELEASE}|sed -e 's/[-(].*//'`
-	exit 0 ;;
+	exit ;;
+    *:*VMS:*:*)
+    	UNAME_MACHINE=`(uname -p) 2>/dev/null`
+	case "${UNAME_MACHINE}" in
+	    A*) echo alpha-dec-vms ; exit ;;
+	    I*) echo ia64-dec-vms ; exit ;;
+	    V*) echo vax-dec-vms ; exit ;;
+	esac ;;
+    *:XENIX:*:SysV)
+	echo i386-pc-xenix
+	exit ;;
+    i*86:skyos:*:*)
+	echo ${UNAME_MACHINE}-pc-skyos`echo ${UNAME_RELEASE}` | sed -e 's/ .*$//'
+	exit ;;
+    i*86:rdos:*:*)
+	echo ${UNAME_MACHINE}-pc-rdos
+	exit ;;
 esac
 
 #echo '(No uname command or uname output not recognized.)' 1>&2
@@ -1291,7 +1355,7 @@
 #endif
 
 #if defined (__arm) && defined (__acorn) && defined (__unix)
-  printf ("arm-acorn-riscix"); exit (0);
+  printf ("arm-acorn-riscix\n"); exit (0);
 #endif
 
 #if defined (hp300) && !defined (hpux)
@@ -1380,11 +1444,12 @@
 }
 EOF
 
-$CC_FOR_BUILD -o $dummy $dummy.c 2>/dev/null && $dummy && exit 0
+$CC_FOR_BUILD -o $dummy $dummy.c 2>/dev/null && SYSTEM_NAME=`$dummy` &&
+	{ echo "$SYSTEM_NAME"; exit; }
 
 # Apollos put the system type in the environment.
 
-test -d /usr/apollo && { echo ${ISP}-apollo-${SYSTYPE}; exit 0; }
+test -d /usr/apollo && { echo ${ISP}-apollo-${SYSTYPE}; exit; }
 
 # Convex versions that predate uname can use getsysinfo(1)
 
@@ -1393,22 +1458,22 @@
     case `getsysinfo -f cpu_type` in
     c1*)
 	echo c1-convex-bsd
-	exit 0 ;;
+	exit ;;
     c2*)
 	if getsysinfo -f scalar_acc
 	then echo c32-convex-bsd
 	else echo c2-convex-bsd
 	fi
-	exit 0 ;;
+	exit ;;
     c34*)
 	echo c34-convex-bsd
-	exit 0 ;;
+	exit ;;
     c38*)
 	echo c38-convex-bsd
-	exit 0 ;;
+	exit ;;
     c4*)
 	echo c4-convex-bsd
-	exit 0 ;;
+	exit ;;
     esac
 fi
 
@@ -1419,7 +1484,9 @@
 the operating system you are using. It is advised that you
 download the most up to date version of the config scripts from
 
-    ftp://ftp.gnu.org/pub/gnu/config/
+  http://git.savannah.gnu.org/gitweb/?p=config.git;a=blob_plain;f=config.guess;hb=HEAD
+and
+  http://git.savannah.gnu.org/gitweb/?p=config.git;a=blob_plain;f=config.sub;hb=HEAD
 
 If the version you run ($0) is already up to date, please
 send the following data and any information you think might be
diff -urN lcd4linux-0.10.0/config.h.in lcd4linux-0.11.0-SVN/config.h.in
--- lcd4linux-0.10.0/config.h.in	2005-06-10 13:11:48.000000000 +0200
+++ lcd4linux-0.11.0-SVN/config.h.in	2009-01-13 06:04:42.000000000 +0100
@@ -12,8 +12,8 @@
 /* Define to 1 if you have the <asm/io.h> header file. */
 #undef HAVE_ASM_IO_H
 
-/* Define to 1 if you have the <asm/msr.h> header file. */
-#undef HAVE_ASM_MSR_H
+/* Define to 1 if you have the <asm/types.h> header file. */
+#undef HAVE_ASM_TYPES_H
 
 /* Define to 1 if you have the <dirent.h> header file, and it defines `DIR'.
    */
@@ -31,6 +31,9 @@
 /* Define to 1 if you have the `fork' function. */
 #undef HAVE_FORK
 
+/* Define to 1 if you have the <ftdi.h> header file. */
+#undef HAVE_FTDI_H
+
 /* Define to 1 if you have the <gd/gd.h> header file. */
 #undef HAVE_GD_GD_H
 
@@ -43,6 +46,9 @@
 /* Define to 1 if you have the `gettimeofday' function. */
 #undef HAVE_GETTIMEOFDAY
 
+/* Define if you have the iconv() function and it works. */
+#undef HAVE_ICONV
+
 /* Define to 1 if you have the <inttypes.h> header file. */
 #undef HAVE_INTTYPES_H
 
@@ -52,15 +58,33 @@
 /* Define to 1 if you have the <linux/dvb/frontend.h> header file. */
 #undef HAVE_LINUX_DVB_FRONTEND_H
 
+/* Define to 1 if you have the <linux/errno.h> header file. */
+#undef HAVE_LINUX_ERRNO_H
+
+/* Define to 1 if you have the <linux/hd44780.h> header file. */
+#undef HAVE_LINUX_HD44780_H
+
 /* Define to 1 if you have the <linux/isdn.h> header file. */
 #undef HAVE_LINUX_ISDN_H
 
+/* Define to 1 if you have the <linux/lcd-linux.h> header file. */
+#undef HAVE_LINUX_LCD_LINUX_H
+
 /* Define to 1 if you have the <linux/parport.h> header file. */
 #undef HAVE_LINUX_PARPORT_H
 
 /* Define to 1 if you have the <linux/ppdev.h> header file. */
 #undef HAVE_LINUX_PPDEV_H
 
+/* Define to 1 if you have the <linux/wireless.h> header file. */
+#undef HAVE_LINUX_WIRELESS_H
+
+/* Define to 1 if you have the <luise.h> header file. */
+#undef HAVE_LUISE_H
+
+/* Define to 1 if you have the `memmove' function. */
+#undef HAVE_MEMMOVE
+
 /* Define to 1 if you have the <memory.h> header file. */
 #undef HAVE_MEMORY_H
 
@@ -82,6 +106,9 @@
 /* Define to 1 if you have the <net/if_ppp.h> header file. */
 #undef HAVE_NET_IF_PPP_H
 
+/* Define to 1 if you have the <nmeap.h> header file. */
+#undef HAVE_NMEAP_H
+
 /* Define to 1 if you have the `pow' function. */
 #undef HAVE_POW
 
@@ -91,6 +118,9 @@
 /* Define to 1 if you have the `regcomp' function. */
 #undef HAVE_REGCOMP
 
+/* Define to 1 if you have the `select' function. */
+#undef HAVE_SELECT
+
 /* Define to 1 if you have the <serdisplib/serdisp.h> header file. */
 #undef HAVE_SERDISPLIB_SERDISP_H
 
@@ -100,6 +130,9 @@
 /* Define to 1 if you have the `sqrt' function. */
 #undef HAVE_SQRT
 
+/* Define to 1 if you have the <st2205.h> header file. */
+#undef HAVE_ST2205_H
+
 /* Define to 1 if `stat' has the bug that it succeeds when given the
    zero-length file name argument. */
 #undef HAVE_STAT_EMPTY_STRING_BUG
@@ -116,6 +149,9 @@
 /* Define to 1 if you have the `strchr' function. */
 #undef HAVE_STRCHR
 
+/* Define to 1 if you have the `strcspn' function. */
+#undef HAVE_STRCSPN
+
 /* Define to 1 if you have the `strdup' function. */
 #undef HAVE_STRDUP
 
@@ -149,6 +185,9 @@
 /* Define to 1 if you have the `strtol' function. */
 #undef HAVE_STRTOL
 
+/* Define to 1 if you have the `strtoul' function. */
+#undef HAVE_STRTOUL
+
 /* Define to 1 if you have the <syslog.h> header file. */
 #undef HAVE_SYSLOG_H
 
@@ -166,12 +205,12 @@
    */
 #undef HAVE_SYS_NDIR_H
 
+/* Define to 1 if you have the <sys/select.h> header file. */
+#undef HAVE_SYS_SELECT_H
+
 /* Define to 1 if you have the <sys/socket.h> header file. */
 #undef HAVE_SYS_SOCKET_H
 
-/* Define to 1 if you have the <sys/statfs.h> header file. */
-#undef HAVE_SYS_STATFS_H
-
 /* Define to 1 if you have the <sys/stat.h> header file. */
 #undef HAVE_SYS_STAT_H
 
@@ -214,6 +253,9 @@
 /* Define to 1 if you have the <X11/Xutil.h> header file. */
 #undef HAVE_X11_XUTIL_H
 
+/* Define as const if the declaration of iconv() needs const. */
+#undef ICONV_CONST
+
 /* Define to 1 if `lstat' dereferences a symlink specified with a trailing
    slash. */
 #undef LSTAT_FOLLOWS_SLASHED_SYMLINK
@@ -245,6 +287,12 @@
 /* apm plugin */
 #undef PLUGIN_APM
 
+/* asterisk plugin */
+#undef PLUGIN_ASTERISK
+
+/* button_exec plugin */
+#undef PLUGIN_BUTTON_EXEC
+
 /* cpuinfo plugin */
 #undef PLUGIN_CPUINFO
 
@@ -257,27 +305,51 @@
 /* exec plugin */
 #undef PLUGIN_EXEC
 
+/* fifo plugin */
+#undef PLUGIN_FIFO
+
+/* file plugin */
+#undef PLUGIN_FILE
+
+/* gps plugin */
+#undef PLUGIN_GPS
+
+/* hddtemp plugin */
+#undef PLUGIN_HDDTEMP
+
 /* i2c sensors plugin */
 #undef PLUGIN_I2C_SENSORS
 
+/* iconv charset converter plugin */
+#undef PLUGIN_ICONV
+
 /* imon plugin */
 #undef PLUGIN_IMON
 
 /* ISDN plugin */
 #undef PLUGIN_ISDN
 
+/* kvv plugin */
+#undef PLUGIN_KVV
+
 /* loadavg plugin */
 #undef PLUGIN_LOADAVG
 
 /* meminfo plugin */
 #undef PLUGIN_MEMINFO
 
+/* mpd plugin */
+#undef PLUGIN_MPD
+
 /* mysql plugin */
 #undef PLUGIN_MYSQL
 
 /* netdev plugin */
 #undef PLUGIN_NETDEV
 
+/* netinfo plugin */
+#undef PLUGIN_NETINFO
+
 /* POP3 plugin */
 #undef PLUGIN_POP3
 
@@ -290,6 +362,9 @@
 /* python plugin */
 #undef PLUGIN_PYTHON
 
+/* sample plugin */
+#undef PLUGIN_SAMPLE
+
 /* seti plugin */
 #undef PLUGIN_SETI
 
@@ -302,6 +377,9 @@
 /* uptime plugin */
 #undef PLUGIN_UPTIME
 
+/* w1retap plugin */
+#undef PLUGIN_W1RETAP
+
 /* wireless plugin */
 #undef PLUGIN_WIRELESS
 
@@ -314,6 +392,15 @@
 /* Define if you want to turn on SCO-specific code */
 #undef SCO_FLAVOR
 
+/* Define to the type of arg 1 for `select'. */
+#undef SELECT_TYPE_ARG1
+
+/* Define to the type of args 2, 3 and 4 for `select'. */
+#undef SELECT_TYPE_ARG234
+
+/* Define to the type of arg 5 for `select'. */
+#undef SELECT_TYPE_ARG5
+
 /* Define to 1 if you have the ANSI C header files. */
 #undef STDC_HEADERS
 
@@ -347,21 +434,51 @@
 /* CwLinux driver */
 #undef WITH_CWLINUX
 
+/* D4D driver */
+#undef WITH_D4D
+
 /* Define if using the dmalloc debugging malloc package */
 #undef WITH_DMALLOC
 
+/* Electronic Assembly RS232 graphic driver */
+#undef WITH_EA232graphic
+
+/* G-15 driver */
+#undef WITH_G15
+
+/* GD library */
+#undef WITH_GD
+
 /* HD44780 driver */
 #undef WITH_HD44780
 
 /* I2C bus driver */
 #undef WITH_I2C
 
+/* image widget */
+#undef WITH_IMAGE
+
+/* IRLCD driver */
+#undef WITH_IRLCD
+
+/* LCD2USB driver */
+#undef WITH_LCD2USB
+
 /* LCD-Linux driver */
 #undef WITH_LCDLINUX
 
 /* LCDTerm driver */
 #undef WITH_LCDTERM
 
+/* LEDMatrix driver */
+#undef WITH_LEDMATRIX
+
+/* LPH7508 driver */
+#undef WITH_LPH7508
+
+/* LUIse driver */
+#undef WITH_LUISE
+
 /* M50530 driver */
 #undef WITH_M50530
 
@@ -377,30 +494,63 @@
 /* NULL driver */
 #undef WITH_NULL
 
-/* driver */
+/* parport bus driver */
+#undef WITH_PARPORT
+
+/* Pertelian driver */
+#undef WITH_PERTELIAN
+
+/* PHAnderson driver */
+#undef WITH_PHANDERSON
+
+/* picoLCD driver */
+#undef WITH_PICOLCD
+
+/* picoLCDGraphic driver */
+#undef WITH_PICOLCDGRAPHIC
+
+/* PNG driver */
 #undef WITH_PNG
 
-/* driver */
+/* PPM driver */
 #undef WITH_PPM
 
 /* RouterBoard driver */
 #undef WITH_ROUTERBOARD
 
+/* Sample driver */
+#undef WITH_SAMPLE
+
 /* serdisplib driver */
 #undef WITH_SERDISPLIB
 
+/* serial bus driver */
+#undef WITH_SERIAL
+
 /* SimpleLCD driver */
 #undef WITH_SIMPLELCD
 
+/* st2205 driver */
+#undef WITH_ST2205
+
 /* T6963 driver */
 #undef WITH_T6963
 
 /* TREFON driver */
 #undef WITH_TREFON
 
+/* ULA200 driver */
+#undef WITH_ULA200
+
+/* USBHUB driver */
+#undef WITH_USBHUB
+
 /* USBLCD driver */
 #undef WITH_USBLCD
 
+/* WincorNixdorf driver */
+#undef WITH_WINCORNIXDORF
+
 /* X11 driver */
 #undef WITH_X11
 
@@ -419,15 +569,18 @@
 #undef inline
 #endif
 
-/* Define to `long' if <sys/types.h> does not define. */
+/* Define to `long int' if <sys/types.h> does not define. */
 #undef off_t
 
 /* Define to `int' if <sys/types.h> does not define. */
 #undef pid_t
 
-/* Define to `unsigned' if <sys/types.h> does not define. */
+/* Define to `unsigned int' if <sys/types.h> does not define. */
 #undef size_t
 
+/* Define to `int' if <sys/types.h> does not define. */
+#undef ssize_t
+
 /* Define to `int' if <sys/types.h> doesn't define. */
 #undef uid_t
 
diff -urN lcd4linux-0.10.0/config.rpath lcd4linux-0.11.0-SVN/config.rpath
--- lcd4linux-0.10.0/config.rpath	1970-01-01 01:00:00.000000000 +0100
+++ lcd4linux-0.11.0-SVN/config.rpath	2008-12-31 08:05:54.000000000 +0100
@@ -0,0 +1,666 @@
+#! /bin/sh
+# Output a system dependent set of variables, describing how to set the
+# run time search path of shared libraries in an executable.
+#
+#   Copyright 1996-2007 Free Software Foundation, Inc.
+#   Taken from GNU libtool, 2001
+#   Originally by Gordon Matzigkeit <gord@gnu.ai.mit.edu>, 1996
+#
+#   This file is free software; the Free Software Foundation gives
+#   unlimited permission to copy and/or distribute it, with or without
+#   modifications, as long as this notice is preserved.
+#
+# The first argument passed to this file is the canonical host specification,
+#    CPU_TYPE-MANUFACTURER-OPERATING_SYSTEM
+# or
+#    CPU_TYPE-MANUFACTURER-KERNEL-OPERATING_SYSTEM
+# The environment variables CC, GCC, LDFLAGS, LD, with_gnu_ld
+# should be set by the caller.
+#
+# The set of defined variables is at the end of this script.
+
+# Known limitations:
+# - On IRIX 6.5 with CC="cc", the run time search patch must not be longer
+#   than 256 bytes, otherwise the compiler driver will dump core. The only
+#   known workaround is to choose shorter directory names for the build
+#   directory and/or the installation directory.
+
+# All known linkers require a `.a' archive for static linking (except MSVC,
+# which needs '.lib').
+libext=a
+shrext=.so
+
+host="$1"
+host_cpu=`echo "$host" | sed 's/^\([^-]*\)-\([^-]*\)-\(.*\)$/\1/'`
+host_vendor=`echo "$host" | sed 's/^\([^-]*\)-\([^-]*\)-\(.*\)$/\2/'`
+host_os=`echo "$host" | sed 's/^\([^-]*\)-\([^-]*\)-\(.*\)$/\3/'`
+
+# Code taken from libtool.m4's _LT_CC_BASENAME.
+
+for cc_temp in $CC""; do
+  case $cc_temp in
+    compile | *[\\/]compile | ccache | *[\\/]ccache ) ;;
+    distcc | *[\\/]distcc | purify | *[\\/]purify ) ;;
+    \-*) ;;
+    *) break;;
+  esac
+done
+cc_basename=`echo "$cc_temp" | sed -e 's%^.*/%%'`
+
+# Code taken from libtool.m4's AC_LIBTOOL_PROG_COMPILER_PIC.
+
+wl=
+if test "$GCC" = yes; then
+  wl='-Wl,'
+else
+  case "$host_os" in
+    aix*)
+      wl='-Wl,'
+      ;;
+    darwin*)
+      case $cc_basename in
+        xlc*)
+          wl='-Wl,'
+          ;;
+      esac
+      ;;
+    mingw* | cygwin* | pw32* | os2*)
+      ;;
+    hpux9* | hpux10* | hpux11*)
+      wl='-Wl,'
+      ;;
+    irix5* | irix6* | nonstopux*)
+      wl='-Wl,'
+      ;;
+    newsos6)
+      ;;
+    linux* | k*bsd*-gnu)
+      case $cc_basename in
+        icc* | ecc*)
+          wl='-Wl,'
+          ;;
+        pgcc | pgf77 | pgf90)
+          wl='-Wl,'
+          ;;
+        ccc*)
+          wl='-Wl,'
+          ;;
+        como)
+          wl='-lopt='
+          ;;
+        *)
+          case `$CC -V 2>&1 | sed 5q` in
+            *Sun\ C*)
+              wl='-Wl,'
+              ;;
+          esac
+          ;;
+      esac
+      ;;
+    osf3* | osf4* | osf5*)
+      wl='-Wl,'
+      ;;
+    rdos*)
+      ;;
+    solaris*)
+      wl='-Wl,'
+      ;;
+    sunos4*)
+      wl='-Qoption ld '
+      ;;
+    sysv4 | sysv4.2uw2* | sysv4.3*)
+      wl='-Wl,'
+      ;;
+    sysv4*MP*)
+      ;;
+    sysv5* | unixware* | sco3.2v5* | sco5v6* | OpenUNIX*)
+      wl='-Wl,'
+      ;;
+    unicos*)
+      wl='-Wl,'
+      ;;
+    uts4*)
+      ;;
+  esac
+fi
+
+# Code taken from libtool.m4's AC_LIBTOOL_PROG_LD_SHLIBS.
+
+hardcode_libdir_flag_spec=
+hardcode_libdir_separator=
+hardcode_direct=no
+hardcode_minus_L=no
+
+case "$host_os" in
+  cygwin* | mingw* | pw32*)
+    # FIXME: the MSVC++ port hasn't been tested in a loooong time
+    # When not using gcc, we currently assume that we are using
+    # Microsoft Visual C++.
+    if test "$GCC" != yes; then
+      with_gnu_ld=no
+    fi
+    ;;
+  interix*)
+    # we just hope/assume this is gcc and not c89 (= MSVC++)
+    with_gnu_ld=yes
+    ;;
+  openbsd*)
+    with_gnu_ld=no
+    ;;
+esac
+
+ld_shlibs=yes
+if test "$with_gnu_ld" = yes; then
+  # Set some defaults for GNU ld with shared library support. These
+  # are reset later if shared libraries are not supported. Putting them
+  # here allows them to be overridden if necessary.
+  # Unlike libtool, we use -rpath here, not --rpath, since the documented
+  # option of GNU ld is called -rpath, not --rpath.
+  hardcode_libdir_flag_spec='${wl}-rpath ${wl}$libdir'
+  case "$host_os" in
+    aix3* | aix4* | aix5*)
+      # On AIX/PPC, the GNU linker is very broken
+      if test "$host_cpu" != ia64; then
+        ld_shlibs=no
+      fi
+      ;;
+    amigaos*)
+      hardcode_libdir_flag_spec='-L$libdir'
+      hardcode_minus_L=yes
+      # Samuel A. Falvo II <kc5tja@dolphin.openprojects.net> reports
+      # that the semantics of dynamic libraries on AmigaOS, at least up
+      # to version 4, is to share data among multiple programs linked
+      # with the same dynamic library.  Since this doesn't match the
+      # behavior of shared libraries on other platforms, we cannot use
+      # them.
+      ld_shlibs=no
+      ;;
+    beos*)
+      if $LD --help 2>&1 | grep ': supported targets:.* elf' > /dev/null; then
+        :
+      else
+        ld_shlibs=no
+      fi
+      ;;
+    cygwin* | mingw* | pw32*)
+      # hardcode_libdir_flag_spec is actually meaningless, as there is
+      # no search path for DLLs.
+      hardcode_libdir_flag_spec='-L$libdir'
+      if $LD --help 2>&1 | grep 'auto-import' > /dev/null; then
+        :
+      else
+        ld_shlibs=no
+      fi
+      ;;
+    interix[3-9]*)
+      hardcode_direct=no
+      hardcode_libdir_flag_spec='${wl}-rpath,$libdir'
+      ;;
+    gnu* | linux* | k*bsd*-gnu)
+      if $LD --help 2>&1 | grep ': supported targets:.* elf' > /dev/null; then
+        :
+      else
+        ld_shlibs=no
+      fi
+      ;;
+    netbsd*)
+      ;;
+    solaris*)
+      if $LD -v 2>&1 | grep 'BFD 2\.8' > /dev/null; then
+        ld_shlibs=no
+      elif $LD --help 2>&1 | grep ': supported targets:.* elf' > /dev/null; then
+        :
+      else
+        ld_shlibs=no
+      fi
+      ;;
+    sysv5* | sco3.2v5* | sco5v6* | unixware* | OpenUNIX*)
+      case `$LD -v 2>&1` in
+        *\ [01].* | *\ 2.[0-9].* | *\ 2.1[0-5].*)
+          ld_shlibs=no
+          ;;
+        *)
+          if $LD --help 2>&1 | grep ': supported targets:.* elf' > /dev/null; then
+            hardcode_libdir_flag_spec='`test -z "$SCOABSPATH" && echo ${wl}-rpath,$libdir`'
+          else
+            ld_shlibs=no
+          fi
+          ;;
+      esac
+      ;;
+    sunos4*)
+      hardcode_direct=yes
+      ;;
+    *)
+      if $LD --help 2>&1 | grep ': supported targets:.* elf' > /dev/null; then
+        :
+      else
+        ld_shlibs=no
+      fi
+      ;;
+  esac
+  if test "$ld_shlibs" = no; then
+    hardcode_libdir_flag_spec=
+  fi
+else
+  case "$host_os" in
+    aix3*)
+      # Note: this linker hardcodes the directories in LIBPATH if there
+      # are no directories specified by -L.
+      hardcode_minus_L=yes
+      if test "$GCC" = yes; then
+        # Neither direct hardcoding nor static linking is supported with a
+        # broken collect2.
+        hardcode_direct=unsupported
+      fi
+      ;;
+    aix4* | aix5*)
+      if test "$host_cpu" = ia64; then
+        # On IA64, the linker does run time linking by default, so we don't
+        # have to do anything special.
+        aix_use_runtimelinking=no
+      else
+        aix_use_runtimelinking=no
+        # Test if we are trying to use run time linking or normal
+        # AIX style linking. If -brtl is somewhere in LDFLAGS, we
+        # need to do runtime linking.
+        case $host_os in aix4.[23]|aix4.[23].*|aix5*)
+          for ld_flag in $LDFLAGS; do
+            if (test $ld_flag = "-brtl" || test $ld_flag = "-Wl,-brtl"); then
+              aix_use_runtimelinking=yes
+              break
+            fi
+          done
+          ;;
+        esac
+      fi
+      hardcode_direct=yes
+      hardcode_libdir_separator=':'
+      if test "$GCC" = yes; then
+        case $host_os in aix4.[012]|aix4.[012].*)
+          collect2name=`${CC} -print-prog-name=collect2`
+          if test -f "$collect2name" && \
+            strings "$collect2name" | grep resolve_lib_name >/dev/null
+          then
+            # We have reworked collect2
+            :
+          else
+            # We have old collect2
+            hardcode_direct=unsupported
+            hardcode_minus_L=yes
+            hardcode_libdir_flag_spec='-L$libdir'
+            hardcode_libdir_separator=
+          fi
+          ;;
+        esac
+      fi
+      # Begin _LT_AC_SYS_LIBPATH_AIX.
+      echo 'int main () { return 0; }' > conftest.c
+      ${CC} ${LDFLAGS} conftest.c -o conftest
+      aix_libpath=`dump -H conftest 2>/dev/null | sed -n -e '/Import File Strings/,/^$/ { /^0/ { s/^0  *\(.*\)$/\1/; p; }
+}'`
+      if test -z "$aix_libpath"; then
+        aix_libpath=`dump -HX64 conftest 2>/dev/null | sed -n -e '/Import File Strings/,/^$/ { /^0/ { s/^0  *\(.*\)$/\1/; p; }
+}'`
+      fi
+      if test -z "$aix_libpath"; then
+        aix_libpath="/usr/lib:/lib"
+      fi
+      rm -f conftest.c conftest
+      # End _LT_AC_SYS_LIBPATH_AIX.
+      if test "$aix_use_runtimelinking" = yes; then
+        hardcode_libdir_flag_spec='${wl}-blibpath:$libdir:'"$aix_libpath"
+      else
+        if test "$host_cpu" = ia64; then
+          hardcode_libdir_flag_spec='${wl}-R $libdir:/usr/lib:/lib'
+        else
+          hardcode_libdir_flag_spec='${wl}-blibpath:$libdir:'"$aix_libpath"
+        fi
+      fi
+      ;;
+    amigaos*)
+      hardcode_libdir_flag_spec='-L$libdir'
+      hardcode_minus_L=yes
+      # see comment about different semantics on the GNU ld section
+      ld_shlibs=no
+      ;;
+    bsdi[45]*)
+      ;;
+    cygwin* | mingw* | pw32*)
+      # When not using gcc, we currently assume that we are using
+      # Microsoft Visual C++.
+      # hardcode_libdir_flag_spec is actually meaningless, as there is
+      # no search path for DLLs.
+      hardcode_libdir_flag_spec=' '
+      libext=lib
+      ;;
+    darwin* | rhapsody*)
+      hardcode_direct=no
+      if test "$GCC" = yes ; then
+        :
+      else
+        case $cc_basename in
+          xlc*)
+            ;;
+          *)
+            ld_shlibs=no
+            ;;
+        esac
+      fi
+      ;;
+    dgux*)
+      hardcode_libdir_flag_spec='-L$libdir'
+      ;;
+    freebsd1*)
+      ld_shlibs=no
+      ;;
+    freebsd2.2*)
+      hardcode_libdir_flag_spec='-R$libdir'
+      hardcode_direct=yes
+      ;;
+    freebsd2*)
+      hardcode_direct=yes
+      hardcode_minus_L=yes
+      ;;
+    freebsd* | dragonfly*)
+      hardcode_libdir_flag_spec='-R$libdir'
+      hardcode_direct=yes
+      ;;
+    hpux9*)
+      hardcode_libdir_flag_spec='${wl}+b ${wl}$libdir'
+      hardcode_libdir_separator=:
+      hardcode_direct=yes
+      # hardcode_minus_L: Not really in the search PATH,
+      # but as the default location of the library.
+      hardcode_minus_L=yes
+      ;;
+    hpux10*)
+      if test "$with_gnu_ld" = no; then
+        hardcode_libdir_flag_spec='${wl}+b ${wl}$libdir'
+        hardcode_libdir_separator=:
+        hardcode_direct=yes
+        # hardcode_minus_L: Not really in the search PATH,
+        # but as the default location of the library.
+        hardcode_minus_L=yes
+      fi
+      ;;
+    hpux11*)
+      if test "$with_gnu_ld" = no; then
+        hardcode_libdir_flag_spec='${wl}+b ${wl}$libdir'
+        hardcode_libdir_separator=:
+        case $host_cpu in
+          hppa*64*|ia64*)
+            hardcode_direct=no
+            ;;
+          *)
+            hardcode_direct=yes
+            # hardcode_minus_L: Not really in the search PATH,
+            # but as the default location of the library.
+            hardcode_minus_L=yes
+            ;;
+        esac
+      fi
+      ;;
+    irix5* | irix6* | nonstopux*)
+      hardcode_libdir_flag_spec='${wl}-rpath ${wl}$libdir'
+      hardcode_libdir_separator=:
+      ;;
+    netbsd*)
+      hardcode_libdir_flag_spec='-R$libdir'
+      hardcode_direct=yes
+      ;;
+    newsos6)
+      hardcode_direct=yes
+      hardcode_libdir_flag_spec='${wl}-rpath ${wl}$libdir'
+      hardcode_libdir_separator=:
+      ;;
+    openbsd*)
+      if test -f /usr/libexec/ld.so; then
+        hardcode_direct=yes
+        if test -z "`echo __ELF__ | $CC -E - | grep __ELF__`" || test "$host_os-$host_cpu" = "openbsd2.8-powerpc"; then
+          hardcode_libdir_flag_spec='${wl}-rpath,$libdir'
+        else
+          case "$host_os" in
+            openbsd[01].* | openbsd2.[0-7] | openbsd2.[0-7].*)
+              hardcode_libdir_flag_spec='-R$libdir'
+              ;;
+            *)
+              hardcode_libdir_flag_spec='${wl}-rpath,$libdir'
+              ;;
+          esac
+        fi
+      else
+        ld_shlibs=no
+      fi
+      ;;
+    os2*)
+      hardcode_libdir_flag_spec='-L$libdir'
+      hardcode_minus_L=yes
+      ;;
+    osf3*)
+      hardcode_libdir_flag_spec='${wl}-rpath ${wl}$libdir'
+      hardcode_libdir_separator=:
+      ;;
+    osf4* | osf5*)
+      if test "$GCC" = yes; then
+        hardcode_libdir_flag_spec='${wl}-rpath ${wl}$libdir'
+      else
+        # Both cc and cxx compiler support -rpath directly
+        hardcode_libdir_flag_spec='-rpath $libdir'
+      fi
+      hardcode_libdir_separator=:
+      ;;
+    solaris*)
+      hardcode_libdir_flag_spec='-R$libdir'
+      ;;
+    sunos4*)
+      hardcode_libdir_flag_spec='-L$libdir'
+      hardcode_direct=yes
+      hardcode_minus_L=yes
+      ;;
+    sysv4)
+      case $host_vendor in
+        sni)
+          hardcode_direct=yes # is this really true???
+          ;;
+        siemens)
+          hardcode_direct=no
+          ;;
+        motorola)
+          hardcode_direct=no #Motorola manual says yes, but my tests say they lie
+          ;;
+      esac
+      ;;
+    sysv4.3*)
+      ;;
+    sysv4*MP*)
+      if test -d /usr/nec; then
+        ld_shlibs=yes
+      fi
+      ;;
+    sysv4*uw2* | sysv5OpenUNIX* | sysv5UnixWare7.[01].[10]* | unixware7* | sco3.2v5.0.[024]*)
+      ;;
+    sysv5* | sco3.2v5* | sco5v6*)
+      hardcode_libdir_flag_spec='`test -z "$SCOABSPATH" && echo ${wl}-R,$libdir`'
+      hardcode_libdir_separator=':'
+      ;;
+    uts4*)
+      hardcode_libdir_flag_spec='-L$libdir'
+      ;;
+    *)
+      ld_shlibs=no
+      ;;
+  esac
+fi
+
+# Check dynamic linker characteristics
+# Code taken from libtool.m4's AC_LIBTOOL_SYS_DYNAMIC_LINKER.
+# Unlike libtool.m4, here we don't care about _all_ names of the library, but
+# only about the one the linker finds when passed -lNAME. This is the last
+# element of library_names_spec in libtool.m4, or possibly two of them if the
+# linker has special search rules.
+library_names_spec=      # the last element of library_names_spec in libtool.m4
+libname_spec='lib$name'
+case "$host_os" in
+  aix3*)
+    library_names_spec='$libname.a'
+    ;;
+  aix4* | aix5*)
+    library_names_spec='$libname$shrext'
+    ;;
+  amigaos*)
+    library_names_spec='$libname.a'
+    ;;
+  beos*)
+    library_names_spec='$libname$shrext'
+    ;;
+  bsdi[45]*)
+    library_names_spec='$libname$shrext'
+    ;;
+  cygwin* | mingw* | pw32*)
+    shrext=.dll
+    library_names_spec='$libname.dll.a $libname.lib'
+    ;;
+  darwin* | rhapsody*)
+    shrext=.dylib
+    library_names_spec='$libname$shrext'
+    ;;
+  dgux*)
+    library_names_spec='$libname$shrext'
+    ;;
+  freebsd1*)
+    ;;
+  freebsd* | dragonfly*)
+    case "$host_os" in
+      freebsd[123]*)
+        library_names_spec='$libname$shrext$versuffix' ;;
+      *)
+        library_names_spec='$libname$shrext' ;;
+    esac
+    ;;
+  gnu*)
+    library_names_spec='$libname$shrext'
+    ;;
+  hpux9* | hpux10* | hpux11*)
+    case $host_cpu in
+      ia64*)
+        shrext=.so
+        ;;
+      hppa*64*)
+        shrext=.sl
+        ;;
+      *)
+        shrext=.sl
+        ;;
+    esac
+    library_names_spec='$libname$shrext'
+    ;;
+  interix[3-9]*)
+    library_names_spec='$libname$shrext'
+    ;;
+  irix5* | irix6* | nonstopux*)
+    library_names_spec='$libname$shrext'
+    case "$host_os" in
+      irix5* | nonstopux*)
+        libsuff= shlibsuff=
+        ;;
+      *)
+        case $LD in
+          *-32|*"-32 "|*-melf32bsmip|*"-melf32bsmip ") libsuff= shlibsuff= ;;
+          *-n32|*"-n32 "|*-melf32bmipn32|*"-melf32bmipn32 ") libsuff=32 shlibsuff=N32 ;;
+          *-64|*"-64 "|*-melf64bmip|*"-melf64bmip ") libsuff=64 shlibsuff=64 ;;
+          *) libsuff= shlibsuff= ;;
+        esac
+        ;;
+    esac
+    ;;
+  linux*oldld* | linux*aout* | linux*coff*)
+    ;;
+  linux* | k*bsd*-gnu)
+    library_names_spec='$libname$shrext'
+    ;;
+  knetbsd*-gnu)
+    library_names_spec='$libname$shrext'
+    ;;
+  netbsd*)
+    library_names_spec='$libname$shrext'
+    ;;
+  newsos6)
+    library_names_spec='$libname$shrext'
+    ;;
+  nto-qnx*)
+    library_names_spec='$libname$shrext'
+    ;;
+  openbsd*)
+    library_names_spec='$libname$shrext$versuffix'
+    ;;
+  os2*)
+    libname_spec='$name'
+    shrext=.dll
+    library_names_spec='$libname.a'
+    ;;
+  osf3* | osf4* | osf5*)
+    library_names_spec='$libname$shrext'
+    ;;
+  rdos*)
+    ;;
+  solaris*)
+    library_names_spec='$libname$shrext'
+    ;;
+  sunos4*)
+    library_names_spec='$libname$shrext$versuffix'
+    ;;
+  sysv4 | sysv4.3*)
+    library_names_spec='$libname$shrext'
+    ;;
+  sysv4*MP*)
+    library_names_spec='$libname$shrext'
+    ;;
+  sysv5* | sco3.2v5* | sco5v6* | unixware* | OpenUNIX* | sysv4*uw2*)
+    library_names_spec='$libname$shrext'
+    ;;
+  uts4*)
+    library_names_spec='$libname$shrext'
+    ;;
+esac
+
+sed_quote_subst='s/\(["`$\\]\)/\\\1/g'
+escaped_wl=`echo "X$wl" | sed -e 's/^X//' -e "$sed_quote_subst"`
+shlibext=`echo "$shrext" | sed -e 's,^\.,,'`
+escaped_libname_spec=`echo "X$libname_spec" | sed -e 's/^X//' -e "$sed_quote_subst"`
+escaped_library_names_spec=`echo "X$library_names_spec" | sed -e 's/^X//' -e "$sed_quote_subst"`
+escaped_hardcode_libdir_flag_spec=`echo "X$hardcode_libdir_flag_spec" | sed -e 's/^X//' -e "$sed_quote_subst"`
+
+LC_ALL=C sed -e 's/^\([a-zA-Z0-9_]*\)=/acl_cv_\1=/' <<EOF
+
+# How to pass a linker flag through the compiler.
+wl="$escaped_wl"
+
+# Static library suffix (normally "a").
+libext="$libext"
+
+# Shared library suffix (normally "so").
+shlibext="$shlibext"
+
+# Format of library name prefix.
+libname_spec="$escaped_libname_spec"
+
+# Library names that the linker finds when passed -lNAME.
+library_names_spec="$escaped_library_names_spec"
+
+# Flag to hardcode \$libdir into a binary during linking.
+# This must work even if \$libdir does not exist.
+hardcode_libdir_flag_spec="$escaped_hardcode_libdir_flag_spec"
+
+# Whether we need a single -rpath flag with a separated argument.
+hardcode_libdir_separator="$hardcode_libdir_separator"
+
+# Set to yes if using DIR/libNAME.so during linking hardcodes DIR into the
+# resulting binary.
+hardcode_direct="$hardcode_direct"
+
+# Set to yes if using the -LDIR flag during linking hardcodes DIR into the
+# resulting binary.
+hardcode_minus_L="$hardcode_minus_L"
+
+EOF
diff -urN lcd4linux-0.10.0/config.sub lcd4linux-0.11.0-SVN/config.sub
--- lcd4linux-0.10.0/config.sub	2004-06-08 14:33:47.000000000 +0200
+++ lcd4linux-0.11.0-SVN/config.sub	2008-12-31 08:05:54.000000000 +0100
@@ -1,9 +1,10 @@
 #! /bin/sh
 # Configuration validation subroutine script.
 #   Copyright (C) 1992, 1993, 1994, 1995, 1996, 1997, 1998, 1999,
-#   2000, 2001, 2002, 2003 Free Software Foundation, Inc.
+#   2000, 2001, 2002, 2003, 2004, 2005, 2006, 2007, 2008
+#   Free Software Foundation, Inc.
 
-timestamp='2004-03-12'
+timestamp='2008-01-16'
 
 # This file is (in principle) common to ALL GNU software.
 # The presence of a machine in this file suggests that SOME GNU software
@@ -21,14 +22,15 @@
 #
 # You should have received a copy of the GNU General Public License
 # along with this program; if not, write to the Free Software
-# Foundation, Inc., 59 Temple Place - Suite 330,
-# Boston, MA 02111-1307, USA.
-
+# Foundation, Inc., 51 Franklin Street - Fifth Floor, Boston, MA
+# 02110-1301, USA.
+#
 # As a special exception to the GNU General Public License, if you
 # distribute this file as part of a program that contains a
 # configuration script generated by Autoconf, you may include it under
 # the same distribution terms that you use for the rest of that program.
 
+
 # Please send patches to <config-patches@gnu.org>.  Submit a context
 # diff and a properly formatted ChangeLog entry.
 #
@@ -70,8 +72,8 @@
 version="\
 GNU config.sub ($timestamp)
 
-Copyright (C) 1992, 1993, 1994, 1995, 1996, 1997, 1998, 1999, 2000, 2001
-Free Software Foundation, Inc.
+Copyright (C) 1992, 1993, 1994, 1995, 1996, 1997, 1998, 1999, 2000, 2001,
+2002, 2003, 2004, 2005, 2006, 2007, 2008 Free Software Foundation, Inc.
 
 This is free software; see the source for copying conditions.  There is NO
 warranty; not even for MERCHANTABILITY or FITNESS FOR A PARTICULAR PURPOSE."
@@ -83,11 +85,11 @@
 while test $# -gt 0 ; do
   case $1 in
     --time-stamp | --time* | -t )
-       echo "$timestamp" ; exit 0 ;;
+       echo "$timestamp" ; exit ;;
     --version | -v )
-       echo "$version" ; exit 0 ;;
+       echo "$version" ; exit ;;
     --help | --h* | -h )
-       echo "$usage"; exit 0 ;;
+       echo "$usage"; exit ;;
     -- )     # Stop option processing
        shift; break ;;
     - )	# Use stdin as input.
@@ -99,7 +101,7 @@
     *local*)
        # First pass through any local machine types.
        echo $1
-       exit 0;;
+       exit ;;
 
     * )
        break ;;
@@ -118,8 +120,9 @@
 # Here we must recognize all the valid KERNEL-OS combinations.
 maybe_os=`echo $1 | sed 's/^\(.*\)-\([^-]*-[^-]*\)$/\2/'`
 case $maybe_os in
-  nto-qnx* | linux-gnu* | linux-dietlibc | linux-uclibc* | uclinux-uclibc* | uclinux-gnu* | \
-  kfreebsd*-gnu* | knetbsd*-gnu* | netbsd*-gnu* | storm-chaos* | os2-emx* | rtmk-nova*)
+  nto-qnx* | linux-gnu* | linux-dietlibc | linux-newlib* | linux-uclibc* | \
+  uclinux-uclibc* | uclinux-gnu* | kfreebsd*-gnu* | knetbsd*-gnu* | netbsd*-gnu* | \
+  storm-chaos* | os2-emx* | rtmk-nova*)
     os=-$maybe_os
     basic_machine=`echo $1 | sed 's/^\(.*\)-\([^-]*-[^-]*\)$/\1/'`
     ;;
@@ -145,7 +148,7 @@
 	-convergent* | -ncr* | -news | -32* | -3600* | -3100* | -hitachi* |\
 	-c[123]* | -convex* | -sun | -crds | -omron* | -dg | -ultra | -tti* | \
 	-harris | -dolphin | -highlevel | -gould | -cbm | -ns | -masscomp | \
-	-apple | -axis)
+	-apple | -axis | -knuth | -cray)
 		os=
 		basic_machine=$1
 		;;
@@ -170,6 +173,10 @@
 	-hiux*)
 		os=-hiuxwe2
 		;;
+	-sco6)
+		os=-sco5v6
+		basic_machine=`echo $1 | sed -e 's/86-.*/86-pc/'`
+		;;
 	-sco5)
 		os=-sco3.2v5
 		basic_machine=`echo $1 | sed -e 's/86-.*/86-pc/'`
@@ -186,6 +193,10 @@
 		# Don't forget version if it is 3.2v4 or newer.
 		basic_machine=`echo $1 | sed -e 's/86-.*/86-pc/'`
 		;;
+	-sco5v6*)
+		# Don't forget version if it is 3.2v4 or newer.
+		basic_machine=`echo $1 | sed -e 's/86-.*/86-pc/'`
+		;;
 	-sco*)
 		os=-sco3.2v2
 		basic_machine=`echo $1 | sed -e 's/86-.*/86-pc/'`
@@ -230,14 +241,16 @@
 	| alpha | alphaev[4-8] | alphaev56 | alphaev6[78] | alphapca5[67] \
 	| alpha64 | alpha64ev[4-8] | alpha64ev56 | alpha64ev6[78] | alpha64pca5[67] \
 	| am33_2.0 \
-	| arc | arm | arm[bl]e | arme[lb] | armv[2345] | armv[345][lb] | avr \
+	| arc | arm | arm[bl]e | arme[lb] | armv[2345] | armv[345][lb] | avr | avr32 \
+	| bfin \
 	| c4x | clipper \
 	| d10v | d30v | dlx | dsp16xx \
-	| fr30 | frv \
+	| fido | fr30 | frv \
 	| h8300 | h8500 | hppa | hppa1.[01] | hppa2.0 | hppa2.0[nw] | hppa64 \
 	| i370 | i860 | i960 | ia64 \
 	| ip2k | iq2000 \
-	| m32r | m32rle | m68000 | m68k | m88k | mcore \
+	| m32c | m32r | m32rle | m68000 | m68k | m88k \
+	| maxq | mb | microblaze | mcore | mep \
 	| mips | mipsbe | mipseb | mipsel | mipsle \
 	| mips16 \
 	| mips64 | mips64el \
@@ -246,6 +259,7 @@
 	| mips64vr4100 | mips64vr4100el \
 	| mips64vr4300 | mips64vr4300el \
 	| mips64vr5000 | mips64vr5000el \
+	| mips64vr5900 | mips64vr5900el \
 	| mipsisa32 | mipsisa32el \
 	| mipsisa32r2 | mipsisa32r2el \
 	| mipsisa64 | mipsisa64el \
@@ -254,20 +268,24 @@
 	| mipsisa64sr71k | mipsisa64sr71kel \
 	| mipstx39 | mipstx39el \
 	| mn10200 | mn10300 \
+	| mt \
 	| msp430 \
+	| nios | nios2 \
 	| ns16k | ns32k \
-	| openrisc | or32 \
+	| or32 \
 	| pdp10 | pdp11 | pj | pjl \
 	| powerpc | powerpc64 | powerpc64le | powerpcle | ppcbe \
 	| pyramid \
-	| sh | sh[1234] | sh[23]e | sh[34]eb | shbe | shle | sh[1234]le | sh3ele \
+	| score \
+	| sh | sh[1234] | sh[24]a | sh[23]e | sh[34]eb | sheb | shbe | shle | sh[1234]le | sh3ele \
 	| sh64 | sh64le \
-	| sparc | sparc64 | sparc86x | sparclet | sparclite | sparcv8 | sparcv9 | sparcv9b \
-	| strongarm \
+	| sparc | sparc64 | sparc64b | sparc64v | sparc86x | sparclet | sparclite \
+	| sparcv8 | sparcv9 | sparcv9b | sparcv9v \
+	| spu | strongarm \
 	| tahoe | thumb | tic4x | tic80 | tron \
 	| v850 | v850e \
 	| we32k \
-	| x86 | xscale | xstormy16 | xtensa \
+	| x86 | xc16x | xscale | xscalee[bl] | xstormy16 | xtensa \
 	| z8k)
 		basic_machine=$basic_machine-unknown
 		;;
@@ -278,6 +296,9 @@
 		;;
 	m88110 | m680[12346]0 | m683?2 | m68360 | m5200 | v70 | w65 | z8k)
 		;;
+	ms1)
+		basic_machine=mt-unknown
+		;;
 
 	# We use `pc' rather than `unknown'
 	# because (1) that's what they normally are, and
@@ -297,20 +318,20 @@
 	| alpha64-* | alpha64ev[4-8]-* | alpha64ev56-* | alpha64ev6[78]-* \
 	| alphapca5[67]-* | alpha64pca5[67]-* | arc-* \
 	| arm-*  | armbe-* | armle-* | armeb-* | armv*-* \
-	| avr-* \
-	| bs2000-* \
+	| avr-* | avr32-* \
+	| bfin-* | bs2000-* \
 	| c[123]* | c30-* | [cjt]90-* | c4x-* | c54x-* | c55x-* | c6x-* \
-	| clipper-* | cydra-* \
+	| clipper-* | craynv-* | cydra-* \
 	| d10v-* | d30v-* | dlx-* \
 	| elxsi-* \
-	| f30[01]-* | f700-* | fr30-* | frv-* | fx80-* \
+	| f30[01]-* | f700-* | fido-* | fr30-* | frv-* | fx80-* \
 	| h8300-* | h8500-* \
 	| hppa-* | hppa1.[01]-* | hppa2.0-* | hppa2.0[nw]-* | hppa64-* \
 	| i*86-* | i860-* | i960-* | ia64-* \
 	| ip2k-* | iq2000-* \
-	| m32r-* | m32rle-* \
+	| m32c-* | m32r-* | m32rle-* \
 	| m68000-* | m680[012346]0-* | m68360-* | m683?2-* | m68k-* \
-	| m88110-* | m88k-* | mcore-* \
+	| m88110-* | m88k-* | maxq-* | mcore-* \
 	| mips-* | mipsbe-* | mipseb-* | mipsel-* | mipsle-* \
 	| mips16-* \
 	| mips64-* | mips64el-* \
@@ -319,6 +340,7 @@
 	| mips64vr4100-* | mips64vr4100el-* \
 	| mips64vr4300-* | mips64vr4300el-* \
 	| mips64vr5000-* | mips64vr5000el-* \
+	| mips64vr5900-* | mips64vr5900el-* \
 	| mipsisa32-* | mipsisa32el-* \
 	| mipsisa32r2-* | mipsisa32r2el-* \
 	| mipsisa64-* | mipsisa64el-* \
@@ -326,27 +348,35 @@
 	| mipsisa64sb1-* | mipsisa64sb1el-* \
 	| mipsisa64sr71k-* | mipsisa64sr71kel-* \
 	| mipstx39-* | mipstx39el-* \
+	| mmix-* \
+	| mt-* \
 	| msp430-* \
-	| none-* | np1-* | nv1-* | ns16k-* | ns32k-* \
+	| nios-* | nios2-* \
+	| none-* | np1-* | ns16k-* | ns32k-* \
 	| orion-* \
 	| pdp10-* | pdp11-* | pj-* | pjl-* | pn-* | power-* \
 	| powerpc-* | powerpc64-* | powerpc64le-* | powerpcle-* | ppcbe-* \
 	| pyramid-* \
 	| romp-* | rs6000-* \
-	| sh-* | sh[1234]-* | sh[23]e-* | sh[34]eb-* | shbe-* \
+	| sh-* | sh[1234]-* | sh[24]a-* | sh[23]e-* | sh[34]eb-* | sheb-* | shbe-* \
 	| shle-* | sh[1234]le-* | sh3ele-* | sh64-* | sh64le-* \
-	| sparc-* | sparc64-* | sparc86x-* | sparclet-* | sparclite-* \
-	| sparcv8-* | sparcv9-* | sparcv9b-* | strongarm-* | sv1-* | sx?-* \
+	| sparc-* | sparc64-* | sparc64b-* | sparc64v-* | sparc86x-* | sparclet-* \
+	| sparclite-* \
+	| sparcv8-* | sparcv9-* | sparcv9b-* | sparcv9v-* | strongarm-* | sv1-* | sx?-* \
 	| tahoe-* | thumb-* \
 	| tic30-* | tic4x-* | tic54x-* | tic55x-* | tic6x-* | tic80-* \
 	| tron-* \
 	| v850-* | v850e-* | vax-* \
 	| we32k-* \
-	| x86-* | x86_64-* | xps100-* | xscale-* | xstormy16-* \
-	| xtensa-* \
+	| x86-* | x86_64-* | xc16x-* | xps100-* | xscale-* | xscalee[bl]-* \
+	| xstormy16-* | xtensa*-* \
 	| ymp-* \
 	| z8k-*)
 		;;
+	# Recognize the basic CPU types without company name, with glob match.
+	xtensa*)
+		basic_machine=$basic_machine-unknown
+		;;
 	# Recognize the various machine names and aliases which stand
 	# for a CPU type and a company and sometimes even an OS.
 	386bsd)
@@ -417,6 +447,14 @@
 		basic_machine=ns32k-sequent
 		os=-dynix
 		;;
+	blackfin)
+		basic_machine=bfin-unknown
+		os=-linux
+		;;
+	blackfin-*)
+		basic_machine=bfin-`echo $basic_machine | sed 's/^[^-]*-//'`
+		os=-linux
+		;;
 	c90)
 		basic_machine=c90-cray
 		os=-unicos
@@ -445,13 +483,20 @@
 		basic_machine=j90-cray
 		os=-unicos
 		;;
-	cr16c)
-		basic_machine=cr16c-unknown
+	craynv)
+		basic_machine=craynv-cray
+		os=-unicosmp
+		;;
+	cr16)
+		basic_machine=cr16-unknown
 		os=-elf
 		;;
 	crds | unos)
 		basic_machine=m68k-crds
 		;;
+	crisv32 | crisv32-* | etraxfs*)
+		basic_machine=crisv32-axis
+		;;
 	cris | cris-* | etrax*)
 		basic_machine=cris-axis
 		;;
@@ -481,6 +526,10 @@
 		basic_machine=m88k-motorola
 		os=-sysv3
 		;;
+	djgpp)
+		basic_machine=i586-pc
+		os=-msdosdjgpp
+		;;
 	dpx20 | dpx20-*)
 		basic_machine=rs6000-bull
 		os=-bosx
@@ -631,6 +680,14 @@
 		basic_machine=m68k-isi
 		os=-sysv
 		;;
+	m68knommu)
+		basic_machine=m68k-unknown
+		os=-linux
+		;;
+	m68knommu-*)
+		basic_machine=m68k-`echo $basic_machine | sed 's/^[^-]*-//'`
+		os=-linux
+		;;
 	m88k-omron*)
 		basic_machine=m88k-omron
 		;;
@@ -646,6 +703,10 @@
 		basic_machine=i386-pc
 		os=-mingw32
 		;;
+	mingw32ce)
+		basic_machine=arm-unknown
+		os=-mingw32ce
+		;;
 	miniframe)
 		basic_machine=m68000-convergent
 		;;
@@ -659,10 +720,6 @@
 	mips3*)
 		basic_machine=`echo $basic_machine | sed -e 's/mips3/mips64/'`-unknown
 		;;
-	mmix*)
-		basic_machine=mmix-knuth
-		os=-mmixware
-		;;
 	monitor)
 		basic_machine=m68k-rom68k
 		os=-coff
@@ -675,6 +732,9 @@
 		basic_machine=i386-pc
 		os=-msdos
 		;;
+	ms1-*)
+		basic_machine=`echo $basic_machine | sed -e 's/ms1-/mt-/'`
+		;;
 	mvs)
 		basic_machine=i370-ibm
 		os=-mvs
@@ -743,10 +803,6 @@
 	np1)
 		basic_machine=np1-gould
 		;;
-	nv1)
-		basic_machine=nv1-cray
-		os=-unicosmp
-		;;
 	nsr-tandem)
 		basic_machine=nsr-tandem
 		;;
@@ -754,9 +810,8 @@
 		basic_machine=hppa1.1-oki
 		os=-proelf
 		;;
-	or32 | or32-*)
+	openrisc | openrisc-*)
 		basic_machine=or32-unknown
-		os=-coff
 		;;
 	os400)
 		basic_machine=powerpc-ibm
@@ -778,6 +833,14 @@
 		basic_machine=i860-intel
 		os=-osf
 		;;
+	parisc)
+		basic_machine=hppa-unknown
+		os=-linux
+		;;
+	parisc-*)
+		basic_machine=hppa-`echo $basic_machine | sed 's/^[^-]*-//'`
+		os=-linux
+		;;
 	pbd)
 		basic_machine=sparc-tti
 		;;
@@ -787,6 +850,12 @@
 	pc532 | pc532-*)
 		basic_machine=ns32k-pc532
 		;;
+	pc98)
+		basic_machine=i386-pc
+		;;
+	pc98-*)
+		basic_machine=i386-`echo $basic_machine | sed 's/^[^-]*-//'`
+		;;
 	pentium | p5 | k5 | k6 | nexgen | viac3)
 		basic_machine=i586-pc
 		;;
@@ -843,6 +912,10 @@
 		basic_machine=i586-unknown
 		os=-pw32
 		;;
+	rdos)
+		basic_machine=i386-pc
+		os=-rdos
+		;;
 	rom68k)
 		basic_machine=m68k-rom68k
 		os=-coff
@@ -869,6 +942,10 @@
 	sb1el)
 		basic_machine=mipsisa64sb1el-unknown
 		;;
+	sde)
+		basic_machine=mipsisa32-sde
+		os=-elf
+		;;
 	sei)
 		basic_machine=mips-sei
 		os=-seiux
@@ -880,6 +957,9 @@
 		basic_machine=sh-hitachi
 		os=-hms
 		;;
+	sh5el)
+		basic_machine=sh5le-unknown
+		;;
 	sh64)
 		basic_machine=sh64-unknown
 		;;
@@ -969,6 +1049,10 @@
 		basic_machine=tic6x-unknown
 		os=-coff
 		;;
+	tile*)
+		basic_machine=tile-unknown
+		os=-linux-gnu
+		;;
 	tx39)
 		basic_machine=mipstx39-unknown
 		;;
@@ -1029,6 +1113,10 @@
 		basic_machine=hppa1.1-winbond
 		os=-proelf
 		;;
+	xbox)
+		basic_machine=i686-pc
+		os=-mingw32
+		;;
 	xps | xps100)
 		basic_machine=xps100-honeywell
 		;;
@@ -1059,6 +1147,9 @@
 	romp)
 		basic_machine=romp-ibm
 		;;
+	mmix)
+		basic_machine=mmix-knuth
+		;;
 	rs6000)
 		basic_machine=rs6000-ibm
 		;;
@@ -1075,13 +1166,10 @@
 	we32k)
 		basic_machine=we32k-att
 		;;
-	sh3 | sh4 | sh[34]eb | sh[1234]le | sh[23]ele)
+	sh[1234] | sh[24]a | sh[34]eb | sh[1234]le | sh[23]ele)
 		basic_machine=sh-unknown
 		;;
-	sh64)
-		basic_machine=sh64-unknown
-		;;
-	sparc | sparcv8 | sparcv9 | sparcv9b)
+	sparc | sparcv8 | sparcv9 | sparcv9b | sparcv9v)
 		basic_machine=sparc-sun
 		;;
 	cydra)
@@ -1154,20 +1242,23 @@
 	      | -aos* \
 	      | -nindy* | -vxsim* | -vxworks* | -ebmon* | -hms* | -mvs* \
 	      | -clix* | -riscos* | -uniplus* | -iris* | -rtu* | -xenix* \
-	      | -hiux* | -386bsd* | -knetbsd* | -mirbsd* | -netbsd* | -openbsd* \
+	      | -hiux* | -386bsd* | -knetbsd* | -mirbsd* | -netbsd* \
+	      | -openbsd* | -solidbsd* \
 	      | -ekkobsd* | -kfreebsd* | -freebsd* | -riscix* | -lynxos* \
 	      | -bosx* | -nextstep* | -cxux* | -aout* | -elf* | -oabi* \
 	      | -ptx* | -coff* | -ecoff* | -winnt* | -domain* | -vsta* \
 	      | -udi* | -eabi* | -lites* | -ieee* | -go32* | -aux* \
 	      | -chorusos* | -chorusrdb* \
 	      | -cygwin* | -pe* | -psos* | -moss* | -proelf* | -rtems* \
-	      | -mingw32* | -linux-gnu* | -linux-uclibc* | -uxpv* | -beos* | -mpeix* | -udk* \
+	      | -mingw32* | -linux-gnu* | -linux-newlib* | -linux-uclibc* \
+	      | -uxpv* | -beos* | -mpeix* | -udk* \
 	      | -interix* | -uwin* | -mks* | -rhapsody* | -darwin* | -opened* \
 	      | -openstep* | -oskit* | -conix* | -pw32* | -nonstopux* \
 	      | -storm-chaos* | -tops10* | -tenex* | -tops20* | -its* \
 	      | -os2* | -vos* | -palmos* | -uclinux* | -nucleus* \
 	      | -morphos* | -superux* | -rtmk* | -rtmk-nova* | -windiss* \
-	      | -powermax* | -dnix* | -nx6 | -nx7 | -sei* | -dragonfly*)
+	      | -powermax* | -dnix* | -nx6 | -nx7 | -sei* | -dragonfly* \
+	      | -skyos* | -haiku* | -rdos* | -toppers* | -drops*)
 	# Remember, each alternative MUST END IN *, to match a version number.
 		;;
 	-qnx*)
@@ -1185,7 +1276,7 @@
 		os=`echo $os | sed -e 's|nto|nto-qnx|'`
 		;;
 	-sim | -es1800* | -hms* | -xray | -os68k* | -none* | -v88r* \
-	      | -windows* | -osx | -abug | -netware* | -os9* | -beos* \
+	      | -windows* | -osx | -abug | -netware* | -os9* | -beos* | -haiku* \
 	      | -macos* | -mpw* | -magic* | -mmixware* | -mon960* | -lnews*)
 		;;
 	-mac*)
@@ -1294,6 +1385,9 @@
 	-kaos*)
 		os=-kaos
 		;;
+	-zvmoe)
+		os=-zvmoe
+		;;
 	-none)
 		;;
 	*)
@@ -1316,6 +1410,12 @@
 # system, and we'll never get to this point.
 
 case $basic_machine in
+        score-*)
+		os=-elf
+		;;
+        spu-*)
+		os=-elf
+		;;
 	*-acorn)
 		os=-riscix1.2
 		;;
@@ -1325,9 +1425,9 @@
 	arm*-semi)
 		os=-aout
 		;;
-    c4x-* | tic4x-*)
-        os=-coff
-        ;;
+        c4x-* | tic4x-*)
+        	os=-coff
+		;;
 	# This must come before the *-dec entry.
 	pdp10-*)
 		os=-tops20
@@ -1353,6 +1453,9 @@
 	m68*-cisco)
 		os=-aout
 		;;
+        mep-*)
+		os=-elf
+		;;
 	mips*-cisco)
 		os=-elf
 		;;
@@ -1371,9 +1474,15 @@
 	*-be)
 		os=-beos
 		;;
+	*-haiku)
+		os=-haiku
+		;;
 	*-ibm)
 		os=-aix
 		;;
+    	*-knuth)
+		os=-mmixware
+		;;
 	*-wec)
 		os=-proelf
 		;;
@@ -1539,7 +1648,7 @@
 esac
 
 echo $basic_machine$os
-exit 0
+exit
 
 # Local variables:
 # eval: (add-hook 'write-file-hooks 'time-stamp)
diff -urN lcd4linux-0.10.0/configure lcd4linux-0.11.0-SVN/configure
--- lcd4linux-0.10.0/configure	2005-06-10 13:21:49.000000000 +0200
+++ lcd4linux-0.11.0-SVN/configure	2009-01-13 06:04:34.000000000 +0100
@@ -1,27 +1,56 @@
 #! /bin/sh
 # Guess values for system-dependent variables and create Makefiles.
-# Generated by GNU Autoconf 2.59 for LCD4Linux 0.10.0.
+# Generated by GNU Autoconf 2.61 for LCD4Linux 0.11.0-SVN.
 #
 # Report bugs to <lcd4linux-users@lists.sourceforge.net>.
 #
-# Copyright (C) 2003 Free Software Foundation, Inc.
+# Copyright (C) 1992, 1993, 1994, 1995, 1996, 1998, 1999, 2000, 2001,
+# 2002, 2003, 2004, 2005, 2006 Free Software Foundation, Inc.
 # This configure script is free software; the Free Software Foundation
 # gives unlimited permission to copy, distribute and modify it.
 ## --------------------- ##
 ## M4sh Initialization.  ##
 ## --------------------- ##
 
-# Be Bourne compatible
+# Be more Bourne compatible
+DUALCASE=1; export DUALCASE # for MKS sh
 if test -n "${ZSH_VERSION+set}" && (emulate sh) >/dev/null 2>&1; then
   emulate sh
   NULLCMD=:
   # Zsh 3.x and 4.x performs word splitting on ${1+"$@"}, which
   # is contrary to our usage.  Disable this feature.
   alias -g '${1+"$@"}'='"$@"'
-elif test -n "${BASH_VERSION+set}" && (set -o posix) >/dev/null 2>&1; then
-  set -o posix
+  setopt NO_GLOB_SUBST
+else
+  case `(set -o) 2>/dev/null` in
+  *posix*) set -o posix ;;
+esac
+
+fi
+
+
+
+
+# PATH needs CR
+# Avoid depending upon Character Ranges.
+as_cr_letters='abcdefghijklmnopqrstuvwxyz'
+as_cr_LETTERS='ABCDEFGHIJKLMNOPQRSTUVWXYZ'
+as_cr_Letters=$as_cr_letters$as_cr_LETTERS
+as_cr_digits='0123456789'
+as_cr_alnum=$as_cr_Letters$as_cr_digits
+
+# The user is always right.
+if test "${PATH_SEPARATOR+set}" != set; then
+  echo "#! /bin/sh" >conf$$.sh
+  echo  "exit 0"   >>conf$$.sh
+  chmod +x conf$$.sh
+  if (PATH="/nonexistent;."; conf$$.sh) >/dev/null 2>&1; then
+    PATH_SEPARATOR=';'
+  else
+    PATH_SEPARATOR=:
+  fi
+  rm -f conf$$.sh
 fi
-DUALCASE=1; export DUALCASE # for MKS sh
 
 # Support unset when possible.
 if ( (MAIL=60; unset MAIL) || exit) >/dev/null 2>&1; then
@@ -31,8 +60,43 @@
 fi
 
 
+# IFS
+# We need space, tab and new line, in precisely that order.  Quoting is
+# there to prevent editors from complaining about space-tab.
+# (If _AS_PATH_WALK were called with IFS unset, it would disable word
+# splitting by setting IFS to empty value.)
+as_nl='
+'
+IFS=" ""	$as_nl"
+
+# Find who we are.  Look in the path if we contain no directory separator.
+case $0 in
+  *[\\/]* ) as_myself=$0 ;;
+  *) as_save_IFS=$IFS; IFS=$PATH_SEPARATOR
+for as_dir in $PATH
+do
+  IFS=$as_save_IFS
+  test -z "$as_dir" && as_dir=.
+  test -r "$as_dir/$0" && as_myself=$as_dir/$0 && break
+done
+IFS=$as_save_IFS
+
+     ;;
+esac
+# We did not find ourselves, most probably we were run as `sh COMMAND'
+# in which case we are not to be found in the path.
+if test "x$as_myself" = x; then
+  as_myself=$0
+fi
+if test ! -f "$as_myself"; then
+  echo "$as_myself: error: cannot find myself; rerun with an absolute file name" >&2
+  { (exit 1); exit 1; }
+fi
+
 # Work around bugs in pre-3.0 UWIN ksh.
-$as_unset ENV MAIL MAILPATH
+for as_var in ENV MAIL MAILPATH
+do ($as_unset $as_var) >/dev/null 2>&1 && $as_unset $as_var
+done
 PS1='$ '
 PS2='> '
 PS4='+ '
@@ -46,18 +110,19 @@
   if (set +x; test -z "`(eval $as_var=C; export $as_var) 2>&1`"); then
     eval $as_var=C; export $as_var
   else
-    $as_unset $as_var
+    ($as_unset $as_var) >/dev/null 2>&1 && $as_unset $as_var
   fi
 done
 
 # Required to use basename.
-if expr a : '\(a\)' >/dev/null 2>&1; then
+if expr a : '\(a\)' >/dev/null 2>&1 &&
+   test "X`expr 00001 : '.*\(...\)'`" = X001; then
   as_expr=expr
 else
   as_expr=false
 fi
 
-if (basename /) >/dev/null 2>&1 && test "X`basename / 2>&1`" = "X/"; then
+if (basename -- /) >/dev/null 2>&1 && test "X`basename -- / 2>&1`" = "X/"; then
   as_basename=basename
 else
   as_basename=false
@@ -65,157 +130,388 @@
 
 
 # Name of the executable.
-as_me=`$as_basename "$0" ||
+as_me=`$as_basename -- "$0" ||
 $as_expr X/"$0" : '.*/\([^/][^/]*\)/*$' \| \
 	 X"$0" : 'X\(//\)$' \| \
-	 X"$0" : 'X\(/\)$' \| \
-	 .     : '\(.\)' 2>/dev/null ||
+	 X"$0" : 'X\(/\)' \| . 2>/dev/null ||
 echo X/"$0" |
-    sed '/^.*\/\([^/][^/]*\)\/*$/{ s//\1/; q; }
-  	  /^X\/\(\/\/\)$/{ s//\1/; q; }
-  	  /^X\/\(\/\).*/{ s//\1/; q; }
-  	  s/.*/./; q'`
+    sed '/^.*\/\([^/][^/]*\)\/*$/{
+	    s//\1/
+	    q
+	  }
+	  /^X\/\(\/\/\)$/{
+	    s//\1/
+	    q
+	  }
+	  /^X\/\(\/\).*/{
+	    s//\1/
+	    q
+	  }
+	  s/.*/./; q'`
 
+# CDPATH.
+$as_unset CDPATH
 
-# PATH needs CR, and LINENO needs CR and PATH.
-# Avoid depending upon Character Ranges.
-as_cr_letters='abcdefghijklmnopqrstuvwxyz'
-as_cr_LETTERS='ABCDEFGHIJKLMNOPQRSTUVWXYZ'
-as_cr_Letters=$as_cr_letters$as_cr_LETTERS
-as_cr_digits='0123456789'
-as_cr_alnum=$as_cr_Letters$as_cr_digits
 
-# The user is always right.
-if test "${PATH_SEPARATOR+set}" != set; then
-  echo "#! /bin/sh" >conf$$.sh
-  echo  "exit 0"   >>conf$$.sh
-  chmod +x conf$$.sh
-  if (PATH="/nonexistent;."; conf$$.sh) >/dev/null 2>&1; then
-    PATH_SEPARATOR=';'
-  else
-    PATH_SEPARATOR=:
-  fi
-  rm -f conf$$.sh
+if test "x$CONFIG_SHELL" = x; then
+  if (eval ":") 2>/dev/null; then
+  as_have_required=yes
+else
+  as_have_required=no
+fi
+
+  if test $as_have_required = yes && 	 (eval ":
+(as_func_return () {
+  (exit \$1)
+}
+as_func_success () {
+  as_func_return 0
+}
+as_func_failure () {
+  as_func_return 1
+}
+as_func_ret_success () {
+  return 0
+}
+as_func_ret_failure () {
+  return 1
+}
+
+exitcode=0
+if as_func_success; then
+  :
+else
+  exitcode=1
+  echo as_func_success failed.
 fi
 
+if as_func_failure; then
+  exitcode=1
+  echo as_func_failure succeeded.
+fi
 
-  as_lineno_1=$LINENO
-  as_lineno_2=$LINENO
-  as_lineno_3=`(expr $as_lineno_1 + 1) 2>/dev/null`
-  test "x$as_lineno_1" != "x$as_lineno_2" &&
-  test "x$as_lineno_3"  = "x$as_lineno_2"  || {
-  # Find who we are.  Look in the path if we contain no path at all
-  # relative or not.
-  case $0 in
-    *[\\/]* ) as_myself=$0 ;;
-    *) as_save_IFS=$IFS; IFS=$PATH_SEPARATOR
-for as_dir in $PATH
-do
-  IFS=$as_save_IFS
-  test -z "$as_dir" && as_dir=.
-  test -r "$as_dir/$0" && as_myself=$as_dir/$0 && break
-done
+if as_func_ret_success; then
+  :
+else
+  exitcode=1
+  echo as_func_ret_success failed.
+fi
 
-       ;;
-  esac
-  # We did not find ourselves, most probably we were run as `sh COMMAND'
-  # in which case we are not to be found in the path.
-  if test "x$as_myself" = x; then
-    as_myself=$0
-  fi
-  if test ! -f "$as_myself"; then
-    { echo "$as_me: error: cannot find myself; rerun with an absolute path" >&2
-   { (exit 1); exit 1; }; }
-  fi
-  case $CONFIG_SHELL in
-  '')
+if as_func_ret_failure; then
+  exitcode=1
+  echo as_func_ret_failure succeeded.
+fi
+
+if ( set x; as_func_ret_success y && test x = \"\$1\" ); then
+  :
+else
+  exitcode=1
+  echo positional parameters were not saved.
+fi
+
+test \$exitcode = 0) || { (exit 1); exit 1; }
+
+(
+  as_lineno_1=\$LINENO
+  as_lineno_2=\$LINENO
+  test \"x\$as_lineno_1\" != \"x\$as_lineno_2\" &&
+  test \"x\`expr \$as_lineno_1 + 1\`\" = \"x\$as_lineno_2\") || { (exit 1); exit 1; }
+") 2> /dev/null; then
+  :
+else
+  as_candidate_shells=
     as_save_IFS=$IFS; IFS=$PATH_SEPARATOR
 for as_dir in /bin$PATH_SEPARATOR/usr/bin$PATH_SEPARATOR$PATH
 do
   IFS=$as_save_IFS
   test -z "$as_dir" && as_dir=.
-  for as_base in sh bash ksh sh5; do
-	 case $as_dir in
+  case $as_dir in
 	 /*)
-	   if ("$as_dir/$as_base" -c '
+	   for as_base in sh bash ksh sh5; do
+	     as_candidate_shells="$as_candidate_shells $as_dir/$as_base"
+	   done;;
+       esac
+done
+IFS=$as_save_IFS
+
+
+      for as_shell in $as_candidate_shells $SHELL; do
+	 # Try only shells that exist, to save several forks.
+	 if { test -f "$as_shell" || test -f "$as_shell.exe"; } &&
+		{ ("$as_shell") 2> /dev/null <<\_ASEOF
+if test -n "${ZSH_VERSION+set}" && (emulate sh) >/dev/null 2>&1; then
+  emulate sh
+  NULLCMD=:
+  # Zsh 3.x and 4.x performs word splitting on ${1+"$@"}, which
+  # is contrary to our usage.  Disable this feature.
+  alias -g '${1+"$@"}'='"$@"'
+  setopt NO_GLOB_SUBST
+else
+  case `(set -o) 2>/dev/null` in
+  *posix*) set -o posix ;;
+esac
+
+fi
+
+
+:
+_ASEOF
+}; then
+  CONFIG_SHELL=$as_shell
+	       as_have_required=yes
+	       if { "$as_shell" 2> /dev/null <<\_ASEOF
+if test -n "${ZSH_VERSION+set}" && (emulate sh) >/dev/null 2>&1; then
+  emulate sh
+  NULLCMD=:
+  # Zsh 3.x and 4.x performs word splitting on ${1+"$@"}, which
+  # is contrary to our usage.  Disable this feature.
+  alias -g '${1+"$@"}'='"$@"'
+  setopt NO_GLOB_SUBST
+else
+  case `(set -o) 2>/dev/null` in
+  *posix*) set -o posix ;;
+esac
+
+fi
+
+
+:
+(as_func_return () {
+  (exit $1)
+}
+as_func_success () {
+  as_func_return 0
+}
+as_func_failure () {
+  as_func_return 1
+}
+as_func_ret_success () {
+  return 0
+}
+as_func_ret_failure () {
+  return 1
+}
+
+exitcode=0
+if as_func_success; then
+  :
+else
+  exitcode=1
+  echo as_func_success failed.
+fi
+
+if as_func_failure; then
+  exitcode=1
+  echo as_func_failure succeeded.
+fi
+
+if as_func_ret_success; then
+  :
+else
+  exitcode=1
+  echo as_func_ret_success failed.
+fi
+
+if as_func_ret_failure; then
+  exitcode=1
+  echo as_func_ret_failure succeeded.
+fi
+
+if ( set x; as_func_ret_success y && test x = "$1" ); then
+  :
+else
+  exitcode=1
+  echo positional parameters were not saved.
+fi
+
+test $exitcode = 0) || { (exit 1); exit 1; }
+
+(
   as_lineno_1=$LINENO
   as_lineno_2=$LINENO
-  as_lineno_3=`(expr $as_lineno_1 + 1) 2>/dev/null`
   test "x$as_lineno_1" != "x$as_lineno_2" &&
-  test "x$as_lineno_3"  = "x$as_lineno_2" ') 2>/dev/null; then
-	     $as_unset BASH_ENV || test "${BASH_ENV+set}" != set || { BASH_ENV=; export BASH_ENV; }
-	     $as_unset ENV || test "${ENV+set}" != set || { ENV=; export ENV; }
-	     CONFIG_SHELL=$as_dir/$as_base
-	     export CONFIG_SHELL
-	     exec "$CONFIG_SHELL" "$0" ${1+"$@"}
-	   fi;;
-	 esac
-       done
-done
-;;
-  esac
+  test "x`expr $as_lineno_1 + 1`" = "x$as_lineno_2") || { (exit 1); exit 1; }
+
+_ASEOF
+}; then
+  break
+fi
+
+fi
+
+      done
+
+      if test "x$CONFIG_SHELL" != x; then
+  for as_var in BASH_ENV ENV
+        do ($as_unset $as_var) >/dev/null 2>&1 && $as_unset $as_var
+        done
+        export CONFIG_SHELL
+        exec "$CONFIG_SHELL" "$as_myself" ${1+"$@"}
+fi
+
+
+    if test $as_have_required = no; then
+  echo This script requires a shell more modern than all the
+      echo shells that I found on your system.  Please install a
+      echo modern shell, or manually run the script under such a
+      echo shell if you do have one.
+      { (exit 1); exit 1; }
+fi
+
+
+fi
+
+fi
+
+
+
+(eval "as_func_return () {
+  (exit \$1)
+}
+as_func_success () {
+  as_func_return 0
+}
+as_func_failure () {
+  as_func_return 1
+}
+as_func_ret_success () {
+  return 0
+}
+as_func_ret_failure () {
+  return 1
+}
+
+exitcode=0
+if as_func_success; then
+  :
+else
+  exitcode=1
+  echo as_func_success failed.
+fi
+
+if as_func_failure; then
+  exitcode=1
+  echo as_func_failure succeeded.
+fi
+
+if as_func_ret_success; then
+  :
+else
+  exitcode=1
+  echo as_func_ret_success failed.
+fi
+
+if as_func_ret_failure; then
+  exitcode=1
+  echo as_func_ret_failure succeeded.
+fi
+
+if ( set x; as_func_ret_success y && test x = \"\$1\" ); then
+  :
+else
+  exitcode=1
+  echo positional parameters were not saved.
+fi
+
+test \$exitcode = 0") || {
+  echo No shell found that supports shell functions.
+  echo Please tell autoconf@gnu.org about your system,
+  echo including any error possibly output before this
+  echo message
+}
+
+
+
+  as_lineno_1=$LINENO
+  as_lineno_2=$LINENO
+  test "x$as_lineno_1" != "x$as_lineno_2" &&
+  test "x`expr $as_lineno_1 + 1`" = "x$as_lineno_2" || {
 
   # Create $as_me.lineno as a copy of $as_myself, but with $LINENO
   # uniformly replaced by the line number.  The first 'sed' inserts a
-  # line-number line before each line; the second 'sed' does the real
-  # work.  The second script uses 'N' to pair each line-number line
-  # with the numbered line, and appends trailing '-' during
-  # substitution so that $LINENO is not a special case at line end.
+  # line-number line after each line using $LINENO; the second 'sed'
+  # does the real work.  The second script uses 'N' to pair each
+  # line-number line with the line containing $LINENO, and appends
+  # trailing '-' during substitution so that $LINENO is not a special
+  # case at line end.
   # (Raja R Harinath suggested sed '=', and Paul Eggert wrote the
-  # second 'sed' script.  Blame Lee E. McMahon for sed's syntax.  :-)
-  sed '=' <$as_myself |
+  # scripts with optimization help from Paolo Bonzini.  Blame Lee
+  # E. McMahon (1931-1989) for sed's syntax.  :-)
+  sed -n '
+    p
+    /[$]LINENO/=
+  ' <$as_myself |
     sed '
+      s/[$]LINENO.*/&-/
+      t lineno
+      b
+      :lineno
       N
-      s,$,-,
-      : loop
-      s,^\(['$as_cr_digits']*\)\(.*\)[$]LINENO\([^'$as_cr_alnum'_]\),\1\2\1\3,
+      :loop
+      s/[$]LINENO\([^'$as_cr_alnum'_].*\n\)\(.*\)/\2\1\2/
       t loop
-      s,-$,,
-      s,^['$as_cr_digits']*\n,,
+      s/-\n.*//
     ' >$as_me.lineno &&
-  chmod +x $as_me.lineno ||
+  chmod +x "$as_me.lineno" ||
     { echo "$as_me: error: cannot create $as_me.lineno; rerun with a POSIX shell" >&2
    { (exit 1); exit 1; }; }
 
   # Don't try to exec as it changes $[0], causing all sort of problems
   # (the dirname of $[0] is not the place where we might find the
-  # original and so on.  Autoconf is especially sensible to this).
-  . ./$as_me.lineno
+  # original and so on.  Autoconf is especially sensitive to this).
+  . "./$as_me.lineno"
   # Exit status is that of the last command.
   exit
 }
 
 
-case `echo "testing\c"; echo 1,2,3`,`echo -n testing; echo 1,2,3` in
-  *c*,-n*) ECHO_N= ECHO_C='
-' ECHO_T='	' ;;
-  *c*,*  ) ECHO_N=-n ECHO_C= ECHO_T= ;;
-  *)       ECHO_N= ECHO_C='\c' ECHO_T= ;;
+if (as_dir=`dirname -- /` && test "X$as_dir" = X/) >/dev/null 2>&1; then
+  as_dirname=dirname
+else
+  as_dirname=false
+fi
+
+ECHO_C= ECHO_N= ECHO_T=
+case `echo -n x` in
+-n*)
+  case `echo 'x\c'` in
+  *c*) ECHO_T='	';;	# ECHO_T is single tab character.
+  *)   ECHO_C='\c';;
+  esac;;
+*)
+  ECHO_N='-n';;
 esac
 
-if expr a : '\(a\)' >/dev/null 2>&1; then
+if expr a : '\(a\)' >/dev/null 2>&1 &&
+   test "X`expr 00001 : '.*\(...\)'`" = X001; then
   as_expr=expr
 else
   as_expr=false
 fi
 
 rm -f conf$$ conf$$.exe conf$$.file
+if test -d conf$$.dir; then
+  rm -f conf$$.dir/conf$$.file
+else
+  rm -f conf$$.dir
+  mkdir conf$$.dir
+fi
 echo >conf$$.file
 if ln -s conf$$.file conf$$ 2>/dev/null; then
-  # We could just check for DJGPP; but this test a) works b) is more generic
-  # and c) will remain valid once DJGPP supports symlinks (DJGPP 2.04).
-  if test -f conf$$.exe; then
-    # Don't use ln at all; we don't have any links
+  as_ln_s='ln -s'
+  # ... but there are two gotchas:
+  # 1) On MSYS, both `ln -s file dir' and `ln file dir' fail.
+  # 2) DJGPP < 2.04 has no symlinks; `ln -s' creates a wrapper executable.
+  # In both cases, we have to default to `cp -p'.
+  ln -s conf$$.file conf$$.dir 2>/dev/null && test ! -f conf$$.exe ||
     as_ln_s='cp -p'
-  else
-    as_ln_s='ln -s'
-  fi
 elif ln conf$$.file conf$$ 2>/dev/null; then
   as_ln_s=ln
 else
   as_ln_s='cp -p'
 fi
-rm -f conf$$ conf$$.exe conf$$.file
+rm -f conf$$ conf$$.exe conf$$.dir/conf$$.file conf$$.file
+rmdir conf$$.dir 2>/dev/null
 
 if mkdir -p . 2>/dev/null; then
   as_mkdir_p=:
@@ -224,7 +520,28 @@
   as_mkdir_p=false
 fi
 
-as_executable_p="test -f"
+if test -x / >/dev/null 2>&1; then
+  as_test_x='test -x'
+else
+  if ls -dL / >/dev/null 2>&1; then
+    as_ls_L_option=L
+  else
+    as_ls_L_option=
+  fi
+  as_test_x='
+    eval sh -c '\''
+      if test -d "$1"; then
+        test -d "$1/.";
+      else
+	case $1 in
+        -*)set "./$1";;
+	esac;
+	case `ls -ld'$as_ls_L_option' "$1" 2>/dev/null` in
+	???[sx]*):;;*)false;;esac;fi
+    '\'' sh
+  '
+fi
+as_executable_p=$as_test_x
 
 # Sed expression to map a string onto a valid CPP name.
 as_tr_cpp="eval sed 'y%*$as_cr_letters%P$as_cr_LETTERS%;s%[^_$as_cr_alnum]%_%g'"
@@ -233,86 +550,194 @@
 as_tr_sh="eval sed 'y%*+%pp%;s%[^_$as_cr_alnum]%_%g'"
 
 
-# IFS
-# We need space, tab and new line, in precisely that order.
-as_nl='
-'
-IFS=" 	$as_nl"
-
-# CDPATH.
-$as_unset CDPATH
 
+exec 7<&0 </dev/null 6>&1
 
 # Name of the host.
 # hostname on some systems (SVR3.2, Linux) returns a bogus exit status,
 # so uname gets run too.
 ac_hostname=`(hostname || uname -n) 2>/dev/null | sed 1q`
 
-exec 6>&1
-
 #
 # Initializations.
 #
 ac_default_prefix=/usr/local
+ac_clean_files=
 ac_config_libobj_dir=.
+LIBOBJS=
 cross_compiling=no
 subdirs=
 MFLAGS=
 MAKEFLAGS=
 SHELL=${CONFIG_SHELL-/bin/sh}
 
-# Maximum number of lines to put in a shell here document.
-# This variable seems obsolete.  It should probably be removed, and
-# only ac_max_sed_lines should be used.
-: ${ac_max_here_lines=38}
-
 # Identity of this package.
 PACKAGE_NAME='LCD4Linux'
 PACKAGE_TARNAME='lcd4linux'
-PACKAGE_VERSION='0.10.0'
-PACKAGE_STRING='LCD4Linux 0.10.0'
+PACKAGE_VERSION='0.11.0-SVN'
+PACKAGE_STRING='LCD4Linux 0.11.0-SVN'
 PACKAGE_BUGREPORT='lcd4linux-users@lists.sourceforge.net'
 
 ac_unique_file="lcd4linux.c"
 # Factoring default headers for most tests.
 ac_includes_default="\
 #include <stdio.h>
-#if HAVE_SYS_TYPES_H
+#ifdef HAVE_SYS_TYPES_H
 # include <sys/types.h>
 #endif
-#if HAVE_SYS_STAT_H
+#ifdef HAVE_SYS_STAT_H
 # include <sys/stat.h>
 #endif
-#if STDC_HEADERS
+#ifdef STDC_HEADERS
 # include <stdlib.h>
 # include <stddef.h>
 #else
-# if HAVE_STDLIB_H
+# ifdef HAVE_STDLIB_H
 #  include <stdlib.h>
 # endif
 #endif
-#if HAVE_STRING_H
-# if !STDC_HEADERS && HAVE_MEMORY_H
+#ifdef HAVE_STRING_H
+# if !defined STDC_HEADERS && defined HAVE_MEMORY_H
 #  include <memory.h>
 # endif
 # include <string.h>
 #endif
-#if HAVE_STRINGS_H
+#ifdef HAVE_STRINGS_H
 # include <strings.h>
 #endif
-#if HAVE_INTTYPES_H
+#ifdef HAVE_INTTYPES_H
 # include <inttypes.h>
-#else
-# if HAVE_STDINT_H
-#  include <stdint.h>
-# endif
 #endif
-#if HAVE_UNISTD_H
+#ifdef HAVE_STDINT_H
+# include <stdint.h>
+#endif
+#ifdef HAVE_UNISTD_H
 # include <unistd.h>
 #endif"
 
-ac_subst_vars='SHELL PATH_SEPARATOR PACKAGE_NAME PACKAGE_TARNAME PACKAGE_VERSION PACKAGE_STRING PACKAGE_BUGREPORT exec_prefix prefix program_transform_name bindir sbindir libexecdir datadir sysconfdir sharedstatedir localstatedir libdir includedir oldincludedir infodir mandir build_alias host_alias target_alias DEFS ECHO_C ECHO_N ECHO_T LIBS INSTALL_PROGRAM INSTALL_SCRIPT INSTALL_DATA PACKAGE VERSION ACLOCAL AUTOCONF AUTOMAKE AUTOHEADER MAKEINFO SET_MAKE CC CFLAGS LDFLAGS CPPFLAGS ac_ct_CC EXEEXT OBJEXT CPP LN_S CURSES_LIBS CURSES_INCLUDEDIR EGREP X_CFLAGS X_PRE_LIBS X_LIBS X_EXTRA_LIBS DRIVERS DRVLIBS PLUGINS PLUGINLIBS LIBOBJS POW_LIB LTLIBOBJS'
+ac_subst_vars='SHELL
+PATH_SEPARATOR
+PACKAGE_NAME
+PACKAGE_TARNAME
+PACKAGE_VERSION
+PACKAGE_STRING
+PACKAGE_BUGREPORT
+exec_prefix
+prefix
+program_transform_name
+bindir
+sbindir
+libexecdir
+datarootdir
+datadir
+sysconfdir
+sharedstatedir
+localstatedir
+includedir
+oldincludedir
+docdir
+infodir
+htmldir
+dvidir
+pdfdir
+psdir
+libdir
+localedir
+mandir
+DEFS
+ECHO_C
+ECHO_N
+ECHO_T
+LIBS
+build_alias
+host_alias
+target_alias
+INSTALL_PROGRAM
+INSTALL_SCRIPT
+INSTALL_DATA
+am__isrc
+CYGPATH_W
+PACKAGE
+VERSION
+ACLOCAL
+AUTOCONF
+AUTOMAKE
+AUTOHEADER
+MAKEINFO
+install_sh
+STRIP
+INSTALL_STRIP_PROGRAM
+mkdir_p
+AWK
+SET_MAKE
+am__leading_dot
+AMTAR
+am__tar
+am__untar
+CC
+CFLAGS
+LDFLAGS
+CPPFLAGS
+ac_ct_CC
+EXEEXT
+OBJEXT
+DEPDIR
+am__include
+am__quote
+AMDEP_TRUE
+AMDEP_FALSE
+AMDEPBACKSLASH
+CCDEPMODE
+am__fastdepCC_TRUE
+am__fastdepCC_FALSE
+CPP
+LN_S
+CURSES_LIBS
+CURSES_INCLUDEDIR
+GREP
+EGREP
+XMKMF
+X_CFLAGS
+X_PRE_LIBS
+X_LIBS
+X_EXTRA_LIBS
+PYTHON_VERSION
+PYTHON
+PYTHON_CPPFLAGS
+PYTHON_LDFLAGS
+PYTHON_SITE_PKG
+PYTHON_EXTRA_LIBS
+PYTHON_EXTRA_LDFLAGS
+DRIVERS
+DRVLIBS
+build
+build_cpu
+build_vendor
+build_os
+host
+host_cpu
+host_vendor
+host_os
+LIBICONV
+LTLIBICONV
+PLUGINS
+PLUGINLIBS
+LIBOBJS
+POW_LIB
+LTLIBOBJS'
 ac_subst_files=''
+      ac_precious_vars='build_alias
+host_alias
+target_alias
+CC
+CFLAGS
+LDFLAGS
+LIBS
+CPPFLAGS
+CPP
+XMKMF
+PYTHON_VERSION'
+
 
 # Initialize some variables set by options.
 ac_init_help=
@@ -339,34 +764,48 @@
 # and all the variables that are supposed to be based on exec_prefix
 # by default will actually change.
 # Use braces instead of parens because sh, perl, etc. also accept them.
+# (The list follows the same order as the GNU Coding Standards.)
 bindir='${exec_prefix}/bin'
 sbindir='${exec_prefix}/sbin'
 libexecdir='${exec_prefix}/libexec'
-datadir='${prefix}/share'
+datarootdir='${prefix}/share'
+datadir='${datarootdir}'
 sysconfdir='${prefix}/etc'
 sharedstatedir='${prefix}/com'
 localstatedir='${prefix}/var'
-libdir='${exec_prefix}/lib'
 includedir='${prefix}/include'
 oldincludedir='/usr/include'
-infodir='${prefix}/info'
-mandir='${prefix}/man'
+docdir='${datarootdir}/doc/${PACKAGE_TARNAME}'
+infodir='${datarootdir}/info'
+htmldir='${docdir}'
+dvidir='${docdir}'
+pdfdir='${docdir}'
+psdir='${docdir}'
+libdir='${exec_prefix}/lib'
+localedir='${datarootdir}/locale'
+mandir='${datarootdir}/man'
 
 ac_prev=
+ac_dashdash=
 for ac_option
 do
   # If the previous option needs an argument, assign it.
   if test -n "$ac_prev"; then
-    eval "$ac_prev=\$ac_option"
+    eval $ac_prev=\$ac_option
     ac_prev=
     continue
   fi
 
-  ac_optarg=`expr "x$ac_option" : 'x[^=]*=\(.*\)'`
+  case $ac_option in
+  *=*)	ac_optarg=`expr "X$ac_option" : '[^=]*=\(.*\)'` ;;
+  *)	ac_optarg=yes ;;
+  esac
 
   # Accept the important Cygnus configure options, so we can diagnose typos.
 
-  case $ac_option in
+  case $ac_dashdash$ac_option in
+  --)
+    ac_dashdash=yes ;;
 
   -bindir | --bindir | --bindi | --bind | --bin | --bi)
     ac_prev=bindir ;;
@@ -388,33 +827,45 @@
   --config-cache | -C)
     cache_file=config.cache ;;
 
-  -datadir | --datadir | --datadi | --datad | --data | --dat | --da)
+  -datadir | --datadir | --datadi | --datad)
     ac_prev=datadir ;;
-  -datadir=* | --datadir=* | --datadi=* | --datad=* | --data=* | --dat=* \
-  | --da=*)
+  -datadir=* | --datadir=* | --datadi=* | --datad=*)
     datadir=$ac_optarg ;;
 
+  -datarootdir | --datarootdir | --datarootdi | --datarootd | --dataroot \
+  | --dataroo | --dataro | --datar)
+    ac_prev=datarootdir ;;
+  -datarootdir=* | --datarootdir=* | --datarootdi=* | --datarootd=* \
+  | --dataroot=* | --dataroo=* | --dataro=* | --datar=*)
+    datarootdir=$ac_optarg ;;
+
   -disable-* | --disable-*)
     ac_feature=`expr "x$ac_option" : 'x-*disable-\(.*\)'`
     # Reject names that are not valid shell variable names.
-    expr "x$ac_feature" : ".*[^-_$as_cr_alnum]" >/dev/null &&
+    expr "x$ac_feature" : ".*[^-._$as_cr_alnum]" >/dev/null &&
       { echo "$as_me: error: invalid feature name: $ac_feature" >&2
    { (exit 1); exit 1; }; }
-    ac_feature=`echo $ac_feature | sed 's/-/_/g'`
-    eval "enable_$ac_feature=no" ;;
+    ac_feature=`echo $ac_feature | sed 's/[-.]/_/g'`
+    eval enable_$ac_feature=no ;;
+
+  -docdir | --docdir | --docdi | --doc | --do)
+    ac_prev=docdir ;;
+  -docdir=* | --docdir=* | --docdi=* | --doc=* | --do=*)
+    docdir=$ac_optarg ;;
+
+  -dvidir | --dvidir | --dvidi | --dvid | --dvi | --dv)
+    ac_prev=dvidir ;;
+  -dvidir=* | --dvidir=* | --dvidi=* | --dvid=* | --dvi=* | --dv=*)
+    dvidir=$ac_optarg ;;
 
   -enable-* | --enable-*)
     ac_feature=`expr "x$ac_option" : 'x-*enable-\([^=]*\)'`
     # Reject names that are not valid shell variable names.
-    expr "x$ac_feature" : ".*[^-_$as_cr_alnum]" >/dev/null &&
+    expr "x$ac_feature" : ".*[^-._$as_cr_alnum]" >/dev/null &&
       { echo "$as_me: error: invalid feature name: $ac_feature" >&2
    { (exit 1); exit 1; }; }
-    ac_feature=`echo $ac_feature | sed 's/-/_/g'`
-    case $ac_option in
-      *=*) ac_optarg=`echo "$ac_optarg" | sed "s/'/'\\\\\\\\''/g"`;;
-      *) ac_optarg=yes ;;
-    esac
-    eval "enable_$ac_feature='$ac_optarg'" ;;
+    ac_feature=`echo $ac_feature | sed 's/[-.]/_/g'`
+    eval enable_$ac_feature=\$ac_optarg ;;
 
   -exec-prefix | --exec_prefix | --exec-prefix | --exec-prefi \
   | --exec-pref | --exec-pre | --exec-pr | --exec-p | --exec- \
@@ -441,6 +892,12 @@
   -host=* | --host=* | --hos=* | --ho=*)
     host_alias=$ac_optarg ;;
 
+  -htmldir | --htmldir | --htmldi | --htmld | --html | --htm | --ht)
+    ac_prev=htmldir ;;
+  -htmldir=* | --htmldir=* | --htmldi=* | --htmld=* | --html=* | --htm=* \
+  | --ht=*)
+    htmldir=$ac_optarg ;;
+
   -includedir | --includedir | --includedi | --included | --include \
   | --includ | --inclu | --incl | --inc)
     ac_prev=includedir ;;
@@ -465,13 +922,16 @@
   | --libexe=* | --libex=* | --libe=*)
     libexecdir=$ac_optarg ;;
 
+  -localedir | --localedir | --localedi | --localed | --locale)
+    ac_prev=localedir ;;
+  -localedir=* | --localedir=* | --localedi=* | --localed=* | --locale=*)
+    localedir=$ac_optarg ;;
+
   -localstatedir | --localstatedir | --localstatedi | --localstated \
-  | --localstate | --localstat | --localsta | --localst \
-  | --locals | --local | --loca | --loc | --lo)
+  | --localstate | --localstat | --localsta | --localst | --locals)
     ac_prev=localstatedir ;;
   -localstatedir=* | --localstatedir=* | --localstatedi=* | --localstated=* \
-  | --localstate=* | --localstat=* | --localsta=* | --localst=* \
-  | --locals=* | --local=* | --loca=* | --loc=* | --lo=*)
+  | --localstate=* | --localstat=* | --localsta=* | --localst=* | --locals=*)
     localstatedir=$ac_optarg ;;
 
   -mandir | --mandir | --mandi | --mand | --man | --ma | --m)
@@ -536,6 +996,16 @@
   | --progr-tra=* | --program-tr=* | --program-t=*)
     program_transform_name=$ac_optarg ;;
 
+  -pdfdir | --pdfdir | --pdfdi | --pdfd | --pdf | --pd)
+    ac_prev=pdfdir ;;
+  -pdfdir=* | --pdfdir=* | --pdfdi=* | --pdfd=* | --pdf=* | --pd=*)
+    pdfdir=$ac_optarg ;;
+
+  -psdir | --psdir | --psdi | --psd | --ps)
+    ac_prev=psdir ;;
+  -psdir=* | --psdir=* | --psdi=* | --psd=* | --ps=*)
+    psdir=$ac_optarg ;;
+
   -q | -quiet | --quiet | --quie | --qui | --qu | --q \
   | -silent | --silent | --silen | --sile | --sil)
     silent=yes ;;
@@ -588,24 +1058,20 @@
   -with-* | --with-*)
     ac_package=`expr "x$ac_option" : 'x-*with-\([^=]*\)'`
     # Reject names that are not valid shell variable names.
-    expr "x$ac_package" : ".*[^-_$as_cr_alnum]" >/dev/null &&
+    expr "x$ac_package" : ".*[^-._$as_cr_alnum]" >/dev/null &&
       { echo "$as_me: error: invalid package name: $ac_package" >&2
    { (exit 1); exit 1; }; }
-    ac_package=`echo $ac_package| sed 's/-/_/g'`
-    case $ac_option in
-      *=*) ac_optarg=`echo "$ac_optarg" | sed "s/'/'\\\\\\\\''/g"`;;
-      *) ac_optarg=yes ;;
-    esac
-    eval "with_$ac_package='$ac_optarg'" ;;
+    ac_package=`echo $ac_package | sed 's/[-.]/_/g'`
+    eval with_$ac_package=\$ac_optarg ;;
 
   -without-* | --without-*)
     ac_package=`expr "x$ac_option" : 'x-*without-\(.*\)'`
     # Reject names that are not valid shell variable names.
-    expr "x$ac_package" : ".*[^-_$as_cr_alnum]" >/dev/null &&
+    expr "x$ac_package" : ".*[^-._$as_cr_alnum]" >/dev/null &&
       { echo "$as_me: error: invalid package name: $ac_package" >&2
    { (exit 1); exit 1; }; }
-    ac_package=`echo $ac_package | sed 's/-/_/g'`
-    eval "with_$ac_package=no" ;;
+    ac_package=`echo $ac_package | sed 's/[-.]/_/g'`
+    eval with_$ac_package=no ;;
 
   --x)
     # Obsolete; use --with-x.
@@ -636,8 +1102,7 @@
     expr "x$ac_envvar" : ".*[^_$as_cr_alnum]" >/dev/null &&
       { echo "$as_me: error: invalid variable name: $ac_envvar" >&2
    { (exit 1); exit 1; }; }
-    ac_optarg=`echo "$ac_optarg" | sed "s/'/'\\\\\\\\''/g"`
-    eval "$ac_envvar='$ac_optarg'"
+    eval $ac_envvar=\$ac_optarg
     export $ac_envvar ;;
 
   *)
@@ -657,27 +1122,19 @@
    { (exit 1); exit 1; }; }
 fi
 
-# Be sure to have absolute paths.
-for ac_var in exec_prefix prefix
-do
-  eval ac_val=$`echo $ac_var`
-  case $ac_val in
-    [\\/$]* | ?:[\\/]* | NONE | '' ) ;;
-    *)  { echo "$as_me: error: expected an absolute directory name for --$ac_var: $ac_val" >&2
-   { (exit 1); exit 1; }; };;
-  esac
-done
-
-# Be sure to have absolute paths.
-for ac_var in bindir sbindir libexecdir datadir sysconfdir sharedstatedir \
-	      localstatedir libdir includedir oldincludedir infodir mandir
+# Be sure to have absolute directory names.
+for ac_var in	exec_prefix prefix bindir sbindir libexecdir datarootdir \
+		datadir sysconfdir sharedstatedir localstatedir includedir \
+		oldincludedir docdir infodir htmldir dvidir pdfdir psdir \
+		libdir localedir mandir
 do
-  eval ac_val=$`echo $ac_var`
+  eval ac_val=\$$ac_var
   case $ac_val in
-    [\\/$]* | ?:[\\/]* ) ;;
-    *)  { echo "$as_me: error: expected an absolute directory name for --$ac_var: $ac_val" >&2
-   { (exit 1); exit 1; }; };;
+    [\\/$]* | ?:[\\/]* )  continue;;
+    NONE | '' ) case $ac_var in *prefix ) continue;; esac;;
   esac
+  { echo "$as_me: error: expected an absolute directory name for --$ac_var: $ac_val" >&2
+   { (exit 1); exit 1; }; }
 done
 
 # There might be people who depend on the old broken behavior: `$host'
@@ -704,74 +1161,76 @@
 test "$silent" = yes && exec 6>/dev/null
 
 
+ac_pwd=`pwd` && test -n "$ac_pwd" &&
+ac_ls_di=`ls -di .` &&
+ac_pwd_ls_di=`cd "$ac_pwd" && ls -di .` ||
+  { echo "$as_me: error: Working directory cannot be determined" >&2
+   { (exit 1); exit 1; }; }
+test "X$ac_ls_di" = "X$ac_pwd_ls_di" ||
+  { echo "$as_me: error: pwd does not report name of working directory" >&2
+   { (exit 1); exit 1; }; }
+
+
 # Find the source files, if location was not specified.
 if test -z "$srcdir"; then
   ac_srcdir_defaulted=yes
-  # Try the directory containing this script, then its parent.
-  ac_confdir=`(dirname "$0") 2>/dev/null ||
+  # Try the directory containing this script, then the parent directory.
+  ac_confdir=`$as_dirname -- "$0" ||
 $as_expr X"$0" : 'X\(.*[^/]\)//*[^/][^/]*/*$' \| \
 	 X"$0" : 'X\(//\)[^/]' \| \
 	 X"$0" : 'X\(//\)$' \| \
-	 X"$0" : 'X\(/\)' \| \
-	 .     : '\(.\)' 2>/dev/null ||
+	 X"$0" : 'X\(/\)' \| . 2>/dev/null ||
 echo X"$0" |
-    sed '/^X\(.*[^/]\)\/\/*[^/][^/]*\/*$/{ s//\1/; q; }
-  	  /^X\(\/\/\)[^/].*/{ s//\1/; q; }
-  	  /^X\(\/\/\)$/{ s//\1/; q; }
-  	  /^X\(\/\).*/{ s//\1/; q; }
-  	  s/.*/./; q'`
+    sed '/^X\(.*[^/]\)\/\/*[^/][^/]*\/*$/{
+	    s//\1/
+	    q
+	  }
+	  /^X\(\/\/\)[^/].*/{
+	    s//\1/
+	    q
+	  }
+	  /^X\(\/\/\)$/{
+	    s//\1/
+	    q
+	  }
+	  /^X\(\/\).*/{
+	    s//\1/
+	    q
+	  }
+	  s/.*/./; q'`
   srcdir=$ac_confdir
-  if test ! -r $srcdir/$ac_unique_file; then
+  if test ! -r "$srcdir/$ac_unique_file"; then
     srcdir=..
   fi
 else
   ac_srcdir_defaulted=no
 fi
-if test ! -r $srcdir/$ac_unique_file; then
-  if test "$ac_srcdir_defaulted" = yes; then
-    { echo "$as_me: error: cannot find sources ($ac_unique_file) in $ac_confdir or .." >&2
+if test ! -r "$srcdir/$ac_unique_file"; then
+  test "$ac_srcdir_defaulted" = yes && srcdir="$ac_confdir or .."
+  { echo "$as_me: error: cannot find sources ($ac_unique_file) in $srcdir" >&2
    { (exit 1); exit 1; }; }
-  else
-    { echo "$as_me: error: cannot find sources ($ac_unique_file) in $srcdir" >&2
+fi
+ac_msg="sources are in $srcdir, but \`cd $srcdir' does not work"
+ac_abs_confdir=`(
+	cd "$srcdir" && test -r "./$ac_unique_file" || { echo "$as_me: error: $ac_msg" >&2
    { (exit 1); exit 1; }; }
-  fi
-fi
-(cd $srcdir && test -r ./$ac_unique_file) 2>/dev/null ||
-  { echo "$as_me: error: sources are in $srcdir, but \`cd $srcdir' does not work" >&2
-   { (exit 1); exit 1; }; }
-srcdir=`echo "$srcdir" | sed 's%\([^\\/]\)[\\/]*$%\1%'`
-ac_env_build_alias_set=${build_alias+set}
-ac_env_build_alias_value=$build_alias
-ac_cv_env_build_alias_set=${build_alias+set}
-ac_cv_env_build_alias_value=$build_alias
-ac_env_host_alias_set=${host_alias+set}
-ac_env_host_alias_value=$host_alias
-ac_cv_env_host_alias_set=${host_alias+set}
-ac_cv_env_host_alias_value=$host_alias
-ac_env_target_alias_set=${target_alias+set}
-ac_env_target_alias_value=$target_alias
-ac_cv_env_target_alias_set=${target_alias+set}
-ac_cv_env_target_alias_value=$target_alias
-ac_env_CC_set=${CC+set}
-ac_env_CC_value=$CC
-ac_cv_env_CC_set=${CC+set}
-ac_cv_env_CC_value=$CC
-ac_env_CFLAGS_set=${CFLAGS+set}
-ac_env_CFLAGS_value=$CFLAGS
-ac_cv_env_CFLAGS_set=${CFLAGS+set}
-ac_cv_env_CFLAGS_value=$CFLAGS
-ac_env_LDFLAGS_set=${LDFLAGS+set}
-ac_env_LDFLAGS_value=$LDFLAGS
-ac_cv_env_LDFLAGS_set=${LDFLAGS+set}
-ac_cv_env_LDFLAGS_value=$LDFLAGS
-ac_env_CPPFLAGS_set=${CPPFLAGS+set}
-ac_env_CPPFLAGS_value=$CPPFLAGS
-ac_cv_env_CPPFLAGS_set=${CPPFLAGS+set}
-ac_cv_env_CPPFLAGS_value=$CPPFLAGS
-ac_env_CPP_set=${CPP+set}
-ac_env_CPP_value=$CPP
-ac_cv_env_CPP_set=${CPP+set}
-ac_cv_env_CPP_value=$CPP
+	pwd)`
+# When building in place, set srcdir=.
+if test "$ac_abs_confdir" = "$ac_pwd"; then
+  srcdir=.
+fi
+# Remove unnecessary trailing slashes from srcdir.
+# Double slashes in file names in object file debugging info
+# mess up M-x gdb in Emacs.
+case $srcdir in
+*/) srcdir=`expr "X$srcdir" : 'X\(.*[^/]\)' \| "X$srcdir" : 'X\(.*\)'`;;
+esac
+for ac_var in $ac_precious_vars; do
+  eval ac_env_${ac_var}_set=\${${ac_var}+set}
+  eval ac_env_${ac_var}_value=\$${ac_var}
+  eval ac_cv_env_${ac_var}_set=\${${ac_var}+set}
+  eval ac_cv_env_${ac_var}_value=\$${ac_var}
+done
 
 #
 # Report the --help message.
@@ -780,7 +1239,7 @@
   # Omit some internal or obsolete options to make the list less imposing.
   # This message is too long to be a string in the A/UX 3.1 sh.
   cat <<_ACEOF
-\`configure' configures LCD4Linux 0.10.0 to adapt to many kinds of systems.
+\`configure' configures LCD4Linux 0.11.0-SVN to adapt to many kinds of systems.
 
 Usage: $0 [OPTION]... [VAR=VALUE]...
 
@@ -800,9 +1259,6 @@
   -n, --no-create         do not create output files
       --srcdir=DIR        find the sources in DIR [configure dir or \`..']
 
-_ACEOF
-
-  cat <<_ACEOF
 Installation directories:
   --prefix=PREFIX         install architecture-independent files in PREFIX
 			  [$ac_default_prefix]
@@ -820,15 +1276,22 @@
   --bindir=DIR           user executables [EPREFIX/bin]
   --sbindir=DIR          system admin executables [EPREFIX/sbin]
   --libexecdir=DIR       program executables [EPREFIX/libexec]
-  --datadir=DIR          read-only architecture-independent data [PREFIX/share]
   --sysconfdir=DIR       read-only single-machine data [PREFIX/etc]
   --sharedstatedir=DIR   modifiable architecture-independent data [PREFIX/com]
   --localstatedir=DIR    modifiable single-machine data [PREFIX/var]
   --libdir=DIR           object code libraries [EPREFIX/lib]
   --includedir=DIR       C header files [PREFIX/include]
   --oldincludedir=DIR    C header files for non-gcc [/usr/include]
-  --infodir=DIR          info documentation [PREFIX/info]
-  --mandir=DIR           man documentation [PREFIX/man]
+  --datarootdir=DIR      read-only arch.-independent data root [PREFIX/share]
+  --datadir=DIR          read-only architecture-independent data [DATAROOTDIR]
+  --infodir=DIR          info documentation [DATAROOTDIR/info]
+  --localedir=DIR        locale-dependent data [DATAROOTDIR/locale]
+  --mandir=DIR           man documentation [DATAROOTDIR/man]
+  --docdir=DIR           documentation root [DATAROOTDIR/doc/lcd4linux]
+  --htmldir=DIR          html documentation [DOCDIR]
+  --dvidir=DIR           dvi documentation [DOCDIR]
+  --pdfdir=DIR           pdf documentation [DOCDIR]
+  --psdir=DIR            ps documentation [DOCDIR]
 _ACEOF
 
   cat <<\_ACEOF
@@ -841,20 +1304,31 @@
 X features:
   --x-includes=DIR    X include files are in DIR
   --x-libraries=DIR   X library files are in DIR
+
+System types:
+  --build=BUILD     configure for building on BUILD [guessed]
+  --host=HOST       cross-compile to build programs to run on HOST [BUILD]
 _ACEOF
 fi
 
 if test -n "$ac_init_help"; then
   case $ac_init_help in
-     short | recursive ) echo "Configuration of LCD4Linux 0.10.0:";;
+     short | recursive ) echo "Configuration of LCD4Linux 0.11.0-SVN:";;
    esac
   cat <<\_ACEOF
 
+Optional Features:
+  --disable-FEATURE       do not include FEATURE (same as --enable-FEATURE=no)
+  --enable-FEATURE[=ARG]  include FEATURE [ARG=yes]
+  --disable-dependency-tracking  speeds up one-time build
+  --enable-dependency-tracking   do not reject slow dependency extractors
+  --disable-rpath         do not hardcode runtime library paths
+
 Optional Packages:
   --with-PACKAGE[=ARG]    use PACKAGE [ARG=yes]
   --without-PACKAGE       do not use PACKAGE (same as --with-PACKAGE=no)
   --with-dmalloc          use dmalloc, as in
-                          ftp://ftp.letters.com/src/dmalloc/dmalloc.tar.gz
+			  http://www.dmalloc.com/dmalloc.tar.gz
   --with-sco              Use this to turn on SCO-specific code
   --with-sunos-curses     Used to force SunOS 4.x curses
   --with-osf1-curses      Used to force OSF/1 curses
@@ -868,143 +1342,121 @@
                           drivers may be excluded with 'all,!<driver>',
                           (try 'all,\!<driver>' if your shell complains...)
                           possible drivers are:
-                          BeckmannEgle, BWCT, CrystalFontz, Curses, Cwlinux,
-                          HD44780, LCDLinux, LCDTerm, M50530, MatrixOrbital,
-                          MilfordInstruments, Noritake, NULL, PNG, PPM,
-                          RouterBoard, serdisplib, SimpleLCD, T6963, Trefon,
-                          USBLCD, X11
+                          BeckmannEgle, BWCT, CrystalFontz, Curses, Cwlinux, D4D,
+                          G15, HD44780, IRLCD, LCD2USB LCDLinux, LCDTerm, LPH7508,
+                          LUIse, M50530, MatrixOrbital, MilfordInstruments, Noritake,
+                          NULL, PNG, PPM, Pertelian, PHAnderson, picoLCD, picoLCDGraphic,
+                          RouterBoard, Sample, serdisplib, SimpleLCD, st2205, T6963, Trefon,
+                          ULA200, USBLCD, USBHUB, WincorNixdorf, X11
   --with-plugins=<list>   choose which plugins to compile.
                           type --with-plugins=list for a list
                           of avaible plugins
+                          plugins may be excluded with 'all,!<plugin>',
+                          (try 'all,\!<plugin>' if your shell complains...)
+  --with-gnu-ld           assume the C compiler uses GNU ld default=no
+  --with-libiconv-prefix[=DIR]  search for libiconv in DIR/include and DIR/lib
+  --without-libiconv-prefix     don't search for libiconv in includedir and libdir
 
 Some influential environment variables:
   CC          C compiler command
   CFLAGS      C compiler flags
   LDFLAGS     linker flags, e.g. -L<lib dir> if you have libraries in a
               nonstandard directory <lib dir>
-  CPPFLAGS    C/C++ preprocessor flags, e.g. -I<include dir> if you have
-              headers in a nonstandard directory <include dir>
+  LIBS        libraries to pass to the linker, e.g. -l<library>
+  CPPFLAGS    C/C++/Objective C preprocessor flags, e.g. -I<include dir> if
+              you have headers in a nonstandard directory <include dir>
   CPP         C preprocessor
+  XMKMF       Path to xmkmf, Makefile generator for X Window System
+  PYTHON_VERSION
+              The installed Python version to use, for example '2.3'. This
+              string will be appended to the Python interpreter canonical
+              name.
 
 Use these variables to override the choices made by `configure' or to help
 it to find libraries and programs with nonstandard names/locations.
 
 Report bugs to <lcd4linux-users@lists.sourceforge.net>.
 _ACEOF
+ac_status=$?
 fi
 
 if test "$ac_init_help" = "recursive"; then
   # If there are subdirs, report their specific --help.
-  ac_popdir=`pwd`
   for ac_dir in : $ac_subdirs_all; do test "x$ac_dir" = x: && continue
-    test -d $ac_dir || continue
+    test -d "$ac_dir" || continue
     ac_builddir=.
 
-if test "$ac_dir" != .; then
+case "$ac_dir" in
+.) ac_dir_suffix= ac_top_builddir_sub=. ac_top_build_prefix= ;;
+*)
   ac_dir_suffix=/`echo "$ac_dir" | sed 's,^\.[\\/],,'`
-  # A "../" for each directory in $ac_dir_suffix.
-  ac_top_builddir=`echo "$ac_dir_suffix" | sed 's,/[^\\/]*,../,g'`
-else
-  ac_dir_suffix= ac_top_builddir=
-fi
+  # A ".." for each directory in $ac_dir_suffix.
+  ac_top_builddir_sub=`echo "$ac_dir_suffix" | sed 's,/[^\\/]*,/..,g;s,/,,'`
+  case $ac_top_builddir_sub in
+  "") ac_top_builddir_sub=. ac_top_build_prefix= ;;
+  *)  ac_top_build_prefix=$ac_top_builddir_sub/ ;;
+  esac ;;
+esac
+ac_abs_top_builddir=$ac_pwd
+ac_abs_builddir=$ac_pwd$ac_dir_suffix
+# for backward compatibility:
+ac_top_builddir=$ac_top_build_prefix
 
 case $srcdir in
-  .)  # No --srcdir option.  We are building in place.
+  .)  # We are building in place.
     ac_srcdir=.
-    if test -z "$ac_top_builddir"; then
-       ac_top_srcdir=.
-    else
-       ac_top_srcdir=`echo $ac_top_builddir | sed 's,/$,,'`
-    fi ;;
-  [\\/]* | ?:[\\/]* )  # Absolute path.
+    ac_top_srcdir=$ac_top_builddir_sub
+    ac_abs_top_srcdir=$ac_pwd ;;
+  [\\/]* | ?:[\\/]* )  # Absolute name.
     ac_srcdir=$srcdir$ac_dir_suffix;
-    ac_top_srcdir=$srcdir ;;
-  *) # Relative path.
-    ac_srcdir=$ac_top_builddir$srcdir$ac_dir_suffix
-    ac_top_srcdir=$ac_top_builddir$srcdir ;;
+    ac_top_srcdir=$srcdir
+    ac_abs_top_srcdir=$srcdir ;;
+  *) # Relative name.
+    ac_srcdir=$ac_top_build_prefix$srcdir$ac_dir_suffix
+    ac_top_srcdir=$ac_top_build_prefix$srcdir
+    ac_abs_top_srcdir=$ac_pwd/$srcdir ;;
 esac
+ac_abs_srcdir=$ac_abs_top_srcdir$ac_dir_suffix
 
-# Do not use `cd foo && pwd` to compute absolute paths, because
-# the directories may not exist.
-case `pwd` in
-.) ac_abs_builddir="$ac_dir";;
-*)
-  case "$ac_dir" in
-  .) ac_abs_builddir=`pwd`;;
-  [\\/]* | ?:[\\/]* ) ac_abs_builddir="$ac_dir";;
-  *) ac_abs_builddir=`pwd`/"$ac_dir";;
-  esac;;
-esac
-case $ac_abs_builddir in
-.) ac_abs_top_builddir=${ac_top_builddir}.;;
-*)
-  case ${ac_top_builddir}. in
-  .) ac_abs_top_builddir=$ac_abs_builddir;;
-  [\\/]* | ?:[\\/]* ) ac_abs_top_builddir=${ac_top_builddir}.;;
-  *) ac_abs_top_builddir=$ac_abs_builddir/${ac_top_builddir}.;;
-  esac;;
-esac
-case $ac_abs_builddir in
-.) ac_abs_srcdir=$ac_srcdir;;
-*)
-  case $ac_srcdir in
-  .) ac_abs_srcdir=$ac_abs_builddir;;
-  [\\/]* | ?:[\\/]* ) ac_abs_srcdir=$ac_srcdir;;
-  *) ac_abs_srcdir=$ac_abs_builddir/$ac_srcdir;;
-  esac;;
-esac
-case $ac_abs_builddir in
-.) ac_abs_top_srcdir=$ac_top_srcdir;;
-*)
-  case $ac_top_srcdir in
-  .) ac_abs_top_srcdir=$ac_abs_builddir;;
-  [\\/]* | ?:[\\/]* ) ac_abs_top_srcdir=$ac_top_srcdir;;
-  *) ac_abs_top_srcdir=$ac_abs_builddir/$ac_top_srcdir;;
-  esac;;
-esac
-
-    cd $ac_dir
-    # Check for guested configure; otherwise get Cygnus style configure.
-    if test -f $ac_srcdir/configure.gnu; then
-      echo
-      $SHELL $ac_srcdir/configure.gnu  --help=recursive
-    elif test -f $ac_srcdir/configure; then
-      echo
-      $SHELL $ac_srcdir/configure  --help=recursive
-    elif test -f $ac_srcdir/configure.ac ||
-	   test -f $ac_srcdir/configure.in; then
-      echo
-      $ac_configure --help
+    cd "$ac_dir" || { ac_status=$?; continue; }
+    # Check for guested configure.
+    if test -f "$ac_srcdir/configure.gnu"; then
+      echo &&
+      $SHELL "$ac_srcdir/configure.gnu" --help=recursive
+    elif test -f "$ac_srcdir/configure"; then
+      echo &&
+      $SHELL "$ac_srcdir/configure" --help=recursive
     else
       echo "$as_me: WARNING: no configuration information is in $ac_dir" >&2
-    fi
-    cd "$ac_popdir"
+    fi || ac_status=$?
+    cd "$ac_pwd" || { ac_status=$?; break; }
   done
 fi
 
-test -n "$ac_init_help" && exit 0
+test -n "$ac_init_help" && exit $ac_status
 if $ac_init_version; then
   cat <<\_ACEOF
-LCD4Linux configure 0.10.0
-generated by GNU Autoconf 2.59
+LCD4Linux configure 0.11.0-SVN
+generated by GNU Autoconf 2.61
 
-Copyright (C) 2003 Free Software Foundation, Inc.
+Copyright (C) 1992, 1993, 1994, 1995, 1996, 1998, 1999, 2000, 2001,
+2002, 2003, 2004, 2005, 2006 Free Software Foundation, Inc.
 This configure script is free software; the Free Software Foundation
 gives unlimited permission to copy, distribute and modify it.
 _ACEOF
-  exit 0
+  exit
 fi
-exec 5>config.log
-cat >&5 <<_ACEOF
+cat >config.log <<_ACEOF
 This file contains any messages produced by compilers while
 running configure, to aid debugging if configure makes a mistake.
 
-It was created by LCD4Linux $as_me 0.10.0, which was
-generated by GNU Autoconf 2.59.  Invocation command line was
+It was created by LCD4Linux $as_me 0.11.0-SVN, which was
+generated by GNU Autoconf 2.61.  Invocation command line was
 
   $ $0 $@
 
 _ACEOF
+exec 5>>config.log
 {
 cat <<_ASUNAME
 ## --------- ##
@@ -1023,7 +1475,7 @@
 /bin/arch              = `(/bin/arch) 2>/dev/null              || echo unknown`
 /usr/bin/arch -k       = `(/usr/bin/arch -k) 2>/dev/null       || echo unknown`
 /usr/convex/getsysinfo = `(/usr/convex/getsysinfo) 2>/dev/null || echo unknown`
-hostinfo               = `(hostinfo) 2>/dev/null               || echo unknown`
+/usr/bin/hostinfo      = `(/usr/bin/hostinfo) 2>/dev/null      || echo unknown`
 /bin/machine           = `(/bin/machine) 2>/dev/null           || echo unknown`
 /usr/bin/oslevel       = `(/usr/bin/oslevel) 2>/dev/null       || echo unknown`
 /bin/universe          = `(/bin/universe) 2>/dev/null          || echo unknown`
@@ -1037,6 +1489,7 @@
   test -z "$as_dir" && as_dir=.
   echo "PATH: $as_dir"
 done
+IFS=$as_save_IFS
 
 } >&5
 
@@ -1058,7 +1511,6 @@
 ac_configure_args=
 ac_configure_args0=
 ac_configure_args1=
-ac_sep=
 ac_must_keep_next=false
 for ac_pass in 1 2
 do
@@ -1069,7 +1521,7 @@
     -q | -quiet | --quiet | --quie | --qui | --qu | --q \
     | -silent | --silent | --silen | --sile | --sil)
       continue ;;
-    *" "*|*"	"*|*[\[\]\~\#\$\^\&\*\(\)\{\}\\\|\;\<\>\?\"\']*)
+    *\'*)
       ac_arg=`echo "$ac_arg" | sed "s/'/'\\\\\\\\''/g"` ;;
     esac
     case $ac_pass in
@@ -1091,9 +1543,7 @@
 	  -* ) ac_must_keep_next=true ;;
 	esac
       fi
-      ac_configure_args="$ac_configure_args$ac_sep'$ac_arg'"
-      # Get rid of the leading space.
-      ac_sep=" "
+      ac_configure_args="$ac_configure_args '$ac_arg'"
       ;;
     esac
   done
@@ -1104,8 +1554,8 @@
 # When interrupted or exit'd, cleanup temporary files, and complete
 # config.log.  We remove comments because anyway the quotes in there
 # would cause problems or look ugly.
-# WARNING: Be sure not to use single quotes in there, as some shells,
-# such as our DU 5.0 friend, will then `close' the trap.
+# WARNING: Use '\'' to represent an apostrophe within the trap.
+# WARNING: Do not start the trap code with a newline, due to a FreeBSD 4.0 bug.
 trap 'exit_status=$?
   # Save into config.log some information that might help in debugging.
   {
@@ -1118,20 +1568,34 @@
 _ASBOX
     echo
     # The following way of writing the cache mishandles newlines in values,
-{
+(
+  for ac_var in `(set) 2>&1 | sed -n '\''s/^\([a-zA-Z_][a-zA-Z0-9_]*\)=.*/\1/p'\''`; do
+    eval ac_val=\$$ac_var
+    case $ac_val in #(
+    *${as_nl}*)
+      case $ac_var in #(
+      *_cv_*) { echo "$as_me:$LINENO: WARNING: Cache variable $ac_var contains a newline." >&5
+echo "$as_me: WARNING: Cache variable $ac_var contains a newline." >&2;} ;;
+      esac
+      case $ac_var in #(
+      _ | IFS | as_nl) ;; #(
+      *) $as_unset $ac_var ;;
+      esac ;;
+    esac
+  done
   (set) 2>&1 |
-    case `(ac_space='"'"' '"'"'; set | grep ac_space) 2>&1` in
-    *ac_space=\ *)
+    case $as_nl`(ac_space='\'' '\''; set) 2>&1` in #(
+    *${as_nl}ac_space=\ *)
       sed -n \
-	"s/'"'"'/'"'"'\\\\'"'"''"'"'/g;
-	  s/^\\([_$as_cr_alnum]*_cv_[_$as_cr_alnum]*\\)=\\(.*\\)/\\1='"'"'\\2'"'"'/p"
-      ;;
+	"s/'\''/'\''\\\\'\'''\''/g;
+	  s/^\\([_$as_cr_alnum]*_cv_[_$as_cr_alnum]*\\)=\\(.*\\)/\\1='\''\\2'\''/p"
+      ;; #(
     *)
-      sed -n \
-	"s/^\\([_$as_cr_alnum]*_cv_[_$as_cr_alnum]*\\)=\\(.*\\)/\\1=\\2/p"
+      sed -n "/^[_$as_cr_alnum]*_cv_[_$as_cr_alnum]*=/p"
       ;;
-    esac;
-}
+    esac |
+    sort
+)
     echo
 
     cat <<\_ASBOX
@@ -1142,22 +1606,28 @@
     echo
     for ac_var in $ac_subst_vars
     do
-      eval ac_val=$`echo $ac_var`
-      echo "$ac_var='"'"'$ac_val'"'"'"
+      eval ac_val=\$$ac_var
+      case $ac_val in
+      *\'\''*) ac_val=`echo "$ac_val" | sed "s/'\''/'\''\\\\\\\\'\'''\''/g"`;;
+      esac
+      echo "$ac_var='\''$ac_val'\''"
     done | sort
     echo
 
     if test -n "$ac_subst_files"; then
       cat <<\_ASBOX
-## ------------- ##
-## Output files. ##
-## ------------- ##
+## ------------------- ##
+## File substitutions. ##
+## ------------------- ##
 _ASBOX
       echo
       for ac_var in $ac_subst_files
       do
-	eval ac_val=$`echo $ac_var`
-	echo "$ac_var='"'"'$ac_val'"'"'"
+	eval ac_val=\$$ac_var
+	case $ac_val in
+	*\'\''*) ac_val=`echo "$ac_val" | sed "s/'\''/'\''\\\\\\\\'\'''\''/g"`;;
+	esac
+	echo "$ac_var='\''$ac_val'\''"
       done | sort
       echo
     fi
@@ -1169,26 +1639,24 @@
 ## ----------- ##
 _ASBOX
       echo
-      sed "/^$/d" confdefs.h | sort
+      cat confdefs.h
       echo
     fi
     test "$ac_signal" != 0 &&
       echo "$as_me: caught signal $ac_signal"
     echo "$as_me: exit $exit_status"
   } >&5
-  rm -f core *.core &&
-  rm -rf conftest* confdefs* conf$$* $ac_clean_files &&
+  rm -f core *.core core.conftest.* &&
+    rm -f -r conftest* confdefs* conf$$* $ac_clean_files &&
     exit $exit_status
-     ' 0
+' 0
 for ac_signal in 1 2 13 15; do
   trap 'ac_signal='$ac_signal'; { (exit 1); exit 1; }' $ac_signal
 done
 ac_signal=0
 
 # confdefs.h avoids OS command line length limits that DEFS can exceed.
-rm -rf conftest* confdefs.h
-# AIX cpp loses on an empty file, so make sure it contains at least a newline.
-echo >confdefs.h
+rm -f -r conftest* confdefs.h
 
 # Predefined preprocessor variables.
 
@@ -1219,14 +1687,17 @@
 
 # Let the site file select an alternate cache file if it wants to.
 # Prefer explicitly selected file to automatically selected ones.
-if test -z "$CONFIG_SITE"; then
-  if test "x$prefix" != xNONE; then
-    CONFIG_SITE="$prefix/share/config.site $prefix/etc/config.site"
-  else
-    CONFIG_SITE="$ac_default_prefix/share/config.site $ac_default_prefix/etc/config.site"
-  fi
+if test -n "$CONFIG_SITE"; then
+  set x "$CONFIG_SITE"
+elif test "x$prefix" != xNONE; then
+  set x "$prefix/share/config.site" "$prefix/etc/config.site"
+else
+  set x "$ac_default_prefix/share/config.site" \
+	"$ac_default_prefix/etc/config.site"
 fi
-for ac_site_file in $CONFIG_SITE; do
+shift
+for ac_site_file
+do
   if test -r "$ac_site_file"; then
     { echo "$as_me:$LINENO: loading site script $ac_site_file" >&5
 echo "$as_me: loading site script $ac_site_file" >&6;}
@@ -1242,8 +1713,8 @@
     { echo "$as_me:$LINENO: loading cache $cache_file" >&5
 echo "$as_me: loading cache $cache_file" >&6;}
     case $cache_file in
-      [\\/]* | ?:[\\/]* ) . $cache_file;;
-      *)                      . ./$cache_file;;
+      [\\/]* | ?:[\\/]* ) . "$cache_file";;
+      *)                      . "./$cache_file";;
     esac
   fi
 else
@@ -1255,12 +1726,11 @@
 # Check that the precious variables saved in the cache have kept the same
 # value.
 ac_cache_corrupted=false
-for ac_var in `(set) 2>&1 |
-	       sed -n 's/^ac_env_\([a-zA-Z_0-9]*\)_set=.*/\1/p'`; do
+for ac_var in $ac_precious_vars; do
   eval ac_old_set=\$ac_cv_env_${ac_var}_set
   eval ac_new_set=\$ac_env_${ac_var}_set
-  eval ac_old_val="\$ac_cv_env_${ac_var}_value"
-  eval ac_new_val="\$ac_env_${ac_var}_value"
+  eval ac_old_val=\$ac_cv_env_${ac_var}_value
+  eval ac_new_val=\$ac_env_${ac_var}_value
   case $ac_old_set,$ac_new_set in
     set,)
       { echo "$as_me:$LINENO: error: \`$ac_var' was set to \`$ac_old_val' in the previous run" >&5
@@ -1285,8 +1755,7 @@
   # Pass precious variables to config.status.
   if test "$ac_new_set" = set; then
     case $ac_new_val in
-    *" "*|*"	"*|*[\[\]\~\#\$\^\&\*\(\)\{\}\\\|\;\<\>\?\"\']*)
-      ac_arg=$ac_var=`echo "$ac_new_val" | sed "s/'/'\\\\\\\\''/g"` ;;
+    *\'*) ac_arg=$ac_var=`echo "$ac_new_val" | sed "s/'/'\\\\\\\\''/g"` ;;
     *) ac_arg=$ac_var=$ac_new_val ;;
     esac
     case " $ac_configure_args " in
@@ -1303,11 +1772,6 @@
    { (exit 1); exit 1; }; }
 fi
 
-ac_ext=c
-ac_cpp='$CPP $CPPFLAGS'
-ac_compile='$CC -c $CFLAGS $CPPFLAGS conftest.$ac_ext >&5'
-ac_link='$CC -o conftest$ac_exeext $CFLAGS $CPPFLAGS $LDFLAGS conftest.$ac_ext $LIBS >&5'
-ac_compiler_gnu=$ac_cv_c_compiler_gnu
 
 
 
@@ -1332,35 +1796,46 @@
 
 
 
+ac_ext=c
+ac_cpp='$CPP $CPPFLAGS'
+ac_compile='$CC -c $CFLAGS $CPPFLAGS conftest.$ac_ext >&5'
+ac_link='$CC -o conftest$ac_exeext $CFLAGS $CPPFLAGS $LDFLAGS conftest.$ac_ext $LIBS >&5'
+ac_compiler_gnu=$ac_cv_c_compiler_gnu
 
 
 
+am__api_version='1.10'
 
-am__api_version="1.4"
 ac_aux_dir=
-for ac_dir in $srcdir $srcdir/.. $srcdir/../..; do
-  if test -f $ac_dir/install-sh; then
+for ac_dir in "$srcdir" "$srcdir/.." "$srcdir/../.."; do
+  if test -f "$ac_dir/install-sh"; then
     ac_aux_dir=$ac_dir
     ac_install_sh="$ac_aux_dir/install-sh -c"
     break
-  elif test -f $ac_dir/install.sh; then
+  elif test -f "$ac_dir/install.sh"; then
     ac_aux_dir=$ac_dir
     ac_install_sh="$ac_aux_dir/install.sh -c"
     break
-  elif test -f $ac_dir/shtool; then
+  elif test -f "$ac_dir/shtool"; then
     ac_aux_dir=$ac_dir
     ac_install_sh="$ac_aux_dir/shtool install -c"
     break
   fi
 done
 if test -z "$ac_aux_dir"; then
-  { { echo "$as_me:$LINENO: error: cannot find install-sh or install.sh in $srcdir $srcdir/.. $srcdir/../.." >&5
-echo "$as_me: error: cannot find install-sh or install.sh in $srcdir $srcdir/.. $srcdir/../.." >&2;}
+  { { echo "$as_me:$LINENO: error: cannot find install-sh or install.sh in \"$srcdir\" \"$srcdir/..\" \"$srcdir/../..\"" >&5
+echo "$as_me: error: cannot find install-sh or install.sh in \"$srcdir\" \"$srcdir/..\" \"$srcdir/../..\"" >&2;}
    { (exit 1); exit 1; }; }
 fi
-ac_config_guess="$SHELL $ac_aux_dir/config.guess"
-ac_config_sub="$SHELL $ac_aux_dir/config.sub"
-ac_configure="$SHELL $ac_aux_dir/configure" # This should be Cygnus configure.
+
+# These three variables are undocumented and unsupported,
+# and are intended to be withdrawn in a future Autoconf release.
+# They can cause serious problems if a builder's source tree is in a directory
+# whose full name contains unusual characters.
+ac_config_guess="$SHELL $ac_aux_dir/config.guess"  # Please don't use this var.
+ac_config_sub="$SHELL $ac_aux_dir/config.sub"  # Please don't use this var.
+ac_configure="$SHELL $ac_aux_dir/configure"  # Please don't use this var.
+
 
 # Find a good install program.  We prefer a C program (faster),
 # so one script is as good as another.  But avoid the broken or
@@ -1375,8 +1850,8 @@
 # SVR4 /usr/ucb/install, which tries to use the nonexistent group "staff"
 # OS/2's system install, which has a completely different semantic
 # ./install, which can be erroneously created by make from ./install.sh.
-echo "$as_me:$LINENO: checking for a BSD-compatible install" >&5
-echo $ECHO_N "checking for a BSD-compatible install... $ECHO_C" >&6
+{ echo "$as_me:$LINENO: checking for a BSD-compatible install" >&5
+echo $ECHO_N "checking for a BSD-compatible install... $ECHO_C" >&6; }
 if test -z "$INSTALL"; then
 if test "${ac_cv_path_install+set}" = set; then
   echo $ECHO_N "(cached) $ECHO_C" >&6
@@ -1398,7 +1873,7 @@
     # by default.
     for ac_prog in ginstall scoinst install; do
       for ac_exec_ext in '' $ac_executable_extensions; do
-	if $as_executable_p "$as_dir/$ac_prog$ac_exec_ext"; then
+	if { test -f "$as_dir/$ac_prog$ac_exec_ext" && $as_test_x "$as_dir/$ac_prog$ac_exec_ext"; }; then
 	  if test $ac_prog = install &&
 	    grep dspmsg "$as_dir/$ac_prog$ac_exec_ext" >/dev/null 2>&1; then
 	    # AIX install.  It has an incompatible calling convention.
@@ -1417,21 +1892,22 @@
     ;;
 esac
 done
+IFS=$as_save_IFS
 
 
 fi
   if test "${ac_cv_path_install+set}" = set; then
     INSTALL=$ac_cv_path_install
   else
-    # As a last resort, use the slow shell script.  We don't cache a
-    # path for INSTALL within a source directory, because that will
+    # As a last resort, use the slow shell script.  Don't cache a
+    # value for INSTALL within a source directory, because that will
     # break other packages using the cache if that directory is
-    # removed, or if the path is relative.
+    # removed, or if the value is a relative name.
     INSTALL=$ac_install_sh
   fi
 fi
-echo "$as_me:$LINENO: result: $INSTALL" >&5
-echo "${ECHO_T}$INSTALL" >&6
+{ echo "$as_me:$LINENO: result: $INSTALL" >&5
+echo "${ECHO_T}$INSTALL" >&6; }
 
 # Use test -z because SunOS4 sh mishandles braces in ${var-val}.
 # It thinks the first close brace ends the variable substitution.
@@ -1441,24 +1917,25 @@
 
 test -z "$INSTALL_DATA" && INSTALL_DATA='${INSTALL} -m 644'
 
-echo "$as_me:$LINENO: checking whether build environment is sane" >&5
-echo $ECHO_N "checking whether build environment is sane... $ECHO_C" >&6
+{ echo "$as_me:$LINENO: checking whether build environment is sane" >&5
+echo $ECHO_N "checking whether build environment is sane... $ECHO_C" >&6; }
 # Just in case
 sleep 1
-echo timestamp > conftestfile
+echo timestamp > conftest.file
 # Do `set' in a subshell so we don't clobber the current shell's
 # arguments.  Must try -L first in case configure is actually a
 # symlink; some systems play weird games with the mod time of symlinks
 # (eg FreeBSD returns the mod time of the symlink's containing
 # directory).
 if (
-   set X `ls -Lt $srcdir/configure conftestfile 2> /dev/null`
+   set X `ls -Lt $srcdir/configure conftest.file 2> /dev/null`
    if test "$*" = "X"; then
       # -L didn't work.
-      set X `ls -t $srcdir/configure conftestfile`
+      set X `ls -t $srcdir/configure conftest.file`
    fi
-   if test "$*" != "X $srcdir/configure conftestfile" \
-      && test "$*" != "X conftestfile $srcdir/configure"; then
+   rm -f conftest.file
+   if test "$*" != "X $srcdir/configure conftest.file" \
+      && test "$*" != "X conftest.file $srcdir/configure"; then
 
       # If neither matched, then we have a broken ls.  This can happen
       # if, for instance, CONFIG_SHELL is bash and it inherits a
@@ -1471,7 +1948,7 @@
    { (exit 1); exit 1; }; }
    fi
 
-   test "$2" = conftestfile
+   test "$2" = conftest.file
    )
 then
    # Ok.
@@ -1483,62 +1960,190 @@
 Check your system clock" >&2;}
    { (exit 1); exit 1; }; }
 fi
-rm -f conftest*
-echo "$as_me:$LINENO: result: yes" >&5
-echo "${ECHO_T}yes" >&6
+{ echo "$as_me:$LINENO: result: yes" >&5
+echo "${ECHO_T}yes" >&6; }
 test "$program_prefix" != NONE &&
-  program_transform_name="s,^,$program_prefix,;$program_transform_name"
+  program_transform_name="s&^&$program_prefix&;$program_transform_name"
 # Use a double $ so make ignores it.
 test "$program_suffix" != NONE &&
-  program_transform_name="s,\$,$program_suffix,;$program_transform_name"
+  program_transform_name="s&\$&$program_suffix&;$program_transform_name"
 # Double any \ or $.  echo might interpret backslashes.
 # By default was `s,x,x', remove it if useless.
 cat <<\_ACEOF >conftest.sed
 s/[\\$]/&&/g;s/;s,x,x,$//
 _ACEOF
 program_transform_name=`echo $program_transform_name | sed -f conftest.sed`
-rm conftest.sed
+rm -f conftest.sed
+
+# expand $ac_aux_dir to an absolute path
+am_aux_dir=`cd $ac_aux_dir && pwd`
+
+test x"${MISSING+set}" = xset || MISSING="\${SHELL} $am_aux_dir/missing"
+# Use eval to expand $SHELL
+if eval "$MISSING --run true"; then
+  am_missing_run="$MISSING --run "
+else
+  am_missing_run=
+  { echo "$as_me:$LINENO: WARNING: \`missing' script is too old or missing" >&5
+echo "$as_me: WARNING: \`missing' script is too old or missing" >&2;}
+fi
+
+{ echo "$as_me:$LINENO: checking for a thread-safe mkdir -p" >&5
+echo $ECHO_N "checking for a thread-safe mkdir -p... $ECHO_C" >&6; }
+if test -z "$MKDIR_P"; then
+  if test "${ac_cv_path_mkdir+set}" = set; then
+  echo $ECHO_N "(cached) $ECHO_C" >&6
+else
+  as_save_IFS=$IFS; IFS=$PATH_SEPARATOR
+for as_dir in $PATH$PATH_SEPARATOR/opt/sfw/bin
+do
+  IFS=$as_save_IFS
+  test -z "$as_dir" && as_dir=.
+  for ac_prog in mkdir gmkdir; do
+	 for ac_exec_ext in '' $ac_executable_extensions; do
+	   { test -f "$as_dir/$ac_prog$ac_exec_ext" && $as_test_x "$as_dir/$ac_prog$ac_exec_ext"; } || continue
+	   case `"$as_dir/$ac_prog$ac_exec_ext" --version 2>&1` in #(
+	     'mkdir (GNU coreutils) '* | \
+	     'mkdir (coreutils) '* | \
+	     'mkdir (fileutils) '4.1*)
+	       ac_cv_path_mkdir=$as_dir/$ac_prog$ac_exec_ext
+	       break 3;;
+	   esac
+	 done
+       done
+done
+IFS=$as_save_IFS
+
+fi
+
+  if test "${ac_cv_path_mkdir+set}" = set; then
+    MKDIR_P="$ac_cv_path_mkdir -p"
+  else
+    # As a last resort, use the slow shell script.  Don't cache a
+    # value for MKDIR_P within a source directory, because that will
+    # break other packages using the cache if that directory is
+    # removed, or if the value is a relative name.
+    test -d ./--version && rmdir ./--version
+    MKDIR_P="$ac_install_sh -d"
+  fi
+fi
+{ echo "$as_me:$LINENO: result: $MKDIR_P" >&5
+echo "${ECHO_T}$MKDIR_P" >&6; }
+
+mkdir_p="$MKDIR_P"
+case $mkdir_p in
+  [\\/$]* | ?:[\\/]*) ;;
+  */*) mkdir_p="\$(top_builddir)/$mkdir_p" ;;
+esac
+
+for ac_prog in gawk mawk nawk awk
+do
+  # Extract the first word of "$ac_prog", so it can be a program name with args.
+set dummy $ac_prog; ac_word=$2
+{ echo "$as_me:$LINENO: checking for $ac_word" >&5
+echo $ECHO_N "checking for $ac_word... $ECHO_C" >&6; }
+if test "${ac_cv_prog_AWK+set}" = set; then
+  echo $ECHO_N "(cached) $ECHO_C" >&6
+else
+  if test -n "$AWK"; then
+  ac_cv_prog_AWK="$AWK" # Let the user override the test.
+else
+as_save_IFS=$IFS; IFS=$PATH_SEPARATOR
+for as_dir in $PATH
+do
+  IFS=$as_save_IFS
+  test -z "$as_dir" && as_dir=.
+  for ac_exec_ext in '' $ac_executable_extensions; do
+  if { test -f "$as_dir/$ac_word$ac_exec_ext" && $as_test_x "$as_dir/$ac_word$ac_exec_ext"; }; then
+    ac_cv_prog_AWK="$ac_prog"
+    echo "$as_me:$LINENO: found $as_dir/$ac_word$ac_exec_ext" >&5
+    break 2
+  fi
+done
+done
+IFS=$as_save_IFS
+
+fi
+fi
+AWK=$ac_cv_prog_AWK
+if test -n "$AWK"; then
+  { echo "$as_me:$LINENO: result: $AWK" >&5
+echo "${ECHO_T}$AWK" >&6; }
+else
+  { echo "$as_me:$LINENO: result: no" >&5
+echo "${ECHO_T}no" >&6; }
+fi
+
+
+  test -n "$AWK" && break
+done
 
-echo "$as_me:$LINENO: checking whether ${MAKE-make} sets \$(MAKE)" >&5
-echo $ECHO_N "checking whether ${MAKE-make} sets \$(MAKE)... $ECHO_C" >&6
-set dummy ${MAKE-make}; ac_make=`echo "$2" | sed 'y,:./+-,___p_,'`
-if eval "test \"\${ac_cv_prog_make_${ac_make}_set+set}\" = set"; then
+{ echo "$as_me:$LINENO: checking whether ${MAKE-make} sets \$(MAKE)" >&5
+echo $ECHO_N "checking whether ${MAKE-make} sets \$(MAKE)... $ECHO_C" >&6; }
+set x ${MAKE-make}; ac_make=`echo "$2" | sed 's/+/p/g; s/[^a-zA-Z0-9_]/_/g'`
+if { as_var=ac_cv_prog_make_${ac_make}_set; eval "test \"\${$as_var+set}\" = set"; }; then
   echo $ECHO_N "(cached) $ECHO_C" >&6
 else
   cat >conftest.make <<\_ACEOF
+SHELL = /bin/sh
 all:
-	@echo 'ac_maketemp="$(MAKE)"'
+	@echo '@@@%%%=$(MAKE)=@@@%%%'
 _ACEOF
 # GNU make sometimes prints "make[1]: Entering...", which would confuse us.
-eval `${MAKE-make} -f conftest.make 2>/dev/null | grep temp=`
-if test -n "$ac_maketemp"; then
-  eval ac_cv_prog_make_${ac_make}_set=yes
-else
-  eval ac_cv_prog_make_${ac_make}_set=no
-fi
+case `${MAKE-make} -f conftest.make 2>/dev/null` in
+  *@@@%%%=?*=@@@%%%*)
+    eval ac_cv_prog_make_${ac_make}_set=yes;;
+  *)
+    eval ac_cv_prog_make_${ac_make}_set=no;;
+esac
 rm -f conftest.make
 fi
-if eval "test \"`echo '$ac_cv_prog_make_'${ac_make}_set`\" = yes"; then
-  echo "$as_me:$LINENO: result: yes" >&5
-echo "${ECHO_T}yes" >&6
+if eval test \$ac_cv_prog_make_${ac_make}_set = yes; then
+  { echo "$as_me:$LINENO: result: yes" >&5
+echo "${ECHO_T}yes" >&6; }
   SET_MAKE=
 else
-  echo "$as_me:$LINENO: result: no" >&5
-echo "${ECHO_T}no" >&6
+  { echo "$as_me:$LINENO: result: no" >&5
+echo "${ECHO_T}no" >&6; }
   SET_MAKE="MAKE=${MAKE-make}"
 fi
 
-
-PACKAGE=lcd4linux
-
-VERSION=0.10.0
-
-if test "`cd $srcdir && pwd`" != "`pwd`" && test -f $srcdir/config.status; then
-  { { echo "$as_me:$LINENO: error: source directory already configured; run \"make distclean\" there first" >&5
+rm -rf .tst 2>/dev/null
+mkdir .tst 2>/dev/null
+if test -d .tst; then
+  am__leading_dot=.
+else
+  am__leading_dot=_
+fi
+rmdir .tst 2>/dev/null
+
+if test "`cd $srcdir && pwd`" != "`pwd`"; then
+  # Use -I$(srcdir) only when $(srcdir) != ., so that make's output
+  # is not polluted with repeated "-I."
+  am__isrc=' -I$(srcdir)'
+  # test to see if srcdir already configured
+  if test -f $srcdir/config.status; then
+    { { echo "$as_me:$LINENO: error: source directory already configured; run \"make distclean\" there first" >&5
 echo "$as_me: error: source directory already configured; run \"make distclean\" there first" >&2;}
    { (exit 1); exit 1; }; }
+  fi
+fi
+
+# test whether we have cygpath
+if test -z "$CYGPATH_W"; then
+  if (cygpath --version) >/dev/null 2>/dev/null; then
+    CYGPATH_W='cygpath -w'
+  else
+    CYGPATH_W=echo
+  fi
 fi
 
+
+# Define the identity of the package.
+ PACKAGE=lcd4linux
+ VERSION=0.11.0-SVN
+
+
 cat >>confdefs.h <<_ACEOF
 #define PACKAGE "$PACKAGE"
 _ACEOF
@@ -1548,107 +2153,39 @@
 #define VERSION "$VERSION"
 _ACEOF
 
+# Some tools Automake needs.
 
+ACLOCAL=${ACLOCAL-"${am_missing_run}aclocal-${am__api_version}"}
 
-missing_dir=`cd $ac_aux_dir && pwd`
-echo "$as_me:$LINENO: checking for working aclocal-${am__api_version}" >&5
-echo $ECHO_N "checking for working aclocal-${am__api_version}... $ECHO_C" >&6
-# Run test in a subshell; some versions of sh will print an error if
-# an executable is not found, even if stderr is redirected.
-# Redirect stdin to placate older versions of autoconf.  Sigh.
-if (aclocal-${am__api_version} --version) < /dev/null > /dev/null 2>&1; then
-   ACLOCAL=aclocal-${am__api_version}
-   echo "$as_me:$LINENO: result: found" >&5
-echo "${ECHO_T}found" >&6
-else
-   ACLOCAL="$missing_dir/missing aclocal-${am__api_version}"
-   echo "$as_me:$LINENO: result: missing" >&5
-echo "${ECHO_T}missing" >&6
-fi
-
-echo "$as_me:$LINENO: checking for working autoconf" >&5
-echo $ECHO_N "checking for working autoconf... $ECHO_C" >&6
-# Run test in a subshell; some versions of sh will print an error if
-# an executable is not found, even if stderr is redirected.
-# Redirect stdin to placate older versions of autoconf.  Sigh.
-if (autoconf --version) < /dev/null > /dev/null 2>&1; then
-   AUTOCONF=autoconf
-   echo "$as_me:$LINENO: result: found" >&5
-echo "${ECHO_T}found" >&6
-else
-   AUTOCONF="$missing_dir/missing autoconf"
-   echo "$as_me:$LINENO: result: missing" >&5
-echo "${ECHO_T}missing" >&6
-fi
-
-echo "$as_me:$LINENO: checking for working automake-${am__api_version}" >&5
-echo $ECHO_N "checking for working automake-${am__api_version}... $ECHO_C" >&6
-# Run test in a subshell; some versions of sh will print an error if
-# an executable is not found, even if stderr is redirected.
-# Redirect stdin to placate older versions of autoconf.  Sigh.
-if (automake-${am__api_version} --version) < /dev/null > /dev/null 2>&1; then
-   AUTOMAKE=automake-${am__api_version}
-   echo "$as_me:$LINENO: result: found" >&5
-echo "${ECHO_T}found" >&6
-else
-   AUTOMAKE="$missing_dir/missing automake-${am__api_version}"
-   echo "$as_me:$LINENO: result: missing" >&5
-echo "${ECHO_T}missing" >&6
-fi
-
-echo "$as_me:$LINENO: checking for working autoheader" >&5
-echo $ECHO_N "checking for working autoheader... $ECHO_C" >&6
-# Run test in a subshell; some versions of sh will print an error if
-# an executable is not found, even if stderr is redirected.
-# Redirect stdin to placate older versions of autoconf.  Sigh.
-if (autoheader --version) < /dev/null > /dev/null 2>&1; then
-   AUTOHEADER=autoheader
-   echo "$as_me:$LINENO: result: found" >&5
-echo "${ECHO_T}found" >&6
-else
-   AUTOHEADER="$missing_dir/missing autoheader"
-   echo "$as_me:$LINENO: result: missing" >&5
-echo "${ECHO_T}missing" >&6
-fi
-
-echo "$as_me:$LINENO: checking for working makeinfo" >&5
-echo $ECHO_N "checking for working makeinfo... $ECHO_C" >&6
-# Run test in a subshell; some versions of sh will print an error if
-# an executable is not found, even if stderr is redirected.
-# Redirect stdin to placate older versions of autoconf.  Sigh.
-if (makeinfo --version) < /dev/null > /dev/null 2>&1; then
-   MAKEINFO=makeinfo
-   echo "$as_me:$LINENO: result: found" >&5
-echo "${ECHO_T}found" >&6
-else
-   MAKEINFO="$missing_dir/missing makeinfo"
-   echo "$as_me:$LINENO: result: missing" >&5
-echo "${ECHO_T}missing" >&6
-fi
 
+AUTOCONF=${AUTOCONF-"${am_missing_run}autoconf"}
 
 
-          ac_config_headers="$ac_config_headers config.h"
+AUTOMAKE=${AUTOMAKE-"${am_missing_run}automake-${am__api_version}"}
 
-          ac_config_commands="$ac_config_commands default-1"
 
+AUTOHEADER=${AUTOHEADER-"${am_missing_run}autoheader"}
 
-# Checks for programs.
-ac_ext=c
-ac_cpp='$CPP $CPPFLAGS'
-ac_compile='$CC -c $CFLAGS $CPPFLAGS conftest.$ac_ext >&5'
-ac_link='$CC -o conftest$ac_exeext $CFLAGS $CPPFLAGS $LDFLAGS conftest.$ac_ext $LIBS >&5'
-ac_compiler_gnu=$ac_cv_c_compiler_gnu
-if test -n "$ac_tool_prefix"; then
-  # Extract the first word of "${ac_tool_prefix}gcc", so it can be a program name with args.
-set dummy ${ac_tool_prefix}gcc; ac_word=$2
-echo "$as_me:$LINENO: checking for $ac_word" >&5
-echo $ECHO_N "checking for $ac_word... $ECHO_C" >&6
-if test "${ac_cv_prog_CC+set}" = set; then
+
+MAKEINFO=${MAKEINFO-"${am_missing_run}makeinfo"}
+
+install_sh=${install_sh-"\$(SHELL) $am_aux_dir/install-sh"}
+
+# Installed binaries are usually stripped using `strip' when the user
+# run `make install-strip'.  However `strip' might not be the right
+# tool to use in cross-compilation environments, therefore Automake
+# will honor the `STRIP' environment variable to overrule this program.
+if test "$cross_compiling" != no; then
+  if test -n "$ac_tool_prefix"; then
+  # Extract the first word of "${ac_tool_prefix}strip", so it can be a program name with args.
+set dummy ${ac_tool_prefix}strip; ac_word=$2
+{ echo "$as_me:$LINENO: checking for $ac_word" >&5
+echo $ECHO_N "checking for $ac_word... $ECHO_C" >&6; }
+if test "${ac_cv_prog_STRIP+set}" = set; then
   echo $ECHO_N "(cached) $ECHO_C" >&6
 else
-  if test -n "$CC"; then
-  ac_cv_prog_CC="$CC" # Let the user override the test.
+  if test -n "$STRIP"; then
+  ac_cv_prog_STRIP="$STRIP" # Let the user override the test.
 else
 as_save_IFS=$IFS; IFS=$PATH_SEPARATOR
 for as_dir in $PATH
@@ -1656,37 +2193,39 @@
   IFS=$as_save_IFS
   test -z "$as_dir" && as_dir=.
   for ac_exec_ext in '' $ac_executable_extensions; do
-  if $as_executable_p "$as_dir/$ac_word$ac_exec_ext"; then
-    ac_cv_prog_CC="${ac_tool_prefix}gcc"
+  if { test -f "$as_dir/$ac_word$ac_exec_ext" && $as_test_x "$as_dir/$ac_word$ac_exec_ext"; }; then
+    ac_cv_prog_STRIP="${ac_tool_prefix}strip"
     echo "$as_me:$LINENO: found $as_dir/$ac_word$ac_exec_ext" >&5
     break 2
   fi
 done
 done
+IFS=$as_save_IFS
 
 fi
 fi
-CC=$ac_cv_prog_CC
-if test -n "$CC"; then
-  echo "$as_me:$LINENO: result: $CC" >&5
-echo "${ECHO_T}$CC" >&6
+STRIP=$ac_cv_prog_STRIP
+if test -n "$STRIP"; then
+  { echo "$as_me:$LINENO: result: $STRIP" >&5
+echo "${ECHO_T}$STRIP" >&6; }
 else
-  echo "$as_me:$LINENO: result: no" >&5
-echo "${ECHO_T}no" >&6
+  { echo "$as_me:$LINENO: result: no" >&5
+echo "${ECHO_T}no" >&6; }
 fi
 
+
 fi
-if test -z "$ac_cv_prog_CC"; then
-  ac_ct_CC=$CC
-  # Extract the first word of "gcc", so it can be a program name with args.
-set dummy gcc; ac_word=$2
-echo "$as_me:$LINENO: checking for $ac_word" >&5
-echo $ECHO_N "checking for $ac_word... $ECHO_C" >&6
-if test "${ac_cv_prog_ac_ct_CC+set}" = set; then
+if test -z "$ac_cv_prog_STRIP"; then
+  ac_ct_STRIP=$STRIP
+  # Extract the first word of "strip", so it can be a program name with args.
+set dummy strip; ac_word=$2
+{ echo "$as_me:$LINENO: checking for $ac_word" >&5
+echo $ECHO_N "checking for $ac_word... $ECHO_C" >&6; }
+if test "${ac_cv_prog_ac_ct_STRIP+set}" = set; then
   echo $ECHO_N "(cached) $ECHO_C" >&6
 else
-  if test -n "$ac_ct_CC"; then
-  ac_cv_prog_ac_ct_CC="$ac_ct_CC" # Let the user override the test.
+  if test -n "$ac_ct_STRIP"; then
+  ac_cv_prog_ac_ct_STRIP="$ac_ct_STRIP" # Let the user override the test.
 else
 as_save_IFS=$IFS; IFS=$PATH_SEPARATOR
 for as_dir in $PATH
@@ -1694,36 +2233,74 @@
   IFS=$as_save_IFS
   test -z "$as_dir" && as_dir=.
   for ac_exec_ext in '' $ac_executable_extensions; do
-  if $as_executable_p "$as_dir/$ac_word$ac_exec_ext"; then
-    ac_cv_prog_ac_ct_CC="gcc"
+  if { test -f "$as_dir/$ac_word$ac_exec_ext" && $as_test_x "$as_dir/$ac_word$ac_exec_ext"; }; then
+    ac_cv_prog_ac_ct_STRIP="strip"
     echo "$as_me:$LINENO: found $as_dir/$ac_word$ac_exec_ext" >&5
     break 2
   fi
 done
 done
+IFS=$as_save_IFS
 
 fi
 fi
-ac_ct_CC=$ac_cv_prog_ac_ct_CC
-if test -n "$ac_ct_CC"; then
-  echo "$as_me:$LINENO: result: $ac_ct_CC" >&5
-echo "${ECHO_T}$ac_ct_CC" >&6
+ac_ct_STRIP=$ac_cv_prog_ac_ct_STRIP
+if test -n "$ac_ct_STRIP"; then
+  { echo "$as_me:$LINENO: result: $ac_ct_STRIP" >&5
+echo "${ECHO_T}$ac_ct_STRIP" >&6; }
 else
-  echo "$as_me:$LINENO: result: no" >&5
-echo "${ECHO_T}no" >&6
+  { echo "$as_me:$LINENO: result: no" >&5
+echo "${ECHO_T}no" >&6; }
 fi
 
-  CC=$ac_ct_CC
+  if test "x$ac_ct_STRIP" = x; then
+    STRIP=":"
+  else
+    case $cross_compiling:$ac_tool_warned in
+yes:)
+{ echo "$as_me:$LINENO: WARNING: In the future, Autoconf will not detect cross-tools
+whose name does not start with the host triplet.  If you think this
+configuration is useful to you, please write to autoconf@gnu.org." >&5
+echo "$as_me: WARNING: In the future, Autoconf will not detect cross-tools
+whose name does not start with the host triplet.  If you think this
+configuration is useful to you, please write to autoconf@gnu.org." >&2;}
+ac_tool_warned=yes ;;
+esac
+    STRIP=$ac_ct_STRIP
+  fi
 else
-  CC="$ac_cv_prog_CC"
+  STRIP="$ac_cv_prog_STRIP"
 fi
 
-if test -z "$CC"; then
-  if test -n "$ac_tool_prefix"; then
-  # Extract the first word of "${ac_tool_prefix}cc", so it can be a program name with args.
-set dummy ${ac_tool_prefix}cc; ac_word=$2
-echo "$as_me:$LINENO: checking for $ac_word" >&5
-echo $ECHO_N "checking for $ac_word... $ECHO_C" >&6
+fi
+INSTALL_STRIP_PROGRAM="\$(install_sh) -c -s"
+
+# We need awk for the "check" target.  The system "awk" is bad on
+# some platforms.
+# Always define AMTAR for backward compatibility.
+
+AMTAR=${AMTAR-"${am_missing_run}tar"}
+
+am__tar='${AMTAR} chof - "$$tardir"'; am__untar='${AMTAR} xf -'
+
+
+
+
+
+ac_config_headers="$ac_config_headers config.h"
+
+
+# Checks for programs.
+ac_ext=c
+ac_cpp='$CPP $CPPFLAGS'
+ac_compile='$CC -c $CFLAGS $CPPFLAGS conftest.$ac_ext >&5'
+ac_link='$CC -o conftest$ac_exeext $CFLAGS $CPPFLAGS $LDFLAGS conftest.$ac_ext $LIBS >&5'
+ac_compiler_gnu=$ac_cv_c_compiler_gnu
+if test -n "$ac_tool_prefix"; then
+  # Extract the first word of "${ac_tool_prefix}gcc", so it can be a program name with args.
+set dummy ${ac_tool_prefix}gcc; ac_word=$2
+{ echo "$as_me:$LINENO: checking for $ac_word" >&5
+echo $ECHO_N "checking for $ac_word... $ECHO_C" >&6; }
 if test "${ac_cv_prog_CC+set}" = set; then
   echo $ECHO_N "(cached) $ECHO_C" >&6
 else
@@ -1736,32 +2313,34 @@
   IFS=$as_save_IFS
   test -z "$as_dir" && as_dir=.
   for ac_exec_ext in '' $ac_executable_extensions; do
-  if $as_executable_p "$as_dir/$ac_word$ac_exec_ext"; then
-    ac_cv_prog_CC="${ac_tool_prefix}cc"
+  if { test -f "$as_dir/$ac_word$ac_exec_ext" && $as_test_x "$as_dir/$ac_word$ac_exec_ext"; }; then
+    ac_cv_prog_CC="${ac_tool_prefix}gcc"
     echo "$as_me:$LINENO: found $as_dir/$ac_word$ac_exec_ext" >&5
     break 2
   fi
 done
 done
+IFS=$as_save_IFS
 
 fi
 fi
 CC=$ac_cv_prog_CC
 if test -n "$CC"; then
-  echo "$as_me:$LINENO: result: $CC" >&5
-echo "${ECHO_T}$CC" >&6
+  { echo "$as_me:$LINENO: result: $CC" >&5
+echo "${ECHO_T}$CC" >&6; }
 else
-  echo "$as_me:$LINENO: result: no" >&5
-echo "${ECHO_T}no" >&6
+  { echo "$as_me:$LINENO: result: no" >&5
+echo "${ECHO_T}no" >&6; }
 fi
 
+
 fi
 if test -z "$ac_cv_prog_CC"; then
   ac_ct_CC=$CC
-  # Extract the first word of "cc", so it can be a program name with args.
-set dummy cc; ac_word=$2
-echo "$as_me:$LINENO: checking for $ac_word" >&5
-echo $ECHO_N "checking for $ac_word... $ECHO_C" >&6
+  # Extract the first word of "gcc", so it can be a program name with args.
+set dummy gcc; ac_word=$2
+{ echo "$as_me:$LINENO: checking for $ac_word" >&5
+echo $ECHO_N "checking for $ac_word... $ECHO_C" >&6; }
 if test "${ac_cv_prog_ac_ct_CC+set}" = set; then
   echo $ECHO_N "(cached) $ECHO_C" >&6
 else
@@ -1774,36 +2353,91 @@
   IFS=$as_save_IFS
   test -z "$as_dir" && as_dir=.
   for ac_exec_ext in '' $ac_executable_extensions; do
-  if $as_executable_p "$as_dir/$ac_word$ac_exec_ext"; then
-    ac_cv_prog_ac_ct_CC="cc"
+  if { test -f "$as_dir/$ac_word$ac_exec_ext" && $as_test_x "$as_dir/$ac_word$ac_exec_ext"; }; then
+    ac_cv_prog_ac_ct_CC="gcc"
     echo "$as_me:$LINENO: found $as_dir/$ac_word$ac_exec_ext" >&5
     break 2
   fi
 done
 done
+IFS=$as_save_IFS
 
 fi
 fi
 ac_ct_CC=$ac_cv_prog_ac_ct_CC
 if test -n "$ac_ct_CC"; then
-  echo "$as_me:$LINENO: result: $ac_ct_CC" >&5
-echo "${ECHO_T}$ac_ct_CC" >&6
+  { echo "$as_me:$LINENO: result: $ac_ct_CC" >&5
+echo "${ECHO_T}$ac_ct_CC" >&6; }
 else
-  echo "$as_me:$LINENO: result: no" >&5
-echo "${ECHO_T}no" >&6
+  { echo "$as_me:$LINENO: result: no" >&5
+echo "${ECHO_T}no" >&6; }
 fi
 
-  CC=$ac_ct_CC
+  if test "x$ac_ct_CC" = x; then
+    CC=""
+  else
+    case $cross_compiling:$ac_tool_warned in
+yes:)
+{ echo "$as_me:$LINENO: WARNING: In the future, Autoconf will not detect cross-tools
+whose name does not start with the host triplet.  If you think this
+configuration is useful to you, please write to autoconf@gnu.org." >&5
+echo "$as_me: WARNING: In the future, Autoconf will not detect cross-tools
+whose name does not start with the host triplet.  If you think this
+configuration is useful to you, please write to autoconf@gnu.org." >&2;}
+ac_tool_warned=yes ;;
+esac
+    CC=$ac_ct_CC
+  fi
 else
   CC="$ac_cv_prog_CC"
 fi
 
+if test -z "$CC"; then
+          if test -n "$ac_tool_prefix"; then
+    # Extract the first word of "${ac_tool_prefix}cc", so it can be a program name with args.
+set dummy ${ac_tool_prefix}cc; ac_word=$2
+{ echo "$as_me:$LINENO: checking for $ac_word" >&5
+echo $ECHO_N "checking for $ac_word... $ECHO_C" >&6; }
+if test "${ac_cv_prog_CC+set}" = set; then
+  echo $ECHO_N "(cached) $ECHO_C" >&6
+else
+  if test -n "$CC"; then
+  ac_cv_prog_CC="$CC" # Let the user override the test.
+else
+as_save_IFS=$IFS; IFS=$PATH_SEPARATOR
+for as_dir in $PATH
+do
+  IFS=$as_save_IFS
+  test -z "$as_dir" && as_dir=.
+  for ac_exec_ext in '' $ac_executable_extensions; do
+  if { test -f "$as_dir/$ac_word$ac_exec_ext" && $as_test_x "$as_dir/$ac_word$ac_exec_ext"; }; then
+    ac_cv_prog_CC="${ac_tool_prefix}cc"
+    echo "$as_me:$LINENO: found $as_dir/$ac_word$ac_exec_ext" >&5
+    break 2
+  fi
+done
+done
+IFS=$as_save_IFS
+
+fi
+fi
+CC=$ac_cv_prog_CC
+if test -n "$CC"; then
+  { echo "$as_me:$LINENO: result: $CC" >&5
+echo "${ECHO_T}$CC" >&6; }
+else
+  { echo "$as_me:$LINENO: result: no" >&5
+echo "${ECHO_T}no" >&6; }
+fi
+
+
+  fi
 fi
 if test -z "$CC"; then
   # Extract the first word of "cc", so it can be a program name with args.
 set dummy cc; ac_word=$2
-echo "$as_me:$LINENO: checking for $ac_word" >&5
-echo $ECHO_N "checking for $ac_word... $ECHO_C" >&6
+{ echo "$as_me:$LINENO: checking for $ac_word" >&5
+echo $ECHO_N "checking for $ac_word... $ECHO_C" >&6; }
 if test "${ac_cv_prog_CC+set}" = set; then
   echo $ECHO_N "(cached) $ECHO_C" >&6
 else
@@ -1817,7 +2451,7 @@
   IFS=$as_save_IFS
   test -z "$as_dir" && as_dir=.
   for ac_exec_ext in '' $ac_executable_extensions; do
-  if $as_executable_p "$as_dir/$ac_word$ac_exec_ext"; then
+  if { test -f "$as_dir/$ac_word$ac_exec_ext" && $as_test_x "$as_dir/$ac_word$ac_exec_ext"; }; then
     if test "$as_dir/$ac_word$ac_exec_ext" = "/usr/ucb/cc"; then
        ac_prog_rejected=yes
        continue
@@ -1828,6 +2462,7 @@
   fi
 done
 done
+IFS=$as_save_IFS
 
 if test $ac_prog_rejected = yes; then
   # We found a bogon in the path, so make sure we never use it.
@@ -1845,22 +2480,23 @@
 fi
 CC=$ac_cv_prog_CC
 if test -n "$CC"; then
-  echo "$as_me:$LINENO: result: $CC" >&5
-echo "${ECHO_T}$CC" >&6
+  { echo "$as_me:$LINENO: result: $CC" >&5
+echo "${ECHO_T}$CC" >&6; }
 else
-  echo "$as_me:$LINENO: result: no" >&5
-echo "${ECHO_T}no" >&6
+  { echo "$as_me:$LINENO: result: no" >&5
+echo "${ECHO_T}no" >&6; }
 fi
 
+
 fi
 if test -z "$CC"; then
   if test -n "$ac_tool_prefix"; then
-  for ac_prog in cl
+  for ac_prog in cl.exe
   do
     # Extract the first word of "$ac_tool_prefix$ac_prog", so it can be a program name with args.
 set dummy $ac_tool_prefix$ac_prog; ac_word=$2
-echo "$as_me:$LINENO: checking for $ac_word" >&5
-echo $ECHO_N "checking for $ac_word... $ECHO_C" >&6
+{ echo "$as_me:$LINENO: checking for $ac_word" >&5
+echo $ECHO_N "checking for $ac_word... $ECHO_C" >&6; }
 if test "${ac_cv_prog_CC+set}" = set; then
   echo $ECHO_N "(cached) $ECHO_C" >&6
 else
@@ -1873,36 +2509,38 @@
   IFS=$as_save_IFS
   test -z "$as_dir" && as_dir=.
   for ac_exec_ext in '' $ac_executable_extensions; do
-  if $as_executable_p "$as_dir/$ac_word$ac_exec_ext"; then
+  if { test -f "$as_dir/$ac_word$ac_exec_ext" && $as_test_x "$as_dir/$ac_word$ac_exec_ext"; }; then
     ac_cv_prog_CC="$ac_tool_prefix$ac_prog"
     echo "$as_me:$LINENO: found $as_dir/$ac_word$ac_exec_ext" >&5
     break 2
   fi
 done
 done
+IFS=$as_save_IFS
 
 fi
 fi
 CC=$ac_cv_prog_CC
 if test -n "$CC"; then
-  echo "$as_me:$LINENO: result: $CC" >&5
-echo "${ECHO_T}$CC" >&6
+  { echo "$as_me:$LINENO: result: $CC" >&5
+echo "${ECHO_T}$CC" >&6; }
 else
-  echo "$as_me:$LINENO: result: no" >&5
-echo "${ECHO_T}no" >&6
+  { echo "$as_me:$LINENO: result: no" >&5
+echo "${ECHO_T}no" >&6; }
 fi
 
+
     test -n "$CC" && break
   done
 fi
 if test -z "$CC"; then
   ac_ct_CC=$CC
-  for ac_prog in cl
+  for ac_prog in cl.exe
 do
   # Extract the first word of "$ac_prog", so it can be a program name with args.
 set dummy $ac_prog; ac_word=$2
-echo "$as_me:$LINENO: checking for $ac_word" >&5
-echo $ECHO_N "checking for $ac_word... $ECHO_C" >&6
+{ echo "$as_me:$LINENO: checking for $ac_word" >&5
+echo $ECHO_N "checking for $ac_word... $ECHO_C" >&6; }
 if test "${ac_cv_prog_ac_ct_CC+set}" = set; then
   echo $ECHO_N "(cached) $ECHO_C" >&6
 else
@@ -1915,29 +2553,45 @@
   IFS=$as_save_IFS
   test -z "$as_dir" && as_dir=.
   for ac_exec_ext in '' $ac_executable_extensions; do
-  if $as_executable_p "$as_dir/$ac_word$ac_exec_ext"; then
+  if { test -f "$as_dir/$ac_word$ac_exec_ext" && $as_test_x "$as_dir/$ac_word$ac_exec_ext"; }; then
     ac_cv_prog_ac_ct_CC="$ac_prog"
     echo "$as_me:$LINENO: found $as_dir/$ac_word$ac_exec_ext" >&5
     break 2
   fi
 done
 done
+IFS=$as_save_IFS
 
 fi
 fi
 ac_ct_CC=$ac_cv_prog_ac_ct_CC
 if test -n "$ac_ct_CC"; then
-  echo "$as_me:$LINENO: result: $ac_ct_CC" >&5
-echo "${ECHO_T}$ac_ct_CC" >&6
+  { echo "$as_me:$LINENO: result: $ac_ct_CC" >&5
+echo "${ECHO_T}$ac_ct_CC" >&6; }
 else
-  echo "$as_me:$LINENO: result: no" >&5
-echo "${ECHO_T}no" >&6
+  { echo "$as_me:$LINENO: result: no" >&5
+echo "${ECHO_T}no" >&6; }
 fi
 
+
   test -n "$ac_ct_CC" && break
 done
 
-  CC=$ac_ct_CC
+  if test "x$ac_ct_CC" = x; then
+    CC=""
+  else
+    case $cross_compiling:$ac_tool_warned in
+yes:)
+{ echo "$as_me:$LINENO: WARNING: In the future, Autoconf will not detect cross-tools
+whose name does not start with the host triplet.  If you think this
+configuration is useful to you, please write to autoconf@gnu.org." >&5
+echo "$as_me: WARNING: In the future, Autoconf will not detect cross-tools
+whose name does not start with the host triplet.  If you think this
+configuration is useful to you, please write to autoconf@gnu.org." >&2;}
+ac_tool_warned=yes ;;
+esac
+    CC=$ac_ct_CC
+  fi
 fi
 
 fi
@@ -1950,21 +2604,35 @@
    { (exit 1); exit 1; }; }
 
 # Provide some information about the compiler.
-echo "$as_me:$LINENO:" \
-     "checking for C compiler version" >&5
+echo "$as_me:$LINENO: checking for C compiler version" >&5
 ac_compiler=`set X $ac_compile; echo $2`
-{ (eval echo "$as_me:$LINENO: \"$ac_compiler --version </dev/null >&5\"") >&5
-  (eval $ac_compiler --version </dev/null >&5) 2>&5
+{ (ac_try="$ac_compiler --version >&5"
+case "(($ac_try" in
+  *\"* | *\`* | *\\*) ac_try_echo=\$ac_try;;
+  *) ac_try_echo=$ac_try;;
+esac
+eval "echo \"\$as_me:$LINENO: $ac_try_echo\"") >&5
+  (eval "$ac_compiler --version >&5") 2>&5
   ac_status=$?
   echo "$as_me:$LINENO: \$? = $ac_status" >&5
   (exit $ac_status); }
-{ (eval echo "$as_me:$LINENO: \"$ac_compiler -v </dev/null >&5\"") >&5
-  (eval $ac_compiler -v </dev/null >&5) 2>&5
+{ (ac_try="$ac_compiler -v >&5"
+case "(($ac_try" in
+  *\"* | *\`* | *\\*) ac_try_echo=\$ac_try;;
+  *) ac_try_echo=$ac_try;;
+esac
+eval "echo \"\$as_me:$LINENO: $ac_try_echo\"") >&5
+  (eval "$ac_compiler -v >&5") 2>&5
   ac_status=$?
   echo "$as_me:$LINENO: \$? = $ac_status" >&5
   (exit $ac_status); }
-{ (eval echo "$as_me:$LINENO: \"$ac_compiler -V </dev/null >&5\"") >&5
-  (eval $ac_compiler -V </dev/null >&5) 2>&5
+{ (ac_try="$ac_compiler -V >&5"
+case "(($ac_try" in
+  *\"* | *\`* | *\\*) ac_try_echo=\$ac_try;;
+  *) ac_try_echo=$ac_try;;
+esac
+eval "echo \"\$as_me:$LINENO: $ac_try_echo\"") >&5
+  (eval "$ac_compiler -V >&5") 2>&5
   ac_status=$?
   echo "$as_me:$LINENO: \$? = $ac_status" >&5
   (exit $ac_status); }
@@ -1989,47 +2657,77 @@
 # Try to create an executable without -o first, disregard a.out.
 # It will help us diagnose broken compilers, and finding out an intuition
 # of exeext.
-echo "$as_me:$LINENO: checking for C compiler default output file name" >&5
-echo $ECHO_N "checking for C compiler default output file name... $ECHO_C" >&6
+{ echo "$as_me:$LINENO: checking for C compiler default output file name" >&5
+echo $ECHO_N "checking for C compiler default output file name... $ECHO_C" >&6; }
 ac_link_default=`echo "$ac_link" | sed 's/ -o *conftest[^ ]*//'`
-if { (eval echo "$as_me:$LINENO: \"$ac_link_default\"") >&5
-  (eval $ac_link_default) 2>&5
+#
+# List of possible output files, starting from the most likely.
+# The algorithm is not robust to junk in `.', hence go to wildcards (a.*)
+# only as a last resort.  b.out is created by i960 compilers.
+ac_files='a_out.exe a.exe conftest.exe a.out conftest a.* conftest.* b.out'
+#
+# The IRIX 6 linker writes into existing files which may not be
+# executable, retaining their permissions.  Remove them first so a
+# subsequent execution test works.
+ac_rmfiles=
+for ac_file in $ac_files
+do
+  case $ac_file in
+    *.$ac_ext | *.xcoff | *.tds | *.d | *.pdb | *.xSYM | *.bb | *.bbg | *.map | *.inf | *.o | *.obj ) ;;
+    * ) ac_rmfiles="$ac_rmfiles $ac_file";;
+  esac
+done
+rm -f $ac_rmfiles
+
+if { (ac_try="$ac_link_default"
+case "(($ac_try" in
+  *\"* | *\`* | *\\*) ac_try_echo=\$ac_try;;
+  *) ac_try_echo=$ac_try;;
+esac
+eval "echo \"\$as_me:$LINENO: $ac_try_echo\"") >&5
+  (eval "$ac_link_default") 2>&5
   ac_status=$?
   echo "$as_me:$LINENO: \$? = $ac_status" >&5
   (exit $ac_status); }; then
-  # Find the output, starting from the most likely.  This scheme is
-# not robust to junk in `.', hence go to wildcards (a.*) only as a last
-# resort.
-
-# Be careful to initialize this variable, since it used to be cached.
-# Otherwise an old cache value of `no' led to `EXEEXT = no' in a Makefile.
-ac_cv_exeext=
-# b.out is created by i960 compilers.
-for ac_file in a_out.exe a.exe conftest.exe a.out conftest a.* conftest.* b.out
+  # Autoconf-2.13 could set the ac_cv_exeext variable to `no'.
+# So ignore a value of `no', otherwise this would lead to `EXEEXT = no'
+# in a Makefile.  We should not override ac_cv_exeext if it was cached,
+# so that the user can short-circuit this test for compilers unknown to
+# Autoconf.
+for ac_file in $ac_files ''
 do
   test -f "$ac_file" || continue
   case $ac_file in
-    *.$ac_ext | *.xcoff | *.tds | *.d | *.pdb | *.xSYM | *.bb | *.bbg | *.o | *.obj )
-	;;
-    conftest.$ac_ext )
-	# This is the source file.
+    *.$ac_ext | *.xcoff | *.tds | *.d | *.pdb | *.xSYM | *.bb | *.bbg | *.map | *.inf | *.o | *.obj )
 	;;
     [ab].out )
 	# We found the default executable, but exeext='' is most
 	# certainly right.
 	break;;
     *.* )
-	ac_cv_exeext=`expr "$ac_file" : '[^.]*\(\..*\)'`
-	# FIXME: I believe we export ac_cv_exeext for Libtool,
-	# but it would be cool to find out if it's true.  Does anybody
-	# maintain Libtool? --akim.
-	export ac_cv_exeext
+        if test "${ac_cv_exeext+set}" = set && test "$ac_cv_exeext" != no;
+	then :; else
+	   ac_cv_exeext=`expr "$ac_file" : '[^.]*\(\..*\)'`
+	fi
+	# We set ac_cv_exeext here because the later test for it is not
+	# safe: cross compilers may not add the suffix if given an `-o'
+	# argument, so we may need to know it at that point already.
+	# Even if this section looks crufty: it has the advantage of
+	# actually working.
 	break;;
     * )
 	break;;
   esac
 done
+test "$ac_cv_exeext" = no && ac_cv_exeext=
+
 else
+  ac_file=''
+fi
+
+{ echo "$as_me:$LINENO: result: $ac_file" >&5
+echo "${ECHO_T}$ac_file" >&6; }
+if test -z "$ac_file"; then
   echo "$as_me: failed program was:" >&5
 sed 's/^/| /' conftest.$ac_ext >&5
 
@@ -2041,19 +2739,21 @@
 fi
 
 ac_exeext=$ac_cv_exeext
-echo "$as_me:$LINENO: result: $ac_file" >&5
-echo "${ECHO_T}$ac_file" >&6
 
-# Check the compiler produces executables we can run.  If not, either
+# Check that the compiler produces executables we can run.  If not, either
 # the compiler is broken, or we cross compile.
-echo "$as_me:$LINENO: checking whether the C compiler works" >&5
-echo $ECHO_N "checking whether the C compiler works... $ECHO_C" >&6
+{ echo "$as_me:$LINENO: checking whether the C compiler works" >&5
+echo $ECHO_N "checking whether the C compiler works... $ECHO_C" >&6; }
 # FIXME: These cross compiler hacks should be removed for Autoconf 3.0
 # If not cross compiling, check that we can run a simple program.
 if test "$cross_compiling" != yes; then
   if { ac_try='./$ac_file'
-  { (eval echo "$as_me:$LINENO: \"$ac_try\"") >&5
-  (eval $ac_try) 2>&5
+  { (case "(($ac_try" in
+  *\"* | *\`* | *\\*) ac_try_echo=\$ac_try;;
+  *) ac_try_echo=$ac_try;;
+esac
+eval "echo \"\$as_me:$LINENO: $ac_try_echo\"") >&5
+  (eval "$ac_try") 2>&5
   ac_status=$?
   echo "$as_me:$LINENO: \$? = $ac_status" >&5
   (exit $ac_status); }; }; then
@@ -2072,22 +2772,27 @@
     fi
   fi
 fi
-echo "$as_me:$LINENO: result: yes" >&5
-echo "${ECHO_T}yes" >&6
+{ echo "$as_me:$LINENO: result: yes" >&5
+echo "${ECHO_T}yes" >&6; }
 
 rm -f a.out a.exe conftest$ac_cv_exeext b.out
 ac_clean_files=$ac_clean_files_save
-# Check the compiler produces executables we can run.  If not, either
+# Check that the compiler produces executables we can run.  If not, either
 # the compiler is broken, or we cross compile.
-echo "$as_me:$LINENO: checking whether we are cross compiling" >&5
-echo $ECHO_N "checking whether we are cross compiling... $ECHO_C" >&6
-echo "$as_me:$LINENO: result: $cross_compiling" >&5
-echo "${ECHO_T}$cross_compiling" >&6
-
-echo "$as_me:$LINENO: checking for suffix of executables" >&5
-echo $ECHO_N "checking for suffix of executables... $ECHO_C" >&6
-if { (eval echo "$as_me:$LINENO: \"$ac_link\"") >&5
-  (eval $ac_link) 2>&5
+{ echo "$as_me:$LINENO: checking whether we are cross compiling" >&5
+echo $ECHO_N "checking whether we are cross compiling... $ECHO_C" >&6; }
+{ echo "$as_me:$LINENO: result: $cross_compiling" >&5
+echo "${ECHO_T}$cross_compiling" >&6; }
+
+{ echo "$as_me:$LINENO: checking for suffix of executables" >&5
+echo $ECHO_N "checking for suffix of executables... $ECHO_C" >&6; }
+if { (ac_try="$ac_link"
+case "(($ac_try" in
+  *\"* | *\`* | *\\*) ac_try_echo=\$ac_try;;
+  *) ac_try_echo=$ac_try;;
+esac
+eval "echo \"\$as_me:$LINENO: $ac_try_echo\"") >&5
+  (eval "$ac_link") 2>&5
   ac_status=$?
   echo "$as_me:$LINENO: \$? = $ac_status" >&5
   (exit $ac_status); }; then
@@ -2098,9 +2803,8 @@
 for ac_file in conftest.exe conftest conftest.*; do
   test -f "$ac_file" || continue
   case $ac_file in
-    *.$ac_ext | *.xcoff | *.tds | *.d | *.pdb | *.xSYM | *.bb | *.bbg | *.o | *.obj ) ;;
+    *.$ac_ext | *.xcoff | *.tds | *.d | *.pdb | *.xSYM | *.bb | *.bbg | *.map | *.inf | *.o | *.obj ) ;;
     *.* ) ac_cv_exeext=`expr "$ac_file" : '[^.]*\(\..*\)'`
-	  export ac_cv_exeext
 	  break;;
     * ) break;;
   esac
@@ -2114,14 +2818,14 @@
 fi
 
 rm -f conftest$ac_cv_exeext
-echo "$as_me:$LINENO: result: $ac_cv_exeext" >&5
-echo "${ECHO_T}$ac_cv_exeext" >&6
+{ echo "$as_me:$LINENO: result: $ac_cv_exeext" >&5
+echo "${ECHO_T}$ac_cv_exeext" >&6; }
 
 rm -f conftest.$ac_ext
 EXEEXT=$ac_cv_exeext
 ac_exeext=$EXEEXT
-echo "$as_me:$LINENO: checking for suffix of object files" >&5
-echo $ECHO_N "checking for suffix of object files... $ECHO_C" >&6
+{ echo "$as_me:$LINENO: checking for suffix of object files" >&5
+echo $ECHO_N "checking for suffix of object files... $ECHO_C" >&6; }
 if test "${ac_cv_objext+set}" = set; then
   echo $ECHO_N "(cached) $ECHO_C" >&6
 else
@@ -2141,14 +2845,20 @@
 }
 _ACEOF
 rm -f conftest.o conftest.obj
-if { (eval echo "$as_me:$LINENO: \"$ac_compile\"") >&5
-  (eval $ac_compile) 2>&5
+if { (ac_try="$ac_compile"
+case "(($ac_try" in
+  *\"* | *\`* | *\\*) ac_try_echo=\$ac_try;;
+  *) ac_try_echo=$ac_try;;
+esac
+eval "echo \"\$as_me:$LINENO: $ac_try_echo\"") >&5
+  (eval "$ac_compile") 2>&5
   ac_status=$?
   echo "$as_me:$LINENO: \$? = $ac_status" >&5
   (exit $ac_status); }; then
-  for ac_file in `(ls conftest.o conftest.obj; ls conftest.*) 2>/dev/null`; do
+  for ac_file in conftest.o conftest.obj conftest.*; do
+  test -f "$ac_file" || continue;
   case $ac_file in
-    *.$ac_ext | *.xcoff | *.tds | *.d | *.pdb | *.xSYM | *.bb | *.bbg ) ;;
+    *.$ac_ext | *.xcoff | *.tds | *.d | *.pdb | *.xSYM | *.bb | *.bbg | *.map | *.inf ) ;;
     *) ac_cv_objext=`expr "$ac_file" : '.*\.\(.*\)'`
        break;;
   esac
@@ -2166,12 +2876,12 @@
 
 rm -f conftest.$ac_cv_objext conftest.$ac_ext
 fi
-echo "$as_me:$LINENO: result: $ac_cv_objext" >&5
-echo "${ECHO_T}$ac_cv_objext" >&6
+{ echo "$as_me:$LINENO: result: $ac_cv_objext" >&5
+echo "${ECHO_T}$ac_cv_objext" >&6; }
 OBJEXT=$ac_cv_objext
 ac_objext=$OBJEXT
-echo "$as_me:$LINENO: checking whether we are using the GNU C compiler" >&5
-echo $ECHO_N "checking whether we are using the GNU C compiler... $ECHO_C" >&6
+{ echo "$as_me:$LINENO: checking whether we are using the GNU C compiler" >&5
+echo $ECHO_N "checking whether we are using the GNU C compiler... $ECHO_C" >&6; }
 if test "${ac_cv_c_compiler_gnu+set}" = set; then
   echo $ECHO_N "(cached) $ECHO_C" >&6
 else
@@ -2194,49 +2904,49 @@
 }
 _ACEOF
 rm -f conftest.$ac_objext
-if { (eval echo "$as_me:$LINENO: \"$ac_compile\"") >&5
-  (eval $ac_compile) 2>conftest.er1
+if { (ac_try="$ac_compile"
+case "(($ac_try" in
+  *\"* | *\`* | *\\*) ac_try_echo=\$ac_try;;
+  *) ac_try_echo=$ac_try;;
+esac
+eval "echo \"\$as_me:$LINENO: $ac_try_echo\"") >&5
+  (eval "$ac_compile") 2>conftest.er1
   ac_status=$?
   grep -v '^ *+' conftest.er1 >conftest.err
   rm -f conftest.er1
   cat conftest.err >&5
   echo "$as_me:$LINENO: \$? = $ac_status" >&5
-  (exit $ac_status); } &&
-	 { ac_try='test -z "$ac_c_werror_flag"			 || test ! -s conftest.err'
-  { (eval echo "$as_me:$LINENO: \"$ac_try\"") >&5
-  (eval $ac_try) 2>&5
-  ac_status=$?
-  echo "$as_me:$LINENO: \$? = $ac_status" >&5
-  (exit $ac_status); }; } &&
-	 { ac_try='test -s conftest.$ac_objext'
-  { (eval echo "$as_me:$LINENO: \"$ac_try\"") >&5
-  (eval $ac_try) 2>&5
-  ac_status=$?
-  echo "$as_me:$LINENO: \$? = $ac_status" >&5
-  (exit $ac_status); }; }; then
+  (exit $ac_status); } && {
+	 test -z "$ac_c_werror_flag" ||
+	 test ! -s conftest.err
+       } && test -s conftest.$ac_objext; then
   ac_compiler_gnu=yes
 else
   echo "$as_me: failed program was:" >&5
 sed 's/^/| /' conftest.$ac_ext >&5
 
-ac_compiler_gnu=no
+	ac_compiler_gnu=no
 fi
-rm -f conftest.err conftest.$ac_objext conftest.$ac_ext
+
+rm -f core conftest.err conftest.$ac_objext conftest.$ac_ext
 ac_cv_c_compiler_gnu=$ac_compiler_gnu
 
 fi
-echo "$as_me:$LINENO: result: $ac_cv_c_compiler_gnu" >&5
-echo "${ECHO_T}$ac_cv_c_compiler_gnu" >&6
+{ echo "$as_me:$LINENO: result: $ac_cv_c_compiler_gnu" >&5
+echo "${ECHO_T}$ac_cv_c_compiler_gnu" >&6; }
 GCC=`test $ac_compiler_gnu = yes && echo yes`
 ac_test_CFLAGS=${CFLAGS+set}
 ac_save_CFLAGS=$CFLAGS
-CFLAGS="-g"
-echo "$as_me:$LINENO: checking whether $CC accepts -g" >&5
-echo $ECHO_N "checking whether $CC accepts -g... $ECHO_C" >&6
+{ echo "$as_me:$LINENO: checking whether $CC accepts -g" >&5
+echo $ECHO_N "checking whether $CC accepts -g... $ECHO_C" >&6; }
 if test "${ac_cv_prog_cc_g+set}" = set; then
   echo $ECHO_N "(cached) $ECHO_C" >&6
 else
-  cat >conftest.$ac_ext <<_ACEOF
+  ac_save_c_werror_flag=$ac_c_werror_flag
+   ac_c_werror_flag=yes
+   ac_cv_prog_cc_g=no
+   CFLAGS="-g"
+   cat >conftest.$ac_ext <<_ACEOF
 /* confdefs.h.  */
 _ACEOF
 cat confdefs.h >>conftest.$ac_ext
@@ -2252,37 +2962,118 @@
 }
 _ACEOF
 rm -f conftest.$ac_objext
-if { (eval echo "$as_me:$LINENO: \"$ac_compile\"") >&5
-  (eval $ac_compile) 2>conftest.er1
+if { (ac_try="$ac_compile"
+case "(($ac_try" in
+  *\"* | *\`* | *\\*) ac_try_echo=\$ac_try;;
+  *) ac_try_echo=$ac_try;;
+esac
+eval "echo \"\$as_me:$LINENO: $ac_try_echo\"") >&5
+  (eval "$ac_compile") 2>conftest.er1
   ac_status=$?
   grep -v '^ *+' conftest.er1 >conftest.err
   rm -f conftest.er1
   cat conftest.err >&5
   echo "$as_me:$LINENO: \$? = $ac_status" >&5
-  (exit $ac_status); } &&
-	 { ac_try='test -z "$ac_c_werror_flag"			 || test ! -s conftest.err'
-  { (eval echo "$as_me:$LINENO: \"$ac_try\"") >&5
-  (eval $ac_try) 2>&5
+  (exit $ac_status); } && {
+	 test -z "$ac_c_werror_flag" ||
+	 test ! -s conftest.err
+       } && test -s conftest.$ac_objext; then
+  ac_cv_prog_cc_g=yes
+else
+  echo "$as_me: failed program was:" >&5
+sed 's/^/| /' conftest.$ac_ext >&5
+
+	CFLAGS=""
+      cat >conftest.$ac_ext <<_ACEOF
+/* confdefs.h.  */
+_ACEOF
+cat confdefs.h >>conftest.$ac_ext
+cat >>conftest.$ac_ext <<_ACEOF
+/* end confdefs.h.  */
+
+int
+main ()
+{
+
+  ;
+  return 0;
+}
+_ACEOF
+rm -f conftest.$ac_objext
+if { (ac_try="$ac_compile"
+case "(($ac_try" in
+  *\"* | *\`* | *\\*) ac_try_echo=\$ac_try;;
+  *) ac_try_echo=$ac_try;;
+esac
+eval "echo \"\$as_me:$LINENO: $ac_try_echo\"") >&5
+  (eval "$ac_compile") 2>conftest.er1
   ac_status=$?
+  grep -v '^ *+' conftest.er1 >conftest.err
+  rm -f conftest.er1
+  cat conftest.err >&5
   echo "$as_me:$LINENO: \$? = $ac_status" >&5
-  (exit $ac_status); }; } &&
-	 { ac_try='test -s conftest.$ac_objext'
-  { (eval echo "$as_me:$LINENO: \"$ac_try\"") >&5
-  (eval $ac_try) 2>&5
+  (exit $ac_status); } && {
+	 test -z "$ac_c_werror_flag" ||
+	 test ! -s conftest.err
+       } && test -s conftest.$ac_objext; then
+  :
+else
+  echo "$as_me: failed program was:" >&5
+sed 's/^/| /' conftest.$ac_ext >&5
+
+	ac_c_werror_flag=$ac_save_c_werror_flag
+	 CFLAGS="-g"
+	 cat >conftest.$ac_ext <<_ACEOF
+/* confdefs.h.  */
+_ACEOF
+cat confdefs.h >>conftest.$ac_ext
+cat >>conftest.$ac_ext <<_ACEOF
+/* end confdefs.h.  */
+
+int
+main ()
+{
+
+  ;
+  return 0;
+}
+_ACEOF
+rm -f conftest.$ac_objext
+if { (ac_try="$ac_compile"
+case "(($ac_try" in
+  *\"* | *\`* | *\\*) ac_try_echo=\$ac_try;;
+  *) ac_try_echo=$ac_try;;
+esac
+eval "echo \"\$as_me:$LINENO: $ac_try_echo\"") >&5
+  (eval "$ac_compile") 2>conftest.er1
   ac_status=$?
+  grep -v '^ *+' conftest.er1 >conftest.err
+  rm -f conftest.er1
+  cat conftest.err >&5
   echo "$as_me:$LINENO: \$? = $ac_status" >&5
-  (exit $ac_status); }; }; then
+  (exit $ac_status); } && {
+	 test -z "$ac_c_werror_flag" ||
+	 test ! -s conftest.err
+       } && test -s conftest.$ac_objext; then
   ac_cv_prog_cc_g=yes
 else
   echo "$as_me: failed program was:" >&5
 sed 's/^/| /' conftest.$ac_ext >&5
 
-ac_cv_prog_cc_g=no
+
+fi
+
+rm -f core conftest.err conftest.$ac_objext conftest.$ac_ext
+fi
+
+rm -f core conftest.err conftest.$ac_objext conftest.$ac_ext
 fi
-rm -f conftest.err conftest.$ac_objext conftest.$ac_ext
+
+rm -f core conftest.err conftest.$ac_objext conftest.$ac_ext
+   ac_c_werror_flag=$ac_save_c_werror_flag
 fi
-echo "$as_me:$LINENO: result: $ac_cv_prog_cc_g" >&5
-echo "${ECHO_T}$ac_cv_prog_cc_g" >&6
+{ echo "$as_me:$LINENO: result: $ac_cv_prog_cc_g" >&5
+echo "${ECHO_T}$ac_cv_prog_cc_g" >&6; }
 if test "$ac_test_CFLAGS" = set; then
   CFLAGS=$ac_save_CFLAGS
 elif test $ac_cv_prog_cc_g = yes; then
@@ -2298,12 +3089,12 @@
     CFLAGS=
   fi
 fi
-echo "$as_me:$LINENO: checking for $CC option to accept ANSI C" >&5
-echo $ECHO_N "checking for $CC option to accept ANSI C... $ECHO_C" >&6
-if test "${ac_cv_prog_cc_stdc+set}" = set; then
+{ echo "$as_me:$LINENO: checking for $CC option to accept ISO C89" >&5
+echo $ECHO_N "checking for $CC option to accept ISO C89... $ECHO_C" >&6; }
+if test "${ac_cv_prog_cc_c89+set}" = set; then
   echo $ECHO_N "(cached) $ECHO_C" >&6
 else
-  ac_cv_prog_cc_stdc=no
+  ac_cv_prog_cc_c89=no
 ac_save_CC=$CC
 cat >conftest.$ac_ext <<_ACEOF
 /* confdefs.h.  */
@@ -2337,12 +3128,17 @@
 /* OSF 4.0 Compaq cc is some sort of almost-ANSI by default.  It has
    function prototypes and stuff, but not '\xHH' hex character constants.
    These don't provoke an error unfortunately, instead are silently treated
-   as 'x'.  The following induces an error, until -std1 is added to get
+   as 'x'.  The following induces an error, until -std is added to get
    proper ANSI mode.  Curiously '\x00'!='x' always comes out true, for an
    array size at least.  It's necessary to write '\x00'==0 to get something
-   that's true only with -std1.  */
+   that's true only with -std.  */
 int osf4_cc_array ['\x00' == 0 ? 1 : -1];
 
+/* IBM C 6 for AIX is almost-ANSI by default, but it replaces macro parameters
+   inside strings and character constants.  */
+#define FOO(x) 'x'
+int xlc6_cc_array[FOO(a) == 'x' ? 1 : -1];
+
 int test (int i, double x);
 struct s1 {int (*f) (int a);};
 struct s2 {int (*f) (double a);};
@@ -2357,214 +3153,240 @@
   return 0;
 }
 _ACEOF
-# Don't try gcc -ansi; that turns off useful extensions and
-# breaks some systems' header files.
-# AIX			-qlanglvl=ansi
-# Ultrix and OSF/1	-std1
-# HP-UX 10.20 and later	-Ae
-# HP-UX older versions	-Aa -D_HPUX_SOURCE
-# SVR4			-Xc -D__EXTENSIONS__
-for ac_arg in "" -qlanglvl=ansi -std1 -Ae "-Aa -D_HPUX_SOURCE" "-Xc -D__EXTENSIONS__"
+for ac_arg in '' -qlanglvl=extc89 -qlanglvl=ansi -std \
+	-Ae "-Aa -D_HPUX_SOURCE" "-Xc -D__EXTENSIONS__"
 do
   CC="$ac_save_CC $ac_arg"
   rm -f conftest.$ac_objext
-if { (eval echo "$as_me:$LINENO: \"$ac_compile\"") >&5
-  (eval $ac_compile) 2>conftest.er1
+if { (ac_try="$ac_compile"
+case "(($ac_try" in
+  *\"* | *\`* | *\\*) ac_try_echo=\$ac_try;;
+  *) ac_try_echo=$ac_try;;
+esac
+eval "echo \"\$as_me:$LINENO: $ac_try_echo\"") >&5
+  (eval "$ac_compile") 2>conftest.er1
   ac_status=$?
   grep -v '^ *+' conftest.er1 >conftest.err
   rm -f conftest.er1
   cat conftest.err >&5
   echo "$as_me:$LINENO: \$? = $ac_status" >&5
-  (exit $ac_status); } &&
-	 { ac_try='test -z "$ac_c_werror_flag"			 || test ! -s conftest.err'
-  { (eval echo "$as_me:$LINENO: \"$ac_try\"") >&5
-  (eval $ac_try) 2>&5
-  ac_status=$?
-  echo "$as_me:$LINENO: \$? = $ac_status" >&5
-  (exit $ac_status); }; } &&
-	 { ac_try='test -s conftest.$ac_objext'
-  { (eval echo "$as_me:$LINENO: \"$ac_try\"") >&5
-  (eval $ac_try) 2>&5
-  ac_status=$?
-  echo "$as_me:$LINENO: \$? = $ac_status" >&5
-  (exit $ac_status); }; }; then
-  ac_cv_prog_cc_stdc=$ac_arg
-break
+  (exit $ac_status); } && {
+	 test -z "$ac_c_werror_flag" ||
+	 test ! -s conftest.err
+       } && test -s conftest.$ac_objext; then
+  ac_cv_prog_cc_c89=$ac_arg
 else
   echo "$as_me: failed program was:" >&5
 sed 's/^/| /' conftest.$ac_ext >&5
 
+
 fi
-rm -f conftest.err conftest.$ac_objext
+
+rm -f core conftest.err conftest.$ac_objext
+  test "x$ac_cv_prog_cc_c89" != "xno" && break
 done
-rm -f conftest.$ac_ext conftest.$ac_objext
+rm -f conftest.$ac_ext
 CC=$ac_save_CC
 
 fi
-
-case "x$ac_cv_prog_cc_stdc" in
-  x|xno)
-    echo "$as_me:$LINENO: result: none needed" >&5
-echo "${ECHO_T}none needed" >&6 ;;
+# AC_CACHE_VAL
+case "x$ac_cv_prog_cc_c89" in
+  x)
+    { echo "$as_me:$LINENO: result: none needed" >&5
+echo "${ECHO_T}none needed" >&6; } ;;
+  xno)
+    { echo "$as_me:$LINENO: result: unsupported" >&5
+echo "${ECHO_T}unsupported" >&6; } ;;
   *)
-    echo "$as_me:$LINENO: result: $ac_cv_prog_cc_stdc" >&5
-echo "${ECHO_T}$ac_cv_prog_cc_stdc" >&6
-    CC="$CC $ac_cv_prog_cc_stdc" ;;
+    CC="$CC $ac_cv_prog_cc_c89"
+    { echo "$as_me:$LINENO: result: $ac_cv_prog_cc_c89" >&5
+echo "${ECHO_T}$ac_cv_prog_cc_c89" >&6; } ;;
 esac
 
-# Some people use a C++ compiler to compile C.  Since we use `exit',
-# in C++ we need to declare it.  In case someone uses the same compiler
-# for both compiling C and C++ we need to have the C++ compiler decide
-# the declaration of exit, since it's the most demanding environment.
-cat >conftest.$ac_ext <<_ACEOF
-#ifndef __cplusplus
-  choke me
-#endif
-_ACEOF
-rm -f conftest.$ac_objext
-if { (eval echo "$as_me:$LINENO: \"$ac_compile\"") >&5
-  (eval $ac_compile) 2>conftest.er1
-  ac_status=$?
-  grep -v '^ *+' conftest.er1 >conftest.err
-  rm -f conftest.er1
-  cat conftest.err >&5
-  echo "$as_me:$LINENO: \$? = $ac_status" >&5
-  (exit $ac_status); } &&
-	 { ac_try='test -z "$ac_c_werror_flag"			 || test ! -s conftest.err'
-  { (eval echo "$as_me:$LINENO: \"$ac_try\"") >&5
-  (eval $ac_try) 2>&5
-  ac_status=$?
-  echo "$as_me:$LINENO: \$? = $ac_status" >&5
-  (exit $ac_status); }; } &&
-	 { ac_try='test -s conftest.$ac_objext'
-  { (eval echo "$as_me:$LINENO: \"$ac_try\"") >&5
-  (eval $ac_try) 2>&5
-  ac_status=$?
-  echo "$as_me:$LINENO: \$? = $ac_status" >&5
-  (exit $ac_status); }; }; then
-  for ac_declaration in \
-   '' \
-   'extern "C" void std::exit (int) throw (); using std::exit;' \
-   'extern "C" void std::exit (int); using std::exit;' \
-   'extern "C" void exit (int) throw ();' \
-   'extern "C" void exit (int);' \
-   'void exit (int);'
-do
-  cat >conftest.$ac_ext <<_ACEOF
-/* confdefs.h.  */
-_ACEOF
-cat confdefs.h >>conftest.$ac_ext
-cat >>conftest.$ac_ext <<_ACEOF
-/* end confdefs.h.  */
-$ac_declaration
-#include <stdlib.h>
-int
-main ()
-{
-exit (42);
-  ;
-  return 0;
-}
-_ACEOF
-rm -f conftest.$ac_objext
-if { (eval echo "$as_me:$LINENO: \"$ac_compile\"") >&5
-  (eval $ac_compile) 2>conftest.er1
-  ac_status=$?
-  grep -v '^ *+' conftest.er1 >conftest.err
-  rm -f conftest.er1
-  cat conftest.err >&5
-  echo "$as_me:$LINENO: \$? = $ac_status" >&5
-  (exit $ac_status); } &&
-	 { ac_try='test -z "$ac_c_werror_flag"			 || test ! -s conftest.err'
-  { (eval echo "$as_me:$LINENO: \"$ac_try\"") >&5
-  (eval $ac_try) 2>&5
-  ac_status=$?
-  echo "$as_me:$LINENO: \$? = $ac_status" >&5
-  (exit $ac_status); }; } &&
-	 { ac_try='test -s conftest.$ac_objext'
-  { (eval echo "$as_me:$LINENO: \"$ac_try\"") >&5
-  (eval $ac_try) 2>&5
-  ac_status=$?
-  echo "$as_me:$LINENO: \$? = $ac_status" >&5
-  (exit $ac_status); }; }; then
-  :
-else
-  echo "$as_me: failed program was:" >&5
-sed 's/^/| /' conftest.$ac_ext >&5
 
-continue
+ac_ext=c
+ac_cpp='$CPP $CPPFLAGS'
+ac_compile='$CC -c $CFLAGS $CPPFLAGS conftest.$ac_ext >&5'
+ac_link='$CC -o conftest$ac_exeext $CFLAGS $CPPFLAGS $LDFLAGS conftest.$ac_ext $LIBS >&5'
+ac_compiler_gnu=$ac_cv_c_compiler_gnu
+DEPDIR="${am__leading_dot}deps"
+
+ac_config_commands="$ac_config_commands depfiles"
+
+
+am_make=${MAKE-make}
+cat > confinc << 'END'
+am__doit:
+	@echo done
+.PHONY: am__doit
+END
+# If we don't find an include directive, just comment out the code.
+{ echo "$as_me:$LINENO: checking for style of include used by $am_make" >&5
+echo $ECHO_N "checking for style of include used by $am_make... $ECHO_C" >&6; }
+am__include="#"
+am__quote=
+_am_result=none
+# First try GNU make style include.
+echo "include confinc" > confmf
+# We grep out `Entering directory' and `Leaving directory'
+# messages which can occur if `w' ends up in MAKEFLAGS.
+# In particular we don't look at `^make:' because GNU make might
+# be invoked under some other name (usually "gmake"), in which
+# case it prints its new name instead of `make'.
+if test "`$am_make -s -f confmf 2> /dev/null | grep -v 'ing directory'`" = "done"; then
+   am__include=include
+   am__quote=
+   _am_result=GNU
+fi
+# Now try BSD make style include.
+if test "$am__include" = "#"; then
+   echo '.include "confinc"' > confmf
+   if test "`$am_make -s -f confmf 2> /dev/null`" = "done"; then
+      am__include=.include
+      am__quote="\""
+      _am_result=BSD
+   fi
 fi
-rm -f conftest.err conftest.$ac_objext conftest.$ac_ext
-  cat >conftest.$ac_ext <<_ACEOF
-/* confdefs.h.  */
-_ACEOF
-cat confdefs.h >>conftest.$ac_ext
-cat >>conftest.$ac_ext <<_ACEOF
-/* end confdefs.h.  */
-$ac_declaration
-int
-main ()
-{
-exit (42);
-  ;
-  return 0;
-}
-_ACEOF
-rm -f conftest.$ac_objext
-if { (eval echo "$as_me:$LINENO: \"$ac_compile\"") >&5
-  (eval $ac_compile) 2>conftest.er1
-  ac_status=$?
-  grep -v '^ *+' conftest.er1 >conftest.err
-  rm -f conftest.er1
-  cat conftest.err >&5
-  echo "$as_me:$LINENO: \$? = $ac_status" >&5
-  (exit $ac_status); } &&
-	 { ac_try='test -z "$ac_c_werror_flag"			 || test ! -s conftest.err'
-  { (eval echo "$as_me:$LINENO: \"$ac_try\"") >&5
-  (eval $ac_try) 2>&5
-  ac_status=$?
-  echo "$as_me:$LINENO: \$? = $ac_status" >&5
-  (exit $ac_status); }; } &&
-	 { ac_try='test -s conftest.$ac_objext'
-  { (eval echo "$as_me:$LINENO: \"$ac_try\"") >&5
-  (eval $ac_try) 2>&5
-  ac_status=$?
-  echo "$as_me:$LINENO: \$? = $ac_status" >&5
-  (exit $ac_status); }; }; then
-  break
-else
-  echo "$as_me: failed program was:" >&5
-sed 's/^/| /' conftest.$ac_ext >&5
 
+
+{ echo "$as_me:$LINENO: result: $_am_result" >&5
+echo "${ECHO_T}$_am_result" >&6; }
+rm -f confinc confmf
+
+# Check whether --enable-dependency-tracking was given.
+if test "${enable_dependency_tracking+set}" = set; then
+  enableval=$enable_dependency_tracking;
 fi
-rm -f conftest.err conftest.$ac_objext conftest.$ac_ext
-done
-rm -f conftest*
-if test -n "$ac_declaration"; then
-  echo '#ifdef __cplusplus' >>confdefs.h
-  echo $ac_declaration      >>confdefs.h
-  echo '#endif'             >>confdefs.h
+
+if test "x$enable_dependency_tracking" != xno; then
+  am_depcomp="$ac_aux_dir/depcomp"
+  AMDEPBACKSLASH='\'
 fi
+ if test "x$enable_dependency_tracking" != xno; then
+  AMDEP_TRUE=
+  AMDEP_FALSE='#'
+else
+  AMDEP_TRUE='#'
+  AMDEP_FALSE=
+fi
+
+
 
+depcc="$CC"   am_compiler_list=
+
+{ echo "$as_me:$LINENO: checking dependency style of $depcc" >&5
+echo $ECHO_N "checking dependency style of $depcc... $ECHO_C" >&6; }
+if test "${am_cv_CC_dependencies_compiler_type+set}" = set; then
+  echo $ECHO_N "(cached) $ECHO_C" >&6
 else
-  echo "$as_me: failed program was:" >&5
-sed 's/^/| /' conftest.$ac_ext >&5
+  if test -z "$AMDEP_TRUE" && test -f "$am_depcomp"; then
+  # We make a subdir and do the tests there.  Otherwise we can end up
+  # making bogus files that we don't know about and never remove.  For
+  # instance it was reported that on HP-UX the gcc test will end up
+  # making a dummy file named `D' -- because `-MD' means `put the output
+  # in D'.
+  mkdir conftest.dir
+  # Copy depcomp to subdir because otherwise we won't find it if we're
+  # using a relative directory.
+  cp "$am_depcomp" conftest.dir
+  cd conftest.dir
+  # We will build objects and dependencies in a subdirectory because
+  # it helps to detect inapplicable dependency modes.  For instance
+  # both Tru64's cc and ICC support -MD to output dependencies as a
+  # side effect of compilation, but ICC will put the dependencies in
+  # the current directory while Tru64 will put them in the object
+  # directory.
+  mkdir sub
+
+  am_cv_CC_dependencies_compiler_type=none
+  if test "$am_compiler_list" = ""; then
+     am_compiler_list=`sed -n 's/^#*\([a-zA-Z0-9]*\))$/\1/p' < ./depcomp`
+  fi
+  for depmode in $am_compiler_list; do
+    # Setup a source with many dependencies, because some compilers
+    # like to wrap large dependency lists on column 80 (with \), and
+    # we should not choose a depcomp mode which is confused by this.
+    #
+    # We need to recreate these files for each test, as the compiler may
+    # overwrite some of them when testing with obscure command lines.
+    # This happens at least with the AIX C compiler.
+    : > sub/conftest.c
+    for i in 1 2 3 4 5 6; do
+      echo '#include "conftst'$i'.h"' >> sub/conftest.c
+      # Using `: > sub/conftst$i.h' creates only sub/conftst1.h with
+      # Solaris 8's {/usr,}/bin/sh.
+      touch sub/conftst$i.h
+    done
+    echo "${am__include} ${am__quote}sub/conftest.Po${am__quote}" > confmf
+
+    case $depmode in
+    nosideeffect)
+      # after this tag, mechanisms are not by side-effect, so they'll
+      # only be used when explicitly requested
+      if test "x$enable_dependency_tracking" = xyes; then
+	continue
+      else
+	break
+      fi
+      ;;
+    none) break ;;
+    esac
+    # We check with `-c' and `-o' for the sake of the "dashmstdout"
+    # mode.  It turns out that the SunPro C++ compiler does not properly
+    # handle `-M -o', and we need to detect this.
+    if depmode=$depmode \
+       source=sub/conftest.c object=sub/conftest.${OBJEXT-o} \
+       depfile=sub/conftest.Po tmpdepfile=sub/conftest.TPo \
+       $SHELL ./depcomp $depcc -c -o sub/conftest.${OBJEXT-o} sub/conftest.c \
+         >/dev/null 2>conftest.err &&
+       grep sub/conftst1.h sub/conftest.Po > /dev/null 2>&1 &&
+       grep sub/conftst6.h sub/conftest.Po > /dev/null 2>&1 &&
+       grep sub/conftest.${OBJEXT-o} sub/conftest.Po > /dev/null 2>&1 &&
+       ${MAKE-make} -s -f confmf > /dev/null 2>&1; then
+      # icc doesn't choke on unknown options, it will just issue warnings
+      # or remarks (even with -Werror).  So we grep stderr for any message
+      # that says an option was ignored or not supported.
+      # When given -MP, icc 7.0 and 7.1 complain thusly:
+      #   icc: Command line warning: ignoring option '-M'; no argument required
+      # The diagnosis changed in icc 8.0:
+      #   icc: Command line remark: option '-MP' not supported
+      if (grep 'ignoring option' conftest.err ||
+          grep 'not supported' conftest.err) >/dev/null 2>&1; then :; else
+        am_cv_CC_dependencies_compiler_type=$depmode
+        break
+      fi
+    fi
+  done
+
+  cd ..
+  rm -rf conftest.dir
+else
+  am_cv_CC_dependencies_compiler_type=none
+fi
 
 fi
-rm -f conftest.err conftest.$ac_objext conftest.$ac_ext
-ac_ext=c
-ac_cpp='$CPP $CPPFLAGS'
-ac_compile='$CC -c $CFLAGS $CPPFLAGS conftest.$ac_ext >&5'
-ac_link='$CC -o conftest$ac_exeext $CFLAGS $CPPFLAGS $LDFLAGS conftest.$ac_ext $LIBS >&5'
-ac_compiler_gnu=$ac_cv_c_compiler_gnu
+{ echo "$as_me:$LINENO: result: $am_cv_CC_dependencies_compiler_type" >&5
+echo "${ECHO_T}$am_cv_CC_dependencies_compiler_type" >&6; }
+CCDEPMODE=depmode=$am_cv_CC_dependencies_compiler_type
+
+ if
+  test "x$enable_dependency_tracking" != xno \
+  && test "$am_cv_CC_dependencies_compiler_type" = gcc3; then
+  am__fastdepCC_TRUE=
+  am__fastdepCC_FALSE='#'
+else
+  am__fastdepCC_TRUE='#'
+  am__fastdepCC_FALSE=
+fi
+
 
 ac_ext=c
 ac_cpp='$CPP $CPPFLAGS'
 ac_compile='$CC -c $CFLAGS $CPPFLAGS conftest.$ac_ext >&5'
 ac_link='$CC -o conftest$ac_exeext $CFLAGS $CPPFLAGS $LDFLAGS conftest.$ac_ext $LIBS >&5'
 ac_compiler_gnu=$ac_cv_c_compiler_gnu
-echo "$as_me:$LINENO: checking how to run the C preprocessor" >&5
-echo $ECHO_N "checking how to run the C preprocessor... $ECHO_C" >&6
+{ echo "$as_me:$LINENO: checking how to run the C preprocessor" >&5
+echo $ECHO_N "checking how to run the C preprocessor... $ECHO_C" >&6; }
 # On Suns, sometimes $CPP names a directory.
 if test -n "$CPP" && test -d "$CPP"; then
   CPP=
@@ -2598,24 +3420,22 @@
 #endif
 		     Syntax error
 _ACEOF
-if { (eval echo "$as_me:$LINENO: \"$ac_cpp conftest.$ac_ext\"") >&5
-  (eval $ac_cpp conftest.$ac_ext) 2>conftest.er1
+if { (ac_try="$ac_cpp conftest.$ac_ext"
+case "(($ac_try" in
+  *\"* | *\`* | *\\*) ac_try_echo=\$ac_try;;
+  *) ac_try_echo=$ac_try;;
+esac
+eval "echo \"\$as_me:$LINENO: $ac_try_echo\"") >&5
+  (eval "$ac_cpp conftest.$ac_ext") 2>conftest.er1
   ac_status=$?
   grep -v '^ *+' conftest.er1 >conftest.err
   rm -f conftest.er1
   cat conftest.err >&5
   echo "$as_me:$LINENO: \$? = $ac_status" >&5
-  (exit $ac_status); } >/dev/null; then
-  if test -s conftest.err; then
-    ac_cpp_err=$ac_c_preproc_warn_flag
-    ac_cpp_err=$ac_cpp_err$ac_c_werror_flag
-  else
-    ac_cpp_err=
-  fi
-else
-  ac_cpp_err=yes
-fi
-if test -z "$ac_cpp_err"; then
+  (exit $ac_status); } >/dev/null && {
+	 test -z "$ac_c_preproc_warn_flag$ac_c_werror_flag" ||
+	 test ! -s conftest.err
+       }; then
   :
 else
   echo "$as_me: failed program was:" >&5
@@ -2624,9 +3444,10 @@
   # Broken: fails on valid input.
 continue
 fi
+
 rm -f conftest.err conftest.$ac_ext
 
-  # OK, works on sane cases.  Now check whether non-existent headers
+  # OK, works on sane cases.  Now check whether nonexistent headers
   # can be detected and how.
   cat >conftest.$ac_ext <<_ACEOF
 /* confdefs.h.  */
@@ -2636,24 +3457,22 @@
 /* end confdefs.h.  */
 #include <ac_nonexistent.h>
 _ACEOF
-if { (eval echo "$as_me:$LINENO: \"$ac_cpp conftest.$ac_ext\"") >&5
-  (eval $ac_cpp conftest.$ac_ext) 2>conftest.er1
+if { (ac_try="$ac_cpp conftest.$ac_ext"
+case "(($ac_try" in
+  *\"* | *\`* | *\\*) ac_try_echo=\$ac_try;;
+  *) ac_try_echo=$ac_try;;
+esac
+eval "echo \"\$as_me:$LINENO: $ac_try_echo\"") >&5
+  (eval "$ac_cpp conftest.$ac_ext") 2>conftest.er1
   ac_status=$?
   grep -v '^ *+' conftest.er1 >conftest.err
   rm -f conftest.er1
   cat conftest.err >&5
   echo "$as_me:$LINENO: \$? = $ac_status" >&5
-  (exit $ac_status); } >/dev/null; then
-  if test -s conftest.err; then
-    ac_cpp_err=$ac_c_preproc_warn_flag
-    ac_cpp_err=$ac_cpp_err$ac_c_werror_flag
-  else
-    ac_cpp_err=
-  fi
-else
-  ac_cpp_err=yes
-fi
-if test -z "$ac_cpp_err"; then
+  (exit $ac_status); } >/dev/null && {
+	 test -z "$ac_c_preproc_warn_flag$ac_c_werror_flag" ||
+	 test ! -s conftest.err
+       }; then
   # Broken: success on invalid input.
 continue
 else
@@ -2664,6 +3483,7 @@
 ac_preproc_ok=:
 break
 fi
+
 rm -f conftest.err conftest.$ac_ext
 
 done
@@ -2681,8 +3501,8 @@
 else
   ac_cv_prog_CPP=$CPP
 fi
-echo "$as_me:$LINENO: result: $CPP" >&5
-echo "${ECHO_T}$CPP" >&6
+{ echo "$as_me:$LINENO: result: $CPP" >&5
+echo "${ECHO_T}$CPP" >&6; }
 ac_preproc_ok=false
 for ac_c_preproc_warn_flag in '' yes
 do
@@ -2705,24 +3525,22 @@
 #endif
 		     Syntax error
 _ACEOF
-if { (eval echo "$as_me:$LINENO: \"$ac_cpp conftest.$ac_ext\"") >&5
-  (eval $ac_cpp conftest.$ac_ext) 2>conftest.er1
+if { (ac_try="$ac_cpp conftest.$ac_ext"
+case "(($ac_try" in
+  *\"* | *\`* | *\\*) ac_try_echo=\$ac_try;;
+  *) ac_try_echo=$ac_try;;
+esac
+eval "echo \"\$as_me:$LINENO: $ac_try_echo\"") >&5
+  (eval "$ac_cpp conftest.$ac_ext") 2>conftest.er1
   ac_status=$?
   grep -v '^ *+' conftest.er1 >conftest.err
   rm -f conftest.er1
   cat conftest.err >&5
   echo "$as_me:$LINENO: \$? = $ac_status" >&5
-  (exit $ac_status); } >/dev/null; then
-  if test -s conftest.err; then
-    ac_cpp_err=$ac_c_preproc_warn_flag
-    ac_cpp_err=$ac_cpp_err$ac_c_werror_flag
-  else
-    ac_cpp_err=
-  fi
-else
-  ac_cpp_err=yes
-fi
-if test -z "$ac_cpp_err"; then
+  (exit $ac_status); } >/dev/null && {
+	 test -z "$ac_c_preproc_warn_flag$ac_c_werror_flag" ||
+	 test ! -s conftest.err
+       }; then
   :
 else
   echo "$as_me: failed program was:" >&5
@@ -2731,9 +3549,10 @@
   # Broken: fails on valid input.
 continue
 fi
+
 rm -f conftest.err conftest.$ac_ext
 
-  # OK, works on sane cases.  Now check whether non-existent headers
+  # OK, works on sane cases.  Now check whether nonexistent headers
   # can be detected and how.
   cat >conftest.$ac_ext <<_ACEOF
 /* confdefs.h.  */
@@ -2743,24 +3562,22 @@
 /* end confdefs.h.  */
 #include <ac_nonexistent.h>
 _ACEOF
-if { (eval echo "$as_me:$LINENO: \"$ac_cpp conftest.$ac_ext\"") >&5
-  (eval $ac_cpp conftest.$ac_ext) 2>conftest.er1
+if { (ac_try="$ac_cpp conftest.$ac_ext"
+case "(($ac_try" in
+  *\"* | *\`* | *\\*) ac_try_echo=\$ac_try;;
+  *) ac_try_echo=$ac_try;;
+esac
+eval "echo \"\$as_me:$LINENO: $ac_try_echo\"") >&5
+  (eval "$ac_cpp conftest.$ac_ext") 2>conftest.er1
   ac_status=$?
   grep -v '^ *+' conftest.er1 >conftest.err
   rm -f conftest.er1
   cat conftest.err >&5
   echo "$as_me:$LINENO: \$? = $ac_status" >&5
-  (exit $ac_status); } >/dev/null; then
-  if test -s conftest.err; then
-    ac_cpp_err=$ac_c_preproc_warn_flag
-    ac_cpp_err=$ac_cpp_err$ac_c_werror_flag
-  else
-    ac_cpp_err=
-  fi
-else
-  ac_cpp_err=yes
-fi
-if test -z "$ac_cpp_err"; then
+  (exit $ac_status); } >/dev/null && {
+	 test -z "$ac_c_preproc_warn_flag$ac_c_werror_flag" ||
+	 test ! -s conftest.err
+       }; then
   # Broken: success on invalid input.
 continue
 else
@@ -2771,6 +3588,7 @@
 ac_preproc_ok=:
 break
 fi
+
 rm -f conftest.err conftest.$ac_ext
 
 done
@@ -2805,8 +3623,8 @@
 # SVR4 /usr/ucb/install, which tries to use the nonexistent group "staff"
 # OS/2's system install, which has a completely different semantic
 # ./install, which can be erroneously created by make from ./install.sh.
-echo "$as_me:$LINENO: checking for a BSD-compatible install" >&5
-echo $ECHO_N "checking for a BSD-compatible install... $ECHO_C" >&6
+{ echo "$as_me:$LINENO: checking for a BSD-compatible install" >&5
+echo $ECHO_N "checking for a BSD-compatible install... $ECHO_C" >&6; }
 if test -z "$INSTALL"; then
 if test "${ac_cv_path_install+set}" = set; then
   echo $ECHO_N "(cached) $ECHO_C" >&6
@@ -2828,7 +3646,7 @@
     # by default.
     for ac_prog in ginstall scoinst install; do
       for ac_exec_ext in '' $ac_executable_extensions; do
-	if $as_executable_p "$as_dir/$ac_prog$ac_exec_ext"; then
+	if { test -f "$as_dir/$ac_prog$ac_exec_ext" && $as_test_x "$as_dir/$ac_prog$ac_exec_ext"; }; then
 	  if test $ac_prog = install &&
 	    grep dspmsg "$as_dir/$ac_prog$ac_exec_ext" >/dev/null 2>&1; then
 	    # AIX install.  It has an incompatible calling convention.
@@ -2847,21 +3665,22 @@
     ;;
 esac
 done
+IFS=$as_save_IFS
 
 
 fi
   if test "${ac_cv_path_install+set}" = set; then
     INSTALL=$ac_cv_path_install
   else
-    # As a last resort, use the slow shell script.  We don't cache a
-    # path for INSTALL within a source directory, because that will
+    # As a last resort, use the slow shell script.  Don't cache a
+    # value for INSTALL within a source directory, because that will
     # break other packages using the cache if that directory is
-    # removed, or if the path is relative.
+    # removed, or if the value is a relative name.
     INSTALL=$ac_install_sh
   fi
 fi
-echo "$as_me:$LINENO: result: $INSTALL" >&5
-echo "${ECHO_T}$INSTALL" >&6
+{ echo "$as_me:$LINENO: result: $INSTALL" >&5
+echo "${ECHO_T}$INSTALL" >&6; }
 
 # Use test -z because SunOS4 sh mishandles braces in ${var-val}.
 # It thinks the first close brace ends the variable substitution.
@@ -2871,57 +3690,57 @@
 
 test -z "$INSTALL_DATA" && INSTALL_DATA='${INSTALL} -m 644'
 
-echo "$as_me:$LINENO: checking whether ln -s works" >&5
-echo $ECHO_N "checking whether ln -s works... $ECHO_C" >&6
+{ echo "$as_me:$LINENO: checking whether ln -s works" >&5
+echo $ECHO_N "checking whether ln -s works... $ECHO_C" >&6; }
 LN_S=$as_ln_s
 if test "$LN_S" = "ln -s"; then
-  echo "$as_me:$LINENO: result: yes" >&5
-echo "${ECHO_T}yes" >&6
+  { echo "$as_me:$LINENO: result: yes" >&5
+echo "${ECHO_T}yes" >&6; }
 else
-  echo "$as_me:$LINENO: result: no, using $LN_S" >&5
-echo "${ECHO_T}no, using $LN_S" >&6
+  { echo "$as_me:$LINENO: result: no, using $LN_S" >&5
+echo "${ECHO_T}no, using $LN_S" >&6; }
 fi
 
-echo "$as_me:$LINENO: checking whether ${MAKE-make} sets \$(MAKE)" >&5
-echo $ECHO_N "checking whether ${MAKE-make} sets \$(MAKE)... $ECHO_C" >&6
-set dummy ${MAKE-make}; ac_make=`echo "$2" | sed 'y,:./+-,___p_,'`
-if eval "test \"\${ac_cv_prog_make_${ac_make}_set+set}\" = set"; then
+{ echo "$as_me:$LINENO: checking whether ${MAKE-make} sets \$(MAKE)" >&5
+echo $ECHO_N "checking whether ${MAKE-make} sets \$(MAKE)... $ECHO_C" >&6; }
+set x ${MAKE-make}; ac_make=`echo "$2" | sed 's/+/p/g; s/[^a-zA-Z0-9_]/_/g'`
+if { as_var=ac_cv_prog_make_${ac_make}_set; eval "test \"\${$as_var+set}\" = set"; }; then
   echo $ECHO_N "(cached) $ECHO_C" >&6
 else
   cat >conftest.make <<\_ACEOF
+SHELL = /bin/sh
 all:
-	@echo 'ac_maketemp="$(MAKE)"'
+	@echo '@@@%%%=$(MAKE)=@@@%%%'
 _ACEOF
 # GNU make sometimes prints "make[1]: Entering...", which would confuse us.
-eval `${MAKE-make} -f conftest.make 2>/dev/null | grep temp=`
-if test -n "$ac_maketemp"; then
-  eval ac_cv_prog_make_${ac_make}_set=yes
-else
-  eval ac_cv_prog_make_${ac_make}_set=no
-fi
+case `${MAKE-make} -f conftest.make 2>/dev/null` in
+  *@@@%%%=?*=@@@%%%*)
+    eval ac_cv_prog_make_${ac_make}_set=yes;;
+  *)
+    eval ac_cv_prog_make_${ac_make}_set=no;;
+esac
 rm -f conftest.make
 fi
-if eval "test \"`echo '$ac_cv_prog_make_'${ac_make}_set`\" = yes"; then
-  echo "$as_me:$LINENO: result: yes" >&5
-echo "${ECHO_T}yes" >&6
+if eval test \$ac_cv_prog_make_${ac_make}_set = yes; then
+  { echo "$as_me:$LINENO: result: yes" >&5
+echo "${ECHO_T}yes" >&6; }
   SET_MAKE=
 else
-  echo "$as_me:$LINENO: result: no" >&5
-echo "${ECHO_T}no" >&6
+  { echo "$as_me:$LINENO: result: no" >&5
+echo "${ECHO_T}no" >&6; }
   SET_MAKE="MAKE=${MAKE-make}"
 fi
 
 
 # dmalloc
-echo "$as_me:$LINENO: checking if malloc debugging is wanted" >&5
-echo $ECHO_N "checking if malloc debugging is wanted... $ECHO_C" >&6
+{ echo "$as_me:$LINENO: checking if malloc debugging is wanted" >&5
+echo $ECHO_N "checking if malloc debugging is wanted... $ECHO_C" >&6; }
 
-# Check whether --with-dmalloc or --without-dmalloc was given.
+# Check whether --with-dmalloc was given.
 if test "${with_dmalloc+set}" = set; then
-  withval="$with_dmalloc"
-  if test "$withval" = yes; then
-  echo "$as_me:$LINENO: result: yes" >&5
-echo "${ECHO_T}yes" >&6
+  withval=$with_dmalloc; if test "$withval" = yes; then
+  { echo "$as_me:$LINENO: result: yes" >&5
+echo "${ECHO_T}yes" >&6; }
 
 cat >>confdefs.h <<\_ACEOF
 #define WITH_DMALLOC 1
@@ -2930,20 +3749,21 @@
   LIBS="$LIBS -ldmalloc"
   LDFLAGS="$LDFLAGS -g"
 else
-  echo "$as_me:$LINENO: result: no" >&5
-echo "${ECHO_T}no" >&6
+  { echo "$as_me:$LINENO: result: no" >&5
+echo "${ECHO_T}no" >&6; }
 fi
 else
-  echo "$as_me:$LINENO: result: no" >&5
-echo "${ECHO_T}no" >&6
-fi;
+  { echo "$as_me:$LINENO: result: no" >&5
+echo "${ECHO_T}no" >&6; }
+fi
+
 
 
 # Checks for libraries.
 
 
-echo "$as_me:$LINENO: checking for log in -lm" >&5
-echo $ECHO_N "checking for log in -lm... $ECHO_C" >&6
+{ echo "$as_me:$LINENO: checking for log in -lm" >&5
+echo $ECHO_N "checking for log in -lm... $ECHO_C" >&6; }
 if test "${ac_cv_lib_m_log+set}" = set; then
   echo $ECHO_N "(cached) $ECHO_C" >&6
 else
@@ -2956,55 +3776,53 @@
 cat >>conftest.$ac_ext <<_ACEOF
 /* end confdefs.h.  */
 
-/* Override any gcc2 internal prototype to avoid an error.  */
+/* Override any GCC internal prototype to avoid an error.
+   Use char because int might match the return type of a GCC
+   builtin and then its argument prototype would still apply.  */
 #ifdef __cplusplus
 extern "C"
 #endif
-/* We use char because int might match the return type of a gcc2
-   builtin and then its argument prototype would still apply.  */
 char log ();
 int
 main ()
 {
-log ();
+return log ();
   ;
   return 0;
 }
 _ACEOF
 rm -f conftest.$ac_objext conftest$ac_exeext
-if { (eval echo "$as_me:$LINENO: \"$ac_link\"") >&5
-  (eval $ac_link) 2>conftest.er1
+if { (ac_try="$ac_link"
+case "(($ac_try" in
+  *\"* | *\`* | *\\*) ac_try_echo=\$ac_try;;
+  *) ac_try_echo=$ac_try;;
+esac
+eval "echo \"\$as_me:$LINENO: $ac_try_echo\"") >&5
+  (eval "$ac_link") 2>conftest.er1
   ac_status=$?
   grep -v '^ *+' conftest.er1 >conftest.err
   rm -f conftest.er1
   cat conftest.err >&5
   echo "$as_me:$LINENO: \$? = $ac_status" >&5
-  (exit $ac_status); } &&
-	 { ac_try='test -z "$ac_c_werror_flag"			 || test ! -s conftest.err'
-  { (eval echo "$as_me:$LINENO: \"$ac_try\"") >&5
-  (eval $ac_try) 2>&5
-  ac_status=$?
-  echo "$as_me:$LINENO: \$? = $ac_status" >&5
-  (exit $ac_status); }; } &&
-	 { ac_try='test -s conftest$ac_exeext'
-  { (eval echo "$as_me:$LINENO: \"$ac_try\"") >&5
-  (eval $ac_try) 2>&5
-  ac_status=$?
-  echo "$as_me:$LINENO: \$? = $ac_status" >&5
-  (exit $ac_status); }; }; then
+  (exit $ac_status); } && {
+	 test -z "$ac_c_werror_flag" ||
+	 test ! -s conftest.err
+       } && test -s conftest$ac_exeext &&
+       $as_test_x conftest$ac_exeext; then
   ac_cv_lib_m_log=yes
 else
   echo "$as_me: failed program was:" >&5
 sed 's/^/| /' conftest.$ac_ext >&5
 
-ac_cv_lib_m_log=no
+	ac_cv_lib_m_log=no
 fi
-rm -f conftest.err conftest.$ac_objext \
+
+rm -f core conftest.err conftest.$ac_objext conftest_ipa8_conftest.oo \
       conftest$ac_exeext conftest.$ac_ext
 LIBS=$ac_check_lib_save_LIBS
 fi
-echo "$as_me:$LINENO: result: $ac_cv_lib_m_log" >&5
-echo "${ECHO_T}$ac_cv_lib_m_log" >&6
+{ echo "$as_me:$LINENO: result: $ac_cv_lib_m_log" >&5
+echo "${ECHO_T}$ac_cv_lib_m_log" >&6; }
 if test $ac_cv_lib_m_log = yes; then
   cat >>confdefs.h <<_ACEOF
 #define HAVE_LIBM 1
@@ -3039,37 +3857,185 @@
 
 
 
-echo "$as_me:$LINENO: checking for egrep" >&5
-echo $ECHO_N "checking for egrep... $ECHO_C" >&6
-if test "${ac_cv_prog_egrep+set}" = set; then
+
+
+{ echo "$as_me:$LINENO: checking for grep that handles long lines and -e" >&5
+echo $ECHO_N "checking for grep that handles long lines and -e... $ECHO_C" >&6; }
+if test "${ac_cv_path_GREP+set}" = set; then
+  echo $ECHO_N "(cached) $ECHO_C" >&6
+else
+  # Extract the first word of "grep ggrep" to use in msg output
+if test -z "$GREP"; then
+set dummy grep ggrep; ac_prog_name=$2
+if test "${ac_cv_path_GREP+set}" = set; then
   echo $ECHO_N "(cached) $ECHO_C" >&6
 else
-  if echo a | (grep -E '(a|b)') >/dev/null 2>&1
-    then ac_cv_prog_egrep='grep -E'
-    else ac_cv_prog_egrep='egrep'
+  ac_path_GREP_found=false
+# Loop through the user's path and test for each of PROGNAME-LIST
+as_save_IFS=$IFS; IFS=$PATH_SEPARATOR
+for as_dir in $PATH$PATH_SEPARATOR/usr/xpg4/bin
+do
+  IFS=$as_save_IFS
+  test -z "$as_dir" && as_dir=.
+  for ac_prog in grep ggrep; do
+  for ac_exec_ext in '' $ac_executable_extensions; do
+    ac_path_GREP="$as_dir/$ac_prog$ac_exec_ext"
+    { test -f "$ac_path_GREP" && $as_test_x "$ac_path_GREP"; } || continue
+    # Check for GNU ac_path_GREP and select it if it is found.
+  # Check for GNU $ac_path_GREP
+case `"$ac_path_GREP" --version 2>&1` in
+*GNU*)
+  ac_cv_path_GREP="$ac_path_GREP" ac_path_GREP_found=:;;
+*)
+  ac_count=0
+  echo $ECHO_N "0123456789$ECHO_C" >"conftest.in"
+  while :
+  do
+    cat "conftest.in" "conftest.in" >"conftest.tmp"
+    mv "conftest.tmp" "conftest.in"
+    cp "conftest.in" "conftest.nl"
+    echo 'GREP' >> "conftest.nl"
+    "$ac_path_GREP" -e 'GREP$' -e '-(cannot match)-' < "conftest.nl" >"conftest.out" 2>/dev/null || break
+    diff "conftest.out" "conftest.nl" >/dev/null 2>&1 || break
+    ac_count=`expr $ac_count + 1`
+    if test $ac_count -gt ${ac_path_GREP_max-0}; then
+      # Best one so far, save it but keep looking for a better one
+      ac_cv_path_GREP="$ac_path_GREP"
+      ac_path_GREP_max=$ac_count
     fi
-fi
-echo "$as_me:$LINENO: result: $ac_cv_prog_egrep" >&5
-echo "${ECHO_T}$ac_cv_prog_egrep" >&6
- EGREP=$ac_cv_prog_egrep
+    # 10*(2^10) chars as input seems more than enough
+    test $ac_count -gt 10 && break
+  done
+  rm -f conftest.in conftest.tmp conftest.nl conftest.out;;
+esac
 
 
+    $ac_path_GREP_found && break 3
+  done
+done
 
-	search_ncurses=true
-	screen_manager=""
-	has_curses=false
+done
+IFS=$as_save_IFS
 
-	CFLAGS=${CFLAGS--O}
 
+fi
 
+GREP="$ac_cv_path_GREP"
+if test -z "$GREP"; then
+  { { echo "$as_me:$LINENO: error: no acceptable $ac_prog_name could be found in $PATH$PATH_SEPARATOR/usr/xpg4/bin" >&5
+echo "$as_me: error: no acceptable $ac_prog_name could be found in $PATH$PATH_SEPARATOR/usr/xpg4/bin" >&2;}
+   { (exit 1); exit 1; }; }
+fi
 
+else
+  ac_cv_path_GREP=$GREP
+fi
 
 
-# Check whether --with-sco or --without-sco was given.
-if test "${with_sco+set}" = set; then
-  withval="$with_sco"
+fi
+{ echo "$as_me:$LINENO: result: $ac_cv_path_GREP" >&5
+echo "${ECHO_T}$ac_cv_path_GREP" >&6; }
+ GREP="$ac_cv_path_GREP"
 
-	  if test x$withval = xyes; then
+
+{ echo "$as_me:$LINENO: checking for egrep" >&5
+echo $ECHO_N "checking for egrep... $ECHO_C" >&6; }
+if test "${ac_cv_path_EGREP+set}" = set; then
+  echo $ECHO_N "(cached) $ECHO_C" >&6
+else
+  if echo a | $GREP -E '(a|b)' >/dev/null 2>&1
+   then ac_cv_path_EGREP="$GREP -E"
+   else
+     # Extract the first word of "egrep" to use in msg output
+if test -z "$EGREP"; then
+set dummy egrep; ac_prog_name=$2
+if test "${ac_cv_path_EGREP+set}" = set; then
+  echo $ECHO_N "(cached) $ECHO_C" >&6
+else
+  ac_path_EGREP_found=false
+# Loop through the user's path and test for each of PROGNAME-LIST
+as_save_IFS=$IFS; IFS=$PATH_SEPARATOR
+for as_dir in $PATH$PATH_SEPARATOR/usr/xpg4/bin
+do
+  IFS=$as_save_IFS
+  test -z "$as_dir" && as_dir=.
+  for ac_prog in egrep; do
+  for ac_exec_ext in '' $ac_executable_extensions; do
+    ac_path_EGREP="$as_dir/$ac_prog$ac_exec_ext"
+    { test -f "$ac_path_EGREP" && $as_test_x "$ac_path_EGREP"; } || continue
+    # Check for GNU ac_path_EGREP and select it if it is found.
+  # Check for GNU $ac_path_EGREP
+case `"$ac_path_EGREP" --version 2>&1` in
+*GNU*)
+  ac_cv_path_EGREP="$ac_path_EGREP" ac_path_EGREP_found=:;;
+*)
+  ac_count=0
+  echo $ECHO_N "0123456789$ECHO_C" >"conftest.in"
+  while :
+  do
+    cat "conftest.in" "conftest.in" >"conftest.tmp"
+    mv "conftest.tmp" "conftest.in"
+    cp "conftest.in" "conftest.nl"
+    echo 'EGREP' >> "conftest.nl"
+    "$ac_path_EGREP" 'EGREP$' < "conftest.nl" >"conftest.out" 2>/dev/null || break
+    diff "conftest.out" "conftest.nl" >/dev/null 2>&1 || break
+    ac_count=`expr $ac_count + 1`
+    if test $ac_count -gt ${ac_path_EGREP_max-0}; then
+      # Best one so far, save it but keep looking for a better one
+      ac_cv_path_EGREP="$ac_path_EGREP"
+      ac_path_EGREP_max=$ac_count
+    fi
+    # 10*(2^10) chars as input seems more than enough
+    test $ac_count -gt 10 && break
+  done
+  rm -f conftest.in conftest.tmp conftest.nl conftest.out;;
+esac
+
+
+    $ac_path_EGREP_found && break 3
+  done
+done
+
+done
+IFS=$as_save_IFS
+
+
+fi
+
+EGREP="$ac_cv_path_EGREP"
+if test -z "$EGREP"; then
+  { { echo "$as_me:$LINENO: error: no acceptable $ac_prog_name could be found in $PATH$PATH_SEPARATOR/usr/xpg4/bin" >&5
+echo "$as_me: error: no acceptable $ac_prog_name could be found in $PATH$PATH_SEPARATOR/usr/xpg4/bin" >&2;}
+   { (exit 1); exit 1; }; }
+fi
+
+else
+  ac_cv_path_EGREP=$EGREP
+fi
+
+
+   fi
+fi
+{ echo "$as_me:$LINENO: result: $ac_cv_path_EGREP" >&5
+echo "${ECHO_T}$ac_cv_path_EGREP" >&6; }
+ EGREP="$ac_cv_path_EGREP"
+
+
+
+	search_ncurses=true
+	screen_manager=""
+	has_curses=false
+
+	CFLAGS=${CFLAGS--O}
+
+
+
+
+
+# Check whether --with-sco was given.
+if test "${with_sco+set}" = set; then
+  withval=$with_sco;
+	  if test x$withval = xyes; then
 
 cat >>confdefs.h <<\_ACEOF
 #define SCO_FLAVOR 1
@@ -3078,19 +4044,19 @@
 		CFLAGS="$CFLAGS -D_SVID3"
 	  fi
 
-fi;
+fi
 
 
-# Check whether --with-sunos-curses or --without-sunos-curses was given.
-if test "${with_sunos_curses+set}" = set; then
-  withval="$with_sunos_curses"
 
+# Check whether --with-sunos-curses was given.
+if test "${with_sunos_curses+set}" = set; then
+  withval=$with_sunos_curses;
 	  if test x$withval = xyes; then
 
 	search_ncurses=false
 	screen_manager="SunOS 4.x /usr/5include curses"
-	echo "$as_me:$LINENO: result: Using SunOS 4.x /usr/5include curses" >&5
-echo "${ECHO_T}Using SunOS 4.x /usr/5include curses" >&6
+	{ echo "$as_me:$LINENO: result: Using SunOS 4.x /usr/5include curses" >&5
+echo "${ECHO_T}Using SunOS 4.x /usr/5include curses" >&6; }
 
 cat >>confdefs.h <<\_ACEOF
 #define USE_SUNOS_CURSES 1
@@ -3114,22 +4080,22 @@
 
 	CURSES_INCLUDEDIR="-I/usr/5include"
 	CURSES_LIBS="/usr/5lib/libcurses.a /usr/5lib/libtermcap.a"
-	echo "$as_me:$LINENO: result: Please note that some screen refreshs may fail" >&5
-echo "${ECHO_T}Please note that some screen refreshs may fail" >&6
+	{ echo "$as_me:$LINENO: result: Please note that some screen refreshs may fail" >&5
+echo "${ECHO_T}Please note that some screen refreshs may fail" >&6; }
 
 	  fi
 
-fi;
+fi
 
 
-# Check whether --with-osf1-curses or --without-osf1-curses was given.
-if test "${with_osf1_curses+set}" = set; then
-  withval="$with_osf1_curses"
 
+# Check whether --with-osf1-curses was given.
+if test "${with_osf1_curses+set}" = set; then
+  withval=$with_osf1_curses;
 	  if test x$withval = xyes; then
 
-       echo "$as_me:$LINENO: result: Using OSF1 curses" >&5
-echo "${ECHO_T}Using OSF1 curses" >&6
+       { echo "$as_me:$LINENO: result: Using OSF1 curses" >&5
+echo "${ECHO_T}Using OSF1 curses" >&6; }
        search_ncurses=false
        screen_manager="OSF1 curses"
 
@@ -3152,18 +4118,18 @@
 
 	  fi
 
-fi;
+fi
 
 
-# Check whether --with-vcurses or --without-vcurses was given.
+
+# Check whether --with-vcurses was given.
 if test "${with_vcurses+set}" = set; then
-  withval="$with_vcurses"
-  if test x$withval != xyes; then
+  withval=$with_vcurses; if test x$withval != xyes; then
 		CURSES_INCLUDEDIR="-I$withval"
 	  fi
 
-	echo "$as_me:$LINENO: result: Using SysV curses" >&5
-echo "${ECHO_T}Using SysV curses" >&6
+	{ echo "$as_me:$LINENO: result: Using SysV curses" >&5
+echo "${ECHO_T}Using SysV curses" >&6; }
 
 cat >>confdefs.h <<\_ACEOF
 #define HAS_CURSES 1
@@ -3180,13 +4146,13 @@
 	CURSES_LIBS="-lcurses"
 
 
-fi;
+fi
+
 
 
-# Check whether --with-ncurses or --without-ncurses was given.
+# Check whether --with-ncurses was given.
 if test "${with_ncurses+set}" = set; then
-  withval="$with_ncurses"
-  if test x$withval = xno ; then
+  withval=$with_ncurses; if test x$withval = xno ; then
 		search_ncurses=false
 	  elif test x$withval != xyes ; then
 		CURSES_LIBS="$LIBS -L$withval/lib -lncurses"
@@ -3206,7 +4172,8 @@
 		has_curses=true
 	  fi
 
-fi;
+fi
+
 
 	if $search_ncurses
 	then
@@ -3219,8 +4186,8 @@
     then
         if test -f /usr/include/ncurses.h
 	then
-	    echo "$as_me:$LINENO: result: Found ncurses on /usr/include/ncurses.h" >&5
-echo "${ECHO_T}Found ncurses on /usr/include/ncurses.h" >&6
+	    { echo "$as_me:$LINENO: result: Found ncurses on /usr/include/ncurses.h" >&5
+echo "${ECHO_T}Found ncurses on /usr/include/ncurses.h" >&6; }
  	    CURSES_LIBS="-lncurses"
 	    CURSES_INCLUDEDIR=""
 	    search_ncurses=false
@@ -3244,8 +4211,8 @@
     then
         if test -f /usr/include/ncurses/ncurses.h
 	then
-	    echo "$as_me:$LINENO: result: Found ncurses on /usr/include/ncurses/ncurses.h" >&5
-echo "${ECHO_T}Found ncurses on /usr/include/ncurses/ncurses.h" >&6
+	    { echo "$as_me:$LINENO: result: Found ncurses on /usr/include/ncurses/ncurses.h" >&5
+echo "${ECHO_T}Found ncurses on /usr/include/ncurses/ncurses.h" >&6; }
  	    CURSES_LIBS="-lncurses"
 	    CURSES_INCLUDEDIR="-I/usr/include/ncurses"
 	    search_ncurses=false
@@ -3269,8 +4236,8 @@
     then
         if test -f /usr/local/include/ncurses.h
 	then
-	    echo "$as_me:$LINENO: result: Found ncurses on /usr/local/include/ncurses.h" >&5
-echo "${ECHO_T}Found ncurses on /usr/local/include/ncurses.h" >&6
+	    { echo "$as_me:$LINENO: result: Found ncurses on /usr/local/include/ncurses.h" >&5
+echo "${ECHO_T}Found ncurses on /usr/local/include/ncurses.h" >&6; }
  	    CURSES_LIBS="-L/usr/local/lib -lncurses"
 	    CURSES_INCLUDEDIR="-I/usr/local/include"
 	    search_ncurses=false
@@ -3294,8 +4261,8 @@
     then
         if test -f /usr/local/include/ncurses/ncurses.h
 	then
-	    echo "$as_me:$LINENO: result: Found ncurses on /usr/local/include/ncurses/ncurses.h" >&5
-echo "${ECHO_T}Found ncurses on /usr/local/include/ncurses/ncurses.h" >&6
+	    { echo "$as_me:$LINENO: result: Found ncurses on /usr/local/include/ncurses/ncurses.h" >&5
+echo "${ECHO_T}Found ncurses on /usr/local/include/ncurses/ncurses.h" >&6; }
  	    CURSES_LIBS="-L/usr/local/lib -L/usr/local/lib/ncurses -lncurses"
 	    CURSES_INCLUDEDIR="-I/usr/local/include/ncurses"
 	    search_ncurses=false
@@ -3320,8 +4287,8 @@
     then
         if test -f /usr/local/include/ncurses/curses.h
 	then
-	    echo "$as_me:$LINENO: result: Found ncurses on /usr/local/include/ncurses/curses.h" >&5
-echo "${ECHO_T}Found ncurses on /usr/local/include/ncurses/curses.h" >&6
+	    { echo "$as_me:$LINENO: result: Found ncurses on /usr/local/include/ncurses/curses.h" >&5
+echo "${ECHO_T}Found ncurses on /usr/local/include/ncurses/curses.h" >&6; }
  	    CURSES_LIBS="-L/usr/local/lib -lncurses"
 	    CURSES_INCLUDEDIR="-I/usr/local/include/ncurses -DRENAMED_NCURSES"
 	    search_ncurses=false
@@ -3346,8 +4313,8 @@
     then
         if test -f /usr/include/ncurses/curses.h
 	then
-	    echo "$as_me:$LINENO: result: Found ncurses on /usr/include/ncurses/curses.h" >&5
-echo "${ECHO_T}Found ncurses on /usr/include/ncurses/curses.h" >&6
+	    { echo "$as_me:$LINENO: result: Found ncurses on /usr/include/ncurses/curses.h" >&5
+echo "${ECHO_T}Found ncurses on /usr/include/ncurses/curses.h" >&6; }
  	    CURSES_LIBS="-lncurses"
 	    CURSES_INCLUDEDIR="-I/usr/include/ncurses -DRENAMED_NCURSES"
 	    search_ncurses=false
@@ -3381,8 +4348,8 @@
 if (eval "$ac_cpp conftest.$ac_ext") 2>&5 |
   $EGREP "init_color" >/dev/null 2>&1; then
 
-	echo "$as_me:$LINENO: result: Using SysV curses" >&5
-echo "${ECHO_T}Using SysV curses" >&6
+	{ echo "$as_me:$LINENO: result: Using SysV curses" >&5
+echo "${ECHO_T}Using SysV curses" >&6; }
 
 cat >>confdefs.h <<\_ACEOF
 #define HAS_CURSES 1
@@ -3445,8 +4412,8 @@
 
 	search_ncurses=false
 	screen_manager="SunOS 4.x /usr/5include curses"
-	echo "$as_me:$LINENO: result: Using SunOS 4.x /usr/5include curses" >&5
-echo "${ECHO_T}Using SunOS 4.x /usr/5include curses" >&6
+	{ echo "$as_me:$LINENO: result: Using SunOS 4.x /usr/5include curses" >&5
+echo "${ECHO_T}Using SunOS 4.x /usr/5include curses" >&6; }
 
 cat >>confdefs.h <<\_ACEOF
 #define USE_SUNOS_CURSES 1
@@ -3470,17 +4437,17 @@
 
 	CURSES_INCLUDEDIR="-I/usr/5include"
 	CURSES_LIBS="/usr/5lib/libcurses.a /usr/5lib/libtermcap.a"
-	echo "$as_me:$LINENO: result: Please note that some screen refreshs may fail" >&5
-echo "${ECHO_T}Please note that some screen refreshs may fail" >&6
+	{ echo "$as_me:$LINENO: result: Please note that some screen refreshs may fail" >&5
+echo "${ECHO_T}Please note that some screen refreshs may fail" >&6; }
 
         fi
     else
         # check for ncurses version, to properly ifdef mouse-fix
-	echo "$as_me:$LINENO: checking for ncurses version" >&5
-echo $ECHO_N "checking for ncurses version... $ECHO_C" >&6
+	{ echo "$as_me:$LINENO: checking for ncurses version" >&5
+echo $ECHO_N "checking for ncurses version... $ECHO_C" >&6; }
 	ncurses_version=unknown
 cat > conftest.$ac_ext <<EOF
-#line 3483 "configure"
+#line 4450 "configure"
 #include "confdefs.h"
 #ifdef RENAMED_NCURSES
 #include <curses.h>
@@ -3495,8 +4462,8 @@
             ncurses_version=`cat conftest.out|sed -e 's/^[^"]*"//' -e 's/".*//'`
 	fi
 	rm -rf conftest*
-        echo "$as_me:$LINENO: result: $ncurses_version" >&5
-echo "${ECHO_T}$ncurses_version" >&6
+        { echo "$as_me:$LINENO: result: $ncurses_version" >&5
+echo "${ECHO_T}$ncurses_version" >&6; }
 	case "$ncurses_version" in
 	4.[01])
 
@@ -3528,47 +4495,49 @@
 
 
 # Checks for X11
+{ echo "$as_me:$LINENO: checking for X" >&5
+echo $ECHO_N "checking for X... $ECHO_C" >&6; }
 
-if test "x$ac_path_x_has_been_run" != xyes; then
-  echo "$as_me:$LINENO: checking for X" >&5
-echo $ECHO_N "checking for X... $ECHO_C" >&6
-
-ac_path_x_has_been_run=yes
 
-# Check whether --with-x or --without-x was given.
+# Check whether --with-x was given.
 if test "${with_x+set}" = set; then
-  withval="$with_x"
+  withval=$with_x;
+fi
 
-fi;
 # $have_x is `yes', `no', `disabled', or empty when we do not yet know.
 if test "x$with_x" = xno; then
   # The user explicitly disabled X.
   have_x=disabled
 else
-  if test "x$x_includes" != xNONE && test "x$x_libraries" != xNONE; then
-    # Both variables are already set.
-    have_x=yes
-  else
-    if test "${ac_cv_have_x+set}" = set; then
+  case $x_includes,$x_libraries in #(
+    *\'*) { { echo "$as_me:$LINENO: error: Cannot use X directory names containing '" >&5
+echo "$as_me: error: Cannot use X directory names containing '" >&2;}
+   { (exit 1); exit 1; }; };; #(
+    *,NONE | NONE,*) if test "${ac_cv_have_x+set}" = set; then
   echo $ECHO_N "(cached) $ECHO_C" >&6
 else
   # One or both of the vars are not set, and there is no cached value.
 ac_x_includes=no ac_x_libraries=no
-rm -fr conftest.dir
+rm -f -r conftest.dir
 if mkdir conftest.dir; then
   cd conftest.dir
-  # Make sure to not put "make" in the Imakefile rules, since we grep it out.
   cat >Imakefile <<'_ACEOF'
-acfindx:
-	@echo 'ac_im_incroot="${INCROOT}"; ac_im_usrlibdir="${USRLIBDIR}"; ac_im_libdir="${LIBDIR}"'
+incroot:
+	@echo incroot='${INCROOT}'
+usrlibdir:
+	@echo usrlibdir='${USRLIBDIR}'
+libdir:
+	@echo libdir='${LIBDIR}'
 _ACEOF
-  if (xmkmf) >/dev/null 2>/dev/null && test -f Makefile; then
+  if (export CC; ${XMKMF-xmkmf}) >/dev/null 2>/dev/null && test -f Makefile; then
     # GNU make sometimes prints "make[1]: Entering...", which would confuse us.
-    eval `${MAKE-make} acfindx 2>/dev/null | grep -v make`
+    for ac_var in incroot usrlibdir libdir; do
+      eval "ac_im_$ac_var=\`\${MAKE-make} $ac_var 2>/dev/null | sed -n 's/^$ac_var=//p'\`"
+    done
     # Open Windows xmkmf reportedly sets LIBDIR instead of USRLIBDIR.
     for ac_extension in a so sl; do
-      if test ! -f $ac_im_usrlibdir/libX11.$ac_extension &&
-	 test -f $ac_im_libdir/libX11.$ac_extension; then
+      if test ! -f "$ac_im_usrlibdir/libX11.$ac_extension" &&
+	 test -f "$ac_im_libdir/libX11.$ac_extension"; then
 	ac_im_usrlibdir=$ac_im_libdir; break
       fi
     done
@@ -3576,7 +4545,7 @@
     # bogus both because they are the default anyway, and because
     # using them would break gcc on systems where it needs fixed includes.
     case $ac_im_incroot in
-	/usr/include) ;;
+	/usr/include) ac_x_includes= ;;
 	*) test -f "$ac_im_incroot/X11/Xos.h" && ac_x_includes=$ac_im_incroot;;
     esac
     case $ac_im_usrlibdir in
@@ -3585,7 +4554,7 @@
     esac
   fi
   cd ..
-  rm -fr conftest.dir
+  rm -f -r conftest.dir
 fi
 
 # Standard set of common directories for X headers.
@@ -3626,7 +4595,7 @@
 /usr/openwin/share/include'
 
 if test "$ac_x_includes" = no; then
-  # Guess where to find include files, by looking for a specified header file.
+  # Guess where to find include files, by looking for Xlib.h.
   # First, try using that file with no special directory specified.
   cat >conftest.$ac_ext <<_ACEOF
 /* confdefs.h.  */
@@ -3634,26 +4603,24 @@
 cat confdefs.h >>conftest.$ac_ext
 cat >>conftest.$ac_ext <<_ACEOF
 /* end confdefs.h.  */
-#include <X11/Intrinsic.h>
+#include <X11/Xlib.h>
 _ACEOF
-if { (eval echo "$as_me:$LINENO: \"$ac_cpp conftest.$ac_ext\"") >&5
-  (eval $ac_cpp conftest.$ac_ext) 2>conftest.er1
+if { (ac_try="$ac_cpp conftest.$ac_ext"
+case "(($ac_try" in
+  *\"* | *\`* | *\\*) ac_try_echo=\$ac_try;;
+  *) ac_try_echo=$ac_try;;
+esac
+eval "echo \"\$as_me:$LINENO: $ac_try_echo\"") >&5
+  (eval "$ac_cpp conftest.$ac_ext") 2>conftest.er1
   ac_status=$?
   grep -v '^ *+' conftest.er1 >conftest.err
   rm -f conftest.er1
   cat conftest.err >&5
   echo "$as_me:$LINENO: \$? = $ac_status" >&5
-  (exit $ac_status); } >/dev/null; then
-  if test -s conftest.err; then
-    ac_cpp_err=$ac_c_preproc_warn_flag
-    ac_cpp_err=$ac_cpp_err$ac_c_werror_flag
-  else
-    ac_cpp_err=
-  fi
-else
-  ac_cpp_err=yes
-fi
-if test -z "$ac_cpp_err"; then
+  (exit $ac_status); } >/dev/null && {
+	 test -z "$ac_c_preproc_warn_flag$ac_c_werror_flag" ||
+	 test ! -s conftest.err
+       }; then
   # We can compile using X headers with no special include directory.
 ac_x_includes=
 else
@@ -3661,12 +4628,13 @@
 sed 's/^/| /' conftest.$ac_ext >&5
 
   for ac_dir in $ac_x_header_dirs; do
-  if test -r "$ac_dir/X11/Intrinsic.h"; then
+  if test -r "$ac_dir/X11/Xlib.h"; then
     ac_x_includes=$ac_dir
     break
   fi
 done
 fi
+
 rm -f conftest.err conftest.$ac_ext
 fi # $ac_x_includes = no
 
@@ -3675,43 +4643,40 @@
   # See if we find them without any special options.
   # Don't add to $LIBS permanently.
   ac_save_LIBS=$LIBS
-  LIBS="-lXt $LIBS"
+  LIBS="-lX11 $LIBS"
   cat >conftest.$ac_ext <<_ACEOF
 /* confdefs.h.  */
 _ACEOF
 cat confdefs.h >>conftest.$ac_ext
 cat >>conftest.$ac_ext <<_ACEOF
 /* end confdefs.h.  */
-#include <X11/Intrinsic.h>
+#include <X11/Xlib.h>
 int
 main ()
 {
-XtMalloc (0)
+XrmInitialize ()
   ;
   return 0;
 }
 _ACEOF
 rm -f conftest.$ac_objext conftest$ac_exeext
-if { (eval echo "$as_me:$LINENO: \"$ac_link\"") >&5
-  (eval $ac_link) 2>conftest.er1
+if { (ac_try="$ac_link"
+case "(($ac_try" in
+  *\"* | *\`* | *\\*) ac_try_echo=\$ac_try;;
+  *) ac_try_echo=$ac_try;;
+esac
+eval "echo \"\$as_me:$LINENO: $ac_try_echo\"") >&5
+  (eval "$ac_link") 2>conftest.er1
   ac_status=$?
   grep -v '^ *+' conftest.er1 >conftest.err
   rm -f conftest.er1
   cat conftest.err >&5
   echo "$as_me:$LINENO: \$? = $ac_status" >&5
-  (exit $ac_status); } &&
-	 { ac_try='test -z "$ac_c_werror_flag"			 || test ! -s conftest.err'
-  { (eval echo "$as_me:$LINENO: \"$ac_try\"") >&5
-  (eval $ac_try) 2>&5
-  ac_status=$?
-  echo "$as_me:$LINENO: \$? = $ac_status" >&5
-  (exit $ac_status); }; } &&
-	 { ac_try='test -s conftest$ac_exeext'
-  { (eval echo "$as_me:$LINENO: \"$ac_try\"") >&5
-  (eval $ac_try) 2>&5
-  ac_status=$?
-  echo "$as_me:$LINENO: \$? = $ac_status" >&5
-  (exit $ac_status); }; }; then
+  (exit $ac_status); } && {
+	 test -z "$ac_c_werror_flag" ||
+	 test ! -s conftest.err
+       } && test -s conftest$ac_exeext &&
+       $as_test_x conftest$ac_exeext; then
   LIBS=$ac_save_LIBS
 # We can link X programs with no special library path.
 ac_x_libraries=
@@ -3719,56 +4684,56 @@
   echo "$as_me: failed program was:" >&5
 sed 's/^/| /' conftest.$ac_ext >&5
 
-LIBS=$ac_save_LIBS
+	LIBS=$ac_save_LIBS
 for ac_dir in `echo "$ac_x_includes $ac_x_header_dirs" | sed s/include/lib/g`
 do
   # Don't even attempt the hair of trying to link an X program!
   for ac_extension in a so sl; do
-    if test -r $ac_dir/libXt.$ac_extension; then
+    if test -r "$ac_dir/libX11.$ac_extension"; then
       ac_x_libraries=$ac_dir
       break 2
     fi
   done
 done
 fi
-rm -f conftest.err conftest.$ac_objext \
+
+rm -f core conftest.err conftest.$ac_objext conftest_ipa8_conftest.oo \
       conftest$ac_exeext conftest.$ac_ext
 fi # $ac_x_libraries = no
 
-if test "$ac_x_includes" = no || test "$ac_x_libraries" = no; then
-  # Didn't find X anywhere.  Cache the known absence of X.
-  ac_cv_have_x="have_x=no"
-else
-  # Record where we found X for the cache.
-  ac_cv_have_x="have_x=yes \
-		ac_x_includes=$ac_x_includes ac_x_libraries=$ac_x_libraries"
-fi
+case $ac_x_includes,$ac_x_libraries in #(
+  no,* | *,no | *\'*)
+    # Didn't find X, or a directory has "'" in its name.
+    ac_cv_have_x="have_x=no";; #(
+  *)
+    # Record where we found X for the cache.
+    ac_cv_have_x="have_x=yes\
+	ac_x_includes='$ac_x_includes'\
+	ac_x_libraries='$ac_x_libraries'"
+esac
 fi
-
-  fi
+;; #(
+    *) have_x=yes;;
+  esac
   eval "$ac_cv_have_x"
 fi # $with_x != no
 
 if test "$have_x" != yes; then
-  echo "$as_me:$LINENO: result: $have_x" >&5
-echo "${ECHO_T}$have_x" >&6
+  { echo "$as_me:$LINENO: result: $have_x" >&5
+echo "${ECHO_T}$have_x" >&6; }
   no_x=yes
 else
   # If each of the values was on the command line, it overrides each guess.
   test "x$x_includes" = xNONE && x_includes=$ac_x_includes
   test "x$x_libraries" = xNONE && x_libraries=$ac_x_libraries
   # Update the cache value to reflect the command line values.
-  ac_cv_have_x="have_x=yes \
-		ac_x_includes=$x_includes ac_x_libraries=$x_libraries"
-  # It might be that x_includes is empty (headers are found in the
-  # standard search path. Then output the corresponding message
-  ac_out_x_includes=$x_includes
-  test "x$x_includes" = x && ac_out_x_includes="in standard search path"
-  echo "$as_me:$LINENO: result: libraries $x_libraries, headers $ac_out_x_includes" >&5
-echo "${ECHO_T}libraries $x_libraries, headers $ac_out_x_includes" >&6
+  ac_cv_have_x="have_x=yes\
+	ac_x_includes='$x_includes'\
+	ac_x_libraries='$x_libraries'"
+  { echo "$as_me:$LINENO: result: libraries $x_libraries, headers $x_includes" >&5
+echo "${ECHO_T}libraries $x_libraries, headers $x_includes" >&6; }
 fi
 
-fi
 if test "$no_x" = yes; then
   # Not all programs may use this symbol, but it does not hurt to define it.
 
@@ -3787,12 +4752,12 @@
     X_LIBS="$X_LIBS -L$x_libraries"
     # For Solaris; some versions of Sun CC require a space after -R and
     # others require no space.  Words are not sufficient . . . .
-    case `(uname -sr) 2>/dev/null` in
-    "SunOS 5"*)
-      echo "$as_me:$LINENO: checking whether -R must be followed by a space" >&5
-echo $ECHO_N "checking whether -R must be followed by a space... $ECHO_C" >&6
-      ac_xsave_LIBS=$LIBS; LIBS="$LIBS -R$x_libraries"
-      cat >conftest.$ac_ext <<_ACEOF
+    { echo "$as_me:$LINENO: checking whether -R must be followed by a space" >&5
+echo $ECHO_N "checking whether -R must be followed by a space... $ECHO_C" >&6; }
+    ac_xsave_LIBS=$LIBS; LIBS="$LIBS -R$x_libraries"
+    ac_xsave_c_werror_flag=$ac_c_werror_flag
+    ac_c_werror_flag=yes
+    cat >conftest.$ac_ext <<_ACEOF
 /* confdefs.h.  */
 _ACEOF
 cat confdefs.h >>conftest.$ac_ext
@@ -3808,42 +4773,32 @@
 }
 _ACEOF
 rm -f conftest.$ac_objext conftest$ac_exeext
-if { (eval echo "$as_me:$LINENO: \"$ac_link\"") >&5
-  (eval $ac_link) 2>conftest.er1
+if { (ac_try="$ac_link"
+case "(($ac_try" in
+  *\"* | *\`* | *\\*) ac_try_echo=\$ac_try;;
+  *) ac_try_echo=$ac_try;;
+esac
+eval "echo \"\$as_me:$LINENO: $ac_try_echo\"") >&5
+  (eval "$ac_link") 2>conftest.er1
   ac_status=$?
   grep -v '^ *+' conftest.er1 >conftest.err
   rm -f conftest.er1
   cat conftest.err >&5
   echo "$as_me:$LINENO: \$? = $ac_status" >&5
-  (exit $ac_status); } &&
-	 { ac_try='test -z "$ac_c_werror_flag"			 || test ! -s conftest.err'
-  { (eval echo "$as_me:$LINENO: \"$ac_try\"") >&5
-  (eval $ac_try) 2>&5
-  ac_status=$?
-  echo "$as_me:$LINENO: \$? = $ac_status" >&5
-  (exit $ac_status); }; } &&
-	 { ac_try='test -s conftest$ac_exeext'
-  { (eval echo "$as_me:$LINENO: \"$ac_try\"") >&5
-  (eval $ac_try) 2>&5
-  ac_status=$?
-  echo "$as_me:$LINENO: \$? = $ac_status" >&5
-  (exit $ac_status); }; }; then
-  ac_R_nospace=yes
+  (exit $ac_status); } && {
+	 test -z "$ac_c_werror_flag" ||
+	 test ! -s conftest.err
+       } && test -s conftest$ac_exeext &&
+       $as_test_x conftest$ac_exeext; then
+  { echo "$as_me:$LINENO: result: no" >&5
+echo "${ECHO_T}no" >&6; }
+       X_LIBS="$X_LIBS -R$x_libraries"
 else
   echo "$as_me: failed program was:" >&5
 sed 's/^/| /' conftest.$ac_ext >&5
 
-ac_R_nospace=no
-fi
-rm -f conftest.err conftest.$ac_objext \
-      conftest$ac_exeext conftest.$ac_ext
-      if test $ac_R_nospace = yes; then
-	echo "$as_me:$LINENO: result: no" >&5
-echo "${ECHO_T}no" >&6
-	X_LIBS="$X_LIBS -R$x_libraries"
-      else
 	LIBS="$ac_xsave_LIBS -R $x_libraries"
-	cat >conftest.$ac_ext <<_ACEOF
+       cat >conftest.$ac_ext <<_ACEOF
 /* confdefs.h.  */
 _ACEOF
 cat confdefs.h >>conftest.$ac_ext
@@ -3859,46 +4814,42 @@
 }
 _ACEOF
 rm -f conftest.$ac_objext conftest$ac_exeext
-if { (eval echo "$as_me:$LINENO: \"$ac_link\"") >&5
-  (eval $ac_link) 2>conftest.er1
+if { (ac_try="$ac_link"
+case "(($ac_try" in
+  *\"* | *\`* | *\\*) ac_try_echo=\$ac_try;;
+  *) ac_try_echo=$ac_try;;
+esac
+eval "echo \"\$as_me:$LINENO: $ac_try_echo\"") >&5
+  (eval "$ac_link") 2>conftest.er1
   ac_status=$?
   grep -v '^ *+' conftest.er1 >conftest.err
   rm -f conftest.er1
   cat conftest.err >&5
   echo "$as_me:$LINENO: \$? = $ac_status" >&5
-  (exit $ac_status); } &&
-	 { ac_try='test -z "$ac_c_werror_flag"			 || test ! -s conftest.err'
-  { (eval echo "$as_me:$LINENO: \"$ac_try\"") >&5
-  (eval $ac_try) 2>&5
-  ac_status=$?
-  echo "$as_me:$LINENO: \$? = $ac_status" >&5
-  (exit $ac_status); }; } &&
-	 { ac_try='test -s conftest$ac_exeext'
-  { (eval echo "$as_me:$LINENO: \"$ac_try\"") >&5
-  (eval $ac_try) 2>&5
-  ac_status=$?
-  echo "$as_me:$LINENO: \$? = $ac_status" >&5
-  (exit $ac_status); }; }; then
-  ac_R_space=yes
+  (exit $ac_status); } && {
+	 test -z "$ac_c_werror_flag" ||
+	 test ! -s conftest.err
+       } && test -s conftest$ac_exeext &&
+       $as_test_x conftest$ac_exeext; then
+  { echo "$as_me:$LINENO: result: yes" >&5
+echo "${ECHO_T}yes" >&6; }
+	  X_LIBS="$X_LIBS -R $x_libraries"
 else
   echo "$as_me: failed program was:" >&5
 sed 's/^/| /' conftest.$ac_ext >&5
 
-ac_R_space=no
+	{ echo "$as_me:$LINENO: result: neither works" >&5
+echo "${ECHO_T}neither works" >&6; }
+fi
+
+rm -f core conftest.err conftest.$ac_objext conftest_ipa8_conftest.oo \
+      conftest$ac_exeext conftest.$ac_ext
 fi
-rm -f conftest.err conftest.$ac_objext \
+
+rm -f core conftest.err conftest.$ac_objext conftest_ipa8_conftest.oo \
       conftest$ac_exeext conftest.$ac_ext
-	if test $ac_R_space = yes; then
-	  echo "$as_me:$LINENO: result: yes" >&5
-echo "${ECHO_T}yes" >&6
-	  X_LIBS="$X_LIBS -R $x_libraries"
-	else
-	  echo "$as_me:$LINENO: result: neither works" >&5
-echo "${ECHO_T}neither works" >&6
-	fi
-      fi
-      LIBS=$ac_xsave_LIBS
-    esac
+    ac_c_werror_flag=$ac_xsave_c_werror_flag
+    LIBS=$ac_xsave_LIBS
   fi
 
   # Check for system-dependent libraries X programs must link with.
@@ -3919,49 +4870,46 @@
 cat >>conftest.$ac_ext <<_ACEOF
 /* end confdefs.h.  */
 
-/* Override any gcc2 internal prototype to avoid an error.  */
+/* Override any GCC internal prototype to avoid an error.
+   Use char because int might match the return type of a GCC
+   builtin and then its argument prototype would still apply.  */
 #ifdef __cplusplus
 extern "C"
 #endif
-/* We use char because int might match the return type of a gcc2
-   builtin and then its argument prototype would still apply.  */
 char XOpenDisplay ();
 int
 main ()
 {
-XOpenDisplay ();
+return XOpenDisplay ();
   ;
   return 0;
 }
 _ACEOF
 rm -f conftest.$ac_objext conftest$ac_exeext
-if { (eval echo "$as_me:$LINENO: \"$ac_link\"") >&5
-  (eval $ac_link) 2>conftest.er1
+if { (ac_try="$ac_link"
+case "(($ac_try" in
+  *\"* | *\`* | *\\*) ac_try_echo=\$ac_try;;
+  *) ac_try_echo=$ac_try;;
+esac
+eval "echo \"\$as_me:$LINENO: $ac_try_echo\"") >&5
+  (eval "$ac_link") 2>conftest.er1
   ac_status=$?
   grep -v '^ *+' conftest.er1 >conftest.err
   rm -f conftest.er1
   cat conftest.err >&5
   echo "$as_me:$LINENO: \$? = $ac_status" >&5
-  (exit $ac_status); } &&
-	 { ac_try='test -z "$ac_c_werror_flag"			 || test ! -s conftest.err'
-  { (eval echo "$as_me:$LINENO: \"$ac_try\"") >&5
-  (eval $ac_try) 2>&5
-  ac_status=$?
-  echo "$as_me:$LINENO: \$? = $ac_status" >&5
-  (exit $ac_status); }; } &&
-	 { ac_try='test -s conftest$ac_exeext'
-  { (eval echo "$as_me:$LINENO: \"$ac_try\"") >&5
-  (eval $ac_try) 2>&5
-  ac_status=$?
-  echo "$as_me:$LINENO: \$? = $ac_status" >&5
-  (exit $ac_status); }; }; then
+  (exit $ac_status); } && {
+	 test -z "$ac_c_werror_flag" ||
+	 test ! -s conftest.err
+       } && test -s conftest$ac_exeext &&
+       $as_test_x conftest$ac_exeext; then
   :
 else
   echo "$as_me: failed program was:" >&5
 sed 's/^/| /' conftest.$ac_ext >&5
 
-echo "$as_me:$LINENO: checking for dnet_ntoa in -ldnet" >&5
-echo $ECHO_N "checking for dnet_ntoa in -ldnet... $ECHO_C" >&6
+	{ echo "$as_me:$LINENO: checking for dnet_ntoa in -ldnet" >&5
+echo $ECHO_N "checking for dnet_ntoa in -ldnet... $ECHO_C" >&6; }
 if test "${ac_cv_lib_dnet_dnet_ntoa+set}" = set; then
   echo $ECHO_N "(cached) $ECHO_C" >&6
 else
@@ -3974,62 +4922,60 @@
 cat >>conftest.$ac_ext <<_ACEOF
 /* end confdefs.h.  */
 
-/* Override any gcc2 internal prototype to avoid an error.  */
+/* Override any GCC internal prototype to avoid an error.
+   Use char because int might match the return type of a GCC
+   builtin and then its argument prototype would still apply.  */
 #ifdef __cplusplus
 extern "C"
 #endif
-/* We use char because int might match the return type of a gcc2
-   builtin and then its argument prototype would still apply.  */
 char dnet_ntoa ();
 int
 main ()
 {
-dnet_ntoa ();
+return dnet_ntoa ();
   ;
   return 0;
 }
 _ACEOF
 rm -f conftest.$ac_objext conftest$ac_exeext
-if { (eval echo "$as_me:$LINENO: \"$ac_link\"") >&5
-  (eval $ac_link) 2>conftest.er1
+if { (ac_try="$ac_link"
+case "(($ac_try" in
+  *\"* | *\`* | *\\*) ac_try_echo=\$ac_try;;
+  *) ac_try_echo=$ac_try;;
+esac
+eval "echo \"\$as_me:$LINENO: $ac_try_echo\"") >&5
+  (eval "$ac_link") 2>conftest.er1
   ac_status=$?
   grep -v '^ *+' conftest.er1 >conftest.err
   rm -f conftest.er1
   cat conftest.err >&5
   echo "$as_me:$LINENO: \$? = $ac_status" >&5
-  (exit $ac_status); } &&
-	 { ac_try='test -z "$ac_c_werror_flag"			 || test ! -s conftest.err'
-  { (eval echo "$as_me:$LINENO: \"$ac_try\"") >&5
-  (eval $ac_try) 2>&5
-  ac_status=$?
-  echo "$as_me:$LINENO: \$? = $ac_status" >&5
-  (exit $ac_status); }; } &&
-	 { ac_try='test -s conftest$ac_exeext'
-  { (eval echo "$as_me:$LINENO: \"$ac_try\"") >&5
-  (eval $ac_try) 2>&5
-  ac_status=$?
-  echo "$as_me:$LINENO: \$? = $ac_status" >&5
-  (exit $ac_status); }; }; then
+  (exit $ac_status); } && {
+	 test -z "$ac_c_werror_flag" ||
+	 test ! -s conftest.err
+       } && test -s conftest$ac_exeext &&
+       $as_test_x conftest$ac_exeext; then
   ac_cv_lib_dnet_dnet_ntoa=yes
 else
   echo "$as_me: failed program was:" >&5
 sed 's/^/| /' conftest.$ac_ext >&5
 
-ac_cv_lib_dnet_dnet_ntoa=no
+	ac_cv_lib_dnet_dnet_ntoa=no
 fi
-rm -f conftest.err conftest.$ac_objext \
+
+rm -f core conftest.err conftest.$ac_objext conftest_ipa8_conftest.oo \
       conftest$ac_exeext conftest.$ac_ext
 LIBS=$ac_check_lib_save_LIBS
 fi
-echo "$as_me:$LINENO: result: $ac_cv_lib_dnet_dnet_ntoa" >&5
-echo "${ECHO_T}$ac_cv_lib_dnet_dnet_ntoa" >&6
+{ echo "$as_me:$LINENO: result: $ac_cv_lib_dnet_dnet_ntoa" >&5
+echo "${ECHO_T}$ac_cv_lib_dnet_dnet_ntoa" >&6; }
 if test $ac_cv_lib_dnet_dnet_ntoa = yes; then
   X_EXTRA_LIBS="$X_EXTRA_LIBS -ldnet"
 fi
 
     if test $ac_cv_lib_dnet_dnet_ntoa = no; then
-      echo "$as_me:$LINENO: checking for dnet_ntoa in -ldnet_stub" >&5
-echo $ECHO_N "checking for dnet_ntoa in -ldnet_stub... $ECHO_C" >&6
+      { echo "$as_me:$LINENO: checking for dnet_ntoa in -ldnet_stub" >&5
+echo $ECHO_N "checking for dnet_ntoa in -ldnet_stub... $ECHO_C" >&6; }
 if test "${ac_cv_lib_dnet_stub_dnet_ntoa+set}" = set; then
   echo $ECHO_N "(cached) $ECHO_C" >&6
 else
@@ -4042,62 +4988,61 @@
 cat >>conftest.$ac_ext <<_ACEOF
 /* end confdefs.h.  */
 
-/* Override any gcc2 internal prototype to avoid an error.  */
+/* Override any GCC internal prototype to avoid an error.
+   Use char because int might match the return type of a GCC
+   builtin and then its argument prototype would still apply.  */
 #ifdef __cplusplus
 extern "C"
 #endif
-/* We use char because int might match the return type of a gcc2
-   builtin and then its argument prototype would still apply.  */
 char dnet_ntoa ();
 int
 main ()
 {
-dnet_ntoa ();
+return dnet_ntoa ();
   ;
   return 0;
 }
 _ACEOF
 rm -f conftest.$ac_objext conftest$ac_exeext
-if { (eval echo "$as_me:$LINENO: \"$ac_link\"") >&5
-  (eval $ac_link) 2>conftest.er1
+if { (ac_try="$ac_link"
+case "(($ac_try" in
+  *\"* | *\`* | *\\*) ac_try_echo=\$ac_try;;
+  *) ac_try_echo=$ac_try;;
+esac
+eval "echo \"\$as_me:$LINENO: $ac_try_echo\"") >&5
+  (eval "$ac_link") 2>conftest.er1
   ac_status=$?
   grep -v '^ *+' conftest.er1 >conftest.err
   rm -f conftest.er1
   cat conftest.err >&5
   echo "$as_me:$LINENO: \$? = $ac_status" >&5
-  (exit $ac_status); } &&
-	 { ac_try='test -z "$ac_c_werror_flag"			 || test ! -s conftest.err'
-  { (eval echo "$as_me:$LINENO: \"$ac_try\"") >&5
-  (eval $ac_try) 2>&5
-  ac_status=$?
-  echo "$as_me:$LINENO: \$? = $ac_status" >&5
-  (exit $ac_status); }; } &&
-	 { ac_try='test -s conftest$ac_exeext'
-  { (eval echo "$as_me:$LINENO: \"$ac_try\"") >&5
-  (eval $ac_try) 2>&5
-  ac_status=$?
-  echo "$as_me:$LINENO: \$? = $ac_status" >&5
-  (exit $ac_status); }; }; then
+  (exit $ac_status); } && {
+	 test -z "$ac_c_werror_flag" ||
+	 test ! -s conftest.err
+       } && test -s conftest$ac_exeext &&
+       $as_test_x conftest$ac_exeext; then
   ac_cv_lib_dnet_stub_dnet_ntoa=yes
 else
   echo "$as_me: failed program was:" >&5
 sed 's/^/| /' conftest.$ac_ext >&5
 
-ac_cv_lib_dnet_stub_dnet_ntoa=no
+	ac_cv_lib_dnet_stub_dnet_ntoa=no
 fi
-rm -f conftest.err conftest.$ac_objext \
+
+rm -f core conftest.err conftest.$ac_objext conftest_ipa8_conftest.oo \
       conftest$ac_exeext conftest.$ac_ext
 LIBS=$ac_check_lib_save_LIBS
 fi
-echo "$as_me:$LINENO: result: $ac_cv_lib_dnet_stub_dnet_ntoa" >&5
-echo "${ECHO_T}$ac_cv_lib_dnet_stub_dnet_ntoa" >&6
+{ echo "$as_me:$LINENO: result: $ac_cv_lib_dnet_stub_dnet_ntoa" >&5
+echo "${ECHO_T}$ac_cv_lib_dnet_stub_dnet_ntoa" >&6; }
 if test $ac_cv_lib_dnet_stub_dnet_ntoa = yes; then
   X_EXTRA_LIBS="$X_EXTRA_LIBS -ldnet_stub"
 fi
 
     fi
 fi
-rm -f conftest.err conftest.$ac_objext \
+
+rm -f core conftest.err conftest.$ac_objext conftest_ipa8_conftest.oo \
       conftest$ac_exeext conftest.$ac_ext
     LIBS="$ac_xsave_LIBS"
 
@@ -4109,8 +5054,8 @@
     # on Irix 5.2, according to T.E. Dickey.
     # The functions gethostbyname, getservbyname, and inet_addr are
     # in -lbsd on LynxOS 3.0.1/i386, according to Lars Hecking.
-    echo "$as_me:$LINENO: checking for gethostbyname" >&5
-echo $ECHO_N "checking for gethostbyname... $ECHO_C" >&6
+    { echo "$as_me:$LINENO: checking for gethostbyname" >&5
+echo $ECHO_N "checking for gethostbyname... $ECHO_C" >&6; }
 if test "${ac_cv_func_gethostbyname+set}" = set; then
   echo $ECHO_N "(cached) $ECHO_C" >&6
 else
@@ -4137,71 +5082,63 @@
 
 #undef gethostbyname
 
-/* Override any gcc2 internal prototype to avoid an error.  */
+/* Override any GCC internal prototype to avoid an error.
+   Use char because int might match the return type of a GCC
+   builtin and then its argument prototype would still apply.  */
 #ifdef __cplusplus
 extern "C"
-{
 #endif
-/* We use char because int might match the return type of a gcc2
-   builtin and then its argument prototype would still apply.  */
 char gethostbyname ();
 /* The GNU C library defines this for functions which it implements
     to always fail with ENOSYS.  Some functions are actually named
     something starting with __ and the normal name is an alias.  */
-#if defined (__stub_gethostbyname) || defined (__stub___gethostbyname)
+#if defined __stub_gethostbyname || defined __stub___gethostbyname
 choke me
-#else
-char (*f) () = gethostbyname;
-#endif
-#ifdef __cplusplus
-}
 #endif
 
 int
 main ()
 {
-return f != gethostbyname;
+return gethostbyname ();
   ;
   return 0;
 }
 _ACEOF
 rm -f conftest.$ac_objext conftest$ac_exeext
-if { (eval echo "$as_me:$LINENO: \"$ac_link\"") >&5
-  (eval $ac_link) 2>conftest.er1
+if { (ac_try="$ac_link"
+case "(($ac_try" in
+  *\"* | *\`* | *\\*) ac_try_echo=\$ac_try;;
+  *) ac_try_echo=$ac_try;;
+esac
+eval "echo \"\$as_me:$LINENO: $ac_try_echo\"") >&5
+  (eval "$ac_link") 2>conftest.er1
   ac_status=$?
   grep -v '^ *+' conftest.er1 >conftest.err
   rm -f conftest.er1
   cat conftest.err >&5
   echo "$as_me:$LINENO: \$? = $ac_status" >&5
-  (exit $ac_status); } &&
-	 { ac_try='test -z "$ac_c_werror_flag"			 || test ! -s conftest.err'
-  { (eval echo "$as_me:$LINENO: \"$ac_try\"") >&5
-  (eval $ac_try) 2>&5
-  ac_status=$?
-  echo "$as_me:$LINENO: \$? = $ac_status" >&5
-  (exit $ac_status); }; } &&
-	 { ac_try='test -s conftest$ac_exeext'
-  { (eval echo "$as_me:$LINENO: \"$ac_try\"") >&5
-  (eval $ac_try) 2>&5
-  ac_status=$?
-  echo "$as_me:$LINENO: \$? = $ac_status" >&5
-  (exit $ac_status); }; }; then
+  (exit $ac_status); } && {
+	 test -z "$ac_c_werror_flag" ||
+	 test ! -s conftest.err
+       } && test -s conftest$ac_exeext &&
+       $as_test_x conftest$ac_exeext; then
   ac_cv_func_gethostbyname=yes
 else
   echo "$as_me: failed program was:" >&5
 sed 's/^/| /' conftest.$ac_ext >&5
 
-ac_cv_func_gethostbyname=no
+	ac_cv_func_gethostbyname=no
 fi
-rm -f conftest.err conftest.$ac_objext \
+
+rm -f core conftest.err conftest.$ac_objext conftest_ipa8_conftest.oo \
       conftest$ac_exeext conftest.$ac_ext
 fi
-echo "$as_me:$LINENO: result: $ac_cv_func_gethostbyname" >&5
-echo "${ECHO_T}$ac_cv_func_gethostbyname" >&6
+{ echo "$as_me:$LINENO: result: $ac_cv_func_gethostbyname" >&5
+echo "${ECHO_T}$ac_cv_func_gethostbyname" >&6; }
 
     if test $ac_cv_func_gethostbyname = no; then
-      echo "$as_me:$LINENO: checking for gethostbyname in -lnsl" >&5
-echo $ECHO_N "checking for gethostbyname in -lnsl... $ECHO_C" >&6
+      { echo "$as_me:$LINENO: checking for gethostbyname in -lnsl" >&5
+echo $ECHO_N "checking for gethostbyname in -lnsl... $ECHO_C" >&6; }
 if test "${ac_cv_lib_nsl_gethostbyname+set}" = set; then
   echo $ECHO_N "(cached) $ECHO_C" >&6
 else
@@ -4214,62 +5151,60 @@
 cat >>conftest.$ac_ext <<_ACEOF
 /* end confdefs.h.  */
 
-/* Override any gcc2 internal prototype to avoid an error.  */
+/* Override any GCC internal prototype to avoid an error.
+   Use char because int might match the return type of a GCC
+   builtin and then its argument prototype would still apply.  */
 #ifdef __cplusplus
 extern "C"
 #endif
-/* We use char because int might match the return type of a gcc2
-   builtin and then its argument prototype would still apply.  */
 char gethostbyname ();
 int
 main ()
 {
-gethostbyname ();
+return gethostbyname ();
   ;
   return 0;
 }
 _ACEOF
 rm -f conftest.$ac_objext conftest$ac_exeext
-if { (eval echo "$as_me:$LINENO: \"$ac_link\"") >&5
-  (eval $ac_link) 2>conftest.er1
+if { (ac_try="$ac_link"
+case "(($ac_try" in
+  *\"* | *\`* | *\\*) ac_try_echo=\$ac_try;;
+  *) ac_try_echo=$ac_try;;
+esac
+eval "echo \"\$as_me:$LINENO: $ac_try_echo\"") >&5
+  (eval "$ac_link") 2>conftest.er1
   ac_status=$?
   grep -v '^ *+' conftest.er1 >conftest.err
   rm -f conftest.er1
   cat conftest.err >&5
   echo "$as_me:$LINENO: \$? = $ac_status" >&5
-  (exit $ac_status); } &&
-	 { ac_try='test -z "$ac_c_werror_flag"			 || test ! -s conftest.err'
-  { (eval echo "$as_me:$LINENO: \"$ac_try\"") >&5
-  (eval $ac_try) 2>&5
-  ac_status=$?
-  echo "$as_me:$LINENO: \$? = $ac_status" >&5
-  (exit $ac_status); }; } &&
-	 { ac_try='test -s conftest$ac_exeext'
-  { (eval echo "$as_me:$LINENO: \"$ac_try\"") >&5
-  (eval $ac_try) 2>&5
-  ac_status=$?
-  echo "$as_me:$LINENO: \$? = $ac_status" >&5
-  (exit $ac_status); }; }; then
+  (exit $ac_status); } && {
+	 test -z "$ac_c_werror_flag" ||
+	 test ! -s conftest.err
+       } && test -s conftest$ac_exeext &&
+       $as_test_x conftest$ac_exeext; then
   ac_cv_lib_nsl_gethostbyname=yes
 else
   echo "$as_me: failed program was:" >&5
 sed 's/^/| /' conftest.$ac_ext >&5
 
-ac_cv_lib_nsl_gethostbyname=no
+	ac_cv_lib_nsl_gethostbyname=no
 fi
-rm -f conftest.err conftest.$ac_objext \
+
+rm -f core conftest.err conftest.$ac_objext conftest_ipa8_conftest.oo \
       conftest$ac_exeext conftest.$ac_ext
 LIBS=$ac_check_lib_save_LIBS
 fi
-echo "$as_me:$LINENO: result: $ac_cv_lib_nsl_gethostbyname" >&5
-echo "${ECHO_T}$ac_cv_lib_nsl_gethostbyname" >&6
+{ echo "$as_me:$LINENO: result: $ac_cv_lib_nsl_gethostbyname" >&5
+echo "${ECHO_T}$ac_cv_lib_nsl_gethostbyname" >&6; }
 if test $ac_cv_lib_nsl_gethostbyname = yes; then
   X_EXTRA_LIBS="$X_EXTRA_LIBS -lnsl"
 fi
 
       if test $ac_cv_lib_nsl_gethostbyname = no; then
-	echo "$as_me:$LINENO: checking for gethostbyname in -lbsd" >&5
-echo $ECHO_N "checking for gethostbyname in -lbsd... $ECHO_C" >&6
+	{ echo "$as_me:$LINENO: checking for gethostbyname in -lbsd" >&5
+echo $ECHO_N "checking for gethostbyname in -lbsd... $ECHO_C" >&6; }
 if test "${ac_cv_lib_bsd_gethostbyname+set}" = set; then
   echo $ECHO_N "(cached) $ECHO_C" >&6
 else
@@ -4282,55 +5217,53 @@
 cat >>conftest.$ac_ext <<_ACEOF
 /* end confdefs.h.  */
 
-/* Override any gcc2 internal prototype to avoid an error.  */
+/* Override any GCC internal prototype to avoid an error.
+   Use char because int might match the return type of a GCC
+   builtin and then its argument prototype would still apply.  */
 #ifdef __cplusplus
 extern "C"
 #endif
-/* We use char because int might match the return type of a gcc2
-   builtin and then its argument prototype would still apply.  */
 char gethostbyname ();
 int
 main ()
 {
-gethostbyname ();
+return gethostbyname ();
   ;
   return 0;
 }
 _ACEOF
 rm -f conftest.$ac_objext conftest$ac_exeext
-if { (eval echo "$as_me:$LINENO: \"$ac_link\"") >&5
-  (eval $ac_link) 2>conftest.er1
+if { (ac_try="$ac_link"
+case "(($ac_try" in
+  *\"* | *\`* | *\\*) ac_try_echo=\$ac_try;;
+  *) ac_try_echo=$ac_try;;
+esac
+eval "echo \"\$as_me:$LINENO: $ac_try_echo\"") >&5
+  (eval "$ac_link") 2>conftest.er1
   ac_status=$?
   grep -v '^ *+' conftest.er1 >conftest.err
   rm -f conftest.er1
   cat conftest.err >&5
   echo "$as_me:$LINENO: \$? = $ac_status" >&5
-  (exit $ac_status); } &&
-	 { ac_try='test -z "$ac_c_werror_flag"			 || test ! -s conftest.err'
-  { (eval echo "$as_me:$LINENO: \"$ac_try\"") >&5
-  (eval $ac_try) 2>&5
-  ac_status=$?
-  echo "$as_me:$LINENO: \$? = $ac_status" >&5
-  (exit $ac_status); }; } &&
-	 { ac_try='test -s conftest$ac_exeext'
-  { (eval echo "$as_me:$LINENO: \"$ac_try\"") >&5
-  (eval $ac_try) 2>&5
-  ac_status=$?
-  echo "$as_me:$LINENO: \$? = $ac_status" >&5
-  (exit $ac_status); }; }; then
+  (exit $ac_status); } && {
+	 test -z "$ac_c_werror_flag" ||
+	 test ! -s conftest.err
+       } && test -s conftest$ac_exeext &&
+       $as_test_x conftest$ac_exeext; then
   ac_cv_lib_bsd_gethostbyname=yes
 else
   echo "$as_me: failed program was:" >&5
 sed 's/^/| /' conftest.$ac_ext >&5
 
-ac_cv_lib_bsd_gethostbyname=no
+	ac_cv_lib_bsd_gethostbyname=no
 fi
-rm -f conftest.err conftest.$ac_objext \
+
+rm -f core conftest.err conftest.$ac_objext conftest_ipa8_conftest.oo \
       conftest$ac_exeext conftest.$ac_ext
 LIBS=$ac_check_lib_save_LIBS
 fi
-echo "$as_me:$LINENO: result: $ac_cv_lib_bsd_gethostbyname" >&5
-echo "${ECHO_T}$ac_cv_lib_bsd_gethostbyname" >&6
+{ echo "$as_me:$LINENO: result: $ac_cv_lib_bsd_gethostbyname" >&5
+echo "${ECHO_T}$ac_cv_lib_bsd_gethostbyname" >&6; }
 if test $ac_cv_lib_bsd_gethostbyname = yes; then
   X_EXTRA_LIBS="$X_EXTRA_LIBS -lbsd"
 fi
@@ -4345,8 +5278,8 @@
     # variants that don't use the name server (or something).  -lsocket
     # must be given before -lnsl if both are needed.  We assume that
     # if connect needs -lnsl, so does gethostbyname.
-    echo "$as_me:$LINENO: checking for connect" >&5
-echo $ECHO_N "checking for connect... $ECHO_C" >&6
+    { echo "$as_me:$LINENO: checking for connect" >&5
+echo $ECHO_N "checking for connect... $ECHO_C" >&6; }
 if test "${ac_cv_func_connect+set}" = set; then
   echo $ECHO_N "(cached) $ECHO_C" >&6
 else
@@ -4373,71 +5306,63 @@
 
 #undef connect
 
-/* Override any gcc2 internal prototype to avoid an error.  */
+/* Override any GCC internal prototype to avoid an error.
+   Use char because int might match the return type of a GCC
+   builtin and then its argument prototype would still apply.  */
 #ifdef __cplusplus
 extern "C"
-{
 #endif
-/* We use char because int might match the return type of a gcc2
-   builtin and then its argument prototype would still apply.  */
 char connect ();
 /* The GNU C library defines this for functions which it implements
     to always fail with ENOSYS.  Some functions are actually named
     something starting with __ and the normal name is an alias.  */
-#if defined (__stub_connect) || defined (__stub___connect)
+#if defined __stub_connect || defined __stub___connect
 choke me
-#else
-char (*f) () = connect;
-#endif
-#ifdef __cplusplus
-}
 #endif
 
 int
 main ()
 {
-return f != connect;
+return connect ();
   ;
   return 0;
 }
 _ACEOF
 rm -f conftest.$ac_objext conftest$ac_exeext
-if { (eval echo "$as_me:$LINENO: \"$ac_link\"") >&5
-  (eval $ac_link) 2>conftest.er1
+if { (ac_try="$ac_link"
+case "(($ac_try" in
+  *\"* | *\`* | *\\*) ac_try_echo=\$ac_try;;
+  *) ac_try_echo=$ac_try;;
+esac
+eval "echo \"\$as_me:$LINENO: $ac_try_echo\"") >&5
+  (eval "$ac_link") 2>conftest.er1
   ac_status=$?
   grep -v '^ *+' conftest.er1 >conftest.err
   rm -f conftest.er1
   cat conftest.err >&5
   echo "$as_me:$LINENO: \$? = $ac_status" >&5
-  (exit $ac_status); } &&
-	 { ac_try='test -z "$ac_c_werror_flag"			 || test ! -s conftest.err'
-  { (eval echo "$as_me:$LINENO: \"$ac_try\"") >&5
-  (eval $ac_try) 2>&5
-  ac_status=$?
-  echo "$as_me:$LINENO: \$? = $ac_status" >&5
-  (exit $ac_status); }; } &&
-	 { ac_try='test -s conftest$ac_exeext'
-  { (eval echo "$as_me:$LINENO: \"$ac_try\"") >&5
-  (eval $ac_try) 2>&5
-  ac_status=$?
-  echo "$as_me:$LINENO: \$? = $ac_status" >&5
-  (exit $ac_status); }; }; then
+  (exit $ac_status); } && {
+	 test -z "$ac_c_werror_flag" ||
+	 test ! -s conftest.err
+       } && test -s conftest$ac_exeext &&
+       $as_test_x conftest$ac_exeext; then
   ac_cv_func_connect=yes
 else
   echo "$as_me: failed program was:" >&5
 sed 's/^/| /' conftest.$ac_ext >&5
 
-ac_cv_func_connect=no
+	ac_cv_func_connect=no
 fi
-rm -f conftest.err conftest.$ac_objext \
+
+rm -f core conftest.err conftest.$ac_objext conftest_ipa8_conftest.oo \
       conftest$ac_exeext conftest.$ac_ext
 fi
-echo "$as_me:$LINENO: result: $ac_cv_func_connect" >&5
-echo "${ECHO_T}$ac_cv_func_connect" >&6
+{ echo "$as_me:$LINENO: result: $ac_cv_func_connect" >&5
+echo "${ECHO_T}$ac_cv_func_connect" >&6; }
 
     if test $ac_cv_func_connect = no; then
-      echo "$as_me:$LINENO: checking for connect in -lsocket" >&5
-echo $ECHO_N "checking for connect in -lsocket... $ECHO_C" >&6
+      { echo "$as_me:$LINENO: checking for connect in -lsocket" >&5
+echo $ECHO_N "checking for connect in -lsocket... $ECHO_C" >&6; }
 if test "${ac_cv_lib_socket_connect+set}" = set; then
   echo $ECHO_N "(cached) $ECHO_C" >&6
 else
@@ -4450,55 +5375,53 @@
 cat >>conftest.$ac_ext <<_ACEOF
 /* end confdefs.h.  */
 
-/* Override any gcc2 internal prototype to avoid an error.  */
+/* Override any GCC internal prototype to avoid an error.
+   Use char because int might match the return type of a GCC
+   builtin and then its argument prototype would still apply.  */
 #ifdef __cplusplus
 extern "C"
 #endif
-/* We use char because int might match the return type of a gcc2
-   builtin and then its argument prototype would still apply.  */
 char connect ();
 int
 main ()
 {
-connect ();
+return connect ();
   ;
   return 0;
 }
 _ACEOF
 rm -f conftest.$ac_objext conftest$ac_exeext
-if { (eval echo "$as_me:$LINENO: \"$ac_link\"") >&5
-  (eval $ac_link) 2>conftest.er1
+if { (ac_try="$ac_link"
+case "(($ac_try" in
+  *\"* | *\`* | *\\*) ac_try_echo=\$ac_try;;
+  *) ac_try_echo=$ac_try;;
+esac
+eval "echo \"\$as_me:$LINENO: $ac_try_echo\"") >&5
+  (eval "$ac_link") 2>conftest.er1
   ac_status=$?
   grep -v '^ *+' conftest.er1 >conftest.err
   rm -f conftest.er1
   cat conftest.err >&5
   echo "$as_me:$LINENO: \$? = $ac_status" >&5
-  (exit $ac_status); } &&
-	 { ac_try='test -z "$ac_c_werror_flag"			 || test ! -s conftest.err'
-  { (eval echo "$as_me:$LINENO: \"$ac_try\"") >&5
-  (eval $ac_try) 2>&5
-  ac_status=$?
-  echo "$as_me:$LINENO: \$? = $ac_status" >&5
-  (exit $ac_status); }; } &&
-	 { ac_try='test -s conftest$ac_exeext'
-  { (eval echo "$as_me:$LINENO: \"$ac_try\"") >&5
-  (eval $ac_try) 2>&5
-  ac_status=$?
-  echo "$as_me:$LINENO: \$? = $ac_status" >&5
-  (exit $ac_status); }; }; then
+  (exit $ac_status); } && {
+	 test -z "$ac_c_werror_flag" ||
+	 test ! -s conftest.err
+       } && test -s conftest$ac_exeext &&
+       $as_test_x conftest$ac_exeext; then
   ac_cv_lib_socket_connect=yes
 else
   echo "$as_me: failed program was:" >&5
 sed 's/^/| /' conftest.$ac_ext >&5
 
-ac_cv_lib_socket_connect=no
+	ac_cv_lib_socket_connect=no
 fi
-rm -f conftest.err conftest.$ac_objext \
+
+rm -f core conftest.err conftest.$ac_objext conftest_ipa8_conftest.oo \
       conftest$ac_exeext conftest.$ac_ext
 LIBS=$ac_check_lib_save_LIBS
 fi
-echo "$as_me:$LINENO: result: $ac_cv_lib_socket_connect" >&5
-echo "${ECHO_T}$ac_cv_lib_socket_connect" >&6
+{ echo "$as_me:$LINENO: result: $ac_cv_lib_socket_connect" >&5
+echo "${ECHO_T}$ac_cv_lib_socket_connect" >&6; }
 if test $ac_cv_lib_socket_connect = yes; then
   X_EXTRA_LIBS="-lsocket $X_EXTRA_LIBS"
 fi
@@ -4506,8 +5429,8 @@
     fi
 
     # Guillermo Gomez says -lposix is necessary on A/UX.
-    echo "$as_me:$LINENO: checking for remove" >&5
-echo $ECHO_N "checking for remove... $ECHO_C" >&6
+    { echo "$as_me:$LINENO: checking for remove" >&5
+echo $ECHO_N "checking for remove... $ECHO_C" >&6; }
 if test "${ac_cv_func_remove+set}" = set; then
   echo $ECHO_N "(cached) $ECHO_C" >&6
 else
@@ -4534,71 +5457,63 @@
 
 #undef remove
 
-/* Override any gcc2 internal prototype to avoid an error.  */
+/* Override any GCC internal prototype to avoid an error.
+   Use char because int might match the return type of a GCC
+   builtin and then its argument prototype would still apply.  */
 #ifdef __cplusplus
 extern "C"
-{
 #endif
-/* We use char because int might match the return type of a gcc2
-   builtin and then its argument prototype would still apply.  */
 char remove ();
 /* The GNU C library defines this for functions which it implements
     to always fail with ENOSYS.  Some functions are actually named
     something starting with __ and the normal name is an alias.  */
-#if defined (__stub_remove) || defined (__stub___remove)
+#if defined __stub_remove || defined __stub___remove
 choke me
-#else
-char (*f) () = remove;
-#endif
-#ifdef __cplusplus
-}
 #endif
 
 int
 main ()
 {
-return f != remove;
+return remove ();
   ;
   return 0;
 }
 _ACEOF
 rm -f conftest.$ac_objext conftest$ac_exeext
-if { (eval echo "$as_me:$LINENO: \"$ac_link\"") >&5
-  (eval $ac_link) 2>conftest.er1
+if { (ac_try="$ac_link"
+case "(($ac_try" in
+  *\"* | *\`* | *\\*) ac_try_echo=\$ac_try;;
+  *) ac_try_echo=$ac_try;;
+esac
+eval "echo \"\$as_me:$LINENO: $ac_try_echo\"") >&5
+  (eval "$ac_link") 2>conftest.er1
   ac_status=$?
   grep -v '^ *+' conftest.er1 >conftest.err
   rm -f conftest.er1
   cat conftest.err >&5
   echo "$as_me:$LINENO: \$? = $ac_status" >&5
-  (exit $ac_status); } &&
-	 { ac_try='test -z "$ac_c_werror_flag"			 || test ! -s conftest.err'
-  { (eval echo "$as_me:$LINENO: \"$ac_try\"") >&5
-  (eval $ac_try) 2>&5
-  ac_status=$?
-  echo "$as_me:$LINENO: \$? = $ac_status" >&5
-  (exit $ac_status); }; } &&
-	 { ac_try='test -s conftest$ac_exeext'
-  { (eval echo "$as_me:$LINENO: \"$ac_try\"") >&5
-  (eval $ac_try) 2>&5
-  ac_status=$?
-  echo "$as_me:$LINENO: \$? = $ac_status" >&5
-  (exit $ac_status); }; }; then
+  (exit $ac_status); } && {
+	 test -z "$ac_c_werror_flag" ||
+	 test ! -s conftest.err
+       } && test -s conftest$ac_exeext &&
+       $as_test_x conftest$ac_exeext; then
   ac_cv_func_remove=yes
 else
   echo "$as_me: failed program was:" >&5
 sed 's/^/| /' conftest.$ac_ext >&5
 
-ac_cv_func_remove=no
+	ac_cv_func_remove=no
 fi
-rm -f conftest.err conftest.$ac_objext \
+
+rm -f core conftest.err conftest.$ac_objext conftest_ipa8_conftest.oo \
       conftest$ac_exeext conftest.$ac_ext
 fi
-echo "$as_me:$LINENO: result: $ac_cv_func_remove" >&5
-echo "${ECHO_T}$ac_cv_func_remove" >&6
+{ echo "$as_me:$LINENO: result: $ac_cv_func_remove" >&5
+echo "${ECHO_T}$ac_cv_func_remove" >&6; }
 
     if test $ac_cv_func_remove = no; then
-      echo "$as_me:$LINENO: checking for remove in -lposix" >&5
-echo $ECHO_N "checking for remove in -lposix... $ECHO_C" >&6
+      { echo "$as_me:$LINENO: checking for remove in -lposix" >&5
+echo $ECHO_N "checking for remove in -lposix... $ECHO_C" >&6; }
 if test "${ac_cv_lib_posix_remove+set}" = set; then
   echo $ECHO_N "(cached) $ECHO_C" >&6
 else
@@ -4611,55 +5526,53 @@
 cat >>conftest.$ac_ext <<_ACEOF
 /* end confdefs.h.  */
 
-/* Override any gcc2 internal prototype to avoid an error.  */
+/* Override any GCC internal prototype to avoid an error.
+   Use char because int might match the return type of a GCC
+   builtin and then its argument prototype would still apply.  */
 #ifdef __cplusplus
 extern "C"
 #endif
-/* We use char because int might match the return type of a gcc2
-   builtin and then its argument prototype would still apply.  */
 char remove ();
 int
 main ()
 {
-remove ();
+return remove ();
   ;
   return 0;
 }
 _ACEOF
 rm -f conftest.$ac_objext conftest$ac_exeext
-if { (eval echo "$as_me:$LINENO: \"$ac_link\"") >&5
-  (eval $ac_link) 2>conftest.er1
+if { (ac_try="$ac_link"
+case "(($ac_try" in
+  *\"* | *\`* | *\\*) ac_try_echo=\$ac_try;;
+  *) ac_try_echo=$ac_try;;
+esac
+eval "echo \"\$as_me:$LINENO: $ac_try_echo\"") >&5
+  (eval "$ac_link") 2>conftest.er1
   ac_status=$?
   grep -v '^ *+' conftest.er1 >conftest.err
   rm -f conftest.er1
   cat conftest.err >&5
   echo "$as_me:$LINENO: \$? = $ac_status" >&5
-  (exit $ac_status); } &&
-	 { ac_try='test -z "$ac_c_werror_flag"			 || test ! -s conftest.err'
-  { (eval echo "$as_me:$LINENO: \"$ac_try\"") >&5
-  (eval $ac_try) 2>&5
-  ac_status=$?
-  echo "$as_me:$LINENO: \$? = $ac_status" >&5
-  (exit $ac_status); }; } &&
-	 { ac_try='test -s conftest$ac_exeext'
-  { (eval echo "$as_me:$LINENO: \"$ac_try\"") >&5
-  (eval $ac_try) 2>&5
-  ac_status=$?
-  echo "$as_me:$LINENO: \$? = $ac_status" >&5
-  (exit $ac_status); }; }; then
+  (exit $ac_status); } && {
+	 test -z "$ac_c_werror_flag" ||
+	 test ! -s conftest.err
+       } && test -s conftest$ac_exeext &&
+       $as_test_x conftest$ac_exeext; then
   ac_cv_lib_posix_remove=yes
 else
   echo "$as_me: failed program was:" >&5
 sed 's/^/| /' conftest.$ac_ext >&5
 
-ac_cv_lib_posix_remove=no
+	ac_cv_lib_posix_remove=no
 fi
-rm -f conftest.err conftest.$ac_objext \
+
+rm -f core conftest.err conftest.$ac_objext conftest_ipa8_conftest.oo \
       conftest$ac_exeext conftest.$ac_ext
 LIBS=$ac_check_lib_save_LIBS
 fi
-echo "$as_me:$LINENO: result: $ac_cv_lib_posix_remove" >&5
-echo "${ECHO_T}$ac_cv_lib_posix_remove" >&6
+{ echo "$as_me:$LINENO: result: $ac_cv_lib_posix_remove" >&5
+echo "${ECHO_T}$ac_cv_lib_posix_remove" >&6; }
 if test $ac_cv_lib_posix_remove = yes; then
   X_EXTRA_LIBS="$X_EXTRA_LIBS -lposix"
 fi
@@ -4667,8 +5580,8 @@
     fi
 
     # BSDI BSD/OS 2.1 needs -lipc for XOpenDisplay.
-    echo "$as_me:$LINENO: checking for shmat" >&5
-echo $ECHO_N "checking for shmat... $ECHO_C" >&6
+    { echo "$as_me:$LINENO: checking for shmat" >&5
+echo $ECHO_N "checking for shmat... $ECHO_C" >&6; }
 if test "${ac_cv_func_shmat+set}" = set; then
   echo $ECHO_N "(cached) $ECHO_C" >&6
 else
@@ -4695,71 +5608,63 @@
 
 #undef shmat
 
-/* Override any gcc2 internal prototype to avoid an error.  */
+/* Override any GCC internal prototype to avoid an error.
+   Use char because int might match the return type of a GCC
+   builtin and then its argument prototype would still apply.  */
 #ifdef __cplusplus
 extern "C"
-{
 #endif
-/* We use char because int might match the return type of a gcc2
-   builtin and then its argument prototype would still apply.  */
 char shmat ();
 /* The GNU C library defines this for functions which it implements
     to always fail with ENOSYS.  Some functions are actually named
     something starting with __ and the normal name is an alias.  */
-#if defined (__stub_shmat) || defined (__stub___shmat)
+#if defined __stub_shmat || defined __stub___shmat
 choke me
-#else
-char (*f) () = shmat;
-#endif
-#ifdef __cplusplus
-}
 #endif
 
 int
 main ()
 {
-return f != shmat;
+return shmat ();
   ;
   return 0;
 }
 _ACEOF
 rm -f conftest.$ac_objext conftest$ac_exeext
-if { (eval echo "$as_me:$LINENO: \"$ac_link\"") >&5
-  (eval $ac_link) 2>conftest.er1
+if { (ac_try="$ac_link"
+case "(($ac_try" in
+  *\"* | *\`* | *\\*) ac_try_echo=\$ac_try;;
+  *) ac_try_echo=$ac_try;;
+esac
+eval "echo \"\$as_me:$LINENO: $ac_try_echo\"") >&5
+  (eval "$ac_link") 2>conftest.er1
   ac_status=$?
   grep -v '^ *+' conftest.er1 >conftest.err
   rm -f conftest.er1
   cat conftest.err >&5
   echo "$as_me:$LINENO: \$? = $ac_status" >&5
-  (exit $ac_status); } &&
-	 { ac_try='test -z "$ac_c_werror_flag"			 || test ! -s conftest.err'
-  { (eval echo "$as_me:$LINENO: \"$ac_try\"") >&5
-  (eval $ac_try) 2>&5
-  ac_status=$?
-  echo "$as_me:$LINENO: \$? = $ac_status" >&5
-  (exit $ac_status); }; } &&
-	 { ac_try='test -s conftest$ac_exeext'
-  { (eval echo "$as_me:$LINENO: \"$ac_try\"") >&5
-  (eval $ac_try) 2>&5
-  ac_status=$?
-  echo "$as_me:$LINENO: \$? = $ac_status" >&5
-  (exit $ac_status); }; }; then
+  (exit $ac_status); } && {
+	 test -z "$ac_c_werror_flag" ||
+	 test ! -s conftest.err
+       } && test -s conftest$ac_exeext &&
+       $as_test_x conftest$ac_exeext; then
   ac_cv_func_shmat=yes
 else
   echo "$as_me: failed program was:" >&5
 sed 's/^/| /' conftest.$ac_ext >&5
 
-ac_cv_func_shmat=no
+	ac_cv_func_shmat=no
 fi
-rm -f conftest.err conftest.$ac_objext \
+
+rm -f core conftest.err conftest.$ac_objext conftest_ipa8_conftest.oo \
       conftest$ac_exeext conftest.$ac_ext
 fi
-echo "$as_me:$LINENO: result: $ac_cv_func_shmat" >&5
-echo "${ECHO_T}$ac_cv_func_shmat" >&6
+{ echo "$as_me:$LINENO: result: $ac_cv_func_shmat" >&5
+echo "${ECHO_T}$ac_cv_func_shmat" >&6; }
 
     if test $ac_cv_func_shmat = no; then
-      echo "$as_me:$LINENO: checking for shmat in -lipc" >&5
-echo $ECHO_N "checking for shmat in -lipc... $ECHO_C" >&6
+      { echo "$as_me:$LINENO: checking for shmat in -lipc" >&5
+echo $ECHO_N "checking for shmat in -lipc... $ECHO_C" >&6; }
 if test "${ac_cv_lib_ipc_shmat+set}" = set; then
   echo $ECHO_N "(cached) $ECHO_C" >&6
 else
@@ -4772,55 +5677,53 @@
 cat >>conftest.$ac_ext <<_ACEOF
 /* end confdefs.h.  */
 
-/* Override any gcc2 internal prototype to avoid an error.  */
+/* Override any GCC internal prototype to avoid an error.
+   Use char because int might match the return type of a GCC
+   builtin and then its argument prototype would still apply.  */
 #ifdef __cplusplus
 extern "C"
 #endif
-/* We use char because int might match the return type of a gcc2
-   builtin and then its argument prototype would still apply.  */
 char shmat ();
 int
 main ()
 {
-shmat ();
+return shmat ();
   ;
   return 0;
 }
 _ACEOF
 rm -f conftest.$ac_objext conftest$ac_exeext
-if { (eval echo "$as_me:$LINENO: \"$ac_link\"") >&5
-  (eval $ac_link) 2>conftest.er1
+if { (ac_try="$ac_link"
+case "(($ac_try" in
+  *\"* | *\`* | *\\*) ac_try_echo=\$ac_try;;
+  *) ac_try_echo=$ac_try;;
+esac
+eval "echo \"\$as_me:$LINENO: $ac_try_echo\"") >&5
+  (eval "$ac_link") 2>conftest.er1
   ac_status=$?
   grep -v '^ *+' conftest.er1 >conftest.err
   rm -f conftest.er1
   cat conftest.err >&5
   echo "$as_me:$LINENO: \$? = $ac_status" >&5
-  (exit $ac_status); } &&
-	 { ac_try='test -z "$ac_c_werror_flag"			 || test ! -s conftest.err'
-  { (eval echo "$as_me:$LINENO: \"$ac_try\"") >&5
-  (eval $ac_try) 2>&5
-  ac_status=$?
-  echo "$as_me:$LINENO: \$? = $ac_status" >&5
-  (exit $ac_status); }; } &&
-	 { ac_try='test -s conftest$ac_exeext'
-  { (eval echo "$as_me:$LINENO: \"$ac_try\"") >&5
-  (eval $ac_try) 2>&5
-  ac_status=$?
-  echo "$as_me:$LINENO: \$? = $ac_status" >&5
-  (exit $ac_status); }; }; then
+  (exit $ac_status); } && {
+	 test -z "$ac_c_werror_flag" ||
+	 test ! -s conftest.err
+       } && test -s conftest$ac_exeext &&
+       $as_test_x conftest$ac_exeext; then
   ac_cv_lib_ipc_shmat=yes
 else
   echo "$as_me: failed program was:" >&5
 sed 's/^/| /' conftest.$ac_ext >&5
 
-ac_cv_lib_ipc_shmat=no
+	ac_cv_lib_ipc_shmat=no
 fi
-rm -f conftest.err conftest.$ac_objext \
+
+rm -f core conftest.err conftest.$ac_objext conftest_ipa8_conftest.oo \
       conftest$ac_exeext conftest.$ac_ext
 LIBS=$ac_check_lib_save_LIBS
 fi
-echo "$as_me:$LINENO: result: $ac_cv_lib_ipc_shmat" >&5
-echo "${ECHO_T}$ac_cv_lib_ipc_shmat" >&6
+{ echo "$as_me:$LINENO: result: $ac_cv_lib_ipc_shmat" >&5
+echo "${ECHO_T}$ac_cv_lib_ipc_shmat" >&6; }
 if test $ac_cv_lib_ipc_shmat = yes; then
   X_EXTRA_LIBS="$X_EXTRA_LIBS -lipc"
 fi
@@ -4837,8 +5740,8 @@
   # These have to be linked with before -lX11, unlike the other
   # libraries we check for below, so use a different variable.
   # John Interrante, Karl Berry
-  echo "$as_me:$LINENO: checking for IceConnectionNumber in -lICE" >&5
-echo $ECHO_N "checking for IceConnectionNumber in -lICE... $ECHO_C" >&6
+  { echo "$as_me:$LINENO: checking for IceConnectionNumber in -lICE" >&5
+echo $ECHO_N "checking for IceConnectionNumber in -lICE... $ECHO_C" >&6; }
 if test "${ac_cv_lib_ICE_IceConnectionNumber+set}" = set; then
   echo $ECHO_N "(cached) $ECHO_C" >&6
 else
@@ -4851,55 +5754,53 @@
 cat >>conftest.$ac_ext <<_ACEOF
 /* end confdefs.h.  */
 
-/* Override any gcc2 internal prototype to avoid an error.  */
+/* Override any GCC internal prototype to avoid an error.
+   Use char because int might match the return type of a GCC
+   builtin and then its argument prototype would still apply.  */
 #ifdef __cplusplus
 extern "C"
 #endif
-/* We use char because int might match the return type of a gcc2
-   builtin and then its argument prototype would still apply.  */
 char IceConnectionNumber ();
 int
 main ()
 {
-IceConnectionNumber ();
+return IceConnectionNumber ();
   ;
   return 0;
 }
 _ACEOF
 rm -f conftest.$ac_objext conftest$ac_exeext
-if { (eval echo "$as_me:$LINENO: \"$ac_link\"") >&5
-  (eval $ac_link) 2>conftest.er1
+if { (ac_try="$ac_link"
+case "(($ac_try" in
+  *\"* | *\`* | *\\*) ac_try_echo=\$ac_try;;
+  *) ac_try_echo=$ac_try;;
+esac
+eval "echo \"\$as_me:$LINENO: $ac_try_echo\"") >&5
+  (eval "$ac_link") 2>conftest.er1
   ac_status=$?
   grep -v '^ *+' conftest.er1 >conftest.err
   rm -f conftest.er1
   cat conftest.err >&5
   echo "$as_me:$LINENO: \$? = $ac_status" >&5
-  (exit $ac_status); } &&
-	 { ac_try='test -z "$ac_c_werror_flag"			 || test ! -s conftest.err'
-  { (eval echo "$as_me:$LINENO: \"$ac_try\"") >&5
-  (eval $ac_try) 2>&5
-  ac_status=$?
-  echo "$as_me:$LINENO: \$? = $ac_status" >&5
-  (exit $ac_status); }; } &&
-	 { ac_try='test -s conftest$ac_exeext'
-  { (eval echo "$as_me:$LINENO: \"$ac_try\"") >&5
-  (eval $ac_try) 2>&5
-  ac_status=$?
-  echo "$as_me:$LINENO: \$? = $ac_status" >&5
-  (exit $ac_status); }; }; then
+  (exit $ac_status); } && {
+	 test -z "$ac_c_werror_flag" ||
+	 test ! -s conftest.err
+       } && test -s conftest$ac_exeext &&
+       $as_test_x conftest$ac_exeext; then
   ac_cv_lib_ICE_IceConnectionNumber=yes
 else
   echo "$as_me: failed program was:" >&5
 sed 's/^/| /' conftest.$ac_ext >&5
 
-ac_cv_lib_ICE_IceConnectionNumber=no
+	ac_cv_lib_ICE_IceConnectionNumber=no
 fi
-rm -f conftest.err conftest.$ac_objext \
+
+rm -f core conftest.err conftest.$ac_objext conftest_ipa8_conftest.oo \
       conftest$ac_exeext conftest.$ac_ext
 LIBS=$ac_check_lib_save_LIBS
 fi
-echo "$as_me:$LINENO: result: $ac_cv_lib_ICE_IceConnectionNumber" >&5
-echo "${ECHO_T}$ac_cv_lib_ICE_IceConnectionNumber" >&6
+{ echo "$as_me:$LINENO: result: $ac_cv_lib_ICE_IceConnectionNumber" >&5
+echo "${ECHO_T}$ac_cv_lib_ICE_IceConnectionNumber" >&6; }
 if test $ac_cv_lib_ICE_IceConnectionNumber = yes; then
   X_PRE_LIBS="$X_PRE_LIBS -lSM -lICE"
 fi
@@ -4910,8 +5811,8 @@
 
 # double-check for X11
 if test "$no_x" != "yes"; then
-   echo "$as_me:$LINENO: checking for ANSI C header files" >&5
-echo $ECHO_N "checking for ANSI C header files... $ECHO_C" >&6
+   { echo "$as_me:$LINENO: checking for ANSI C header files" >&5
+echo $ECHO_N "checking for ANSI C header files... $ECHO_C" >&6; }
 if test "${ac_cv_header_stdc+set}" = set; then
   echo $ECHO_N "(cached) $ECHO_C" >&6
 else
@@ -4935,34 +5836,31 @@
 }
 _ACEOF
 rm -f conftest.$ac_objext
-if { (eval echo "$as_me:$LINENO: \"$ac_compile\"") >&5
-  (eval $ac_compile) 2>conftest.er1
+if { (ac_try="$ac_compile"
+case "(($ac_try" in
+  *\"* | *\`* | *\\*) ac_try_echo=\$ac_try;;
+  *) ac_try_echo=$ac_try;;
+esac
+eval "echo \"\$as_me:$LINENO: $ac_try_echo\"") >&5
+  (eval "$ac_compile") 2>conftest.er1
   ac_status=$?
   grep -v '^ *+' conftest.er1 >conftest.err
   rm -f conftest.er1
   cat conftest.err >&5
   echo "$as_me:$LINENO: \$? = $ac_status" >&5
-  (exit $ac_status); } &&
-	 { ac_try='test -z "$ac_c_werror_flag"			 || test ! -s conftest.err'
-  { (eval echo "$as_me:$LINENO: \"$ac_try\"") >&5
-  (eval $ac_try) 2>&5
-  ac_status=$?
-  echo "$as_me:$LINENO: \$? = $ac_status" >&5
-  (exit $ac_status); }; } &&
-	 { ac_try='test -s conftest.$ac_objext'
-  { (eval echo "$as_me:$LINENO: \"$ac_try\"") >&5
-  (eval $ac_try) 2>&5
-  ac_status=$?
-  echo "$as_me:$LINENO: \$? = $ac_status" >&5
-  (exit $ac_status); }; }; then
+  (exit $ac_status); } && {
+	 test -z "$ac_c_werror_flag" ||
+	 test ! -s conftest.err
+       } && test -s conftest.$ac_objext; then
   ac_cv_header_stdc=yes
 else
   echo "$as_me: failed program was:" >&5
 sed 's/^/| /' conftest.$ac_ext >&5
 
-ac_cv_header_stdc=no
+	ac_cv_header_stdc=no
 fi
-rm -f conftest.err conftest.$ac_objext conftest.$ac_ext
+
+rm -f core conftest.err conftest.$ac_objext conftest.$ac_ext
 
 if test $ac_cv_header_stdc = yes; then
   # SunOS 4.x string.h does not declare mem*, contrary to ANSI.
@@ -5018,6 +5916,7 @@
 cat >>conftest.$ac_ext <<_ACEOF
 /* end confdefs.h.  */
 #include <ctype.h>
+#include <stdlib.h>
 #if ((' ' & 0x0FF) == 0x020)
 # define ISLOWER(c) ('a' <= (c) && (c) <= 'z')
 # define TOUPPER(c) (ISLOWER(c) ? 'A' + ((c) - 'a') : (c))
@@ -5037,18 +5936,27 @@
   for (i = 0; i < 256; i++)
     if (XOR (islower (i), ISLOWER (i))
 	|| toupper (i) != TOUPPER (i))
-      exit(2);
-  exit (0);
+      return 2;
+  return 0;
 }
 _ACEOF
 rm -f conftest$ac_exeext
-if { (eval echo "$as_me:$LINENO: \"$ac_link\"") >&5
-  (eval $ac_link) 2>&5
+if { (ac_try="$ac_link"
+case "(($ac_try" in
+  *\"* | *\`* | *\\*) ac_try_echo=\$ac_try;;
+  *) ac_try_echo=$ac_try;;
+esac
+eval "echo \"\$as_me:$LINENO: $ac_try_echo\"") >&5
+  (eval "$ac_link") 2>&5
   ac_status=$?
   echo "$as_me:$LINENO: \$? = $ac_status" >&5
   (exit $ac_status); } && { ac_try='./conftest$ac_exeext'
-  { (eval echo "$as_me:$LINENO: \"$ac_try\"") >&5
-  (eval $ac_try) 2>&5
+  { (case "(($ac_try" in
+  *\"* | *\`* | *\\*) ac_try_echo=\$ac_try;;
+  *) ac_try_echo=$ac_try;;
+esac
+eval "echo \"\$as_me:$LINENO: $ac_try_echo\"") >&5
+  (eval "$ac_try") 2>&5
   ac_status=$?
   echo "$as_me:$LINENO: \$? = $ac_status" >&5
   (exit $ac_status); }; }; then
@@ -5061,12 +5969,14 @@
 ( exit $ac_status )
 ac_cv_header_stdc=no
 fi
-rm -f core *.core gmon.out bb.out conftest$ac_exeext conftest.$ac_objext conftest.$ac_ext
+rm -f core *.core core.conftest.* gmon.out bb.out conftest$ac_exeext conftest.$ac_objext conftest.$ac_ext
 fi
+
+
 fi
 fi
-echo "$as_me:$LINENO: result: $ac_cv_header_stdc" >&5
-echo "${ECHO_T}$ac_cv_header_stdc" >&6
+{ echo "$as_me:$LINENO: result: $ac_cv_header_stdc" >&5
+echo "${ECHO_T}$ac_cv_header_stdc" >&6; }
 if test $ac_cv_header_stdc = yes; then
 
 cat >>confdefs.h <<\_ACEOF
@@ -5089,9 +5999,9 @@
 		  inttypes.h stdint.h unistd.h
 do
 as_ac_Header=`echo "ac_cv_header_$ac_header" | $as_tr_sh`
-echo "$as_me:$LINENO: checking for $ac_header" >&5
-echo $ECHO_N "checking for $ac_header... $ECHO_C" >&6
-if eval "test \"\${$as_ac_Header+set}\" = set"; then
+{ echo "$as_me:$LINENO: checking for $ac_header" >&5
+echo $ECHO_N "checking for $ac_header... $ECHO_C" >&6; }
+if { as_var=$as_ac_Header; eval "test \"\${$as_var+set}\" = set"; }; then
   echo $ECHO_N "(cached) $ECHO_C" >&6
 else
   cat >conftest.$ac_ext <<_ACEOF
@@ -5105,37 +6015,35 @@
 #include <$ac_header>
 _ACEOF
 rm -f conftest.$ac_objext
-if { (eval echo "$as_me:$LINENO: \"$ac_compile\"") >&5
-  (eval $ac_compile) 2>conftest.er1
+if { (ac_try="$ac_compile"
+case "(($ac_try" in
+  *\"* | *\`* | *\\*) ac_try_echo=\$ac_try;;
+  *) ac_try_echo=$ac_try;;
+esac
+eval "echo \"\$as_me:$LINENO: $ac_try_echo\"") >&5
+  (eval "$ac_compile") 2>conftest.er1
   ac_status=$?
   grep -v '^ *+' conftest.er1 >conftest.err
   rm -f conftest.er1
   cat conftest.err >&5
   echo "$as_me:$LINENO: \$? = $ac_status" >&5
-  (exit $ac_status); } &&
-	 { ac_try='test -z "$ac_c_werror_flag"			 || test ! -s conftest.err'
-  { (eval echo "$as_me:$LINENO: \"$ac_try\"") >&5
-  (eval $ac_try) 2>&5
-  ac_status=$?
-  echo "$as_me:$LINENO: \$? = $ac_status" >&5
-  (exit $ac_status); }; } &&
-	 { ac_try='test -s conftest.$ac_objext'
-  { (eval echo "$as_me:$LINENO: \"$ac_try\"") >&5
-  (eval $ac_try) 2>&5
-  ac_status=$?
-  echo "$as_me:$LINENO: \$? = $ac_status" >&5
-  (exit $ac_status); }; }; then
+  (exit $ac_status); } && {
+	 test -z "$ac_c_werror_flag" ||
+	 test ! -s conftest.err
+       } && test -s conftest.$ac_objext; then
   eval "$as_ac_Header=yes"
 else
   echo "$as_me: failed program was:" >&5
 sed 's/^/| /' conftest.$ac_ext >&5
 
-eval "$as_ac_Header=no"
+	eval "$as_ac_Header=no"
 fi
-rm -f conftest.err conftest.$ac_objext conftest.$ac_ext
+
+rm -f core conftest.err conftest.$ac_objext conftest.$ac_ext
 fi
-echo "$as_me:$LINENO: result: `eval echo '${'$as_ac_Header'}'`" >&5
-echo "${ECHO_T}`eval echo '${'$as_ac_Header'}'`" >&6
+ac_res=`eval echo '${'$as_ac_Header'}'`
+	       { echo "$as_me:$LINENO: result: $ac_res" >&5
+echo "${ECHO_T}$ac_res" >&6; }
 if test `eval echo '${'$as_ac_Header'}'` = yes; then
   cat >>confdefs.h <<_ACEOF
 #define `echo "HAVE_$ac_header" | $as_tr_cpp` 1
@@ -5151,18 +6059,19 @@
 for ac_header in X11/Xlib.h X11/Xutil.h
 do
 as_ac_Header=`echo "ac_cv_header_$ac_header" | $as_tr_sh`
-if eval "test \"\${$as_ac_Header+set}\" = set"; then
-  echo "$as_me:$LINENO: checking for $ac_header" >&5
-echo $ECHO_N "checking for $ac_header... $ECHO_C" >&6
-if eval "test \"\${$as_ac_Header+set}\" = set"; then
+if { as_var=$as_ac_Header; eval "test \"\${$as_var+set}\" = set"; }; then
+  { echo "$as_me:$LINENO: checking for $ac_header" >&5
+echo $ECHO_N "checking for $ac_header... $ECHO_C" >&6; }
+if { as_var=$as_ac_Header; eval "test \"\${$as_var+set}\" = set"; }; then
   echo $ECHO_N "(cached) $ECHO_C" >&6
 fi
-echo "$as_me:$LINENO: result: `eval echo '${'$as_ac_Header'}'`" >&5
-echo "${ECHO_T}`eval echo '${'$as_ac_Header'}'`" >&6
+ac_res=`eval echo '${'$as_ac_Header'}'`
+	       { echo "$as_me:$LINENO: result: $ac_res" >&5
+echo "${ECHO_T}$ac_res" >&6; }
 else
   # Is the header compilable?
-echo "$as_me:$LINENO: checking $ac_header usability" >&5
-echo $ECHO_N "checking $ac_header usability... $ECHO_C" >&6
+{ echo "$as_me:$LINENO: checking $ac_header usability" >&5
+echo $ECHO_N "checking $ac_header usability... $ECHO_C" >&6; }
 cat >conftest.$ac_ext <<_ACEOF
 /* confdefs.h.  */
 _ACEOF
@@ -5173,40 +6082,37 @@
 #include <$ac_header>
 _ACEOF
 rm -f conftest.$ac_objext
-if { (eval echo "$as_me:$LINENO: \"$ac_compile\"") >&5
-  (eval $ac_compile) 2>conftest.er1
+if { (ac_try="$ac_compile"
+case "(($ac_try" in
+  *\"* | *\`* | *\\*) ac_try_echo=\$ac_try;;
+  *) ac_try_echo=$ac_try;;
+esac
+eval "echo \"\$as_me:$LINENO: $ac_try_echo\"") >&5
+  (eval "$ac_compile") 2>conftest.er1
   ac_status=$?
   grep -v '^ *+' conftest.er1 >conftest.err
   rm -f conftest.er1
   cat conftest.err >&5
   echo "$as_me:$LINENO: \$? = $ac_status" >&5
-  (exit $ac_status); } &&
-	 { ac_try='test -z "$ac_c_werror_flag"			 || test ! -s conftest.err'
-  { (eval echo "$as_me:$LINENO: \"$ac_try\"") >&5
-  (eval $ac_try) 2>&5
-  ac_status=$?
-  echo "$as_me:$LINENO: \$? = $ac_status" >&5
-  (exit $ac_status); }; } &&
-	 { ac_try='test -s conftest.$ac_objext'
-  { (eval echo "$as_me:$LINENO: \"$ac_try\"") >&5
-  (eval $ac_try) 2>&5
-  ac_status=$?
-  echo "$as_me:$LINENO: \$? = $ac_status" >&5
-  (exit $ac_status); }; }; then
+  (exit $ac_status); } && {
+	 test -z "$ac_c_werror_flag" ||
+	 test ! -s conftest.err
+       } && test -s conftest.$ac_objext; then
   ac_header_compiler=yes
 else
   echo "$as_me: failed program was:" >&5
 sed 's/^/| /' conftest.$ac_ext >&5
 
-ac_header_compiler=no
+	ac_header_compiler=no
 fi
-rm -f conftest.err conftest.$ac_objext conftest.$ac_ext
-echo "$as_me:$LINENO: result: $ac_header_compiler" >&5
-echo "${ECHO_T}$ac_header_compiler" >&6
+
+rm -f core conftest.err conftest.$ac_objext conftest.$ac_ext
+{ echo "$as_me:$LINENO: result: $ac_header_compiler" >&5
+echo "${ECHO_T}$ac_header_compiler" >&6; }
 
 # Is the header present?
-echo "$as_me:$LINENO: checking $ac_header presence" >&5
-echo $ECHO_N "checking $ac_header presence... $ECHO_C" >&6
+{ echo "$as_me:$LINENO: checking $ac_header presence" >&5
+echo $ECHO_N "checking $ac_header presence... $ECHO_C" >&6; }
 cat >conftest.$ac_ext <<_ACEOF
 /* confdefs.h.  */
 _ACEOF
@@ -5215,24 +6121,22 @@
 /* end confdefs.h.  */
 #include <$ac_header>
 _ACEOF
-if { (eval echo "$as_me:$LINENO: \"$ac_cpp conftest.$ac_ext\"") >&5
-  (eval $ac_cpp conftest.$ac_ext) 2>conftest.er1
+if { (ac_try="$ac_cpp conftest.$ac_ext"
+case "(($ac_try" in
+  *\"* | *\`* | *\\*) ac_try_echo=\$ac_try;;
+  *) ac_try_echo=$ac_try;;
+esac
+eval "echo \"\$as_me:$LINENO: $ac_try_echo\"") >&5
+  (eval "$ac_cpp conftest.$ac_ext") 2>conftest.er1
   ac_status=$?
   grep -v '^ *+' conftest.er1 >conftest.err
   rm -f conftest.er1
   cat conftest.err >&5
   echo "$as_me:$LINENO: \$? = $ac_status" >&5
-  (exit $ac_status); } >/dev/null; then
-  if test -s conftest.err; then
-    ac_cpp_err=$ac_c_preproc_warn_flag
-    ac_cpp_err=$ac_cpp_err$ac_c_werror_flag
-  else
-    ac_cpp_err=
-  fi
-else
-  ac_cpp_err=yes
-fi
-if test -z "$ac_cpp_err"; then
+  (exit $ac_status); } >/dev/null && {
+	 test -z "$ac_c_preproc_warn_flag$ac_c_werror_flag" ||
+	 test ! -s conftest.err
+       }; then
   ac_header_preproc=yes
 else
   echo "$as_me: failed program was:" >&5
@@ -5240,9 +6144,10 @@
 
   ac_header_preproc=no
 fi
+
 rm -f conftest.err conftest.$ac_ext
-echo "$as_me:$LINENO: result: $ac_header_preproc" >&5
-echo "${ECHO_T}$ac_header_preproc" >&6
+{ echo "$as_me:$LINENO: result: $ac_header_preproc" >&5
+echo "${ECHO_T}$ac_header_preproc" >&6; }
 
 # So?  What about this header?
 case $ac_header_compiler:$ac_header_preproc:$ac_c_preproc_warn_flag in
@@ -5266,25 +6171,24 @@
 echo "$as_me: WARNING: $ac_header: proceeding with the preprocessor's result" >&2;}
     { echo "$as_me:$LINENO: WARNING: $ac_header: in the future, the compiler will take precedence" >&5
 echo "$as_me: WARNING: $ac_header: in the future, the compiler will take precedence" >&2;}
-    (
-      cat <<\_ASBOX
+    ( cat <<\_ASBOX
 ## ---------------------------------------------------- ##
 ## Report this to lcd4linux-users@lists.sourceforge.net ##
 ## ---------------------------------------------------- ##
 _ASBOX
-    ) |
-      sed "s/^/$as_me: WARNING:     /" >&2
+     ) | sed "s/^/$as_me: WARNING:     /" >&2
     ;;
 esac
-echo "$as_me:$LINENO: checking for $ac_header" >&5
-echo $ECHO_N "checking for $ac_header... $ECHO_C" >&6
-if eval "test \"\${$as_ac_Header+set}\" = set"; then
+{ echo "$as_me:$LINENO: checking for $ac_header" >&5
+echo $ECHO_N "checking for $ac_header... $ECHO_C" >&6; }
+if { as_var=$as_ac_Header; eval "test \"\${$as_var+set}\" = set"; }; then
   echo $ECHO_N "(cached) $ECHO_C" >&6
 else
   eval "$as_ac_Header=\$ac_header_preproc"
 fi
-echo "$as_me:$LINENO: result: `eval echo '${'$as_ac_Header'}'`" >&5
-echo "${ECHO_T}`eval echo '${'$as_ac_Header'}'`" >&6
+ac_res=`eval echo '${'$as_ac_Header'}'`
+	       { echo "$as_me:$LINENO: result: $ac_res" >&5
+echo "${ECHO_T}$ac_res" >&6; }
 
 fi
 if test `eval echo '${'$as_ac_Header'}'` = yes; then
@@ -5312,18 +6216,19 @@
 for ac_header in gd/gd.h gd.h
 do
 as_ac_Header=`echo "ac_cv_header_$ac_header" | $as_tr_sh`
-if eval "test \"\${$as_ac_Header+set}\" = set"; then
-  echo "$as_me:$LINENO: checking for $ac_header" >&5
-echo $ECHO_N "checking for $ac_header... $ECHO_C" >&6
-if eval "test \"\${$as_ac_Header+set}\" = set"; then
+if { as_var=$as_ac_Header; eval "test \"\${$as_var+set}\" = set"; }; then
+  { echo "$as_me:$LINENO: checking for $ac_header" >&5
+echo $ECHO_N "checking for $ac_header... $ECHO_C" >&6; }
+if { as_var=$as_ac_Header; eval "test \"\${$as_var+set}\" = set"; }; then
   echo $ECHO_N "(cached) $ECHO_C" >&6
 fi
-echo "$as_me:$LINENO: result: `eval echo '${'$as_ac_Header'}'`" >&5
-echo "${ECHO_T}`eval echo '${'$as_ac_Header'}'`" >&6
+ac_res=`eval echo '${'$as_ac_Header'}'`
+	       { echo "$as_me:$LINENO: result: $ac_res" >&5
+echo "${ECHO_T}$ac_res" >&6; }
 else
   # Is the header compilable?
-echo "$as_me:$LINENO: checking $ac_header usability" >&5
-echo $ECHO_N "checking $ac_header usability... $ECHO_C" >&6
+{ echo "$as_me:$LINENO: checking $ac_header usability" >&5
+echo $ECHO_N "checking $ac_header usability... $ECHO_C" >&6; }
 cat >conftest.$ac_ext <<_ACEOF
 /* confdefs.h.  */
 _ACEOF
@@ -5334,40 +6239,37 @@
 #include <$ac_header>
 _ACEOF
 rm -f conftest.$ac_objext
-if { (eval echo "$as_me:$LINENO: \"$ac_compile\"") >&5
-  (eval $ac_compile) 2>conftest.er1
+if { (ac_try="$ac_compile"
+case "(($ac_try" in
+  *\"* | *\`* | *\\*) ac_try_echo=\$ac_try;;
+  *) ac_try_echo=$ac_try;;
+esac
+eval "echo \"\$as_me:$LINENO: $ac_try_echo\"") >&5
+  (eval "$ac_compile") 2>conftest.er1
   ac_status=$?
   grep -v '^ *+' conftest.er1 >conftest.err
   rm -f conftest.er1
   cat conftest.err >&5
   echo "$as_me:$LINENO: \$? = $ac_status" >&5
-  (exit $ac_status); } &&
-	 { ac_try='test -z "$ac_c_werror_flag"			 || test ! -s conftest.err'
-  { (eval echo "$as_me:$LINENO: \"$ac_try\"") >&5
-  (eval $ac_try) 2>&5
-  ac_status=$?
-  echo "$as_me:$LINENO: \$? = $ac_status" >&5
-  (exit $ac_status); }; } &&
-	 { ac_try='test -s conftest.$ac_objext'
-  { (eval echo "$as_me:$LINENO: \"$ac_try\"") >&5
-  (eval $ac_try) 2>&5
-  ac_status=$?
-  echo "$as_me:$LINENO: \$? = $ac_status" >&5
-  (exit $ac_status); }; }; then
+  (exit $ac_status); } && {
+	 test -z "$ac_c_werror_flag" ||
+	 test ! -s conftest.err
+       } && test -s conftest.$ac_objext; then
   ac_header_compiler=yes
 else
   echo "$as_me: failed program was:" >&5
 sed 's/^/| /' conftest.$ac_ext >&5
 
-ac_header_compiler=no
+	ac_header_compiler=no
 fi
-rm -f conftest.err conftest.$ac_objext conftest.$ac_ext
-echo "$as_me:$LINENO: result: $ac_header_compiler" >&5
-echo "${ECHO_T}$ac_header_compiler" >&6
+
+rm -f core conftest.err conftest.$ac_objext conftest.$ac_ext
+{ echo "$as_me:$LINENO: result: $ac_header_compiler" >&5
+echo "${ECHO_T}$ac_header_compiler" >&6; }
 
 # Is the header present?
-echo "$as_me:$LINENO: checking $ac_header presence" >&5
-echo $ECHO_N "checking $ac_header presence... $ECHO_C" >&6
+{ echo "$as_me:$LINENO: checking $ac_header presence" >&5
+echo $ECHO_N "checking $ac_header presence... $ECHO_C" >&6; }
 cat >conftest.$ac_ext <<_ACEOF
 /* confdefs.h.  */
 _ACEOF
@@ -5376,24 +6278,22 @@
 /* end confdefs.h.  */
 #include <$ac_header>
 _ACEOF
-if { (eval echo "$as_me:$LINENO: \"$ac_cpp conftest.$ac_ext\"") >&5
-  (eval $ac_cpp conftest.$ac_ext) 2>conftest.er1
+if { (ac_try="$ac_cpp conftest.$ac_ext"
+case "(($ac_try" in
+  *\"* | *\`* | *\\*) ac_try_echo=\$ac_try;;
+  *) ac_try_echo=$ac_try;;
+esac
+eval "echo \"\$as_me:$LINENO: $ac_try_echo\"") >&5
+  (eval "$ac_cpp conftest.$ac_ext") 2>conftest.er1
   ac_status=$?
   grep -v '^ *+' conftest.er1 >conftest.err
   rm -f conftest.er1
   cat conftest.err >&5
   echo "$as_me:$LINENO: \$? = $ac_status" >&5
-  (exit $ac_status); } >/dev/null; then
-  if test -s conftest.err; then
-    ac_cpp_err=$ac_c_preproc_warn_flag
-    ac_cpp_err=$ac_cpp_err$ac_c_werror_flag
-  else
-    ac_cpp_err=
-  fi
-else
-  ac_cpp_err=yes
-fi
-if test -z "$ac_cpp_err"; then
+  (exit $ac_status); } >/dev/null && {
+	 test -z "$ac_c_preproc_warn_flag$ac_c_werror_flag" ||
+	 test ! -s conftest.err
+       }; then
   ac_header_preproc=yes
 else
   echo "$as_me: failed program was:" >&5
@@ -5401,9 +6301,10 @@
 
   ac_header_preproc=no
 fi
+
 rm -f conftest.err conftest.$ac_ext
-echo "$as_me:$LINENO: result: $ac_header_preproc" >&5
-echo "${ECHO_T}$ac_header_preproc" >&6
+{ echo "$as_me:$LINENO: result: $ac_header_preproc" >&5
+echo "${ECHO_T}$ac_header_preproc" >&6; }
 
 # So?  What about this header?
 case $ac_header_compiler:$ac_header_preproc:$ac_c_preproc_warn_flag in
@@ -5427,25 +6328,24 @@
 echo "$as_me: WARNING: $ac_header: proceeding with the preprocessor's result" >&2;}
     { echo "$as_me:$LINENO: WARNING: $ac_header: in the future, the compiler will take precedence" >&5
 echo "$as_me: WARNING: $ac_header: in the future, the compiler will take precedence" >&2;}
-    (
-      cat <<\_ASBOX
+    ( cat <<\_ASBOX
 ## ---------------------------------------------------- ##
 ## Report this to lcd4linux-users@lists.sourceforge.net ##
 ## ---------------------------------------------------- ##
 _ASBOX
-    ) |
-      sed "s/^/$as_me: WARNING:     /" >&2
+     ) | sed "s/^/$as_me: WARNING:     /" >&2
     ;;
 esac
-echo "$as_me:$LINENO: checking for $ac_header" >&5
-echo $ECHO_N "checking for $ac_header... $ECHO_C" >&6
-if eval "test \"\${$as_ac_Header+set}\" = set"; then
+{ echo "$as_me:$LINENO: checking for $ac_header" >&5
+echo $ECHO_N "checking for $ac_header... $ECHO_C" >&6; }
+if { as_var=$as_ac_Header; eval "test \"\${$as_var+set}\" = set"; }; then
   echo $ECHO_N "(cached) $ECHO_C" >&6
 else
   eval "$as_ac_Header=\$ac_header_preproc"
 fi
-echo "$as_me:$LINENO: result: `eval echo '${'$as_ac_Header'}'`" >&5
-echo "${ECHO_T}`eval echo '${'$as_ac_Header'}'`" >&6
+ac_res=`eval echo '${'$as_ac_Header'}'`
+	       { echo "$as_me:$LINENO: result: $ac_res" >&5
+echo "${ECHO_T}$ac_res" >&6; }
 
 fi
 if test `eval echo '${'$as_ac_Header'}'` = yes; then
@@ -5460,23 +6360,24 @@
 done
 
 
-# check for usb.h
+# check for sys/io.h (RouterBoard driver)
 
-for ac_header in usb.h
+for ac_header in sys/io.h
 do
 as_ac_Header=`echo "ac_cv_header_$ac_header" | $as_tr_sh`
-if eval "test \"\${$as_ac_Header+set}\" = set"; then
-  echo "$as_me:$LINENO: checking for $ac_header" >&5
-echo $ECHO_N "checking for $ac_header... $ECHO_C" >&6
-if eval "test \"\${$as_ac_Header+set}\" = set"; then
+if { as_var=$as_ac_Header; eval "test \"\${$as_var+set}\" = set"; }; then
+  { echo "$as_me:$LINENO: checking for $ac_header" >&5
+echo $ECHO_N "checking for $ac_header... $ECHO_C" >&6; }
+if { as_var=$as_ac_Header; eval "test \"\${$as_var+set}\" = set"; }; then
   echo $ECHO_N "(cached) $ECHO_C" >&6
 fi
-echo "$as_me:$LINENO: result: `eval echo '${'$as_ac_Header'}'`" >&5
-echo "${ECHO_T}`eval echo '${'$as_ac_Header'}'`" >&6
+ac_res=`eval echo '${'$as_ac_Header'}'`
+	       { echo "$as_me:$LINENO: result: $ac_res" >&5
+echo "${ECHO_T}$ac_res" >&6; }
 else
   # Is the header compilable?
-echo "$as_me:$LINENO: checking $ac_header usability" >&5
-echo $ECHO_N "checking $ac_header usability... $ECHO_C" >&6
+{ echo "$as_me:$LINENO: checking $ac_header usability" >&5
+echo $ECHO_N "checking $ac_header usability... $ECHO_C" >&6; }
 cat >conftest.$ac_ext <<_ACEOF
 /* confdefs.h.  */
 _ACEOF
@@ -5487,40 +6388,37 @@
 #include <$ac_header>
 _ACEOF
 rm -f conftest.$ac_objext
-if { (eval echo "$as_me:$LINENO: \"$ac_compile\"") >&5
-  (eval $ac_compile) 2>conftest.er1
+if { (ac_try="$ac_compile"
+case "(($ac_try" in
+  *\"* | *\`* | *\\*) ac_try_echo=\$ac_try;;
+  *) ac_try_echo=$ac_try;;
+esac
+eval "echo \"\$as_me:$LINENO: $ac_try_echo\"") >&5
+  (eval "$ac_compile") 2>conftest.er1
   ac_status=$?
   grep -v '^ *+' conftest.er1 >conftest.err
   rm -f conftest.er1
   cat conftest.err >&5
   echo "$as_me:$LINENO: \$? = $ac_status" >&5
-  (exit $ac_status); } &&
-	 { ac_try='test -z "$ac_c_werror_flag"			 || test ! -s conftest.err'
-  { (eval echo "$as_me:$LINENO: \"$ac_try\"") >&5
-  (eval $ac_try) 2>&5
-  ac_status=$?
-  echo "$as_me:$LINENO: \$? = $ac_status" >&5
-  (exit $ac_status); }; } &&
-	 { ac_try='test -s conftest.$ac_objext'
-  { (eval echo "$as_me:$LINENO: \"$ac_try\"") >&5
-  (eval $ac_try) 2>&5
-  ac_status=$?
-  echo "$as_me:$LINENO: \$? = $ac_status" >&5
-  (exit $ac_status); }; }; then
+  (exit $ac_status); } && {
+	 test -z "$ac_c_werror_flag" ||
+	 test ! -s conftest.err
+       } && test -s conftest.$ac_objext; then
   ac_header_compiler=yes
 else
   echo "$as_me: failed program was:" >&5
 sed 's/^/| /' conftest.$ac_ext >&5
 
-ac_header_compiler=no
+	ac_header_compiler=no
 fi
-rm -f conftest.err conftest.$ac_objext conftest.$ac_ext
-echo "$as_me:$LINENO: result: $ac_header_compiler" >&5
-echo "${ECHO_T}$ac_header_compiler" >&6
+
+rm -f core conftest.err conftest.$ac_objext conftest.$ac_ext
+{ echo "$as_me:$LINENO: result: $ac_header_compiler" >&5
+echo "${ECHO_T}$ac_header_compiler" >&6; }
 
 # Is the header present?
-echo "$as_me:$LINENO: checking $ac_header presence" >&5
-echo $ECHO_N "checking $ac_header presence... $ECHO_C" >&6
+{ echo "$as_me:$LINENO: checking $ac_header presence" >&5
+echo $ECHO_N "checking $ac_header presence... $ECHO_C" >&6; }
 cat >conftest.$ac_ext <<_ACEOF
 /* confdefs.h.  */
 _ACEOF
@@ -5529,24 +6427,22 @@
 /* end confdefs.h.  */
 #include <$ac_header>
 _ACEOF
-if { (eval echo "$as_me:$LINENO: \"$ac_cpp conftest.$ac_ext\"") >&5
-  (eval $ac_cpp conftest.$ac_ext) 2>conftest.er1
+if { (ac_try="$ac_cpp conftest.$ac_ext"
+case "(($ac_try" in
+  *\"* | *\`* | *\\*) ac_try_echo=\$ac_try;;
+  *) ac_try_echo=$ac_try;;
+esac
+eval "echo \"\$as_me:$LINENO: $ac_try_echo\"") >&5
+  (eval "$ac_cpp conftest.$ac_ext") 2>conftest.er1
   ac_status=$?
   grep -v '^ *+' conftest.er1 >conftest.err
   rm -f conftest.er1
   cat conftest.err >&5
   echo "$as_me:$LINENO: \$? = $ac_status" >&5
-  (exit $ac_status); } >/dev/null; then
-  if test -s conftest.err; then
-    ac_cpp_err=$ac_c_preproc_warn_flag
-    ac_cpp_err=$ac_cpp_err$ac_c_werror_flag
-  else
-    ac_cpp_err=
-  fi
-else
-  ac_cpp_err=yes
-fi
-if test -z "$ac_cpp_err"; then
+  (exit $ac_status); } >/dev/null && {
+	 test -z "$ac_c_preproc_warn_flag$ac_c_werror_flag" ||
+	 test ! -s conftest.err
+       }; then
   ac_header_preproc=yes
 else
   echo "$as_me: failed program was:" >&5
@@ -5554,9 +6450,10 @@
 
   ac_header_preproc=no
 fi
+
 rm -f conftest.err conftest.$ac_ext
-echo "$as_me:$LINENO: result: $ac_header_preproc" >&5
-echo "${ECHO_T}$ac_header_preproc" >&6
+{ echo "$as_me:$LINENO: result: $ac_header_preproc" >&5
+echo "${ECHO_T}$ac_header_preproc" >&6; }
 
 # So?  What about this header?
 case $ac_header_compiler:$ac_header_preproc:$ac_c_preproc_warn_flag in
@@ -5580,56 +6477,56 @@
 echo "$as_me: WARNING: $ac_header: proceeding with the preprocessor's result" >&2;}
     { echo "$as_me:$LINENO: WARNING: $ac_header: in the future, the compiler will take precedence" >&5
 echo "$as_me: WARNING: $ac_header: in the future, the compiler will take precedence" >&2;}
-    (
-      cat <<\_ASBOX
+    ( cat <<\_ASBOX
 ## ---------------------------------------------------- ##
 ## Report this to lcd4linux-users@lists.sourceforge.net ##
 ## ---------------------------------------------------- ##
 _ASBOX
-    ) |
-      sed "s/^/$as_me: WARNING:     /" >&2
+     ) | sed "s/^/$as_me: WARNING:     /" >&2
     ;;
 esac
-echo "$as_me:$LINENO: checking for $ac_header" >&5
-echo $ECHO_N "checking for $ac_header... $ECHO_C" >&6
-if eval "test \"\${$as_ac_Header+set}\" = set"; then
+{ echo "$as_me:$LINENO: checking for $ac_header" >&5
+echo $ECHO_N "checking for $ac_header... $ECHO_C" >&6; }
+if { as_var=$as_ac_Header; eval "test \"\${$as_var+set}\" = set"; }; then
   echo $ECHO_N "(cached) $ECHO_C" >&6
 else
   eval "$as_ac_Header=\$ac_header_preproc"
 fi
-echo "$as_me:$LINENO: result: `eval echo '${'$as_ac_Header'}'`" >&5
-echo "${ECHO_T}`eval echo '${'$as_ac_Header'}'`" >&6
+ac_res=`eval echo '${'$as_ac_Header'}'`
+	       { echo "$as_me:$LINENO: result: $ac_res" >&5
+echo "${ECHO_T}$ac_res" >&6; }
 
 fi
 if test `eval echo '${'$as_ac_Header'}'` = yes; then
   cat >>confdefs.h <<_ACEOF
 #define `echo "HAVE_$ac_header" | $as_tr_cpp` 1
 _ACEOF
- has_usb="true"
+ has_io_h="true"
 else
-  has_usb="false"
+  has_io_h="false"
 fi
 
 done
 
 
-# check for serdisplib
+# check for usb.h
 
-for ac_header in serdisplib/serdisp.h
+for ac_header in usb.h
 do
 as_ac_Header=`echo "ac_cv_header_$ac_header" | $as_tr_sh`
-if eval "test \"\${$as_ac_Header+set}\" = set"; then
-  echo "$as_me:$LINENO: checking for $ac_header" >&5
-echo $ECHO_N "checking for $ac_header... $ECHO_C" >&6
-if eval "test \"\${$as_ac_Header+set}\" = set"; then
+if { as_var=$as_ac_Header; eval "test \"\${$as_var+set}\" = set"; }; then
+  { echo "$as_me:$LINENO: checking for $ac_header" >&5
+echo $ECHO_N "checking for $ac_header... $ECHO_C" >&6; }
+if { as_var=$as_ac_Header; eval "test \"\${$as_var+set}\" = set"; }; then
   echo $ECHO_N "(cached) $ECHO_C" >&6
 fi
-echo "$as_me:$LINENO: result: `eval echo '${'$as_ac_Header'}'`" >&5
-echo "${ECHO_T}`eval echo '${'$as_ac_Header'}'`" >&6
+ac_res=`eval echo '${'$as_ac_Header'}'`
+	       { echo "$as_me:$LINENO: result: $ac_res" >&5
+echo "${ECHO_T}$ac_res" >&6; }
 else
   # Is the header compilable?
-echo "$as_me:$LINENO: checking $ac_header usability" >&5
-echo $ECHO_N "checking $ac_header usability... $ECHO_C" >&6
+{ echo "$as_me:$LINENO: checking $ac_header usability" >&5
+echo $ECHO_N "checking $ac_header usability... $ECHO_C" >&6; }
 cat >conftest.$ac_ext <<_ACEOF
 /* confdefs.h.  */
 _ACEOF
@@ -5640,40 +6537,37 @@
 #include <$ac_header>
 _ACEOF
 rm -f conftest.$ac_objext
-if { (eval echo "$as_me:$LINENO: \"$ac_compile\"") >&5
-  (eval $ac_compile) 2>conftest.er1
+if { (ac_try="$ac_compile"
+case "(($ac_try" in
+  *\"* | *\`* | *\\*) ac_try_echo=\$ac_try;;
+  *) ac_try_echo=$ac_try;;
+esac
+eval "echo \"\$as_me:$LINENO: $ac_try_echo\"") >&5
+  (eval "$ac_compile") 2>conftest.er1
   ac_status=$?
   grep -v '^ *+' conftest.er1 >conftest.err
   rm -f conftest.er1
   cat conftest.err >&5
   echo "$as_me:$LINENO: \$? = $ac_status" >&5
-  (exit $ac_status); } &&
-	 { ac_try='test -z "$ac_c_werror_flag"			 || test ! -s conftest.err'
-  { (eval echo "$as_me:$LINENO: \"$ac_try\"") >&5
-  (eval $ac_try) 2>&5
-  ac_status=$?
-  echo "$as_me:$LINENO: \$? = $ac_status" >&5
-  (exit $ac_status); }; } &&
-	 { ac_try='test -s conftest.$ac_objext'
-  { (eval echo "$as_me:$LINENO: \"$ac_try\"") >&5
-  (eval $ac_try) 2>&5
-  ac_status=$?
-  echo "$as_me:$LINENO: \$? = $ac_status" >&5
-  (exit $ac_status); }; }; then
+  (exit $ac_status); } && {
+	 test -z "$ac_c_werror_flag" ||
+	 test ! -s conftest.err
+       } && test -s conftest.$ac_objext; then
   ac_header_compiler=yes
 else
   echo "$as_me: failed program was:" >&5
 sed 's/^/| /' conftest.$ac_ext >&5
 
-ac_header_compiler=no
+	ac_header_compiler=no
 fi
-rm -f conftest.err conftest.$ac_objext conftest.$ac_ext
-echo "$as_me:$LINENO: result: $ac_header_compiler" >&5
-echo "${ECHO_T}$ac_header_compiler" >&6
+
+rm -f core conftest.err conftest.$ac_objext conftest.$ac_ext
+{ echo "$as_me:$LINENO: result: $ac_header_compiler" >&5
+echo "${ECHO_T}$ac_header_compiler" >&6; }
 
 # Is the header present?
-echo "$as_me:$LINENO: checking $ac_header presence" >&5
-echo $ECHO_N "checking $ac_header presence... $ECHO_C" >&6
+{ echo "$as_me:$LINENO: checking $ac_header presence" >&5
+echo $ECHO_N "checking $ac_header presence... $ECHO_C" >&6; }
 cat >conftest.$ac_ext <<_ACEOF
 /* confdefs.h.  */
 _ACEOF
@@ -5682,24 +6576,22 @@
 /* end confdefs.h.  */
 #include <$ac_header>
 _ACEOF
-if { (eval echo "$as_me:$LINENO: \"$ac_cpp conftest.$ac_ext\"") >&5
-  (eval $ac_cpp conftest.$ac_ext) 2>conftest.er1
+if { (ac_try="$ac_cpp conftest.$ac_ext"
+case "(($ac_try" in
+  *\"* | *\`* | *\\*) ac_try_echo=\$ac_try;;
+  *) ac_try_echo=$ac_try;;
+esac
+eval "echo \"\$as_me:$LINENO: $ac_try_echo\"") >&5
+  (eval "$ac_cpp conftest.$ac_ext") 2>conftest.er1
   ac_status=$?
   grep -v '^ *+' conftest.er1 >conftest.err
   rm -f conftest.er1
   cat conftest.err >&5
   echo "$as_me:$LINENO: \$? = $ac_status" >&5
-  (exit $ac_status); } >/dev/null; then
-  if test -s conftest.err; then
-    ac_cpp_err=$ac_c_preproc_warn_flag
-    ac_cpp_err=$ac_cpp_err$ac_c_werror_flag
-  else
-    ac_cpp_err=
-  fi
-else
-  ac_cpp_err=yes
-fi
-if test -z "$ac_cpp_err"; then
+  (exit $ac_status); } >/dev/null && {
+	 test -z "$ac_c_preproc_warn_flag$ac_c_werror_flag" ||
+	 test ! -s conftest.err
+       }; then
   ac_header_preproc=yes
 else
   echo "$as_me: failed program was:" >&5
@@ -5707,9 +6599,10 @@
 
   ac_header_preproc=no
 fi
+
 rm -f conftest.err conftest.$ac_ext
-echo "$as_me:$LINENO: result: $ac_header_preproc" >&5
-echo "${ECHO_T}$ac_header_preproc" >&6
+{ echo "$as_me:$LINENO: result: $ac_header_preproc" >&5
+echo "${ECHO_T}$ac_header_preproc" >&6; }
 
 # So?  What about this header?
 case $ac_header_compiler:$ac_header_preproc:$ac_c_preproc_warn_flag in
@@ -5733,759 +6626,4386 @@
 echo "$as_me: WARNING: $ac_header: proceeding with the preprocessor's result" >&2;}
     { echo "$as_me:$LINENO: WARNING: $ac_header: in the future, the compiler will take precedence" >&5
 echo "$as_me: WARNING: $ac_header: in the future, the compiler will take precedence" >&2;}
-    (
-      cat <<\_ASBOX
+    ( cat <<\_ASBOX
 ## ---------------------------------------------------- ##
 ## Report this to lcd4linux-users@lists.sourceforge.net ##
 ## ---------------------------------------------------- ##
 _ASBOX
-    ) |
-      sed "s/^/$as_me: WARNING:     /" >&2
+     ) | sed "s/^/$as_me: WARNING:     /" >&2
     ;;
 esac
-echo "$as_me:$LINENO: checking for $ac_header" >&5
-echo $ECHO_N "checking for $ac_header... $ECHO_C" >&6
-if eval "test \"\${$as_ac_Header+set}\" = set"; then
+{ echo "$as_me:$LINENO: checking for $ac_header" >&5
+echo $ECHO_N "checking for $ac_header... $ECHO_C" >&6; }
+if { as_var=$as_ac_Header; eval "test \"\${$as_var+set}\" = set"; }; then
   echo $ECHO_N "(cached) $ECHO_C" >&6
 else
   eval "$as_ac_Header=\$ac_header_preproc"
 fi
-echo "$as_me:$LINENO: result: `eval echo '${'$as_ac_Header'}'`" >&5
-echo "${ECHO_T}`eval echo '${'$as_ac_Header'}'`" >&6
+ac_res=`eval echo '${'$as_ac_Header'}'`
+	       { echo "$as_me:$LINENO: result: $ac_res" >&5
+echo "${ECHO_T}$ac_res" >&6; }
 
 fi
 if test `eval echo '${'$as_ac_Header'}'` = yes; then
   cat >>confdefs.h <<_ACEOF
 #define `echo "HAVE_$ac_header" | $as_tr_cpp` 1
 _ACEOF
- has_serdisplib="true"
+ has_usb="true"
 else
-  has_serdisplib="false"
+  has_usb="false"
 fi
 
 done
 
 
-# check for python
-echo "$as_me:$LINENO: checking if python support is wanted" >&5
-echo $ECHO_N "checking if python support is wanted... $ECHO_C" >&6
+# check for luise.h
 
-# Check whether --with-python or --without-python was given.
-if test "${with_python+set}" = set; then
-  withval="$with_python"
-  echo "$as_me:$LINENO: result: $withval" >&5
-echo "${ECHO_T}$withval" >&6
+for ac_header in luise.h
+do
+as_ac_Header=`echo "ac_cv_header_$ac_header" | $as_tr_sh`
+if { as_var=$as_ac_Header; eval "test \"\${$as_var+set}\" = set"; }; then
+  { echo "$as_me:$LINENO: checking for $ac_header" >&5
+echo $ECHO_N "checking for $ac_header... $ECHO_C" >&6; }
+if { as_var=$as_ac_Header; eval "test \"\${$as_var+set}\" = set"; }; then
+  echo $ECHO_N "(cached) $ECHO_C" >&6
+fi
+ac_res=`eval echo '${'$as_ac_Header'}'`
+	       { echo "$as_me:$LINENO: result: $ac_res" >&5
+echo "${ECHO_T}$ac_res" >&6; }
 else
-  echo "$as_me:$LINENO: result: no" >&5
-echo "${ECHO_T}no" >&6
-fi;
-if test "$with_python" = "yes"; then
-  ## ------------------------
-## Python file handling
-## From Andrew Dalke
-## Updated by James Henstridge
-## ------------------------
-
-# Copyright 1999, 2000, 2001, 2002, 2003  Free Software Foundation, Inc.
-
-# This program is free software; you can redistribute it and/or modify
-# it under the terms of the GNU General Public License as published by
-# the Free Software Foundation; either version 2, or (at your option)
-# any later version.
-
-# This program is distributed in the hope that it will be useful,
-# but WITHOUT ANY WARRANTY; without even the implied warranty of
-# MERCHANTABILITY or FITNESS FOR A PARTICULAR PURPOSE.  See the
-# GNU General Public License for more details.
-
-# You should have received a copy of the GNU General Public License
-# along with this program; if not, write to the Free Software
-# Foundation, Inc., 59 Temple Place - Suite 330, Boston, MA
-# 02111-1307, USA.
-
-# AM_PATH_PYTHON([MINIMUM-VERSION])
-
-# Adds support for distributing Python modules and packages.  To
-# install modules, copy them to $(pythondir), using the python_PYTHON
-# automake variable.  To install a package with the same name as the
-# automake package, install to $(pkgpythondir), or use the
-# pkgpython_PYTHON automake variable.
-
-# The variables $(pyexecdir) and $(pkgpyexecdir) are provided as
-# locations to install python extension modules (shared libraries).
-# Another macro is required to find the appropriate flags to compile
-# extension modules.
-
-# If your package is configured with a different prefix to python,
-# users will have to add the install directory to the PYTHONPATH
-# environment variable, or create a .pth file (see the python
-# documentation for details).
-
-# If the MINIMUM-VERSION argument is passed, AM_PATH_PYTHON will
-# cause an error if the version of python installed on the system
-# doesn't meet the requirement.  MINIMUM-VERSION should consist of
-# numbers and dots only.
-
+  # Is the header compilable?
+{ echo "$as_me:$LINENO: checking $ac_header usability" >&5
+echo $ECHO_N "checking $ac_header usability... $ECHO_C" >&6; }
+cat >conftest.$ac_ext <<_ACEOF
+/* confdefs.h.  */
+_ACEOF
+cat confdefs.h >>conftest.$ac_ext
+cat >>conftest.$ac_ext <<_ACEOF
+/* end confdefs.h.  */
+$ac_includes_default
+#include <$ac_header>
+_ACEOF
+rm -f conftest.$ac_objext
+if { (ac_try="$ac_compile"
+case "(($ac_try" in
+  *\"* | *\`* | *\\*) ac_try_echo=\$ac_try;;
+  *) ac_try_echo=$ac_try;;
+esac
+eval "echo \"\$as_me:$LINENO: $ac_try_echo\"") >&5
+  (eval "$ac_compile") 2>conftest.er1
+  ac_status=$?
+  grep -v '^ *+' conftest.er1 >conftest.err
+  rm -f conftest.er1
+  cat conftest.err >&5
+  echo "$as_me:$LINENO: \$? = $ac_status" >&5
+  (exit $ac_status); } && {
+	 test -z "$ac_c_werror_flag" ||
+	 test ! -s conftest.err
+       } && test -s conftest.$ac_objext; then
+  ac_header_compiler=yes
+else
+  echo "$as_me: failed program was:" >&5
+sed 's/^/| /' conftest.$ac_ext >&5
 
+	ac_header_compiler=no
+fi
 
+rm -f core conftest.err conftest.$ac_objext conftest.$ac_ext
+{ echo "$as_me:$LINENO: result: $ac_header_compiler" >&5
+echo "${ECHO_T}$ac_header_compiler" >&6; }
 
-# AM_PYTHON_CHECK_VERSION(PROG, VERSION, [ACTION-IF-TRUE], [ACTION-IF-FALSE])
-# ---------------------------------------------------------------------------
-# Run ACTION-IF-TRUE if the Python interpreter PROG has version >= VERSION.
-# Run ACTION-IF-FALSE otherwise.
-# This test uses sys.hexversion instead of the string equivalent (first
-# word of sys.version), in order to cope with versions such as 2.2c1.
-# hexversion has been introduced in Python 1.5.2; it's probably not
-# worth to support older versions (1.5.1 was released on October 31, 1998).
+# Is the header present?
+{ echo "$as_me:$LINENO: checking $ac_header presence" >&5
+echo $ECHO_N "checking $ac_header presence... $ECHO_C" >&6; }
+cat >conftest.$ac_ext <<_ACEOF
+/* confdefs.h.  */
+_ACEOF
+cat confdefs.h >>conftest.$ac_ext
+cat >>conftest.$ac_ext <<_ACEOF
+/* end confdefs.h.  */
+#include <$ac_header>
+_ACEOF
+if { (ac_try="$ac_cpp conftest.$ac_ext"
+case "(($ac_try" in
+  *\"* | *\`* | *\\*) ac_try_echo=\$ac_try;;
+  *) ac_try_echo=$ac_try;;
+esac
+eval "echo \"\$as_me:$LINENO: $ac_try_echo\"") >&5
+  (eval "$ac_cpp conftest.$ac_ext") 2>conftest.er1
+  ac_status=$?
+  grep -v '^ *+' conftest.er1 >conftest.err
+  rm -f conftest.er1
+  cat conftest.err >&5
+  echo "$as_me:$LINENO: \$? = $ac_status" >&5
+  (exit $ac_status); } >/dev/null && {
+	 test -z "$ac_c_preproc_warn_flag$ac_c_werror_flag" ||
+	 test ! -s conftest.err
+       }; then
+  ac_header_preproc=yes
+else
+  echo "$as_me: failed program was:" >&5
+sed 's/^/| /' conftest.$ac_ext >&5
 
+  ac_header_preproc=no
+fi
 
+rm -f conftest.err conftest.$ac_ext
+{ echo "$as_me:$LINENO: result: $ac_header_preproc" >&5
+echo "${ECHO_T}$ac_header_preproc" >&6; }
 
+# So?  What about this header?
+case $ac_header_compiler:$ac_header_preproc:$ac_c_preproc_warn_flag in
+  yes:no: )
+    { echo "$as_me:$LINENO: WARNING: $ac_header: accepted by the compiler, rejected by the preprocessor!" >&5
+echo "$as_me: WARNING: $ac_header: accepted by the compiler, rejected by the preprocessor!" >&2;}
+    { echo "$as_me:$LINENO: WARNING: $ac_header: proceeding with the compiler's result" >&5
+echo "$as_me: WARNING: $ac_header: proceeding with the compiler's result" >&2;}
+    ac_header_preproc=yes
+    ;;
+  no:yes:* )
+    { echo "$as_me:$LINENO: WARNING: $ac_header: present but cannot be compiled" >&5
+echo "$as_me: WARNING: $ac_header: present but cannot be compiled" >&2;}
+    { echo "$as_me:$LINENO: WARNING: $ac_header:     check for missing prerequisite headers?" >&5
+echo "$as_me: WARNING: $ac_header:     check for missing prerequisite headers?" >&2;}
+    { echo "$as_me:$LINENO: WARNING: $ac_header: see the Autoconf documentation" >&5
+echo "$as_me: WARNING: $ac_header: see the Autoconf documentation" >&2;}
+    { echo "$as_me:$LINENO: WARNING: $ac_header:     section \"Present But Cannot Be Compiled\"" >&5
+echo "$as_me: WARNING: $ac_header:     section \"Present But Cannot Be Compiled\"" >&2;}
+    { echo "$as_me:$LINENO: WARNING: $ac_header: proceeding with the preprocessor's result" >&5
+echo "$as_me: WARNING: $ac_header: proceeding with the preprocessor's result" >&2;}
+    { echo "$as_me:$LINENO: WARNING: $ac_header: in the future, the compiler will take precedence" >&5
+echo "$as_me: WARNING: $ac_header: in the future, the compiler will take precedence" >&2;}
+    ( cat <<\_ASBOX
+## ---------------------------------------------------- ##
+## Report this to lcd4linux-users@lists.sourceforge.net ##
+## ---------------------------------------------------- ##
+_ASBOX
+     ) | sed "s/^/$as_me: WARNING:     /" >&2
+    ;;
+esac
+{ echo "$as_me:$LINENO: checking for $ac_header" >&5
+echo $ECHO_N "checking for $ac_header... $ECHO_C" >&6; }
+if { as_var=$as_ac_Header; eval "test \"\${$as_var+set}\" = set"; }; then
+  echo $ECHO_N "(cached) $ECHO_C" >&6
+else
+  eval "$as_ac_Header=\$ac_header_preproc"
+fi
+ac_res=`eval echo '${'$as_ac_Header'}'`
+	       { echo "$as_me:$LINENO: result: $ac_res" >&5
+echo "${ECHO_T}$ac_res" >&6; }
 
+fi
+if test `eval echo '${'$as_ac_Header'}'` = yes; then
+  cat >>confdefs.h <<_ACEOF
+#define `echo "HAVE_$ac_header" | $as_tr_cpp` 1
+_ACEOF
+ has_luise="true"
+else
+  has_luise="false"
+fi
 
+done
 
 
+# check for serdisplib
 
-  PYTHON__DEVEL
+for ac_header in serdisplib/serdisp.h
+do
+as_ac_Header=`echo "ac_cv_header_$ac_header" | $as_tr_sh`
+if { as_var=$as_ac_Header; eval "test \"\${$as_var+set}\" = set"; }; then
+  { echo "$as_me:$LINENO: checking for $ac_header" >&5
+echo $ECHO_N "checking for $ac_header... $ECHO_C" >&6; }
+if { as_var=$as_ac_Header; eval "test \"\${$as_var+set}\" = set"; }; then
+  echo $ECHO_N "(cached) $ECHO_C" >&6
 fi
+ac_res=`eval echo '${'$as_ac_Header'}'`
+	       { echo "$as_me:$LINENO: result: $ac_res" >&5
+echo "${ECHO_T}$ac_res" >&6; }
+else
+  # Is the header compilable?
+{ echo "$as_me:$LINENO: checking $ac_header usability" >&5
+echo $ECHO_N "checking $ac_header usability... $ECHO_C" >&6; }
+cat >conftest.$ac_ext <<_ACEOF
+/* confdefs.h.  */
+_ACEOF
+cat confdefs.h >>conftest.$ac_ext
+cat >>conftest.$ac_ext <<_ACEOF
+/* end confdefs.h.  */
+$ac_includes_default
+#include <$ac_header>
+_ACEOF
+rm -f conftest.$ac_objext
+if { (ac_try="$ac_compile"
+case "(($ac_try" in
+  *\"* | *\`* | *\\*) ac_try_echo=\$ac_try;;
+  *) ac_try_echo=$ac_try;;
+esac
+eval "echo \"\$as_me:$LINENO: $ac_try_echo\"") >&5
+  (eval "$ac_compile") 2>conftest.er1
+  ac_status=$?
+  grep -v '^ *+' conftest.er1 >conftest.err
+  rm -f conftest.er1
+  cat conftest.err >&5
+  echo "$as_me:$LINENO: \$? = $ac_status" >&5
+  (exit $ac_status); } && {
+	 test -z "$ac_c_werror_flag" ||
+	 test ! -s conftest.err
+       } && test -s conftest.$ac_objext; then
+  ac_header_compiler=yes
+else
+  echo "$as_me: failed program was:" >&5
+sed 's/^/| /' conftest.$ac_ext >&5
 
-# drivers
+	ac_header_compiler=no
+fi
 
-echo "$as_me:$LINENO: checking which drivers to compile" >&5
-echo $ECHO_N "checking which drivers to compile... $ECHO_C" >&6
+rm -f core conftest.err conftest.$ac_objext conftest.$ac_ext
+{ echo "$as_me:$LINENO: result: $ac_header_compiler" >&5
+echo "${ECHO_T}$ac_header_compiler" >&6; }
 
-# Check whether --with-drivers or --without-drivers was given.
-if test "${with_drivers+set}" = set; then
-  withval="$with_drivers"
-  drivers=$withval
+# Is the header present?
+{ echo "$as_me:$LINENO: checking $ac_header presence" >&5
+echo $ECHO_N "checking $ac_header presence... $ECHO_C" >&6; }
+cat >conftest.$ac_ext <<_ACEOF
+/* confdefs.h.  */
+_ACEOF
+cat confdefs.h >>conftest.$ac_ext
+cat >>conftest.$ac_ext <<_ACEOF
+/* end confdefs.h.  */
+#include <$ac_header>
+_ACEOF
+if { (ac_try="$ac_cpp conftest.$ac_ext"
+case "(($ac_try" in
+  *\"* | *\`* | *\\*) ac_try_echo=\$ac_try;;
+  *) ac_try_echo=$ac_try;;
+esac
+eval "echo \"\$as_me:$LINENO: $ac_try_echo\"") >&5
+  (eval "$ac_cpp conftest.$ac_ext") 2>conftest.er1
+  ac_status=$?
+  grep -v '^ *+' conftest.er1 >conftest.err
+  rm -f conftest.er1
+  cat conftest.err >&5
+  echo "$as_me:$LINENO: \$? = $ac_status" >&5
+  (exit $ac_status); } >/dev/null && {
+	 test -z "$ac_c_preproc_warn_flag$ac_c_werror_flag" ||
+	 test ! -s conftest.err
+       }; then
+  ac_header_preproc=yes
 else
-  drivers=all
-
-fi;
+  echo "$as_me: failed program was:" >&5
+sed 's/^/| /' conftest.$ac_ext >&5
 
-drivers=`echo $drivers|sed 's/,/ /g'`
+  ac_header_preproc=no
+fi
 
-for driver in $drivers; do
+rm -f conftest.err conftest.$ac_ext
+{ echo "$as_me:$LINENO: result: $ac_header_preproc" >&5
+echo "${ECHO_T}$ac_header_preproc" >&6; }
 
-   case $driver in
-      !*)
-         val="no"
-         driver=`echo $driver|cut -c 2-`
-         ;;
-       *)
-         val="yes"
-         ;;
+# So?  What about this header?
+case $ac_header_compiler:$ac_header_preproc:$ac_c_preproc_warn_flag in
+  yes:no: )
+    { echo "$as_me:$LINENO: WARNING: $ac_header: accepted by the compiler, rejected by the preprocessor!" >&5
+echo "$as_me: WARNING: $ac_header: accepted by the compiler, rejected by the preprocessor!" >&2;}
+    { echo "$as_me:$LINENO: WARNING: $ac_header: proceeding with the compiler's result" >&5
+echo "$as_me: WARNING: $ac_header: proceeding with the compiler's result" >&2;}
+    ac_header_preproc=yes
+    ;;
+  no:yes:* )
+    { echo "$as_me:$LINENO: WARNING: $ac_header: present but cannot be compiled" >&5
+echo "$as_me: WARNING: $ac_header: present but cannot be compiled" >&2;}
+    { echo "$as_me:$LINENO: WARNING: $ac_header:     check for missing prerequisite headers?" >&5
+echo "$as_me: WARNING: $ac_header:     check for missing prerequisite headers?" >&2;}
+    { echo "$as_me:$LINENO: WARNING: $ac_header: see the Autoconf documentation" >&5
+echo "$as_me: WARNING: $ac_header: see the Autoconf documentation" >&2;}
+    { echo "$as_me:$LINENO: WARNING: $ac_header:     section \"Present But Cannot Be Compiled\"" >&5
+echo "$as_me: WARNING: $ac_header:     section \"Present But Cannot Be Compiled\"" >&2;}
+    { echo "$as_me:$LINENO: WARNING: $ac_header: proceeding with the preprocessor's result" >&5
+echo "$as_me: WARNING: $ac_header: proceeding with the preprocessor's result" >&2;}
+    { echo "$as_me:$LINENO: WARNING: $ac_header: in the future, the compiler will take precedence" >&5
+echo "$as_me: WARNING: $ac_header: in the future, the compiler will take precedence" >&2;}
+    ( cat <<\_ASBOX
+## ---------------------------------------------------- ##
+## Report this to lcd4linux-users@lists.sourceforge.net ##
+## ---------------------------------------------------- ##
+_ASBOX
+     ) | sed "s/^/$as_me: WARNING:     /" >&2
+    ;;
+esac
+{ echo "$as_me:$LINENO: checking for $ac_header" >&5
+echo $ECHO_N "checking for $ac_header... $ECHO_C" >&6; }
+if { as_var=$as_ac_Header; eval "test \"\${$as_var+set}\" = set"; }; then
+  echo $ECHO_N "(cached) $ECHO_C" >&6
+else
+  eval "$as_ac_Header=\$ac_header_preproc"
+fi
+ac_res=`eval echo '${'$as_ac_Header'}'`
+	       { echo "$as_me:$LINENO: result: $ac_res" >&5
+echo "${ECHO_T}$ac_res" >&6; }
+
+fi
+if test `eval echo '${'$as_ac_Header'}'` = yes; then
+  cat >>confdefs.h <<_ACEOF
+#define `echo "HAVE_$ac_header" | $as_tr_cpp` 1
+_ACEOF
+ has_serdisplib="true"
+else
+  has_serdisplib="false"
+fi
+
+done
+
+
+# check for st2205 libs
+
+for ac_header in st2205.h
+do
+as_ac_Header=`echo "ac_cv_header_$ac_header" | $as_tr_sh`
+if { as_var=$as_ac_Header; eval "test \"\${$as_var+set}\" = set"; }; then
+  { echo "$as_me:$LINENO: checking for $ac_header" >&5
+echo $ECHO_N "checking for $ac_header... $ECHO_C" >&6; }
+if { as_var=$as_ac_Header; eval "test \"\${$as_var+set}\" = set"; }; then
+  echo $ECHO_N "(cached) $ECHO_C" >&6
+fi
+ac_res=`eval echo '${'$as_ac_Header'}'`
+	       { echo "$as_me:$LINENO: result: $ac_res" >&5
+echo "${ECHO_T}$ac_res" >&6; }
+else
+  # Is the header compilable?
+{ echo "$as_me:$LINENO: checking $ac_header usability" >&5
+echo $ECHO_N "checking $ac_header usability... $ECHO_C" >&6; }
+cat >conftest.$ac_ext <<_ACEOF
+/* confdefs.h.  */
+_ACEOF
+cat confdefs.h >>conftest.$ac_ext
+cat >>conftest.$ac_ext <<_ACEOF
+/* end confdefs.h.  */
+$ac_includes_default
+#include <$ac_header>
+_ACEOF
+rm -f conftest.$ac_objext
+if { (ac_try="$ac_compile"
+case "(($ac_try" in
+  *\"* | *\`* | *\\*) ac_try_echo=\$ac_try;;
+  *) ac_try_echo=$ac_try;;
+esac
+eval "echo \"\$as_me:$LINENO: $ac_try_echo\"") >&5
+  (eval "$ac_compile") 2>conftest.er1
+  ac_status=$?
+  grep -v '^ *+' conftest.er1 >conftest.err
+  rm -f conftest.er1
+  cat conftest.err >&5
+  echo "$as_me:$LINENO: \$? = $ac_status" >&5
+  (exit $ac_status); } && {
+	 test -z "$ac_c_werror_flag" ||
+	 test ! -s conftest.err
+       } && test -s conftest.$ac_objext; then
+  ac_header_compiler=yes
+else
+  echo "$as_me: failed program was:" >&5
+sed 's/^/| /' conftest.$ac_ext >&5
+
+	ac_header_compiler=no
+fi
+
+rm -f core conftest.err conftest.$ac_objext conftest.$ac_ext
+{ echo "$as_me:$LINENO: result: $ac_header_compiler" >&5
+echo "${ECHO_T}$ac_header_compiler" >&6; }
+
+# Is the header present?
+{ echo "$as_me:$LINENO: checking $ac_header presence" >&5
+echo $ECHO_N "checking $ac_header presence... $ECHO_C" >&6; }
+cat >conftest.$ac_ext <<_ACEOF
+/* confdefs.h.  */
+_ACEOF
+cat confdefs.h >>conftest.$ac_ext
+cat >>conftest.$ac_ext <<_ACEOF
+/* end confdefs.h.  */
+#include <$ac_header>
+_ACEOF
+if { (ac_try="$ac_cpp conftest.$ac_ext"
+case "(($ac_try" in
+  *\"* | *\`* | *\\*) ac_try_echo=\$ac_try;;
+  *) ac_try_echo=$ac_try;;
+esac
+eval "echo \"\$as_me:$LINENO: $ac_try_echo\"") >&5
+  (eval "$ac_cpp conftest.$ac_ext") 2>conftest.er1
+  ac_status=$?
+  grep -v '^ *+' conftest.er1 >conftest.err
+  rm -f conftest.er1
+  cat conftest.err >&5
+  echo "$as_me:$LINENO: \$? = $ac_status" >&5
+  (exit $ac_status); } >/dev/null && {
+	 test -z "$ac_c_preproc_warn_flag$ac_c_werror_flag" ||
+	 test ! -s conftest.err
+       }; then
+  ac_header_preproc=yes
+else
+  echo "$as_me: failed program was:" >&5
+sed 's/^/| /' conftest.$ac_ext >&5
+
+  ac_header_preproc=no
+fi
+
+rm -f conftest.err conftest.$ac_ext
+{ echo "$as_me:$LINENO: result: $ac_header_preproc" >&5
+echo "${ECHO_T}$ac_header_preproc" >&6; }
+
+# So?  What about this header?
+case $ac_header_compiler:$ac_header_preproc:$ac_c_preproc_warn_flag in
+  yes:no: )
+    { echo "$as_me:$LINENO: WARNING: $ac_header: accepted by the compiler, rejected by the preprocessor!" >&5
+echo "$as_me: WARNING: $ac_header: accepted by the compiler, rejected by the preprocessor!" >&2;}
+    { echo "$as_me:$LINENO: WARNING: $ac_header: proceeding with the compiler's result" >&5
+echo "$as_me: WARNING: $ac_header: proceeding with the compiler's result" >&2;}
+    ac_header_preproc=yes
+    ;;
+  no:yes:* )
+    { echo "$as_me:$LINENO: WARNING: $ac_header: present but cannot be compiled" >&5
+echo "$as_me: WARNING: $ac_header: present but cannot be compiled" >&2;}
+    { echo "$as_me:$LINENO: WARNING: $ac_header:     check for missing prerequisite headers?" >&5
+echo "$as_me: WARNING: $ac_header:     check for missing prerequisite headers?" >&2;}
+    { echo "$as_me:$LINENO: WARNING: $ac_header: see the Autoconf documentation" >&5
+echo "$as_me: WARNING: $ac_header: see the Autoconf documentation" >&2;}
+    { echo "$as_me:$LINENO: WARNING: $ac_header:     section \"Present But Cannot Be Compiled\"" >&5
+echo "$as_me: WARNING: $ac_header:     section \"Present But Cannot Be Compiled\"" >&2;}
+    { echo "$as_me:$LINENO: WARNING: $ac_header: proceeding with the preprocessor's result" >&5
+echo "$as_me: WARNING: $ac_header: proceeding with the preprocessor's result" >&2;}
+    { echo "$as_me:$LINENO: WARNING: $ac_header: in the future, the compiler will take precedence" >&5
+echo "$as_me: WARNING: $ac_header: in the future, the compiler will take precedence" >&2;}
+    ( cat <<\_ASBOX
+## ---------------------------------------------------- ##
+## Report this to lcd4linux-users@lists.sourceforge.net ##
+## ---------------------------------------------------- ##
+_ASBOX
+     ) | sed "s/^/$as_me: WARNING:     /" >&2
+    ;;
+esac
+{ echo "$as_me:$LINENO: checking for $ac_header" >&5
+echo $ECHO_N "checking for $ac_header... $ECHO_C" >&6; }
+if { as_var=$as_ac_Header; eval "test \"\${$as_var+set}\" = set"; }; then
+  echo $ECHO_N "(cached) $ECHO_C" >&6
+else
+  eval "$as_ac_Header=\$ac_header_preproc"
+fi
+ac_res=`eval echo '${'$as_ac_Header'}'`
+	       { echo "$as_me:$LINENO: result: $ac_res" >&5
+echo "${ECHO_T}$ac_res" >&6; }
+
+fi
+if test `eval echo '${'$as_ac_Header'}'` = yes; then
+  cat >>confdefs.h <<_ACEOF
+#define `echo "HAVE_$ac_header" | $as_tr_cpp` 1
+_ACEOF
+ has_st2205="true"
+else
+  has_st2205="false"
+fi
+
+done
+
+
+# check for LCD-Linux
+
+
+for ac_header in linux/lcd-linux.h linux/hd44780.h
+do
+as_ac_Header=`echo "ac_cv_header_$ac_header" | $as_tr_sh`
+if { as_var=$as_ac_Header; eval "test \"\${$as_var+set}\" = set"; }; then
+  { echo "$as_me:$LINENO: checking for $ac_header" >&5
+echo $ECHO_N "checking for $ac_header... $ECHO_C" >&6; }
+if { as_var=$as_ac_Header; eval "test \"\${$as_var+set}\" = set"; }; then
+  echo $ECHO_N "(cached) $ECHO_C" >&6
+fi
+ac_res=`eval echo '${'$as_ac_Header'}'`
+	       { echo "$as_me:$LINENO: result: $ac_res" >&5
+echo "${ECHO_T}$ac_res" >&6; }
+else
+  # Is the header compilable?
+{ echo "$as_me:$LINENO: checking $ac_header usability" >&5
+echo $ECHO_N "checking $ac_header usability... $ECHO_C" >&6; }
+cat >conftest.$ac_ext <<_ACEOF
+/* confdefs.h.  */
+_ACEOF
+cat confdefs.h >>conftest.$ac_ext
+cat >>conftest.$ac_ext <<_ACEOF
+/* end confdefs.h.  */
+$ac_includes_default
+#include <$ac_header>
+_ACEOF
+rm -f conftest.$ac_objext
+if { (ac_try="$ac_compile"
+case "(($ac_try" in
+  *\"* | *\`* | *\\*) ac_try_echo=\$ac_try;;
+  *) ac_try_echo=$ac_try;;
+esac
+eval "echo \"\$as_me:$LINENO: $ac_try_echo\"") >&5
+  (eval "$ac_compile") 2>conftest.er1
+  ac_status=$?
+  grep -v '^ *+' conftest.er1 >conftest.err
+  rm -f conftest.er1
+  cat conftest.err >&5
+  echo "$as_me:$LINENO: \$? = $ac_status" >&5
+  (exit $ac_status); } && {
+	 test -z "$ac_c_werror_flag" ||
+	 test ! -s conftest.err
+       } && test -s conftest.$ac_objext; then
+  ac_header_compiler=yes
+else
+  echo "$as_me: failed program was:" >&5
+sed 's/^/| /' conftest.$ac_ext >&5
+
+	ac_header_compiler=no
+fi
+
+rm -f core conftest.err conftest.$ac_objext conftest.$ac_ext
+{ echo "$as_me:$LINENO: result: $ac_header_compiler" >&5
+echo "${ECHO_T}$ac_header_compiler" >&6; }
+
+# Is the header present?
+{ echo "$as_me:$LINENO: checking $ac_header presence" >&5
+echo $ECHO_N "checking $ac_header presence... $ECHO_C" >&6; }
+cat >conftest.$ac_ext <<_ACEOF
+/* confdefs.h.  */
+_ACEOF
+cat confdefs.h >>conftest.$ac_ext
+cat >>conftest.$ac_ext <<_ACEOF
+/* end confdefs.h.  */
+#include <$ac_header>
+_ACEOF
+if { (ac_try="$ac_cpp conftest.$ac_ext"
+case "(($ac_try" in
+  *\"* | *\`* | *\\*) ac_try_echo=\$ac_try;;
+  *) ac_try_echo=$ac_try;;
+esac
+eval "echo \"\$as_me:$LINENO: $ac_try_echo\"") >&5
+  (eval "$ac_cpp conftest.$ac_ext") 2>conftest.er1
+  ac_status=$?
+  grep -v '^ *+' conftest.er1 >conftest.err
+  rm -f conftest.er1
+  cat conftest.err >&5
+  echo "$as_me:$LINENO: \$? = $ac_status" >&5
+  (exit $ac_status); } >/dev/null && {
+	 test -z "$ac_c_preproc_warn_flag$ac_c_werror_flag" ||
+	 test ! -s conftest.err
+       }; then
+  ac_header_preproc=yes
+else
+  echo "$as_me: failed program was:" >&5
+sed 's/^/| /' conftest.$ac_ext >&5
+
+  ac_header_preproc=no
+fi
+
+rm -f conftest.err conftest.$ac_ext
+{ echo "$as_me:$LINENO: result: $ac_header_preproc" >&5
+echo "${ECHO_T}$ac_header_preproc" >&6; }
+
+# So?  What about this header?
+case $ac_header_compiler:$ac_header_preproc:$ac_c_preproc_warn_flag in
+  yes:no: )
+    { echo "$as_me:$LINENO: WARNING: $ac_header: accepted by the compiler, rejected by the preprocessor!" >&5
+echo "$as_me: WARNING: $ac_header: accepted by the compiler, rejected by the preprocessor!" >&2;}
+    { echo "$as_me:$LINENO: WARNING: $ac_header: proceeding with the compiler's result" >&5
+echo "$as_me: WARNING: $ac_header: proceeding with the compiler's result" >&2;}
+    ac_header_preproc=yes
+    ;;
+  no:yes:* )
+    { echo "$as_me:$LINENO: WARNING: $ac_header: present but cannot be compiled" >&5
+echo "$as_me: WARNING: $ac_header: present but cannot be compiled" >&2;}
+    { echo "$as_me:$LINENO: WARNING: $ac_header:     check for missing prerequisite headers?" >&5
+echo "$as_me: WARNING: $ac_header:     check for missing prerequisite headers?" >&2;}
+    { echo "$as_me:$LINENO: WARNING: $ac_header: see the Autoconf documentation" >&5
+echo "$as_me: WARNING: $ac_header: see the Autoconf documentation" >&2;}
+    { echo "$as_me:$LINENO: WARNING: $ac_header:     section \"Present But Cannot Be Compiled\"" >&5
+echo "$as_me: WARNING: $ac_header:     section \"Present But Cannot Be Compiled\"" >&2;}
+    { echo "$as_me:$LINENO: WARNING: $ac_header: proceeding with the preprocessor's result" >&5
+echo "$as_me: WARNING: $ac_header: proceeding with the preprocessor's result" >&2;}
+    { echo "$as_me:$LINENO: WARNING: $ac_header: in the future, the compiler will take precedence" >&5
+echo "$as_me: WARNING: $ac_header: in the future, the compiler will take precedence" >&2;}
+    ( cat <<\_ASBOX
+## ---------------------------------------------------- ##
+## Report this to lcd4linux-users@lists.sourceforge.net ##
+## ---------------------------------------------------- ##
+_ASBOX
+     ) | sed "s/^/$as_me: WARNING:     /" >&2
+    ;;
+esac
+{ echo "$as_me:$LINENO: checking for $ac_header" >&5
+echo $ECHO_N "checking for $ac_header... $ECHO_C" >&6; }
+if { as_var=$as_ac_Header; eval "test \"\${$as_var+set}\" = set"; }; then
+  echo $ECHO_N "(cached) $ECHO_C" >&6
+else
+  eval "$as_ac_Header=\$ac_header_preproc"
+fi
+ac_res=`eval echo '${'$as_ac_Header'}'`
+	       { echo "$as_me:$LINENO: result: $ac_res" >&5
+echo "${ECHO_T}$ac_res" >&6; }
+
+fi
+if test `eval echo '${'$as_ac_Header'}'` = yes; then
+  cat >>confdefs.h <<_ACEOF
+#define `echo "HAVE_$ac_header" | $as_tr_cpp` 1
+_ACEOF
+ has_lcd_linux="true"
+else
+  has_lcd_linux="false"; break
+fi
+
+done
+
+
+# check for ftdi.h (ULA200)
+
+for ac_header in ftdi.h
+do
+as_ac_Header=`echo "ac_cv_header_$ac_header" | $as_tr_sh`
+if { as_var=$as_ac_Header; eval "test \"\${$as_var+set}\" = set"; }; then
+  { echo "$as_me:$LINENO: checking for $ac_header" >&5
+echo $ECHO_N "checking for $ac_header... $ECHO_C" >&6; }
+if { as_var=$as_ac_Header; eval "test \"\${$as_var+set}\" = set"; }; then
+  echo $ECHO_N "(cached) $ECHO_C" >&6
+fi
+ac_res=`eval echo '${'$as_ac_Header'}'`
+	       { echo "$as_me:$LINENO: result: $ac_res" >&5
+echo "${ECHO_T}$ac_res" >&6; }
+else
+  # Is the header compilable?
+{ echo "$as_me:$LINENO: checking $ac_header usability" >&5
+echo $ECHO_N "checking $ac_header usability... $ECHO_C" >&6; }
+cat >conftest.$ac_ext <<_ACEOF
+/* confdefs.h.  */
+_ACEOF
+cat confdefs.h >>conftest.$ac_ext
+cat >>conftest.$ac_ext <<_ACEOF
+/* end confdefs.h.  */
+$ac_includes_default
+#include <$ac_header>
+_ACEOF
+rm -f conftest.$ac_objext
+if { (ac_try="$ac_compile"
+case "(($ac_try" in
+  *\"* | *\`* | *\\*) ac_try_echo=\$ac_try;;
+  *) ac_try_echo=$ac_try;;
+esac
+eval "echo \"\$as_me:$LINENO: $ac_try_echo\"") >&5
+  (eval "$ac_compile") 2>conftest.er1
+  ac_status=$?
+  grep -v '^ *+' conftest.er1 >conftest.err
+  rm -f conftest.er1
+  cat conftest.err >&5
+  echo "$as_me:$LINENO: \$? = $ac_status" >&5
+  (exit $ac_status); } && {
+	 test -z "$ac_c_werror_flag" ||
+	 test ! -s conftest.err
+       } && test -s conftest.$ac_objext; then
+  ac_header_compiler=yes
+else
+  echo "$as_me: failed program was:" >&5
+sed 's/^/| /' conftest.$ac_ext >&5
+
+	ac_header_compiler=no
+fi
+
+rm -f core conftest.err conftest.$ac_objext conftest.$ac_ext
+{ echo "$as_me:$LINENO: result: $ac_header_compiler" >&5
+echo "${ECHO_T}$ac_header_compiler" >&6; }
+
+# Is the header present?
+{ echo "$as_me:$LINENO: checking $ac_header presence" >&5
+echo $ECHO_N "checking $ac_header presence... $ECHO_C" >&6; }
+cat >conftest.$ac_ext <<_ACEOF
+/* confdefs.h.  */
+_ACEOF
+cat confdefs.h >>conftest.$ac_ext
+cat >>conftest.$ac_ext <<_ACEOF
+/* end confdefs.h.  */
+#include <$ac_header>
+_ACEOF
+if { (ac_try="$ac_cpp conftest.$ac_ext"
+case "(($ac_try" in
+  *\"* | *\`* | *\\*) ac_try_echo=\$ac_try;;
+  *) ac_try_echo=$ac_try;;
+esac
+eval "echo \"\$as_me:$LINENO: $ac_try_echo\"") >&5
+  (eval "$ac_cpp conftest.$ac_ext") 2>conftest.er1
+  ac_status=$?
+  grep -v '^ *+' conftest.er1 >conftest.err
+  rm -f conftest.er1
+  cat conftest.err >&5
+  echo "$as_me:$LINENO: \$? = $ac_status" >&5
+  (exit $ac_status); } >/dev/null && {
+	 test -z "$ac_c_preproc_warn_flag$ac_c_werror_flag" ||
+	 test ! -s conftest.err
+       }; then
+  ac_header_preproc=yes
+else
+  echo "$as_me: failed program was:" >&5
+sed 's/^/| /' conftest.$ac_ext >&5
+
+  ac_header_preproc=no
+fi
+
+rm -f conftest.err conftest.$ac_ext
+{ echo "$as_me:$LINENO: result: $ac_header_preproc" >&5
+echo "${ECHO_T}$ac_header_preproc" >&6; }
+
+# So?  What about this header?
+case $ac_header_compiler:$ac_header_preproc:$ac_c_preproc_warn_flag in
+  yes:no: )
+    { echo "$as_me:$LINENO: WARNING: $ac_header: accepted by the compiler, rejected by the preprocessor!" >&5
+echo "$as_me: WARNING: $ac_header: accepted by the compiler, rejected by the preprocessor!" >&2;}
+    { echo "$as_me:$LINENO: WARNING: $ac_header: proceeding with the compiler's result" >&5
+echo "$as_me: WARNING: $ac_header: proceeding with the compiler's result" >&2;}
+    ac_header_preproc=yes
+    ;;
+  no:yes:* )
+    { echo "$as_me:$LINENO: WARNING: $ac_header: present but cannot be compiled" >&5
+echo "$as_me: WARNING: $ac_header: present but cannot be compiled" >&2;}
+    { echo "$as_me:$LINENO: WARNING: $ac_header:     check for missing prerequisite headers?" >&5
+echo "$as_me: WARNING: $ac_header:     check for missing prerequisite headers?" >&2;}
+    { echo "$as_me:$LINENO: WARNING: $ac_header: see the Autoconf documentation" >&5
+echo "$as_me: WARNING: $ac_header: see the Autoconf documentation" >&2;}
+    { echo "$as_me:$LINENO: WARNING: $ac_header:     section \"Present But Cannot Be Compiled\"" >&5
+echo "$as_me: WARNING: $ac_header:     section \"Present But Cannot Be Compiled\"" >&2;}
+    { echo "$as_me:$LINENO: WARNING: $ac_header: proceeding with the preprocessor's result" >&5
+echo "$as_me: WARNING: $ac_header: proceeding with the preprocessor's result" >&2;}
+    { echo "$as_me:$LINENO: WARNING: $ac_header: in the future, the compiler will take precedence" >&5
+echo "$as_me: WARNING: $ac_header: in the future, the compiler will take precedence" >&2;}
+    ( cat <<\_ASBOX
+## ---------------------------------------------------- ##
+## Report this to lcd4linux-users@lists.sourceforge.net ##
+## ---------------------------------------------------- ##
+_ASBOX
+     ) | sed "s/^/$as_me: WARNING:     /" >&2
+    ;;
+esac
+{ echo "$as_me:$LINENO: checking for $ac_header" >&5
+echo $ECHO_N "checking for $ac_header... $ECHO_C" >&6; }
+if { as_var=$as_ac_Header; eval "test \"\${$as_var+set}\" = set"; }; then
+  echo $ECHO_N "(cached) $ECHO_C" >&6
+else
+  eval "$as_ac_Header=\$ac_header_preproc"
+fi
+ac_res=`eval echo '${'$as_ac_Header'}'`
+	       { echo "$as_me:$LINENO: result: $ac_res" >&5
+echo "${ECHO_T}$ac_res" >&6; }
+
+fi
+if test `eval echo '${'$as_ac_Header'}'` = yes; then
+  cat >>confdefs.h <<_ACEOF
+#define `echo "HAVE_$ac_header" | $as_tr_cpp` 1
+_ACEOF
+ has_ftdi="true"
+else
+  has_ftdi="false"; break
+fi
+
+done
+
+
+# check for python
+{ echo "$as_me:$LINENO: checking if python support is wanted" >&5
+echo $ECHO_N "checking if python support is wanted... $ECHO_C" >&6; }
+
+# Check whether --with-python was given.
+if test "${with_python+set}" = set; then
+  withval=$with_python; { echo "$as_me:$LINENO: result: $withval" >&5
+echo "${ECHO_T}$withval" >&6; }
+else
+  { echo "$as_me:$LINENO: result: no" >&5
+echo "${ECHO_T}no" >&6; }
+fi
+
+if test "$with_python" = "yes"; then
+
+
+
+
+
+
+	#
+	# Allow the use of a (user set) custom python version
+	#
+
+
+	# Extract the first word of "python[$PYTHON_VERSION]", so it can be a program name with args.
+set dummy python$PYTHON_VERSION; ac_word=$2
+{ echo "$as_me:$LINENO: checking for $ac_word" >&5
+echo $ECHO_N "checking for $ac_word... $ECHO_C" >&6; }
+if test "${ac_cv_path_PYTHON+set}" = set; then
+  echo $ECHO_N "(cached) $ECHO_C" >&6
+else
+  case $PYTHON in
+  [\\/]* | ?:[\\/]*)
+  ac_cv_path_PYTHON="$PYTHON" # Let the user override the test with a path.
+  ;;
+  *)
+  as_save_IFS=$IFS; IFS=$PATH_SEPARATOR
+for as_dir in $PATH
+do
+  IFS=$as_save_IFS
+  test -z "$as_dir" && as_dir=.
+  for ac_exec_ext in '' $ac_executable_extensions; do
+  if { test -f "$as_dir/$ac_word$ac_exec_ext" && $as_test_x "$as_dir/$ac_word$ac_exec_ext"; }; then
+    ac_cv_path_PYTHON="$as_dir/$ac_word$ac_exec_ext"
+    echo "$as_me:$LINENO: found $as_dir/$ac_word$ac_exec_ext" >&5
+    break 2
+  fi
+done
+done
+IFS=$as_save_IFS
+
+  ;;
+esac
+fi
+PYTHON=$ac_cv_path_PYTHON
+if test -n "$PYTHON"; then
+  { echo "$as_me:$LINENO: result: $PYTHON" >&5
+echo "${ECHO_T}$PYTHON" >&6; }
+else
+  { echo "$as_me:$LINENO: result: no" >&5
+echo "${ECHO_T}no" >&6; }
+fi
+
+
+	if test -z "$PYTHON"; then
+	   { { echo "$as_me:$LINENO: error: Cannot find python$PYTHON_VERSION in your system path" >&5
+echo "$as_me: error: Cannot find python$PYTHON_VERSION in your system path" >&2;}
+   { (exit 1); exit 1; }; }
+	fi
+
+	#
+	# Check for a version of Python >= 2.1.0
+	#
+	{ echo "$as_me:$LINENO: checking for a version of Python >= '2.1.0'" >&5
+echo $ECHO_N "checking for a version of Python >= '2.1.0'... $ECHO_C" >&6; }
+	ac_supports_python_ver=`$PYTHON -c "import sys, string; \
+		ver = string.split(sys.version)[0]; \
+		print ver >= '2.1.0'"`
+	if test "$ac_supports_python_ver" != "True"; then
+		if test -z "$PYTHON_NOVERSIONCHECK"; then
+			{ echo "$as_me:$LINENO: result: no" >&5
+echo "${ECHO_T}no" >&6; }
+			{ { echo "$as_me:$LINENO: error:
+This version of the AC_PYTHON_DEVEL macro
+doesn't work properly with versions of Python before
+2.1.0. You may need to re-run configure, setting the
+variables PYTHON_CPPFLAGS, PYTHON_LDFLAGS, PYTHON_SITE_PKG,
+PYTHON_EXTRA_LIBS and PYTHON_EXTRA_LDFLAGS by hand.
+Moreover, to disable this check, set PYTHON_NOVERSIONCHECK
+to something else than an empty string.
+
+See \`config.log' for more details." >&5
+echo "$as_me: error:
+This version of the AC_PYTHON_DEVEL macro
+doesn't work properly with versions of Python before
+2.1.0. You may need to re-run configure, setting the
+variables PYTHON_CPPFLAGS, PYTHON_LDFLAGS, PYTHON_SITE_PKG,
+PYTHON_EXTRA_LIBS and PYTHON_EXTRA_LDFLAGS by hand.
+Moreover, to disable this check, set PYTHON_NOVERSIONCHECK
+to something else than an empty string.
+
+See \`config.log' for more details." >&2;}
+   { (exit 1); exit 1; }; }		else
+			{ echo "$as_me:$LINENO: result: skip at user request" >&5
+echo "${ECHO_T}skip at user request" >&6; }
+		fi
+	else
+		{ echo "$as_me:$LINENO: result: yes" >&5
+echo "${ECHO_T}yes" >&6; }
+	fi
+
+	#
+	# if the macro parameter ``version'' is set, honour it
+	#
+	if test -n ""; then
+		{ echo "$as_me:$LINENO: checking for a version of Python " >&5
+echo $ECHO_N "checking for a version of Python ... $ECHO_C" >&6; }
+		ac_supports_python_ver=`$PYTHON -c "import sys, string; \
+			ver = string.split(sys.version)[0]; \
+			print ver "`
+		if test "$ac_supports_python_ver" = "True"; then
+	   	   { echo "$as_me:$LINENO: result: yes" >&5
+echo "${ECHO_T}yes" >&6; }
+		else
+			{ echo "$as_me:$LINENO: result: no" >&5
+echo "${ECHO_T}no" >&6; }
+			{ { echo "$as_me:$LINENO: error: this package requires Python .
+If you have it installed, but it isn't the default Python
+interpreter in your system path, please pass the PYTHON_VERSION
+variable to configure. See \`\`configure --help'' for reference.
+" >&5
+echo "$as_me: error: this package requires Python .
+If you have it installed, but it isn't the default Python
+interpreter in your system path, please pass the PYTHON_VERSION
+variable to configure. See \`\`configure --help'' for reference.
+" >&2;}
+   { (exit 1); exit 1; }; }		fi
+	fi
+
+	#
+	# Check if you have distutils, else fail
+	#
+	{ echo "$as_me:$LINENO: checking for the distutils Python package" >&5
+echo $ECHO_N "checking for the distutils Python package... $ECHO_C" >&6; }
+	ac_distutils_result=`$PYTHON -c "import distutils" 2>&1`
+	if test -z "$ac_distutils_result"; then
+		{ echo "$as_me:$LINENO: result: yes" >&5
+echo "${ECHO_T}yes" >&6; }
+	else
+		{ echo "$as_me:$LINENO: result: no" >&5
+echo "${ECHO_T}no" >&6; }
+		{ { echo "$as_me:$LINENO: error: cannot import Python module \"distutils\".
+Please check your Python installation. The error was:
+$ac_distutils_result" >&5
+echo "$as_me: error: cannot import Python module \"distutils\".
+Please check your Python installation. The error was:
+$ac_distutils_result" >&2;}
+   { (exit 1); exit 1; }; }
+	fi
+
+	#
+	# Check for Python include path
+	#
+	{ echo "$as_me:$LINENO: checking for Python include path" >&5
+echo $ECHO_N "checking for Python include path... $ECHO_C" >&6; }
+	if test -z "$PYTHON_CPPFLAGS"; then
+		python_path=`$PYTHON -c "import distutils.sysconfig; \
+           		print distutils.sysconfig.get_python_inc();"`
+		if test -n "${python_path}"; then
+		   	python_path="-I$python_path"
+		fi
+		PYTHON_CPPFLAGS=$python_path
+	fi
+	{ echo "$as_me:$LINENO: result: $PYTHON_CPPFLAGS" >&5
+echo "${ECHO_T}$PYTHON_CPPFLAGS" >&6; }
+
+
+	#
+	# Check for Python library path
+	#
+	{ echo "$as_me:$LINENO: checking for Python library path" >&5
+echo $ECHO_N "checking for Python library path... $ECHO_C" >&6; }
+	if test -z "$PYTHON_LDFLAGS"; then
+		# (makes two attempts to ensure we've got a version number
+		# from the interpreter)
+		py_version=`$PYTHON -c "from distutils.sysconfig import *; \
+			from string import join; \
+			print join(get_config_vars('VERSION'))"`
+		if test "$py_version" == "None"; then
+			if test -n "$PYTHON_VERSION"; then
+				py_version=$PYTHON_VERSION
+			else
+				py_version=`$PYTHON -c "import sys; \
+					print sys.version[:3]"`
+			fi
+		fi
+
+		PYTHON_LDFLAGS=`$PYTHON -c "from distutils.sysconfig import *; \
+			from string import join; \
+			print '-L' + get_python_lib(0,1), \
+		      	'-lpython';"`$py_version
+	fi
+	{ echo "$as_me:$LINENO: result: $PYTHON_LDFLAGS" >&5
+echo "${ECHO_T}$PYTHON_LDFLAGS" >&6; }
+
+
+	#
+	# Check for site packages
+	#
+	{ echo "$as_me:$LINENO: checking for Python site-packages path" >&5
+echo $ECHO_N "checking for Python site-packages path... $ECHO_C" >&6; }
+	if test -z "$PYTHON_SITE_PKG"; then
+		PYTHON_SITE_PKG=`$PYTHON -c "import distutils.sysconfig; \
+		        print distutils.sysconfig.get_python_lib(0,0);"`
+	fi
+	{ echo "$as_me:$LINENO: result: $PYTHON_SITE_PKG" >&5
+echo "${ECHO_T}$PYTHON_SITE_PKG" >&6; }
+
+
+	#
+	# libraries which must be linked in when embedding
+	#
+	{ echo "$as_me:$LINENO: checking python extra libraries" >&5
+echo $ECHO_N "checking python extra libraries... $ECHO_C" >&6; }
+	if test -z "$PYTHON_EXTRA_LIBS"; then
+	   PYTHON_EXTRA_LIBS=`$PYTHON -c "import distutils.sysconfig; \
+                conf = distutils.sysconfig.get_config_var; \
+                print conf('LOCALMODLIBS'), conf('LIBS')"`
+	fi
+	{ echo "$as_me:$LINENO: result: $PYTHON_EXTRA_LIBS" >&5
+echo "${ECHO_T}$PYTHON_EXTRA_LIBS" >&6; }
+
+
+	#
+	# linking flags needed when embedding
+	#
+	{ echo "$as_me:$LINENO: checking python extra linking flags" >&5
+echo $ECHO_N "checking python extra linking flags... $ECHO_C" >&6; }
+	if test -z "$PYTHON_EXTRA_LDFLAGS"; then
+		PYTHON_EXTRA_LDFLAGS=`$PYTHON -c "import distutils.sysconfig; \
+			conf = distutils.sysconfig.get_config_var; \
+			print conf('LINKFORSHARED')"`
+	fi
+	{ echo "$as_me:$LINENO: result: $PYTHON_EXTRA_LDFLAGS" >&5
+echo "${ECHO_T}$PYTHON_EXTRA_LDFLAGS" >&6; }
+
+
+fi
+
+# drivers
+
+
+
+{ echo "$as_me:$LINENO: checking which drivers to compile" >&5
+echo $ECHO_N "checking which drivers to compile... $ECHO_C" >&6; }
+
+# Check whether --with-drivers was given.
+if test "${with_drivers+set}" = set; then
+  withval=$with_drivers; drivers=$withval
+else
+  drivers=all
+
+fi
+
+
+drivers=`echo $drivers|sed 's/,/ /g'`
+
+for driver in $drivers; do
+
+   case $driver in
+      !*)
+         val="no"
+         driver=`echo $driver|cut -c 2-`
+         ;;
+       *)
+         val="yes"
+         ;;
+   esac
+
+   case "$driver" in
+      all)
+         BECKMANNEGLE="yes"
+         BWCT="yes"
+         CRYSTALFONTZ="yes"
+         CURSES="yes"
+         CWLINUX="yes"
+         D4D="yes"
+         EA232graphic="yes"
+         G15="yes"
+         HD44780="yes"
+	 IRLCD="yes"
+         LCD2USB="yes"
+	 LCDLINUX="yes"
+         LCDTERM="yes"
+         LEDMATRIX="yes"
+	 LPH7508="yes"
+         LUISE="yes"
+         M50530="yes"
+         MATRIXORBITAL="yes"
+         MILINST="yes"
+         NORITAKE="yes"
+         NULL="yes"
+         PERTELIAN="yes"
+         PHANDERSON="yes"
+         PICOLCD="yes"
+	 PICOLCDGRAPHIC="yes"
+         PNG="yes"
+         PPM="yes"
+         ROUTERBOARD="yes"
+         SAMPLE="yes"
+         ST2205="yes"
+	 SERDISPLIB="yes"
+         SIMPLELCD="yes"
+         T6963="yes"
+         Trefon="yes"
+         ULA200="yes"
+	 USBHUB="yes"
+         USBLCD="yes"
+	 WINCORNIXDORF="yes"
+         X11="yes"
+         ;;
+      BeckmannEgle)
+         BECKMANNEGLE=$val
+         ;;
+      BWCT)
+         BWCT=$val
+         ;;
+      CrystalFontz)
+         CRYSTALFONTZ=$val
+         ;;
+      Curses)
+         CURSES=$val
+         ;;
+      Cwlinux)
+         CWLINUX=$val
+         ;;
+      D4D)
+         D4D=$val
+         ;;
+      EA232graphic)
+         EA232graphic=$val
+         ;;
+      G15)
+         G15=$val
+         ;;
+      HD44780)
+         HD44780=$val
+	 ;;
+      HD44780-I2C)
+         HD44780_I2C=$val
+	 ;;
+      IRLCD)
+         IRLCD=$val
+         ;;
+      LCD2USB)
+         LCD2USB=$val
+         ;;
+      LCDLinux)
+         LCDLINUX=$val
+	 ;;
+      LCDTerm)
+         LCDTERM=$val
+	 ;;
+      LEDMatrix)
+         LEDMATRIX=$val
+	 ;;
+      LPH7508)
+         LPH7508=$val
+         ;;
+      LUIse)
+         LUISE=$val
+         ;;
+      M50530)
+         M50530=$val
+         ;;
+      MatrixOrbital)
+         MATRIXORBITAL=$val
+         ;;
+      MilfordInstruments)
+         MILINST=$val
+         ;;
+      Noritake)
+         NORITAKE=$val;
+         ;;
+      NULL)
+         NULL=$val;
+         ;;
+      Pertelian)
+         PERTELIAN=$val
+         ;;
+      PHAnderson)
+         PHANDERSON=$val
+         ;;
+      picoLCD)
+         PICOLCD=$val
+         ;;
+      picoLCDGraphic)
+         PICOLCDGRAPHIC=$val
+         ;;
+
+      PNG)
+         PNG=$val
+         ;;
+      PPM)
+         PPM=$val
+         ;;
+      RouterBoard)
+         ROUTERBOARD=$val
+         ;;
+      Sample)
+         SAMPLE=$val
+         ;;
+      serdisplib)
+         SERDISPLIB=$val;
+         ;;
+      SimpleLCD)
+         SIMPLELCD=$val
+         ;;
+      st2205)
+         ST2205=$val
+         ;;
+      T6963)
+         T6963=$val
+         ;;
+      Trefon)
+         Trefon=$val
+         ;;
+      ULA200)
+         ULA200=$val
+         ;;
+      USBHUB)
+         USBHUB=$val
+         ;;
+      USBLCD)
+         USBLCD=$val
+         ;;
+      WincorNixdorf)
+         WINCORNIXDORF=$val
+         ;;
+      X11)
+         X11=$val
+         ;;
+      *)
+         { { echo "$as_me:$LINENO: error: Unknown driver '$driver'" >&5
+echo "$as_me: error: Unknown driver '$driver'" >&2;}
+   { (exit 1); exit 1; }; }
+         ;;
+   esac
+done
+
+{ echo "$as_me:$LINENO: result: done" >&5
+echo "${ECHO_T}done" >&6; }
+
+
+# generic display drivers
+TEXT="no"
+GRAPHIC="no"
+IMAGE="no"
+GPIO="no"
+
+# generiv I/O drivers
+PARPORT="no"
+SERIAL="no"
+I2C="no"
+KEYPAD="no"
+
+# generic libraries
+LIBUSB="no"
+LIBFTDI="no"
+
+if test "$BECKMANNEGLE" = "yes"; then
+   TEXT="yes"
+   GPIO="yes"
+   SERIAL="yes"
+   DRIVERS="$DRIVERS drv_BeckmannEgle.o"
+
+cat >>confdefs.h <<\_ACEOF
+#define WITH_BECKMANNEGLE 1
+_ACEOF
+
+fi
+
+if test "$BWCT" = "yes"; then
+   if test "$has_usb" = "true"; then
+      TEXT="yes"
+      DRIVERS="$DRIVERS drv_BWCT.o"
+      LIBUSB="yes"
+
+cat >>confdefs.h <<\_ACEOF
+#define WITH_BWCT 1
+_ACEOF
+
+   else
+      { echo "$as_me:$LINENO: WARNING: usb.h not found: BWCT driver disabled" >&5
+echo "$as_me: WARNING: usb.h not found: BWCT driver disabled" >&2;}
+   fi
+fi
+
+if test "$CRYSTALFONTZ" = "yes"; then
+   TEXT="yes"
+   GPIO="yes"
+   SERIAL="yes"
+   KEYPAD="yes"
+   DRIVERS="$DRIVERS drv_Crystalfontz.o"
+
+cat >>confdefs.h <<\_ACEOF
+#define WITH_CRYSTALFONTZ 1
+_ACEOF
+
+fi
+
+if test "$CURSES" = "yes"; then
+   if test "$has_curses" = true; then
+      TEXT="yes"
+      KEYPAD="yes"
+      DRIVERS="$DRIVERS drv_Curses.o"
+      DRVLIBS="$DRVLIBS $CURSES_LIBS"
+      CPPFLAGS="$CPPFLAGS $CURSES_INCLUDES"
+
+cat >>confdefs.h <<\_ACEOF
+#define WITH_CURSES 1
+_ACEOF
+
+   else
+      { echo "$as_me:$LINENO: WARNING: curses not found: Curses driver disabled" >&5
+echo "$as_me: WARNING: curses not found: Curses driver disabled" >&2;}
+   fi
+fi
+
+if test "$CWLINUX" = "yes"; then
+   TEXT="yes"
+   GPIO="yes"
+   SERIAL="yes"
+   KEYPAD="yes"
+   DRIVERS="$DRIVERS drv_Cwlinux.o"
+
+cat >>confdefs.h <<\_ACEOF
+#define WITH_CWLINUX 1
+_ACEOF
+
+fi
+
+if test "$D4D" = "yes"; then
+   TEXT="yes"
+   GRAPHIC="yes"
+   SERIAL="yes"
+   DRIVERS="$DRIVERS drv_D4D.o"
+
+cat >>confdefs.h <<\_ACEOF
+#define WITH_D4D 1
+_ACEOF
+
+fi
+
+if test "$EA232graphic" = "yes"; then
+   GRAPHIC="yes"
+   SERIAL="yes"
+   GPIO="yes"
+   DRIVERS="$DRIVERS drv_EA232graphic.o"
+
+cat >>confdefs.h <<\_ACEOF
+#define WITH_EA232graphic 1
+_ACEOF
+
+fi
+
+if test "$G15" = "yes"; then
+   if test "$has_usb" = "true"; then
+      GRAPHIC="yes"
+      LIBUSB="yes"
+      DRIVERS="$DRIVERS drv_G15.o"
+
+cat >>confdefs.h <<\_ACEOF
+#define WITH_G15 1
+_ACEOF
+
+   else
+      { echo "$as_me:$LINENO: WARNING: usb.h not found: G15 driver disabled" >&5
+echo "$as_me: WARNING: usb.h not found: G15 driver disabled" >&2;}
+   fi
+fi
+
+if test "$HD44780" = "yes"; then
+   TEXT="yes"
+   PARPORT="yes"
+   I2C="yes"
+   GPIO="yes"
+   KEYPAD="yes"
+   DRIVERS="$DRIVERS drv_HD44780.o"
+
+cat >>confdefs.h <<\_ACEOF
+#define WITH_HD44780 1
+_ACEOF
+
+fi
+
+if test "$HD44780_I2C" = "yes"; then
+   TEXT="yes"
+   I2C="yes"
+   GPIO="yes"
+   DRIVERS="$DRIVERS drv_HD44780.o"
+
+cat >>confdefs.h <<\_ACEOF
+#define WITH_HD44780 1
+_ACEOF
+
+fi
+
+if test "$IRLCD" = "yes"; then
+   if test "$has_usb" = "true"; then
+      TEXT="yes"
+      SERIAL="yes"
+      DRIVERS="$DRIVERS drv_IRLCD.o"
+      LIBUSB="yes"
+
+cat >>confdefs.h <<\_ACEOF
+#define WITH_IRLCD 1
+_ACEOF
+
+   else
+      { echo "$as_me:$LINENO: WARNING: usb.h not found: IRLCD driver disabled" >&5
+echo "$as_me: WARNING: usb.h not found: IRLCD driver disabled" >&2;}
+   fi
+fi
+
+if test "$LCD2USB" = "yes"; then
+   if test "$has_usb" = "true"; then
+      TEXT="yes"
+      SERIAL="yes"
+      KEYPAD="yes"
+      DRIVERS="$DRIVERS drv_LCD2USB.o"
+      LIBUSB="yes"
+
+cat >>confdefs.h <<\_ACEOF
+#define WITH_LCD2USB 1
+_ACEOF
+
+   else
+      { echo "$as_me:$LINENO: WARNING: usb.h not found: LCD2USB driver disabled" >&5
+echo "$as_me: WARNING: usb.h not found: LCD2USB driver disabled" >&2;}
+   fi
+fi
+
+if test "$LCDLINUX" = "yes"; then
+   if test "$has_lcd_linux" = true; then
+      TEXT="yes"
+      DRIVERS="$DRIVERS drv_LCDLinux.o"
+
+cat >>confdefs.h <<\_ACEOF
+#define WITH_LCDLINUX 1
+_ACEOF
+
+   else
+      { echo "$as_me:$LINENO: WARNING: linux/lcd-linux.h or linux/hd44780.h not found: LCD-Linux driver disabled" >&5
+echo "$as_me: WARNING: linux/lcd-linux.h or linux/hd44780.h not found: LCD-Linux driver disabled" >&2;}
+   fi
+fi
+
+if test "$LCDTERM" = "yes"; then
+   TEXT="yes"
+   SERIAL="yes"
+   DRIVERS="$DRIVERS drv_LCDTerm.o"
+
+cat >>confdefs.h <<\_ACEOF
+#define WITH_LCDTERM 1
+_ACEOF
+
+fi
+
+if test "$LEDMATRIX" = "yes"; then
+   GRAPHIC="yes"
+   DRIVERS="$DRIVERS drv_LEDMatrix.o"
+
+cat >>confdefs.h <<\_ACEOF
+#define WITH_LEDMATRIX 1
+_ACEOF
+
+fi
+
+if test "$LPH7508" = "yes"; then
+   GRAPHIC="yes"
+   GPIO="yes"
+   PARPORT="yes"
+   DRIVERS="$DRIVERS drv_LPH7508.o"
+
+cat >>confdefs.h <<\_ACEOF
+#define WITH_LPH7508 1
+_ACEOF
+
+fi
+
+if test "$LUISE" = "yes"; then
+   if test "$has_luise" = "true"; then
+      GRAPHIC="yes"
+      DRIVERS="$DRIVERS drv_LUIse.o"
+      DRVLIBS="$DRVLIBS -L/usr/local/lib -lluise"
+
+cat >>confdefs.h <<\_ACEOF
+#define WITH_LUISE 1
+_ACEOF
+
+   else
+      { echo "$as_me:$LINENO: WARNING: luise.h not found: LUIse driver disabled" >&5
+echo "$as_me: WARNING: luise.h not found: LUIse driver disabled" >&2;}
+   fi
+fi
+
+if test "$M50530" = "yes"; then
+   TEXT="yes"
+   GPIO="yes"
+   PARPORT="yes"
+   DRIVERS="$DRIVERS drv_M50530.o"
+
+cat >>confdefs.h <<\_ACEOF
+#define WITH_M50530 1
+_ACEOF
+
+fi
+
+if test "$MATRIXORBITAL" = "yes"; then
+   TEXT="yes"
+   GPIO="yes"
+   SERIAL="yes"
+   DRIVERS="$DRIVERS drv_MatrixOrbital.o"
+
+cat >>confdefs.h <<\_ACEOF
+#define WITH_MATRIXORBITAL 1
+_ACEOF
+
+fi
+
+if test "$MILINST" = "yes"; then
+   TEXT="yes"
+   SERIAL="yes"
+   DRIVERS="$DRIVERS drv_MilfordInstruments.o"
+
+cat >>confdefs.h <<\_ACEOF
+#define WITH_MILINST 1
+_ACEOF
+
+fi
+
+if test "$NORITAKE" = "yes"; then
+   TEXT="yes"
+   GRAPHIC="yes"
+   PARPORT="yes"
+   DRIVERS="$DRIVERS drv_Noritake.o"
+
+cat >>confdefs.h <<\_ACEOF
+#define WITH_NORITAKE 1
+_ACEOF
+
+fi
+
+if test "$NULL" = "yes"; then
+   TEXT="yes"
+   DRIVERS="$DRIVERS drv_NULL.o"
+
+cat >>confdefs.h <<\_ACEOF
+#define WITH_NULL 1
+_ACEOF
+
+fi
+
+if test "$PERTELIAN" = "yes"; then
+   # select either text or graphics mode
+   TEXT="yes"
+   # select bus: serial (including USB), parallel or i2c
+   SERIAL="yes"
+   DRIVERS="$DRIVERS drv_Pertelian.o"
+
+cat >>confdefs.h <<\_ACEOF
+#define WITH_PERTELIAN 1
+_ACEOF
+
+fi
+
+if test "$PHANDERSON" = "yes"; then
+   TEXT="yes"
+   SERIAL="yes"
+   DRIVERS="$DRIVERS drv_PHAnderson.o"
+
+cat >>confdefs.h <<\_ACEOF
+#define WITH_PHANDERSON 1
+_ACEOF
+
+fi
+
+if test "$PICOLCD" = "yes"; then
+   if test "$has_usb" = "true"; then
+      TEXT="yes"
+      GPIO="yes"
+      SERIAL="yes"
+      LIBUSB="yes"
+      DRIVERS="$DRIVERS drv_picoLCD.o"
+
+cat >>confdefs.h <<\_ACEOF
+#define WITH_PICOLCD 1
+_ACEOF
+
+   else
+      { echo "$as_me:$LINENO: WARNING: usb.h not found: picoLCD driver disabled" >&5
+echo "$as_me: WARNING: usb.h not found: picoLCD driver disabled" >&2;}
+   fi
+fi
+
+if test "$PICOLCDGRAPHIC" = "yes"; then
+   if test "$has_usb" = "true"; then
+      TEXT="yes"
+      GRAPHIC="yes"
+      GPIO="yes"
+      SERIAL="yes"
+      LIBUSB="yes"
+      DRIVERS="$DRIVERS drv_picoLCDGraphic.o"
+
+cat >>confdefs.h <<\_ACEOF
+#define WITH_PICOLCDGRAPHIC 1
+_ACEOF
+
+   else
+      { echo "$as_me:$LINENO: WARNING: usb.h not found: picoLCDGraphic driver disabled" >&5
+echo "$as_me: WARNING: usb.h not found: picoLCDGraphic driver disabled" >&2;}
+   fi
+fi
+
+if test "$PNG" = "yes"; then
+   if test "$has_gd" = "true"; then
+      IMAGE="yes"
+
+cat >>confdefs.h <<\_ACEOF
+#define WITH_PNG 1
+_ACEOF
+
+   else
+      { echo "$as_me:$LINENO: WARNING: gd.h not found: PNG driver disabled" >&5
+echo "$as_me: WARNING: gd.h not found: PNG driver disabled" >&2;}
+   fi
+fi
+
+if test "$PPM" = "yes"; then
+   IMAGE="yes"
+
+cat >>confdefs.h <<\_ACEOF
+#define WITH_PPM 1
+_ACEOF
+
+fi
+
+if test "$ROUTERBOARD" = "yes"; then
+   if test "$has_io_h" = "true"; then
+      TEXT="yes"
+      GPIO="yes"
+      DRIVERS="$DRIVERS drv_RouterBoard.o"
+
+cat >>confdefs.h <<\_ACEOF
+#define WITH_ROUTERBOARD 1
+_ACEOF
+
+   else
+      { echo "$as_me:$LINENO: WARNING: sys/io.h not found: RouterBoard driver disabled" >&5
+echo "$as_me: WARNING: sys/io.h not found: RouterBoard driver disabled" >&2;}
+   fi
+fi
+
+if test "$SAMPLE" = "yes"; then
+   # select either text or graphics mode
+   TEXT="yes"
+   GRAPHIC="yes"
+   # support for GPIO's
+   GPIO="yes"
+   # select bus: serial (including USB), parallel or i2c
+   SERIAL="yes"
+   PARPORT="yes"
+   #I2C="yes"
+   DRIVERS="$DRIVERS drv_Sample.o"
+
+cat >>confdefs.h <<\_ACEOF
+#define WITH_SAMPLE 1
+_ACEOF
+
+fi
+
+if test "$SERDISPLIB" = "yes"; then
+   if test "$has_serdisplib" = "true"; then
+      GRAPHIC="yes"
+      DRIVERS="$DRIVERS drv_serdisplib.o"
+      DRVLIBS="$DRVLIBS -L/usr/local/lib -lserdisp"
+
+cat >>confdefs.h <<\_ACEOF
+#define WITH_SERDISPLIB 1
+_ACEOF
+
+      if test "$has_usb" = "true"; then
+         LIBUSB="yes"
+      fi
+   else
+      { echo "$as_me:$LINENO: WARNING: serdisp.h not found: serdisplib driver disabled" >&5
+echo "$as_me: WARNING: serdisp.h not found: serdisplib driver disabled" >&2;}
+   fi
+fi
+
+if test "$SIMPLELCD" = "yes"; then
+   TEXT="yes"
+   SERIAL="yes"
+   DRIVERS="$DRIVERS drv_SimpleLCD.o"
+
+cat >>confdefs.h <<\_ACEOF
+#define WITH_SIMPLELCD 1
+_ACEOF
+
+fi
+
+if test "$ST2205" = "yes"; then
+   if test "$has_st2205" = "true"; then
+      GRAPHIC="yes"
+      DRIVERS="$DRIVERS drv_st2205.o"
+      DRVLIBS="$DRVLIBS -L/usr/local/lib -lst2205"
+
+cat >>confdefs.h <<\_ACEOF
+#define WITH_ST2205 1
+_ACEOF
+
+   else
+      { echo "$as_me:$LINENO: WARNING: st2205.h not found: st2205 driver disabled" >&5
+echo "$as_me: WARNING: st2205.h not found: st2205 driver disabled" >&2;}
+   fi
+fi
+
+if test "$T6963" = "yes"; then
+   GRAPHIC="yes"
+   PARPORT="yes"
+   DRIVERS="$DRIVERS drv_T6963.o"
+
+cat >>confdefs.h <<\_ACEOF
+#define WITH_T6963 1
+_ACEOF
+
+fi
+
+if test "$Trefon" = "yes"; then
+   if test "$has_usb" = "true"; then
+      TEXT="yes"
+      DRIVERS="$DRIVERS drv_Trefon.o"
+      LIBUSB="yes"
+
+cat >>confdefs.h <<\_ACEOF
+#define WITH_TREFON 1
+_ACEOF
+
+   else
+      { echo "$as_me:$LINENO: WARNING: usb.h not found: Trefon driver disabled" >&5
+echo "$as_me: WARNING: usb.h not found: Trefon driver disabled" >&2;}
+   fi
+fi
+
+if test "$ULA200" = "yes"; then
+   if test "$has_ftdi" = "true"; then
+      TEXT="yes"
+      LIBUSB="yes"
+      LIBFTDI="yes"
+      DRIVERS="$DRIVERS drv_ula200.o"
+
+cat >>confdefs.h <<\_ACEOF
+#define WITH_ULA200 1
+_ACEOF
+
+   else
+      { echo "$as_me:$LINENO: WARNING: ftdi.h not found: ULA200 driver disabled" >&5
+echo "$as_me: WARNING: ftdi.h not found: ULA200 driver disabled" >&2;}
+   fi
+fi
+
+if test "$USBHUB" = "yes"; then
+   if test "$has_usb" = "true"; then
+      GPIO="yes"
+      DRIVERS="$DRIVERS drv_USBHUB.o"
+      LIBUSB="yes"
+
+cat >>confdefs.h <<\_ACEOF
+#define WITH_USBHUB 1
+_ACEOF
+
+   else
+      { echo "$as_me:$LINENO: WARNING: usb.h not found: USB-Hub driver disabled" >&5
+echo "$as_me: WARNING: usb.h not found: USB-Hub driver disabled" >&2;}
+   fi
+fi
+
+if test "$USBLCD" = "yes"; then
+   TEXT="yes"
+   SERIAL="yes"
+   DRIVERS="$DRIVERS drv_USBLCD.o"
+   if test "$has_usb" = "true"; then
+      LIBUSB="yes"
+   fi
+
+cat >>confdefs.h <<\_ACEOF
+#define WITH_USBLCD 1
+_ACEOF
+
+fi
+
+if test "$WINCORNIXDORF" = "yes"; then
+   TEXT="yes"
+   SERIAL="yes"
+   DRIVERS="$DRIVERS drv_WincorNixdorf.o"
+
+cat >>confdefs.h <<\_ACEOF
+#define WITH_WINCORNIXDORF 1
+_ACEOF
+
+fi
+
+if test "$X11" = "yes"; then
+   if test "$no_x" = "yes"; then
+      { echo "$as_me:$LINENO: WARNING: X11 headers or libraries not available: X11 driver disabled" >&5
+echo "$as_me: WARNING: X11 headers or libraries not available: X11 driver disabled" >&2;}
+   else
+      GRAPHIC="yes"
+      KEYPAD="yes"
+      DRIVERS="$DRIVERS drv_X11.o"
+      if test "x$ac_x_libraries" = "x"; then
+	DRVLIBS="$DRVLIBS -lX11"
+      else
+        DRVLIBS="$DRVLIBS -L$ac_x_libraries -lX11"
+      fi
+      CPP_FLAGS="$CPPFLAGS $X_CFLAGS"
+
+cat >>confdefs.h <<\_ACEOF
+#define WITH_X11 1
+_ACEOF
+
+   fi
+fi
+
+
+# Image driver
+if test "$IMAGE" = "yes"; then
+   GRAPHIC="yes"
+   DRIVERS="$DRIVERS drv_Image.o"
+fi
+
+if test "$DRIVERS" = ""; then
+   { { echo "$as_me:$LINENO: error: You should activate at least one driver..." >&5
+echo "$as_me: error: You should activate at least one driver..." >&2;}
+   { (exit 1); exit 1; }; }
+fi
+
+# generic text driver
+if test "$TEXT" = "yes"; then
+   DRIVERS="$DRIVERS drv_generic_text.o"
+fi
+
+# generic graphic driver
+if test "$GRAPHIC" = "yes"; then
+   DRIVERS="$DRIVERS drv_generic_graphic.o"
+   if test "$has_gd" = "true"; then
+      DRIVERS="$DRIVERS widget_image.o"
+      DRVLIBS="$DRVLIBS -lgd"
+
+cat >>confdefs.h <<\_ACEOF
+#define WITH_GD 1
+_ACEOF
+
+
+cat >>confdefs.h <<\_ACEOF
+#define WITH_IMAGE 1
+_ACEOF
+
+   fi
+fi
+
+# generic GPIO driver
+if test "$GPIO" = "yes"; then
+   DRIVERS="$DRIVERS drv_generic_gpio.o"
+fi
+
+# generic parport driver
+if test "$PARPORT" = "yes"; then
+   DRIVERS="$DRIVERS drv_generic_parport.o"
+
+cat >>confdefs.h <<\_ACEOF
+#define WITH_PARPORT 1
+_ACEOF
+
+fi
+
+# generic serial driver
+if test "$SERIAL" = "yes"; then
+   DRIVERS="$DRIVERS drv_generic_serial.o"
+
+cat >>confdefs.h <<\_ACEOF
+#define WITH_SERIAL 1
+_ACEOF
+
+fi
+
+# generic i2c driver
+if test "$I2C" = "yes"; then
+   DRIVERS="$DRIVERS drv_generic_i2c.o"
+
+cat >>confdefs.h <<\_ACEOF
+#define WITH_I2C 1
+_ACEOF
+
+fi
+
+# generic keypad driver
+if test "$KEYPAD" = "yes"; then
+   DRIVERS="$DRIVERS drv_generic_keypad.o"
+fi
+
+# libusb
+if test "$LIBUSB" = "yes"; then
+   DRVLIBS="$DRVLIBS -lusb"
+fi
+
+# libftdi
+if test "$LIBFTDI" = "yes"; then
+   DRVLIBS="$DRVLIBS -lftdi"
+fi
+
+if test "$DRIVERS" = ""; then
+   { { echo "$as_me:$LINENO: error: You should include at least one driver..." >&5
+echo "$as_me: error: You should include at least one driver..." >&2;}
+   { (exit 1); exit 1; }; }
+fi
+
+
+
+
+
+# plugins
+
+
+
+{ echo "$as_me:$LINENO: checking which plugins to compile" >&5
+echo $ECHO_N "checking which plugins to compile... $ECHO_C" >&6; }
+
+# Check whether --with-plugins was given.
+if test "${with_plugins+set}" = set; then
+  withval=$with_plugins; plugins=$withval
+else
+  plugins=all
+
+fi
+
+
+plugins=`echo $plugins|sed 's/,/ /g'`
+
+for plugin in $plugins; do
+
+   case $plugin in
+      !*)
+         val="no"
+         plugin=`echo $plugin|cut -c 2-`
+         ;;
+       *)
+         val="yes"
+         ;;
+   esac
+
+   case "$plugin" in
+      list)
+         { echo "$as_me:$LINENO: result: available plugins:
+             apm,cpuinfo,diskstats,dvb,exec,file,gps,i2c_sensors,iconv,imon,isdn,kvv,
+             loadavg,meminfo,mpd,mysql,netdev,netinfo,pop3,ppp,proc_stat,sample,seti,
+             statfs,uname,uptime,wireless,xmms" >&5
+echo "${ECHO_T}available plugins:
+             apm,cpuinfo,diskstats,dvb,exec,file,gps,i2c_sensors,iconv,imon,isdn,kvv,
+             loadavg,meminfo,mpd,mysql,netdev,netinfo,pop3,ppp,proc_stat,sample,seti,
+             statfs,uname,uptime,wireless,xmms" >&6; }
+         { { echo "$as_me:$LINENO: error: run ./configure --with-plugins=..." >&5
+echo "$as_me: error: run ./configure --with-plugins=..." >&2;}
+   { (exit 1); exit 1; }; }
+         ;;
+      all)
+         PLUGIN_APM="yes"
+	 PLUGIN_ASTERISK="yes"
+	 PLUGIN_BUTTON_EXEC="yes"
+         PLUGIN_CPUINFO="yes"
+         PLUGIN_DISKSTATS="yes"
+         PLUGIN_DVB="yes"
+         PLUGIN_EXEC="yes"
+         PLUGIN_FIFO="yes"
+         PLUGIN_FILE="yes"
+         PLUGIN_GPS="yes"
+         PLUGIN_HDDTEMP="yes"
+         PLUGIN_I2C_SENSORS="yes"
+         PLUGIN_ICONV="yes"
+         PLUGIN_IMON="yes"
+         PLUGIN_ISDN="yes"
+         PLUGIN_KVV="yes"
+         PLUGIN_LOADAVG="yes"
+         PLUGIN_MEMINFO="yes"
+         PLUGIN_MPD="yes"
+         PLUGIN_MYSQL="yes"
+         PLUGIN_NETDEV="yes"
+         PLUGIN_NETINFO="yes"
+         PLUGIN_POP3="yes"
+         PLUGIN_PPP="yes"
+         PLUGIN_PROC_STAT="yes"
+         PLUGIN_PYTHON=$with_python
+         PLUGIN_SAMPLE="yes"
+         PLUGIN_SETI="yes"
+         PLUGIN_STATFS="yes"
+         PLUGIN_UNAME="yes"
+         PLUGIN_UPTIME="yes"
+         PLUGIN_W1RETAP="yes"
+         PLUGIN_WIRELESS="yes"
+         PLUGIN_XMMS="yes"
+         ;;
+      apm)
+         PLUGIN_APM=$val
+         ;;
+      button_exec)
+	 PLUGIN_BUTTON_EXEC=$val
+	 ;;
+      asterisk)
+         PLUGIN_ASTERISK=$val
+         ;;
+      cpuinfo)
+         PLUGIN_CPUINFO=$val
+         ;;
+      diskstats)
+         PLUGIN_DISKSTATS=$val
+         ;;
+      dvb)
+         PLUGIN_DVB=$val
+         ;;
+      exec)
+         PLUGIN_EXEC=$val
+         ;;
+      fifo)
+         PLUGIN_FIFO=$val
+         ;;
+      file)
+         PLUGIN_FILE=$val
+         ;;
+      gps)
+         PLUGIN_GPS=$val
+         ;;
+      hddtemp)
+         PLUGIN_HDDTEMP=$val
+         ;;
+      i2c_sensors)
+         PLUGIN_I2C_SENSORS=$val
+	 ;;
+      iconv)
+      	PLUGIN_ICONV=$val
+      	;;
+      imon)
+         PLUGIN_IMON=$val
+         ;;
+      isdn)
+         PLUGIN_ISDN=$val
+         ;;
+      kvv)
+         PLUGIN_KVV=$val
+         ;;
+      loadavg)
+         PLUGIN_LOADAVG=$val
+         ;;
+      meminfo)
+         PLUGIN_MEMINFO=$val
+         ;;
+      mpd)
+         PLUGIN_MPD=$val
+	 ;;
+      mysql)
+         PLUGIN_MYSQL=$val
+         ;;
+      netdev)
+         PLUGIN_NETDEV=$val
+         ;;
+      netinfo)
+         PLUGIN_NETINFO=$val
+         ;;
+      pop3)
+         PLUGIN_POP3=$val
+         ;;
+      ppp)
+         PLUGIN_PPP=$val
+         ;;
+      proc_stat)
+         PLUGIN_PROC_STAT=$val
+         ;;
+      python)
+         PLUGIN_PYTHON=$val
+         ;;
+      sample)
+         PLUGIN_SAMPLE=$val
+         ;;
+      seti)
+         PLUGIN_SETI=$val
+         ;;
+      statfs)
+         PLUGIN_STATFS=$val
+         ;;
+      uname)
+         PLUGIN_UNAME=$val
+         ;;
+      uptime)
+         PLUGIN_UPTIME=$val
+         ;;
+      w1retap)
+         PLUGIN_W1RETAP=$val
+         ;;
+      wireless)
+         PLUGIN_WIRELESS=$val
+         ;;
+      xmms)
+         PLUGIN_XMMS=$val
+         ;;
+      *)
+         { { echo "$as_me:$LINENO: error: Unknown plugin '$plugin'" >&5
+echo "$as_me: error: Unknown plugin '$plugin'" >&2;}
+   { (exit 1); exit 1; }; }
+         ;;
    esac
+done
+
+{ echo "$as_me:$LINENO: result: done" >&5
+echo "${ECHO_T}done" >&6; }
+
+# Advanced Power Management
+if test "$PLUGIN_APM" = "yes"; then
+
+for ac_header in asm/types.h
+do
+as_ac_Header=`echo "ac_cv_header_$ac_header" | $as_tr_sh`
+if { as_var=$as_ac_Header; eval "test \"\${$as_var+set}\" = set"; }; then
+  { echo "$as_me:$LINENO: checking for $ac_header" >&5
+echo $ECHO_N "checking for $ac_header... $ECHO_C" >&6; }
+if { as_var=$as_ac_Header; eval "test \"\${$as_var+set}\" = set"; }; then
+  echo $ECHO_N "(cached) $ECHO_C" >&6
+fi
+ac_res=`eval echo '${'$as_ac_Header'}'`
+	       { echo "$as_me:$LINENO: result: $ac_res" >&5
+echo "${ECHO_T}$ac_res" >&6; }
+else
+  # Is the header compilable?
+{ echo "$as_me:$LINENO: checking $ac_header usability" >&5
+echo $ECHO_N "checking $ac_header usability... $ECHO_C" >&6; }
+cat >conftest.$ac_ext <<_ACEOF
+/* confdefs.h.  */
+_ACEOF
+cat confdefs.h >>conftest.$ac_ext
+cat >>conftest.$ac_ext <<_ACEOF
+/* end confdefs.h.  */
+$ac_includes_default
+#include <$ac_header>
+_ACEOF
+rm -f conftest.$ac_objext
+if { (ac_try="$ac_compile"
+case "(($ac_try" in
+  *\"* | *\`* | *\\*) ac_try_echo=\$ac_try;;
+  *) ac_try_echo=$ac_try;;
+esac
+eval "echo \"\$as_me:$LINENO: $ac_try_echo\"") >&5
+  (eval "$ac_compile") 2>conftest.er1
+  ac_status=$?
+  grep -v '^ *+' conftest.er1 >conftest.err
+  rm -f conftest.er1
+  cat conftest.err >&5
+  echo "$as_me:$LINENO: \$? = $ac_status" >&5
+  (exit $ac_status); } && {
+	 test -z "$ac_c_werror_flag" ||
+	 test ! -s conftest.err
+       } && test -s conftest.$ac_objext; then
+  ac_header_compiler=yes
+else
+  echo "$as_me: failed program was:" >&5
+sed 's/^/| /' conftest.$ac_ext >&5
+
+	ac_header_compiler=no
+fi
+
+rm -f core conftest.err conftest.$ac_objext conftest.$ac_ext
+{ echo "$as_me:$LINENO: result: $ac_header_compiler" >&5
+echo "${ECHO_T}$ac_header_compiler" >&6; }
+
+# Is the header present?
+{ echo "$as_me:$LINENO: checking $ac_header presence" >&5
+echo $ECHO_N "checking $ac_header presence... $ECHO_C" >&6; }
+cat >conftest.$ac_ext <<_ACEOF
+/* confdefs.h.  */
+_ACEOF
+cat confdefs.h >>conftest.$ac_ext
+cat >>conftest.$ac_ext <<_ACEOF
+/* end confdefs.h.  */
+#include <$ac_header>
+_ACEOF
+if { (ac_try="$ac_cpp conftest.$ac_ext"
+case "(($ac_try" in
+  *\"* | *\`* | *\\*) ac_try_echo=\$ac_try;;
+  *) ac_try_echo=$ac_try;;
+esac
+eval "echo \"\$as_me:$LINENO: $ac_try_echo\"") >&5
+  (eval "$ac_cpp conftest.$ac_ext") 2>conftest.er1
+  ac_status=$?
+  grep -v '^ *+' conftest.er1 >conftest.err
+  rm -f conftest.er1
+  cat conftest.err >&5
+  echo "$as_me:$LINENO: \$? = $ac_status" >&5
+  (exit $ac_status); } >/dev/null && {
+	 test -z "$ac_c_preproc_warn_flag$ac_c_werror_flag" ||
+	 test ! -s conftest.err
+       }; then
+  ac_header_preproc=yes
+else
+  echo "$as_me: failed program was:" >&5
+sed 's/^/| /' conftest.$ac_ext >&5
+
+  ac_header_preproc=no
+fi
+
+rm -f conftest.err conftest.$ac_ext
+{ echo "$as_me:$LINENO: result: $ac_header_preproc" >&5
+echo "${ECHO_T}$ac_header_preproc" >&6; }
+
+# So?  What about this header?
+case $ac_header_compiler:$ac_header_preproc:$ac_c_preproc_warn_flag in
+  yes:no: )
+    { echo "$as_me:$LINENO: WARNING: $ac_header: accepted by the compiler, rejected by the preprocessor!" >&5
+echo "$as_me: WARNING: $ac_header: accepted by the compiler, rejected by the preprocessor!" >&2;}
+    { echo "$as_me:$LINENO: WARNING: $ac_header: proceeding with the compiler's result" >&5
+echo "$as_me: WARNING: $ac_header: proceeding with the compiler's result" >&2;}
+    ac_header_preproc=yes
+    ;;
+  no:yes:* )
+    { echo "$as_me:$LINENO: WARNING: $ac_header: present but cannot be compiled" >&5
+echo "$as_me: WARNING: $ac_header: present but cannot be compiled" >&2;}
+    { echo "$as_me:$LINENO: WARNING: $ac_header:     check for missing prerequisite headers?" >&5
+echo "$as_me: WARNING: $ac_header:     check for missing prerequisite headers?" >&2;}
+    { echo "$as_me:$LINENO: WARNING: $ac_header: see the Autoconf documentation" >&5
+echo "$as_me: WARNING: $ac_header: see the Autoconf documentation" >&2;}
+    { echo "$as_me:$LINENO: WARNING: $ac_header:     section \"Present But Cannot Be Compiled\"" >&5
+echo "$as_me: WARNING: $ac_header:     section \"Present But Cannot Be Compiled\"" >&2;}
+    { echo "$as_me:$LINENO: WARNING: $ac_header: proceeding with the preprocessor's result" >&5
+echo "$as_me: WARNING: $ac_header: proceeding with the preprocessor's result" >&2;}
+    { echo "$as_me:$LINENO: WARNING: $ac_header: in the future, the compiler will take precedence" >&5
+echo "$as_me: WARNING: $ac_header: in the future, the compiler will take precedence" >&2;}
+    ( cat <<\_ASBOX
+## ---------------------------------------------------- ##
+## Report this to lcd4linux-users@lists.sourceforge.net ##
+## ---------------------------------------------------- ##
+_ASBOX
+     ) | sed "s/^/$as_me: WARNING:     /" >&2
+    ;;
+esac
+{ echo "$as_me:$LINENO: checking for $ac_header" >&5
+echo $ECHO_N "checking for $ac_header... $ECHO_C" >&6; }
+if { as_var=$as_ac_Header; eval "test \"\${$as_var+set}\" = set"; }; then
+  echo $ECHO_N "(cached) $ECHO_C" >&6
+else
+  eval "$as_ac_Header=\$ac_header_preproc"
+fi
+ac_res=`eval echo '${'$as_ac_Header'}'`
+	       { echo "$as_me:$LINENO: result: $ac_res" >&5
+echo "${ECHO_T}$ac_res" >&6; }
+
+fi
+if test `eval echo '${'$as_ac_Header'}'` = yes; then
+  cat >>confdefs.h <<_ACEOF
+#define `echo "HAVE_$ac_header" | $as_tr_cpp` 1
+_ACEOF
+ has_asm_types="true"
+else
+  has_asm_types="false"
+fi
+
+done
+
+   if test "$has_asm_types" = "true"; then
+      PLUGINS="$PLUGINS plugin_apm.o"
+
+cat >>confdefs.h <<\_ACEOF
+#define PLUGIN_APM 1
+_ACEOF
+
+   else
+      { echo "$as_me:$LINENO: WARNING: asm/types.h header not found: apm plugin disabled" >&5
+echo "$as_me: WARNING: asm/types.h header not found: apm plugin disabled" >&2;}
+   fi
+fi
+
+if test "$PLUGIN_BUTTON_EXEC" = "yes"; then
+   PLUGINS="$PLUGINS plugin_button_exec.o"
+
+cat >>confdefs.h <<\_ACEOF
+#define PLUGIN_BUTTON_EXEC 1
+_ACEOF
+
+fi
+
+if test "$PLUGIN_ASTERISK" = "yes"; then
+   PLUGINS="$PLUGINS plugin_asterisk.o"
+
+cat >>confdefs.h <<\_ACEOF
+#define PLUGIN_ASTERISK 1
+_ACEOF
+
+fi
+
+# /proc/cpuinfo
+if test "$PLUGIN_CPUINFO" = "yes"; then
+   PLUGINS="$PLUGINS plugin_cpuinfo.o"
+
+cat >>confdefs.h <<\_ACEOF
+#define PLUGIN_CPUINFO 1
+_ACEOF
+
+fi
+
+# /proc/diskstat
+if test "$PLUGIN_DISKSTATS" = "yes"; then
+   PLUGINS="$PLUGINS plugin_diskstats.o"
+
+cat >>confdefs.h <<\_ACEOF
+#define PLUGIN_DISKSTATS 1
+_ACEOF
+
+fi
+
+# Digital Video Broadcasting
+if test "$PLUGIN_DVB" = "yes"; then
+
+for ac_header in asm/types.h
+do
+as_ac_Header=`echo "ac_cv_header_$ac_header" | $as_tr_sh`
+if { as_var=$as_ac_Header; eval "test \"\${$as_var+set}\" = set"; }; then
+  { echo "$as_me:$LINENO: checking for $ac_header" >&5
+echo $ECHO_N "checking for $ac_header... $ECHO_C" >&6; }
+if { as_var=$as_ac_Header; eval "test \"\${$as_var+set}\" = set"; }; then
+  echo $ECHO_N "(cached) $ECHO_C" >&6
+fi
+ac_res=`eval echo '${'$as_ac_Header'}'`
+	       { echo "$as_me:$LINENO: result: $ac_res" >&5
+echo "${ECHO_T}$ac_res" >&6; }
+else
+  # Is the header compilable?
+{ echo "$as_me:$LINENO: checking $ac_header usability" >&5
+echo $ECHO_N "checking $ac_header usability... $ECHO_C" >&6; }
+cat >conftest.$ac_ext <<_ACEOF
+/* confdefs.h.  */
+_ACEOF
+cat confdefs.h >>conftest.$ac_ext
+cat >>conftest.$ac_ext <<_ACEOF
+/* end confdefs.h.  */
+$ac_includes_default
+#include <$ac_header>
+_ACEOF
+rm -f conftest.$ac_objext
+if { (ac_try="$ac_compile"
+case "(($ac_try" in
+  *\"* | *\`* | *\\*) ac_try_echo=\$ac_try;;
+  *) ac_try_echo=$ac_try;;
+esac
+eval "echo \"\$as_me:$LINENO: $ac_try_echo\"") >&5
+  (eval "$ac_compile") 2>conftest.er1
+  ac_status=$?
+  grep -v '^ *+' conftest.er1 >conftest.err
+  rm -f conftest.er1
+  cat conftest.err >&5
+  echo "$as_me:$LINENO: \$? = $ac_status" >&5
+  (exit $ac_status); } && {
+	 test -z "$ac_c_werror_flag" ||
+	 test ! -s conftest.err
+       } && test -s conftest.$ac_objext; then
+  ac_header_compiler=yes
+else
+  echo "$as_me: failed program was:" >&5
+sed 's/^/| /' conftest.$ac_ext >&5
+
+	ac_header_compiler=no
+fi
+
+rm -f core conftest.err conftest.$ac_objext conftest.$ac_ext
+{ echo "$as_me:$LINENO: result: $ac_header_compiler" >&5
+echo "${ECHO_T}$ac_header_compiler" >&6; }
+
+# Is the header present?
+{ echo "$as_me:$LINENO: checking $ac_header presence" >&5
+echo $ECHO_N "checking $ac_header presence... $ECHO_C" >&6; }
+cat >conftest.$ac_ext <<_ACEOF
+/* confdefs.h.  */
+_ACEOF
+cat confdefs.h >>conftest.$ac_ext
+cat >>conftest.$ac_ext <<_ACEOF
+/* end confdefs.h.  */
+#include <$ac_header>
+_ACEOF
+if { (ac_try="$ac_cpp conftest.$ac_ext"
+case "(($ac_try" in
+  *\"* | *\`* | *\\*) ac_try_echo=\$ac_try;;
+  *) ac_try_echo=$ac_try;;
+esac
+eval "echo \"\$as_me:$LINENO: $ac_try_echo\"") >&5
+  (eval "$ac_cpp conftest.$ac_ext") 2>conftest.er1
+  ac_status=$?
+  grep -v '^ *+' conftest.er1 >conftest.err
+  rm -f conftest.er1
+  cat conftest.err >&5
+  echo "$as_me:$LINENO: \$? = $ac_status" >&5
+  (exit $ac_status); } >/dev/null && {
+	 test -z "$ac_c_preproc_warn_flag$ac_c_werror_flag" ||
+	 test ! -s conftest.err
+       }; then
+  ac_header_preproc=yes
+else
+  echo "$as_me: failed program was:" >&5
+sed 's/^/| /' conftest.$ac_ext >&5
+
+  ac_header_preproc=no
+fi
+
+rm -f conftest.err conftest.$ac_ext
+{ echo "$as_me:$LINENO: result: $ac_header_preproc" >&5
+echo "${ECHO_T}$ac_header_preproc" >&6; }
+
+# So?  What about this header?
+case $ac_header_compiler:$ac_header_preproc:$ac_c_preproc_warn_flag in
+  yes:no: )
+    { echo "$as_me:$LINENO: WARNING: $ac_header: accepted by the compiler, rejected by the preprocessor!" >&5
+echo "$as_me: WARNING: $ac_header: accepted by the compiler, rejected by the preprocessor!" >&2;}
+    { echo "$as_me:$LINENO: WARNING: $ac_header: proceeding with the compiler's result" >&5
+echo "$as_me: WARNING: $ac_header: proceeding with the compiler's result" >&2;}
+    ac_header_preproc=yes
+    ;;
+  no:yes:* )
+    { echo "$as_me:$LINENO: WARNING: $ac_header: present but cannot be compiled" >&5
+echo "$as_me: WARNING: $ac_header: present but cannot be compiled" >&2;}
+    { echo "$as_me:$LINENO: WARNING: $ac_header:     check for missing prerequisite headers?" >&5
+echo "$as_me: WARNING: $ac_header:     check for missing prerequisite headers?" >&2;}
+    { echo "$as_me:$LINENO: WARNING: $ac_header: see the Autoconf documentation" >&5
+echo "$as_me: WARNING: $ac_header: see the Autoconf documentation" >&2;}
+    { echo "$as_me:$LINENO: WARNING: $ac_header:     section \"Present But Cannot Be Compiled\"" >&5
+echo "$as_me: WARNING: $ac_header:     section \"Present But Cannot Be Compiled\"" >&2;}
+    { echo "$as_me:$LINENO: WARNING: $ac_header: proceeding with the preprocessor's result" >&5
+echo "$as_me: WARNING: $ac_header: proceeding with the preprocessor's result" >&2;}
+    { echo "$as_me:$LINENO: WARNING: $ac_header: in the future, the compiler will take precedence" >&5
+echo "$as_me: WARNING: $ac_header: in the future, the compiler will take precedence" >&2;}
+    ( cat <<\_ASBOX
+## ---------------------------------------------------- ##
+## Report this to lcd4linux-users@lists.sourceforge.net ##
+## ---------------------------------------------------- ##
+_ASBOX
+     ) | sed "s/^/$as_me: WARNING:     /" >&2
+    ;;
+esac
+{ echo "$as_me:$LINENO: checking for $ac_header" >&5
+echo $ECHO_N "checking for $ac_header... $ECHO_C" >&6; }
+if { as_var=$as_ac_Header; eval "test \"\${$as_var+set}\" = set"; }; then
+  echo $ECHO_N "(cached) $ECHO_C" >&6
+else
+  eval "$as_ac_Header=\$ac_header_preproc"
+fi
+ac_res=`eval echo '${'$as_ac_Header'}'`
+	       { echo "$as_me:$LINENO: result: $ac_res" >&5
+echo "${ECHO_T}$ac_res" >&6; }
+
+fi
+if test `eval echo '${'$as_ac_Header'}'` = yes; then
+  cat >>confdefs.h <<_ACEOF
+#define `echo "HAVE_$ac_header" | $as_tr_cpp` 1
+_ACEOF
+ has_asm_types="true"
+else
+  has_asm_types="false"
+fi
+
+done
+
+   if test "$has_asm_types" = "true"; then
+
+for ac_header in linux/dvb/frontend.h
+do
+as_ac_Header=`echo "ac_cv_header_$ac_header" | $as_tr_sh`
+if { as_var=$as_ac_Header; eval "test \"\${$as_var+set}\" = set"; }; then
+  { echo "$as_me:$LINENO: checking for $ac_header" >&5
+echo $ECHO_N "checking for $ac_header... $ECHO_C" >&6; }
+if { as_var=$as_ac_Header; eval "test \"\${$as_var+set}\" = set"; }; then
+  echo $ECHO_N "(cached) $ECHO_C" >&6
+fi
+ac_res=`eval echo '${'$as_ac_Header'}'`
+	       { echo "$as_me:$LINENO: result: $ac_res" >&5
+echo "${ECHO_T}$ac_res" >&6; }
+else
+  # Is the header compilable?
+{ echo "$as_me:$LINENO: checking $ac_header usability" >&5
+echo $ECHO_N "checking $ac_header usability... $ECHO_C" >&6; }
+cat >conftest.$ac_ext <<_ACEOF
+/* confdefs.h.  */
+_ACEOF
+cat confdefs.h >>conftest.$ac_ext
+cat >>conftest.$ac_ext <<_ACEOF
+/* end confdefs.h.  */
+$ac_includes_default
+#include <$ac_header>
+_ACEOF
+rm -f conftest.$ac_objext
+if { (ac_try="$ac_compile"
+case "(($ac_try" in
+  *\"* | *\`* | *\\*) ac_try_echo=\$ac_try;;
+  *) ac_try_echo=$ac_try;;
+esac
+eval "echo \"\$as_me:$LINENO: $ac_try_echo\"") >&5
+  (eval "$ac_compile") 2>conftest.er1
+  ac_status=$?
+  grep -v '^ *+' conftest.er1 >conftest.err
+  rm -f conftest.er1
+  cat conftest.err >&5
+  echo "$as_me:$LINENO: \$? = $ac_status" >&5
+  (exit $ac_status); } && {
+	 test -z "$ac_c_werror_flag" ||
+	 test ! -s conftest.err
+       } && test -s conftest.$ac_objext; then
+  ac_header_compiler=yes
+else
+  echo "$as_me: failed program was:" >&5
+sed 's/^/| /' conftest.$ac_ext >&5
+
+	ac_header_compiler=no
+fi
+
+rm -f core conftest.err conftest.$ac_objext conftest.$ac_ext
+{ echo "$as_me:$LINENO: result: $ac_header_compiler" >&5
+echo "${ECHO_T}$ac_header_compiler" >&6; }
+
+# Is the header present?
+{ echo "$as_me:$LINENO: checking $ac_header presence" >&5
+echo $ECHO_N "checking $ac_header presence... $ECHO_C" >&6; }
+cat >conftest.$ac_ext <<_ACEOF
+/* confdefs.h.  */
+_ACEOF
+cat confdefs.h >>conftest.$ac_ext
+cat >>conftest.$ac_ext <<_ACEOF
+/* end confdefs.h.  */
+#include <$ac_header>
+_ACEOF
+if { (ac_try="$ac_cpp conftest.$ac_ext"
+case "(($ac_try" in
+  *\"* | *\`* | *\\*) ac_try_echo=\$ac_try;;
+  *) ac_try_echo=$ac_try;;
+esac
+eval "echo \"\$as_me:$LINENO: $ac_try_echo\"") >&5
+  (eval "$ac_cpp conftest.$ac_ext") 2>conftest.er1
+  ac_status=$?
+  grep -v '^ *+' conftest.er1 >conftest.err
+  rm -f conftest.er1
+  cat conftest.err >&5
+  echo "$as_me:$LINENO: \$? = $ac_status" >&5
+  (exit $ac_status); } >/dev/null && {
+	 test -z "$ac_c_preproc_warn_flag$ac_c_werror_flag" ||
+	 test ! -s conftest.err
+       }; then
+  ac_header_preproc=yes
+else
+  echo "$as_me: failed program was:" >&5
+sed 's/^/| /' conftest.$ac_ext >&5
+
+  ac_header_preproc=no
+fi
+
+rm -f conftest.err conftest.$ac_ext
+{ echo "$as_me:$LINENO: result: $ac_header_preproc" >&5
+echo "${ECHO_T}$ac_header_preproc" >&6; }
+
+# So?  What about this header?
+case $ac_header_compiler:$ac_header_preproc:$ac_c_preproc_warn_flag in
+  yes:no: )
+    { echo "$as_me:$LINENO: WARNING: $ac_header: accepted by the compiler, rejected by the preprocessor!" >&5
+echo "$as_me: WARNING: $ac_header: accepted by the compiler, rejected by the preprocessor!" >&2;}
+    { echo "$as_me:$LINENO: WARNING: $ac_header: proceeding with the compiler's result" >&5
+echo "$as_me: WARNING: $ac_header: proceeding with the compiler's result" >&2;}
+    ac_header_preproc=yes
+    ;;
+  no:yes:* )
+    { echo "$as_me:$LINENO: WARNING: $ac_header: present but cannot be compiled" >&5
+echo "$as_me: WARNING: $ac_header: present but cannot be compiled" >&2;}
+    { echo "$as_me:$LINENO: WARNING: $ac_header:     check for missing prerequisite headers?" >&5
+echo "$as_me: WARNING: $ac_header:     check for missing prerequisite headers?" >&2;}
+    { echo "$as_me:$LINENO: WARNING: $ac_header: see the Autoconf documentation" >&5
+echo "$as_me: WARNING: $ac_header: see the Autoconf documentation" >&2;}
+    { echo "$as_me:$LINENO: WARNING: $ac_header:     section \"Present But Cannot Be Compiled\"" >&5
+echo "$as_me: WARNING: $ac_header:     section \"Present But Cannot Be Compiled\"" >&2;}
+    { echo "$as_me:$LINENO: WARNING: $ac_header: proceeding with the preprocessor's result" >&5
+echo "$as_me: WARNING: $ac_header: proceeding with the preprocessor's result" >&2;}
+    { echo "$as_me:$LINENO: WARNING: $ac_header: in the future, the compiler will take precedence" >&5
+echo "$as_me: WARNING: $ac_header: in the future, the compiler will take precedence" >&2;}
+    ( cat <<\_ASBOX
+## ---------------------------------------------------- ##
+## Report this to lcd4linux-users@lists.sourceforge.net ##
+## ---------------------------------------------------- ##
+_ASBOX
+     ) | sed "s/^/$as_me: WARNING:     /" >&2
+    ;;
+esac
+{ echo "$as_me:$LINENO: checking for $ac_header" >&5
+echo $ECHO_N "checking for $ac_header... $ECHO_C" >&6; }
+if { as_var=$as_ac_Header; eval "test \"\${$as_var+set}\" = set"; }; then
+  echo $ECHO_N "(cached) $ECHO_C" >&6
+else
+  eval "$as_ac_Header=\$ac_header_preproc"
+fi
+ac_res=`eval echo '${'$as_ac_Header'}'`
+	       { echo "$as_me:$LINENO: result: $ac_res" >&5
+echo "${ECHO_T}$ac_res" >&6; }
+
+fi
+if test `eval echo '${'$as_ac_Header'}'` = yes; then
+  cat >>confdefs.h <<_ACEOF
+#define `echo "HAVE_$ac_header" | $as_tr_cpp` 1
+_ACEOF
+ has_dvb_header="true"
+else
+  has_dvb_header="false"
+fi
+
+done
+
+       if test "$has_dvb_header" = "true"; then
+          PLUGINS="$PLUGINS plugin_dvb.o"
+
+cat >>confdefs.h <<\_ACEOF
+#define PLUGIN_DVB 1
+_ACEOF
+
+       else
+          PLUGINS="$PLUGINS plugin_dvb.o"
+          { echo "$as_me:$LINENO: WARNING: linux/dvb/frontend.h header not found: using ioctl" >&5
+echo "$as_me: WARNING: linux/dvb/frontend.h header not found: using ioctl" >&2;}
+       fi
+   else
+       { echo "$as_me:$LINENO: WARNING: asm/types.h header not found: dvb plugin disabled" >&5
+echo "$as_me: WARNING: asm/types.h header not found: dvb plugin disabled" >&2;}
+   fi
+fi
+
+# start external commands (exec)
+if test "$PLUGIN_EXEC" = "yes"; then
+   PLUGINS="$PLUGINS plugin_exec.o"
+
+cat >>confdefs.h <<\_ACEOF
+#define PLUGIN_EXEC 1
+_ACEOF
+
+fi
+
+# file
+if test "$PLUGIN_FILE" = "yes"; then
+   PLUGINS="$PLUGINS plugin_file.o"
+
+cat >>confdefs.h <<\_ACEOF
+#define PLUGIN_FILE 1
+_ACEOF
+
+fi
+
+# FIFO
+if test "$PLUGIN_FIFO" = "yes"; then
+   PLUGINS="$PLUGINS plugin_fifo.o"
+
+cat >>confdefs.h <<\_ACEOF
+#define PLUGIN_FIFO 1
+_ACEOF
+
+fi
+
+# GPS
+if test "$PLUGIN_GPS" = "yes"; then
+
+for ac_header in nmeap.h
+do
+as_ac_Header=`echo "ac_cv_header_$ac_header" | $as_tr_sh`
+if { as_var=$as_ac_Header; eval "test \"\${$as_var+set}\" = set"; }; then
+  { echo "$as_me:$LINENO: checking for $ac_header" >&5
+echo $ECHO_N "checking for $ac_header... $ECHO_C" >&6; }
+if { as_var=$as_ac_Header; eval "test \"\${$as_var+set}\" = set"; }; then
+  echo $ECHO_N "(cached) $ECHO_C" >&6
+fi
+ac_res=`eval echo '${'$as_ac_Header'}'`
+	       { echo "$as_me:$LINENO: result: $ac_res" >&5
+echo "${ECHO_T}$ac_res" >&6; }
+else
+  # Is the header compilable?
+{ echo "$as_me:$LINENO: checking $ac_header usability" >&5
+echo $ECHO_N "checking $ac_header usability... $ECHO_C" >&6; }
+cat >conftest.$ac_ext <<_ACEOF
+/* confdefs.h.  */
+_ACEOF
+cat confdefs.h >>conftest.$ac_ext
+cat >>conftest.$ac_ext <<_ACEOF
+/* end confdefs.h.  */
+$ac_includes_default
+#include <$ac_header>
+_ACEOF
+rm -f conftest.$ac_objext
+if { (ac_try="$ac_compile"
+case "(($ac_try" in
+  *\"* | *\`* | *\\*) ac_try_echo=\$ac_try;;
+  *) ac_try_echo=$ac_try;;
+esac
+eval "echo \"\$as_me:$LINENO: $ac_try_echo\"") >&5
+  (eval "$ac_compile") 2>conftest.er1
+  ac_status=$?
+  grep -v '^ *+' conftest.er1 >conftest.err
+  rm -f conftest.er1
+  cat conftest.err >&5
+  echo "$as_me:$LINENO: \$? = $ac_status" >&5
+  (exit $ac_status); } && {
+	 test -z "$ac_c_werror_flag" ||
+	 test ! -s conftest.err
+       } && test -s conftest.$ac_objext; then
+  ac_header_compiler=yes
+else
+  echo "$as_me: failed program was:" >&5
+sed 's/^/| /' conftest.$ac_ext >&5
 
-   case "$driver" in
-      all)
-         BECKMANNEGLE="yes"
-         BWCT="yes"
-         CRYSTALFONTZ="yes"
-         CURSES="yes"
-         CWLINUX="yes"
-         HD44780="yes"
-	 LCDLINUX="yes"
-         LCDTERM="yes"
-         M50530="yes"
-         MATRIXORBITAL="yes"
-         MILINST="yes"
-         NORITAKE="yes"
-         NULL="yes"
-         PNG="yes"
-         PPM="yes"
-	 ROUTERBOARD="yes"
-	 SERDISPLIB="yes"
-         SIMPLELCD="yes"
-         T6963="yes"
-         Trefon="yes"
-         USBLCD="yes"
-         X11="yes"
-         ;;
-      BeckmannEgle)
-         BECKMANNEGLE=$val
-         ;;
-      BWCT)
-         BWCT=$val
-         ;;
-      CrystalFontz)
-         CRYSTALFONTZ=$val
-         ;;
-      Curses)
-         CURSES=$val
-         ;;
-      Cwlinux)
-         CWLINUX=$val
-         ;;
-      HD44780)
-         HD44780=$val
-	 ;;
-      LCDLINUX)
-         LCDLINUX=$val
-	 ;;
-      LCDTerm)
-         LCDTERM=$val
-	 ;;
-      M50530)
-         M50530=$val
-         ;;
-      MatrixOrbital)
-         MATRIXORBITAL=$val
-         ;;
-      MilfordInstruments)
-         MILINST=$val
-         ;;
-      Noritake)
-         NORITAKE=$val;
-         ;;
-      NULL)
-         NULL=$val;
-         ;;
-      PNG)
-         PNG=$val
-         ;;
-      PPM)
-         PPM=$val
-         ;;
-      RouterBoard)
-         ROUTERBOARD=$val
-         ;;
-      serdisplib)
-         SERDISPLIB=$val;
-         ;;
-      SimpleLCD)
-         SIMPLELCD=$val
-         ;;
-      T6963)
-         T6963=$val
-         ;;
-      Trefon)
-         Trefon=$val
-         ;;
-      USBLCD)
-         USBLCD=$val
-         ;;
-      X11)
-         X11=$val
-         ;;
+	ac_header_compiler=no
+fi
+
+rm -f core conftest.err conftest.$ac_objext conftest.$ac_ext
+{ echo "$as_me:$LINENO: result: $ac_header_compiler" >&5
+echo "${ECHO_T}$ac_header_compiler" >&6; }
+
+# Is the header present?
+{ echo "$as_me:$LINENO: checking $ac_header presence" >&5
+echo $ECHO_N "checking $ac_header presence... $ECHO_C" >&6; }
+cat >conftest.$ac_ext <<_ACEOF
+/* confdefs.h.  */
+_ACEOF
+cat confdefs.h >>conftest.$ac_ext
+cat >>conftest.$ac_ext <<_ACEOF
+/* end confdefs.h.  */
+#include <$ac_header>
+_ACEOF
+if { (ac_try="$ac_cpp conftest.$ac_ext"
+case "(($ac_try" in
+  *\"* | *\`* | *\\*) ac_try_echo=\$ac_try;;
+  *) ac_try_echo=$ac_try;;
+esac
+eval "echo \"\$as_me:$LINENO: $ac_try_echo\"") >&5
+  (eval "$ac_cpp conftest.$ac_ext") 2>conftest.er1
+  ac_status=$?
+  grep -v '^ *+' conftest.er1 >conftest.err
+  rm -f conftest.er1
+  cat conftest.err >&5
+  echo "$as_me:$LINENO: \$? = $ac_status" >&5
+  (exit $ac_status); } >/dev/null && {
+	 test -z "$ac_c_preproc_warn_flag$ac_c_werror_flag" ||
+	 test ! -s conftest.err
+       }; then
+  ac_header_preproc=yes
+else
+  echo "$as_me: failed program was:" >&5
+sed 's/^/| /' conftest.$ac_ext >&5
+
+  ac_header_preproc=no
+fi
+
+rm -f conftest.err conftest.$ac_ext
+{ echo "$as_me:$LINENO: result: $ac_header_preproc" >&5
+echo "${ECHO_T}$ac_header_preproc" >&6; }
+
+# So?  What about this header?
+case $ac_header_compiler:$ac_header_preproc:$ac_c_preproc_warn_flag in
+  yes:no: )
+    { echo "$as_me:$LINENO: WARNING: $ac_header: accepted by the compiler, rejected by the preprocessor!" >&5
+echo "$as_me: WARNING: $ac_header: accepted by the compiler, rejected by the preprocessor!" >&2;}
+    { echo "$as_me:$LINENO: WARNING: $ac_header: proceeding with the compiler's result" >&5
+echo "$as_me: WARNING: $ac_header: proceeding with the compiler's result" >&2;}
+    ac_header_preproc=yes
+    ;;
+  no:yes:* )
+    { echo "$as_me:$LINENO: WARNING: $ac_header: present but cannot be compiled" >&5
+echo "$as_me: WARNING: $ac_header: present but cannot be compiled" >&2;}
+    { echo "$as_me:$LINENO: WARNING: $ac_header:     check for missing prerequisite headers?" >&5
+echo "$as_me: WARNING: $ac_header:     check for missing prerequisite headers?" >&2;}
+    { echo "$as_me:$LINENO: WARNING: $ac_header: see the Autoconf documentation" >&5
+echo "$as_me: WARNING: $ac_header: see the Autoconf documentation" >&2;}
+    { echo "$as_me:$LINENO: WARNING: $ac_header:     section \"Present But Cannot Be Compiled\"" >&5
+echo "$as_me: WARNING: $ac_header:     section \"Present But Cannot Be Compiled\"" >&2;}
+    { echo "$as_me:$LINENO: WARNING: $ac_header: proceeding with the preprocessor's result" >&5
+echo "$as_me: WARNING: $ac_header: proceeding with the preprocessor's result" >&2;}
+    { echo "$as_me:$LINENO: WARNING: $ac_header: in the future, the compiler will take precedence" >&5
+echo "$as_me: WARNING: $ac_header: in the future, the compiler will take precedence" >&2;}
+    ( cat <<\_ASBOX
+## ---------------------------------------------------- ##
+## Report this to lcd4linux-users@lists.sourceforge.net ##
+## ---------------------------------------------------- ##
+_ASBOX
+     ) | sed "s/^/$as_me: WARNING:     /" >&2
+    ;;
+esac
+{ echo "$as_me:$LINENO: checking for $ac_header" >&5
+echo $ECHO_N "checking for $ac_header... $ECHO_C" >&6; }
+if { as_var=$as_ac_Header; eval "test \"\${$as_var+set}\" = set"; }; then
+  echo $ECHO_N "(cached) $ECHO_C" >&6
+else
+  eval "$as_ac_Header=\$ac_header_preproc"
+fi
+ac_res=`eval echo '${'$as_ac_Header'}'`
+	       { echo "$as_me:$LINENO: result: $ac_res" >&5
+echo "${ECHO_T}$ac_res" >&6; }
+
+fi
+if test `eval echo '${'$as_ac_Header'}'` = yes; then
+  cat >>confdefs.h <<_ACEOF
+#define `echo "HAVE_$ac_header" | $as_tr_cpp` 1
+_ACEOF
+ has_nmeap_header="true"
+else
+  has_nmeap_header="false"
+fi
+
+done
+
+   if test "$has_nmeap_header" = "true"; then
+      { echo "$as_me:$LINENO: checking for nmeap_init in -lnmeap" >&5
+echo $ECHO_N "checking for nmeap_init in -lnmeap... $ECHO_C" >&6; }
+if test "${ac_cv_lib_nmeap_nmeap_init+set}" = set; then
+  echo $ECHO_N "(cached) $ECHO_C" >&6
+else
+  ac_check_lib_save_LIBS=$LIBS
+LIBS="-lnmeap  $LIBS"
+cat >conftest.$ac_ext <<_ACEOF
+/* confdefs.h.  */
+_ACEOF
+cat confdefs.h >>conftest.$ac_ext
+cat >>conftest.$ac_ext <<_ACEOF
+/* end confdefs.h.  */
+
+/* Override any GCC internal prototype to avoid an error.
+   Use char because int might match the return type of a GCC
+   builtin and then its argument prototype would still apply.  */
+#ifdef __cplusplus
+extern "C"
+#endif
+char nmeap_init ();
+int
+main ()
+{
+return nmeap_init ();
+  ;
+  return 0;
+}
+_ACEOF
+rm -f conftest.$ac_objext conftest$ac_exeext
+if { (ac_try="$ac_link"
+case "(($ac_try" in
+  *\"* | *\`* | *\\*) ac_try_echo=\$ac_try;;
+  *) ac_try_echo=$ac_try;;
+esac
+eval "echo \"\$as_me:$LINENO: $ac_try_echo\"") >&5
+  (eval "$ac_link") 2>conftest.er1
+  ac_status=$?
+  grep -v '^ *+' conftest.er1 >conftest.err
+  rm -f conftest.er1
+  cat conftest.err >&5
+  echo "$as_me:$LINENO: \$? = $ac_status" >&5
+  (exit $ac_status); } && {
+	 test -z "$ac_c_werror_flag" ||
+	 test ! -s conftest.err
+       } && test -s conftest$ac_exeext &&
+       $as_test_x conftest$ac_exeext; then
+  ac_cv_lib_nmeap_nmeap_init=yes
+else
+  echo "$as_me: failed program was:" >&5
+sed 's/^/| /' conftest.$ac_ext >&5
+
+	ac_cv_lib_nmeap_nmeap_init=no
+fi
+
+rm -f core conftest.err conftest.$ac_objext conftest_ipa8_conftest.oo \
+      conftest$ac_exeext conftest.$ac_ext
+LIBS=$ac_check_lib_save_LIBS
+fi
+{ echo "$as_me:$LINENO: result: $ac_cv_lib_nmeap_nmeap_init" >&5
+echo "${ECHO_T}$ac_cv_lib_nmeap_nmeap_init" >&6; }
+if test $ac_cv_lib_nmeap_nmeap_init = yes; then
+  has_libnmeap_lib="true"
+else
+  has_libnmeap_lib="false"
+fi
+
+      if test "$has_libnmeap_lib" = "true"; then
+        PLUGINS="$PLUGINS plugin_gps.o"
+        PLUGINLIBS="$PLUGINLIBS -lnmeap"
+
+cat >>confdefs.h <<\_ACEOF
+#define PLUGIN_GPS 1
+_ACEOF
+
+      else
+        { echo "$as_me:$LINENO: WARNING: libnmeap lib not found: gps plugin disabled" >&5
+echo "$as_me: WARNING: libnmeap lib not found: gps plugin disabled" >&2;}
+      fi
+   else
+      { echo "$as_me:$LINENO: WARNING: nmeap.h header not found: gps plugin disabled" >&5
+echo "$as_me: WARNING: nmeap.h header not found: gps plugin disabled" >&2;}
+   fi
+fi
+
+# hddtemp
+if test "$PLUGIN_HDDTEMP" = "yes"; then
+   PLUGINS="$PLUGINS plugin_hddtemp.o"
+
+cat >>confdefs.h <<\_ACEOF
+#define PLUGIN_HDDTEMP 1
+_ACEOF
+
+fi
+
+# I2C
+if test "$PLUGIN_I2C_SENSORS" = "yes"; then
+   PLUGINS="$PLUGINS plugin_i2c_sensors.o"
+
+cat >>confdefs.h <<\_ACEOF
+#define PLUGIN_I2C_SENSORS 1
+_ACEOF
+
+fi
+
+# IConv
+if test "$PLUGIN_ICONV" = "yes"; then
+   # Make sure we can run config.sub.
+$SHELL "$ac_aux_dir/config.sub" sun4 >/dev/null 2>&1 ||
+  { { echo "$as_me:$LINENO: error: cannot run $SHELL $ac_aux_dir/config.sub" >&5
+echo "$as_me: error: cannot run $SHELL $ac_aux_dir/config.sub" >&2;}
+   { (exit 1); exit 1; }; }
+
+{ echo "$as_me:$LINENO: checking build system type" >&5
+echo $ECHO_N "checking build system type... $ECHO_C" >&6; }
+if test "${ac_cv_build+set}" = set; then
+  echo $ECHO_N "(cached) $ECHO_C" >&6
+else
+  ac_build_alias=$build_alias
+test "x$ac_build_alias" = x &&
+  ac_build_alias=`$SHELL "$ac_aux_dir/config.guess"`
+test "x$ac_build_alias" = x &&
+  { { echo "$as_me:$LINENO: error: cannot guess build type; you must specify one" >&5
+echo "$as_me: error: cannot guess build type; you must specify one" >&2;}
+   { (exit 1); exit 1; }; }
+ac_cv_build=`$SHELL "$ac_aux_dir/config.sub" $ac_build_alias` ||
+  { { echo "$as_me:$LINENO: error: $SHELL $ac_aux_dir/config.sub $ac_build_alias failed" >&5
+echo "$as_me: error: $SHELL $ac_aux_dir/config.sub $ac_build_alias failed" >&2;}
+   { (exit 1); exit 1; }; }
+
+fi
+{ echo "$as_me:$LINENO: result: $ac_cv_build" >&5
+echo "${ECHO_T}$ac_cv_build" >&6; }
+case $ac_cv_build in
+*-*-*) ;;
+*) { { echo "$as_me:$LINENO: error: invalid value of canonical build" >&5
+echo "$as_me: error: invalid value of canonical build" >&2;}
+   { (exit 1); exit 1; }; };;
+esac
+build=$ac_cv_build
+ac_save_IFS=$IFS; IFS='-'
+set x $ac_cv_build
+shift
+build_cpu=$1
+build_vendor=$2
+shift; shift
+# Remember, the first character of IFS is used to create $*,
+# except with old shells:
+build_os=$*
+IFS=$ac_save_IFS
+case $build_os in *\ *) build_os=`echo "$build_os" | sed 's/ /-/g'`;; esac
+
+
+{ echo "$as_me:$LINENO: checking host system type" >&5
+echo $ECHO_N "checking host system type... $ECHO_C" >&6; }
+if test "${ac_cv_host+set}" = set; then
+  echo $ECHO_N "(cached) $ECHO_C" >&6
+else
+  if test "x$host_alias" = x; then
+  ac_cv_host=$ac_cv_build
+else
+  ac_cv_host=`$SHELL "$ac_aux_dir/config.sub" $host_alias` ||
+    { { echo "$as_me:$LINENO: error: $SHELL $ac_aux_dir/config.sub $host_alias failed" >&5
+echo "$as_me: error: $SHELL $ac_aux_dir/config.sub $host_alias failed" >&2;}
+   { (exit 1); exit 1; }; }
+fi
+
+fi
+{ echo "$as_me:$LINENO: result: $ac_cv_host" >&5
+echo "${ECHO_T}$ac_cv_host" >&6; }
+case $ac_cv_host in
+*-*-*) ;;
+*) { { echo "$as_me:$LINENO: error: invalid value of canonical host" >&5
+echo "$as_me: error: invalid value of canonical host" >&2;}
+   { (exit 1); exit 1; }; };;
+esac
+host=$ac_cv_host
+ac_save_IFS=$IFS; IFS='-'
+set x $ac_cv_host
+shift
+host_cpu=$1
+host_vendor=$2
+shift; shift
+# Remember, the first character of IFS is used to create $*,
+# except with old shells:
+host_os=$*
+IFS=$ac_save_IFS
+case $host_os in *\ *) host_os=`echo "$host_os" | sed 's/ /-/g'`;; esac
+
+
+
+      if test "X$prefix" = "XNONE"; then
+    acl_final_prefix="$ac_default_prefix"
+  else
+    acl_final_prefix="$prefix"
+  fi
+  if test "X$exec_prefix" = "XNONE"; then
+    acl_final_exec_prefix='${prefix}'
+  else
+    acl_final_exec_prefix="$exec_prefix"
+  fi
+  acl_save_prefix="$prefix"
+  prefix="$acl_final_prefix"
+  eval acl_final_exec_prefix=\"$acl_final_exec_prefix\"
+  prefix="$acl_save_prefix"
+
+
+# Check whether --with-gnu-ld was given.
+if test "${with_gnu_ld+set}" = set; then
+  withval=$with_gnu_ld; test "$withval" = no || with_gnu_ld=yes
+else
+  with_gnu_ld=no
+fi
+
+# Prepare PATH_SEPARATOR.
+# The user is always right.
+if test "${PATH_SEPARATOR+set}" != set; then
+  echo "#! /bin/sh" >conf$$.sh
+  echo  "exit 0"   >>conf$$.sh
+  chmod +x conf$$.sh
+  if (PATH="/nonexistent;."; conf$$.sh) >/dev/null 2>&1; then
+    PATH_SEPARATOR=';'
+  else
+    PATH_SEPARATOR=:
+  fi
+  rm -f conf$$.sh
+fi
+ac_prog=ld
+if test "$GCC" = yes; then
+  # Check if gcc -print-prog-name=ld gives a path.
+  { echo "$as_me:$LINENO: checking for ld used by GCC" >&5
+echo $ECHO_N "checking for ld used by GCC... $ECHO_C" >&6; }
+  case $host in
+  *-*-mingw*)
+    # gcc leaves a trailing carriage return which upsets mingw
+    ac_prog=`($CC -print-prog-name=ld) 2>&5 | tr -d '\015'` ;;
+  *)
+    ac_prog=`($CC -print-prog-name=ld) 2>&5` ;;
+  esac
+  case $ac_prog in
+    # Accept absolute paths.
+    [\\/]* | [A-Za-z]:[\\/]*)
+      re_direlt='/[^/][^/]*/\.\./'
+      # Canonicalize the path of ld
+      ac_prog=`echo $ac_prog| sed 's%\\\\%/%g'`
+      while echo $ac_prog | grep "$re_direlt" > /dev/null 2>&1; do
+	ac_prog=`echo $ac_prog| sed "s%$re_direlt%/%"`
+      done
+      test -z "$LD" && LD="$ac_prog"
+      ;;
+  "")
+    # If it fails, then pretend we aren't using GCC.
+    ac_prog=ld
+    ;;
+  *)
+    # If it is relative, then search for the first ld in PATH.
+    with_gnu_ld=unknown
+    ;;
+  esac
+elif test "$with_gnu_ld" = yes; then
+  { echo "$as_me:$LINENO: checking for GNU ld" >&5
+echo $ECHO_N "checking for GNU ld... $ECHO_C" >&6; }
+else
+  { echo "$as_me:$LINENO: checking for non-GNU ld" >&5
+echo $ECHO_N "checking for non-GNU ld... $ECHO_C" >&6; }
+fi
+if test "${acl_cv_path_LD+set}" = set; then
+  echo $ECHO_N "(cached) $ECHO_C" >&6
+else
+  if test -z "$LD"; then
+  IFS="${IFS= 	}"; ac_save_ifs="$IFS"; IFS="${IFS}${PATH_SEPARATOR-:}"
+  for ac_dir in $PATH; do
+    test -z "$ac_dir" && ac_dir=.
+    if test -f "$ac_dir/$ac_prog" || test -f "$ac_dir/$ac_prog$ac_exeext"; then
+      acl_cv_path_LD="$ac_dir/$ac_prog"
+      # Check to see if the program is GNU ld.  I'd rather use --version,
+      # but apparently some GNU ld's only accept -v.
+      # Break only if it was the GNU/non-GNU ld that we prefer.
+      case `"$acl_cv_path_LD" -v 2>&1 < /dev/null` in
+      *GNU* | *'with BFD'*)
+	test "$with_gnu_ld" != no && break ;;
       *)
-         { { echo "$as_me:$LINENO: error: Unknown driver '$driver'" >&5
-echo "$as_me: error: Unknown driver '$driver'" >&2;}
+	test "$with_gnu_ld" != yes && break ;;
+      esac
+    fi
+  done
+  IFS="$ac_save_ifs"
+else
+  acl_cv_path_LD="$LD" # Let the user override the test with a path.
+fi
+fi
+
+LD="$acl_cv_path_LD"
+if test -n "$LD"; then
+  { echo "$as_me:$LINENO: result: $LD" >&5
+echo "${ECHO_T}$LD" >&6; }
+else
+  { echo "$as_me:$LINENO: result: no" >&5
+echo "${ECHO_T}no" >&6; }
+fi
+test -z "$LD" && { { echo "$as_me:$LINENO: error: no acceptable ld found in \$PATH" >&5
+echo "$as_me: error: no acceptable ld found in \$PATH" >&2;}
    { (exit 1); exit 1; }; }
-         ;;
-   esac
-done
+{ echo "$as_me:$LINENO: checking if the linker ($LD) is GNU ld" >&5
+echo $ECHO_N "checking if the linker ($LD) is GNU ld... $ECHO_C" >&6; }
+if test "${acl_cv_prog_gnu_ld+set}" = set; then
+  echo $ECHO_N "(cached) $ECHO_C" >&6
+else
+  # I'd rather use --version here, but apparently some GNU ld's only accept -v.
+case `$LD -v 2>&1 </dev/null` in
+*GNU* | *'with BFD'*)
+  acl_cv_prog_gnu_ld=yes ;;
+*)
+  acl_cv_prog_gnu_ld=no ;;
+esac
+fi
+{ echo "$as_me:$LINENO: result: $acl_cv_prog_gnu_ld" >&5
+echo "${ECHO_T}$acl_cv_prog_gnu_ld" >&6; }
+with_gnu_ld=$acl_cv_prog_gnu_ld
 
-echo "$as_me:$LINENO: result: done" >&5
-echo "${ECHO_T}done" >&6
 
 
-# generic display drivers
-TEXT="no"
-GRAPHIC="no"
-IMAGE="no"
 
-# generiv I/O drivers
-PARPORT="no"
-SERIAL="no"
-I2C="no"
+                                                { echo "$as_me:$LINENO: checking for shared library run path origin" >&5
+echo $ECHO_N "checking for shared library run path origin... $ECHO_C" >&6; }
+if test "${acl_cv_rpath+set}" = set; then
+  echo $ECHO_N "(cached) $ECHO_C" >&6
+else
 
+    CC="$CC" GCC="$GCC" LDFLAGS="$LDFLAGS" LD="$LD" with_gnu_ld="$with_gnu_ld" \
+    ${CONFIG_SHELL-/bin/sh} "$ac_aux_dir/config.rpath" "$host" > conftest.sh
+    . ./conftest.sh
+    rm -f ./conftest.sh
+    acl_cv_rpath=done
 
-if test "$BECKMANNEGLE" = "yes"; then
-   TEXT="yes"
-   SERIAL="yes"
-   DRIVERS="$DRIVERS drv_BeckmannEgle.o"
+fi
+{ echo "$as_me:$LINENO: result: $acl_cv_rpath" >&5
+echo "${ECHO_T}$acl_cv_rpath" >&6; }
+  wl="$acl_cv_wl"
+  acl_libext="$acl_cv_libext"
+  acl_shlibext="$acl_cv_shlibext"
+  acl_libname_spec="$acl_cv_libname_spec"
+  acl_library_names_spec="$acl_cv_library_names_spec"
+  acl_hardcode_libdir_flag_spec="$acl_cv_hardcode_libdir_flag_spec"
+  acl_hardcode_libdir_separator="$acl_cv_hardcode_libdir_separator"
+  acl_hardcode_direct="$acl_cv_hardcode_direct"
+  acl_hardcode_minus_L="$acl_cv_hardcode_minus_L"
+    # Check whether --enable-rpath was given.
+if test "${enable_rpath+set}" = set; then
+  enableval=$enable_rpath; :
+else
+  enable_rpath=yes
+fi
 
-cat >>confdefs.h <<\_ACEOF
-#define WITH_BECKMANNEGLE 1
-_ACEOF
 
-fi
 
-if test "$BWCT" = "yes"; then
-   if test "$has_usb" = "true"; then
-      TEXT="yes"
-      DRIVERS="$DRIVERS drv_BWCT.o"
-      DRVLIBS="$DRVLIBS -lusb"
+                  acl_libdirstem=lib
+  searchpath=`(LC_ALL=C $CC -print-search-dirs) 2>/dev/null | sed -n -e 's,^libraries: ,,p' | sed -e 's,^=,,'`
+  if test -n "$searchpath"; then
+    acl_save_IFS="${IFS= 	}"; IFS=":"
+    for searchdir in $searchpath; do
+      if test -d "$searchdir"; then
+        case "$searchdir" in
+          */lib64/ | */lib64 ) acl_libdirstem=lib64 ;;
+          *) searchdir=`cd "$searchdir" && pwd`
+             case "$searchdir" in
+               */lib64 ) acl_libdirstem=lib64 ;;
+             esac ;;
+        esac
+      fi
+    done
+    IFS="$acl_save_IFS"
+  fi
 
-cat >>confdefs.h <<\_ACEOF
-#define WITH_BWCT 1
-_ACEOF
 
-   else
-      { echo "$as_me:$LINENO: WARNING: usb.h not found: BWCT driver disabled" >&5
-echo "$as_me: WARNING: usb.h not found: BWCT driver disabled" >&2;}
-   fi
-fi
 
-if test "$CRYSTALFONTZ" = "yes"; then
-   TEXT="yes"
-   SERIAL="yes"
-   DRIVERS="$DRIVERS drv_Crystalfontz.o"
 
-cat >>confdefs.h <<\_ACEOF
-#define WITH_CRYSTALFONTZ 1
-_ACEOF
 
-fi
 
-if test "$CURSES" = "yes"; then
-   if test "$has_curses" = true; then
-      DRIVERS="$DRIVERS drv_Curses.o"
-      DRVLIBS="$DRVLIBS $CURSES_LIBS"
-      CPPFLAGS="$CPPFLAGS $CURSES_INCLUDES"
 
-cat >>confdefs.h <<\_ACEOF
-#define WITH_CURSES 1
-_ACEOF
 
-   else
-      { echo "$as_me:$LINENO: WARNING: curses not found: Curses driver disabled" >&5
-echo "$as_me: WARNING: curses not found: Curses driver disabled" >&2;}
-   fi
+
+    use_additional=yes
+
+  acl_save_prefix="$prefix"
+  prefix="$acl_final_prefix"
+  acl_save_exec_prefix="$exec_prefix"
+  exec_prefix="$acl_final_exec_prefix"
+
+    eval additional_includedir=\"$includedir\"
+    eval additional_libdir=\"$libdir\"
+
+  exec_prefix="$acl_save_exec_prefix"
+  prefix="$acl_save_prefix"
+
+
+# Check whether --with-libiconv-prefix was given.
+if test "${with_libiconv_prefix+set}" = set; then
+  withval=$with_libiconv_prefix;
+    if test "X$withval" = "Xno"; then
+      use_additional=no
+    else
+      if test "X$withval" = "X"; then
+
+  acl_save_prefix="$prefix"
+  prefix="$acl_final_prefix"
+  acl_save_exec_prefix="$exec_prefix"
+  exec_prefix="$acl_final_exec_prefix"
+
+          eval additional_includedir=\"$includedir\"
+          eval additional_libdir=\"$libdir\"
+
+  exec_prefix="$acl_save_exec_prefix"
+  prefix="$acl_save_prefix"
+
+      else
+        additional_includedir="$withval/include"
+        additional_libdir="$withval/$acl_libdirstem"
+      fi
+    fi
+
 fi
 
-if test "$CWLINUX" = "yes"; then
-   TEXT="yes"
-   SERIAL="yes"
-   DRIVERS="$DRIVERS drv_Cwlinux.o"
+      LIBICONV=
+  LTLIBICONV=
+  INCICONV=
+  LIBICONV_PREFIX=
+  rpathdirs=
+  ltrpathdirs=
+  names_already_handled=
+  names_next_round='iconv '
+  while test -n "$names_next_round"; do
+    names_this_round="$names_next_round"
+    names_next_round=
+    for name in $names_this_round; do
+      already_handled=
+      for n in $names_already_handled; do
+        if test "$n" = "$name"; then
+          already_handled=yes
+          break
+        fi
+      done
+      if test -z "$already_handled"; then
+        names_already_handled="$names_already_handled $name"
+                        uppername=`echo "$name" | sed -e 'y|abcdefghijklmnopqrstuvwxyz./-|ABCDEFGHIJKLMNOPQRSTUVWXYZ___|'`
+        eval value=\"\$HAVE_LIB$uppername\"
+        if test -n "$value"; then
+          if test "$value" = yes; then
+            eval value=\"\$LIB$uppername\"
+            test -z "$value" || LIBICONV="${LIBICONV}${LIBICONV:+ }$value"
+            eval value=\"\$LTLIB$uppername\"
+            test -z "$value" || LTLIBICONV="${LTLIBICONV}${LTLIBICONV:+ }$value"
+          else
+                                    :
+          fi
+        else
+                              found_dir=
+          found_la=
+          found_so=
+          found_a=
+          eval libname=\"$acl_libname_spec\"    # typically: libname=lib$name
+          if test -n "$acl_shlibext"; then
+            shrext=".$acl_shlibext"             # typically: shrext=.so
+          else
+            shrext=
+          fi
+          if test $use_additional = yes; then
+            dir="$additional_libdir"
+                                    if test -n "$acl_shlibext"; then
+              if test -f "$dir/$libname$shrext"; then
+                found_dir="$dir"
+                found_so="$dir/$libname$shrext"
+              else
+                if test "$acl_library_names_spec" = '$libname$shrext$versuffix'; then
+                  ver=`(cd "$dir" && \
+                        for f in "$libname$shrext".*; do echo "$f"; done \
+                        | sed -e "s,^$libname$shrext\\\\.,," \
+                        | sort -t '.' -n -r -k1,1 -k2,2 -k3,3 -k4,4 -k5,5 \
+                        | sed 1q ) 2>/dev/null`
+                  if test -n "$ver" && test -f "$dir/$libname$shrext.$ver"; then
+                    found_dir="$dir"
+                    found_so="$dir/$libname$shrext.$ver"
+                  fi
+                else
+                  eval library_names=\"$acl_library_names_spec\"
+                  for f in $library_names; do
+                    if test -f "$dir/$f"; then
+                      found_dir="$dir"
+                      found_so="$dir/$f"
+                      break
+                    fi
+                  done
+                fi
+              fi
+            fi
+                        if test "X$found_dir" = "X"; then
+              if test -f "$dir/$libname.$acl_libext"; then
+                found_dir="$dir"
+                found_a="$dir/$libname.$acl_libext"
+              fi
+            fi
+            if test "X$found_dir" != "X"; then
+              if test -f "$dir/$libname.la"; then
+                found_la="$dir/$libname.la"
+              fi
+            fi
+          fi
+          if test "X$found_dir" = "X"; then
+            for x in $LDFLAGS $LTLIBICONV; do
+
+  acl_save_prefix="$prefix"
+  prefix="$acl_final_prefix"
+  acl_save_exec_prefix="$exec_prefix"
+  exec_prefix="$acl_final_exec_prefix"
+  eval x=\"$x\"
+  exec_prefix="$acl_save_exec_prefix"
+  prefix="$acl_save_prefix"
+
+              case "$x" in
+                -L*)
+                  dir=`echo "X$x" | sed -e 's/^X-L//'`
+                                    if test -n "$acl_shlibext"; then
+                    if test -f "$dir/$libname$shrext"; then
+                      found_dir="$dir"
+                      found_so="$dir/$libname$shrext"
+                    else
+                      if test "$acl_library_names_spec" = '$libname$shrext$versuffix'; then
+                        ver=`(cd "$dir" && \
+                              for f in "$libname$shrext".*; do echo "$f"; done \
+                              | sed -e "s,^$libname$shrext\\\\.,," \
+                              | sort -t '.' -n -r -k1,1 -k2,2 -k3,3 -k4,4 -k5,5 \
+                              | sed 1q ) 2>/dev/null`
+                        if test -n "$ver" && test -f "$dir/$libname$shrext.$ver"; then
+                          found_dir="$dir"
+                          found_so="$dir/$libname$shrext.$ver"
+                        fi
+                      else
+                        eval library_names=\"$acl_library_names_spec\"
+                        for f in $library_names; do
+                          if test -f "$dir/$f"; then
+                            found_dir="$dir"
+                            found_so="$dir/$f"
+                            break
+                          fi
+                        done
+                      fi
+                    fi
+                  fi
+                                    if test "X$found_dir" = "X"; then
+                    if test -f "$dir/$libname.$acl_libext"; then
+                      found_dir="$dir"
+                      found_a="$dir/$libname.$acl_libext"
+                    fi
+                  fi
+                  if test "X$found_dir" != "X"; then
+                    if test -f "$dir/$libname.la"; then
+                      found_la="$dir/$libname.la"
+                    fi
+                  fi
+                  ;;
+              esac
+              if test "X$found_dir" != "X"; then
+                break
+              fi
+            done
+          fi
+          if test "X$found_dir" != "X"; then
+                        LTLIBICONV="${LTLIBICONV}${LTLIBICONV:+ }-L$found_dir -l$name"
+            if test "X$found_so" != "X"; then
+                                                        if test "$enable_rpath" = no || test "X$found_dir" = "X/usr/$acl_libdirstem"; then
+                                LIBICONV="${LIBICONV}${LIBICONV:+ }$found_so"
+              else
+                                                                                haveit=
+                for x in $ltrpathdirs; do
+                  if test "X$x" = "X$found_dir"; then
+                    haveit=yes
+                    break
+                  fi
+                done
+                if test -z "$haveit"; then
+                  ltrpathdirs="$ltrpathdirs $found_dir"
+                fi
+                                if test "$acl_hardcode_direct" = yes; then
+                                                      LIBICONV="${LIBICONV}${LIBICONV:+ }$found_so"
+                else
+                  if test -n "$acl_hardcode_libdir_flag_spec" && test "$acl_hardcode_minus_L" = no; then
+                                                            LIBICONV="${LIBICONV}${LIBICONV:+ }$found_so"
+                                                            haveit=
+                    for x in $rpathdirs; do
+                      if test "X$x" = "X$found_dir"; then
+                        haveit=yes
+                        break
+                      fi
+                    done
+                    if test -z "$haveit"; then
+                      rpathdirs="$rpathdirs $found_dir"
+                    fi
+                  else
+                                                                                haveit=
+                    for x in $LDFLAGS $LIBICONV; do
+
+  acl_save_prefix="$prefix"
+  prefix="$acl_final_prefix"
+  acl_save_exec_prefix="$exec_prefix"
+  exec_prefix="$acl_final_exec_prefix"
+  eval x=\"$x\"
+  exec_prefix="$acl_save_exec_prefix"
+  prefix="$acl_save_prefix"
+
+                      if test "X$x" = "X-L$found_dir"; then
+                        haveit=yes
+                        break
+                      fi
+                    done
+                    if test -z "$haveit"; then
+                      LIBICONV="${LIBICONV}${LIBICONV:+ }-L$found_dir"
+                    fi
+                    if test "$acl_hardcode_minus_L" != no; then
+                                                                                        LIBICONV="${LIBICONV}${LIBICONV:+ }$found_so"
+                    else
+                                                                                                                                                                                LIBICONV="${LIBICONV}${LIBICONV:+ }-l$name"
+                    fi
+                  fi
+                fi
+              fi
+            else
+              if test "X$found_a" != "X"; then
+                                LIBICONV="${LIBICONV}${LIBICONV:+ }$found_a"
+              else
+                                                LIBICONV="${LIBICONV}${LIBICONV:+ }-L$found_dir -l$name"
+              fi
+            fi
+                        additional_includedir=
+            case "$found_dir" in
+              */$acl_libdirstem | */$acl_libdirstem/)
+                basedir=`echo "X$found_dir" | sed -e 's,^X,,' -e "s,/$acl_libdirstem/"'*$,,'`
+                LIBICONV_PREFIX="$basedir"
+                additional_includedir="$basedir/include"
+                ;;
+            esac
+            if test "X$additional_includedir" != "X"; then
+                                                                                                                if test "X$additional_includedir" != "X/usr/include"; then
+                haveit=
+                if test "X$additional_includedir" = "X/usr/local/include"; then
+                  if test -n "$GCC"; then
+                    case $host_os in
+                      linux* | gnu* | k*bsd*-gnu) haveit=yes;;
+                    esac
+                  fi
+                fi
+                if test -z "$haveit"; then
+                  for x in $CPPFLAGS $INCICONV; do
+
+  acl_save_prefix="$prefix"
+  prefix="$acl_final_prefix"
+  acl_save_exec_prefix="$exec_prefix"
+  exec_prefix="$acl_final_exec_prefix"
+  eval x=\"$x\"
+  exec_prefix="$acl_save_exec_prefix"
+  prefix="$acl_save_prefix"
+
+                    if test "X$x" = "X-I$additional_includedir"; then
+                      haveit=yes
+                      break
+                    fi
+                  done
+                  if test -z "$haveit"; then
+                    if test -d "$additional_includedir"; then
+                                            INCICONV="${INCICONV}${INCICONV:+ }-I$additional_includedir"
+                    fi
+                  fi
+                fi
+              fi
+            fi
+                        if test -n "$found_la"; then
+                                                        save_libdir="$libdir"
+              case "$found_la" in
+                */* | *\\*) . "$found_la" ;;
+                *) . "./$found_la" ;;
+              esac
+              libdir="$save_libdir"
+                            for dep in $dependency_libs; do
+                case "$dep" in
+                  -L*)
+                    additional_libdir=`echo "X$dep" | sed -e 's/^X-L//'`
+                                                                                                                                                                if test "X$additional_libdir" != "X/usr/$acl_libdirstem"; then
+                      haveit=
+                      if test "X$additional_libdir" = "X/usr/local/$acl_libdirstem"; then
+                        if test -n "$GCC"; then
+                          case $host_os in
+                            linux* | gnu* | k*bsd*-gnu) haveit=yes;;
+                          esac
+                        fi
+                      fi
+                      if test -z "$haveit"; then
+                        haveit=
+                        for x in $LDFLAGS $LIBICONV; do
+
+  acl_save_prefix="$prefix"
+  prefix="$acl_final_prefix"
+  acl_save_exec_prefix="$exec_prefix"
+  exec_prefix="$acl_final_exec_prefix"
+  eval x=\"$x\"
+  exec_prefix="$acl_save_exec_prefix"
+  prefix="$acl_save_prefix"
+
+                          if test "X$x" = "X-L$additional_libdir"; then
+                            haveit=yes
+                            break
+                          fi
+                        done
+                        if test -z "$haveit"; then
+                          if test -d "$additional_libdir"; then
+                                                        LIBICONV="${LIBICONV}${LIBICONV:+ }-L$additional_libdir"
+                          fi
+                        fi
+                        haveit=
+                        for x in $LDFLAGS $LTLIBICONV; do
+
+  acl_save_prefix="$prefix"
+  prefix="$acl_final_prefix"
+  acl_save_exec_prefix="$exec_prefix"
+  exec_prefix="$acl_final_exec_prefix"
+  eval x=\"$x\"
+  exec_prefix="$acl_save_exec_prefix"
+  prefix="$acl_save_prefix"
+
+                          if test "X$x" = "X-L$additional_libdir"; then
+                            haveit=yes
+                            break
+                          fi
+                        done
+                        if test -z "$haveit"; then
+                          if test -d "$additional_libdir"; then
+                                                        LTLIBICONV="${LTLIBICONV}${LTLIBICONV:+ }-L$additional_libdir"
+                          fi
+                        fi
+                      fi
+                    fi
+                    ;;
+                  -R*)
+                    dir=`echo "X$dep" | sed -e 's/^X-R//'`
+                    if test "$enable_rpath" != no; then
+                                                                  haveit=
+                      for x in $rpathdirs; do
+                        if test "X$x" = "X$dir"; then
+                          haveit=yes
+                          break
+                        fi
+                      done
+                      if test -z "$haveit"; then
+                        rpathdirs="$rpathdirs $dir"
+                      fi
+                                                                  haveit=
+                      for x in $ltrpathdirs; do
+                        if test "X$x" = "X$dir"; then
+                          haveit=yes
+                          break
+                        fi
+                      done
+                      if test -z "$haveit"; then
+                        ltrpathdirs="$ltrpathdirs $dir"
+                      fi
+                    fi
+                    ;;
+                  -l*)
+                                        names_next_round="$names_next_round "`echo "X$dep" | sed -e 's/^X-l//'`
+                    ;;
+                  *.la)
+                                                                                names_next_round="$names_next_round "`echo "X$dep" | sed -e 's,^X.*/,,' -e 's,^lib,,' -e 's,\.la$,,'`
+                    ;;
+                  *)
+                                        LIBICONV="${LIBICONV}${LIBICONV:+ }$dep"
+                    LTLIBICONV="${LTLIBICONV}${LTLIBICONV:+ }$dep"
+                    ;;
+                esac
+              done
+            fi
+          else
+                                                            LIBICONV="${LIBICONV}${LIBICONV:+ }-l$name"
+            LTLIBICONV="${LTLIBICONV}${LTLIBICONV:+ }-l$name"
+          fi
+        fi
+      fi
+    done
+  done
+  if test "X$rpathdirs" != "X"; then
+    if test -n "$acl_hardcode_libdir_separator"; then
+                        alldirs=
+      for found_dir in $rpathdirs; do
+        alldirs="${alldirs}${alldirs:+$acl_hardcode_libdir_separator}$found_dir"
+      done
+            acl_save_libdir="$libdir"
+      libdir="$alldirs"
+      eval flag=\"$acl_hardcode_libdir_flag_spec\"
+      libdir="$acl_save_libdir"
+      LIBICONV="${LIBICONV}${LIBICONV:+ }$flag"
+    else
+            for found_dir in $rpathdirs; do
+        acl_save_libdir="$libdir"
+        libdir="$found_dir"
+        eval flag=\"$acl_hardcode_libdir_flag_spec\"
+        libdir="$acl_save_libdir"
+        LIBICONV="${LIBICONV}${LIBICONV:+ }$flag"
+      done
+    fi
+  fi
+  if test "X$ltrpathdirs" != "X"; then
+            for found_dir in $ltrpathdirs; do
+      LTLIBICONV="${LTLIBICONV}${LTLIBICONV:+ }-R$found_dir"
+    done
+  fi
 
-cat >>confdefs.h <<\_ACEOF
-#define WITH_CWLINUX 1
+
+
+
+
+
+
+          am_save_CPPFLAGS="$CPPFLAGS"
+
+  for element in $INCICONV; do
+    haveit=
+    for x in $CPPFLAGS; do
+
+  acl_save_prefix="$prefix"
+  prefix="$acl_final_prefix"
+  acl_save_exec_prefix="$exec_prefix"
+  exec_prefix="$acl_final_exec_prefix"
+  eval x=\"$x\"
+  exec_prefix="$acl_save_exec_prefix"
+  prefix="$acl_save_prefix"
+
+      if test "X$x" = "X$element"; then
+        haveit=yes
+        break
+      fi
+    done
+    if test -z "$haveit"; then
+      CPPFLAGS="${CPPFLAGS}${CPPFLAGS:+ }$element"
+    fi
+  done
+
+
+  { echo "$as_me:$LINENO: checking for iconv" >&5
+echo $ECHO_N "checking for iconv... $ECHO_C" >&6; }
+if test "${am_cv_func_iconv+set}" = set; then
+  echo $ECHO_N "(cached) $ECHO_C" >&6
+else
+
+    am_cv_func_iconv="no, consider installing GNU libiconv"
+    am_cv_lib_iconv=no
+    cat >conftest.$ac_ext <<_ACEOF
+/* confdefs.h.  */
+_ACEOF
+cat confdefs.h >>conftest.$ac_ext
+cat >>conftest.$ac_ext <<_ACEOF
+/* end confdefs.h.  */
+#include <stdlib.h>
+#include <iconv.h>
+int
+main ()
+{
+iconv_t cd = iconv_open("","");
+       iconv(cd,NULL,NULL,NULL,NULL);
+       iconv_close(cd);
+  ;
+  return 0;
+}
 _ACEOF
+rm -f conftest.$ac_objext conftest$ac_exeext
+if { (ac_try="$ac_link"
+case "(($ac_try" in
+  *\"* | *\`* | *\\*) ac_try_echo=\$ac_try;;
+  *) ac_try_echo=$ac_try;;
+esac
+eval "echo \"\$as_me:$LINENO: $ac_try_echo\"") >&5
+  (eval "$ac_link") 2>conftest.er1
+  ac_status=$?
+  grep -v '^ *+' conftest.er1 >conftest.err
+  rm -f conftest.er1
+  cat conftest.err >&5
+  echo "$as_me:$LINENO: \$? = $ac_status" >&5
+  (exit $ac_status); } && {
+	 test -z "$ac_c_werror_flag" ||
+	 test ! -s conftest.err
+       } && test -s conftest$ac_exeext &&
+       $as_test_x conftest$ac_exeext; then
+  am_cv_func_iconv=yes
+else
+  echo "$as_me: failed program was:" >&5
+sed 's/^/| /' conftest.$ac_ext >&5
 
-fi
 
-if test "$HD44780" = "yes"; then
-   TEXT="yes"
-   PARPORT="yes"
-   I2C="yes"
-   DRIVERS="$DRIVERS drv_HD44780.o"
+fi
 
-cat >>confdefs.h <<\_ACEOF
-#define WITH_HD44780 1
+rm -f core conftest.err conftest.$ac_objext conftest_ipa8_conftest.oo \
+      conftest$ac_exeext conftest.$ac_ext
+    if test "$am_cv_func_iconv" != yes; then
+      am_save_LIBS="$LIBS"
+      LIBS="$LIBS $LIBICONV"
+      cat >conftest.$ac_ext <<_ACEOF
+/* confdefs.h.  */
+_ACEOF
+cat confdefs.h >>conftest.$ac_ext
+cat >>conftest.$ac_ext <<_ACEOF
+/* end confdefs.h.  */
+#include <stdlib.h>
+#include <iconv.h>
+int
+main ()
+{
+iconv_t cd = iconv_open("","");
+         iconv(cd,NULL,NULL,NULL,NULL);
+         iconv_close(cd);
+  ;
+  return 0;
+}
 _ACEOF
+rm -f conftest.$ac_objext conftest$ac_exeext
+if { (ac_try="$ac_link"
+case "(($ac_try" in
+  *\"* | *\`* | *\\*) ac_try_echo=\$ac_try;;
+  *) ac_try_echo=$ac_try;;
+esac
+eval "echo \"\$as_me:$LINENO: $ac_try_echo\"") >&5
+  (eval "$ac_link") 2>conftest.er1
+  ac_status=$?
+  grep -v '^ *+' conftest.er1 >conftest.err
+  rm -f conftest.er1
+  cat conftest.err >&5
+  echo "$as_me:$LINENO: \$? = $ac_status" >&5
+  (exit $ac_status); } && {
+	 test -z "$ac_c_werror_flag" ||
+	 test ! -s conftest.err
+       } && test -s conftest$ac_exeext &&
+       $as_test_x conftest$ac_exeext; then
+  am_cv_lib_iconv=yes
+        am_cv_func_iconv=yes
+else
+  echo "$as_me: failed program was:" >&5
+sed 's/^/| /' conftest.$ac_ext >&5
+
 
 fi
 
-if test "$LCDLINUX" = "yes"; then
-   TEXT="yes"
-   DRIVERS="$DRIVERS drv_LCDLinux.o"
+rm -f core conftest.err conftest.$ac_objext conftest_ipa8_conftest.oo \
+      conftest$ac_exeext conftest.$ac_ext
+      LIBS="$am_save_LIBS"
+    fi
 
-cat >>confdefs.h <<\_ACEOF
-#define WITH_LCDLINUX 1
+fi
+{ echo "$as_me:$LINENO: result: $am_cv_func_iconv" >&5
+echo "${ECHO_T}$am_cv_func_iconv" >&6; }
+  if test "$am_cv_func_iconv" = yes; then
+    { echo "$as_me:$LINENO: checking for working iconv" >&5
+echo $ECHO_N "checking for working iconv... $ECHO_C" >&6; }
+if test "${am_cv_func_iconv_works+set}" = set; then
+  echo $ECHO_N "(cached) $ECHO_C" >&6
+else
+
+            am_save_LIBS="$LIBS"
+      if test $am_cv_lib_iconv = yes; then
+        LIBS="$LIBS $LIBICONV"
+      fi
+      if test "$cross_compiling" = yes; then
+  case "$host_os" in
+           aix* | hpux*) am_cv_func_iconv_works="guessing no" ;;
+           *)            am_cv_func_iconv_works="guessing yes" ;;
+         esac
+else
+  cat >conftest.$ac_ext <<_ACEOF
+/* confdefs.h.  */
 _ACEOF
+cat confdefs.h >>conftest.$ac_ext
+cat >>conftest.$ac_ext <<_ACEOF
+/* end confdefs.h.  */
+
+#include <iconv.h>
+#include <string.h>
+int main ()
+{
+  /* Test against AIX 5.1 bug: Failures are not distinguishable from successful
+     returns.  */
+  {
+    iconv_t cd_utf8_to_88591 = iconv_open ("ISO8859-1", "UTF-8");
+    if (cd_utf8_to_88591 != (iconv_t)(-1))
+      {
+        static const char input[] = "\342\202\254"; /* EURO SIGN */
+        char buf[10];
+        const char *inptr = input;
+        size_t inbytesleft = strlen (input);
+        char *outptr = buf;
+        size_t outbytesleft = sizeof (buf);
+        size_t res = iconv (cd_utf8_to_88591,
+                            (char **) &inptr, &inbytesleft,
+                            &outptr, &outbytesleft);
+        if (res == 0)
+          return 1;
+      }
+  }
+#if 0 /* This bug could be worked around by the caller.  */
+  /* Test against HP-UX 11.11 bug: Positive return value instead of 0.  */
+  {
+    iconv_t cd_88591_to_utf8 = iconv_open ("utf8", "iso88591");
+    if (cd_88591_to_utf8 != (iconv_t)(-1))
+      {
+        static const char input[] = "\304rger mit b\366sen B\374bchen ohne Augenma\337";
+        char buf[50];
+        const char *inptr = input;
+        size_t inbytesleft = strlen (input);
+        char *outptr = buf;
+        size_t outbytesleft = sizeof (buf);
+        size_t res = iconv (cd_88591_to_utf8,
+                            (char **) &inptr, &inbytesleft,
+                            &outptr, &outbytesleft);
+        if ((int)res > 0)
+          return 1;
+      }
+  }
+#endif
+  /* Test against HP-UX 11.11 bug: No converter from EUC-JP to UTF-8 is
+     provided.  */
+  if (/* Try standardized names.  */
+      iconv_open ("UTF-8", "EUC-JP") == (iconv_t)(-1)
+      /* Try IRIX, OSF/1 names.  */
+      && iconv_open ("UTF-8", "eucJP") == (iconv_t)(-1)
+      /* Try AIX names.  */
+      && iconv_open ("UTF-8", "IBM-eucJP") == (iconv_t)(-1)
+      /* Try HP-UX names.  */
+      && iconv_open ("utf8", "eucJP") == (iconv_t)(-1))
+    return 1;
+  return 0;
+}
+_ACEOF
+rm -f conftest$ac_exeext
+if { (ac_try="$ac_link"
+case "(($ac_try" in
+  *\"* | *\`* | *\\*) ac_try_echo=\$ac_try;;
+  *) ac_try_echo=$ac_try;;
+esac
+eval "echo \"\$as_me:$LINENO: $ac_try_echo\"") >&5
+  (eval "$ac_link") 2>&5
+  ac_status=$?
+  echo "$as_me:$LINENO: \$? = $ac_status" >&5
+  (exit $ac_status); } && { ac_try='./conftest$ac_exeext'
+  { (case "(($ac_try" in
+  *\"* | *\`* | *\\*) ac_try_echo=\$ac_try;;
+  *) ac_try_echo=$ac_try;;
+esac
+eval "echo \"\$as_me:$LINENO: $ac_try_echo\"") >&5
+  (eval "$ac_try") 2>&5
+  ac_status=$?
+  echo "$as_me:$LINENO: \$? = $ac_status" >&5
+  (exit $ac_status); }; }; then
+  am_cv_func_iconv_works=yes
+else
+  echo "$as_me: program exited with status $ac_status" >&5
+echo "$as_me: failed program was:" >&5
+sed 's/^/| /' conftest.$ac_ext >&5
 
+( exit $ac_status )
+am_cv_func_iconv_works=no
+fi
+rm -f core *.core core.conftest.* gmon.out bb.out conftest$ac_exeext conftest.$ac_objext conftest.$ac_ext
 fi
 
-if test "$LCDTERM" = "yes"; then
-   TEXT="yes"
-   SERIAL="yes"
-   DRIVERS="$DRIVERS drv_LCDTerm.o"
 
-cat >>confdefs.h <<\_ACEOF
-#define WITH_LCDTERM 1
-_ACEOF
+      LIBS="$am_save_LIBS"
 
 fi
-
-if test "$M50530" = "yes"; then
-   TEXT="yes"
-   PARPORT="yes"
-   DRIVERS="$DRIVERS drv_M50530.o"
+{ echo "$as_me:$LINENO: result: $am_cv_func_iconv_works" >&5
+echo "${ECHO_T}$am_cv_func_iconv_works" >&6; }
+    case "$am_cv_func_iconv_works" in
+      *no) am_func_iconv=no am_cv_lib_iconv=no ;;
+      *)   am_func_iconv=yes ;;
+    esac
+  else
+    am_func_iconv=no am_cv_lib_iconv=no
+  fi
+  if test "$am_func_iconv" = yes; then
 
 cat >>confdefs.h <<\_ACEOF
-#define WITH_M50530 1
+#define HAVE_ICONV 1
 _ACEOF
 
-fi
-
-if test "$MATRIXORBITAL" = "yes"; then
-   SERIAL="yes"
-   DRIVERS="$DRIVERS drv_MatrixOrbital.o"
+  fi
+  if test "$am_cv_lib_iconv" = yes; then
+    { echo "$as_me:$LINENO: checking how to link with libiconv" >&5
+echo $ECHO_N "checking how to link with libiconv... $ECHO_C" >&6; }
+    { echo "$as_me:$LINENO: result: $LIBICONV" >&5
+echo "${ECHO_T}$LIBICONV" >&6; }
+  else
+            CPPFLAGS="$am_save_CPPFLAGS"
+    LIBICONV=
+    LTLIBICONV=
+  fi
 
-cat >>confdefs.h <<\_ACEOF
-#define WITH_MATRIXORBITAL 1
-_ACEOF
 
-fi
 
-if test "$MILINST" = "yes"; then
-   DRIVERS="$DRIVERS drv_MilfordInstruments.o"
+  if test "$am_cv_func_iconv" = yes; then
+    { echo "$as_me:$LINENO: checking for iconv declaration" >&5
+echo $ECHO_N "checking for iconv declaration... $ECHO_C" >&6; }
+    if test "${am_cv_proto_iconv+set}" = set; then
+  echo $ECHO_N "(cached) $ECHO_C" >&6
+else
 
-cat >>confdefs.h <<\_ACEOF
-#define WITH_MILINST 1
+      cat >conftest.$ac_ext <<_ACEOF
+/* confdefs.h.  */
 _ACEOF
+cat confdefs.h >>conftest.$ac_ext
+cat >>conftest.$ac_ext <<_ACEOF
+/* end confdefs.h.  */
 
-fi
+#include <stdlib.h>
+#include <iconv.h>
+extern
+#ifdef __cplusplus
+"C"
+#endif
+#if defined(__STDC__) || defined(__cplusplus)
+size_t iconv (iconv_t cd, char * *inbuf, size_t *inbytesleft, char * *outbuf, size_t *outbytesleft);
+#else
+size_t iconv();
+#endif
 
-if test "$NORITAKE" = "yes"; then
-   TEXT="yes"
-   GRAPHIC="yes"
-   PARPORT="yes"
-   DRIVERS="$DRIVERS drv_Noritake.o"
+int
+main ()
+{
 
-cat >>confdefs.h <<\_ACEOF
-#define WITH_NORITAKE 1
+  ;
+  return 0;
+}
 _ACEOF
+rm -f conftest.$ac_objext
+if { (ac_try="$ac_compile"
+case "(($ac_try" in
+  *\"* | *\`* | *\\*) ac_try_echo=\$ac_try;;
+  *) ac_try_echo=$ac_try;;
+esac
+eval "echo \"\$as_me:$LINENO: $ac_try_echo\"") >&5
+  (eval "$ac_compile") 2>conftest.er1
+  ac_status=$?
+  grep -v '^ *+' conftest.er1 >conftest.err
+  rm -f conftest.er1
+  cat conftest.err >&5
+  echo "$as_me:$LINENO: \$? = $ac_status" >&5
+  (exit $ac_status); } && {
+	 test -z "$ac_c_werror_flag" ||
+	 test ! -s conftest.err
+       } && test -s conftest.$ac_objext; then
+  am_cv_proto_iconv_arg1=""
+else
+  echo "$as_me: failed program was:" >&5
+sed 's/^/| /' conftest.$ac_ext >&5
 
+	am_cv_proto_iconv_arg1="const"
 fi
 
-if test "$NULL" = "yes"; then
-   DRIVERS="$DRIVERS drv_NULL.o"
+rm -f core conftest.err conftest.$ac_objext conftest.$ac_ext
+      am_cv_proto_iconv="extern size_t iconv (iconv_t cd, $am_cv_proto_iconv_arg1 char * *inbuf, size_t *inbytesleft, char * *outbuf, size_t *outbytesleft);"
+fi
 
-cat >>confdefs.h <<\_ACEOF
-#define WITH_NULL 1
+    am_cv_proto_iconv=`echo "$am_cv_proto_iconv" | tr -s ' ' | sed -e 's/( /(/'`
+    { echo "$as_me:$LINENO: result: ${ac_t:-
+         }$am_cv_proto_iconv" >&5
+echo "${ECHO_T}${ac_t:-
+         }$am_cv_proto_iconv" >&6; }
+
+cat >>confdefs.h <<_ACEOF
+#define ICONV_CONST $am_cv_proto_iconv_arg1
 _ACEOF
 
-fi
+  fi
 
-if test "$PNG" = "yes"; then
-   if test "$has_gd" = "true"; then
-      GRAPHIC="yes"
-      IMAGE="yes"
-      DRVLIBS="$DRVLIBS -lgd"
+   if test "$am_cv_func_iconv" = "yes"; then
+      PLUGINS="$PLUGINS plugin_iconv.o"
+      PLUGINLIBS="$PLUGINLIBS $LIBICONV"
 
 cat >>confdefs.h <<\_ACEOF
-#define WITH_PNG 1
+#define PLUGIN_ICONV 1
 _ACEOF
 
    else
-      { echo "$as_me:$LINENO: WARNING: gd.h not found: PNG driver disabled" >&5
-echo "$as_me: WARNING: gd.h not found: PNG driver disabled" >&2;}
+      { echo "$as_me:$LINENO: WARNING: iconv not found: iconv plugin disabled" >&5
+echo "$as_me: WARNING: iconv not found: iconv plugin disabled" >&2;}
    fi
 fi
 
-if test "$PPM" = "yes"; then
-   GRAPHIC="yes"
-   IMAGE="yes"
-
-cat >>confdefs.h <<\_ACEOF
-#define WITH_PPM 1
-_ACEOF
-
-fi
+# ISDN monitor
+if test "$PLUGIN_IMON" = "yes"; then
 
-if test "$IMAGE" = "yes"; then
-   DRIVERS="$DRIVERS drv_Image.o"
+for ac_header in linux/errno.h
+do
+as_ac_Header=`echo "ac_cv_header_$ac_header" | $as_tr_sh`
+if { as_var=$as_ac_Header; eval "test \"\${$as_var+set}\" = set"; }; then
+  { echo "$as_me:$LINENO: checking for $ac_header" >&5
+echo $ECHO_N "checking for $ac_header... $ECHO_C" >&6; }
+if { as_var=$as_ac_Header; eval "test \"\${$as_var+set}\" = set"; }; then
+  echo $ECHO_N "(cached) $ECHO_C" >&6
 fi
-
-if test "$ROUTERBOARD" = "yes"; then
-   TEXT="yes"
-   DRIVERS="$DRIVERS drv_RouterBoard.o"
-
-cat >>confdefs.h <<\_ACEOF
-#define WITH_ROUTERBOARD 1
+ac_res=`eval echo '${'$as_ac_Header'}'`
+	       { echo "$as_me:$LINENO: result: $ac_res" >&5
+echo "${ECHO_T}$ac_res" >&6; }
+else
+  # Is the header compilable?
+{ echo "$as_me:$LINENO: checking $ac_header usability" >&5
+echo $ECHO_N "checking $ac_header usability... $ECHO_C" >&6; }
+cat >conftest.$ac_ext <<_ACEOF
+/* confdefs.h.  */
+_ACEOF
+cat confdefs.h >>conftest.$ac_ext
+cat >>conftest.$ac_ext <<_ACEOF
+/* end confdefs.h.  */
+$ac_includes_default
+#include <$ac_header>
 _ACEOF
+rm -f conftest.$ac_objext
+if { (ac_try="$ac_compile"
+case "(($ac_try" in
+  *\"* | *\`* | *\\*) ac_try_echo=\$ac_try;;
+  *) ac_try_echo=$ac_try;;
+esac
+eval "echo \"\$as_me:$LINENO: $ac_try_echo\"") >&5
+  (eval "$ac_compile") 2>conftest.er1
+  ac_status=$?
+  grep -v '^ *+' conftest.er1 >conftest.err
+  rm -f conftest.er1
+  cat conftest.err >&5
+  echo "$as_me:$LINENO: \$? = $ac_status" >&5
+  (exit $ac_status); } && {
+	 test -z "$ac_c_werror_flag" ||
+	 test ! -s conftest.err
+       } && test -s conftest.$ac_objext; then
+  ac_header_compiler=yes
+else
+  echo "$as_me: failed program was:" >&5
+sed 's/^/| /' conftest.$ac_ext >&5
 
+	ac_header_compiler=no
 fi
 
-if test "$SERDISPLIB" = "yes"; then
-   if test "$has_serdisplib" = "true"; then
-      GRAPHIC="yes"
-      DRIVERS="$DRIVERS drv_serdisplib.o"
-      DRVLIBS="$DRVLIBS -L/usr/local/lib -lserdisp"
+rm -f core conftest.err conftest.$ac_objext conftest.$ac_ext
+{ echo "$as_me:$LINENO: result: $ac_header_compiler" >&5
+echo "${ECHO_T}$ac_header_compiler" >&6; }
 
-cat >>confdefs.h <<\_ACEOF
-#define WITH_SERDISPLIB 1
+# Is the header present?
+{ echo "$as_me:$LINENO: checking $ac_header presence" >&5
+echo $ECHO_N "checking $ac_header presence... $ECHO_C" >&6; }
+cat >conftest.$ac_ext <<_ACEOF
+/* confdefs.h.  */
+_ACEOF
+cat confdefs.h >>conftest.$ac_ext
+cat >>conftest.$ac_ext <<_ACEOF
+/* end confdefs.h.  */
+#include <$ac_header>
 _ACEOF
+if { (ac_try="$ac_cpp conftest.$ac_ext"
+case "(($ac_try" in
+  *\"* | *\`* | *\\*) ac_try_echo=\$ac_try;;
+  *) ac_try_echo=$ac_try;;
+esac
+eval "echo \"\$as_me:$LINENO: $ac_try_echo\"") >&5
+  (eval "$ac_cpp conftest.$ac_ext") 2>conftest.er1
+  ac_status=$?
+  grep -v '^ *+' conftest.er1 >conftest.err
+  rm -f conftest.er1
+  cat conftest.err >&5
+  echo "$as_me:$LINENO: \$? = $ac_status" >&5
+  (exit $ac_status); } >/dev/null && {
+	 test -z "$ac_c_preproc_warn_flag$ac_c_werror_flag" ||
+	 test ! -s conftest.err
+       }; then
+  ac_header_preproc=yes
+else
+  echo "$as_me: failed program was:" >&5
+sed 's/^/| /' conftest.$ac_ext >&5
 
-   else
-      { echo "$as_me:$LINENO: WARNING: serdisp.h not found: serdisplib driver disabled" >&5
-echo "$as_me: WARNING: serdisp.h not found: serdisplib driver disabled" >&2;}
-   fi
+  ac_header_preproc=no
 fi
 
-if test "$SIMPLELCD" = "yes"; then
-   TEXT="yes"
-   SERIAL="yes"
-   DRIVERS="$DRIVERS drv_SimpleLCD.o"
-
-cat >>confdefs.h <<\_ACEOF
-#define WITH_SIMPLELCD 1
-_ACEOF
+rm -f conftest.err conftest.$ac_ext
+{ echo "$as_me:$LINENO: result: $ac_header_preproc" >&5
+echo "${ECHO_T}$ac_header_preproc" >&6; }
 
+# So?  What about this header?
+case $ac_header_compiler:$ac_header_preproc:$ac_c_preproc_warn_flag in
+  yes:no: )
+    { echo "$as_me:$LINENO: WARNING: $ac_header: accepted by the compiler, rejected by the preprocessor!" >&5
+echo "$as_me: WARNING: $ac_header: accepted by the compiler, rejected by the preprocessor!" >&2;}
+    { echo "$as_me:$LINENO: WARNING: $ac_header: proceeding with the compiler's result" >&5
+echo "$as_me: WARNING: $ac_header: proceeding with the compiler's result" >&2;}
+    ac_header_preproc=yes
+    ;;
+  no:yes:* )
+    { echo "$as_me:$LINENO: WARNING: $ac_header: present but cannot be compiled" >&5
+echo "$as_me: WARNING: $ac_header: present but cannot be compiled" >&2;}
+    { echo "$as_me:$LINENO: WARNING: $ac_header:     check for missing prerequisite headers?" >&5
+echo "$as_me: WARNING: $ac_header:     check for missing prerequisite headers?" >&2;}
+    { echo "$as_me:$LINENO: WARNING: $ac_header: see the Autoconf documentation" >&5
+echo "$as_me: WARNING: $ac_header: see the Autoconf documentation" >&2;}
+    { echo "$as_me:$LINENO: WARNING: $ac_header:     section \"Present But Cannot Be Compiled\"" >&5
+echo "$as_me: WARNING: $ac_header:     section \"Present But Cannot Be Compiled\"" >&2;}
+    { echo "$as_me:$LINENO: WARNING: $ac_header: proceeding with the preprocessor's result" >&5
+echo "$as_me: WARNING: $ac_header: proceeding with the preprocessor's result" >&2;}
+    { echo "$as_me:$LINENO: WARNING: $ac_header: in the future, the compiler will take precedence" >&5
+echo "$as_me: WARNING: $ac_header: in the future, the compiler will take precedence" >&2;}
+    ( cat <<\_ASBOX
+## ---------------------------------------------------- ##
+## Report this to lcd4linux-users@lists.sourceforge.net ##
+## ---------------------------------------------------- ##
+_ASBOX
+     ) | sed "s/^/$as_me: WARNING:     /" >&2
+    ;;
+esac
+{ echo "$as_me:$LINENO: checking for $ac_header" >&5
+echo $ECHO_N "checking for $ac_header... $ECHO_C" >&6; }
+if { as_var=$as_ac_Header; eval "test \"\${$as_var+set}\" = set"; }; then
+  echo $ECHO_N "(cached) $ECHO_C" >&6
+else
+  eval "$as_ac_Header=\$ac_header_preproc"
 fi
+ac_res=`eval echo '${'$as_ac_Header'}'`
+	       { echo "$as_me:$LINENO: result: $ac_res" >&5
+echo "${ECHO_T}$ac_res" >&6; }
 
-if test "$T6963" = "yes"; then
-   GRAPHIC="yes"
-   PARPORT="yes"
-   DRIVERS="$DRIVERS drv_T6963.o"
-
-cat >>confdefs.h <<\_ACEOF
-#define WITH_T6963 1
+fi
+if test `eval echo '${'$as_ac_Header'}'` = yes; then
+  cat >>confdefs.h <<_ACEOF
+#define `echo "HAVE_$ac_header" | $as_tr_cpp` 1
 _ACEOF
-
+ has_linux_errno="true"
+else
+  has_linux_errno="false"
 fi
 
-if test "$Trefon" = "yes"; then
-   if test "$has_usb" = "true"; then
-      TEXT="yes"
-      DRIVERS="$DRIVERS drv_Trefon.o"
-      DRVLIBS="$DRVLIBS -lusb"
+done
+
+   if test "$has_linux_errno" = "true"; then
+       PLUGINS="$PLUGINS plugin_imon.o"
 
 cat >>confdefs.h <<\_ACEOF
-#define WITH_TREFON 1
+#define PLUGIN_IMON 1
 _ACEOF
 
    else
-      { echo "$as_me:$LINENO: WARNING: usb.h not found: Trefon driver disabled" >&5
-echo "$as_me: WARNING: usb.h not found: Trefon driver disabled" >&2;}
+       { echo "$as_me:$LINENO: WARNING: linux/errno.h header not found: imon plugin disabled" >&5
+echo "$as_me: WARNING: linux/errno.h header not found: imon plugin disabled" >&2;}
    fi
 fi
 
-if test "$USBLCD" = "yes"; then
-   TEXT="yes"
-   SERIAL="yes"
-   DRIVERS="$DRIVERS drv_USBLCD.o"
-   if test "$has_usb" = "true"; then
-      DRVLIBS="$DRVLIBS -lusb"
-   fi
+# ISDN
+if test "$PLUGIN_ISDN" = "yes"; then
 
-cat >>confdefs.h <<\_ACEOF
-#define WITH_USBLCD 1
+for ac_header in linux/isdn.h
+do
+as_ac_Header=`echo "ac_cv_header_$ac_header" | $as_tr_sh`
+if { as_var=$as_ac_Header; eval "test \"\${$as_var+set}\" = set"; }; then
+  { echo "$as_me:$LINENO: checking for $ac_header" >&5
+echo $ECHO_N "checking for $ac_header... $ECHO_C" >&6; }
+if { as_var=$as_ac_Header; eval "test \"\${$as_var+set}\" = set"; }; then
+  echo $ECHO_N "(cached) $ECHO_C" >&6
+fi
+ac_res=`eval echo '${'$as_ac_Header'}'`
+	       { echo "$as_me:$LINENO: result: $ac_res" >&5
+echo "${ECHO_T}$ac_res" >&6; }
+else
+  # Is the header compilable?
+{ echo "$as_me:$LINENO: checking $ac_header usability" >&5
+echo $ECHO_N "checking $ac_header usability... $ECHO_C" >&6; }
+cat >conftest.$ac_ext <<_ACEOF
+/* confdefs.h.  */
+_ACEOF
+cat confdefs.h >>conftest.$ac_ext
+cat >>conftest.$ac_ext <<_ACEOF
+/* end confdefs.h.  */
+$ac_includes_default
+#include <$ac_header>
 _ACEOF
+rm -f conftest.$ac_objext
+if { (ac_try="$ac_compile"
+case "(($ac_try" in
+  *\"* | *\`* | *\\*) ac_try_echo=\$ac_try;;
+  *) ac_try_echo=$ac_try;;
+esac
+eval "echo \"\$as_me:$LINENO: $ac_try_echo\"") >&5
+  (eval "$ac_compile") 2>conftest.er1
+  ac_status=$?
+  grep -v '^ *+' conftest.er1 >conftest.err
+  rm -f conftest.er1
+  cat conftest.err >&5
+  echo "$as_me:$LINENO: \$? = $ac_status" >&5
+  (exit $ac_status); } && {
+	 test -z "$ac_c_werror_flag" ||
+	 test ! -s conftest.err
+       } && test -s conftest.$ac_objext; then
+  ac_header_compiler=yes
+else
+  echo "$as_me: failed program was:" >&5
+sed 's/^/| /' conftest.$ac_ext >&5
 
+	ac_header_compiler=no
 fi
 
-if test "$X11" = "yes"; then
-   if test "$no_x" = "yes"; then
-      { echo "$as_me:$LINENO: WARNING: X11 headers or libraries not available: X11 driver disabled" >&5
-echo "$as_me: WARNING: X11 headers or libraries not available: X11 driver disabled" >&2;}
-   else
-      GRAPHIC="yes"
-      DRIVERS="$DRIVERS drv_X11.o"
-      DRVLIBS="$DRVLIBS -L$ac_x_libraries -lX11"
-      CPP_FLAGS="$CPPFLAGS $X_CFLAGS"
+rm -f core conftest.err conftest.$ac_objext conftest.$ac_ext
+{ echo "$as_me:$LINENO: result: $ac_header_compiler" >&5
+echo "${ECHO_T}$ac_header_compiler" >&6; }
 
-cat >>confdefs.h <<\_ACEOF
-#define WITH_X11 1
+# Is the header present?
+{ echo "$as_me:$LINENO: checking $ac_header presence" >&5
+echo $ECHO_N "checking $ac_header presence... $ECHO_C" >&6; }
+cat >conftest.$ac_ext <<_ACEOF
+/* confdefs.h.  */
 _ACEOF
+cat confdefs.h >>conftest.$ac_ext
+cat >>conftest.$ac_ext <<_ACEOF
+/* end confdefs.h.  */
+#include <$ac_header>
+_ACEOF
+if { (ac_try="$ac_cpp conftest.$ac_ext"
+case "(($ac_try" in
+  *\"* | *\`* | *\\*) ac_try_echo=\$ac_try;;
+  *) ac_try_echo=$ac_try;;
+esac
+eval "echo \"\$as_me:$LINENO: $ac_try_echo\"") >&5
+  (eval "$ac_cpp conftest.$ac_ext") 2>conftest.er1
+  ac_status=$?
+  grep -v '^ *+' conftest.er1 >conftest.err
+  rm -f conftest.er1
+  cat conftest.err >&5
+  echo "$as_me:$LINENO: \$? = $ac_status" >&5
+  (exit $ac_status); } >/dev/null && {
+	 test -z "$ac_c_preproc_warn_flag$ac_c_werror_flag" ||
+	 test ! -s conftest.err
+       }; then
+  ac_header_preproc=yes
+else
+  echo "$as_me: failed program was:" >&5
+sed 's/^/| /' conftest.$ac_ext >&5
 
-   fi
-fi
-
-
-if test "$DRIVERS" = ""; then
-   { { echo "$as_me:$LINENO: error: You should activate at least one driver..." >&5
-echo "$as_me: error: You should activate at least one driver..." >&2;}
-   { (exit 1); exit 1; }; }
+  ac_header_preproc=no
 fi
 
+rm -f conftest.err conftest.$ac_ext
+{ echo "$as_me:$LINENO: result: $ac_header_preproc" >&5
+echo "${ECHO_T}$ac_header_preproc" >&6; }
 
-# generic text driver
-if test "$TEXT" = "yes"; then
-   DRIVERS="$DRIVERS drv_generic_text.o"
+# So?  What about this header?
+case $ac_header_compiler:$ac_header_preproc:$ac_c_preproc_warn_flag in
+  yes:no: )
+    { echo "$as_me:$LINENO: WARNING: $ac_header: accepted by the compiler, rejected by the preprocessor!" >&5
+echo "$as_me: WARNING: $ac_header: accepted by the compiler, rejected by the preprocessor!" >&2;}
+    { echo "$as_me:$LINENO: WARNING: $ac_header: proceeding with the compiler's result" >&5
+echo "$as_me: WARNING: $ac_header: proceeding with the compiler's result" >&2;}
+    ac_header_preproc=yes
+    ;;
+  no:yes:* )
+    { echo "$as_me:$LINENO: WARNING: $ac_header: present but cannot be compiled" >&5
+echo "$as_me: WARNING: $ac_header: present but cannot be compiled" >&2;}
+    { echo "$as_me:$LINENO: WARNING: $ac_header:     check for missing prerequisite headers?" >&5
+echo "$as_me: WARNING: $ac_header:     check for missing prerequisite headers?" >&2;}
+    { echo "$as_me:$LINENO: WARNING: $ac_header: see the Autoconf documentation" >&5
+echo "$as_me: WARNING: $ac_header: see the Autoconf documentation" >&2;}
+    { echo "$as_me:$LINENO: WARNING: $ac_header:     section \"Present But Cannot Be Compiled\"" >&5
+echo "$as_me: WARNING: $ac_header:     section \"Present But Cannot Be Compiled\"" >&2;}
+    { echo "$as_me:$LINENO: WARNING: $ac_header: proceeding with the preprocessor's result" >&5
+echo "$as_me: WARNING: $ac_header: proceeding with the preprocessor's result" >&2;}
+    { echo "$as_me:$LINENO: WARNING: $ac_header: in the future, the compiler will take precedence" >&5
+echo "$as_me: WARNING: $ac_header: in the future, the compiler will take precedence" >&2;}
+    ( cat <<\_ASBOX
+## ---------------------------------------------------- ##
+## Report this to lcd4linux-users@lists.sourceforge.net ##
+## ---------------------------------------------------- ##
+_ASBOX
+     ) | sed "s/^/$as_me: WARNING:     /" >&2
+    ;;
+esac
+{ echo "$as_me:$LINENO: checking for $ac_header" >&5
+echo $ECHO_N "checking for $ac_header... $ECHO_C" >&6; }
+if { as_var=$as_ac_Header; eval "test \"\${$as_var+set}\" = set"; }; then
+  echo $ECHO_N "(cached) $ECHO_C" >&6
+else
+  eval "$as_ac_Header=\$ac_header_preproc"
 fi
+ac_res=`eval echo '${'$as_ac_Header'}'`
+	       { echo "$as_me:$LINENO: result: $ac_res" >&5
+echo "${ECHO_T}$ac_res" >&6; }
 
-# generic graphic driver
-if test "$GRAPHIC" = "yes"; then
-:
-   DRIVERS="$DRIVERS drv_generic_graphic.o"
 fi
-
-
-# generic parport driver
-if test "$PARPORT" = "yes"; then
-   DRIVERS="$DRIVERS drv_generic_parport.o"
+if test `eval echo '${'$as_ac_Header'}'` = yes; then
+  cat >>confdefs.h <<_ACEOF
+#define `echo "HAVE_$ac_header" | $as_tr_cpp` 1
+_ACEOF
+ has_isdn_header="true"
+else
+  has_isdn_header="false"
 fi
 
-# generic serial driver
-if test "$SERIAL" = "yes"; then
-   DRIVERS="$DRIVERS drv_generic_serial.o"
-fi
+done
 
-# generic i2c driver
-if test "$I2C" = "yes"; then
-   DRIVERS="$DRIVERS drv_generic_i2c.o"
+   if test "$has_dvb_header" = "false"; then
+      { echo "$as_me:$LINENO: WARNING: linux/isdn.h header not found: isdn plugin CPS disabled" >&5
+echo "$as_me: WARNING: linux/isdn.h header not found: isdn plugin CPS disabled" >&2;}
+   fi
+   PLUGINS="$PLUGINS plugin_isdn.o"
 
 cat >>confdefs.h <<\_ACEOF
-#define WITH_I2C 1
+#define PLUGIN_ISDN 1
 _ACEOF
 
 fi
 
+# Karlsruher Verkehrsverbund
+if test "$PLUGIN_KVV" = "yes"; then
+   PLUGINS="$PLUGINS plugin_kvv.o"
 
+cat >>confdefs.h <<\_ACEOF
+#define PLUGIN_KVV 1
+_ACEOF
 
+fi
 
-
-
-# plugins
-
-echo "$as_me:$LINENO: checking which plugins to compile" >&5
-echo $ECHO_N "checking which plugins to compile... $ECHO_C" >&6
-
-# Check whether --with-plugins or --without-plugins was given.
-if test "${with_plugins+set}" = set; then
-  withval="$with_plugins"
-  plugins=$withval
-else
-  plugins=all
-
-fi;
-
-plugins=`echo $plugins|sed 's/,/ /g'`
-
-for plugin in $plugins; do
-
-   case $plugin in
-      !*)
-         val="no"
-         plugin=`echo $plugin|cut -c 2-`
-         ;;
-       *)
-         val="yes"
-         ;;
-   esac
-
-   case "$plugin" in
-      list)
-         echo "$as_me:$LINENO: result: TO BE DONE..." >&5
-echo "${ECHO_T}TO BE DONE..." >&6
-         { { echo "$as_me:$LINENO: error: run ./configure --with-plugins=..." >&5
-echo "$as_me: error: run ./configure --with-plugins=..." >&2;}
-   { (exit 1); exit 1; }; }
-         ;;
-      all)
-         PLUGIN_APM="yes"
-         PLUGIN_CPUINFO="yes"
-         PLUGIN_DISKSTATS="yes"
-         PLUGIN_DVB="yes"
-         PLUGIN_EXEC="yes"
-         PLUGIN_I2C_SENSORS="yes"
-         PLUGIN_IMON="yes"
-         PLUGIN_ISDN="yes"
-         PLUGIN_LOADAVG="yes"
-         PLUGIN_MEMINFO="yes"
-         PLUGIN_MYSQL="yes"
-         PLUGIN_NETDEV="yes"
-         PLUGIN_POP3="yes"
-         PLUGIN_PPP="yes"
-         PLUGIN_PROC_STAT="yes"
-         PLUGIN_PYTHON=$with_python
-         PLUGIN_SETI="yes"
-         PLUGIN_STATFS="yes"
-         PLUGIN_UNAME="yes"
-         PLUGIN_UPTIME="yes"
-         PLUGIN_WIRELESS="yes"
-         PLUGIN_XMMS="yes"
-         ;;
-      apm)
-         PLUGIN_APM=$val
-         ;;
-      cpuinfo)
-         PLUGIN_CPUINFO=$val
-         ;;
-      diskstats)
-         PLUGIN_DISKSTATS=$val
-         ;;
-      dvb)
-         PLUGIN_DVB=$val
-         ;;
-      exec)
-         PLUGIN_EXEC=$val
-         ;;
-      i2c_sensors)
-         PLUGIN_I2C_SENSORS=$val
-	 ;;
-      imon)
-         PLUGIN_IMON=$val
-         ;;
-      isdn)
-         PLUGIN_ISDN=$val
-         ;;
-      loadavg)
-         PLUGIN_LOADAVG=$val
-         ;;
-      meminfo)
-         PLUGIN_MEMINFO=$val
-         ;;
-      mysql)
-         PLUGIN_MYSQL=$val
-         ;;
-      netdev)
-         PLUGIN_NETDEV=$val
-         ;;
-      pop3)
-         PLUGIN_POP3=$val
-         ;;
-      ppp)
-         PLUGIN_PPP=$val
-         ;;
-      proc_stat)
-         PLUGIN_PROC_STAT=$val
-         ;;
-      python)
-         PLUGIN_PYTHON=$val
-         ;;
-      seti)
-         PLUGIN_SETI=$val
-         ;;
-      statfs)
-         PLUGIN_STATFS=$val
-         ;;
-      uname)
-         PLUGIN_UNAME=$val
-         ;;
-      uptime)
-         PLUGIN_UPTIME=$val
-         ;;
-      wireless)
-         PLUGIN_WIRELESS=$val
-         ;;
-      xmms)
-         PLUGIN_XMMS=$val
-         ;;
-      *)
-         { { echo "$as_me:$LINENO: error: Unknown plugin '$plugin'" >&5
-echo "$as_me: error: Unknown plugin '$plugin'" >&2;}
-   { (exit 1); exit 1; }; }
-         ;;
-   esac
-done
-
-echo "$as_me:$LINENO: result: done" >&5
-echo "${ECHO_T}done" >&6
-if test "$PLUGIN_APM" = "yes"; then
-   PLUGINS="$PLUGINS plugin_apm.o"
+# load average
+if test "$PLUGIN_LOADAVG" = "yes"; then
+   PLUGINS="$PLUGINS plugin_loadavg.o"
 
 cat >>confdefs.h <<\_ACEOF
-#define PLUGIN_APM 1
+#define PLUGIN_LOADAVG 1
 _ACEOF
 
 fi
-if test "$PLUGIN_CPUINFO" = "yes"; then
-   PLUGINS="$PLUGINS plugin_cpuinfo.o"
+
+# meminfo
+if test "$PLUGIN_MEMINFO" = "yes"; then
+   PLUGINS="$PLUGINS plugin_meminfo.o"
 
 cat >>confdefs.h <<\_ACEOF
-#define PLUGIN_CPUINFO 1
+#define PLUGIN_MEMINFO 1
 _ACEOF
 
 fi
-if test "$PLUGIN_DISKSTATS" = "yes"; then
-   PLUGINS="$PLUGINS plugin_diskstats.o"
+
+# MPD
+if test "$PLUGIN_MPD" = "yes"; then
+   if test -f "libmpdclient.h"
+   then
+	PLUGINS="$PLUGINS plugin_mpd.o libmpdclient.o"
 
 cat >>confdefs.h <<\_ACEOF
-#define PLUGIN_DISKSTATS 1
+#define PLUGIN_MPD 1
 _ACEOF
 
+   else
+      { echo "$as_me:$LINENO: WARNING: libmpdclient.h header not found: mpd plugin disabled" >&5
+echo "$as_me: WARNING: libmpdclient.h header not found: mpd plugin disabled" >&2;}
+      { echo "$as_me:$LINENO: WARNING: get libmpdclient.h from http://www.musicpd.org/libmpdclient.shtml" >&5
+echo "$as_me: WARNING: get libmpdclient.h from http://www.musicpd.org/libmpdclient.shtml" >&2;}
+      { echo "$as_me:$LINENO: WARNING: and copy those 2 files in the lcd4linux directory." >&5
+echo "$as_me: WARNING: and copy those 2 files in the lcd4linux directory." >&2;}
+   fi
 fi
-if test "$PLUGIN_DVB" = "yes"; then
 
-for ac_header in linux/dvb/frontend.h
+# MySQL
+if test "$PLUGIN_MYSQL" = "yes"; then
+
+for ac_header in mysql/mysql.h
 do
 as_ac_Header=`echo "ac_cv_header_$ac_header" | $as_tr_sh`
-if eval "test \"\${$as_ac_Header+set}\" = set"; then
-  echo "$as_me:$LINENO: checking for $ac_header" >&5
-echo $ECHO_N "checking for $ac_header... $ECHO_C" >&6
-if eval "test \"\${$as_ac_Header+set}\" = set"; then
+if { as_var=$as_ac_Header; eval "test \"\${$as_var+set}\" = set"; }; then
+  { echo "$as_me:$LINENO: checking for $ac_header" >&5
+echo $ECHO_N "checking for $ac_header... $ECHO_C" >&6; }
+if { as_var=$as_ac_Header; eval "test \"\${$as_var+set}\" = set"; }; then
   echo $ECHO_N "(cached) $ECHO_C" >&6
 fi
-echo "$as_me:$LINENO: result: `eval echo '${'$as_ac_Header'}'`" >&5
-echo "${ECHO_T}`eval echo '${'$as_ac_Header'}'`" >&6
+ac_res=`eval echo '${'$as_ac_Header'}'`
+	       { echo "$as_me:$LINENO: result: $ac_res" >&5
+echo "${ECHO_T}$ac_res" >&6; }
 else
   # Is the header compilable?
-echo "$as_me:$LINENO: checking $ac_header usability" >&5
-echo $ECHO_N "checking $ac_header usability... $ECHO_C" >&6
+{ echo "$as_me:$LINENO: checking $ac_header usability" >&5
+echo $ECHO_N "checking $ac_header usability... $ECHO_C" >&6; }
 cat >conftest.$ac_ext <<_ACEOF
 /* confdefs.h.  */
 _ACEOF
@@ -6496,40 +11016,37 @@
 #include <$ac_header>
 _ACEOF
 rm -f conftest.$ac_objext
-if { (eval echo "$as_me:$LINENO: \"$ac_compile\"") >&5
-  (eval $ac_compile) 2>conftest.er1
+if { (ac_try="$ac_compile"
+case "(($ac_try" in
+  *\"* | *\`* | *\\*) ac_try_echo=\$ac_try;;
+  *) ac_try_echo=$ac_try;;
+esac
+eval "echo \"\$as_me:$LINENO: $ac_try_echo\"") >&5
+  (eval "$ac_compile") 2>conftest.er1
   ac_status=$?
   grep -v '^ *+' conftest.er1 >conftest.err
   rm -f conftest.er1
   cat conftest.err >&5
   echo "$as_me:$LINENO: \$? = $ac_status" >&5
-  (exit $ac_status); } &&
-	 { ac_try='test -z "$ac_c_werror_flag"			 || test ! -s conftest.err'
-  { (eval echo "$as_me:$LINENO: \"$ac_try\"") >&5
-  (eval $ac_try) 2>&5
-  ac_status=$?
-  echo "$as_me:$LINENO: \$? = $ac_status" >&5
-  (exit $ac_status); }; } &&
-	 { ac_try='test -s conftest.$ac_objext'
-  { (eval echo "$as_me:$LINENO: \"$ac_try\"") >&5
-  (eval $ac_try) 2>&5
-  ac_status=$?
-  echo "$as_me:$LINENO: \$? = $ac_status" >&5
-  (exit $ac_status); }; }; then
+  (exit $ac_status); } && {
+	 test -z "$ac_c_werror_flag" ||
+	 test ! -s conftest.err
+       } && test -s conftest.$ac_objext; then
   ac_header_compiler=yes
 else
   echo "$as_me: failed program was:" >&5
 sed 's/^/| /' conftest.$ac_ext >&5
 
-ac_header_compiler=no
+	ac_header_compiler=no
 fi
-rm -f conftest.err conftest.$ac_objext conftest.$ac_ext
-echo "$as_me:$LINENO: result: $ac_header_compiler" >&5
-echo "${ECHO_T}$ac_header_compiler" >&6
+
+rm -f core conftest.err conftest.$ac_objext conftest.$ac_ext
+{ echo "$as_me:$LINENO: result: $ac_header_compiler" >&5
+echo "${ECHO_T}$ac_header_compiler" >&6; }
 
 # Is the header present?
-echo "$as_me:$LINENO: checking $ac_header presence" >&5
-echo $ECHO_N "checking $ac_header presence... $ECHO_C" >&6
+{ echo "$as_me:$LINENO: checking $ac_header presence" >&5
+echo $ECHO_N "checking $ac_header presence... $ECHO_C" >&6; }
 cat >conftest.$ac_ext <<_ACEOF
 /* confdefs.h.  */
 _ACEOF
@@ -6538,24 +11055,22 @@
 /* end confdefs.h.  */
 #include <$ac_header>
 _ACEOF
-if { (eval echo "$as_me:$LINENO: \"$ac_cpp conftest.$ac_ext\"") >&5
-  (eval $ac_cpp conftest.$ac_ext) 2>conftest.er1
+if { (ac_try="$ac_cpp conftest.$ac_ext"
+case "(($ac_try" in
+  *\"* | *\`* | *\\*) ac_try_echo=\$ac_try;;
+  *) ac_try_echo=$ac_try;;
+esac
+eval "echo \"\$as_me:$LINENO: $ac_try_echo\"") >&5
+  (eval "$ac_cpp conftest.$ac_ext") 2>conftest.er1
   ac_status=$?
   grep -v '^ *+' conftest.er1 >conftest.err
   rm -f conftest.er1
   cat conftest.err >&5
   echo "$as_me:$LINENO: \$? = $ac_status" >&5
-  (exit $ac_status); } >/dev/null; then
-  if test -s conftest.err; then
-    ac_cpp_err=$ac_c_preproc_warn_flag
-    ac_cpp_err=$ac_cpp_err$ac_c_werror_flag
-  else
-    ac_cpp_err=
-  fi
-else
-  ac_cpp_err=yes
-fi
-if test -z "$ac_cpp_err"; then
+  (exit $ac_status); } >/dev/null && {
+	 test -z "$ac_c_preproc_warn_flag$ac_c_werror_flag" ||
+	 test ! -s conftest.err
+       }; then
   ac_header_preproc=yes
 else
   echo "$as_me: failed program was:" >&5
@@ -6563,9 +11078,10 @@
 
   ac_header_preproc=no
 fi
+
 rm -f conftest.err conftest.$ac_ext
-echo "$as_me:$LINENO: result: $ac_header_preproc" >&5
-echo "${ECHO_T}$ac_header_preproc" >&6
+{ echo "$as_me:$LINENO: result: $ac_header_preproc" >&5
+echo "${ECHO_T}$ac_header_preproc" >&6; }
 
 # So?  What about this header?
 case $ac_header_compiler:$ac_header_preproc:$ac_c_preproc_warn_flag in
@@ -6589,91 +11105,172 @@
 echo "$as_me: WARNING: $ac_header: proceeding with the preprocessor's result" >&2;}
     { echo "$as_me:$LINENO: WARNING: $ac_header: in the future, the compiler will take precedence" >&5
 echo "$as_me: WARNING: $ac_header: in the future, the compiler will take precedence" >&2;}
-    (
-      cat <<\_ASBOX
+    ( cat <<\_ASBOX
 ## ---------------------------------------------------- ##
 ## Report this to lcd4linux-users@lists.sourceforge.net ##
 ## ---------------------------------------------------- ##
 _ASBOX
-    ) |
-      sed "s/^/$as_me: WARNING:     /" >&2
+     ) | sed "s/^/$as_me: WARNING:     /" >&2
     ;;
 esac
-echo "$as_me:$LINENO: checking for $ac_header" >&5
-echo $ECHO_N "checking for $ac_header... $ECHO_C" >&6
-if eval "test \"\${$as_ac_Header+set}\" = set"; then
+{ echo "$as_me:$LINENO: checking for $ac_header" >&5
+echo $ECHO_N "checking for $ac_header... $ECHO_C" >&6; }
+if { as_var=$as_ac_Header; eval "test \"\${$as_var+set}\" = set"; }; then
   echo $ECHO_N "(cached) $ECHO_C" >&6
 else
   eval "$as_ac_Header=\$ac_header_preproc"
 fi
-echo "$as_me:$LINENO: result: `eval echo '${'$as_ac_Header'}'`" >&5
-echo "${ECHO_T}`eval echo '${'$as_ac_Header'}'`" >&6
+ac_res=`eval echo '${'$as_ac_Header'}'`
+	       { echo "$as_me:$LINENO: result: $ac_res" >&5
+echo "${ECHO_T}$ac_res" >&6; }
 
 fi
 if test `eval echo '${'$as_ac_Header'}'` = yes; then
   cat >>confdefs.h <<_ACEOF
 #define `echo "HAVE_$ac_header" | $as_tr_cpp` 1
 _ACEOF
- has_dvb_header="true"
+ has_mysql_header="true"
 else
-  has_dvb_header="false"
+  has_mysql_header="false"
 fi
 
 done
 
-   if test "$has_dvb_header" = "true"; then
-      PLUGINS="$PLUGINS plugin_dvb.o"
+   if test "$has_mysql_header" = "true"; then
+      { echo "$as_me:$LINENO: checking for mysql_init in -lmysqlclient" >&5
+echo $ECHO_N "checking for mysql_init in -lmysqlclient... $ECHO_C" >&6; }
+if test "${ac_cv_lib_mysqlclient_mysql_init+set}" = set; then
+  echo $ECHO_N "(cached) $ECHO_C" >&6
+else
+  ac_check_lib_save_LIBS=$LIBS
+LIBS="-lmysqlclient  $LIBS"
+cat >conftest.$ac_ext <<_ACEOF
+/* confdefs.h.  */
+_ACEOF
+cat confdefs.h >>conftest.$ac_ext
+cat >>conftest.$ac_ext <<_ACEOF
+/* end confdefs.h.  */
+
+/* Override any GCC internal prototype to avoid an error.
+   Use char because int might match the return type of a GCC
+   builtin and then its argument prototype would still apply.  */
+#ifdef __cplusplus
+extern "C"
+#endif
+char mysql_init ();
+int
+main ()
+{
+return mysql_init ();
+  ;
+  return 0;
+}
+_ACEOF
+rm -f conftest.$ac_objext conftest$ac_exeext
+if { (ac_try="$ac_link"
+case "(($ac_try" in
+  *\"* | *\`* | *\\*) ac_try_echo=\$ac_try;;
+  *) ac_try_echo=$ac_try;;
+esac
+eval "echo \"\$as_me:$LINENO: $ac_try_echo\"") >&5
+  (eval "$ac_link") 2>conftest.er1
+  ac_status=$?
+  grep -v '^ *+' conftest.er1 >conftest.err
+  rm -f conftest.er1
+  cat conftest.err >&5
+  echo "$as_me:$LINENO: \$? = $ac_status" >&5
+  (exit $ac_status); } && {
+	 test -z "$ac_c_werror_flag" ||
+	 test ! -s conftest.err
+       } && test -s conftest$ac_exeext &&
+       $as_test_x conftest$ac_exeext; then
+  ac_cv_lib_mysqlclient_mysql_init=yes
+else
+  echo "$as_me: failed program was:" >&5
+sed 's/^/| /' conftest.$ac_ext >&5
+
+	ac_cv_lib_mysqlclient_mysql_init=no
+fi
+
+rm -f core conftest.err conftest.$ac_objext conftest_ipa8_conftest.oo \
+      conftest$ac_exeext conftest.$ac_ext
+LIBS=$ac_check_lib_save_LIBS
+fi
+{ echo "$as_me:$LINENO: result: $ac_cv_lib_mysqlclient_mysql_init" >&5
+echo "${ECHO_T}$ac_cv_lib_mysqlclient_mysql_init" >&6; }
+if test $ac_cv_lib_mysqlclient_mysql_init = yes; then
+  has_mysql_lib="true"
+else
+  has_mysql_lib="false"
+fi
+
+      if test "$has_mysql_lib" = "true"; then
+        PLUGINS="$PLUGINS plugin_mysql.o"
+        PLUGINLIBS="$PLUGINLIBS -lmysqlclient"
 
 cat >>confdefs.h <<\_ACEOF
-#define PLUGIN_DVB 1
+#define PLUGIN_MYSQL 1
 _ACEOF
 
+      else
+        { echo "$as_me:$LINENO: WARNING: mysqlclient lib not found: mysql plugin disabled" >&5
+echo "$as_me: WARNING: mysqlclient lib not found: mysql plugin disabled" >&2;}
+      fi
    else
-      { echo "$as_me:$LINENO: WARNING: linux/dvb/frontend.h header not found: dvb plugin disabled" >&5
-echo "$as_me: WARNING: linux/dvb/frontend.h header not found: dvb plugin disabled" >&2;}
+      { echo "$as_me:$LINENO: WARNING: mysql/mysql.h header not found: mysql plugin disabled" >&5
+echo "$as_me: WARNING: mysql/mysql.h header not found: mysql plugin disabled" >&2;}
    fi
 fi
-if test "$PLUGIN_EXEC" = "yes"; then
-   PLUGINS="$PLUGINS plugin_exec.o"
+
+# /proc/net/dev
+if test "$PLUGIN_NETDEV" = "yes"; then
+   PLUGINS="$PLUGINS plugin_netdev.o"
 
 cat >>confdefs.h <<\_ACEOF
-#define PLUGIN_EXEC 1
+#define PLUGIN_NETDEV 1
 _ACEOF
 
 fi
-if test "$PLUGIN_I2C_SENSORS" = "yes"; then
-   PLUGINS="$PLUGINS plugin_i2c_sensors.o"
+
+# configuration of network devices
+if test "$PLUGIN_NETINFO" = "yes"; then
+   PLUGINS="$PLUGINS plugin_netinfo.o"
 
 cat >>confdefs.h <<\_ACEOF
-#define PLUGIN_I2C_SENSORS 1
+#define PLUGIN_NETINFO 1
 _ACEOF
 
 fi
-if test "$PLUGIN_IMON" = "yes"; then
-   PLUGINS="$PLUGINS plugin_imon.o"
+
+# POP3
+if test "$PLUGIN_POP3" = "yes"; then
+   PLUGINS="$PLUGINS plugin_pop3.o"
 
 cat >>confdefs.h <<\_ACEOF
-#define PLUGIN_IMON 1
+#define PLUGIN_POP3 1
 _ACEOF
 
 fi
-if test "$PLUGIN_ISDN" = "yes"; then
 
-for ac_header in linux/isdn.h
+# PPP
+if test "$PLUGIN_PPP" = "yes"; then
+
+for ac_header in net/if_ppp.h
 do
 as_ac_Header=`echo "ac_cv_header_$ac_header" | $as_tr_sh`
-if eval "test \"\${$as_ac_Header+set}\" = set"; then
-  echo "$as_me:$LINENO: checking for $ac_header" >&5
-echo $ECHO_N "checking for $ac_header... $ECHO_C" >&6
-if eval "test \"\${$as_ac_Header+set}\" = set"; then
+if { as_var=$as_ac_Header; eval "test \"\${$as_var+set}\" = set"; }; then
+  { echo "$as_me:$LINENO: checking for $ac_header" >&5
+echo $ECHO_N "checking for $ac_header... $ECHO_C" >&6; }
+if { as_var=$as_ac_Header; eval "test \"\${$as_var+set}\" = set"; }; then
   echo $ECHO_N "(cached) $ECHO_C" >&6
 fi
-echo "$as_me:$LINENO: result: `eval echo '${'$as_ac_Header'}'`" >&5
-echo "${ECHO_T}`eval echo '${'$as_ac_Header'}'`" >&6
+ac_res=`eval echo '${'$as_ac_Header'}'`
+	       { echo "$as_me:$LINENO: result: $ac_res" >&5
+echo "${ECHO_T}$ac_res" >&6; }
 else
   # Is the header compilable?
-echo "$as_me:$LINENO: checking $ac_header usability" >&5
-echo $ECHO_N "checking $ac_header usability... $ECHO_C" >&6
+{ echo "$as_me:$LINENO: checking $ac_header usability" >&5
+echo $ECHO_N "checking $ac_header usability... $ECHO_C" >&6; }
 cat >conftest.$ac_ext <<_ACEOF
 /* confdefs.h.  */
 _ACEOF
@@ -6684,40 +11281,37 @@
 #include <$ac_header>
 _ACEOF
 rm -f conftest.$ac_objext
-if { (eval echo "$as_me:$LINENO: \"$ac_compile\"") >&5
-  (eval $ac_compile) 2>conftest.er1
+if { (ac_try="$ac_compile"
+case "(($ac_try" in
+  *\"* | *\`* | *\\*) ac_try_echo=\$ac_try;;
+  *) ac_try_echo=$ac_try;;
+esac
+eval "echo \"\$as_me:$LINENO: $ac_try_echo\"") >&5
+  (eval "$ac_compile") 2>conftest.er1
   ac_status=$?
   grep -v '^ *+' conftest.er1 >conftest.err
   rm -f conftest.er1
   cat conftest.err >&5
   echo "$as_me:$LINENO: \$? = $ac_status" >&5
-  (exit $ac_status); } &&
-	 { ac_try='test -z "$ac_c_werror_flag"			 || test ! -s conftest.err'
-  { (eval echo "$as_me:$LINENO: \"$ac_try\"") >&5
-  (eval $ac_try) 2>&5
-  ac_status=$?
-  echo "$as_me:$LINENO: \$? = $ac_status" >&5
-  (exit $ac_status); }; } &&
-	 { ac_try='test -s conftest.$ac_objext'
-  { (eval echo "$as_me:$LINENO: \"$ac_try\"") >&5
-  (eval $ac_try) 2>&5
-  ac_status=$?
-  echo "$as_me:$LINENO: \$? = $ac_status" >&5
-  (exit $ac_status); }; }; then
+  (exit $ac_status); } && {
+	 test -z "$ac_c_werror_flag" ||
+	 test ! -s conftest.err
+       } && test -s conftest.$ac_objext; then
   ac_header_compiler=yes
 else
   echo "$as_me: failed program was:" >&5
 sed 's/^/| /' conftest.$ac_ext >&5
 
-ac_header_compiler=no
+	ac_header_compiler=no
 fi
-rm -f conftest.err conftest.$ac_objext conftest.$ac_ext
-echo "$as_me:$LINENO: result: $ac_header_compiler" >&5
-echo "${ECHO_T}$ac_header_compiler" >&6
+
+rm -f core conftest.err conftest.$ac_objext conftest.$ac_ext
+{ echo "$as_me:$LINENO: result: $ac_header_compiler" >&5
+echo "${ECHO_T}$ac_header_compiler" >&6; }
 
 # Is the header present?
-echo "$as_me:$LINENO: checking $ac_header presence" >&5
-echo $ECHO_N "checking $ac_header presence... $ECHO_C" >&6
+{ echo "$as_me:$LINENO: checking $ac_header presence" >&5
+echo $ECHO_N "checking $ac_header presence... $ECHO_C" >&6; }
 cat >conftest.$ac_ext <<_ACEOF
 /* confdefs.h.  */
 _ACEOF
@@ -6726,24 +11320,22 @@
 /* end confdefs.h.  */
 #include <$ac_header>
 _ACEOF
-if { (eval echo "$as_me:$LINENO: \"$ac_cpp conftest.$ac_ext\"") >&5
-  (eval $ac_cpp conftest.$ac_ext) 2>conftest.er1
+if { (ac_try="$ac_cpp conftest.$ac_ext"
+case "(($ac_try" in
+  *\"* | *\`* | *\\*) ac_try_echo=\$ac_try;;
+  *) ac_try_echo=$ac_try;;
+esac
+eval "echo \"\$as_me:$LINENO: $ac_try_echo\"") >&5
+  (eval "$ac_cpp conftest.$ac_ext") 2>conftest.er1
   ac_status=$?
   grep -v '^ *+' conftest.er1 >conftest.err
   rm -f conftest.er1
   cat conftest.err >&5
   echo "$as_me:$LINENO: \$? = $ac_status" >&5
-  (exit $ac_status); } >/dev/null; then
-  if test -s conftest.err; then
-    ac_cpp_err=$ac_c_preproc_warn_flag
-    ac_cpp_err=$ac_cpp_err$ac_c_werror_flag
-  else
-    ac_cpp_err=
-  fi
-else
-  ac_cpp_err=yes
-fi
-if test -z "$ac_cpp_err"; then
+  (exit $ac_status); } >/dev/null && {
+	 test -z "$ac_c_preproc_warn_flag$ac_c_werror_flag" ||
+	 test ! -s conftest.err
+       }; then
   ac_header_preproc=yes
 else
   echo "$as_me: failed program was:" >&5
@@ -6751,9 +11343,10 @@
 
   ac_header_preproc=no
 fi
+
 rm -f conftest.err conftest.$ac_ext
-echo "$as_me:$LINENO: result: $ac_header_preproc" >&5
-echo "${ECHO_T}$ac_header_preproc" >&6
+{ echo "$as_me:$LINENO: result: $ac_header_preproc" >&5
+echo "${ECHO_T}$ac_header_preproc" >&6; }
 
 # So?  What about this header?
 case $ac_header_compiler:$ac_header_preproc:$ac_c_preproc_warn_flag in
@@ -6777,82 +11370,121 @@
 echo "$as_me: WARNING: $ac_header: proceeding with the preprocessor's result" >&2;}
     { echo "$as_me:$LINENO: WARNING: $ac_header: in the future, the compiler will take precedence" >&5
 echo "$as_me: WARNING: $ac_header: in the future, the compiler will take precedence" >&2;}
-    (
-      cat <<\_ASBOX
+    ( cat <<\_ASBOX
 ## ---------------------------------------------------- ##
 ## Report this to lcd4linux-users@lists.sourceforge.net ##
 ## ---------------------------------------------------- ##
 _ASBOX
-    ) |
-      sed "s/^/$as_me: WARNING:     /" >&2
+     ) | sed "s/^/$as_me: WARNING:     /" >&2
     ;;
 esac
-echo "$as_me:$LINENO: checking for $ac_header" >&5
-echo $ECHO_N "checking for $ac_header... $ECHO_C" >&6
-if eval "test \"\${$as_ac_Header+set}\" = set"; then
+{ echo "$as_me:$LINENO: checking for $ac_header" >&5
+echo $ECHO_N "checking for $ac_header... $ECHO_C" >&6; }
+if { as_var=$as_ac_Header; eval "test \"\${$as_var+set}\" = set"; }; then
   echo $ECHO_N "(cached) $ECHO_C" >&6
 else
   eval "$as_ac_Header=\$ac_header_preproc"
 fi
-echo "$as_me:$LINENO: result: `eval echo '${'$as_ac_Header'}'`" >&5
-echo "${ECHO_T}`eval echo '${'$as_ac_Header'}'`" >&6
+ac_res=`eval echo '${'$as_ac_Header'}'`
+	       { echo "$as_me:$LINENO: result: $ac_res" >&5
+echo "${ECHO_T}$ac_res" >&6; }
 
 fi
 if test `eval echo '${'$as_ac_Header'}'` = yes; then
   cat >>confdefs.h <<_ACEOF
 #define `echo "HAVE_$ac_header" | $as_tr_cpp` 1
 _ACEOF
- has_isdn_header="true"
+ has_ppp_header="true"
 else
-  has_isdn_header="false"
+  has_ppp_header="false"
 fi
 
 done
 
-   if test "$has_dvb_header" = "false"; then
-      { echo "$as_me:$LINENO: WARNING: linux/isdn.h header not found: isdn plugin CPS disabled" >&5
-echo "$as_me: WARNING: linux/isdn.h header not found: isdn plugin CPS disabled" >&2;}
+   if test "$has_ppp_header" = "true"; then
+      PLUGINS="$PLUGINS plugin_ppp.o"
+
+cat >>confdefs.h <<\_ACEOF
+#define PLUGIN_PPP 1
+_ACEOF
+
+   else
+      { echo "$as_me:$LINENO: WARNING: net/if_ppp.h header not found: ppp plugin disabled" >&5
+echo "$as_me: WARNING: net/if_ppp.h header not found: ppp plugin disabled" >&2;}
    fi
-   PLUGINS="$PLUGINS plugin_isdn.o"
+fi
+
+# /proc/stat
+if test "$PLUGIN_PROC_STAT" = "yes"; then
+   PLUGINS="$PLUGINS plugin_proc_stat.o"
 
 cat >>confdefs.h <<\_ACEOF
-#define PLUGIN_ISDN 1
+#define PLUGIN_PROC_STAT 1
 _ACEOF
 
 fi
-if test "$PLUGIN_LOADAVG" = "yes"; then
-   PLUGINS="$PLUGINS plugin_loadavg.o"
+
+# python
+if test "$PLUGIN_PYTHON" = "yes"; then
+   if test "$with_python" != "yes"; then
+      { echo "$as_me:$LINENO: WARNING: python support not enabled: python plugin disabled (use --with-python to enable)" >&5
+echo "$as_me: WARNING: python support not enabled: python plugin disabled (use --with-python to enable)" >&2;}
+   else
+      if test -z "$python_path"; then
+         { echo "$as_me:$LINENO: WARNING: python headers not found: python plugin disabled" >&5
+echo "$as_me: WARNING: python headers not found: python plugin disabled" >&2;}
+      else
+         PLUGINS="$PLUGINS plugin_python.o"
+         CPPFLAGS="$CPPFLAGS $PYTHON_CPPFLAGS"
+         PLUGINLIBS="$PLUGINLIBS $PYTHON_LDFLAGS $PYTHON_EXTRA_LIBS"
 
 cat >>confdefs.h <<\_ACEOF
-#define PLUGIN_LOADAVG 1
+#define PLUGIN_PYTHON 1
 _ACEOF
 
+      fi
+   fi
 fi
-if test "$PLUGIN_MEMINFO" = "yes"; then
-   PLUGINS="$PLUGINS plugin_meminfo.o"
+
+# sample
+if test "$PLUGIN_SAMPLE" = "yes"; then
+   PLUGINS="$PLUGINS plugin_sample.o"
 
 cat >>confdefs.h <<\_ACEOF
-#define PLUGIN_MEMINFO 1
+#define PLUGIN_SAMPLE 1
 _ACEOF
 
 fi
-if test "$PLUGIN_MYSQL" = "yes"; then
 
-for ac_header in mysql/mysql.h
+# SETI
+if test "$PLUGIN_SETI" = "yes"; then
+   PLUGINS="$PLUGINS plugin_seti.o"
+
+cat >>confdefs.h <<\_ACEOF
+#define PLUGIN_SETI 1
+_ACEOF
+
+fi
+
+# statfs()
+if test "$PLUGIN_STATFS" = "yes"; then
+
+for ac_header in sys/vfs.h
 do
 as_ac_Header=`echo "ac_cv_header_$ac_header" | $as_tr_sh`
-if eval "test \"\${$as_ac_Header+set}\" = set"; then
-  echo "$as_me:$LINENO: checking for $ac_header" >&5
-echo $ECHO_N "checking for $ac_header... $ECHO_C" >&6
-if eval "test \"\${$as_ac_Header+set}\" = set"; then
+if { as_var=$as_ac_Header; eval "test \"\${$as_var+set}\" = set"; }; then
+  { echo "$as_me:$LINENO: checking for $ac_header" >&5
+echo $ECHO_N "checking for $ac_header... $ECHO_C" >&6; }
+if { as_var=$as_ac_Header; eval "test \"\${$as_var+set}\" = set"; }; then
   echo $ECHO_N "(cached) $ECHO_C" >&6
 fi
-echo "$as_me:$LINENO: result: `eval echo '${'$as_ac_Header'}'`" >&5
-echo "${ECHO_T}`eval echo '${'$as_ac_Header'}'`" >&6
+ac_res=`eval echo '${'$as_ac_Header'}'`
+	       { echo "$as_me:$LINENO: result: $ac_res" >&5
+echo "${ECHO_T}$ac_res" >&6; }
 else
   # Is the header compilable?
-echo "$as_me:$LINENO: checking $ac_header usability" >&5
-echo $ECHO_N "checking $ac_header usability... $ECHO_C" >&6
+{ echo "$as_me:$LINENO: checking $ac_header usability" >&5
+echo $ECHO_N "checking $ac_header usability... $ECHO_C" >&6; }
 cat >conftest.$ac_ext <<_ACEOF
 /* confdefs.h.  */
 _ACEOF
@@ -6863,40 +11495,37 @@
 #include <$ac_header>
 _ACEOF
 rm -f conftest.$ac_objext
-if { (eval echo "$as_me:$LINENO: \"$ac_compile\"") >&5
-  (eval $ac_compile) 2>conftest.er1
+if { (ac_try="$ac_compile"
+case "(($ac_try" in
+  *\"* | *\`* | *\\*) ac_try_echo=\$ac_try;;
+  *) ac_try_echo=$ac_try;;
+esac
+eval "echo \"\$as_me:$LINENO: $ac_try_echo\"") >&5
+  (eval "$ac_compile") 2>conftest.er1
   ac_status=$?
   grep -v '^ *+' conftest.er1 >conftest.err
   rm -f conftest.er1
   cat conftest.err >&5
   echo "$as_me:$LINENO: \$? = $ac_status" >&5
-  (exit $ac_status); } &&
-	 { ac_try='test -z "$ac_c_werror_flag"			 || test ! -s conftest.err'
-  { (eval echo "$as_me:$LINENO: \"$ac_try\"") >&5
-  (eval $ac_try) 2>&5
-  ac_status=$?
-  echo "$as_me:$LINENO: \$? = $ac_status" >&5
-  (exit $ac_status); }; } &&
-	 { ac_try='test -s conftest.$ac_objext'
-  { (eval echo "$as_me:$LINENO: \"$ac_try\"") >&5
-  (eval $ac_try) 2>&5
-  ac_status=$?
-  echo "$as_me:$LINENO: \$? = $ac_status" >&5
-  (exit $ac_status); }; }; then
+  (exit $ac_status); } && {
+	 test -z "$ac_c_werror_flag" ||
+	 test ! -s conftest.err
+       } && test -s conftest.$ac_objext; then
   ac_header_compiler=yes
 else
   echo "$as_me: failed program was:" >&5
 sed 's/^/| /' conftest.$ac_ext >&5
 
-ac_header_compiler=no
+	ac_header_compiler=no
 fi
-rm -f conftest.err conftest.$ac_objext conftest.$ac_ext
-echo "$as_me:$LINENO: result: $ac_header_compiler" >&5
-echo "${ECHO_T}$ac_header_compiler" >&6
+
+rm -f core conftest.err conftest.$ac_objext conftest.$ac_ext
+{ echo "$as_me:$LINENO: result: $ac_header_compiler" >&5
+echo "${ECHO_T}$ac_header_compiler" >&6; }
 
 # Is the header present?
-echo "$as_me:$LINENO: checking $ac_header presence" >&5
-echo $ECHO_N "checking $ac_header presence... $ECHO_C" >&6
+{ echo "$as_me:$LINENO: checking $ac_header presence" >&5
+echo $ECHO_N "checking $ac_header presence... $ECHO_C" >&6; }
 cat >conftest.$ac_ext <<_ACEOF
 /* confdefs.h.  */
 _ACEOF
@@ -6905,24 +11534,22 @@
 /* end confdefs.h.  */
 #include <$ac_header>
 _ACEOF
-if { (eval echo "$as_me:$LINENO: \"$ac_cpp conftest.$ac_ext\"") >&5
-  (eval $ac_cpp conftest.$ac_ext) 2>conftest.er1
+if { (ac_try="$ac_cpp conftest.$ac_ext"
+case "(($ac_try" in
+  *\"* | *\`* | *\\*) ac_try_echo=\$ac_try;;
+  *) ac_try_echo=$ac_try;;
+esac
+eval "echo \"\$as_me:$LINENO: $ac_try_echo\"") >&5
+  (eval "$ac_cpp conftest.$ac_ext") 2>conftest.er1
   ac_status=$?
   grep -v '^ *+' conftest.er1 >conftest.err
   rm -f conftest.er1
   cat conftest.err >&5
   echo "$as_me:$LINENO: \$? = $ac_status" >&5
-  (exit $ac_status); } >/dev/null; then
-  if test -s conftest.err; then
-    ac_cpp_err=$ac_c_preproc_warn_flag
-    ac_cpp_err=$ac_cpp_err$ac_c_werror_flag
-  else
-    ac_cpp_err=
-  fi
-else
-  ac_cpp_err=yes
-fi
-if test -z "$ac_cpp_err"; then
+  (exit $ac_status); } >/dev/null && {
+	 test -z "$ac_c_preproc_warn_flag$ac_c_werror_flag" ||
+	 test ! -s conftest.err
+       }; then
   ac_header_preproc=yes
 else
   echo "$as_me: failed program was:" >&5
@@ -6930,9 +11557,10 @@
 
   ac_header_preproc=no
 fi
+
 rm -f conftest.err conftest.$ac_ext
-echo "$as_me:$LINENO: result: $ac_header_preproc" >&5
-echo "${ECHO_T}$ac_header_preproc" >&6
+{ echo "$as_me:$LINENO: result: $ac_header_preproc" >&5
+echo "${ECHO_T}$ac_header_preproc" >&6; }
 
 # So?  What about this header?
 case $ac_header_compiler:$ac_header_preproc:$ac_c_preproc_warn_flag in
@@ -6949,165 +11577,105 @@
     { echo "$as_me:$LINENO: WARNING: $ac_header:     check for missing prerequisite headers?" >&5
 echo "$as_me: WARNING: $ac_header:     check for missing prerequisite headers?" >&2;}
     { echo "$as_me:$LINENO: WARNING: $ac_header: see the Autoconf documentation" >&5
-echo "$as_me: WARNING: $ac_header: see the Autoconf documentation" >&2;}
-    { echo "$as_me:$LINENO: WARNING: $ac_header:     section \"Present But Cannot Be Compiled\"" >&5
-echo "$as_me: WARNING: $ac_header:     section \"Present But Cannot Be Compiled\"" >&2;}
-    { echo "$as_me:$LINENO: WARNING: $ac_header: proceeding with the preprocessor's result" >&5
-echo "$as_me: WARNING: $ac_header: proceeding with the preprocessor's result" >&2;}
-    { echo "$as_me:$LINENO: WARNING: $ac_header: in the future, the compiler will take precedence" >&5
-echo "$as_me: WARNING: $ac_header: in the future, the compiler will take precedence" >&2;}
-    (
-      cat <<\_ASBOX
-## ---------------------------------------------------- ##
-## Report this to lcd4linux-users@lists.sourceforge.net ##
-## ---------------------------------------------------- ##
-_ASBOX
-    ) |
-      sed "s/^/$as_me: WARNING:     /" >&2
-    ;;
-esac
-echo "$as_me:$LINENO: checking for $ac_header" >&5
-echo $ECHO_N "checking for $ac_header... $ECHO_C" >&6
-if eval "test \"\${$as_ac_Header+set}\" = set"; then
-  echo $ECHO_N "(cached) $ECHO_C" >&6
-else
-  eval "$as_ac_Header=\$ac_header_preproc"
-fi
-echo "$as_me:$LINENO: result: `eval echo '${'$as_ac_Header'}'`" >&5
-echo "${ECHO_T}`eval echo '${'$as_ac_Header'}'`" >&6
-
-fi
-if test `eval echo '${'$as_ac_Header'}'` = yes; then
-  cat >>confdefs.h <<_ACEOF
-#define `echo "HAVE_$ac_header" | $as_tr_cpp` 1
-_ACEOF
- has_mysql_header="true"
-else
-  has_mysql_header="false"
-fi
-
-done
-
-   if test "$has_mysql_header" = "true"; then
-      echo "$as_me:$LINENO: checking for mysql_init in -lmysqlclient" >&5
-echo $ECHO_N "checking for mysql_init in -lmysqlclient... $ECHO_C" >&6
-if test "${ac_cv_lib_mysqlclient_mysql_init+set}" = set; then
-  echo $ECHO_N "(cached) $ECHO_C" >&6
-else
-  ac_check_lib_save_LIBS=$LIBS
-LIBS="-lmysqlclient  $LIBS"
-cat >conftest.$ac_ext <<_ACEOF
-/* confdefs.h.  */
-_ACEOF
-cat confdefs.h >>conftest.$ac_ext
-cat >>conftest.$ac_ext <<_ACEOF
-/* end confdefs.h.  */
-
-/* Override any gcc2 internal prototype to avoid an error.  */
-#ifdef __cplusplus
-extern "C"
-#endif
-/* We use char because int might match the return type of a gcc2
-   builtin and then its argument prototype would still apply.  */
-char mysql_init ();
-int
-main ()
-{
-mysql_init ();
-  ;
-  return 0;
-}
-_ACEOF
-rm -f conftest.$ac_objext conftest$ac_exeext
-if { (eval echo "$as_me:$LINENO: \"$ac_link\"") >&5
-  (eval $ac_link) 2>conftest.er1
-  ac_status=$?
-  grep -v '^ *+' conftest.er1 >conftest.err
-  rm -f conftest.er1
-  cat conftest.err >&5
-  echo "$as_me:$LINENO: \$? = $ac_status" >&5
-  (exit $ac_status); } &&
-	 { ac_try='test -z "$ac_c_werror_flag"			 || test ! -s conftest.err'
-  { (eval echo "$as_me:$LINENO: \"$ac_try\"") >&5
-  (eval $ac_try) 2>&5
-  ac_status=$?
-  echo "$as_me:$LINENO: \$? = $ac_status" >&5
-  (exit $ac_status); }; } &&
-	 { ac_try='test -s conftest$ac_exeext'
-  { (eval echo "$as_me:$LINENO: \"$ac_try\"") >&5
-  (eval $ac_try) 2>&5
-  ac_status=$?
-  echo "$as_me:$LINENO: \$? = $ac_status" >&5
-  (exit $ac_status); }; }; then
-  ac_cv_lib_mysqlclient_mysql_init=yes
+echo "$as_me: WARNING: $ac_header: see the Autoconf documentation" >&2;}
+    { echo "$as_me:$LINENO: WARNING: $ac_header:     section \"Present But Cannot Be Compiled\"" >&5
+echo "$as_me: WARNING: $ac_header:     section \"Present But Cannot Be Compiled\"" >&2;}
+    { echo "$as_me:$LINENO: WARNING: $ac_header: proceeding with the preprocessor's result" >&5
+echo "$as_me: WARNING: $ac_header: proceeding with the preprocessor's result" >&2;}
+    { echo "$as_me:$LINENO: WARNING: $ac_header: in the future, the compiler will take precedence" >&5
+echo "$as_me: WARNING: $ac_header: in the future, the compiler will take precedence" >&2;}
+    ( cat <<\_ASBOX
+## ---------------------------------------------------- ##
+## Report this to lcd4linux-users@lists.sourceforge.net ##
+## ---------------------------------------------------- ##
+_ASBOX
+     ) | sed "s/^/$as_me: WARNING:     /" >&2
+    ;;
+esac
+{ echo "$as_me:$LINENO: checking for $ac_header" >&5
+echo $ECHO_N "checking for $ac_header... $ECHO_C" >&6; }
+if { as_var=$as_ac_Header; eval "test \"\${$as_var+set}\" = set"; }; then
+  echo $ECHO_N "(cached) $ECHO_C" >&6
 else
-  echo "$as_me: failed program was:" >&5
-sed 's/^/| /' conftest.$ac_ext >&5
-
-ac_cv_lib_mysqlclient_mysql_init=no
+  eval "$as_ac_Header=\$ac_header_preproc"
 fi
-rm -f conftest.err conftest.$ac_objext \
-      conftest$ac_exeext conftest.$ac_ext
-LIBS=$ac_check_lib_save_LIBS
+ac_res=`eval echo '${'$as_ac_Header'}'`
+	       { echo "$as_me:$LINENO: result: $ac_res" >&5
+echo "${ECHO_T}$ac_res" >&6; }
+
 fi
-echo "$as_me:$LINENO: result: $ac_cv_lib_mysqlclient_mysql_init" >&5
-echo "${ECHO_T}$ac_cv_lib_mysqlclient_mysql_init" >&6
-if test $ac_cv_lib_mysqlclient_mysql_init = yes; then
-  has_mysql_lib="true"
+if test `eval echo '${'$as_ac_Header'}'` = yes; then
+  cat >>confdefs.h <<_ACEOF
+#define `echo "HAVE_$ac_header" | $as_tr_cpp` 1
+_ACEOF
+ has_vfs_header="true"
 else
-  has_mysql_lib="false"
+  has_vfs_header="false"
 fi
 
-      if test "$has_mysql_lib" = "true"; then
-        PLUGINS="$PLUGINS plugin_mysql.o"
-        PLUGINLIBS="$PLUGINLIBS -lmysqlclient"
+done
+
+   if test "$has_vfs_header" = "true"; then
+       PLUGINS="$PLUGINS plugin_statfs.o"
 
 cat >>confdefs.h <<\_ACEOF
-#define PLUGIN_MYSQL 1
+#define PLUGIN_STATFS 1
 _ACEOF
 
-      else
-        { echo "$as_me:$LINENO: WARNING: mysqlclient lib not found: mysql plugin disabled" >&5
-echo "$as_me: WARNING: mysqlclient lib not found: mysql plugin disabled" >&2;}
-      fi
    else
-      { echo "$as_me:$LINENO: WARNING: mysql/mysql.h header not found: mysql plugin disabled" >&5
-echo "$as_me: WARNING: mysql/mysql.h header not found: mysql plugin disabled" >&2;}
+      { echo "$as_me:$LINENO: WARNING: sys/vfs.h header not found: statfs plugin disabled" >&5
+echo "$as_me: WARNING: sys/vfs.h header not found: statfs plugin disabled" >&2;}
    fi
 fi
-if test "$PLUGIN_NETDEV" = "yes"; then
-   PLUGINS="$PLUGINS plugin_netdev.o"
+
+# uname
+if test "$PLUGIN_UNAME" = "yes"; then
+   PLUGINS="$PLUGINS plugin_uname.o"
 
 cat >>confdefs.h <<\_ACEOF
-#define PLUGIN_NETDEV 1
+#define PLUGIN_UNAME 1
 _ACEOF
 
 fi
-if test "$PLUGIN_POP3" = "yes"; then
-   PLUGINS="$PLUGINS plugin_pop3.o"
+
+# uptime
+if test "$PLUGIN_UPTIME" = "yes"; then
+   PLUGINS="$PLUGINS plugin_uptime.o"
 
 cat >>confdefs.h <<\_ACEOF
-#define PLUGIN_POP3 1
+#define PLUGIN_UPTIME 1
 _ACEOF
 
 fi
-if test "$PLUGIN_PPP" = "yes"; then
 
-for ac_header in net/if_ppp.h
+if test "$PLUGIN_W1RETAP" = "yes"; then
+   PLUGINS="$PLUGINS plugin_w1retap.o"
+
+cat >>confdefs.h <<\_ACEOF
+#define PLUGIN_W1RETAP 1
+_ACEOF
+
+fi
+
+# WLAN
+if test "$PLUGIN_WIRELESS" = "yes"; then
+
+for ac_header in linux/wireless.h
 do
 as_ac_Header=`echo "ac_cv_header_$ac_header" | $as_tr_sh`
-if eval "test \"\${$as_ac_Header+set}\" = set"; then
-  echo "$as_me:$LINENO: checking for $ac_header" >&5
-echo $ECHO_N "checking for $ac_header... $ECHO_C" >&6
-if eval "test \"\${$as_ac_Header+set}\" = set"; then
+if { as_var=$as_ac_Header; eval "test \"\${$as_var+set}\" = set"; }; then
+  { echo "$as_me:$LINENO: checking for $ac_header" >&5
+echo $ECHO_N "checking for $ac_header... $ECHO_C" >&6; }
+if { as_var=$as_ac_Header; eval "test \"\${$as_var+set}\" = set"; }; then
   echo $ECHO_N "(cached) $ECHO_C" >&6
 fi
-echo "$as_me:$LINENO: result: `eval echo '${'$as_ac_Header'}'`" >&5
-echo "${ECHO_T}`eval echo '${'$as_ac_Header'}'`" >&6
+ac_res=`eval echo '${'$as_ac_Header'}'`
+	       { echo "$as_me:$LINENO: result: $ac_res" >&5
+echo "${ECHO_T}$ac_res" >&6; }
 else
   # Is the header compilable?
-echo "$as_me:$LINENO: checking $ac_header usability" >&5
-echo $ECHO_N "checking $ac_header usability... $ECHO_C" >&6
+{ echo "$as_me:$LINENO: checking $ac_header usability" >&5
+echo $ECHO_N "checking $ac_header usability... $ECHO_C" >&6; }
 cat >conftest.$ac_ext <<_ACEOF
 /* confdefs.h.  */
 _ACEOF
@@ -7118,40 +11686,37 @@
 #include <$ac_header>
 _ACEOF
 rm -f conftest.$ac_objext
-if { (eval echo "$as_me:$LINENO: \"$ac_compile\"") >&5
-  (eval $ac_compile) 2>conftest.er1
+if { (ac_try="$ac_compile"
+case "(($ac_try" in
+  *\"* | *\`* | *\\*) ac_try_echo=\$ac_try;;
+  *) ac_try_echo=$ac_try;;
+esac
+eval "echo \"\$as_me:$LINENO: $ac_try_echo\"") >&5
+  (eval "$ac_compile") 2>conftest.er1
   ac_status=$?
   grep -v '^ *+' conftest.er1 >conftest.err
   rm -f conftest.er1
   cat conftest.err >&5
   echo "$as_me:$LINENO: \$? = $ac_status" >&5
-  (exit $ac_status); } &&
-	 { ac_try='test -z "$ac_c_werror_flag"			 || test ! -s conftest.err'
-  { (eval echo "$as_me:$LINENO: \"$ac_try\"") >&5
-  (eval $ac_try) 2>&5
-  ac_status=$?
-  echo "$as_me:$LINENO: \$? = $ac_status" >&5
-  (exit $ac_status); }; } &&
-	 { ac_try='test -s conftest.$ac_objext'
-  { (eval echo "$as_me:$LINENO: \"$ac_try\"") >&5
-  (eval $ac_try) 2>&5
-  ac_status=$?
-  echo "$as_me:$LINENO: \$? = $ac_status" >&5
-  (exit $ac_status); }; }; then
+  (exit $ac_status); } && {
+	 test -z "$ac_c_werror_flag" ||
+	 test ! -s conftest.err
+       } && test -s conftest.$ac_objext; then
   ac_header_compiler=yes
 else
   echo "$as_me: failed program was:" >&5
 sed 's/^/| /' conftest.$ac_ext >&5
 
-ac_header_compiler=no
+	ac_header_compiler=no
 fi
-rm -f conftest.err conftest.$ac_objext conftest.$ac_ext
-echo "$as_me:$LINENO: result: $ac_header_compiler" >&5
-echo "${ECHO_T}$ac_header_compiler" >&6
+
+rm -f core conftest.err conftest.$ac_objext conftest.$ac_ext
+{ echo "$as_me:$LINENO: result: $ac_header_compiler" >&5
+echo "${ECHO_T}$ac_header_compiler" >&6; }
 
 # Is the header present?
-echo "$as_me:$LINENO: checking $ac_header presence" >&5
-echo $ECHO_N "checking $ac_header presence... $ECHO_C" >&6
+{ echo "$as_me:$LINENO: checking $ac_header presence" >&5
+echo $ECHO_N "checking $ac_header presence... $ECHO_C" >&6; }
 cat >conftest.$ac_ext <<_ACEOF
 /* confdefs.h.  */
 _ACEOF
@@ -7160,24 +11725,22 @@
 /* end confdefs.h.  */
 #include <$ac_header>
 _ACEOF
-if { (eval echo "$as_me:$LINENO: \"$ac_cpp conftest.$ac_ext\"") >&5
-  (eval $ac_cpp conftest.$ac_ext) 2>conftest.er1
+if { (ac_try="$ac_cpp conftest.$ac_ext"
+case "(($ac_try" in
+  *\"* | *\`* | *\\*) ac_try_echo=\$ac_try;;
+  *) ac_try_echo=$ac_try;;
+esac
+eval "echo \"\$as_me:$LINENO: $ac_try_echo\"") >&5
+  (eval "$ac_cpp conftest.$ac_ext") 2>conftest.er1
   ac_status=$?
   grep -v '^ *+' conftest.er1 >conftest.err
   rm -f conftest.er1
   cat conftest.err >&5
   echo "$as_me:$LINENO: \$? = $ac_status" >&5
-  (exit $ac_status); } >/dev/null; then
-  if test -s conftest.err; then
-    ac_cpp_err=$ac_c_preproc_warn_flag
-    ac_cpp_err=$ac_cpp_err$ac_c_werror_flag
-  else
-    ac_cpp_err=
-  fi
-else
-  ac_cpp_err=yes
-fi
-if test -z "$ac_cpp_err"; then
+  (exit $ac_status); } >/dev/null && {
+	 test -z "$ac_c_preproc_warn_flag$ac_c_werror_flag" ||
+	 test ! -s conftest.err
+       }; then
   ac_header_preproc=yes
 else
   echo "$as_me: failed program was:" >&5
@@ -7185,9 +11748,10 @@
 
   ac_header_preproc=no
 fi
+
 rm -f conftest.err conftest.$ac_ext
-echo "$as_me:$LINENO: result: $ac_header_preproc" >&5
-echo "${ECHO_T}$ac_header_preproc" >&6
+{ echo "$as_me:$LINENO: result: $ac_header_preproc" >&5
+echo "${ECHO_T}$ac_header_preproc" >&6; }
 
 # So?  What about this header?
 case $ac_header_compiler:$ac_header_preproc:$ac_c_preproc_warn_flag in
@@ -7211,118 +11775,51 @@
 echo "$as_me: WARNING: $ac_header: proceeding with the preprocessor's result" >&2;}
     { echo "$as_me:$LINENO: WARNING: $ac_header: in the future, the compiler will take precedence" >&5
 echo "$as_me: WARNING: $ac_header: in the future, the compiler will take precedence" >&2;}
-    (
-      cat <<\_ASBOX
+    ( cat <<\_ASBOX
 ## ---------------------------------------------------- ##
 ## Report this to lcd4linux-users@lists.sourceforge.net ##
 ## ---------------------------------------------------- ##
 _ASBOX
-    ) |
-      sed "s/^/$as_me: WARNING:     /" >&2
+     ) | sed "s/^/$as_me: WARNING:     /" >&2
     ;;
 esac
-echo "$as_me:$LINENO: checking for $ac_header" >&5
-echo $ECHO_N "checking for $ac_header... $ECHO_C" >&6
-if eval "test \"\${$as_ac_Header+set}\" = set"; then
+{ echo "$as_me:$LINENO: checking for $ac_header" >&5
+echo $ECHO_N "checking for $ac_header... $ECHO_C" >&6; }
+if { as_var=$as_ac_Header; eval "test \"\${$as_var+set}\" = set"; }; then
   echo $ECHO_N "(cached) $ECHO_C" >&6
 else
   eval "$as_ac_Header=\$ac_header_preproc"
 fi
-echo "$as_me:$LINENO: result: `eval echo '${'$as_ac_Header'}'`" >&5
-echo "${ECHO_T}`eval echo '${'$as_ac_Header'}'`" >&6
+ac_res=`eval echo '${'$as_ac_Header'}'`
+	       { echo "$as_me:$LINENO: result: $ac_res" >&5
+echo "${ECHO_T}$ac_res" >&6; }
 
 fi
 if test `eval echo '${'$as_ac_Header'}'` = yes; then
   cat >>confdefs.h <<_ACEOF
 #define `echo "HAVE_$ac_header" | $as_tr_cpp` 1
 _ACEOF
- has_ppp_header="true"
+ has_wireless_header="true"
 else
-  has_ppp_header="false"
+  has_wireless_header="false"
 fi
 
 done
 
-   if test "$has_ppp_header" = "true"; then
-      PLUGINS="$PLUGINS plugin_ppp.o"
-
-cat >>confdefs.h <<\_ACEOF
-#define PLUGIN_PPP 1
-_ACEOF
-
-   else
-      { echo "$as_me:$LINENO: WARNING: net/if_ppp.h header not found: ppp plugin disabled" >&5
-echo "$as_me: WARNING: net/if_ppp.h header not found: ppp plugin disabled" >&2;}
-   fi
-fi
-if test "$PLUGIN_PROC_STAT" = "yes"; then
-   PLUGINS="$PLUGINS plugin_proc_stat.o"
+   if test "$has_wireless_header" = "true"; then
+       PLUGINS="$PLUGINS plugin_wireless.o"
 
 cat >>confdefs.h <<\_ACEOF
-#define PLUGIN_PROC_STAT 1
+#define PLUGIN_WIRELESS 1
 _ACEOF
 
-fi
-if test "$PLUGIN_PYTHON" = "yes"; then
-   if test "$with_python" != "yes"; then
-      { echo "$as_me:$LINENO: WARNING: python support not enabled: python plugin disabled (use --with-python to enable)" >&5
-echo "$as_me: WARNING: python support not enabled: python plugin disabled (use --with-python to enable)" >&2;}
    else
-      if test -z "$python_path"; then
-         { echo "$as_me:$LINENO: WARNING: python headers not found: python plugin disabled" >&5
-echo "$as_me: WARNING: python headers not found: python plugin disabled" >&2;}
-      else
-         PLUGINS="$PLUGINS plugin_python.o"
-         CPPFLAGS="$CPPFLAGS $PYTHON_CPPFLAGS"
-         PLUGINLIBS="$PLUGINLIBS $PYTHON_LDFLAGS $PYTHON_EXTRA_LIBS"
-
-cat >>confdefs.h <<\_ACEOF
-#define PLUGIN_PYTHON 1
-_ACEOF
-
-      fi
+      { echo "$as_me:$LINENO: WARNING: linux/wireless.h header not found: wireless plugin disabled" >&5
+echo "$as_me: WARNING: linux/wireless.h header not found: wireless plugin disabled" >&2;}
    fi
 fi
-if test "$PLUGIN_SETI" = "yes"; then
-   PLUGINS="$PLUGINS plugin_seti.o"
-
-cat >>confdefs.h <<\_ACEOF
-#define PLUGIN_SETI 1
-_ACEOF
-
-fi
-if test "$PLUGIN_STATFS" = "yes"; then
-   PLUGINS="$PLUGINS plugin_statfs.o"
-
-cat >>confdefs.h <<\_ACEOF
-#define PLUGIN_STATFS 1
-_ACEOF
-
-fi
-if test "$PLUGIN_UNAME" = "yes"; then
-   PLUGINS="$PLUGINS plugin_uname.o"
-
-cat >>confdefs.h <<\_ACEOF
-#define PLUGIN_UNAME 1
-_ACEOF
-
-fi
-if test "$PLUGIN_UPTIME" = "yes"; then
-   PLUGINS="$PLUGINS plugin_uptime.o"
-
-cat >>confdefs.h <<\_ACEOF
-#define PLUGIN_UPTIME 1
-_ACEOF
-
-fi
-if test "$PLUGIN_WIRELESS" = "yes"; then
-   PLUGINS="$PLUGINS plugin_wireless.o"
-
-cat >>confdefs.h <<\_ACEOF
-#define PLUGIN_WIRELESS 1
-_ACEOF
 
-fi
+# XMMS
 if test "$PLUGIN_XMMS" = "yes"; then
    PLUGINS="$PLUGINS plugin_xmms.o"
 
@@ -7332,17 +11829,10 @@
 
 fi
 
-#if test "$PLUGIN_" = "yes"; then
-#   PLUGINS="$PLUGINS plugin_.o"
-#   AC_DEFINE(PLUGIN_,1,[plugin])
-#fi
-
 if test "$PLUGINS" = ""; then
    { { echo "$as_me:$LINENO: error: You should include at least one plugin..." >&5
 echo "$as_me: error: You should include at least one plugin..." >&2;}
    { (exit 1); exit 1; }; }
-#else
-#   AC_MSG_ERROR($PLUGINS)
 fi
 
 
@@ -7358,9 +11848,9 @@
 ac_header_dirent=no
 for ac_hdr in dirent.h sys/ndir.h sys/dir.h ndir.h; do
   as_ac_Header=`echo "ac_cv_header_dirent_$ac_hdr" | $as_tr_sh`
-echo "$as_me:$LINENO: checking for $ac_hdr that defines DIR" >&5
-echo $ECHO_N "checking for $ac_hdr that defines DIR... $ECHO_C" >&6
-if eval "test \"\${$as_ac_Header+set}\" = set"; then
+{ echo "$as_me:$LINENO: checking for $ac_hdr that defines DIR" >&5
+echo $ECHO_N "checking for $ac_hdr that defines DIR... $ECHO_C" >&6; }
+if { as_var=$as_ac_Header; eval "test \"\${$as_var+set}\" = set"; }; then
   echo $ECHO_N "(cached) $ECHO_C" >&6
 else
   cat >conftest.$ac_ext <<_ACEOF
@@ -7382,37 +11872,35 @@
 }
 _ACEOF
 rm -f conftest.$ac_objext
-if { (eval echo "$as_me:$LINENO: \"$ac_compile\"") >&5
-  (eval $ac_compile) 2>conftest.er1
+if { (ac_try="$ac_compile"
+case "(($ac_try" in
+  *\"* | *\`* | *\\*) ac_try_echo=\$ac_try;;
+  *) ac_try_echo=$ac_try;;
+esac
+eval "echo \"\$as_me:$LINENO: $ac_try_echo\"") >&5
+  (eval "$ac_compile") 2>conftest.er1
   ac_status=$?
   grep -v '^ *+' conftest.er1 >conftest.err
   rm -f conftest.er1
   cat conftest.err >&5
   echo "$as_me:$LINENO: \$? = $ac_status" >&5
-  (exit $ac_status); } &&
-	 { ac_try='test -z "$ac_c_werror_flag"			 || test ! -s conftest.err'
-  { (eval echo "$as_me:$LINENO: \"$ac_try\"") >&5
-  (eval $ac_try) 2>&5
-  ac_status=$?
-  echo "$as_me:$LINENO: \$? = $ac_status" >&5
-  (exit $ac_status); }; } &&
-	 { ac_try='test -s conftest.$ac_objext'
-  { (eval echo "$as_me:$LINENO: \"$ac_try\"") >&5
-  (eval $ac_try) 2>&5
-  ac_status=$?
-  echo "$as_me:$LINENO: \$? = $ac_status" >&5
-  (exit $ac_status); }; }; then
+  (exit $ac_status); } && {
+	 test -z "$ac_c_werror_flag" ||
+	 test ! -s conftest.err
+       } && test -s conftest.$ac_objext; then
   eval "$as_ac_Header=yes"
 else
   echo "$as_me: failed program was:" >&5
 sed 's/^/| /' conftest.$ac_ext >&5
 
-eval "$as_ac_Header=no"
+	eval "$as_ac_Header=no"
 fi
-rm -f conftest.err conftest.$ac_objext conftest.$ac_ext
+
+rm -f core conftest.err conftest.$ac_objext conftest.$ac_ext
 fi
-echo "$as_me:$LINENO: result: `eval echo '${'$as_ac_Header'}'`" >&5
-echo "${ECHO_T}`eval echo '${'$as_ac_Header'}'`" >&6
+ac_res=`eval echo '${'$as_ac_Header'}'`
+	       { echo "$as_me:$LINENO: result: $ac_res" >&5
+echo "${ECHO_T}$ac_res" >&6; }
 if test `eval echo '${'$as_ac_Header'}'` = yes; then
   cat >>confdefs.h <<_ACEOF
 #define `echo "HAVE_$ac_hdr" | $as_tr_cpp` 1
@@ -7424,13 +11912,12 @@
 done
 # Two versions of opendir et al. are in -ldir and -lx on SCO Xenix.
 if test $ac_header_dirent = dirent.h; then
-  echo "$as_me:$LINENO: checking for library containing opendir" >&5
-echo $ECHO_N "checking for library containing opendir... $ECHO_C" >&6
+  { echo "$as_me:$LINENO: checking for library containing opendir" >&5
+echo $ECHO_N "checking for library containing opendir... $ECHO_C" >&6; }
 if test "${ac_cv_search_opendir+set}" = set; then
   echo $ECHO_N "(cached) $ECHO_C" >&6
 else
   ac_func_search_save_LIBS=$LIBS
-ac_cv_search_opendir=no
 cat >conftest.$ac_ext <<_ACEOF
 /* confdefs.h.  */
 _ACEOF
@@ -7438,245 +11925,164 @@
 cat >>conftest.$ac_ext <<_ACEOF
 /* end confdefs.h.  */
 
-/* Override any gcc2 internal prototype to avoid an error.  */
+/* Override any GCC internal prototype to avoid an error.
+   Use char because int might match the return type of a GCC
+   builtin and then its argument prototype would still apply.  */
 #ifdef __cplusplus
 extern "C"
 #endif
-/* We use char because int might match the return type of a gcc2
-   builtin and then its argument prototype would still apply.  */
 char opendir ();
 int
 main ()
 {
-opendir ();
+return opendir ();
   ;
   return 0;
 }
 _ACEOF
-rm -f conftest.$ac_objext conftest$ac_exeext
-if { (eval echo "$as_me:$LINENO: \"$ac_link\"") >&5
-  (eval $ac_link) 2>conftest.er1
+for ac_lib in '' dir; do
+  if test -z "$ac_lib"; then
+    ac_res="none required"
+  else
+    ac_res=-l$ac_lib
+    LIBS="-l$ac_lib  $ac_func_search_save_LIBS"
+  fi
+  rm -f conftest.$ac_objext conftest$ac_exeext
+if { (ac_try="$ac_link"
+case "(($ac_try" in
+  *\"* | *\`* | *\\*) ac_try_echo=\$ac_try;;
+  *) ac_try_echo=$ac_try;;
+esac
+eval "echo \"\$as_me:$LINENO: $ac_try_echo\"") >&5
+  (eval "$ac_link") 2>conftest.er1
   ac_status=$?
   grep -v '^ *+' conftest.er1 >conftest.err
   rm -f conftest.er1
   cat conftest.err >&5
   echo "$as_me:$LINENO: \$? = $ac_status" >&5
-  (exit $ac_status); } &&
-	 { ac_try='test -z "$ac_c_werror_flag"			 || test ! -s conftest.err'
-  { (eval echo "$as_me:$LINENO: \"$ac_try\"") >&5
-  (eval $ac_try) 2>&5
-  ac_status=$?
-  echo "$as_me:$LINENO: \$? = $ac_status" >&5
-  (exit $ac_status); }; } &&
-	 { ac_try='test -s conftest$ac_exeext'
-  { (eval echo "$as_me:$LINENO: \"$ac_try\"") >&5
-  (eval $ac_try) 2>&5
-  ac_status=$?
-  echo "$as_me:$LINENO: \$? = $ac_status" >&5
-  (exit $ac_status); }; }; then
-  ac_cv_search_opendir="none required"
+  (exit $ac_status); } && {
+	 test -z "$ac_c_werror_flag" ||
+	 test ! -s conftest.err
+       } && test -s conftest$ac_exeext &&
+       $as_test_x conftest$ac_exeext; then
+  ac_cv_search_opendir=$ac_res
 else
   echo "$as_me: failed program was:" >&5
 sed 's/^/| /' conftest.$ac_ext >&5
 
-fi
-rm -f conftest.err conftest.$ac_objext \
-      conftest$ac_exeext conftest.$ac_ext
-if test "$ac_cv_search_opendir" = no; then
-  for ac_lib in dir; do
-    LIBS="-l$ac_lib  $ac_func_search_save_LIBS"
-    cat >conftest.$ac_ext <<_ACEOF
-/* confdefs.h.  */
-_ACEOF
-cat confdefs.h >>conftest.$ac_ext
-cat >>conftest.$ac_ext <<_ACEOF
-/* end confdefs.h.  */
 
-/* Override any gcc2 internal prototype to avoid an error.  */
-#ifdef __cplusplus
-extern "C"
-#endif
-/* We use char because int might match the return type of a gcc2
-   builtin and then its argument prototype would still apply.  */
-char opendir ();
-int
-main ()
-{
-opendir ();
-  ;
-  return 0;
-}
-_ACEOF
-rm -f conftest.$ac_objext conftest$ac_exeext
-if { (eval echo "$as_me:$LINENO: \"$ac_link\"") >&5
-  (eval $ac_link) 2>conftest.er1
-  ac_status=$?
-  grep -v '^ *+' conftest.er1 >conftest.err
-  rm -f conftest.er1
-  cat conftest.err >&5
-  echo "$as_me:$LINENO: \$? = $ac_status" >&5
-  (exit $ac_status); } &&
-	 { ac_try='test -z "$ac_c_werror_flag"			 || test ! -s conftest.err'
-  { (eval echo "$as_me:$LINENO: \"$ac_try\"") >&5
-  (eval $ac_try) 2>&5
-  ac_status=$?
-  echo "$as_me:$LINENO: \$? = $ac_status" >&5
-  (exit $ac_status); }; } &&
-	 { ac_try='test -s conftest$ac_exeext'
-  { (eval echo "$as_me:$LINENO: \"$ac_try\"") >&5
-  (eval $ac_try) 2>&5
-  ac_status=$?
-  echo "$as_me:$LINENO: \$? = $ac_status" >&5
-  (exit $ac_status); }; }; then
-  ac_cv_search_opendir="-l$ac_lib"
-break
-else
-  echo "$as_me: failed program was:" >&5
-sed 's/^/| /' conftest.$ac_ext >&5
+fi
 
+rm -f core conftest.err conftest.$ac_objext conftest_ipa8_conftest.oo \
+      conftest$ac_exeext
+  if test "${ac_cv_search_opendir+set}" = set; then
+  break
 fi
-rm -f conftest.err conftest.$ac_objext \
-      conftest$ac_exeext conftest.$ac_ext
-  done
+done
+if test "${ac_cv_search_opendir+set}" = set; then
+  :
+else
+  ac_cv_search_opendir=no
 fi
+rm conftest.$ac_ext
 LIBS=$ac_func_search_save_LIBS
 fi
-echo "$as_me:$LINENO: result: $ac_cv_search_opendir" >&5
-echo "${ECHO_T}$ac_cv_search_opendir" >&6
-if test "$ac_cv_search_opendir" != no; then
-  test "$ac_cv_search_opendir" = "none required" || LIBS="$ac_cv_search_opendir $LIBS"
+{ echo "$as_me:$LINENO: result: $ac_cv_search_opendir" >&5
+echo "${ECHO_T}$ac_cv_search_opendir" >&6; }
+ac_res=$ac_cv_search_opendir
+if test "$ac_res" != no; then
+  test "$ac_res" = "none required" || LIBS="$ac_res $LIBS"
 
 fi
 
 else
-  echo "$as_me:$LINENO: checking for library containing opendir" >&5
-echo $ECHO_N "checking for library containing opendir... $ECHO_C" >&6
+  { echo "$as_me:$LINENO: checking for library containing opendir" >&5
+echo $ECHO_N "checking for library containing opendir... $ECHO_C" >&6; }
 if test "${ac_cv_search_opendir+set}" = set; then
   echo $ECHO_N "(cached) $ECHO_C" >&6
 else
-  ac_func_search_save_LIBS=$LIBS
-ac_cv_search_opendir=no
-cat >conftest.$ac_ext <<_ACEOF
-/* confdefs.h.  */
-_ACEOF
-cat confdefs.h >>conftest.$ac_ext
-cat >>conftest.$ac_ext <<_ACEOF
-/* end confdefs.h.  */
-
-/* Override any gcc2 internal prototype to avoid an error.  */
-#ifdef __cplusplus
-extern "C"
-#endif
-/* We use char because int might match the return type of a gcc2
-   builtin and then its argument prototype would still apply.  */
-char opendir ();
-int
-main ()
-{
-opendir ();
-  ;
-  return 0;
-}
-_ACEOF
-rm -f conftest.$ac_objext conftest$ac_exeext
-if { (eval echo "$as_me:$LINENO: \"$ac_link\"") >&5
-  (eval $ac_link) 2>conftest.er1
-  ac_status=$?
-  grep -v '^ *+' conftest.er1 >conftest.err
-  rm -f conftest.er1
-  cat conftest.err >&5
-  echo "$as_me:$LINENO: \$? = $ac_status" >&5
-  (exit $ac_status); } &&
-	 { ac_try='test -z "$ac_c_werror_flag"			 || test ! -s conftest.err'
-  { (eval echo "$as_me:$LINENO: \"$ac_try\"") >&5
-  (eval $ac_try) 2>&5
-  ac_status=$?
-  echo "$as_me:$LINENO: \$? = $ac_status" >&5
-  (exit $ac_status); }; } &&
-	 { ac_try='test -s conftest$ac_exeext'
-  { (eval echo "$as_me:$LINENO: \"$ac_try\"") >&5
-  (eval $ac_try) 2>&5
-  ac_status=$?
-  echo "$as_me:$LINENO: \$? = $ac_status" >&5
-  (exit $ac_status); }; }; then
-  ac_cv_search_opendir="none required"
-else
-  echo "$as_me: failed program was:" >&5
-sed 's/^/| /' conftest.$ac_ext >&5
-
-fi
-rm -f conftest.err conftest.$ac_objext \
-      conftest$ac_exeext conftest.$ac_ext
-if test "$ac_cv_search_opendir" = no; then
-  for ac_lib in x; do
-    LIBS="-l$ac_lib  $ac_func_search_save_LIBS"
-    cat >conftest.$ac_ext <<_ACEOF
+  ac_func_search_save_LIBS=$LIBS
+cat >conftest.$ac_ext <<_ACEOF
 /* confdefs.h.  */
 _ACEOF
 cat confdefs.h >>conftest.$ac_ext
 cat >>conftest.$ac_ext <<_ACEOF
 /* end confdefs.h.  */
 
-/* Override any gcc2 internal prototype to avoid an error.  */
+/* Override any GCC internal prototype to avoid an error.
+   Use char because int might match the return type of a GCC
+   builtin and then its argument prototype would still apply.  */
 #ifdef __cplusplus
 extern "C"
 #endif
-/* We use char because int might match the return type of a gcc2
-   builtin and then its argument prototype would still apply.  */
 char opendir ();
 int
 main ()
 {
-opendir ();
+return opendir ();
   ;
   return 0;
 }
 _ACEOF
-rm -f conftest.$ac_objext conftest$ac_exeext
-if { (eval echo "$as_me:$LINENO: \"$ac_link\"") >&5
-  (eval $ac_link) 2>conftest.er1
+for ac_lib in '' x; do
+  if test -z "$ac_lib"; then
+    ac_res="none required"
+  else
+    ac_res=-l$ac_lib
+    LIBS="-l$ac_lib  $ac_func_search_save_LIBS"
+  fi
+  rm -f conftest.$ac_objext conftest$ac_exeext
+if { (ac_try="$ac_link"
+case "(($ac_try" in
+  *\"* | *\`* | *\\*) ac_try_echo=\$ac_try;;
+  *) ac_try_echo=$ac_try;;
+esac
+eval "echo \"\$as_me:$LINENO: $ac_try_echo\"") >&5
+  (eval "$ac_link") 2>conftest.er1
   ac_status=$?
   grep -v '^ *+' conftest.er1 >conftest.err
   rm -f conftest.er1
   cat conftest.err >&5
   echo "$as_me:$LINENO: \$? = $ac_status" >&5
-  (exit $ac_status); } &&
-	 { ac_try='test -z "$ac_c_werror_flag"			 || test ! -s conftest.err'
-  { (eval echo "$as_me:$LINENO: \"$ac_try\"") >&5
-  (eval $ac_try) 2>&5
-  ac_status=$?
-  echo "$as_me:$LINENO: \$? = $ac_status" >&5
-  (exit $ac_status); }; } &&
-	 { ac_try='test -s conftest$ac_exeext'
-  { (eval echo "$as_me:$LINENO: \"$ac_try\"") >&5
-  (eval $ac_try) 2>&5
-  ac_status=$?
-  echo "$as_me:$LINENO: \$? = $ac_status" >&5
-  (exit $ac_status); }; }; then
-  ac_cv_search_opendir="-l$ac_lib"
-break
+  (exit $ac_status); } && {
+	 test -z "$ac_c_werror_flag" ||
+	 test ! -s conftest.err
+       } && test -s conftest$ac_exeext &&
+       $as_test_x conftest$ac_exeext; then
+  ac_cv_search_opendir=$ac_res
 else
   echo "$as_me: failed program was:" >&5
 sed 's/^/| /' conftest.$ac_ext >&5
 
+
 fi
-rm -f conftest.err conftest.$ac_objext \
-      conftest$ac_exeext conftest.$ac_ext
-  done
+
+rm -f core conftest.err conftest.$ac_objext conftest_ipa8_conftest.oo \
+      conftest$ac_exeext
+  if test "${ac_cv_search_opendir+set}" = set; then
+  break
+fi
+done
+if test "${ac_cv_search_opendir+set}" = set; then
+  :
+else
+  ac_cv_search_opendir=no
 fi
+rm conftest.$ac_ext
 LIBS=$ac_func_search_save_LIBS
 fi
-echo "$as_me:$LINENO: result: $ac_cv_search_opendir" >&5
-echo "${ECHO_T}$ac_cv_search_opendir" >&6
-if test "$ac_cv_search_opendir" != no; then
-  test "$ac_cv_search_opendir" = "none required" || LIBS="$ac_cv_search_opendir $LIBS"
+{ echo "$as_me:$LINENO: result: $ac_cv_search_opendir" >&5
+echo "${ECHO_T}$ac_cv_search_opendir" >&6; }
+ac_res=$ac_cv_search_opendir
+if test "$ac_res" != no; then
+  test "$ac_res" = "none required" || LIBS="$ac_res $LIBS"
 
 fi
 
 fi
 
-echo "$as_me:$LINENO: checking for ANSI C header files" >&5
-echo $ECHO_N "checking for ANSI C header files... $ECHO_C" >&6
+{ echo "$as_me:$LINENO: checking for ANSI C header files" >&5
+echo $ECHO_N "checking for ANSI C header files... $ECHO_C" >&6; }
 if test "${ac_cv_header_stdc+set}" = set; then
   echo $ECHO_N "(cached) $ECHO_C" >&6
 else
@@ -7700,34 +12106,31 @@
 }
 _ACEOF
 rm -f conftest.$ac_objext
-if { (eval echo "$as_me:$LINENO: \"$ac_compile\"") >&5
-  (eval $ac_compile) 2>conftest.er1
+if { (ac_try="$ac_compile"
+case "(($ac_try" in
+  *\"* | *\`* | *\\*) ac_try_echo=\$ac_try;;
+  *) ac_try_echo=$ac_try;;
+esac
+eval "echo \"\$as_me:$LINENO: $ac_try_echo\"") >&5
+  (eval "$ac_compile") 2>conftest.er1
   ac_status=$?
   grep -v '^ *+' conftest.er1 >conftest.err
   rm -f conftest.er1
   cat conftest.err >&5
   echo "$as_me:$LINENO: \$? = $ac_status" >&5
-  (exit $ac_status); } &&
-	 { ac_try='test -z "$ac_c_werror_flag"			 || test ! -s conftest.err'
-  { (eval echo "$as_me:$LINENO: \"$ac_try\"") >&5
-  (eval $ac_try) 2>&5
-  ac_status=$?
-  echo "$as_me:$LINENO: \$? = $ac_status" >&5
-  (exit $ac_status); }; } &&
-	 { ac_try='test -s conftest.$ac_objext'
-  { (eval echo "$as_me:$LINENO: \"$ac_try\"") >&5
-  (eval $ac_try) 2>&5
-  ac_status=$?
-  echo "$as_me:$LINENO: \$? = $ac_status" >&5
-  (exit $ac_status); }; }; then
+  (exit $ac_status); } && {
+	 test -z "$ac_c_werror_flag" ||
+	 test ! -s conftest.err
+       } && test -s conftest.$ac_objext; then
   ac_cv_header_stdc=yes
 else
   echo "$as_me: failed program was:" >&5
 sed 's/^/| /' conftest.$ac_ext >&5
 
-ac_cv_header_stdc=no
+	ac_cv_header_stdc=no
 fi
-rm -f conftest.err conftest.$ac_objext conftest.$ac_ext
+
+rm -f core conftest.err conftest.$ac_objext conftest.$ac_ext
 
 if test $ac_cv_header_stdc = yes; then
   # SunOS 4.x string.h does not declare mem*, contrary to ANSI.
@@ -7783,6 +12186,7 @@
 cat >>conftest.$ac_ext <<_ACEOF
 /* end confdefs.h.  */
 #include <ctype.h>
+#include <stdlib.h>
 #if ((' ' & 0x0FF) == 0x020)
 # define ISLOWER(c) ('a' <= (c) && (c) <= 'z')
 # define TOUPPER(c) (ISLOWER(c) ? 'A' + ((c) - 'a') : (c))
@@ -7802,18 +12206,27 @@
   for (i = 0; i < 256; i++)
     if (XOR (islower (i), ISLOWER (i))
 	|| toupper (i) != TOUPPER (i))
-      exit(2);
-  exit (0);
+      return 2;
+  return 0;
 }
 _ACEOF
 rm -f conftest$ac_exeext
-if { (eval echo "$as_me:$LINENO: \"$ac_link\"") >&5
-  (eval $ac_link) 2>&5
+if { (ac_try="$ac_link"
+case "(($ac_try" in
+  *\"* | *\`* | *\\*) ac_try_echo=\$ac_try;;
+  *) ac_try_echo=$ac_try;;
+esac
+eval "echo \"\$as_me:$LINENO: $ac_try_echo\"") >&5
+  (eval "$ac_link") 2>&5
   ac_status=$?
   echo "$as_me:$LINENO: \$? = $ac_status" >&5
   (exit $ac_status); } && { ac_try='./conftest$ac_exeext'
-  { (eval echo "$as_me:$LINENO: \"$ac_try\"") >&5
-  (eval $ac_try) 2>&5
+  { (case "(($ac_try" in
+  *\"* | *\`* | *\\*) ac_try_echo=\$ac_try;;
+  *) ac_try_echo=$ac_try;;
+esac
+eval "echo \"\$as_me:$LINENO: $ac_try_echo\"") >&5
+  (eval "$ac_try") 2>&5
   ac_status=$?
   echo "$as_me:$LINENO: \$? = $ac_status" >&5
   (exit $ac_status); }; }; then
@@ -7826,12 +12239,14 @@
 ( exit $ac_status )
 ac_cv_header_stdc=no
 fi
-rm -f core *.core gmon.out bb.out conftest$ac_exeext conftest.$ac_objext conftest.$ac_ext
+rm -f core *.core core.conftest.* gmon.out bb.out conftest$ac_exeext conftest.$ac_objext conftest.$ac_ext
 fi
+
+
 fi
 fi
-echo "$as_me:$LINENO: result: $ac_cv_header_stdc" >&5
-echo "${ECHO_T}$ac_cv_header_stdc" >&6
+{ echo "$as_me:$LINENO: result: $ac_cv_header_stdc" >&5
+echo "${ECHO_T}$ac_cv_header_stdc" >&6; }
 if test $ac_cv_header_stdc = yes; then
 
 cat >>confdefs.h <<\_ACEOF
@@ -7853,22 +12268,22 @@
 
 
 
-
-for ac_header in arpa/inet.h fcntl.h netdb.h netinet/in.h stdlib.h string.h sys/ioctl.h sys/socket.h sys/statfs.h sys/vfs.h sys/time.h syslog.h termios.h unistd.h
+for ac_header in arpa/inet.h fcntl.h netdb.h netinet/in.h stdlib.h string.h sys/ioctl.h sys/socket.h sys/time.h sys/vfs.h syslog.h termios.h unistd.h
 do
 as_ac_Header=`echo "ac_cv_header_$ac_header" | $as_tr_sh`
-if eval "test \"\${$as_ac_Header+set}\" = set"; then
-  echo "$as_me:$LINENO: checking for $ac_header" >&5
-echo $ECHO_N "checking for $ac_header... $ECHO_C" >&6
-if eval "test \"\${$as_ac_Header+set}\" = set"; then
+if { as_var=$as_ac_Header; eval "test \"\${$as_var+set}\" = set"; }; then
+  { echo "$as_me:$LINENO: checking for $ac_header" >&5
+echo $ECHO_N "checking for $ac_header... $ECHO_C" >&6; }
+if { as_var=$as_ac_Header; eval "test \"\${$as_var+set}\" = set"; }; then
   echo $ECHO_N "(cached) $ECHO_C" >&6
 fi
-echo "$as_me:$LINENO: result: `eval echo '${'$as_ac_Header'}'`" >&5
-echo "${ECHO_T}`eval echo '${'$as_ac_Header'}'`" >&6
+ac_res=`eval echo '${'$as_ac_Header'}'`
+	       { echo "$as_me:$LINENO: result: $ac_res" >&5
+echo "${ECHO_T}$ac_res" >&6; }
 else
   # Is the header compilable?
-echo "$as_me:$LINENO: checking $ac_header usability" >&5
-echo $ECHO_N "checking $ac_header usability... $ECHO_C" >&6
+{ echo "$as_me:$LINENO: checking $ac_header usability" >&5
+echo $ECHO_N "checking $ac_header usability... $ECHO_C" >&6; }
 cat >conftest.$ac_ext <<_ACEOF
 /* confdefs.h.  */
 _ACEOF
@@ -7879,40 +12294,37 @@
 #include <$ac_header>
 _ACEOF
 rm -f conftest.$ac_objext
-if { (eval echo "$as_me:$LINENO: \"$ac_compile\"") >&5
-  (eval $ac_compile) 2>conftest.er1
+if { (ac_try="$ac_compile"
+case "(($ac_try" in
+  *\"* | *\`* | *\\*) ac_try_echo=\$ac_try;;
+  *) ac_try_echo=$ac_try;;
+esac
+eval "echo \"\$as_me:$LINENO: $ac_try_echo\"") >&5
+  (eval "$ac_compile") 2>conftest.er1
   ac_status=$?
   grep -v '^ *+' conftest.er1 >conftest.err
   rm -f conftest.er1
   cat conftest.err >&5
   echo "$as_me:$LINENO: \$? = $ac_status" >&5
-  (exit $ac_status); } &&
-	 { ac_try='test -z "$ac_c_werror_flag"			 || test ! -s conftest.err'
-  { (eval echo "$as_me:$LINENO: \"$ac_try\"") >&5
-  (eval $ac_try) 2>&5
-  ac_status=$?
-  echo "$as_me:$LINENO: \$? = $ac_status" >&5
-  (exit $ac_status); }; } &&
-	 { ac_try='test -s conftest.$ac_objext'
-  { (eval echo "$as_me:$LINENO: \"$ac_try\"") >&5
-  (eval $ac_try) 2>&5
-  ac_status=$?
-  echo "$as_me:$LINENO: \$? = $ac_status" >&5
-  (exit $ac_status); }; }; then
+  (exit $ac_status); } && {
+	 test -z "$ac_c_werror_flag" ||
+	 test ! -s conftest.err
+       } && test -s conftest.$ac_objext; then
   ac_header_compiler=yes
 else
   echo "$as_me: failed program was:" >&5
 sed 's/^/| /' conftest.$ac_ext >&5
 
-ac_header_compiler=no
+	ac_header_compiler=no
 fi
-rm -f conftest.err conftest.$ac_objext conftest.$ac_ext
-echo "$as_me:$LINENO: result: $ac_header_compiler" >&5
-echo "${ECHO_T}$ac_header_compiler" >&6
+
+rm -f core conftest.err conftest.$ac_objext conftest.$ac_ext
+{ echo "$as_me:$LINENO: result: $ac_header_compiler" >&5
+echo "${ECHO_T}$ac_header_compiler" >&6; }
 
 # Is the header present?
-echo "$as_me:$LINENO: checking $ac_header presence" >&5
-echo $ECHO_N "checking $ac_header presence... $ECHO_C" >&6
+{ echo "$as_me:$LINENO: checking $ac_header presence" >&5
+echo $ECHO_N "checking $ac_header presence... $ECHO_C" >&6; }
 cat >conftest.$ac_ext <<_ACEOF
 /* confdefs.h.  */
 _ACEOF
@@ -7921,24 +12333,22 @@
 /* end confdefs.h.  */
 #include <$ac_header>
 _ACEOF
-if { (eval echo "$as_me:$LINENO: \"$ac_cpp conftest.$ac_ext\"") >&5
-  (eval $ac_cpp conftest.$ac_ext) 2>conftest.er1
+if { (ac_try="$ac_cpp conftest.$ac_ext"
+case "(($ac_try" in
+  *\"* | *\`* | *\\*) ac_try_echo=\$ac_try;;
+  *) ac_try_echo=$ac_try;;
+esac
+eval "echo \"\$as_me:$LINENO: $ac_try_echo\"") >&5
+  (eval "$ac_cpp conftest.$ac_ext") 2>conftest.er1
   ac_status=$?
   grep -v '^ *+' conftest.er1 >conftest.err
   rm -f conftest.er1
   cat conftest.err >&5
   echo "$as_me:$LINENO: \$? = $ac_status" >&5
-  (exit $ac_status); } >/dev/null; then
-  if test -s conftest.err; then
-    ac_cpp_err=$ac_c_preproc_warn_flag
-    ac_cpp_err=$ac_cpp_err$ac_c_werror_flag
-  else
-    ac_cpp_err=
-  fi
-else
-  ac_cpp_err=yes
-fi
-if test -z "$ac_cpp_err"; then
+  (exit $ac_status); } >/dev/null && {
+	 test -z "$ac_c_preproc_warn_flag$ac_c_werror_flag" ||
+	 test ! -s conftest.err
+       }; then
   ac_header_preproc=yes
 else
   echo "$as_me: failed program was:" >&5
@@ -7946,9 +12356,10 @@
 
   ac_header_preproc=no
 fi
+
 rm -f conftest.err conftest.$ac_ext
-echo "$as_me:$LINENO: result: $ac_header_preproc" >&5
-echo "${ECHO_T}$ac_header_preproc" >&6
+{ echo "$as_me:$LINENO: result: $ac_header_preproc" >&5
+echo "${ECHO_T}$ac_header_preproc" >&6; }
 
 # So?  What about this header?
 case $ac_header_compiler:$ac_header_preproc:$ac_c_preproc_warn_flag in
@@ -7972,25 +12383,24 @@
 echo "$as_me: WARNING: $ac_header: proceeding with the preprocessor's result" >&2;}
     { echo "$as_me:$LINENO: WARNING: $ac_header: in the future, the compiler will take precedence" >&5
 echo "$as_me: WARNING: $ac_header: in the future, the compiler will take precedence" >&2;}
-    (
-      cat <<\_ASBOX
+    ( cat <<\_ASBOX
 ## ---------------------------------------------------- ##
 ## Report this to lcd4linux-users@lists.sourceforge.net ##
 ## ---------------------------------------------------- ##
 _ASBOX
-    ) |
-      sed "s/^/$as_me: WARNING:     /" >&2
+     ) | sed "s/^/$as_me: WARNING:     /" >&2
     ;;
 esac
-echo "$as_me:$LINENO: checking for $ac_header" >&5
-echo $ECHO_N "checking for $ac_header... $ECHO_C" >&6
-if eval "test \"\${$as_ac_Header+set}\" = set"; then
+{ echo "$as_me:$LINENO: checking for $ac_header" >&5
+echo $ECHO_N "checking for $ac_header... $ECHO_C" >&6; }
+if { as_var=$as_ac_Header; eval "test \"\${$as_var+set}\" = set"; }; then
   echo $ECHO_N "(cached) $ECHO_C" >&6
 else
   eval "$as_ac_Header=\$ac_header_preproc"
 fi
-echo "$as_me:$LINENO: result: `eval echo '${'$as_ac_Header'}'`" >&5
-echo "${ECHO_T}`eval echo '${'$as_ac_Header'}'`" >&6
+ac_res=`eval echo '${'$as_ac_Header'}'`
+	       { echo "$as_me:$LINENO: result: $ac_res" >&5
+echo "${ECHO_T}$ac_res" >&6; }
 
 fi
 if test `eval echo '${'$as_ac_Header'}'` = yes; then
@@ -8003,22 +12413,22 @@
 done
 
 
-
-for ac_header in sys/io.h asm/io.h
+for ac_header in asm/io.h
 do
 as_ac_Header=`echo "ac_cv_header_$ac_header" | $as_tr_sh`
-if eval "test \"\${$as_ac_Header+set}\" = set"; then
-  echo "$as_me:$LINENO: checking for $ac_header" >&5
-echo $ECHO_N "checking for $ac_header... $ECHO_C" >&6
-if eval "test \"\${$as_ac_Header+set}\" = set"; then
+if { as_var=$as_ac_Header; eval "test \"\${$as_var+set}\" = set"; }; then
+  { echo "$as_me:$LINENO: checking for $ac_header" >&5
+echo $ECHO_N "checking for $ac_header... $ECHO_C" >&6; }
+if { as_var=$as_ac_Header; eval "test \"\${$as_var+set}\" = set"; }; then
   echo $ECHO_N "(cached) $ECHO_C" >&6
 fi
-echo "$as_me:$LINENO: result: `eval echo '${'$as_ac_Header'}'`" >&5
-echo "${ECHO_T}`eval echo '${'$as_ac_Header'}'`" >&6
+ac_res=`eval echo '${'$as_ac_Header'}'`
+	       { echo "$as_me:$LINENO: result: $ac_res" >&5
+echo "${ECHO_T}$ac_res" >&6; }
 else
   # Is the header compilable?
-echo "$as_me:$LINENO: checking $ac_header usability" >&5
-echo $ECHO_N "checking $ac_header usability... $ECHO_C" >&6
+{ echo "$as_me:$LINENO: checking $ac_header usability" >&5
+echo $ECHO_N "checking $ac_header usability... $ECHO_C" >&6; }
 cat >conftest.$ac_ext <<_ACEOF
 /* confdefs.h.  */
 _ACEOF
@@ -8029,40 +12439,37 @@
 #include <$ac_header>
 _ACEOF
 rm -f conftest.$ac_objext
-if { (eval echo "$as_me:$LINENO: \"$ac_compile\"") >&5
-  (eval $ac_compile) 2>conftest.er1
+if { (ac_try="$ac_compile"
+case "(($ac_try" in
+  *\"* | *\`* | *\\*) ac_try_echo=\$ac_try;;
+  *) ac_try_echo=$ac_try;;
+esac
+eval "echo \"\$as_me:$LINENO: $ac_try_echo\"") >&5
+  (eval "$ac_compile") 2>conftest.er1
   ac_status=$?
   grep -v '^ *+' conftest.er1 >conftest.err
   rm -f conftest.er1
   cat conftest.err >&5
   echo "$as_me:$LINENO: \$? = $ac_status" >&5
-  (exit $ac_status); } &&
-	 { ac_try='test -z "$ac_c_werror_flag"			 || test ! -s conftest.err'
-  { (eval echo "$as_me:$LINENO: \"$ac_try\"") >&5
-  (eval $ac_try) 2>&5
-  ac_status=$?
-  echo "$as_me:$LINENO: \$? = $ac_status" >&5
-  (exit $ac_status); }; } &&
-	 { ac_try='test -s conftest.$ac_objext'
-  { (eval echo "$as_me:$LINENO: \"$ac_try\"") >&5
-  (eval $ac_try) 2>&5
-  ac_status=$?
-  echo "$as_me:$LINENO: \$? = $ac_status" >&5
-  (exit $ac_status); }; }; then
+  (exit $ac_status); } && {
+	 test -z "$ac_c_werror_flag" ||
+	 test ! -s conftest.err
+       } && test -s conftest.$ac_objext; then
   ac_header_compiler=yes
 else
   echo "$as_me: failed program was:" >&5
 sed 's/^/| /' conftest.$ac_ext >&5
 
-ac_header_compiler=no
+	ac_header_compiler=no
 fi
-rm -f conftest.err conftest.$ac_objext conftest.$ac_ext
-echo "$as_me:$LINENO: result: $ac_header_compiler" >&5
-echo "${ECHO_T}$ac_header_compiler" >&6
+
+rm -f core conftest.err conftest.$ac_objext conftest.$ac_ext
+{ echo "$as_me:$LINENO: result: $ac_header_compiler" >&5
+echo "${ECHO_T}$ac_header_compiler" >&6; }
 
 # Is the header present?
-echo "$as_me:$LINENO: checking $ac_header presence" >&5
-echo $ECHO_N "checking $ac_header presence... $ECHO_C" >&6
+{ echo "$as_me:$LINENO: checking $ac_header presence" >&5
+echo $ECHO_N "checking $ac_header presence... $ECHO_C" >&6; }
 cat >conftest.$ac_ext <<_ACEOF
 /* confdefs.h.  */
 _ACEOF
@@ -8071,24 +12478,22 @@
 /* end confdefs.h.  */
 #include <$ac_header>
 _ACEOF
-if { (eval echo "$as_me:$LINENO: \"$ac_cpp conftest.$ac_ext\"") >&5
-  (eval $ac_cpp conftest.$ac_ext) 2>conftest.er1
+if { (ac_try="$ac_cpp conftest.$ac_ext"
+case "(($ac_try" in
+  *\"* | *\`* | *\\*) ac_try_echo=\$ac_try;;
+  *) ac_try_echo=$ac_try;;
+esac
+eval "echo \"\$as_me:$LINENO: $ac_try_echo\"") >&5
+  (eval "$ac_cpp conftest.$ac_ext") 2>conftest.er1
   ac_status=$?
   grep -v '^ *+' conftest.er1 >conftest.err
   rm -f conftest.er1
   cat conftest.err >&5
   echo "$as_me:$LINENO: \$? = $ac_status" >&5
-  (exit $ac_status); } >/dev/null; then
-  if test -s conftest.err; then
-    ac_cpp_err=$ac_c_preproc_warn_flag
-    ac_cpp_err=$ac_cpp_err$ac_c_werror_flag
-  else
-    ac_cpp_err=
-  fi
-else
-  ac_cpp_err=yes
-fi
-if test -z "$ac_cpp_err"; then
+  (exit $ac_status); } >/dev/null && {
+	 test -z "$ac_c_preproc_warn_flag$ac_c_werror_flag" ||
+	 test ! -s conftest.err
+       }; then
   ac_header_preproc=yes
 else
   echo "$as_me: failed program was:" >&5
@@ -8096,9 +12501,10 @@
 
   ac_header_preproc=no
 fi
+
 rm -f conftest.err conftest.$ac_ext
-echo "$as_me:$LINENO: result: $ac_header_preproc" >&5
-echo "${ECHO_T}$ac_header_preproc" >&6
+{ echo "$as_me:$LINENO: result: $ac_header_preproc" >&5
+echo "${ECHO_T}$ac_header_preproc" >&6; }
 
 # So?  What about this header?
 case $ac_header_compiler:$ac_header_preproc:$ac_c_preproc_warn_flag in
@@ -8122,25 +12528,24 @@
 echo "$as_me: WARNING: $ac_header: proceeding with the preprocessor's result" >&2;}
     { echo "$as_me:$LINENO: WARNING: $ac_header: in the future, the compiler will take precedence" >&5
 echo "$as_me: WARNING: $ac_header: in the future, the compiler will take precedence" >&2;}
-    (
-      cat <<\_ASBOX
+    ( cat <<\_ASBOX
 ## ---------------------------------------------------- ##
 ## Report this to lcd4linux-users@lists.sourceforge.net ##
 ## ---------------------------------------------------- ##
 _ASBOX
-    ) |
-      sed "s/^/$as_me: WARNING:     /" >&2
+     ) | sed "s/^/$as_me: WARNING:     /" >&2
     ;;
 esac
-echo "$as_me:$LINENO: checking for $ac_header" >&5
-echo $ECHO_N "checking for $ac_header... $ECHO_C" >&6
-if eval "test \"\${$as_ac_Header+set}\" = set"; then
+{ echo "$as_me:$LINENO: checking for $ac_header" >&5
+echo $ECHO_N "checking for $ac_header... $ECHO_C" >&6; }
+if { as_var=$as_ac_Header; eval "test \"\${$as_var+set}\" = set"; }; then
   echo $ECHO_N "(cached) $ECHO_C" >&6
 else
   eval "$as_ac_Header=\$ac_header_preproc"
 fi
-echo "$as_me:$LINENO: result: `eval echo '${'$as_ac_Header'}'`" >&5
-echo "${ECHO_T}`eval echo '${'$as_ac_Header'}'`" >&6
+ac_res=`eval echo '${'$as_ac_Header'}'`
+	       { echo "$as_me:$LINENO: result: $ac_res" >&5
+echo "${ECHO_T}$ac_res" >&6; }
 
 fi
 if test `eval echo '${'$as_ac_Header'}'` = yes; then
@@ -8157,18 +12562,19 @@
 for ac_header in linux/parport.h linux/ppdev.h
 do
 as_ac_Header=`echo "ac_cv_header_$ac_header" | $as_tr_sh`
-if eval "test \"\${$as_ac_Header+set}\" = set"; then
-  echo "$as_me:$LINENO: checking for $ac_header" >&5
-echo $ECHO_N "checking for $ac_header... $ECHO_C" >&6
-if eval "test \"\${$as_ac_Header+set}\" = set"; then
+if { as_var=$as_ac_Header; eval "test \"\${$as_var+set}\" = set"; }; then
+  { echo "$as_me:$LINENO: checking for $ac_header" >&5
+echo $ECHO_N "checking for $ac_header... $ECHO_C" >&6; }
+if { as_var=$as_ac_Header; eval "test \"\${$as_var+set}\" = set"; }; then
   echo $ECHO_N "(cached) $ECHO_C" >&6
 fi
-echo "$as_me:$LINENO: result: `eval echo '${'$as_ac_Header'}'`" >&5
-echo "${ECHO_T}`eval echo '${'$as_ac_Header'}'`" >&6
+ac_res=`eval echo '${'$as_ac_Header'}'`
+	       { echo "$as_me:$LINENO: result: $ac_res" >&5
+echo "${ECHO_T}$ac_res" >&6; }
 else
   # Is the header compilable?
-echo "$as_me:$LINENO: checking $ac_header usability" >&5
-echo $ECHO_N "checking $ac_header usability... $ECHO_C" >&6
+{ echo "$as_me:$LINENO: checking $ac_header usability" >&5
+echo $ECHO_N "checking $ac_header usability... $ECHO_C" >&6; }
 cat >conftest.$ac_ext <<_ACEOF
 /* confdefs.h.  */
 _ACEOF
@@ -8179,189 +12585,37 @@
 #include <$ac_header>
 _ACEOF
 rm -f conftest.$ac_objext
-if { (eval echo "$as_me:$LINENO: \"$ac_compile\"") >&5
-  (eval $ac_compile) 2>conftest.er1
-  ac_status=$?
-  grep -v '^ *+' conftest.er1 >conftest.err
-  rm -f conftest.er1
-  cat conftest.err >&5
-  echo "$as_me:$LINENO: \$? = $ac_status" >&5
-  (exit $ac_status); } &&
-	 { ac_try='test -z "$ac_c_werror_flag"			 || test ! -s conftest.err'
-  { (eval echo "$as_me:$LINENO: \"$ac_try\"") >&5
-  (eval $ac_try) 2>&5
-  ac_status=$?
-  echo "$as_me:$LINENO: \$? = $ac_status" >&5
-  (exit $ac_status); }; } &&
-	 { ac_try='test -s conftest.$ac_objext'
-  { (eval echo "$as_me:$LINENO: \"$ac_try\"") >&5
-  (eval $ac_try) 2>&5
-  ac_status=$?
-  echo "$as_me:$LINENO: \$? = $ac_status" >&5
-  (exit $ac_status); }; }; then
-  ac_header_compiler=yes
-else
-  echo "$as_me: failed program was:" >&5
-sed 's/^/| /' conftest.$ac_ext >&5
-
-ac_header_compiler=no
-fi
-rm -f conftest.err conftest.$ac_objext conftest.$ac_ext
-echo "$as_me:$LINENO: result: $ac_header_compiler" >&5
-echo "${ECHO_T}$ac_header_compiler" >&6
-
-# Is the header present?
-echo "$as_me:$LINENO: checking $ac_header presence" >&5
-echo $ECHO_N "checking $ac_header presence... $ECHO_C" >&6
-cat >conftest.$ac_ext <<_ACEOF
-/* confdefs.h.  */
-_ACEOF
-cat confdefs.h >>conftest.$ac_ext
-cat >>conftest.$ac_ext <<_ACEOF
-/* end confdefs.h.  */
-#include <$ac_header>
-_ACEOF
-if { (eval echo "$as_me:$LINENO: \"$ac_cpp conftest.$ac_ext\"") >&5
-  (eval $ac_cpp conftest.$ac_ext) 2>conftest.er1
-  ac_status=$?
-  grep -v '^ *+' conftest.er1 >conftest.err
-  rm -f conftest.er1
-  cat conftest.err >&5
-  echo "$as_me:$LINENO: \$? = $ac_status" >&5
-  (exit $ac_status); } >/dev/null; then
-  if test -s conftest.err; then
-    ac_cpp_err=$ac_c_preproc_warn_flag
-    ac_cpp_err=$ac_cpp_err$ac_c_werror_flag
-  else
-    ac_cpp_err=
-  fi
-else
-  ac_cpp_err=yes
-fi
-if test -z "$ac_cpp_err"; then
-  ac_header_preproc=yes
-else
-  echo "$as_me: failed program was:" >&5
-sed 's/^/| /' conftest.$ac_ext >&5
-
-  ac_header_preproc=no
-fi
-rm -f conftest.err conftest.$ac_ext
-echo "$as_me:$LINENO: result: $ac_header_preproc" >&5
-echo "${ECHO_T}$ac_header_preproc" >&6
-
-# So?  What about this header?
-case $ac_header_compiler:$ac_header_preproc:$ac_c_preproc_warn_flag in
-  yes:no: )
-    { echo "$as_me:$LINENO: WARNING: $ac_header: accepted by the compiler, rejected by the preprocessor!" >&5
-echo "$as_me: WARNING: $ac_header: accepted by the compiler, rejected by the preprocessor!" >&2;}
-    { echo "$as_me:$LINENO: WARNING: $ac_header: proceeding with the compiler's result" >&5
-echo "$as_me: WARNING: $ac_header: proceeding with the compiler's result" >&2;}
-    ac_header_preproc=yes
-    ;;
-  no:yes:* )
-    { echo "$as_me:$LINENO: WARNING: $ac_header: present but cannot be compiled" >&5
-echo "$as_me: WARNING: $ac_header: present but cannot be compiled" >&2;}
-    { echo "$as_me:$LINENO: WARNING: $ac_header:     check for missing prerequisite headers?" >&5
-echo "$as_me: WARNING: $ac_header:     check for missing prerequisite headers?" >&2;}
-    { echo "$as_me:$LINENO: WARNING: $ac_header: see the Autoconf documentation" >&5
-echo "$as_me: WARNING: $ac_header: see the Autoconf documentation" >&2;}
-    { echo "$as_me:$LINENO: WARNING: $ac_header:     section \"Present But Cannot Be Compiled\"" >&5
-echo "$as_me: WARNING: $ac_header:     section \"Present But Cannot Be Compiled\"" >&2;}
-    { echo "$as_me:$LINENO: WARNING: $ac_header: proceeding with the preprocessor's result" >&5
-echo "$as_me: WARNING: $ac_header: proceeding with the preprocessor's result" >&2;}
-    { echo "$as_me:$LINENO: WARNING: $ac_header: in the future, the compiler will take precedence" >&5
-echo "$as_me: WARNING: $ac_header: in the future, the compiler will take precedence" >&2;}
-    (
-      cat <<\_ASBOX
-## ---------------------------------------------------- ##
-## Report this to lcd4linux-users@lists.sourceforge.net ##
-## ---------------------------------------------------- ##
-_ASBOX
-    ) |
-      sed "s/^/$as_me: WARNING:     /" >&2
-    ;;
+if { (ac_try="$ac_compile"
+case "(($ac_try" in
+  *\"* | *\`* | *\\*) ac_try_echo=\$ac_try;;
+  *) ac_try_echo=$ac_try;;
 esac
-echo "$as_me:$LINENO: checking for $ac_header" >&5
-echo $ECHO_N "checking for $ac_header... $ECHO_C" >&6
-if eval "test \"\${$as_ac_Header+set}\" = set"; then
-  echo $ECHO_N "(cached) $ECHO_C" >&6
-else
-  eval "$as_ac_Header=\$ac_header_preproc"
-fi
-echo "$as_me:$LINENO: result: `eval echo '${'$as_ac_Header'}'`" >&5
-echo "${ECHO_T}`eval echo '${'$as_ac_Header'}'`" >&6
-
-fi
-if test `eval echo '${'$as_ac_Header'}'` = yes; then
-  cat >>confdefs.h <<_ACEOF
-#define `echo "HAVE_$ac_header" | $as_tr_cpp` 1
-_ACEOF
-
-fi
-
-done
-
-
-for ac_header in asm/msr.h
-do
-as_ac_Header=`echo "ac_cv_header_$ac_header" | $as_tr_sh`
-if eval "test \"\${$as_ac_Header+set}\" = set"; then
-  echo "$as_me:$LINENO: checking for $ac_header" >&5
-echo $ECHO_N "checking for $ac_header... $ECHO_C" >&6
-if eval "test \"\${$as_ac_Header+set}\" = set"; then
-  echo $ECHO_N "(cached) $ECHO_C" >&6
-fi
-echo "$as_me:$LINENO: result: `eval echo '${'$as_ac_Header'}'`" >&5
-echo "${ECHO_T}`eval echo '${'$as_ac_Header'}'`" >&6
-else
-  # Is the header compilable?
-echo "$as_me:$LINENO: checking $ac_header usability" >&5
-echo $ECHO_N "checking $ac_header usability... $ECHO_C" >&6
-cat >conftest.$ac_ext <<_ACEOF
-/* confdefs.h.  */
-_ACEOF
-cat confdefs.h >>conftest.$ac_ext
-cat >>conftest.$ac_ext <<_ACEOF
-/* end confdefs.h.  */
-$ac_includes_default
-#include <$ac_header>
-_ACEOF
-rm -f conftest.$ac_objext
-if { (eval echo "$as_me:$LINENO: \"$ac_compile\"") >&5
-  (eval $ac_compile) 2>conftest.er1
+eval "echo \"\$as_me:$LINENO: $ac_try_echo\"") >&5
+  (eval "$ac_compile") 2>conftest.er1
   ac_status=$?
   grep -v '^ *+' conftest.er1 >conftest.err
   rm -f conftest.er1
   cat conftest.err >&5
   echo "$as_me:$LINENO: \$? = $ac_status" >&5
-  (exit $ac_status); } &&
-	 { ac_try='test -z "$ac_c_werror_flag"			 || test ! -s conftest.err'
-  { (eval echo "$as_me:$LINENO: \"$ac_try\"") >&5
-  (eval $ac_try) 2>&5
-  ac_status=$?
-  echo "$as_me:$LINENO: \$? = $ac_status" >&5
-  (exit $ac_status); }; } &&
-	 { ac_try='test -s conftest.$ac_objext'
-  { (eval echo "$as_me:$LINENO: \"$ac_try\"") >&5
-  (eval $ac_try) 2>&5
-  ac_status=$?
-  echo "$as_me:$LINENO: \$? = $ac_status" >&5
-  (exit $ac_status); }; }; then
+  (exit $ac_status); } && {
+	 test -z "$ac_c_werror_flag" ||
+	 test ! -s conftest.err
+       } && test -s conftest.$ac_objext; then
   ac_header_compiler=yes
 else
   echo "$as_me: failed program was:" >&5
 sed 's/^/| /' conftest.$ac_ext >&5
 
-ac_header_compiler=no
+	ac_header_compiler=no
 fi
-rm -f conftest.err conftest.$ac_objext conftest.$ac_ext
-echo "$as_me:$LINENO: result: $ac_header_compiler" >&5
-echo "${ECHO_T}$ac_header_compiler" >&6
+
+rm -f core conftest.err conftest.$ac_objext conftest.$ac_ext
+{ echo "$as_me:$LINENO: result: $ac_header_compiler" >&5
+echo "${ECHO_T}$ac_header_compiler" >&6; }
 
 # Is the header present?
-echo "$as_me:$LINENO: checking $ac_header presence" >&5
-echo $ECHO_N "checking $ac_header presence... $ECHO_C" >&6
+{ echo "$as_me:$LINENO: checking $ac_header presence" >&5
+echo $ECHO_N "checking $ac_header presence... $ECHO_C" >&6; }
 cat >conftest.$ac_ext <<_ACEOF
 /* confdefs.h.  */
 _ACEOF
@@ -8370,24 +12624,22 @@
 /* end confdefs.h.  */
 #include <$ac_header>
 _ACEOF
-if { (eval echo "$as_me:$LINENO: \"$ac_cpp conftest.$ac_ext\"") >&5
-  (eval $ac_cpp conftest.$ac_ext) 2>conftest.er1
+if { (ac_try="$ac_cpp conftest.$ac_ext"
+case "(($ac_try" in
+  *\"* | *\`* | *\\*) ac_try_echo=\$ac_try;;
+  *) ac_try_echo=$ac_try;;
+esac
+eval "echo \"\$as_me:$LINENO: $ac_try_echo\"") >&5
+  (eval "$ac_cpp conftest.$ac_ext") 2>conftest.er1
   ac_status=$?
   grep -v '^ *+' conftest.er1 >conftest.err
   rm -f conftest.er1
   cat conftest.err >&5
   echo "$as_me:$LINENO: \$? = $ac_status" >&5
-  (exit $ac_status); } >/dev/null; then
-  if test -s conftest.err; then
-    ac_cpp_err=$ac_c_preproc_warn_flag
-    ac_cpp_err=$ac_cpp_err$ac_c_werror_flag
-  else
-    ac_cpp_err=
-  fi
-else
-  ac_cpp_err=yes
-fi
-if test -z "$ac_cpp_err"; then
+  (exit $ac_status); } >/dev/null && {
+	 test -z "$ac_c_preproc_warn_flag$ac_c_werror_flag" ||
+	 test ! -s conftest.err
+       }; then
   ac_header_preproc=yes
 else
   echo "$as_me: failed program was:" >&5
@@ -8395,9 +12647,10 @@
 
   ac_header_preproc=no
 fi
+
 rm -f conftest.err conftest.$ac_ext
-echo "$as_me:$LINENO: result: $ac_header_preproc" >&5
-echo "${ECHO_T}$ac_header_preproc" >&6
+{ echo "$as_me:$LINENO: result: $ac_header_preproc" >&5
+echo "${ECHO_T}$ac_header_preproc" >&6; }
 
 # So?  What about this header?
 case $ac_header_compiler:$ac_header_preproc:$ac_c_preproc_warn_flag in
@@ -8421,25 +12674,24 @@
 echo "$as_me: WARNING: $ac_header: proceeding with the preprocessor's result" >&2;}
     { echo "$as_me:$LINENO: WARNING: $ac_header: in the future, the compiler will take precedence" >&5
 echo "$as_me: WARNING: $ac_header: in the future, the compiler will take precedence" >&2;}
-    (
-      cat <<\_ASBOX
+    ( cat <<\_ASBOX
 ## ---------------------------------------------------- ##
 ## Report this to lcd4linux-users@lists.sourceforge.net ##
 ## ---------------------------------------------------- ##
 _ASBOX
-    ) |
-      sed "s/^/$as_me: WARNING:     /" >&2
+     ) | sed "s/^/$as_me: WARNING:     /" >&2
     ;;
 esac
-echo "$as_me:$LINENO: checking for $ac_header" >&5
-echo $ECHO_N "checking for $ac_header... $ECHO_C" >&6
-if eval "test \"\${$as_ac_Header+set}\" = set"; then
+{ echo "$as_me:$LINENO: checking for $ac_header" >&5
+echo $ECHO_N "checking for $ac_header... $ECHO_C" >&6; }
+if { as_var=$as_ac_Header; eval "test \"\${$as_var+set}\" = set"; }; then
   echo $ECHO_N "(cached) $ECHO_C" >&6
 else
   eval "$as_ac_Header=\$ac_header_preproc"
 fi
-echo "$as_me:$LINENO: result: `eval echo '${'$as_ac_Header'}'`" >&5
-echo "${ECHO_T}`eval echo '${'$as_ac_Header'}'`" >&6
+ac_res=`eval echo '${'$as_ac_Header'}'`
+	       { echo "$as_me:$LINENO: result: $ac_res" >&5
+echo "${ECHO_T}$ac_res" >&6; }
 
 fi
 if test `eval echo '${'$as_ac_Header'}'` = yes; then
@@ -8453,8 +12705,8 @@
 
 
 # Checks for typedefs, structures, and compiler characteristics.
-echo "$as_me:$LINENO: checking for an ANSI C-conforming const" >&5
-echo $ECHO_N "checking for an ANSI C-conforming const... $ECHO_C" >&6
+{ echo "$as_me:$LINENO: checking for an ANSI C-conforming const" >&5
+echo $ECHO_N "checking for an ANSI C-conforming const... $ECHO_C" >&6; }
 if test "${ac_cv_c_const+set}" = set; then
   echo $ECHO_N "(cached) $ECHO_C" >&6
 else
@@ -8472,10 +12724,10 @@
 #ifndef __cplusplus
   /* Ultrix mips cc rejects this.  */
   typedef int charset[2];
-  const charset x;
+  const charset cs;
   /* SunOS 4.1.1 cc rejects this.  */
-  char const *const *ccp;
-  char **p;
+  char const *const *pcpcc;
+  char **ppc;
   /* NEC SVR4.0.2 mips cc rejects this.  */
   struct point {int x, y;};
   static struct point const zero = {0,0};
@@ -8484,16 +12736,17 @@
      an arm of an if-expression whose if-part is not a constant
      expression */
   const char *g = "string";
-  ccp = &g + (g ? g-g : 0);
+  pcpcc = &g + (g ? g-g : 0);
   /* HPUX 7.0 cc rejects these. */
-  ++ccp;
-  p = (char**) ccp;
-  ccp = (char const *const *) p;
+  ++pcpcc;
+  ppc = (char**) pcpcc;
+  pcpcc = (char const *const *) ppc;
   { /* SCO 3.2v4 cc rejects this.  */
     char *t;
     char const *s = 0 ? (char *) 0 : (char const *) 0;
 
     *t++ = 0;
+    if (s) return 0;
   }
   { /* Someone thinks the Sun supposedly-ANSI compiler will reject this.  */
     int x[] = {25, 17};
@@ -8512,7 +12765,9 @@
   }
   { /* ULTRIX-32 V3.1 (Rev 9) vcc rejects this */
     const int foo = 10;
+    if (!foo) return 0;
   }
+  return !cs[0] && !zero.x;
 #endif
 
   ;
@@ -8520,37 +12775,34 @@
 }
 _ACEOF
 rm -f conftest.$ac_objext
-if { (eval echo "$as_me:$LINENO: \"$ac_compile\"") >&5
-  (eval $ac_compile) 2>conftest.er1
+if { (ac_try="$ac_compile"
+case "(($ac_try" in
+  *\"* | *\`* | *\\*) ac_try_echo=\$ac_try;;
+  *) ac_try_echo=$ac_try;;
+esac
+eval "echo \"\$as_me:$LINENO: $ac_try_echo\"") >&5
+  (eval "$ac_compile") 2>conftest.er1
   ac_status=$?
   grep -v '^ *+' conftest.er1 >conftest.err
   rm -f conftest.er1
   cat conftest.err >&5
   echo "$as_me:$LINENO: \$? = $ac_status" >&5
-  (exit $ac_status); } &&
-	 { ac_try='test -z "$ac_c_werror_flag"			 || test ! -s conftest.err'
-  { (eval echo "$as_me:$LINENO: \"$ac_try\"") >&5
-  (eval $ac_try) 2>&5
-  ac_status=$?
-  echo "$as_me:$LINENO: \$? = $ac_status" >&5
-  (exit $ac_status); }; } &&
-	 { ac_try='test -s conftest.$ac_objext'
-  { (eval echo "$as_me:$LINENO: \"$ac_try\"") >&5
-  (eval $ac_try) 2>&5
-  ac_status=$?
-  echo "$as_me:$LINENO: \$? = $ac_status" >&5
-  (exit $ac_status); }; }; then
+  (exit $ac_status); } && {
+	 test -z "$ac_c_werror_flag" ||
+	 test ! -s conftest.err
+       } && test -s conftest.$ac_objext; then
   ac_cv_c_const=yes
 else
   echo "$as_me: failed program was:" >&5
 sed 's/^/| /' conftest.$ac_ext >&5
 
-ac_cv_c_const=no
+	ac_cv_c_const=no
 fi
-rm -f conftest.err conftest.$ac_objext conftest.$ac_ext
+
+rm -f core conftest.err conftest.$ac_objext conftest.$ac_ext
 fi
-echo "$as_me:$LINENO: result: $ac_cv_c_const" >&5
-echo "${ECHO_T}$ac_cv_c_const" >&6
+{ echo "$as_me:$LINENO: result: $ac_cv_c_const" >&5
+echo "${ECHO_T}$ac_cv_c_const" >&6; }
 if test $ac_cv_c_const = no; then
 
 cat >>confdefs.h <<\_ACEOF
@@ -8559,8 +12811,8 @@
 
 fi
 
-echo "$as_me:$LINENO: checking for inline" >&5
-echo $ECHO_N "checking for inline... $ECHO_C" >&6
+{ echo "$as_me:$LINENO: checking for inline" >&5
+echo $ECHO_N "checking for inline... $ECHO_C" >&6; }
 if test "${ac_cv_c_inline+set}" = set; then
   echo $ECHO_N "(cached) $ECHO_C" >&6
 else
@@ -8580,38 +12832,37 @@
 
 _ACEOF
 rm -f conftest.$ac_objext
-if { (eval echo "$as_me:$LINENO: \"$ac_compile\"") >&5
-  (eval $ac_compile) 2>conftest.er1
+if { (ac_try="$ac_compile"
+case "(($ac_try" in
+  *\"* | *\`* | *\\*) ac_try_echo=\$ac_try;;
+  *) ac_try_echo=$ac_try;;
+esac
+eval "echo \"\$as_me:$LINENO: $ac_try_echo\"") >&5
+  (eval "$ac_compile") 2>conftest.er1
   ac_status=$?
   grep -v '^ *+' conftest.er1 >conftest.err
   rm -f conftest.er1
   cat conftest.err >&5
   echo "$as_me:$LINENO: \$? = $ac_status" >&5
-  (exit $ac_status); } &&
-	 { ac_try='test -z "$ac_c_werror_flag"			 || test ! -s conftest.err'
-  { (eval echo "$as_me:$LINENO: \"$ac_try\"") >&5
-  (eval $ac_try) 2>&5
-  ac_status=$?
-  echo "$as_me:$LINENO: \$? = $ac_status" >&5
-  (exit $ac_status); }; } &&
-	 { ac_try='test -s conftest.$ac_objext'
-  { (eval echo "$as_me:$LINENO: \"$ac_try\"") >&5
-  (eval $ac_try) 2>&5
-  ac_status=$?
-  echo "$as_me:$LINENO: \$? = $ac_status" >&5
-  (exit $ac_status); }; }; then
-  ac_cv_c_inline=$ac_kw; break
+  (exit $ac_status); } && {
+	 test -z "$ac_c_werror_flag" ||
+	 test ! -s conftest.err
+       } && test -s conftest.$ac_objext; then
+  ac_cv_c_inline=$ac_kw
 else
   echo "$as_me: failed program was:" >&5
 sed 's/^/| /' conftest.$ac_ext >&5
 
+
 fi
-rm -f conftest.err conftest.$ac_objext conftest.$ac_ext
+
+rm -f core conftest.err conftest.$ac_objext conftest.$ac_ext
+  test "$ac_cv_c_inline" != no && break
 done
 
 fi
-echo "$as_me:$LINENO: result: $ac_cv_c_inline" >&5
-echo "${ECHO_T}$ac_cv_c_inline" >&6
+{ echo "$as_me:$LINENO: result: $ac_cv_c_inline" >&5
+echo "${ECHO_T}$ac_cv_c_inline" >&6; }
 
 
 case $ac_cv_c_inline in
@@ -8629,8 +12880,8 @@
     ;;
 esac
 
-echo "$as_me:$LINENO: checking for off_t" >&5
-echo $ECHO_N "checking for off_t... $ECHO_C" >&6
+{ echo "$as_me:$LINENO: checking for off_t" >&5
+echo $ECHO_N "checking for off_t... $ECHO_C" >&6; }
 if test "${ac_cv_type_off_t+set}" = set; then
   echo $ECHO_N "(cached) $ECHO_C" >&6
 else
@@ -8641,61 +12892,59 @@
 cat >>conftest.$ac_ext <<_ACEOF
 /* end confdefs.h.  */
 $ac_includes_default
+typedef off_t ac__type_new_;
 int
 main ()
 {
-if ((off_t *) 0)
+if ((ac__type_new_ *) 0)
   return 0;
-if (sizeof (off_t))
+if (sizeof (ac__type_new_))
   return 0;
   ;
   return 0;
 }
 _ACEOF
 rm -f conftest.$ac_objext
-if { (eval echo "$as_me:$LINENO: \"$ac_compile\"") >&5
-  (eval $ac_compile) 2>conftest.er1
+if { (ac_try="$ac_compile"
+case "(($ac_try" in
+  *\"* | *\`* | *\\*) ac_try_echo=\$ac_try;;
+  *) ac_try_echo=$ac_try;;
+esac
+eval "echo \"\$as_me:$LINENO: $ac_try_echo\"") >&5
+  (eval "$ac_compile") 2>conftest.er1
   ac_status=$?
   grep -v '^ *+' conftest.er1 >conftest.err
   rm -f conftest.er1
   cat conftest.err >&5
   echo "$as_me:$LINENO: \$? = $ac_status" >&5
-  (exit $ac_status); } &&
-	 { ac_try='test -z "$ac_c_werror_flag"			 || test ! -s conftest.err'
-  { (eval echo "$as_me:$LINENO: \"$ac_try\"") >&5
-  (eval $ac_try) 2>&5
-  ac_status=$?
-  echo "$as_me:$LINENO: \$? = $ac_status" >&5
-  (exit $ac_status); }; } &&
-	 { ac_try='test -s conftest.$ac_objext'
-  { (eval echo "$as_me:$LINENO: \"$ac_try\"") >&5
-  (eval $ac_try) 2>&5
-  ac_status=$?
-  echo "$as_me:$LINENO: \$? = $ac_status" >&5
-  (exit $ac_status); }; }; then
+  (exit $ac_status); } && {
+	 test -z "$ac_c_werror_flag" ||
+	 test ! -s conftest.err
+       } && test -s conftest.$ac_objext; then
   ac_cv_type_off_t=yes
 else
   echo "$as_me: failed program was:" >&5
 sed 's/^/| /' conftest.$ac_ext >&5
 
-ac_cv_type_off_t=no
+	ac_cv_type_off_t=no
 fi
-rm -f conftest.err conftest.$ac_objext conftest.$ac_ext
+
+rm -f core conftest.err conftest.$ac_objext conftest.$ac_ext
 fi
-echo "$as_me:$LINENO: result: $ac_cv_type_off_t" >&5
-echo "${ECHO_T}$ac_cv_type_off_t" >&6
+{ echo "$as_me:$LINENO: result: $ac_cv_type_off_t" >&5
+echo "${ECHO_T}$ac_cv_type_off_t" >&6; }
 if test $ac_cv_type_off_t = yes; then
   :
 else
 
 cat >>confdefs.h <<_ACEOF
-#define off_t long
+#define off_t long int
 _ACEOF
 
 fi
 
-echo "$as_me:$LINENO: checking for pid_t" >&5
-echo $ECHO_N "checking for pid_t... $ECHO_C" >&6
+{ echo "$as_me:$LINENO: checking for pid_t" >&5
+echo $ECHO_N "checking for pid_t... $ECHO_C" >&6; }
 if test "${ac_cv_type_pid_t+set}" = set; then
   echo $ECHO_N "(cached) $ECHO_C" >&6
 else
@@ -8706,62 +12955,123 @@
 cat >>conftest.$ac_ext <<_ACEOF
 /* end confdefs.h.  */
 $ac_includes_default
+typedef pid_t ac__type_new_;
 int
 main ()
 {
-if ((pid_t *) 0)
+if ((ac__type_new_ *) 0)
   return 0;
-if (sizeof (pid_t))
+if (sizeof (ac__type_new_))
   return 0;
   ;
   return 0;
 }
 _ACEOF
 rm -f conftest.$ac_objext
-if { (eval echo "$as_me:$LINENO: \"$ac_compile\"") >&5
-  (eval $ac_compile) 2>conftest.er1
+if { (ac_try="$ac_compile"
+case "(($ac_try" in
+  *\"* | *\`* | *\\*) ac_try_echo=\$ac_try;;
+  *) ac_try_echo=$ac_try;;
+esac
+eval "echo \"\$as_me:$LINENO: $ac_try_echo\"") >&5
+  (eval "$ac_compile") 2>conftest.er1
   ac_status=$?
   grep -v '^ *+' conftest.er1 >conftest.err
   rm -f conftest.er1
   cat conftest.err >&5
   echo "$as_me:$LINENO: \$? = $ac_status" >&5
-  (exit $ac_status); } &&
-	 { ac_try='test -z "$ac_c_werror_flag"			 || test ! -s conftest.err'
-  { (eval echo "$as_me:$LINENO: \"$ac_try\"") >&5
-  (eval $ac_try) 2>&5
-  ac_status=$?
-  echo "$as_me:$LINENO: \$? = $ac_status" >&5
-  (exit $ac_status); }; } &&
-	 { ac_try='test -s conftest.$ac_objext'
-  { (eval echo "$as_me:$LINENO: \"$ac_try\"") >&5
-  (eval $ac_try) 2>&5
+  (exit $ac_status); } && {
+	 test -z "$ac_c_werror_flag" ||
+	 test ! -s conftest.err
+       } && test -s conftest.$ac_objext; then
+  ac_cv_type_pid_t=yes
+else
+  echo "$as_me: failed program was:" >&5
+sed 's/^/| /' conftest.$ac_ext >&5
+
+	ac_cv_type_pid_t=no
+fi
+
+rm -f core conftest.err conftest.$ac_objext conftest.$ac_ext
+fi
+{ echo "$as_me:$LINENO: result: $ac_cv_type_pid_t" >&5
+echo "${ECHO_T}$ac_cv_type_pid_t" >&6; }
+if test $ac_cv_type_pid_t = yes; then
+  :
+else
+
+cat >>confdefs.h <<_ACEOF
+#define pid_t int
+_ACEOF
+
+fi
+
+{ echo "$as_me:$LINENO: checking for size_t" >&5
+echo $ECHO_N "checking for size_t... $ECHO_C" >&6; }
+if test "${ac_cv_type_size_t+set}" = set; then
+  echo $ECHO_N "(cached) $ECHO_C" >&6
+else
+  cat >conftest.$ac_ext <<_ACEOF
+/* confdefs.h.  */
+_ACEOF
+cat confdefs.h >>conftest.$ac_ext
+cat >>conftest.$ac_ext <<_ACEOF
+/* end confdefs.h.  */
+$ac_includes_default
+typedef size_t ac__type_new_;
+int
+main ()
+{
+if ((ac__type_new_ *) 0)
+  return 0;
+if (sizeof (ac__type_new_))
+  return 0;
+  ;
+  return 0;
+}
+_ACEOF
+rm -f conftest.$ac_objext
+if { (ac_try="$ac_compile"
+case "(($ac_try" in
+  *\"* | *\`* | *\\*) ac_try_echo=\$ac_try;;
+  *) ac_try_echo=$ac_try;;
+esac
+eval "echo \"\$as_me:$LINENO: $ac_try_echo\"") >&5
+  (eval "$ac_compile") 2>conftest.er1
   ac_status=$?
+  grep -v '^ *+' conftest.er1 >conftest.err
+  rm -f conftest.er1
+  cat conftest.err >&5
   echo "$as_me:$LINENO: \$? = $ac_status" >&5
-  (exit $ac_status); }; }; then
-  ac_cv_type_pid_t=yes
+  (exit $ac_status); } && {
+	 test -z "$ac_c_werror_flag" ||
+	 test ! -s conftest.err
+       } && test -s conftest.$ac_objext; then
+  ac_cv_type_size_t=yes
 else
   echo "$as_me: failed program was:" >&5
 sed 's/^/| /' conftest.$ac_ext >&5
 
-ac_cv_type_pid_t=no
+	ac_cv_type_size_t=no
 fi
-rm -f conftest.err conftest.$ac_objext conftest.$ac_ext
+
+rm -f core conftest.err conftest.$ac_objext conftest.$ac_ext
 fi
-echo "$as_me:$LINENO: result: $ac_cv_type_pid_t" >&5
-echo "${ECHO_T}$ac_cv_type_pid_t" >&6
-if test $ac_cv_type_pid_t = yes; then
+{ echo "$as_me:$LINENO: result: $ac_cv_type_size_t" >&5
+echo "${ECHO_T}$ac_cv_type_size_t" >&6; }
+if test $ac_cv_type_size_t = yes; then
   :
 else
 
 cat >>confdefs.h <<_ACEOF
-#define pid_t int
+#define size_t unsigned int
 _ACEOF
 
 fi
 
-echo "$as_me:$LINENO: checking for size_t" >&5
-echo $ECHO_N "checking for size_t... $ECHO_C" >&6
-if test "${ac_cv_type_size_t+set}" = set; then
+{ echo "$as_me:$LINENO: checking for ssize_t" >&5
+echo $ECHO_N "checking for ssize_t... $ECHO_C" >&6; }
+if test "${ac_cv_type_ssize_t+set}" = set; then
   echo $ECHO_N "(cached) $ECHO_C" >&6
 else
   cat >conftest.$ac_ext <<_ACEOF
@@ -8771,61 +13081,59 @@
 cat >>conftest.$ac_ext <<_ACEOF
 /* end confdefs.h.  */
 $ac_includes_default
+typedef ssize_t ac__type_new_;
 int
 main ()
 {
-if ((size_t *) 0)
+if ((ac__type_new_ *) 0)
   return 0;
-if (sizeof (size_t))
+if (sizeof (ac__type_new_))
   return 0;
   ;
   return 0;
 }
 _ACEOF
 rm -f conftest.$ac_objext
-if { (eval echo "$as_me:$LINENO: \"$ac_compile\"") >&5
-  (eval $ac_compile) 2>conftest.er1
+if { (ac_try="$ac_compile"
+case "(($ac_try" in
+  *\"* | *\`* | *\\*) ac_try_echo=\$ac_try;;
+  *) ac_try_echo=$ac_try;;
+esac
+eval "echo \"\$as_me:$LINENO: $ac_try_echo\"") >&5
+  (eval "$ac_compile") 2>conftest.er1
   ac_status=$?
   grep -v '^ *+' conftest.er1 >conftest.err
   rm -f conftest.er1
   cat conftest.err >&5
   echo "$as_me:$LINENO: \$? = $ac_status" >&5
-  (exit $ac_status); } &&
-	 { ac_try='test -z "$ac_c_werror_flag"			 || test ! -s conftest.err'
-  { (eval echo "$as_me:$LINENO: \"$ac_try\"") >&5
-  (eval $ac_try) 2>&5
-  ac_status=$?
-  echo "$as_me:$LINENO: \$? = $ac_status" >&5
-  (exit $ac_status); }; } &&
-	 { ac_try='test -s conftest.$ac_objext'
-  { (eval echo "$as_me:$LINENO: \"$ac_try\"") >&5
-  (eval $ac_try) 2>&5
-  ac_status=$?
-  echo "$as_me:$LINENO: \$? = $ac_status" >&5
-  (exit $ac_status); }; }; then
-  ac_cv_type_size_t=yes
+  (exit $ac_status); } && {
+	 test -z "$ac_c_werror_flag" ||
+	 test ! -s conftest.err
+       } && test -s conftest.$ac_objext; then
+  ac_cv_type_ssize_t=yes
 else
   echo "$as_me: failed program was:" >&5
 sed 's/^/| /' conftest.$ac_ext >&5
 
-ac_cv_type_size_t=no
+	ac_cv_type_ssize_t=no
 fi
-rm -f conftest.err conftest.$ac_objext conftest.$ac_ext
+
+rm -f core conftest.err conftest.$ac_objext conftest.$ac_ext
 fi
-echo "$as_me:$LINENO: result: $ac_cv_type_size_t" >&5
-echo "${ECHO_T}$ac_cv_type_size_t" >&6
-if test $ac_cv_type_size_t = yes; then
+{ echo "$as_me:$LINENO: result: $ac_cv_type_ssize_t" >&5
+echo "${ECHO_T}$ac_cv_type_ssize_t" >&6; }
+if test $ac_cv_type_ssize_t = yes; then
   :
 else
 
 cat >>confdefs.h <<_ACEOF
-#define size_t unsigned
+#define ssize_t int
 _ACEOF
 
 fi
 
-echo "$as_me:$LINENO: checking whether time.h and sys/time.h may both be included" >&5
-echo $ECHO_N "checking whether time.h and sys/time.h may both be included... $ECHO_C" >&6
+{ echo "$as_me:$LINENO: checking whether time.h and sys/time.h may both be included" >&5
+echo $ECHO_N "checking whether time.h and sys/time.h may both be included... $ECHO_C" >&6; }
 if test "${ac_cv_header_time+set}" = set; then
   echo $ECHO_N "(cached) $ECHO_C" >&6
 else
@@ -8849,37 +13157,34 @@
 }
 _ACEOF
 rm -f conftest.$ac_objext
-if { (eval echo "$as_me:$LINENO: \"$ac_compile\"") >&5
-  (eval $ac_compile) 2>conftest.er1
+if { (ac_try="$ac_compile"
+case "(($ac_try" in
+  *\"* | *\`* | *\\*) ac_try_echo=\$ac_try;;
+  *) ac_try_echo=$ac_try;;
+esac
+eval "echo \"\$as_me:$LINENO: $ac_try_echo\"") >&5
+  (eval "$ac_compile") 2>conftest.er1
   ac_status=$?
   grep -v '^ *+' conftest.er1 >conftest.err
   rm -f conftest.er1
   cat conftest.err >&5
   echo "$as_me:$LINENO: \$? = $ac_status" >&5
-  (exit $ac_status); } &&
-	 { ac_try='test -z "$ac_c_werror_flag"			 || test ! -s conftest.err'
-  { (eval echo "$as_me:$LINENO: \"$ac_try\"") >&5
-  (eval $ac_try) 2>&5
-  ac_status=$?
-  echo "$as_me:$LINENO: \$? = $ac_status" >&5
-  (exit $ac_status); }; } &&
-	 { ac_try='test -s conftest.$ac_objext'
-  { (eval echo "$as_me:$LINENO: \"$ac_try\"") >&5
-  (eval $ac_try) 2>&5
-  ac_status=$?
-  echo "$as_me:$LINENO: \$? = $ac_status" >&5
-  (exit $ac_status); }; }; then
+  (exit $ac_status); } && {
+	 test -z "$ac_c_werror_flag" ||
+	 test ! -s conftest.err
+       } && test -s conftest.$ac_objext; then
   ac_cv_header_time=yes
 else
   echo "$as_me: failed program was:" >&5
 sed 's/^/| /' conftest.$ac_ext >&5
 
-ac_cv_header_time=no
+	ac_cv_header_time=no
 fi
-rm -f conftest.err conftest.$ac_objext conftest.$ac_ext
+
+rm -f core conftest.err conftest.$ac_objext conftest.$ac_ext
 fi
-echo "$as_me:$LINENO: result: $ac_cv_header_time" >&5
-echo "${ECHO_T}$ac_cv_header_time" >&6
+{ echo "$as_me:$LINENO: result: $ac_cv_header_time" >&5
+echo "${ECHO_T}$ac_cv_header_time" >&6; }
 if test $ac_cv_header_time = yes; then
 
 cat >>confdefs.h <<\_ACEOF
@@ -8888,8 +13193,8 @@
 
 fi
 
-echo "$as_me:$LINENO: checking for uid_t in sys/types.h" >&5
-echo $ECHO_N "checking for uid_t in sys/types.h... $ECHO_C" >&6
+{ echo "$as_me:$LINENO: checking for uid_t in sys/types.h" >&5
+echo $ECHO_N "checking for uid_t in sys/types.h... $ECHO_C" >&6; }
 if test "${ac_cv_type_uid_t+set}" = set; then
   echo $ECHO_N "(cached) $ECHO_C" >&6
 else
@@ -8911,8 +13216,8 @@
 rm -f conftest*
 
 fi
-echo "$as_me:$LINENO: result: $ac_cv_type_uid_t" >&5
-echo "${ECHO_T}$ac_cv_type_uid_t" >&6
+{ echo "$as_me:$LINENO: result: $ac_cv_type_uid_t" >&5
+echo "${ECHO_T}$ac_cv_type_uid_t" >&6; }
 if test $ac_cv_type_uid_t = no; then
 
 cat >>confdefs.h <<\_ACEOF
@@ -8927,9 +13232,10 @@
 fi
 
 
+
 # Checks for library functions.
-echo "$as_me:$LINENO: checking whether closedir returns void" >&5
-echo $ECHO_N "checking whether closedir returns void... $ECHO_C" >&6
+{ echo "$as_me:$LINENO: checking whether closedir returns void" >&5
+echo $ECHO_N "checking whether closedir returns void... $ECHO_C" >&6; }
 if test "${ac_cv_func_closedir_void+set}" = set; then
   echo $ECHO_N "(cached) $ECHO_C" >&6
 else
@@ -8951,19 +13257,28 @@
 int
 main ()
 {
-exit (closedir (opendir (".")) != 0);
+return closedir (opendir (".")) != 0;
   ;
   return 0;
 }
 _ACEOF
 rm -f conftest$ac_exeext
-if { (eval echo "$as_me:$LINENO: \"$ac_link\"") >&5
-  (eval $ac_link) 2>&5
+if { (ac_try="$ac_link"
+case "(($ac_try" in
+  *\"* | *\`* | *\\*) ac_try_echo=\$ac_try;;
+  *) ac_try_echo=$ac_try;;
+esac
+eval "echo \"\$as_me:$LINENO: $ac_try_echo\"") >&5
+  (eval "$ac_link") 2>&5
   ac_status=$?
   echo "$as_me:$LINENO: \$? = $ac_status" >&5
   (exit $ac_status); } && { ac_try='./conftest$ac_exeext'
-  { (eval echo "$as_me:$LINENO: \"$ac_try\"") >&5
-  (eval $ac_try) 2>&5
+  { (case "(($ac_try" in
+  *\"* | *\`* | *\\*) ac_try_echo=\$ac_try;;
+  *) ac_try_echo=$ac_try;;
+esac
+eval "echo \"\$as_me:$LINENO: $ac_try_echo\"") >&5
+  (eval "$ac_try") 2>&5
   ac_status=$?
   echo "$as_me:$LINENO: \$? = $ac_status" >&5
   (exit $ac_status); }; }; then
@@ -8976,11 +13291,13 @@
 ( exit $ac_status )
 ac_cv_func_closedir_void=yes
 fi
-rm -f core *.core gmon.out bb.out conftest$ac_exeext conftest.$ac_objext conftest.$ac_ext
+rm -f core *.core core.conftest.* gmon.out bb.out conftest$ac_exeext conftest.$ac_objext conftest.$ac_ext
 fi
+
+
 fi
-echo "$as_me:$LINENO: result: $ac_cv_func_closedir_void" >&5
-echo "${ECHO_T}$ac_cv_func_closedir_void" >&6
+{ echo "$as_me:$LINENO: result: $ac_cv_func_closedir_void" >&5
+echo "${ECHO_T}$ac_cv_func_closedir_void" >&6; }
 if test $ac_cv_func_closedir_void = yes; then
 
 cat >>confdefs.h <<\_ACEOF
@@ -8989,8 +13306,8 @@
 
 fi
 
-echo "$as_me:$LINENO: checking for error_at_line" >&5
-echo $ECHO_N "checking for error_at_line... $ECHO_C" >&6
+{ echo "$as_me:$LINENO: checking for error_at_line" >&5
+echo $ECHO_N "checking for error_at_line... $ECHO_C" >&6; }
 if test "${ac_cv_lib_error_at_line+set}" = set; then
   echo $ECHO_N "(cached) $ECHO_C" >&6
 else
@@ -9000,76 +13317,72 @@
 cat confdefs.h >>conftest.$ac_ext
 cat >>conftest.$ac_ext <<_ACEOF
 /* end confdefs.h.  */
-$ac_includes_default
+#include <error.h>
 int
 main ()
 {
-error_at_line (0, 0, "", 0, "");
+error_at_line (0, 0, "", 0, "an error occurred");
   ;
   return 0;
 }
 _ACEOF
 rm -f conftest.$ac_objext conftest$ac_exeext
-if { (eval echo "$as_me:$LINENO: \"$ac_link\"") >&5
-  (eval $ac_link) 2>conftest.er1
+if { (ac_try="$ac_link"
+case "(($ac_try" in
+  *\"* | *\`* | *\\*) ac_try_echo=\$ac_try;;
+  *) ac_try_echo=$ac_try;;
+esac
+eval "echo \"\$as_me:$LINENO: $ac_try_echo\"") >&5
+  (eval "$ac_link") 2>conftest.er1
   ac_status=$?
   grep -v '^ *+' conftest.er1 >conftest.err
   rm -f conftest.er1
   cat conftest.err >&5
   echo "$as_me:$LINENO: \$? = $ac_status" >&5
-  (exit $ac_status); } &&
-	 { ac_try='test -z "$ac_c_werror_flag"			 || test ! -s conftest.err'
-  { (eval echo "$as_me:$LINENO: \"$ac_try\"") >&5
-  (eval $ac_try) 2>&5
-  ac_status=$?
-  echo "$as_me:$LINENO: \$? = $ac_status" >&5
-  (exit $ac_status); }; } &&
-	 { ac_try='test -s conftest$ac_exeext'
-  { (eval echo "$as_me:$LINENO: \"$ac_try\"") >&5
-  (eval $ac_try) 2>&5
-  ac_status=$?
-  echo "$as_me:$LINENO: \$? = $ac_status" >&5
-  (exit $ac_status); }; }; then
+  (exit $ac_status); } && {
+	 test -z "$ac_c_werror_flag" ||
+	 test ! -s conftest.err
+       } && test -s conftest$ac_exeext &&
+       $as_test_x conftest$ac_exeext; then
   ac_cv_lib_error_at_line=yes
 else
   echo "$as_me: failed program was:" >&5
 sed 's/^/| /' conftest.$ac_ext >&5
 
-ac_cv_lib_error_at_line=no
+	ac_cv_lib_error_at_line=no
 fi
-rm -f conftest.err conftest.$ac_objext \
+
+rm -f core conftest.err conftest.$ac_objext conftest_ipa8_conftest.oo \
       conftest$ac_exeext conftest.$ac_ext
 fi
-echo "$as_me:$LINENO: result: $ac_cv_lib_error_at_line" >&5
-echo "${ECHO_T}$ac_cv_lib_error_at_line" >&6
+{ echo "$as_me:$LINENO: result: $ac_cv_lib_error_at_line" >&5
+echo "${ECHO_T}$ac_cv_lib_error_at_line" >&6; }
 if test $ac_cv_lib_error_at_line = no; then
-  case $LIBOBJS in
-    "error.$ac_objext"   | \
-  *" error.$ac_objext"   | \
-    "error.$ac_objext "* | \
+  case " $LIBOBJS " in
   *" error.$ac_objext "* ) ;;
-  *) LIBOBJS="$LIBOBJS error.$ac_objext" ;;
+  *) LIBOBJS="$LIBOBJS error.$ac_objext"
+ ;;
 esac
 
 fi
 
 
-
-for ac_header in unistd.h vfork.h
+for ac_header in vfork.h
 do
 as_ac_Header=`echo "ac_cv_header_$ac_header" | $as_tr_sh`
-if eval "test \"\${$as_ac_Header+set}\" = set"; then
-  echo "$as_me:$LINENO: checking for $ac_header" >&5
-echo $ECHO_N "checking for $ac_header... $ECHO_C" >&6
-if eval "test \"\${$as_ac_Header+set}\" = set"; then
+if { as_var=$as_ac_Header; eval "test \"\${$as_var+set}\" = set"; }; then
+  { echo "$as_me:$LINENO: checking for $ac_header" >&5
+echo $ECHO_N "checking for $ac_header... $ECHO_C" >&6; }
+if { as_var=$as_ac_Header; eval "test \"\${$as_var+set}\" = set"; }; then
   echo $ECHO_N "(cached) $ECHO_C" >&6
 fi
-echo "$as_me:$LINENO: result: `eval echo '${'$as_ac_Header'}'`" >&5
-echo "${ECHO_T}`eval echo '${'$as_ac_Header'}'`" >&6
+ac_res=`eval echo '${'$as_ac_Header'}'`
+	       { echo "$as_me:$LINENO: result: $ac_res" >&5
+echo "${ECHO_T}$ac_res" >&6; }
 else
   # Is the header compilable?
-echo "$as_me:$LINENO: checking $ac_header usability" >&5
-echo $ECHO_N "checking $ac_header usability... $ECHO_C" >&6
+{ echo "$as_me:$LINENO: checking $ac_header usability" >&5
+echo $ECHO_N "checking $ac_header usability... $ECHO_C" >&6; }
 cat >conftest.$ac_ext <<_ACEOF
 /* confdefs.h.  */
 _ACEOF
@@ -9080,40 +13393,37 @@
 #include <$ac_header>
 _ACEOF
 rm -f conftest.$ac_objext
-if { (eval echo "$as_me:$LINENO: \"$ac_compile\"") >&5
-  (eval $ac_compile) 2>conftest.er1
+if { (ac_try="$ac_compile"
+case "(($ac_try" in
+  *\"* | *\`* | *\\*) ac_try_echo=\$ac_try;;
+  *) ac_try_echo=$ac_try;;
+esac
+eval "echo \"\$as_me:$LINENO: $ac_try_echo\"") >&5
+  (eval "$ac_compile") 2>conftest.er1
   ac_status=$?
   grep -v '^ *+' conftest.er1 >conftest.err
   rm -f conftest.er1
   cat conftest.err >&5
   echo "$as_me:$LINENO: \$? = $ac_status" >&5
-  (exit $ac_status); } &&
-	 { ac_try='test -z "$ac_c_werror_flag"			 || test ! -s conftest.err'
-  { (eval echo "$as_me:$LINENO: \"$ac_try\"") >&5
-  (eval $ac_try) 2>&5
-  ac_status=$?
-  echo "$as_me:$LINENO: \$? = $ac_status" >&5
-  (exit $ac_status); }; } &&
-	 { ac_try='test -s conftest.$ac_objext'
-  { (eval echo "$as_me:$LINENO: \"$ac_try\"") >&5
-  (eval $ac_try) 2>&5
-  ac_status=$?
-  echo "$as_me:$LINENO: \$? = $ac_status" >&5
-  (exit $ac_status); }; }; then
+  (exit $ac_status); } && {
+	 test -z "$ac_c_werror_flag" ||
+	 test ! -s conftest.err
+       } && test -s conftest.$ac_objext; then
   ac_header_compiler=yes
 else
   echo "$as_me: failed program was:" >&5
 sed 's/^/| /' conftest.$ac_ext >&5
 
-ac_header_compiler=no
+	ac_header_compiler=no
 fi
-rm -f conftest.err conftest.$ac_objext conftest.$ac_ext
-echo "$as_me:$LINENO: result: $ac_header_compiler" >&5
-echo "${ECHO_T}$ac_header_compiler" >&6
+
+rm -f core conftest.err conftest.$ac_objext conftest.$ac_ext
+{ echo "$as_me:$LINENO: result: $ac_header_compiler" >&5
+echo "${ECHO_T}$ac_header_compiler" >&6; }
 
 # Is the header present?
-echo "$as_me:$LINENO: checking $ac_header presence" >&5
-echo $ECHO_N "checking $ac_header presence... $ECHO_C" >&6
+{ echo "$as_me:$LINENO: checking $ac_header presence" >&5
+echo $ECHO_N "checking $ac_header presence... $ECHO_C" >&6; }
 cat >conftest.$ac_ext <<_ACEOF
 /* confdefs.h.  */
 _ACEOF
@@ -9122,24 +13432,22 @@
 /* end confdefs.h.  */
 #include <$ac_header>
 _ACEOF
-if { (eval echo "$as_me:$LINENO: \"$ac_cpp conftest.$ac_ext\"") >&5
-  (eval $ac_cpp conftest.$ac_ext) 2>conftest.er1
+if { (ac_try="$ac_cpp conftest.$ac_ext"
+case "(($ac_try" in
+  *\"* | *\`* | *\\*) ac_try_echo=\$ac_try;;
+  *) ac_try_echo=$ac_try;;
+esac
+eval "echo \"\$as_me:$LINENO: $ac_try_echo\"") >&5
+  (eval "$ac_cpp conftest.$ac_ext") 2>conftest.er1
   ac_status=$?
   grep -v '^ *+' conftest.er1 >conftest.err
   rm -f conftest.er1
   cat conftest.err >&5
   echo "$as_me:$LINENO: \$? = $ac_status" >&5
-  (exit $ac_status); } >/dev/null; then
-  if test -s conftest.err; then
-    ac_cpp_err=$ac_c_preproc_warn_flag
-    ac_cpp_err=$ac_cpp_err$ac_c_werror_flag
-  else
-    ac_cpp_err=
-  fi
-else
-  ac_cpp_err=yes
-fi
-if test -z "$ac_cpp_err"; then
+  (exit $ac_status); } >/dev/null && {
+	 test -z "$ac_c_preproc_warn_flag$ac_c_werror_flag" ||
+	 test ! -s conftest.err
+       }; then
   ac_header_preproc=yes
 else
   echo "$as_me: failed program was:" >&5
@@ -9147,9 +13455,10 @@
 
   ac_header_preproc=no
 fi
+
 rm -f conftest.err conftest.$ac_ext
-echo "$as_me:$LINENO: result: $ac_header_preproc" >&5
-echo "${ECHO_T}$ac_header_preproc" >&6
+{ echo "$as_me:$LINENO: result: $ac_header_preproc" >&5
+echo "${ECHO_T}$ac_header_preproc" >&6; }
 
 # So?  What about this header?
 case $ac_header_compiler:$ac_header_preproc:$ac_c_preproc_warn_flag in
@@ -9173,25 +13482,24 @@
 echo "$as_me: WARNING: $ac_header: proceeding with the preprocessor's result" >&2;}
     { echo "$as_me:$LINENO: WARNING: $ac_header: in the future, the compiler will take precedence" >&5
 echo "$as_me: WARNING: $ac_header: in the future, the compiler will take precedence" >&2;}
-    (
-      cat <<\_ASBOX
+    ( cat <<\_ASBOX
 ## ---------------------------------------------------- ##
 ## Report this to lcd4linux-users@lists.sourceforge.net ##
 ## ---------------------------------------------------- ##
 _ASBOX
-    ) |
-      sed "s/^/$as_me: WARNING:     /" >&2
+     ) | sed "s/^/$as_me: WARNING:     /" >&2
     ;;
 esac
-echo "$as_me:$LINENO: checking for $ac_header" >&5
-echo $ECHO_N "checking for $ac_header... $ECHO_C" >&6
-if eval "test \"\${$as_ac_Header+set}\" = set"; then
+{ echo "$as_me:$LINENO: checking for $ac_header" >&5
+echo $ECHO_N "checking for $ac_header... $ECHO_C" >&6; }
+if { as_var=$as_ac_Header; eval "test \"\${$as_var+set}\" = set"; }; then
   echo $ECHO_N "(cached) $ECHO_C" >&6
 else
   eval "$as_ac_Header=\$ac_header_preproc"
 fi
-echo "$as_me:$LINENO: result: `eval echo '${'$as_ac_Header'}'`" >&5
-echo "${ECHO_T}`eval echo '${'$as_ac_Header'}'`" >&6
+ac_res=`eval echo '${'$as_ac_Header'}'`
+	       { echo "$as_me:$LINENO: result: $ac_res" >&5
+echo "${ECHO_T}$ac_res" >&6; }
 
 fi
 if test `eval echo '${'$as_ac_Header'}'` = yes; then
@@ -9208,9 +13516,9 @@
 for ac_func in fork vfork
 do
 as_ac_var=`echo "ac_cv_func_$ac_func" | $as_tr_sh`
-echo "$as_me:$LINENO: checking for $ac_func" >&5
-echo $ECHO_N "checking for $ac_func... $ECHO_C" >&6
-if eval "test \"\${$as_ac_var+set}\" = set"; then
+{ echo "$as_me:$LINENO: checking for $ac_func" >&5
+echo $ECHO_N "checking for $ac_func... $ECHO_C" >&6; }
+if { as_var=$as_ac_var; eval "test \"\${$as_var+set}\" = set"; }; then
   echo $ECHO_N "(cached) $ECHO_C" >&6
 else
   cat >conftest.$ac_ext <<_ACEOF
@@ -9236,67 +13544,60 @@
 
 #undef $ac_func
 
-/* Override any gcc2 internal prototype to avoid an error.  */
+/* Override any GCC internal prototype to avoid an error.
+   Use char because int might match the return type of a GCC
+   builtin and then its argument prototype would still apply.  */
 #ifdef __cplusplus
 extern "C"
-{
 #endif
-/* We use char because int might match the return type of a gcc2
-   builtin and then its argument prototype would still apply.  */
 char $ac_func ();
 /* The GNU C library defines this for functions which it implements
     to always fail with ENOSYS.  Some functions are actually named
     something starting with __ and the normal name is an alias.  */
-#if defined (__stub_$ac_func) || defined (__stub___$ac_func)
+#if defined __stub_$ac_func || defined __stub___$ac_func
 choke me
-#else
-char (*f) () = $ac_func;
-#endif
-#ifdef __cplusplus
-}
 #endif
 
 int
 main ()
 {
-return f != $ac_func;
+return $ac_func ();
   ;
   return 0;
 }
 _ACEOF
 rm -f conftest.$ac_objext conftest$ac_exeext
-if { (eval echo "$as_me:$LINENO: \"$ac_link\"") >&5
-  (eval $ac_link) 2>conftest.er1
+if { (ac_try="$ac_link"
+case "(($ac_try" in
+  *\"* | *\`* | *\\*) ac_try_echo=\$ac_try;;
+  *) ac_try_echo=$ac_try;;
+esac
+eval "echo \"\$as_me:$LINENO: $ac_try_echo\"") >&5
+  (eval "$ac_link") 2>conftest.er1
   ac_status=$?
   grep -v '^ *+' conftest.er1 >conftest.err
   rm -f conftest.er1
   cat conftest.err >&5
   echo "$as_me:$LINENO: \$? = $ac_status" >&5
-  (exit $ac_status); } &&
-	 { ac_try='test -z "$ac_c_werror_flag"			 || test ! -s conftest.err'
-  { (eval echo "$as_me:$LINENO: \"$ac_try\"") >&5
-  (eval $ac_try) 2>&5
-  ac_status=$?
-  echo "$as_me:$LINENO: \$? = $ac_status" >&5
-  (exit $ac_status); }; } &&
-	 { ac_try='test -s conftest$ac_exeext'
-  { (eval echo "$as_me:$LINENO: \"$ac_try\"") >&5
-  (eval $ac_try) 2>&5
-  ac_status=$?
-  echo "$as_me:$LINENO: \$? = $ac_status" >&5
-  (exit $ac_status); }; }; then
+  (exit $ac_status); } && {
+	 test -z "$ac_c_werror_flag" ||
+	 test ! -s conftest.err
+       } && test -s conftest$ac_exeext &&
+       $as_test_x conftest$ac_exeext; then
   eval "$as_ac_var=yes"
 else
   echo "$as_me: failed program was:" >&5
 sed 's/^/| /' conftest.$ac_ext >&5
 
-eval "$as_ac_var=no"
+	eval "$as_ac_var=no"
 fi
-rm -f conftest.err conftest.$ac_objext \
+
+rm -f core conftest.err conftest.$ac_objext conftest_ipa8_conftest.oo \
       conftest$ac_exeext conftest.$ac_ext
 fi
-echo "$as_me:$LINENO: result: `eval echo '${'$as_ac_var'}'`" >&5
-echo "${ECHO_T}`eval echo '${'$as_ac_var'}'`" >&6
+ac_res=`eval echo '${'$as_ac_var'}'`
+	       { echo "$as_me:$LINENO: result: $ac_res" >&5
+echo "${ECHO_T}$ac_res" >&6; }
 if test `eval echo '${'$as_ac_var'}'` = yes; then
   cat >>confdefs.h <<_ACEOF
 #define `echo "HAVE_$ac_func" | $as_tr_cpp` 1
@@ -9306,8 +13607,8 @@
 done
 
 if test "x$ac_cv_func_fork" = xyes; then
-  echo "$as_me:$LINENO: checking for working fork" >&5
-echo $ECHO_N "checking for working fork... $ECHO_C" >&6
+  { echo "$as_me:$LINENO: checking for working fork" >&5
+echo $ECHO_N "checking for working fork... $ECHO_C" >&6; }
 if test "${ac_cv_func_fork_works+set}" = set; then
   echo $ECHO_N "(cached) $ECHO_C" >&6
 else
@@ -9315,27 +13616,40 @@
   ac_cv_func_fork_works=cross
 else
   cat >conftest.$ac_ext <<_ACEOF
-/* By Ruediger Kuhlmann. */
-      #include <sys/types.h>
-      #if HAVE_UNISTD_H
-      # include <unistd.h>
-      #endif
-      /* Some systems only have a dummy stub for fork() */
-      int main ()
-      {
-	if (fork() < 0)
-	  exit (1);
-	exit (0);
-      }
+/* confdefs.h.  */
+_ACEOF
+cat confdefs.h >>conftest.$ac_ext
+cat >>conftest.$ac_ext <<_ACEOF
+/* end confdefs.h.  */
+$ac_includes_default
+int
+main ()
+{
+
+	  /* By Ruediger Kuhlmann. */
+	  return fork () < 0;
+
+  ;
+  return 0;
+}
 _ACEOF
 rm -f conftest$ac_exeext
-if { (eval echo "$as_me:$LINENO: \"$ac_link\"") >&5
-  (eval $ac_link) 2>&5
+if { (ac_try="$ac_link"
+case "(($ac_try" in
+  *\"* | *\`* | *\\*) ac_try_echo=\$ac_try;;
+  *) ac_try_echo=$ac_try;;
+esac
+eval "echo \"\$as_me:$LINENO: $ac_try_echo\"") >&5
+  (eval "$ac_link") 2>&5
   ac_status=$?
   echo "$as_me:$LINENO: \$? = $ac_status" >&5
   (exit $ac_status); } && { ac_try='./conftest$ac_exeext'
-  { (eval echo "$as_me:$LINENO: \"$ac_try\"") >&5
-  (eval $ac_try) 2>&5
+  { (case "(($ac_try" in
+  *\"* | *\`* | *\\*) ac_try_echo=\$ac_try;;
+  *) ac_try_echo=$ac_try;;
+esac
+eval "echo \"\$as_me:$LINENO: $ac_try_echo\"") >&5
+  (eval "$ac_try") 2>&5
   ac_status=$?
   echo "$as_me:$LINENO: \$? = $ac_status" >&5
   (exit $ac_status); }; }; then
@@ -9348,11 +13662,13 @@
 ( exit $ac_status )
 ac_cv_func_fork_works=no
 fi
-rm -f core *.core gmon.out bb.out conftest$ac_exeext conftest.$ac_objext conftest.$ac_ext
+rm -f core *.core core.conftest.* gmon.out bb.out conftest$ac_exeext conftest.$ac_objext conftest.$ac_ext
 fi
+
+
 fi
-echo "$as_me:$LINENO: result: $ac_cv_func_fork_works" >&5
-echo "${ECHO_T}$ac_cv_func_fork_works" >&6
+{ echo "$as_me:$LINENO: result: $ac_cv_func_fork_works" >&5
+echo "${ECHO_T}$ac_cv_func_fork_works" >&6; }
 
 else
   ac_cv_func_fork_works=$ac_cv_func_fork
@@ -9372,8 +13688,8 @@
 fi
 ac_cv_func_vfork_works=$ac_cv_func_vfork
 if test "x$ac_cv_func_vfork" = xyes; then
-  echo "$as_me:$LINENO: checking for working vfork" >&5
-echo $ECHO_N "checking for working vfork... $ECHO_C" >&6
+  { echo "$as_me:$LINENO: checking for working vfork" >&5
+echo $ECHO_N "checking for working vfork... $ECHO_C" >&6; }
 if test "${ac_cv_func_vfork_works+set}" = set; then
   echo $ECHO_N "(cached) $ECHO_C" >&6
 else
@@ -9387,15 +13703,9 @@
 cat >>conftest.$ac_ext <<_ACEOF
 /* end confdefs.h.  */
 /* Thanks to Paul Eggert for this test.  */
-#include <stdio.h>
-#include <stdlib.h>
-#include <sys/types.h>
-#include <sys/stat.h>
+$ac_includes_default
 #include <sys/wait.h>
-#if HAVE_UNISTD_H
-# include <unistd.h>
-#endif
-#if HAVE_VFORK_H
+#ifdef HAVE_VFORK_H
 # include <vfork.h>
 #endif
 /* On some sparc systems, changes by the child to local and incoming
@@ -9466,7 +13776,7 @@
 
     while (wait(&status) != child)
       ;
-    exit(
+    return (
 	 /* Was there some problem with vforking?  */
 	 child < 0
 
@@ -9483,13 +13793,22 @@
 }
 _ACEOF
 rm -f conftest$ac_exeext
-if { (eval echo "$as_me:$LINENO: \"$ac_link\"") >&5
-  (eval $ac_link) 2>&5
+if { (ac_try="$ac_link"
+case "(($ac_try" in
+  *\"* | *\`* | *\\*) ac_try_echo=\$ac_try;;
+  *) ac_try_echo=$ac_try;;
+esac
+eval "echo \"\$as_me:$LINENO: $ac_try_echo\"") >&5
+  (eval "$ac_link") 2>&5
   ac_status=$?
   echo "$as_me:$LINENO: \$? = $ac_status" >&5
   (exit $ac_status); } && { ac_try='./conftest$ac_exeext'
-  { (eval echo "$as_me:$LINENO: \"$ac_try\"") >&5
-  (eval $ac_try) 2>&5
+  { (case "(($ac_try" in
+  *\"* | *\`* | *\\*) ac_try_echo=\$ac_try;;
+  *) ac_try_echo=$ac_try;;
+esac
+eval "echo \"\$as_me:$LINENO: $ac_try_echo\"") >&5
+  (eval "$ac_try") 2>&5
   ac_status=$?
   echo "$as_me:$LINENO: \$? = $ac_status" >&5
   (exit $ac_status); }; }; then
@@ -9502,11 +13821,13 @@
 ( exit $ac_status )
 ac_cv_func_vfork_works=no
 fi
-rm -f core *.core gmon.out bb.out conftest$ac_exeext conftest.$ac_objext conftest.$ac_ext
+rm -f core *.core core.conftest.* gmon.out bb.out conftest$ac_exeext conftest.$ac_objext conftest.$ac_ext
 fi
+
+
 fi
-echo "$as_me:$LINENO: result: $ac_cv_func_vfork_works" >&5
-echo "${ECHO_T}$ac_cv_func_vfork_works" >&6
+{ echo "$as_me:$LINENO: result: $ac_cv_func_vfork_works" >&5
+echo "${ECHO_T}$ac_cv_func_vfork_works" >&6; }
 
 fi;
 if test "x$ac_cv_func_fork_works" = xcross; then
@@ -9536,9 +13857,14 @@
 
 fi
 
+
+# uClibc has no getloadavg()
+# AC_FUNC_GETLOADAVG sounds promising, but does not really work
+#AC_FUNC_GETLOADAVG
+
 if test $ac_cv_c_compiler_gnu = yes; then
-    echo "$as_me:$LINENO: checking whether $CC needs -traditional" >&5
-echo $ECHO_N "checking whether $CC needs -traditional... $ECHO_C" >&6
+    { echo "$as_me:$LINENO: checking whether $CC needs -traditional" >&5
+echo $ECHO_N "checking whether $CC needs -traditional... $ECHO_C" >&6; }
 if test "${ac_cv_prog_gcc_traditional+set}" = set; then
   echo $ECHO_N "(cached) $ECHO_C" >&6
 else
@@ -9556,47 +13882,277 @@
   $EGREP "$ac_pattern" >/dev/null 2>&1; then
   ac_cv_prog_gcc_traditional=yes
 else
-  ac_cv_prog_gcc_traditional=no
-fi
-rm -f conftest*
+  ac_cv_prog_gcc_traditional=no
+fi
+rm -f conftest*
+
+
+  if test $ac_cv_prog_gcc_traditional = no; then
+    cat >conftest.$ac_ext <<_ACEOF
+/* confdefs.h.  */
+_ACEOF
+cat confdefs.h >>conftest.$ac_ext
+cat >>conftest.$ac_ext <<_ACEOF
+/* end confdefs.h.  */
+#include <termio.h>
+Autoconf TCGETA
+_ACEOF
+if (eval "$ac_cpp conftest.$ac_ext") 2>&5 |
+  $EGREP "$ac_pattern" >/dev/null 2>&1; then
+  ac_cv_prog_gcc_traditional=yes
+fi
+rm -f conftest*
+
+  fi
+fi
+{ echo "$as_me:$LINENO: result: $ac_cv_prog_gcc_traditional" >&5
+echo "${ECHO_T}$ac_cv_prog_gcc_traditional" >&6; }
+  if test $ac_cv_prog_gcc_traditional = yes; then
+    CC="$CC -traditional"
+  fi
+fi
+
+
+# removed for uClibc compatibility
+#AC_FUNC_MALLOC
+#AC_FUNC_REALLOC
+
+
+
+for ac_header in sys/select.h sys/socket.h
+do
+as_ac_Header=`echo "ac_cv_header_$ac_header" | $as_tr_sh`
+if { as_var=$as_ac_Header; eval "test \"\${$as_var+set}\" = set"; }; then
+  { echo "$as_me:$LINENO: checking for $ac_header" >&5
+echo $ECHO_N "checking for $ac_header... $ECHO_C" >&6; }
+if { as_var=$as_ac_Header; eval "test \"\${$as_var+set}\" = set"; }; then
+  echo $ECHO_N "(cached) $ECHO_C" >&6
+fi
+ac_res=`eval echo '${'$as_ac_Header'}'`
+	       { echo "$as_me:$LINENO: result: $ac_res" >&5
+echo "${ECHO_T}$ac_res" >&6; }
+else
+  # Is the header compilable?
+{ echo "$as_me:$LINENO: checking $ac_header usability" >&5
+echo $ECHO_N "checking $ac_header usability... $ECHO_C" >&6; }
+cat >conftest.$ac_ext <<_ACEOF
+/* confdefs.h.  */
+_ACEOF
+cat confdefs.h >>conftest.$ac_ext
+cat >>conftest.$ac_ext <<_ACEOF
+/* end confdefs.h.  */
+$ac_includes_default
+#include <$ac_header>
+_ACEOF
+rm -f conftest.$ac_objext
+if { (ac_try="$ac_compile"
+case "(($ac_try" in
+  *\"* | *\`* | *\\*) ac_try_echo=\$ac_try;;
+  *) ac_try_echo=$ac_try;;
+esac
+eval "echo \"\$as_me:$LINENO: $ac_try_echo\"") >&5
+  (eval "$ac_compile") 2>conftest.er1
+  ac_status=$?
+  grep -v '^ *+' conftest.er1 >conftest.err
+  rm -f conftest.er1
+  cat conftest.err >&5
+  echo "$as_me:$LINENO: \$? = $ac_status" >&5
+  (exit $ac_status); } && {
+	 test -z "$ac_c_werror_flag" ||
+	 test ! -s conftest.err
+       } && test -s conftest.$ac_objext; then
+  ac_header_compiler=yes
+else
+  echo "$as_me: failed program was:" >&5
+sed 's/^/| /' conftest.$ac_ext >&5
+
+	ac_header_compiler=no
+fi
+
+rm -f core conftest.err conftest.$ac_objext conftest.$ac_ext
+{ echo "$as_me:$LINENO: result: $ac_header_compiler" >&5
+echo "${ECHO_T}$ac_header_compiler" >&6; }
+
+# Is the header present?
+{ echo "$as_me:$LINENO: checking $ac_header presence" >&5
+echo $ECHO_N "checking $ac_header presence... $ECHO_C" >&6; }
+cat >conftest.$ac_ext <<_ACEOF
+/* confdefs.h.  */
+_ACEOF
+cat confdefs.h >>conftest.$ac_ext
+cat >>conftest.$ac_ext <<_ACEOF
+/* end confdefs.h.  */
+#include <$ac_header>
+_ACEOF
+if { (ac_try="$ac_cpp conftest.$ac_ext"
+case "(($ac_try" in
+  *\"* | *\`* | *\\*) ac_try_echo=\$ac_try;;
+  *) ac_try_echo=$ac_try;;
+esac
+eval "echo \"\$as_me:$LINENO: $ac_try_echo\"") >&5
+  (eval "$ac_cpp conftest.$ac_ext") 2>conftest.er1
+  ac_status=$?
+  grep -v '^ *+' conftest.er1 >conftest.err
+  rm -f conftest.er1
+  cat conftest.err >&5
+  echo "$as_me:$LINENO: \$? = $ac_status" >&5
+  (exit $ac_status); } >/dev/null && {
+	 test -z "$ac_c_preproc_warn_flag$ac_c_werror_flag" ||
+	 test ! -s conftest.err
+       }; then
+  ac_header_preproc=yes
+else
+  echo "$as_me: failed program was:" >&5
+sed 's/^/| /' conftest.$ac_ext >&5
+
+  ac_header_preproc=no
+fi
+
+rm -f conftest.err conftest.$ac_ext
+{ echo "$as_me:$LINENO: result: $ac_header_preproc" >&5
+echo "${ECHO_T}$ac_header_preproc" >&6; }
+
+# So?  What about this header?
+case $ac_header_compiler:$ac_header_preproc:$ac_c_preproc_warn_flag in
+  yes:no: )
+    { echo "$as_me:$LINENO: WARNING: $ac_header: accepted by the compiler, rejected by the preprocessor!" >&5
+echo "$as_me: WARNING: $ac_header: accepted by the compiler, rejected by the preprocessor!" >&2;}
+    { echo "$as_me:$LINENO: WARNING: $ac_header: proceeding with the compiler's result" >&5
+echo "$as_me: WARNING: $ac_header: proceeding with the compiler's result" >&2;}
+    ac_header_preproc=yes
+    ;;
+  no:yes:* )
+    { echo "$as_me:$LINENO: WARNING: $ac_header: present but cannot be compiled" >&5
+echo "$as_me: WARNING: $ac_header: present but cannot be compiled" >&2;}
+    { echo "$as_me:$LINENO: WARNING: $ac_header:     check for missing prerequisite headers?" >&5
+echo "$as_me: WARNING: $ac_header:     check for missing prerequisite headers?" >&2;}
+    { echo "$as_me:$LINENO: WARNING: $ac_header: see the Autoconf documentation" >&5
+echo "$as_me: WARNING: $ac_header: see the Autoconf documentation" >&2;}
+    { echo "$as_me:$LINENO: WARNING: $ac_header:     section \"Present But Cannot Be Compiled\"" >&5
+echo "$as_me: WARNING: $ac_header:     section \"Present But Cannot Be Compiled\"" >&2;}
+    { echo "$as_me:$LINENO: WARNING: $ac_header: proceeding with the preprocessor's result" >&5
+echo "$as_me: WARNING: $ac_header: proceeding with the preprocessor's result" >&2;}
+    { echo "$as_me:$LINENO: WARNING: $ac_header: in the future, the compiler will take precedence" >&5
+echo "$as_me: WARNING: $ac_header: in the future, the compiler will take precedence" >&2;}
+    ( cat <<\_ASBOX
+## ---------------------------------------------------- ##
+## Report this to lcd4linux-users@lists.sourceforge.net ##
+## ---------------------------------------------------- ##
+_ASBOX
+     ) | sed "s/^/$as_me: WARNING:     /" >&2
+    ;;
+esac
+{ echo "$as_me:$LINENO: checking for $ac_header" >&5
+echo $ECHO_N "checking for $ac_header... $ECHO_C" >&6; }
+if { as_var=$as_ac_Header; eval "test \"\${$as_var+set}\" = set"; }; then
+  echo $ECHO_N "(cached) $ECHO_C" >&6
+else
+  eval "$as_ac_Header=\$ac_header_preproc"
+fi
+ac_res=`eval echo '${'$as_ac_Header'}'`
+	       { echo "$as_me:$LINENO: result: $ac_res" >&5
+echo "${ECHO_T}$ac_res" >&6; }
+
+fi
+if test `eval echo '${'$as_ac_Header'}'` = yes; then
+  cat >>confdefs.h <<_ACEOF
+#define `echo "HAVE_$ac_header" | $as_tr_cpp` 1
+_ACEOF
+
+fi
+
+done
+
+{ echo "$as_me:$LINENO: checking types of arguments for select" >&5
+echo $ECHO_N "checking types of arguments for select... $ECHO_C" >&6; }
+if test "${ac_cv_func_select_args+set}" = set; then
+  echo $ECHO_N "(cached) $ECHO_C" >&6
+else
+  for ac_arg234 in 'fd_set *' 'int *' 'void *'; do
+ for ac_arg1 in 'int' 'size_t' 'unsigned long int' 'unsigned int'; do
+  for ac_arg5 in 'struct timeval *' 'const struct timeval *'; do
+   cat >conftest.$ac_ext <<_ACEOF
+/* confdefs.h.  */
+_ACEOF
+cat confdefs.h >>conftest.$ac_ext
+cat >>conftest.$ac_ext <<_ACEOF
+/* end confdefs.h.  */
+$ac_includes_default
+#ifdef HAVE_SYS_SELECT_H
+# include <sys/select.h>
+#endif
+#ifdef HAVE_SYS_SOCKET_H
+# include <sys/socket.h>
+#endif
+
+int
+main ()
+{
+extern int select ($ac_arg1,
+					    $ac_arg234, $ac_arg234, $ac_arg234,
+					    $ac_arg5);
+  ;
+  return 0;
+}
+_ACEOF
+rm -f conftest.$ac_objext
+if { (ac_try="$ac_compile"
+case "(($ac_try" in
+  *\"* | *\`* | *\\*) ac_try_echo=\$ac_try;;
+  *) ac_try_echo=$ac_try;;
+esac
+eval "echo \"\$as_me:$LINENO: $ac_try_echo\"") >&5
+  (eval "$ac_compile") 2>conftest.er1
+  ac_status=$?
+  grep -v '^ *+' conftest.er1 >conftest.err
+  rm -f conftest.er1
+  cat conftest.err >&5
+  echo "$as_me:$LINENO: \$? = $ac_status" >&5
+  (exit $ac_status); } && {
+	 test -z "$ac_c_werror_flag" ||
+	 test ! -s conftest.err
+       } && test -s conftest.$ac_objext; then
+  ac_cv_func_select_args="$ac_arg1,$ac_arg234,$ac_arg5"; break 3
+else
+  echo "$as_me: failed program was:" >&5
+sed 's/^/| /' conftest.$ac_ext >&5
 
 
-  if test $ac_cv_prog_gcc_traditional = no; then
-    cat >conftest.$ac_ext <<_ACEOF
-/* confdefs.h.  */
-_ACEOF
-cat confdefs.h >>conftest.$ac_ext
-cat >>conftest.$ac_ext <<_ACEOF
-/* end confdefs.h.  */
-#include <termio.h>
-Autoconf TCGETA
-_ACEOF
-if (eval "$ac_cpp conftest.$ac_ext") 2>&5 |
-  $EGREP "$ac_pattern" >/dev/null 2>&1; then
-  ac_cv_prog_gcc_traditional=yes
 fi
-rm -f conftest*
 
-  fi
-fi
-echo "$as_me:$LINENO: result: $ac_cv_prog_gcc_traditional" >&5
-echo "${ECHO_T}$ac_cv_prog_gcc_traditional" >&6
-  if test $ac_cv_prog_gcc_traditional = yes; then
-    CC="$CC -traditional"
-  fi
+rm -f core conftest.err conftest.$ac_objext conftest.$ac_ext
+  done
+ done
+done
+# Provide a safe default value.
+: ${ac_cv_func_select_args='int,int *,struct timeval *'}
+
 fi
+{ echo "$as_me:$LINENO: result: $ac_cv_func_select_args" >&5
+echo "${ECHO_T}$ac_cv_func_select_args" >&6; }
+ac_save_IFS=$IFS; IFS=','
+set dummy `echo "$ac_cv_func_select_args" | sed 's/\*/\*/g'`
+IFS=$ac_save_IFS
+shift
 
+cat >>confdefs.h <<_ACEOF
+#define SELECT_TYPE_ARG1 $1
+_ACEOF
 
-# uClibc has no getloadavg()
-# AC_FUNC_GETLOADAVG sounds promising, but does not really work
-#AC_FUNC_GETLOADAVG
 
-#removed for uClibc compatibility
-#AC_FUNC_MALLOC
-#AC_FUNC_REALLOC
+cat >>confdefs.h <<_ACEOF
+#define SELECT_TYPE_ARG234 ($2)
+_ACEOF
+
+
+cat >>confdefs.h <<_ACEOF
+#define SELECT_TYPE_ARG5 ($3)
+_ACEOF
+
+rm -f conftest*
 
-echo "$as_me:$LINENO: checking return type of signal handlers" >&5
-echo $ECHO_N "checking return type of signal handlers... $ECHO_C" >&6
+{ echo "$as_me:$LINENO: checking return type of signal handlers" >&5
+echo $ECHO_N "checking return type of signal handlers... $ECHO_C" >&6; }
 if test "${ac_cv_type_signal+set}" = set; then
   echo $ECHO_N "(cached) $ECHO_C" >&6
 else
@@ -9608,63 +14164,52 @@
 /* end confdefs.h.  */
 #include <sys/types.h>
 #include <signal.h>
-#ifdef signal
-# undef signal
-#endif
-#ifdef __cplusplus
-extern "C" void (*signal (int, void (*)(int)))(int);
-#else
-void (*signal ()) ();
-#endif
 
 int
 main ()
 {
-int i;
+return *(signal (0, 0)) (0) == 1;
   ;
   return 0;
 }
 _ACEOF
 rm -f conftest.$ac_objext
-if { (eval echo "$as_me:$LINENO: \"$ac_compile\"") >&5
-  (eval $ac_compile) 2>conftest.er1
+if { (ac_try="$ac_compile"
+case "(($ac_try" in
+  *\"* | *\`* | *\\*) ac_try_echo=\$ac_try;;
+  *) ac_try_echo=$ac_try;;
+esac
+eval "echo \"\$as_me:$LINENO: $ac_try_echo\"") >&5
+  (eval "$ac_compile") 2>conftest.er1
   ac_status=$?
   grep -v '^ *+' conftest.er1 >conftest.err
   rm -f conftest.er1
   cat conftest.err >&5
   echo "$as_me:$LINENO: \$? = $ac_status" >&5
-  (exit $ac_status); } &&
-	 { ac_try='test -z "$ac_c_werror_flag"			 || test ! -s conftest.err'
-  { (eval echo "$as_me:$LINENO: \"$ac_try\"") >&5
-  (eval $ac_try) 2>&5
-  ac_status=$?
-  echo "$as_me:$LINENO: \$? = $ac_status" >&5
-  (exit $ac_status); }; } &&
-	 { ac_try='test -s conftest.$ac_objext'
-  { (eval echo "$as_me:$LINENO: \"$ac_try\"") >&5
-  (eval $ac_try) 2>&5
-  ac_status=$?
-  echo "$as_me:$LINENO: \$? = $ac_status" >&5
-  (exit $ac_status); }; }; then
-  ac_cv_type_signal=void
+  (exit $ac_status); } && {
+	 test -z "$ac_c_werror_flag" ||
+	 test ! -s conftest.err
+       } && test -s conftest.$ac_objext; then
+  ac_cv_type_signal=int
 else
   echo "$as_me: failed program was:" >&5
 sed 's/^/| /' conftest.$ac_ext >&5
 
-ac_cv_type_signal=int
+	ac_cv_type_signal=void
 fi
-rm -f conftest.err conftest.$ac_objext conftest.$ac_ext
+
+rm -f core conftest.err conftest.$ac_objext conftest.$ac_ext
 fi
-echo "$as_me:$LINENO: result: $ac_cv_type_signal" >&5
-echo "${ECHO_T}$ac_cv_type_signal" >&6
+{ echo "$as_me:$LINENO: result: $ac_cv_type_signal" >&5
+echo "${ECHO_T}$ac_cv_type_signal" >&6; }
 
 cat >>confdefs.h <<_ACEOF
 #define RETSIGTYPE $ac_cv_type_signal
 _ACEOF
 
 
-echo "$as_me:$LINENO: checking whether lstat dereferences a symlink specified with a trailing slash" >&5
-echo $ECHO_N "checking whether lstat dereferences a symlink specified with a trailing slash... $ECHO_C" >&6
+{ echo "$as_me:$LINENO: checking whether lstat dereferences a symlink specified with a trailing slash" >&5
+echo $ECHO_N "checking whether lstat dereferences a symlink specified with a trailing slash... $ECHO_C" >&6; }
 if test "${ac_cv_func_lstat_dereferences_slashed_symlink+set}" = set; then
   echo $ECHO_N "(cached) $ECHO_C" >&6
 else
@@ -9688,19 +14233,28 @@
      /* Linux will dereference the symlink and fail.
 	That is better in the sense that it means we will not
 	have to compile and use the lstat wrapper.  */
-     exit (lstat ("conftest.sym/", &sbuf) ? 0 : 1);
+     return lstat ("conftest.sym/", &sbuf) == 0;
   ;
   return 0;
 }
 _ACEOF
 rm -f conftest$ac_exeext
-if { (eval echo "$as_me:$LINENO: \"$ac_link\"") >&5
-  (eval $ac_link) 2>&5
+if { (ac_try="$ac_link"
+case "(($ac_try" in
+  *\"* | *\`* | *\\*) ac_try_echo=\$ac_try;;
+  *) ac_try_echo=$ac_try;;
+esac
+eval "echo \"\$as_me:$LINENO: $ac_try_echo\"") >&5
+  (eval "$ac_link") 2>&5
   ac_status=$?
   echo "$as_me:$LINENO: \$? = $ac_status" >&5
   (exit $ac_status); } && { ac_try='./conftest$ac_exeext'
-  { (eval echo "$as_me:$LINENO: \"$ac_try\"") >&5
-  (eval $ac_try) 2>&5
+  { (case "(($ac_try" in
+  *\"* | *\`* | *\\*) ac_try_echo=\$ac_try;;
+  *) ac_try_echo=$ac_try;;
+esac
+eval "echo \"\$as_me:$LINENO: $ac_try_echo\"") >&5
+  (eval "$ac_try") 2>&5
   ac_status=$?
   echo "$as_me:$LINENO: \$? = $ac_status" >&5
   (exit $ac_status); }; }; then
@@ -9713,8 +14267,10 @@
 ( exit $ac_status )
 ac_cv_func_lstat_dereferences_slashed_symlink=no
 fi
-rm -f core *.core gmon.out bb.out conftest$ac_exeext conftest.$ac_objext conftest.$ac_ext
+rm -f core *.core core.conftest.* gmon.out bb.out conftest$ac_exeext conftest.$ac_objext conftest.$ac_ext
 fi
+
+
 else
   # If the `ln -s' command failed, then we probably don't even
   # have an lstat function.
@@ -9723,8 +14279,8 @@
 rm -f conftest.sym conftest.file
 
 fi
-echo "$as_me:$LINENO: result: $ac_cv_func_lstat_dereferences_slashed_symlink" >&5
-echo "${ECHO_T}$ac_cv_func_lstat_dereferences_slashed_symlink" >&6
+{ echo "$as_me:$LINENO: result: $ac_cv_func_lstat_dereferences_slashed_symlink" >&5
+echo "${ECHO_T}$ac_cv_func_lstat_dereferences_slashed_symlink" >&6; }
 
 test $ac_cv_func_lstat_dereferences_slashed_symlink = yes &&
 
@@ -9734,18 +14290,16 @@
 
 
 if test $ac_cv_func_lstat_dereferences_slashed_symlink = no; then
-  case $LIBOBJS in
-    "lstat.$ac_objext"   | \
-  *" lstat.$ac_objext"   | \
-    "lstat.$ac_objext "* | \
+  case " $LIBOBJS " in
   *" lstat.$ac_objext "* ) ;;
-  *) LIBOBJS="$LIBOBJS lstat.$ac_objext" ;;
+  *) LIBOBJS="$LIBOBJS lstat.$ac_objext"
+ ;;
 esac
 
 fi
 
-echo "$as_me:$LINENO: checking whether stat accepts an empty string" >&5
-echo $ECHO_N "checking whether stat accepts an empty string... $ECHO_C" >&6
+{ echo "$as_me:$LINENO: checking whether stat accepts an empty string" >&5
+echo $ECHO_N "checking whether stat accepts an empty string... $ECHO_C" >&6; }
 if test "${ac_cv_func_stat_empty_string_bug+set}" = set; then
   echo $ECHO_N "(cached) $ECHO_C" >&6
 else
@@ -9763,43 +14317,52 @@
 main ()
 {
 struct stat sbuf;
-  exit (stat ("", &sbuf) ? 1 : 0);
+  return stat ("", &sbuf) == 0;
   ;
   return 0;
 }
 _ACEOF
 rm -f conftest$ac_exeext
-if { (eval echo "$as_me:$LINENO: \"$ac_link\"") >&5
-  (eval $ac_link) 2>&5
+if { (ac_try="$ac_link"
+case "(($ac_try" in
+  *\"* | *\`* | *\\*) ac_try_echo=\$ac_try;;
+  *) ac_try_echo=$ac_try;;
+esac
+eval "echo \"\$as_me:$LINENO: $ac_try_echo\"") >&5
+  (eval "$ac_link") 2>&5
   ac_status=$?
   echo "$as_me:$LINENO: \$? = $ac_status" >&5
   (exit $ac_status); } && { ac_try='./conftest$ac_exeext'
-  { (eval echo "$as_me:$LINENO: \"$ac_try\"") >&5
-  (eval $ac_try) 2>&5
+  { (case "(($ac_try" in
+  *\"* | *\`* | *\\*) ac_try_echo=\$ac_try;;
+  *) ac_try_echo=$ac_try;;
+esac
+eval "echo \"\$as_me:$LINENO: $ac_try_echo\"") >&5
+  (eval "$ac_try") 2>&5
   ac_status=$?
   echo "$as_me:$LINENO: \$? = $ac_status" >&5
   (exit $ac_status); }; }; then
-  ac_cv_func_stat_empty_string_bug=yes
+  ac_cv_func_stat_empty_string_bug=no
 else
   echo "$as_me: program exited with status $ac_status" >&5
 echo "$as_me: failed program was:" >&5
 sed 's/^/| /' conftest.$ac_ext >&5
 
 ( exit $ac_status )
-ac_cv_func_stat_empty_string_bug=no
+ac_cv_func_stat_empty_string_bug=yes
 fi
-rm -f core *.core gmon.out bb.out conftest$ac_exeext conftest.$ac_objext conftest.$ac_ext
+rm -f core *.core core.conftest.* gmon.out bb.out conftest$ac_exeext conftest.$ac_objext conftest.$ac_ext
 fi
+
+
 fi
-echo "$as_me:$LINENO: result: $ac_cv_func_stat_empty_string_bug" >&5
-echo "${ECHO_T}$ac_cv_func_stat_empty_string_bug" >&6
+{ echo "$as_me:$LINENO: result: $ac_cv_func_stat_empty_string_bug" >&5
+echo "${ECHO_T}$ac_cv_func_stat_empty_string_bug" >&6; }
 if test $ac_cv_func_stat_empty_string_bug = yes; then
-  case $LIBOBJS in
-    "stat.$ac_objext"   | \
-  *" stat.$ac_objext"   | \
-    "stat.$ac_objext "* | \
+  case " $LIBOBJS " in
   *" stat.$ac_objext "* ) ;;
-  *) LIBOBJS="$LIBOBJS stat.$ac_objext" ;;
+  *) LIBOBJS="$LIBOBJS stat.$ac_objext"
+ ;;
 esac
 
 
@@ -9813,9 +14376,9 @@
 for ac_func in strftime
 do
 as_ac_var=`echo "ac_cv_func_$ac_func" | $as_tr_sh`
-echo "$as_me:$LINENO: checking for $ac_func" >&5
-echo $ECHO_N "checking for $ac_func... $ECHO_C" >&6
-if eval "test \"\${$as_ac_var+set}\" = set"; then
+{ echo "$as_me:$LINENO: checking for $ac_func" >&5
+echo $ECHO_N "checking for $ac_func... $ECHO_C" >&6; }
+if { as_var=$as_ac_var; eval "test \"\${$as_var+set}\" = set"; }; then
   echo $ECHO_N "(cached) $ECHO_C" >&6
 else
   cat >conftest.$ac_ext <<_ACEOF
@@ -9841,67 +14404,60 @@
 
 #undef $ac_func
 
-/* Override any gcc2 internal prototype to avoid an error.  */
+/* Override any GCC internal prototype to avoid an error.
+   Use char because int might match the return type of a GCC
+   builtin and then its argument prototype would still apply.  */
 #ifdef __cplusplus
 extern "C"
-{
 #endif
-/* We use char because int might match the return type of a gcc2
-   builtin and then its argument prototype would still apply.  */
 char $ac_func ();
 /* The GNU C library defines this for functions which it implements
     to always fail with ENOSYS.  Some functions are actually named
     something starting with __ and the normal name is an alias.  */
-#if defined (__stub_$ac_func) || defined (__stub___$ac_func)
+#if defined __stub_$ac_func || defined __stub___$ac_func
 choke me
-#else
-char (*f) () = $ac_func;
-#endif
-#ifdef __cplusplus
-}
 #endif
 
 int
 main ()
 {
-return f != $ac_func;
+return $ac_func ();
   ;
   return 0;
 }
 _ACEOF
 rm -f conftest.$ac_objext conftest$ac_exeext
-if { (eval echo "$as_me:$LINENO: \"$ac_link\"") >&5
-  (eval $ac_link) 2>conftest.er1
+if { (ac_try="$ac_link"
+case "(($ac_try" in
+  *\"* | *\`* | *\\*) ac_try_echo=\$ac_try;;
+  *) ac_try_echo=$ac_try;;
+esac
+eval "echo \"\$as_me:$LINENO: $ac_try_echo\"") >&5
+  (eval "$ac_link") 2>conftest.er1
   ac_status=$?
   grep -v '^ *+' conftest.er1 >conftest.err
   rm -f conftest.er1
   cat conftest.err >&5
   echo "$as_me:$LINENO: \$? = $ac_status" >&5
-  (exit $ac_status); } &&
-	 { ac_try='test -z "$ac_c_werror_flag"			 || test ! -s conftest.err'
-  { (eval echo "$as_me:$LINENO: \"$ac_try\"") >&5
-  (eval $ac_try) 2>&5
-  ac_status=$?
-  echo "$as_me:$LINENO: \$? = $ac_status" >&5
-  (exit $ac_status); }; } &&
-	 { ac_try='test -s conftest$ac_exeext'
-  { (eval echo "$as_me:$LINENO: \"$ac_try\"") >&5
-  (eval $ac_try) 2>&5
-  ac_status=$?
-  echo "$as_me:$LINENO: \$? = $ac_status" >&5
-  (exit $ac_status); }; }; then
+  (exit $ac_status); } && {
+	 test -z "$ac_c_werror_flag" ||
+	 test ! -s conftest.err
+       } && test -s conftest$ac_exeext &&
+       $as_test_x conftest$ac_exeext; then
   eval "$as_ac_var=yes"
 else
   echo "$as_me: failed program was:" >&5
 sed 's/^/| /' conftest.$ac_ext >&5
 
-eval "$as_ac_var=no"
+	eval "$as_ac_var=no"
 fi
-rm -f conftest.err conftest.$ac_objext \
+
+rm -f core conftest.err conftest.$ac_objext conftest_ipa8_conftest.oo \
       conftest$ac_exeext conftest.$ac_ext
 fi
-echo "$as_me:$LINENO: result: `eval echo '${'$as_ac_var'}'`" >&5
-echo "${ECHO_T}`eval echo '${'$as_ac_var'}'`" >&6
+ac_res=`eval echo '${'$as_ac_var'}'`
+	       { echo "$as_me:$LINENO: result: $ac_res" >&5
+echo "${ECHO_T}$ac_res" >&6; }
 if test `eval echo '${'$as_ac_var'}'` = yes; then
   cat >>confdefs.h <<_ACEOF
 #define `echo "HAVE_$ac_func" | $as_tr_cpp` 1
@@ -9909,8 +14465,8 @@
 
 else
   # strftime is in -lintl on SCO UNIX.
-echo "$as_me:$LINENO: checking for strftime in -lintl" >&5
-echo $ECHO_N "checking for strftime in -lintl... $ECHO_C" >&6
+{ echo "$as_me:$LINENO: checking for strftime in -lintl" >&5
+echo $ECHO_N "checking for strftime in -lintl... $ECHO_C" >&6; }
 if test "${ac_cv_lib_intl_strftime+set}" = set; then
   echo $ECHO_N "(cached) $ECHO_C" >&6
 else
@@ -9923,55 +14479,53 @@
 cat >>conftest.$ac_ext <<_ACEOF
 /* end confdefs.h.  */
 
-/* Override any gcc2 internal prototype to avoid an error.  */
+/* Override any GCC internal prototype to avoid an error.
+   Use char because int might match the return type of a GCC
+   builtin and then its argument prototype would still apply.  */
 #ifdef __cplusplus
 extern "C"
 #endif
-/* We use char because int might match the return type of a gcc2
-   builtin and then its argument prototype would still apply.  */
 char strftime ();
 int
 main ()
 {
-strftime ();
+return strftime ();
   ;
   return 0;
 }
 _ACEOF
 rm -f conftest.$ac_objext conftest$ac_exeext
-if { (eval echo "$as_me:$LINENO: \"$ac_link\"") >&5
-  (eval $ac_link) 2>conftest.er1
+if { (ac_try="$ac_link"
+case "(($ac_try" in
+  *\"* | *\`* | *\\*) ac_try_echo=\$ac_try;;
+  *) ac_try_echo=$ac_try;;
+esac
+eval "echo \"\$as_me:$LINENO: $ac_try_echo\"") >&5
+  (eval "$ac_link") 2>conftest.er1
   ac_status=$?
   grep -v '^ *+' conftest.er1 >conftest.err
   rm -f conftest.er1
   cat conftest.err >&5
   echo "$as_me:$LINENO: \$? = $ac_status" >&5
-  (exit $ac_status); } &&
-	 { ac_try='test -z "$ac_c_werror_flag"			 || test ! -s conftest.err'
-  { (eval echo "$as_me:$LINENO: \"$ac_try\"") >&5
-  (eval $ac_try) 2>&5
-  ac_status=$?
-  echo "$as_me:$LINENO: \$? = $ac_status" >&5
-  (exit $ac_status); }; } &&
-	 { ac_try='test -s conftest$ac_exeext'
-  { (eval echo "$as_me:$LINENO: \"$ac_try\"") >&5
-  (eval $ac_try) 2>&5
-  ac_status=$?
-  echo "$as_me:$LINENO: \$? = $ac_status" >&5
-  (exit $ac_status); }; }; then
+  (exit $ac_status); } && {
+	 test -z "$ac_c_werror_flag" ||
+	 test ! -s conftest.err
+       } && test -s conftest$ac_exeext &&
+       $as_test_x conftest$ac_exeext; then
   ac_cv_lib_intl_strftime=yes
 else
   echo "$as_me: failed program was:" >&5
 sed 's/^/| /' conftest.$ac_ext >&5
 
-ac_cv_lib_intl_strftime=no
+	ac_cv_lib_intl_strftime=no
 fi
-rm -f conftest.err conftest.$ac_objext \
+
+rm -f core conftest.err conftest.$ac_objext conftest_ipa8_conftest.oo \
       conftest$ac_exeext conftest.$ac_ext
 LIBS=$ac_check_lib_save_LIBS
 fi
-echo "$as_me:$LINENO: result: $ac_cv_lib_intl_strftime" >&5
-echo "${ECHO_T}$ac_cv_lib_intl_strftime" >&6
+{ echo "$as_me:$LINENO: result: $ac_cv_lib_intl_strftime" >&5
+echo "${ECHO_T}$ac_cv_lib_intl_strftime" >&6; }
 if test $ac_cv_lib_intl_strftime = yes; then
   cat >>confdefs.h <<\_ACEOF
 #define HAVE_STRFTIME 1
@@ -9983,8 +14537,8 @@
 fi
 done
 
-echo "$as_me:$LINENO: checking for working strtod" >&5
-echo $ECHO_N "checking for working strtod... $ECHO_C" >&6
+{ echo "$as_me:$LINENO: checking for working strtod" >&5
+echo $ECHO_N "checking for working strtod... $ECHO_C" >&6; }
 if test "${ac_cv_func_strtod+set}" = set; then
   echo $ECHO_N "(cached) $ECHO_C" >&6
 else
@@ -9998,7 +14552,10 @@
 cat >>conftest.$ac_ext <<_ACEOF
 /* end confdefs.h.  */
 
+$ac_includes_default
+#ifndef strtod
 double strtod ();
+#endif
 int
 main()
 {
@@ -10009,7 +14566,7 @@
     double value;
     value = strtod (string, &term);
     if (value != 69 || term != (string + 4))
-      exit (1);
+      return 1;
   }
 
   {
@@ -10019,20 +14576,29 @@
     char *term;
     strtod (string, &term);
     if (term != string && *(term - 1) == 0)
-      exit (1);
+      return 1;
   }
-  exit (0);
+  return 0;
 }
 
 _ACEOF
 rm -f conftest$ac_exeext
-if { (eval echo "$as_me:$LINENO: \"$ac_link\"") >&5
-  (eval $ac_link) 2>&5
+if { (ac_try="$ac_link"
+case "(($ac_try" in
+  *\"* | *\`* | *\\*) ac_try_echo=\$ac_try;;
+  *) ac_try_echo=$ac_try;;
+esac
+eval "echo \"\$as_me:$LINENO: $ac_try_echo\"") >&5
+  (eval "$ac_link") 2>&5
   ac_status=$?
   echo "$as_me:$LINENO: \$? = $ac_status" >&5
   (exit $ac_status); } && { ac_try='./conftest$ac_exeext'
-  { (eval echo "$as_me:$LINENO: \"$ac_try\"") >&5
-  (eval $ac_try) 2>&5
+  { (case "(($ac_try" in
+  *\"* | *\`* | *\\*) ac_try_echo=\$ac_try;;
+  *) ac_try_echo=$ac_try;;
+esac
+eval "echo \"\$as_me:$LINENO: $ac_try_echo\"") >&5
+  (eval "$ac_try") 2>&5
   ac_status=$?
   echo "$as_me:$LINENO: \$? = $ac_status" >&5
   (exit $ac_status); }; }; then
@@ -10045,22 +14611,22 @@
 ( exit $ac_status )
 ac_cv_func_strtod=no
 fi
-rm -f core *.core gmon.out bb.out conftest$ac_exeext conftest.$ac_objext conftest.$ac_ext
+rm -f core *.core core.conftest.* gmon.out bb.out conftest$ac_exeext conftest.$ac_objext conftest.$ac_ext
 fi
+
+
 fi
-echo "$as_me:$LINENO: result: $ac_cv_func_strtod" >&5
-echo "${ECHO_T}$ac_cv_func_strtod" >&6
+{ echo "$as_me:$LINENO: result: $ac_cv_func_strtod" >&5
+echo "${ECHO_T}$ac_cv_func_strtod" >&6; }
 if test $ac_cv_func_strtod = no; then
-  case $LIBOBJS in
-    "strtod.$ac_objext"   | \
-  *" strtod.$ac_objext"   | \
-    "strtod.$ac_objext "* | \
+  case " $LIBOBJS " in
   *" strtod.$ac_objext "* ) ;;
-  *) LIBOBJS="$LIBOBJS strtod.$ac_objext" ;;
+  *) LIBOBJS="$LIBOBJS strtod.$ac_objext"
+ ;;
 esac
 
-echo "$as_me:$LINENO: checking for pow" >&5
-echo $ECHO_N "checking for pow... $ECHO_C" >&6
+{ echo "$as_me:$LINENO: checking for pow" >&5
+echo $ECHO_N "checking for pow... $ECHO_C" >&6; }
 if test "${ac_cv_func_pow+set}" = set; then
   echo $ECHO_N "(cached) $ECHO_C" >&6
 else
@@ -10087,71 +14653,63 @@
 
 #undef pow
 
-/* Override any gcc2 internal prototype to avoid an error.  */
+/* Override any GCC internal prototype to avoid an error.
+   Use char because int might match the return type of a GCC
+   builtin and then its argument prototype would still apply.  */
 #ifdef __cplusplus
 extern "C"
-{
 #endif
-/* We use char because int might match the return type of a gcc2
-   builtin and then its argument prototype would still apply.  */
 char pow ();
 /* The GNU C library defines this for functions which it implements
     to always fail with ENOSYS.  Some functions are actually named
     something starting with __ and the normal name is an alias.  */
-#if defined (__stub_pow) || defined (__stub___pow)
+#if defined __stub_pow || defined __stub___pow
 choke me
-#else
-char (*f) () = pow;
-#endif
-#ifdef __cplusplus
-}
 #endif
 
 int
 main ()
 {
-return f != pow;
+return pow ();
   ;
   return 0;
 }
 _ACEOF
 rm -f conftest.$ac_objext conftest$ac_exeext
-if { (eval echo "$as_me:$LINENO: \"$ac_link\"") >&5
-  (eval $ac_link) 2>conftest.er1
+if { (ac_try="$ac_link"
+case "(($ac_try" in
+  *\"* | *\`* | *\\*) ac_try_echo=\$ac_try;;
+  *) ac_try_echo=$ac_try;;
+esac
+eval "echo \"\$as_me:$LINENO: $ac_try_echo\"") >&5
+  (eval "$ac_link") 2>conftest.er1
   ac_status=$?
   grep -v '^ *+' conftest.er1 >conftest.err
   rm -f conftest.er1
   cat conftest.err >&5
   echo "$as_me:$LINENO: \$? = $ac_status" >&5
-  (exit $ac_status); } &&
-	 { ac_try='test -z "$ac_c_werror_flag"			 || test ! -s conftest.err'
-  { (eval echo "$as_me:$LINENO: \"$ac_try\"") >&5
-  (eval $ac_try) 2>&5
-  ac_status=$?
-  echo "$as_me:$LINENO: \$? = $ac_status" >&5
-  (exit $ac_status); }; } &&
-	 { ac_try='test -s conftest$ac_exeext'
-  { (eval echo "$as_me:$LINENO: \"$ac_try\"") >&5
-  (eval $ac_try) 2>&5
-  ac_status=$?
-  echo "$as_me:$LINENO: \$? = $ac_status" >&5
-  (exit $ac_status); }; }; then
+  (exit $ac_status); } && {
+	 test -z "$ac_c_werror_flag" ||
+	 test ! -s conftest.err
+       } && test -s conftest$ac_exeext &&
+       $as_test_x conftest$ac_exeext; then
   ac_cv_func_pow=yes
 else
   echo "$as_me: failed program was:" >&5
 sed 's/^/| /' conftest.$ac_ext >&5
 
-ac_cv_func_pow=no
+	ac_cv_func_pow=no
 fi
-rm -f conftest.err conftest.$ac_objext \
+
+rm -f core conftest.err conftest.$ac_objext conftest_ipa8_conftest.oo \
       conftest$ac_exeext conftest.$ac_ext
 fi
-echo "$as_me:$LINENO: result: $ac_cv_func_pow" >&5
-echo "${ECHO_T}$ac_cv_func_pow" >&6
+{ echo "$as_me:$LINENO: result: $ac_cv_func_pow" >&5
+echo "${ECHO_T}$ac_cv_func_pow" >&6; }
 
 if test $ac_cv_func_pow = no; then
-  echo "$as_me:$LINENO: checking for pow in -lm" >&5
-echo $ECHO_N "checking for pow in -lm... $ECHO_C" >&6
+  { echo "$as_me:$LINENO: checking for pow in -lm" >&5
+echo $ECHO_N "checking for pow in -lm... $ECHO_C" >&6; }
 if test "${ac_cv_lib_m_pow+set}" = set; then
   echo $ECHO_N "(cached) $ECHO_C" >&6
 else
@@ -10164,55 +14722,53 @@
 cat >>conftest.$ac_ext <<_ACEOF
 /* end confdefs.h.  */
 
-/* Override any gcc2 internal prototype to avoid an error.  */
+/* Override any GCC internal prototype to avoid an error.
+   Use char because int might match the return type of a GCC
+   builtin and then its argument prototype would still apply.  */
 #ifdef __cplusplus
 extern "C"
 #endif
-/* We use char because int might match the return type of a gcc2
-   builtin and then its argument prototype would still apply.  */
 char pow ();
 int
 main ()
 {
-pow ();
+return pow ();
   ;
   return 0;
 }
 _ACEOF
 rm -f conftest.$ac_objext conftest$ac_exeext
-if { (eval echo "$as_me:$LINENO: \"$ac_link\"") >&5
-  (eval $ac_link) 2>conftest.er1
+if { (ac_try="$ac_link"
+case "(($ac_try" in
+  *\"* | *\`* | *\\*) ac_try_echo=\$ac_try;;
+  *) ac_try_echo=$ac_try;;
+esac
+eval "echo \"\$as_me:$LINENO: $ac_try_echo\"") >&5
+  (eval "$ac_link") 2>conftest.er1
   ac_status=$?
   grep -v '^ *+' conftest.er1 >conftest.err
   rm -f conftest.er1
   cat conftest.err >&5
   echo "$as_me:$LINENO: \$? = $ac_status" >&5
-  (exit $ac_status); } &&
-	 { ac_try='test -z "$ac_c_werror_flag"			 || test ! -s conftest.err'
-  { (eval echo "$as_me:$LINENO: \"$ac_try\"") >&5
-  (eval $ac_try) 2>&5
-  ac_status=$?
-  echo "$as_me:$LINENO: \$? = $ac_status" >&5
-  (exit $ac_status); }; } &&
-	 { ac_try='test -s conftest$ac_exeext'
-  { (eval echo "$as_me:$LINENO: \"$ac_try\"") >&5
-  (eval $ac_try) 2>&5
-  ac_status=$?
-  echo "$as_me:$LINENO: \$? = $ac_status" >&5
-  (exit $ac_status); }; }; then
+  (exit $ac_status); } && {
+	 test -z "$ac_c_werror_flag" ||
+	 test ! -s conftest.err
+       } && test -s conftest$ac_exeext &&
+       $as_test_x conftest$ac_exeext; then
   ac_cv_lib_m_pow=yes
 else
   echo "$as_me: failed program was:" >&5
 sed 's/^/| /' conftest.$ac_ext >&5
 
-ac_cv_lib_m_pow=no
+	ac_cv_lib_m_pow=no
 fi
-rm -f conftest.err conftest.$ac_objext \
+
+rm -f core conftest.err conftest.$ac_objext conftest_ipa8_conftest.oo \
       conftest$ac_exeext conftest.$ac_ext
 LIBS=$ac_check_lib_save_LIBS
 fi
-echo "$as_me:$LINENO: result: $ac_cv_lib_m_pow" >&5
-echo "${ECHO_T}$ac_cv_lib_m_pow" >&6
+{ echo "$as_me:$LINENO: result: $ac_cv_lib_m_pow" >&5
+echo "${ECHO_T}$ac_cv_lib_m_pow" >&6; }
 if test $ac_cv_lib_m_pow = yes; then
   POW_LIB=-lm
 else
@@ -10245,12 +14801,16 @@
 
 
 
-for ac_func in dup2 floor gethostbyname gettimeofday memset pow putenv regcomp socket sqrt strcasecmp strchr strdup strerror strncasecmp strndup strpbrk strrchr strstr strtol uname
+
+
+
+
+for ac_func in dup2 floor gethostbyname gettimeofday memmove memset pow putenv regcomp select socket sqrt strcasecmp strchr strcspn strdup strerror strncasecmp strndup strpbrk strrchr strstr strtol strtoul uname
 do
 as_ac_var=`echo "ac_cv_func_$ac_func" | $as_tr_sh`
-echo "$as_me:$LINENO: checking for $ac_func" >&5
-echo $ECHO_N "checking for $ac_func... $ECHO_C" >&6
-if eval "test \"\${$as_ac_var+set}\" = set"; then
+{ echo "$as_me:$LINENO: checking for $ac_func" >&5
+echo $ECHO_N "checking for $ac_func... $ECHO_C" >&6; }
+if { as_var=$as_ac_var; eval "test \"\${$as_var+set}\" = set"; }; then
   echo $ECHO_N "(cached) $ECHO_C" >&6
 else
   cat >conftest.$ac_ext <<_ACEOF
@@ -10276,67 +14836,60 @@
 
 #undef $ac_func
 
-/* Override any gcc2 internal prototype to avoid an error.  */
+/* Override any GCC internal prototype to avoid an error.
+   Use char because int might match the return type of a GCC
+   builtin and then its argument prototype would still apply.  */
 #ifdef __cplusplus
 extern "C"
-{
 #endif
-/* We use char because int might match the return type of a gcc2
-   builtin and then its argument prototype would still apply.  */
 char $ac_func ();
 /* The GNU C library defines this for functions which it implements
     to always fail with ENOSYS.  Some functions are actually named
     something starting with __ and the normal name is an alias.  */
-#if defined (__stub_$ac_func) || defined (__stub___$ac_func)
+#if defined __stub_$ac_func || defined __stub___$ac_func
 choke me
-#else
-char (*f) () = $ac_func;
-#endif
-#ifdef __cplusplus
-}
 #endif
 
 int
 main ()
 {
-return f != $ac_func;
+return $ac_func ();
   ;
   return 0;
 }
 _ACEOF
 rm -f conftest.$ac_objext conftest$ac_exeext
-if { (eval echo "$as_me:$LINENO: \"$ac_link\"") >&5
-  (eval $ac_link) 2>conftest.er1
+if { (ac_try="$ac_link"
+case "(($ac_try" in
+  *\"* | *\`* | *\\*) ac_try_echo=\$ac_try;;
+  *) ac_try_echo=$ac_try;;
+esac
+eval "echo \"\$as_me:$LINENO: $ac_try_echo\"") >&5
+  (eval "$ac_link") 2>conftest.er1
   ac_status=$?
   grep -v '^ *+' conftest.er1 >conftest.err
   rm -f conftest.er1
   cat conftest.err >&5
   echo "$as_me:$LINENO: \$? = $ac_status" >&5
-  (exit $ac_status); } &&
-	 { ac_try='test -z "$ac_c_werror_flag"			 || test ! -s conftest.err'
-  { (eval echo "$as_me:$LINENO: \"$ac_try\"") >&5
-  (eval $ac_try) 2>&5
-  ac_status=$?
-  echo "$as_me:$LINENO: \$? = $ac_status" >&5
-  (exit $ac_status); }; } &&
-	 { ac_try='test -s conftest$ac_exeext'
-  { (eval echo "$as_me:$LINENO: \"$ac_try\"") >&5
-  (eval $ac_try) 2>&5
-  ac_status=$?
-  echo "$as_me:$LINENO: \$? = $ac_status" >&5
-  (exit $ac_status); }; }; then
+  (exit $ac_status); } && {
+	 test -z "$ac_c_werror_flag" ||
+	 test ! -s conftest.err
+       } && test -s conftest$ac_exeext &&
+       $as_test_x conftest$ac_exeext; then
   eval "$as_ac_var=yes"
 else
   echo "$as_me: failed program was:" >&5
 sed 's/^/| /' conftest.$ac_ext >&5
 
-eval "$as_ac_var=no"
+	eval "$as_ac_var=no"
 fi
-rm -f conftest.err conftest.$ac_objext \
+
+rm -f core conftest.err conftest.$ac_objext conftest_ipa8_conftest.oo \
       conftest$ac_exeext conftest.$ac_ext
 fi
-echo "$as_me:$LINENO: result: `eval echo '${'$as_ac_var'}'`" >&5
-echo "${ECHO_T}`eval echo '${'$as_ac_var'}'`" >&6
+ac_res=`eval echo '${'$as_ac_var'}'`
+	       { echo "$as_me:$LINENO: result: $ac_res" >&5
+echo "${ECHO_T}$ac_res" >&6; }
 if test `eval echo '${'$as_ac_var'}'` = yes; then
   cat >>confdefs.h <<_ACEOF
 #define `echo "HAVE_$ac_func" | $as_tr_cpp` 1
@@ -10346,7 +14899,7 @@
 done
 
 
-          ac_config_files="$ac_config_files Makefile"
+ac_config_files="$ac_config_files Makefile"
 
 cat >confcache <<\_ACEOF
 # This file is a shell script that caches the results of configure
@@ -10366,39 +14919,58 @@
 
 # The following way of writing the cache mishandles newlines in values,
 # but we know of no workaround that is simple, portable, and efficient.
-# So, don't put newlines in cache variables' values.
+# So, we kill variables containing newlines.
 # Ultrix sh set writes to stderr and can't be redirected directly,
 # and sets the high bit in the cache file unless we assign to the vars.
-{
+(
+  for ac_var in `(set) 2>&1 | sed -n 's/^\([a-zA-Z_][a-zA-Z0-9_]*\)=.*/\1/p'`; do
+    eval ac_val=\$$ac_var
+    case $ac_val in #(
+    *${as_nl}*)
+      case $ac_var in #(
+      *_cv_*) { echo "$as_me:$LINENO: WARNING: Cache variable $ac_var contains a newline." >&5
+echo "$as_me: WARNING: Cache variable $ac_var contains a newline." >&2;} ;;
+      esac
+      case $ac_var in #(
+      _ | IFS | as_nl) ;; #(
+      *) $as_unset $ac_var ;;
+      esac ;;
+    esac
+  done
+
   (set) 2>&1 |
-    case `(ac_space=' '; set | grep ac_space) 2>&1` in
-    *ac_space=\ *)
+    case $as_nl`(ac_space=' '; set) 2>&1` in #(
+    *${as_nl}ac_space=\ *)
       # `set' does not quote correctly, so add quotes (double-quote
       # substitution turns \\\\ into \\, and sed turns \\ into \).
       sed -n \
 	"s/'/'\\\\''/g;
 	  s/^\\([_$as_cr_alnum]*_cv_[_$as_cr_alnum]*\\)=\\(.*\\)/\\1='\\2'/p"
-      ;;
+      ;; #(
     *)
       # `set' quotes correctly as required by POSIX, so do not add quotes.
-      sed -n \
-	"s/^\\([_$as_cr_alnum]*_cv_[_$as_cr_alnum]*\\)=\\(.*\\)/\\1=\\2/p"
+      sed -n "/^[_$as_cr_alnum]*_cv_[_$as_cr_alnum]*=/p"
       ;;
-    esac;
-} |
+    esac |
+    sort
+) |
   sed '
+     /^ac_cv_env_/b end
      t clear
-     : clear
+     :clear
      s/^\([^=]*\)=\(.*[{}].*\)$/test "${\1+set}" = set || &/
      t end
-     /^ac_cv_env/!s/^\([^=]*\)=\(.*\)$/\1=${\1=\2}/
-     : end' >>confcache
-if diff $cache_file confcache >/dev/null 2>&1; then :; else
-  if test -w $cache_file; then
-    test "x$cache_file" != "x/dev/null" && echo "updating cache $cache_file"
+     s/^\([^=]*\)=\(.*\)$/\1=${\1=\2}/
+     :end' >>confcache
+if diff "$cache_file" confcache >/dev/null 2>&1; then :; else
+  if test -w "$cache_file"; then
+    test "x$cache_file" != "x/dev/null" &&
+      { echo "$as_me:$LINENO: updating cache $cache_file" >&5
+echo "$as_me: updating cache $cache_file" >&6;}
     cat confcache >$cache_file
   else
-    echo "not updating unwritable cache $cache_file"
+    { echo "$as_me:$LINENO: not updating unwritable cache $cache_file" >&5
+echo "$as_me: not updating unwritable cache $cache_file" >&6;}
   fi
 fi
 rm -f confcache
@@ -10407,38 +14979,38 @@
 # Let make expand exec_prefix.
 test "x$exec_prefix" = xNONE && exec_prefix='${prefix}'
 
-# VPATH may cause trouble with some makes, so we remove $(srcdir),
-# ${srcdir} and @srcdir@ from VPATH if srcdir is ".", strip leading and
-# trailing colons and then remove the whole line if VPATH becomes empty
-# (actually we leave an empty line to preserve line numbers).
-if test "x$srcdir" = x.; then
-  ac_vpsub='/^[	 ]*VPATH[	 ]*=/{
-s/:*\$(srcdir):*/:/;
-s/:*\${srcdir}:*/:/;
-s/:*@srcdir@:*/:/;
-s/^\([^=]*=[	 ]*\):*/\1/;
-s/:*$//;
-s/^[^=]*=[	 ]*$//;
-}'
-fi
-
 DEFS=-DHAVE_CONFIG_H
 
 ac_libobjs=
 ac_ltlibobjs=
 for ac_i in : $LIBOBJS; do test "x$ac_i" = x: && continue
   # 1. Remove the extension, and $U if already installed.
-  ac_i=`echo "$ac_i" |
-	 sed 's/\$U\././;s/\.o$//;s/\.obj$//'`
-  # 2. Add them.
-  ac_libobjs="$ac_libobjs $ac_i\$U.$ac_objext"
-  ac_ltlibobjs="$ac_ltlibobjs $ac_i"'$U.lo'
+  ac_script='s/\$U\././;s/\.o$//;s/\.obj$//'
+  ac_i=`echo "$ac_i" | sed "$ac_script"`
+  # 2. Prepend LIBOBJDIR.  When used with automake>=1.10 LIBOBJDIR
+  #    will be set to the directory where LIBOBJS objects are built.
+  ac_libobjs="$ac_libobjs \${LIBOBJDIR}$ac_i\$U.$ac_objext"
+  ac_ltlibobjs="$ac_ltlibobjs \${LIBOBJDIR}$ac_i"'$U.lo'
 done
 LIBOBJS=$ac_libobjs
 
 LTLIBOBJS=$ac_ltlibobjs
 
 
+if test -z "${AMDEP_TRUE}" && test -z "${AMDEP_FALSE}"; then
+  { { echo "$as_me:$LINENO: error: conditional \"AMDEP\" was never defined.
+Usually this means the macro was only invoked conditionally." >&5
+echo "$as_me: error: conditional \"AMDEP\" was never defined.
+Usually this means the macro was only invoked conditionally." >&2;}
+   { (exit 1); exit 1; }; }
+fi
+if test -z "${am__fastdepCC_TRUE}" && test -z "${am__fastdepCC_FALSE}"; then
+  { { echo "$as_me:$LINENO: error: conditional \"am__fastdepCC\" was never defined.
+Usually this means the macro was only invoked conditionally." >&5
+echo "$as_me: error: conditional \"am__fastdepCC\" was never defined.
+Usually this means the macro was only invoked conditionally." >&2;}
+   { (exit 1); exit 1; }; }
+fi
 
 : ${CONFIG_STATUS=./config.status}
 ac_clean_files_save=$ac_clean_files
@@ -10463,17 +15035,45 @@
 ## M4sh Initialization.  ##
 ## --------------------- ##
 
-# Be Bourne compatible
+# Be more Bourne compatible
+DUALCASE=1; export DUALCASE # for MKS sh
 if test -n "${ZSH_VERSION+set}" && (emulate sh) >/dev/null 2>&1; then
   emulate sh
   NULLCMD=:
   # Zsh 3.x and 4.x performs word splitting on ${1+"$@"}, which
   # is contrary to our usage.  Disable this feature.
   alias -g '${1+"$@"}'='"$@"'
-elif test -n "${BASH_VERSION+set}" && (set -o posix) >/dev/null 2>&1; then
-  set -o posix
+  setopt NO_GLOB_SUBST
+else
+  case `(set -o) 2>/dev/null` in
+  *posix*) set -o posix ;;
+esac
+
+fi
+
+
+
+
+# PATH needs CR
+# Avoid depending upon Character Ranges.
+as_cr_letters='abcdefghijklmnopqrstuvwxyz'
+as_cr_LETTERS='ABCDEFGHIJKLMNOPQRSTUVWXYZ'
+as_cr_Letters=$as_cr_letters$as_cr_LETTERS
+as_cr_digits='0123456789'
+as_cr_alnum=$as_cr_Letters$as_cr_digits
+
+# The user is always right.
+if test "${PATH_SEPARATOR+set}" != set; then
+  echo "#! /bin/sh" >conf$$.sh
+  echo  "exit 0"   >>conf$$.sh
+  chmod +x conf$$.sh
+  if (PATH="/nonexistent;."; conf$$.sh) >/dev/null 2>&1; then
+    PATH_SEPARATOR=';'
+  else
+    PATH_SEPARATOR=:
+  fi
+  rm -f conf$$.sh
 fi
-DUALCASE=1; export DUALCASE # for MKS sh
 
 # Support unset when possible.
 if ( (MAIL=60; unset MAIL) || exit) >/dev/null 2>&1; then
@@ -10483,8 +15083,43 @@
 fi
 
 
+# IFS
+# We need space, tab and new line, in precisely that order.  Quoting is
+# there to prevent editors from complaining about space-tab.
+# (If _AS_PATH_WALK were called with IFS unset, it would disable word
+# splitting by setting IFS to empty value.)
+as_nl='
+'
+IFS=" ""	$as_nl"
+
+# Find who we are.  Look in the path if we contain no directory separator.
+case $0 in
+  *[\\/]* ) as_myself=$0 ;;
+  *) as_save_IFS=$IFS; IFS=$PATH_SEPARATOR
+for as_dir in $PATH
+do
+  IFS=$as_save_IFS
+  test -z "$as_dir" && as_dir=.
+  test -r "$as_dir/$0" && as_myself=$as_dir/$0 && break
+done
+IFS=$as_save_IFS
+
+     ;;
+esac
+# We did not find ourselves, most probably we were run as `sh COMMAND'
+# in which case we are not to be found in the path.
+if test "x$as_myself" = x; then
+  as_myself=$0
+fi
+if test ! -f "$as_myself"; then
+  echo "$as_myself: error: cannot find myself; rerun with an absolute file name" >&2
+  { (exit 1); exit 1; }
+fi
+
 # Work around bugs in pre-3.0 UWIN ksh.
-$as_unset ENV MAIL MAILPATH
+for as_var in ENV MAIL MAILPATH
+do ($as_unset $as_var) >/dev/null 2>&1 && $as_unset $as_var
+done
 PS1='$ '
 PS2='> '
 PS4='+ '
@@ -10498,18 +15133,19 @@
   if (set +x; test -z "`(eval $as_var=C; export $as_var) 2>&1`"); then
     eval $as_var=C; export $as_var
   else
-    $as_unset $as_var
+    ($as_unset $as_var) >/dev/null 2>&1 && $as_unset $as_var
   fi
 done
 
 # Required to use basename.
-if expr a : '\(a\)' >/dev/null 2>&1; then
+if expr a : '\(a\)' >/dev/null 2>&1 &&
+   test "X`expr 00001 : '.*\(...\)'`" = X001; then
   as_expr=expr
 else
   as_expr=false
 fi
 
-if (basename /) >/dev/null 2>&1 && test "X`basename / 2>&1`" = "X/"; then
+if (basename -- /) >/dev/null 2>&1 && test "X`basename -- / 2>&1`" = "X/"; then
   as_basename=basename
 else
   as_basename=false
@@ -10517,159 +15153,120 @@
 
 
 # Name of the executable.
-as_me=`$as_basename "$0" ||
+as_me=`$as_basename -- "$0" ||
 $as_expr X/"$0" : '.*/\([^/][^/]*\)/*$' \| \
 	 X"$0" : 'X\(//\)$' \| \
-	 X"$0" : 'X\(/\)$' \| \
-	 .     : '\(.\)' 2>/dev/null ||
+	 X"$0" : 'X\(/\)' \| . 2>/dev/null ||
 echo X/"$0" |
-    sed '/^.*\/\([^/][^/]*\)\/*$/{ s//\1/; q; }
-  	  /^X\/\(\/\/\)$/{ s//\1/; q; }
-  	  /^X\/\(\/\).*/{ s//\1/; q; }
-  	  s/.*/./; q'`
-
-
-# PATH needs CR, and LINENO needs CR and PATH.
-# Avoid depending upon Character Ranges.
-as_cr_letters='abcdefghijklmnopqrstuvwxyz'
-as_cr_LETTERS='ABCDEFGHIJKLMNOPQRSTUVWXYZ'
-as_cr_Letters=$as_cr_letters$as_cr_LETTERS
-as_cr_digits='0123456789'
-as_cr_alnum=$as_cr_Letters$as_cr_digits
+    sed '/^.*\/\([^/][^/]*\)\/*$/{
+	    s//\1/
+	    q
+	  }
+	  /^X\/\(\/\/\)$/{
+	    s//\1/
+	    q
+	  }
+	  /^X\/\(\/\).*/{
+	    s//\1/
+	    q
+	  }
+	  s/.*/./; q'`
 
-# The user is always right.
-if test "${PATH_SEPARATOR+set}" != set; then
-  echo "#! /bin/sh" >conf$$.sh
-  echo  "exit 0"   >>conf$$.sh
-  chmod +x conf$$.sh
-  if (PATH="/nonexistent;."; conf$$.sh) >/dev/null 2>&1; then
-    PATH_SEPARATOR=';'
-  else
-    PATH_SEPARATOR=:
-  fi
-  rm -f conf$$.sh
-fi
+# CDPATH.
+$as_unset CDPATH
 
 
-  as_lineno_1=$LINENO
-  as_lineno_2=$LINENO
-  as_lineno_3=`(expr $as_lineno_1 + 1) 2>/dev/null`
-  test "x$as_lineno_1" != "x$as_lineno_2" &&
-  test "x$as_lineno_3"  = "x$as_lineno_2"  || {
-  # Find who we are.  Look in the path if we contain no path at all
-  # relative or not.
-  case $0 in
-    *[\\/]* ) as_myself=$0 ;;
-    *) as_save_IFS=$IFS; IFS=$PATH_SEPARATOR
-for as_dir in $PATH
-do
-  IFS=$as_save_IFS
-  test -z "$as_dir" && as_dir=.
-  test -r "$as_dir/$0" && as_myself=$as_dir/$0 && break
-done
 
-       ;;
-  esac
-  # We did not find ourselves, most probably we were run as `sh COMMAND'
-  # in which case we are not to be found in the path.
-  if test "x$as_myself" = x; then
-    as_myself=$0
-  fi
-  if test ! -f "$as_myself"; then
-    { { echo "$as_me:$LINENO: error: cannot find myself; rerun with an absolute path" >&5
-echo "$as_me: error: cannot find myself; rerun with an absolute path" >&2;}
-   { (exit 1); exit 1; }; }
-  fi
-  case $CONFIG_SHELL in
-  '')
-    as_save_IFS=$IFS; IFS=$PATH_SEPARATOR
-for as_dir in /bin$PATH_SEPARATOR/usr/bin$PATH_SEPARATOR$PATH
-do
-  IFS=$as_save_IFS
-  test -z "$as_dir" && as_dir=.
-  for as_base in sh bash ksh sh5; do
-	 case $as_dir in
-	 /*)
-	   if ("$as_dir/$as_base" -c '
   as_lineno_1=$LINENO
   as_lineno_2=$LINENO
-  as_lineno_3=`(expr $as_lineno_1 + 1) 2>/dev/null`
   test "x$as_lineno_1" != "x$as_lineno_2" &&
-  test "x$as_lineno_3"  = "x$as_lineno_2" ') 2>/dev/null; then
-	     $as_unset BASH_ENV || test "${BASH_ENV+set}" != set || { BASH_ENV=; export BASH_ENV; }
-	     $as_unset ENV || test "${ENV+set}" != set || { ENV=; export ENV; }
-	     CONFIG_SHELL=$as_dir/$as_base
-	     export CONFIG_SHELL
-	     exec "$CONFIG_SHELL" "$0" ${1+"$@"}
-	   fi;;
-	 esac
-       done
-done
-;;
-  esac
+  test "x`expr $as_lineno_1 + 1`" = "x$as_lineno_2" || {
 
   # Create $as_me.lineno as a copy of $as_myself, but with $LINENO
   # uniformly replaced by the line number.  The first 'sed' inserts a
-  # line-number line before each line; the second 'sed' does the real
-  # work.  The second script uses 'N' to pair each line-number line
-  # with the numbered line, and appends trailing '-' during
-  # substitution so that $LINENO is not a special case at line end.
+  # line-number line after each line using $LINENO; the second 'sed'
+  # does the real work.  The second script uses 'N' to pair each
+  # line-number line with the line containing $LINENO, and appends
+  # trailing '-' during substitution so that $LINENO is not a special
+  # case at line end.
   # (Raja R Harinath suggested sed '=', and Paul Eggert wrote the
-  # second 'sed' script.  Blame Lee E. McMahon for sed's syntax.  :-)
-  sed '=' <$as_myself |
+  # scripts with optimization help from Paolo Bonzini.  Blame Lee
+  # E. McMahon (1931-1989) for sed's syntax.  :-)
+  sed -n '
+    p
+    /[$]LINENO/=
+  ' <$as_myself |
     sed '
+      s/[$]LINENO.*/&-/
+      t lineno
+      b
+      :lineno
       N
-      s,$,-,
-      : loop
-      s,^\(['$as_cr_digits']*\)\(.*\)[$]LINENO\([^'$as_cr_alnum'_]\),\1\2\1\3,
+      :loop
+      s/[$]LINENO\([^'$as_cr_alnum'_].*\n\)\(.*\)/\2\1\2/
       t loop
-      s,-$,,
-      s,^['$as_cr_digits']*\n,,
+      s/-\n.*//
     ' >$as_me.lineno &&
-  chmod +x $as_me.lineno ||
-    { { echo "$as_me:$LINENO: error: cannot create $as_me.lineno; rerun with a POSIX shell" >&5
-echo "$as_me: error: cannot create $as_me.lineno; rerun with a POSIX shell" >&2;}
+  chmod +x "$as_me.lineno" ||
+    { echo "$as_me: error: cannot create $as_me.lineno; rerun with a POSIX shell" >&2
    { (exit 1); exit 1; }; }
 
   # Don't try to exec as it changes $[0], causing all sort of problems
   # (the dirname of $[0] is not the place where we might find the
-  # original and so on.  Autoconf is especially sensible to this).
-  . ./$as_me.lineno
+  # original and so on.  Autoconf is especially sensitive to this).
+  . "./$as_me.lineno"
   # Exit status is that of the last command.
   exit
 }
 
 
-case `echo "testing\c"; echo 1,2,3`,`echo -n testing; echo 1,2,3` in
-  *c*,-n*) ECHO_N= ECHO_C='
-' ECHO_T='	' ;;
-  *c*,*  ) ECHO_N=-n ECHO_C= ECHO_T= ;;
-  *)       ECHO_N= ECHO_C='\c' ECHO_T= ;;
+if (as_dir=`dirname -- /` && test "X$as_dir" = X/) >/dev/null 2>&1; then
+  as_dirname=dirname
+else
+  as_dirname=false
+fi
+
+ECHO_C= ECHO_N= ECHO_T=
+case `echo -n x` in
+-n*)
+  case `echo 'x\c'` in
+  *c*) ECHO_T='	';;	# ECHO_T is single tab character.
+  *)   ECHO_C='\c';;
+  esac;;
+*)
+  ECHO_N='-n';;
 esac
 
-if expr a : '\(a\)' >/dev/null 2>&1; then
+if expr a : '\(a\)' >/dev/null 2>&1 &&
+   test "X`expr 00001 : '.*\(...\)'`" = X001; then
   as_expr=expr
 else
   as_expr=false
 fi
 
 rm -f conf$$ conf$$.exe conf$$.file
+if test -d conf$$.dir; then
+  rm -f conf$$.dir/conf$$.file
+else
+  rm -f conf$$.dir
+  mkdir conf$$.dir
+fi
 echo >conf$$.file
 if ln -s conf$$.file conf$$ 2>/dev/null; then
-  # We could just check for DJGPP; but this test a) works b) is more generic
-  # and c) will remain valid once DJGPP supports symlinks (DJGPP 2.04).
-  if test -f conf$$.exe; then
-    # Don't use ln at all; we don't have any links
+  as_ln_s='ln -s'
+  # ... but there are two gotchas:
+  # 1) On MSYS, both `ln -s file dir' and `ln file dir' fail.
+  # 2) DJGPP < 2.04 has no symlinks; `ln -s' creates a wrapper executable.
+  # In both cases, we have to default to `cp -p'.
+  ln -s conf$$.file conf$$.dir 2>/dev/null && test ! -f conf$$.exe ||
     as_ln_s='cp -p'
-  else
-    as_ln_s='ln -s'
-  fi
 elif ln conf$$.file conf$$ 2>/dev/null; then
   as_ln_s=ln
 else
   as_ln_s='cp -p'
 fi
-rm -f conf$$ conf$$.exe conf$$.file
+rm -f conf$$ conf$$.exe conf$$.dir/conf$$.file conf$$.file
+rmdir conf$$.dir 2>/dev/null
 
 if mkdir -p . 2>/dev/null; then
   as_mkdir_p=:
@@ -10678,7 +15275,28 @@
   as_mkdir_p=false
 fi
 
-as_executable_p="test -f"
+if test -x / >/dev/null 2>&1; then
+  as_test_x='test -x'
+else
+  if ls -dL / >/dev/null 2>&1; then
+    as_ls_L_option=L
+  else
+    as_ls_L_option=
+  fi
+  as_test_x='
+    eval sh -c '\''
+      if test -d "$1"; then
+        test -d "$1/.";
+      else
+	case $1 in
+        -*)set "./$1";;
+	esac;
+	case `ls -ld'$as_ls_L_option' "$1" 2>/dev/null` in
+	???[sx]*):;;*)false;;esac;fi
+    '\'' sh
+  '
+fi
+as_executable_p=$as_test_x
 
 # Sed expression to map a string onto a valid CPP name.
 as_tr_cpp="eval sed 'y%*$as_cr_letters%P$as_cr_LETTERS%;s%[^_$as_cr_alnum]%_%g'"
@@ -10687,31 +15305,14 @@
 as_tr_sh="eval sed 'y%*+%pp%;s%[^_$as_cr_alnum]%_%g'"
 
 
-# IFS
-# We need space, tab and new line, in precisely that order.
-as_nl='
-'
-IFS=" 	$as_nl"
-
-# CDPATH.
-$as_unset CDPATH
-
 exec 6>&1
 
-# Open the log real soon, to keep \$[0] and so on meaningful, and to
+# Save the log message, to keep $[0] and so on meaningful, and to
 # report actual input values of CONFIG_FILES etc. instead of their
-# values after options handling.  Logging --version etc. is OK.
-exec 5>>config.log
-{
-  echo
-  sed 'h;s/./-/g;s/^.../## /;s/...$/ ##/;p;x;p;x' <<_ASBOX
-## Running $as_me. ##
-_ASBOX
-} >&5
-cat >&5 <<_CSEOF
-
-This file was extended by LCD4Linux $as_me 0.10.0, which was
-generated by GNU Autoconf 2.59.  Invocation command line was
+# values after options handling.
+ac_log="
+This file was extended by LCD4Linux $as_me 0.11.0-SVN, which was
+generated by GNU Autoconf 2.61.  Invocation command line was
 
   CONFIG_FILES    = $CONFIG_FILES
   CONFIG_HEADERS  = $CONFIG_HEADERS
@@ -10719,30 +15320,20 @@
   CONFIG_COMMANDS = $CONFIG_COMMANDS
   $ $0 $@
 
-_CSEOF
-echo "on `(hostname || uname -n) 2>/dev/null | sed 1q`" >&5
-echo >&5
+on `(hostname || uname -n) 2>/dev/null | sed 1q`
+"
+
 _ACEOF
 
+cat >>$CONFIG_STATUS <<_ACEOF
 # Files that config.status was made for.
-if test -n "$ac_config_files"; then
-  echo "config_files=\"$ac_config_files\"" >>$CONFIG_STATUS
-fi
-
-if test -n "$ac_config_headers"; then
-  echo "config_headers=\"$ac_config_headers\"" >>$CONFIG_STATUS
-fi
+config_files="$ac_config_files"
+config_headers="$ac_config_headers"
+config_commands="$ac_config_commands"
 
-if test -n "$ac_config_links"; then
-  echo "config_links=\"$ac_config_links\"" >>$CONFIG_STATUS
-fi
-
-if test -n "$ac_config_commands"; then
-  echo "config_commands=\"$ac_config_commands\"" >>$CONFIG_STATUS
-fi
+_ACEOF
 
 cat >>$CONFIG_STATUS <<\_ACEOF
-
 ac_cs_usage="\
 \`$as_me' instantiates files from templates according to the
 current configuration.
@@ -10750,7 +15341,7 @@
 Usage: $0 [OPTIONS] [FILE]...
 
   -h, --help       print this help, then exit
-  -V, --version    print version number, then exit
+  -V, --version    print version number and configuration settings, then exit
   -q, --quiet      do not print progress messages
   -d, --debug      don't remove temporary files
       --recheck    update $as_me by reconfiguring in the same conditions
@@ -10769,19 +15360,22 @@
 $config_commands
 
 Report bugs to <bug-autoconf@gnu.org>."
-_ACEOF
 
+_ACEOF
 cat >>$CONFIG_STATUS <<_ACEOF
 ac_cs_version="\\
-LCD4Linux config.status 0.10.0
-configured by $0, generated by GNU Autoconf 2.59,
-  with options \\"`echo "$ac_configure_args" | sed 's/[\\""\`\$]/\\\\&/g'`\\"
+LCD4Linux config.status 0.11.0-SVN
+configured by $0, generated by GNU Autoconf 2.61,
+  with options \\"`echo "$ac_configure_args" | sed 's/^ //; s/[\\""\`\$]/\\\\&/g'`\\"
 
-Copyright (C) 2003 Free Software Foundation, Inc.
+Copyright (C) 2006 Free Software Foundation, Inc.
 This config.status script is free software; the Free Software Foundation
 gives unlimited permission to copy, distribute and modify it."
-srcdir=$srcdir
-INSTALL="$INSTALL"
+
+ac_pwd='$ac_pwd'
+srcdir='$srcdir'
+INSTALL='$INSTALL'
+MKDIR_P='$MKDIR_P'
 _ACEOF
 
 cat >>$CONFIG_STATUS <<\_ACEOF
@@ -10792,39 +15386,24 @@
 do
   case $1 in
   --*=*)
-    ac_option=`expr "x$1" : 'x\([^=]*\)='`
-    ac_optarg=`expr "x$1" : 'x[^=]*=\(.*\)'`
+    ac_option=`expr "X$1" : 'X\([^=]*\)='`
+    ac_optarg=`expr "X$1" : 'X[^=]*=\(.*\)'`
     ac_shift=:
     ;;
-  -*)
+  *)
     ac_option=$1
     ac_optarg=$2
     ac_shift=shift
     ;;
-  *) # This is not an option, so the user has probably given explicit
-     # arguments.
-     ac_option=$1
-     ac_need_defaults=false;;
   esac
 
   case $ac_option in
   # Handling of the options.
-_ACEOF
-cat >>$CONFIG_STATUS <<\_ACEOF
   -recheck | --recheck | --rechec | --reche | --rech | --rec | --re | --r)
     ac_cs_recheck=: ;;
-  --version | --vers* | -V )
-    echo "$ac_cs_version"; exit 0 ;;
-  --he | --h)
-    # Conflict between --help and --header
-    { { echo "$as_me:$LINENO: error: ambiguous option: $1
-Try \`$0 --help' for more information." >&5
-echo "$as_me: error: ambiguous option: $1
-Try \`$0 --help' for more information." >&2;}
-   { (exit 1); exit 1; }; };;
-  --help | --hel | -h )
-    echo "$ac_cs_usage"; exit 0 ;;
-  --debug | --d* | -d )
+  --version | --versio | --versi | --vers | --ver | --ve | --v | -V )
+    echo "$ac_cs_version"; exit ;;
+  --debug | --debu | --deb | --de | --d | -d )
     debug=: ;;
   --file | --fil | --fi | --f )
     $ac_shift
@@ -10834,18 +15413,24 @@
     $ac_shift
     CONFIG_HEADERS="$CONFIG_HEADERS $ac_optarg"
     ac_need_defaults=false;;
+  --he | --h)
+    # Conflict between --help and --header
+    { echo "$as_me: error: ambiguous option: $1
+Try \`$0 --help' for more information." >&2
+   { (exit 1); exit 1; }; };;
+  --help | --hel | -h )
+    echo "$ac_cs_usage"; exit ;;
   -q | -quiet | --quiet | --quie | --qui | --qu | --q \
   | -silent | --silent | --silen | --sile | --sil | --si | --s)
     ac_cs_silent=: ;;
 
   # This is an error.
-  -*) { { echo "$as_me:$LINENO: error: unrecognized option: $1
-Try \`$0 --help' for more information." >&5
-echo "$as_me: error: unrecognized option: $1
-Try \`$0 --help' for more information." >&2;}
+  -*) { echo "$as_me: error: unrecognized option: $1
+Try \`$0 --help' for more information." >&2
    { (exit 1); exit 1; }; } ;;
 
-  *) ac_config_targets="$ac_config_targets $1" ;;
+  *) ac_config_targets="$ac_config_targets $1"
+     ac_need_defaults=false ;;
 
   esac
   shift
@@ -10861,37 +15446,49 @@
 _ACEOF
 cat >>$CONFIG_STATUS <<_ACEOF
 if \$ac_cs_recheck; then
-  echo "running $SHELL $0 " $ac_configure_args \$ac_configure_extra_args " --no-create --no-recursion" >&6
-  exec $SHELL $0 $ac_configure_args \$ac_configure_extra_args --no-create --no-recursion
+  echo "running CONFIG_SHELL=$SHELL $SHELL $0 "$ac_configure_args \$ac_configure_extra_args " --no-create --no-recursion" >&6
+  CONFIG_SHELL=$SHELL
+  export CONFIG_SHELL
+  exec $SHELL "$0"$ac_configure_args \$ac_configure_extra_args --no-create --no-recursion
 fi
 
 _ACEOF
+cat >>$CONFIG_STATUS <<\_ACEOF
+exec 5>>config.log
+{
+  echo
+  sed 'h;s/./-/g;s/^.../## /;s/...$/ ##/;p;x;p;x' <<_ASBOX
+## Running $as_me. ##
+_ASBOX
+  echo "$ac_log"
+} >&5
 
+_ACEOF
 cat >>$CONFIG_STATUS <<_ACEOF
 #
-# INIT-COMMANDS section.
+# INIT-COMMANDS
 #
-
-
+AMDEP_TRUE="$AMDEP_TRUE" ac_aux_dir="$ac_aux_dir"
 
 _ACEOF
 
-
-
 cat >>$CONFIG_STATUS <<\_ACEOF
+
+# Handling of arguments.
 for ac_config_target in $ac_config_targets
 do
-  case "$ac_config_target" in
-  # Handling of arguments.
-  "Makefile" ) CONFIG_FILES="$CONFIG_FILES Makefile" ;;
-  "default-1" ) CONFIG_COMMANDS="$CONFIG_COMMANDS default-1" ;;
-  "config.h" ) CONFIG_HEADERS="$CONFIG_HEADERS config.h" ;;
+  case $ac_config_target in
+    "config.h") CONFIG_HEADERS="$CONFIG_HEADERS config.h" ;;
+    "depfiles") CONFIG_COMMANDS="$CONFIG_COMMANDS depfiles" ;;
+    "Makefile") CONFIG_FILES="$CONFIG_FILES Makefile" ;;
+
   *) { { echo "$as_me:$LINENO: error: invalid argument: $ac_config_target" >&5
 echo "$as_me: error: invalid argument: $ac_config_target" >&2;}
    { (exit 1); exit 1; }; };;
   esac
 done
 
+
 # If the user did not use the arguments to specify the items to instantiate,
 # then the envvar interface is used.  Set only those that are not.
 # We use the long form for the default assignment because of an extremely
@@ -10903,690 +15500,773 @@
 fi
 
 # Have a temporary directory for convenience.  Make it in the build tree
-# simply because there is no reason to put it here, and in addition,
+# simply because there is no reason against having it here, and in addition,
 # creating and moving files from /tmp can sometimes cause problems.
-# Create a temporary directory, and hook for its removal unless debugging.
+# Hook for its removal unless debugging.
+# Note that there is a small window in which the directory will not be cleaned:
+# after its creation but before its name has been assigned to `$tmp'.
 $debug ||
 {
-  trap 'exit_status=$?; rm -rf $tmp && exit $exit_status' 0
+  tmp=
+  trap 'exit_status=$?
+  { test -z "$tmp" || test ! -d "$tmp" || rm -fr "$tmp"; } && exit $exit_status
+' 0
   trap '{ (exit 1); exit 1; }' 1 2 13 15
 }
-
 # Create a (secure) tmp directory for tmp files.
 
 {
-  tmp=`(umask 077 && mktemp -d -q "./confstatXXXXXX") 2>/dev/null` &&
+  tmp=`(umask 077 && mktemp -d "./confXXXXXX") 2>/dev/null` &&
   test -n "$tmp" && test -d "$tmp"
 }  ||
 {
-  tmp=./confstat$$-$RANDOM
-  (umask 077 && mkdir $tmp)
+  tmp=./conf$$-$RANDOM
+  (umask 077 && mkdir "$tmp")
 } ||
 {
    echo "$me: cannot create a temporary directory in ." >&2
    { (exit 1); exit 1; }
 }
 
-_ACEOF
-
-cat >>$CONFIG_STATUS <<_ACEOF
-
 #
-# CONFIG_FILES section.
+# Set up the sed scripts for CONFIG_FILES section.
 #
 
 # No need to generate the scripts if there are no CONFIG_FILES.
 # This happens for instance when ./config.status config.h
-if test -n "\$CONFIG_FILES"; then
-  # Protect against being on the right side of a sed subst in config.status.
-  sed 's/,@/@@/; s/@,/@@/; s/,;t t\$/@;t t/; /@;t t\$/s/[\\\\&,]/\\\\&/g;
-   s/@@/,@/; s/@@/@,/; s/@;t t\$/,;t t/' >\$tmp/subs.sed <<\\CEOF
-s,@SHELL@,$SHELL,;t t
-s,@PATH_SEPARATOR@,$PATH_SEPARATOR,;t t
-s,@PACKAGE_NAME@,$PACKAGE_NAME,;t t
-s,@PACKAGE_TARNAME@,$PACKAGE_TARNAME,;t t
-s,@PACKAGE_VERSION@,$PACKAGE_VERSION,;t t
-s,@PACKAGE_STRING@,$PACKAGE_STRING,;t t
-s,@PACKAGE_BUGREPORT@,$PACKAGE_BUGREPORT,;t t
-s,@exec_prefix@,$exec_prefix,;t t
-s,@prefix@,$prefix,;t t
-s,@program_transform_name@,$program_transform_name,;t t
-s,@bindir@,$bindir,;t t
-s,@sbindir@,$sbindir,;t t
-s,@libexecdir@,$libexecdir,;t t
-s,@datadir@,$datadir,;t t
-s,@sysconfdir@,$sysconfdir,;t t
-s,@sharedstatedir@,$sharedstatedir,;t t
-s,@localstatedir@,$localstatedir,;t t
-s,@libdir@,$libdir,;t t
-s,@includedir@,$includedir,;t t
-s,@oldincludedir@,$oldincludedir,;t t
-s,@infodir@,$infodir,;t t
-s,@mandir@,$mandir,;t t
-s,@build_alias@,$build_alias,;t t
-s,@host_alias@,$host_alias,;t t
-s,@target_alias@,$target_alias,;t t
-s,@DEFS@,$DEFS,;t t
-s,@ECHO_C@,$ECHO_C,;t t
-s,@ECHO_N@,$ECHO_N,;t t
-s,@ECHO_T@,$ECHO_T,;t t
-s,@LIBS@,$LIBS,;t t
-s,@INSTALL_PROGRAM@,$INSTALL_PROGRAM,;t t
-s,@INSTALL_SCRIPT@,$INSTALL_SCRIPT,;t t
-s,@INSTALL_DATA@,$INSTALL_DATA,;t t
-s,@PACKAGE@,$PACKAGE,;t t
-s,@VERSION@,$VERSION,;t t
-s,@ACLOCAL@,$ACLOCAL,;t t
-s,@AUTOCONF@,$AUTOCONF,;t t
-s,@AUTOMAKE@,$AUTOMAKE,;t t
-s,@AUTOHEADER@,$AUTOHEADER,;t t
-s,@MAKEINFO@,$MAKEINFO,;t t
-s,@SET_MAKE@,$SET_MAKE,;t t
-s,@CC@,$CC,;t t
-s,@CFLAGS@,$CFLAGS,;t t
-s,@LDFLAGS@,$LDFLAGS,;t t
-s,@CPPFLAGS@,$CPPFLAGS,;t t
-s,@ac_ct_CC@,$ac_ct_CC,;t t
-s,@EXEEXT@,$EXEEXT,;t t
-s,@OBJEXT@,$OBJEXT,;t t
-s,@CPP@,$CPP,;t t
-s,@LN_S@,$LN_S,;t t
-s,@CURSES_LIBS@,$CURSES_LIBS,;t t
-s,@CURSES_INCLUDEDIR@,$CURSES_INCLUDEDIR,;t t
-s,@EGREP@,$EGREP,;t t
-s,@X_CFLAGS@,$X_CFLAGS,;t t
-s,@X_PRE_LIBS@,$X_PRE_LIBS,;t t
-s,@X_LIBS@,$X_LIBS,;t t
-s,@X_EXTRA_LIBS@,$X_EXTRA_LIBS,;t t
-s,@DRIVERS@,$DRIVERS,;t t
-s,@DRVLIBS@,$DRVLIBS,;t t
-s,@PLUGINS@,$PLUGINS,;t t
-s,@PLUGINLIBS@,$PLUGINLIBS,;t t
-s,@LIBOBJS@,$LIBOBJS,;t t
-s,@POW_LIB@,$POW_LIB,;t t
-s,@LTLIBOBJS@,$LTLIBOBJS,;t t
-CEOF
-
-_ACEOF
-
-  cat >>$CONFIG_STATUS <<\_ACEOF
-  # Split the substitutions into bite-sized pieces for seds with
-  # small command number limits, like on Digital OSF/1 and HP-UX.
-  ac_max_sed_lines=48
-  ac_sed_frag=1 # Number of current file.
-  ac_beg=1 # First line for current file.
-  ac_end=$ac_max_sed_lines # Line after last line for current file.
-  ac_more_lines=:
-  ac_sed_cmds=
-  while $ac_more_lines; do
-    if test $ac_beg -gt 1; then
-      sed "1,${ac_beg}d; ${ac_end}q" $tmp/subs.sed >$tmp/subs.frag
-    else
-      sed "${ac_end}q" $tmp/subs.sed >$tmp/subs.frag
-    fi
-    if test ! -s $tmp/subs.frag; then
-      ac_more_lines=false
-    else
-      # The purpose of the label and of the branching condition is to
-      # speed up the sed processing (if there are no `@' at all, there
-      # is no need to browse any of the substitutions).
-      # These are the two extra sed commands mentioned above.
-      (echo ':t
-  /@[a-zA-Z_][a-zA-Z_0-9]*@/!b' && cat $tmp/subs.frag) >$tmp/subs-$ac_sed_frag.sed
-      if test -z "$ac_sed_cmds"; then
-	ac_sed_cmds="sed -f $tmp/subs-$ac_sed_frag.sed"
-      else
-	ac_sed_cmds="$ac_sed_cmds | sed -f $tmp/subs-$ac_sed_frag.sed"
-      fi
-      ac_sed_frag=`expr $ac_sed_frag + 1`
-      ac_beg=$ac_end
-      ac_end=`expr $ac_end + $ac_max_sed_lines`
-    fi
-  done
-  if test -z "$ac_sed_cmds"; then
-    ac_sed_cmds=cat
+if test -n "$CONFIG_FILES"; then
+
+_ACEOF
+
+
+
+ac_delim='%!_!# '
+for ac_last_try in false false false false false :; do
+  cat >conf$$subs.sed <<_ACEOF
+SHELL!$SHELL$ac_delim
+PATH_SEPARATOR!$PATH_SEPARATOR$ac_delim
+PACKAGE_NAME!$PACKAGE_NAME$ac_delim
+PACKAGE_TARNAME!$PACKAGE_TARNAME$ac_delim
+PACKAGE_VERSION!$PACKAGE_VERSION$ac_delim
+PACKAGE_STRING!$PACKAGE_STRING$ac_delim
+PACKAGE_BUGREPORT!$PACKAGE_BUGREPORT$ac_delim
+exec_prefix!$exec_prefix$ac_delim
+prefix!$prefix$ac_delim
+program_transform_name!$program_transform_name$ac_delim
+bindir!$bindir$ac_delim
+sbindir!$sbindir$ac_delim
+libexecdir!$libexecdir$ac_delim
+datarootdir!$datarootdir$ac_delim
+datadir!$datadir$ac_delim
+sysconfdir!$sysconfdir$ac_delim
+sharedstatedir!$sharedstatedir$ac_delim
+localstatedir!$localstatedir$ac_delim
+includedir!$includedir$ac_delim
+oldincludedir!$oldincludedir$ac_delim
+docdir!$docdir$ac_delim
+infodir!$infodir$ac_delim
+htmldir!$htmldir$ac_delim
+dvidir!$dvidir$ac_delim
+pdfdir!$pdfdir$ac_delim
+psdir!$psdir$ac_delim
+libdir!$libdir$ac_delim
+localedir!$localedir$ac_delim
+mandir!$mandir$ac_delim
+DEFS!$DEFS$ac_delim
+ECHO_C!$ECHO_C$ac_delim
+ECHO_N!$ECHO_N$ac_delim
+ECHO_T!$ECHO_T$ac_delim
+LIBS!$LIBS$ac_delim
+build_alias!$build_alias$ac_delim
+host_alias!$host_alias$ac_delim
+target_alias!$target_alias$ac_delim
+INSTALL_PROGRAM!$INSTALL_PROGRAM$ac_delim
+INSTALL_SCRIPT!$INSTALL_SCRIPT$ac_delim
+INSTALL_DATA!$INSTALL_DATA$ac_delim
+am__isrc!$am__isrc$ac_delim
+CYGPATH_W!$CYGPATH_W$ac_delim
+PACKAGE!$PACKAGE$ac_delim
+VERSION!$VERSION$ac_delim
+ACLOCAL!$ACLOCAL$ac_delim
+AUTOCONF!$AUTOCONF$ac_delim
+AUTOMAKE!$AUTOMAKE$ac_delim
+AUTOHEADER!$AUTOHEADER$ac_delim
+MAKEINFO!$MAKEINFO$ac_delim
+install_sh!$install_sh$ac_delim
+STRIP!$STRIP$ac_delim
+INSTALL_STRIP_PROGRAM!$INSTALL_STRIP_PROGRAM$ac_delim
+mkdir_p!$mkdir_p$ac_delim
+AWK!$AWK$ac_delim
+SET_MAKE!$SET_MAKE$ac_delim
+am__leading_dot!$am__leading_dot$ac_delim
+AMTAR!$AMTAR$ac_delim
+am__tar!$am__tar$ac_delim
+am__untar!$am__untar$ac_delim
+CC!$CC$ac_delim
+CFLAGS!$CFLAGS$ac_delim
+LDFLAGS!$LDFLAGS$ac_delim
+CPPFLAGS!$CPPFLAGS$ac_delim
+ac_ct_CC!$ac_ct_CC$ac_delim
+EXEEXT!$EXEEXT$ac_delim
+OBJEXT!$OBJEXT$ac_delim
+DEPDIR!$DEPDIR$ac_delim
+am__include!$am__include$ac_delim
+am__quote!$am__quote$ac_delim
+AMDEP_TRUE!$AMDEP_TRUE$ac_delim
+AMDEP_FALSE!$AMDEP_FALSE$ac_delim
+AMDEPBACKSLASH!$AMDEPBACKSLASH$ac_delim
+CCDEPMODE!$CCDEPMODE$ac_delim
+am__fastdepCC_TRUE!$am__fastdepCC_TRUE$ac_delim
+am__fastdepCC_FALSE!$am__fastdepCC_FALSE$ac_delim
+CPP!$CPP$ac_delim
+LN_S!$LN_S$ac_delim
+CURSES_LIBS!$CURSES_LIBS$ac_delim
+CURSES_INCLUDEDIR!$CURSES_INCLUDEDIR$ac_delim
+GREP!$GREP$ac_delim
+EGREP!$EGREP$ac_delim
+XMKMF!$XMKMF$ac_delim
+X_CFLAGS!$X_CFLAGS$ac_delim
+X_PRE_LIBS!$X_PRE_LIBS$ac_delim
+X_LIBS!$X_LIBS$ac_delim
+X_EXTRA_LIBS!$X_EXTRA_LIBS$ac_delim
+PYTHON_VERSION!$PYTHON_VERSION$ac_delim
+PYTHON!$PYTHON$ac_delim
+PYTHON_CPPFLAGS!$PYTHON_CPPFLAGS$ac_delim
+PYTHON_LDFLAGS!$PYTHON_LDFLAGS$ac_delim
+PYTHON_SITE_PKG!$PYTHON_SITE_PKG$ac_delim
+PYTHON_EXTRA_LIBS!$PYTHON_EXTRA_LIBS$ac_delim
+PYTHON_EXTRA_LDFLAGS!$PYTHON_EXTRA_LDFLAGS$ac_delim
+DRIVERS!$DRIVERS$ac_delim
+DRVLIBS!$DRVLIBS$ac_delim
+build!$build$ac_delim
+build_cpu!$build_cpu$ac_delim
+_ACEOF
+
+  if test `sed -n "s/.*$ac_delim\$/X/p" conf$$subs.sed | grep -c X` = 97; then
+    break
+  elif $ac_last_try; then
+    { { echo "$as_me:$LINENO: error: could not make $CONFIG_STATUS" >&5
+echo "$as_me: error: could not make $CONFIG_STATUS" >&2;}
+   { (exit 1); exit 1; }; }
+  else
+    ac_delim="$ac_delim!$ac_delim _$ac_delim!! "
   fi
-fi # test -n "$CONFIG_FILES"
+done
+
+ac_eof=`sed -n '/^CEOF[0-9]*$/s/CEOF/0/p' conf$$subs.sed`
+if test -n "$ac_eof"; then
+  ac_eof=`echo "$ac_eof" | sort -nru | sed 1q`
+  ac_eof=`expr $ac_eof + 1`
+fi
+
+cat >>$CONFIG_STATUS <<_ACEOF
+cat >"\$tmp/subs-1.sed" <<\CEOF$ac_eof
+/@[a-zA-Z_][a-zA-Z_0-9]*@/!b
+_ACEOF
+sed '
+s/[,\\&]/\\&/g; s/@/@|#_!!_#|/g
+s/^/s,@/; s/!/@,|#_!!_#|/
+:n
+t n
+s/'"$ac_delim"'$/,g/; t
+s/$/\\/; p
+N; s/^.*\n//; s/[,\\&]/\\&/g; s/@/@|#_!!_#|/g; b n
+' >>$CONFIG_STATUS <conf$$subs.sed
+rm -f conf$$subs.sed
+cat >>$CONFIG_STATUS <<_ACEOF
+CEOF$ac_eof
+_ACEOF
+
+
+ac_delim='%!_!# '
+for ac_last_try in false false false false false :; do
+  cat >conf$$subs.sed <<_ACEOF
+build_vendor!$build_vendor$ac_delim
+build_os!$build_os$ac_delim
+host!$host$ac_delim
+host_cpu!$host_cpu$ac_delim
+host_vendor!$host_vendor$ac_delim
+host_os!$host_os$ac_delim
+LIBICONV!$LIBICONV$ac_delim
+LTLIBICONV!$LTLIBICONV$ac_delim
+PLUGINS!$PLUGINS$ac_delim
+PLUGINLIBS!$PLUGINLIBS$ac_delim
+LIBOBJS!$LIBOBJS$ac_delim
+POW_LIB!$POW_LIB$ac_delim
+LTLIBOBJS!$LTLIBOBJS$ac_delim
+_ACEOF
+
+  if test `sed -n "s/.*$ac_delim\$/X/p" conf$$subs.sed | grep -c X` = 13; then
+    break
+  elif $ac_last_try; then
+    { { echo "$as_me:$LINENO: error: could not make $CONFIG_STATUS" >&5
+echo "$as_me: error: could not make $CONFIG_STATUS" >&2;}
+   { (exit 1); exit 1; }; }
+  else
+    ac_delim="$ac_delim!$ac_delim _$ac_delim!! "
+  fi
+done
+
+ac_eof=`sed -n '/^CEOF[0-9]*$/s/CEOF/0/p' conf$$subs.sed`
+if test -n "$ac_eof"; then
+  ac_eof=`echo "$ac_eof" | sort -nru | sed 1q`
+  ac_eof=`expr $ac_eof + 1`
+fi
 
+cat >>$CONFIG_STATUS <<_ACEOF
+cat >"\$tmp/subs-2.sed" <<\CEOF$ac_eof
+/@[a-zA-Z_][a-zA-Z_0-9]*@/!b end
+_ACEOF
+sed '
+s/[,\\&]/\\&/g; s/@/@|#_!!_#|/g
+s/^/s,@/; s/!/@,|#_!!_#|/
+:n
+t n
+s/'"$ac_delim"'$/,g/; t
+s/$/\\/; p
+N; s/^.*\n//; s/[,\\&]/\\&/g; s/@/@|#_!!_#|/g; b n
+' >>$CONFIG_STATUS <conf$$subs.sed
+rm -f conf$$subs.sed
+cat >>$CONFIG_STATUS <<_ACEOF
+:end
+s/|#_!!_#|//g
+CEOF$ac_eof
 _ACEOF
+
+
+# VPATH may cause trouble with some makes, so we remove $(srcdir),
+# ${srcdir} and @srcdir@ from VPATH if srcdir is ".", strip leading and
+# trailing colons and then remove the whole line if VPATH becomes empty
+# (actually we leave an empty line to preserve line numbers).
+if test "x$srcdir" = x.; then
+  ac_vpsub='/^[	 ]*VPATH[	 ]*=/{
+s/:*\$(srcdir):*/:/
+s/:*\${srcdir}:*/:/
+s/:*@srcdir@:*/:/
+s/^\([^=]*=[	 ]*\):*/\1/
+s/:*$//
+s/^[^=]*=[	 ]*$//
+}'
+fi
+
 cat >>$CONFIG_STATUS <<\_ACEOF
-for ac_file in : $CONFIG_FILES; do test "x$ac_file" = x: && continue
-  # Support "outfile[:infile[:infile...]]", defaulting infile="outfile.in".
-  case $ac_file in
-  - | *:- | *:-:* ) # input from stdin
-	cat >$tmp/stdin
-	ac_file_in=`echo "$ac_file" | sed 's,[^:]*:,,'`
-	ac_file=`echo "$ac_file" | sed 's,:.*,,'` ;;
-  *:* ) ac_file_in=`echo "$ac_file" | sed 's,[^:]*:,,'`
-	ac_file=`echo "$ac_file" | sed 's,:.*,,'` ;;
-  * )   ac_file_in=$ac_file.in ;;
+fi # test -n "$CONFIG_FILES"
+
+
+for ac_tag in  :F $CONFIG_FILES  :H $CONFIG_HEADERS    :C $CONFIG_COMMANDS
+do
+  case $ac_tag in
+  :[FHLC]) ac_mode=$ac_tag; continue;;
+  esac
+  case $ac_mode$ac_tag in
+  :[FHL]*:*);;
+  :L* | :C*:*) { { echo "$as_me:$LINENO: error: Invalid tag $ac_tag." >&5
+echo "$as_me: error: Invalid tag $ac_tag." >&2;}
+   { (exit 1); exit 1; }; };;
+  :[FH]-) ac_tag=-:-;;
+  :[FH]*) ac_tag=$ac_tag:$ac_tag.in;;
+  esac
+  ac_save_IFS=$IFS
+  IFS=:
+  set x $ac_tag
+  IFS=$ac_save_IFS
+  shift
+  ac_file=$1
+  shift
+
+  case $ac_mode in
+  :L) ac_source=$1;;
+  :[FH])
+    ac_file_inputs=
+    for ac_f
+    do
+      case $ac_f in
+      -) ac_f="$tmp/stdin";;
+      *) # Look for the file first in the build tree, then in the source tree
+	 # (if the path is not absolute).  The absolute path cannot be DOS-style,
+	 # because $ac_f cannot contain `:'.
+	 test -f "$ac_f" ||
+	   case $ac_f in
+	   [\\/$]*) false;;
+	   *) test -f "$srcdir/$ac_f" && ac_f="$srcdir/$ac_f";;
+	   esac ||
+	   { { echo "$as_me:$LINENO: error: cannot find input file: $ac_f" >&5
+echo "$as_me: error: cannot find input file: $ac_f" >&2;}
+   { (exit 1); exit 1; }; };;
+      esac
+      ac_file_inputs="$ac_file_inputs $ac_f"
+    done
+
+    # Let's still pretend it is `configure' which instantiates (i.e., don't
+    # use $as_me), people would be surprised to read:
+    #    /* config.h.  Generated by config.status.  */
+    configure_input="Generated from "`IFS=:
+	  echo $* | sed 's|^[^:]*/||;s|:[^:]*/|, |g'`" by configure."
+    if test x"$ac_file" != x-; then
+      configure_input="$ac_file.  $configure_input"
+      { echo "$as_me:$LINENO: creating $ac_file" >&5
+echo "$as_me: creating $ac_file" >&6;}
+    fi
+
+    case $ac_tag in
+    *:-:* | *:-) cat >"$tmp/stdin";;
+    esac
+    ;;
   esac
 
-  # Compute @srcdir@, @top_srcdir@, and @INSTALL@ for subdirectories.
-  ac_dir=`(dirname "$ac_file") 2>/dev/null ||
+  ac_dir=`$as_dirname -- "$ac_file" ||
 $as_expr X"$ac_file" : 'X\(.*[^/]\)//*[^/][^/]*/*$' \| \
 	 X"$ac_file" : 'X\(//\)[^/]' \| \
 	 X"$ac_file" : 'X\(//\)$' \| \
-	 X"$ac_file" : 'X\(/\)' \| \
-	 .     : '\(.\)' 2>/dev/null ||
+	 X"$ac_file" : 'X\(/\)' \| . 2>/dev/null ||
 echo X"$ac_file" |
-    sed '/^X\(.*[^/]\)\/\/*[^/][^/]*\/*$/{ s//\1/; q; }
-  	  /^X\(\/\/\)[^/].*/{ s//\1/; q; }
-  	  /^X\(\/\/\)$/{ s//\1/; q; }
-  	  /^X\(\/\).*/{ s//\1/; q; }
-  	  s/.*/./; q'`
-  { if $as_mkdir_p; then
-    mkdir -p "$ac_dir"
-  else
-    as_dir="$ac_dir"
+    sed '/^X\(.*[^/]\)\/\/*[^/][^/]*\/*$/{
+	    s//\1/
+	    q
+	  }
+	  /^X\(\/\/\)[^/].*/{
+	    s//\1/
+	    q
+	  }
+	  /^X\(\/\/\)$/{
+	    s//\1/
+	    q
+	  }
+	  /^X\(\/\).*/{
+	    s//\1/
+	    q
+	  }
+	  s/.*/./; q'`
+  { as_dir="$ac_dir"
+  case $as_dir in #(
+  -*) as_dir=./$as_dir;;
+  esac
+  test -d "$as_dir" || { $as_mkdir_p && mkdir -p "$as_dir"; } || {
     as_dirs=
-    while test ! -d "$as_dir"; do
-      as_dirs="$as_dir $as_dirs"
-      as_dir=`(dirname "$as_dir") 2>/dev/null ||
+    while :; do
+      case $as_dir in #(
+      *\'*) as_qdir=`echo "$as_dir" | sed "s/'/'\\\\\\\\''/g"`;; #(
+      *) as_qdir=$as_dir;;
+      esac
+      as_dirs="'$as_qdir' $as_dirs"
+      as_dir=`$as_dirname -- "$as_dir" ||
 $as_expr X"$as_dir" : 'X\(.*[^/]\)//*[^/][^/]*/*$' \| \
 	 X"$as_dir" : 'X\(//\)[^/]' \| \
 	 X"$as_dir" : 'X\(//\)$' \| \
-	 X"$as_dir" : 'X\(/\)' \| \
-	 .     : '\(.\)' 2>/dev/null ||
+	 X"$as_dir" : 'X\(/\)' \| . 2>/dev/null ||
 echo X"$as_dir" |
-    sed '/^X\(.*[^/]\)\/\/*[^/][^/]*\/*$/{ s//\1/; q; }
-  	  /^X\(\/\/\)[^/].*/{ s//\1/; q; }
-  	  /^X\(\/\/\)$/{ s//\1/; q; }
-  	  /^X\(\/\).*/{ s//\1/; q; }
-  	  s/.*/./; q'`
+    sed '/^X\(.*[^/]\)\/\/*[^/][^/]*\/*$/{
+	    s//\1/
+	    q
+	  }
+	  /^X\(\/\/\)[^/].*/{
+	    s//\1/
+	    q
+	  }
+	  /^X\(\/\/\)$/{
+	    s//\1/
+	    q
+	  }
+	  /^X\(\/\).*/{
+	    s//\1/
+	    q
+	  }
+	  s/.*/./; q'`
+      test -d "$as_dir" && break
     done
-    test ! -n "$as_dirs" || mkdir $as_dirs
-  fi || { { echo "$as_me:$LINENO: error: cannot create directory \"$ac_dir\"" >&5
-echo "$as_me: error: cannot create directory \"$ac_dir\"" >&2;}
+    test -z "$as_dirs" || eval "mkdir $as_dirs"
+  } || test -d "$as_dir" || { { echo "$as_me:$LINENO: error: cannot create directory $as_dir" >&5
+echo "$as_me: error: cannot create directory $as_dir" >&2;}
    { (exit 1); exit 1; }; }; }
-
   ac_builddir=.
 
-if test "$ac_dir" != .; then
+case "$ac_dir" in
+.) ac_dir_suffix= ac_top_builddir_sub=. ac_top_build_prefix= ;;
+*)
   ac_dir_suffix=/`echo "$ac_dir" | sed 's,^\.[\\/],,'`
-  # A "../" for each directory in $ac_dir_suffix.
-  ac_top_builddir=`echo "$ac_dir_suffix" | sed 's,/[^\\/]*,../,g'`
-else
-  ac_dir_suffix= ac_top_builddir=
-fi
+  # A ".." for each directory in $ac_dir_suffix.
+  ac_top_builddir_sub=`echo "$ac_dir_suffix" | sed 's,/[^\\/]*,/..,g;s,/,,'`
+  case $ac_top_builddir_sub in
+  "") ac_top_builddir_sub=. ac_top_build_prefix= ;;
+  *)  ac_top_build_prefix=$ac_top_builddir_sub/ ;;
+  esac ;;
+esac
+ac_abs_top_builddir=$ac_pwd
+ac_abs_builddir=$ac_pwd$ac_dir_suffix
+# for backward compatibility:
+ac_top_builddir=$ac_top_build_prefix
 
 case $srcdir in
-  .)  # No --srcdir option.  We are building in place.
+  .)  # We are building in place.
     ac_srcdir=.
-    if test -z "$ac_top_builddir"; then
-       ac_top_srcdir=.
-    else
-       ac_top_srcdir=`echo $ac_top_builddir | sed 's,/$,,'`
-    fi ;;
-  [\\/]* | ?:[\\/]* )  # Absolute path.
+    ac_top_srcdir=$ac_top_builddir_sub
+    ac_abs_top_srcdir=$ac_pwd ;;
+  [\\/]* | ?:[\\/]* )  # Absolute name.
     ac_srcdir=$srcdir$ac_dir_suffix;
-    ac_top_srcdir=$srcdir ;;
-  *) # Relative path.
-    ac_srcdir=$ac_top_builddir$srcdir$ac_dir_suffix
-    ac_top_srcdir=$ac_top_builddir$srcdir ;;
+    ac_top_srcdir=$srcdir
+    ac_abs_top_srcdir=$srcdir ;;
+  *) # Relative name.
+    ac_srcdir=$ac_top_build_prefix$srcdir$ac_dir_suffix
+    ac_top_srcdir=$ac_top_build_prefix$srcdir
+    ac_abs_top_srcdir=$ac_pwd/$srcdir ;;
 esac
+ac_abs_srcdir=$ac_abs_top_srcdir$ac_dir_suffix
 
-# Do not use `cd foo && pwd` to compute absolute paths, because
-# the directories may not exist.
-case `pwd` in
-.) ac_abs_builddir="$ac_dir";;
-*)
-  case "$ac_dir" in
-  .) ac_abs_builddir=`pwd`;;
-  [\\/]* | ?:[\\/]* ) ac_abs_builddir="$ac_dir";;
-  *) ac_abs_builddir=`pwd`/"$ac_dir";;
-  esac;;
-esac
-case $ac_abs_builddir in
-.) ac_abs_top_builddir=${ac_top_builddir}.;;
-*)
-  case ${ac_top_builddir}. in
-  .) ac_abs_top_builddir=$ac_abs_builddir;;
-  [\\/]* | ?:[\\/]* ) ac_abs_top_builddir=${ac_top_builddir}.;;
-  *) ac_abs_top_builddir=$ac_abs_builddir/${ac_top_builddir}.;;
-  esac;;
-esac
-case $ac_abs_builddir in
-.) ac_abs_srcdir=$ac_srcdir;;
-*)
-  case $ac_srcdir in
-  .) ac_abs_srcdir=$ac_abs_builddir;;
-  [\\/]* | ?:[\\/]* ) ac_abs_srcdir=$ac_srcdir;;
-  *) ac_abs_srcdir=$ac_abs_builddir/$ac_srcdir;;
-  esac;;
-esac
-case $ac_abs_builddir in
-.) ac_abs_top_srcdir=$ac_top_srcdir;;
-*)
-  case $ac_top_srcdir in
-  .) ac_abs_top_srcdir=$ac_abs_builddir;;
-  [\\/]* | ?:[\\/]* ) ac_abs_top_srcdir=$ac_top_srcdir;;
-  *) ac_abs_top_srcdir=$ac_abs_builddir/$ac_top_srcdir;;
-  esac;;
-esac
 
+  case $ac_mode in
+  :F)
+  #
+  # CONFIG_FILE
+  #
 
   case $INSTALL in
   [\\/$]* | ?:[\\/]* ) ac_INSTALL=$INSTALL ;;
-  *) ac_INSTALL=$ac_top_builddir$INSTALL ;;
+  *) ac_INSTALL=$ac_top_build_prefix$INSTALL ;;
   esac
+  ac_MKDIR_P=$MKDIR_P
+  case $MKDIR_P in
+  [\\/$]* | ?:[\\/]* ) ;;
+  */*) ac_MKDIR_P=$ac_top_build_prefix$MKDIR_P ;;
+  esac
+_ACEOF
 
-  # Let's still pretend it is `configure' which instantiates (i.e., don't
-  # use $as_me), people would be surprised to read:
-  #    /* config.h.  Generated by config.status.  */
-  if test x"$ac_file" = x-; then
-    configure_input=
-  else
-    configure_input="$ac_file.  "
-  fi
-  configure_input=$configure_input"Generated from `echo $ac_file_in |
-				     sed 's,.*/,,'` by configure."
-
-  # First look for the input files in the build tree, otherwise in the
-  # src tree.
-  ac_file_inputs=`IFS=:
-    for f in $ac_file_in; do
-      case $f in
-      -) echo $tmp/stdin ;;
-      [\\/$]*)
-	 # Absolute (can't be DOS-style, as IFS=:)
-	 test -f "$f" || { { echo "$as_me:$LINENO: error: cannot find input file: $f" >&5
-echo "$as_me: error: cannot find input file: $f" >&2;}
-   { (exit 1); exit 1; }; }
-	 echo "$f";;
-      *) # Relative
-	 if test -f "$f"; then
-	   # Build tree
-	   echo "$f"
-	 elif test -f "$srcdir/$f"; then
-	   # Source tree
-	   echo "$srcdir/$f"
-	 else
-	   # /dev/null tree
-	   { { echo "$as_me:$LINENO: error: cannot find input file: $f" >&5
-echo "$as_me: error: cannot find input file: $f" >&2;}
-   { (exit 1); exit 1; }; }
-	 fi;;
-      esac
-    done` || { (exit 1); exit 1; }
-
-  if test x"$ac_file" != x-; then
-    { echo "$as_me:$LINENO: creating $ac_file" >&5
-echo "$as_me: creating $ac_file" >&6;}
-    rm -f "$ac_file"
-  fi
+cat >>$CONFIG_STATUS <<\_ACEOF
+# If the template does not know about datarootdir, expand it.
+# FIXME: This hack should be removed a few years after 2.60.
+ac_datarootdir_hack=; ac_datarootdir_seen=
+
+case `sed -n '/datarootdir/ {
+  p
+  q
+}
+/@datadir@/p
+/@docdir@/p
+/@infodir@/p
+/@localedir@/p
+/@mandir@/p
+' $ac_file_inputs` in
+*datarootdir*) ac_datarootdir_seen=yes;;
+*@datadir@*|*@docdir@*|*@infodir@*|*@localedir@*|*@mandir@*)
+  { echo "$as_me:$LINENO: WARNING: $ac_file_inputs seems to ignore the --datarootdir setting" >&5
+echo "$as_me: WARNING: $ac_file_inputs seems to ignore the --datarootdir setting" >&2;}
 _ACEOF
 cat >>$CONFIG_STATUS <<_ACEOF
+  ac_datarootdir_hack='
+  s&@datadir@&$datadir&g
+  s&@docdir@&$docdir&g
+  s&@infodir@&$infodir&g
+  s&@localedir@&$localedir&g
+  s&@mandir@&$mandir&g
+    s&\\\${datarootdir}&$datarootdir&g' ;;
+esac
+_ACEOF
+
+# Neutralize VPATH when `$srcdir' = `.'.
+# Shell code in configure.ac might set extrasub.
+# FIXME: do we really want to maintain this feature?
+cat >>$CONFIG_STATUS <<_ACEOF
   sed "$ac_vpsub
 $extrasub
 _ACEOF
 cat >>$CONFIG_STATUS <<\_ACEOF
 :t
 /@[a-zA-Z_][a-zA-Z_0-9]*@/!b
-s,@configure_input@,$configure_input,;t t
-s,@srcdir@,$ac_srcdir,;t t
-s,@abs_srcdir@,$ac_abs_srcdir,;t t
-s,@top_srcdir@,$ac_top_srcdir,;t t
-s,@abs_top_srcdir@,$ac_abs_top_srcdir,;t t
-s,@builddir@,$ac_builddir,;t t
-s,@abs_builddir@,$ac_abs_builddir,;t t
-s,@top_builddir@,$ac_top_builddir,;t t
-s,@abs_top_builddir@,$ac_abs_top_builddir,;t t
-s,@INSTALL@,$ac_INSTALL,;t t
-" $ac_file_inputs | (eval "$ac_sed_cmds") >$tmp/out
-  rm -f $tmp/stdin
-  if test x"$ac_file" != x-; then
-    mv $tmp/out $ac_file
-  else
-    cat $tmp/out
-    rm -f $tmp/out
-  fi
-
-done
-_ACEOF
-cat >>$CONFIG_STATUS <<\_ACEOF
-
-#
-# CONFIG_HEADER section.
-#
-
-# These sed commands are passed to sed as "A NAME B NAME C VALUE D", where
-# NAME is the cpp macro being defined and VALUE is the value it is being given.
-#
-# ac_d sets the value in "#define NAME VALUE" lines.
-ac_dA='s,^\([	 ]*\)#\([	 ]*define[	 ][	 ]*\)'
-ac_dB='[	 ].*$,\1#\2'
-ac_dC=' '
-ac_dD=',;t'
-# ac_u turns "#undef NAME" without trailing blanks into "#define NAME VALUE".
-ac_uA='s,^\([	 ]*\)#\([	 ]*\)undef\([	 ][	 ]*\)'
-ac_uB='$,\1#\2define\3'
-ac_uC=' '
-ac_uD=',;t'
+s&@configure_input@&$configure_input&;t t
+s&@top_builddir@&$ac_top_builddir_sub&;t t
+s&@srcdir@&$ac_srcdir&;t t
+s&@abs_srcdir@&$ac_abs_srcdir&;t t
+s&@top_srcdir@&$ac_top_srcdir&;t t
+s&@abs_top_srcdir@&$ac_abs_top_srcdir&;t t
+s&@builddir@&$ac_builddir&;t t
+s&@abs_builddir@&$ac_abs_builddir&;t t
+s&@abs_top_builddir@&$ac_abs_top_builddir&;t t
+s&@INSTALL@&$ac_INSTALL&;t t
+s&@MKDIR_P@&$ac_MKDIR_P&;t t
+$ac_datarootdir_hack
+" $ac_file_inputs | sed -f "$tmp/subs-1.sed" | sed -f "$tmp/subs-2.sed" >$tmp/out
+
+test -z "$ac_datarootdir_hack$ac_datarootdir_seen" &&
+  { ac_out=`sed -n '/\${datarootdir}/p' "$tmp/out"`; test -n "$ac_out"; } &&
+  { ac_out=`sed -n '/^[	 ]*datarootdir[	 ]*:*=/p' "$tmp/out"`; test -z "$ac_out"; } &&
+  { echo "$as_me:$LINENO: WARNING: $ac_file contains a reference to the variable \`datarootdir'
+which seems to be undefined.  Please make sure it is defined." >&5
+echo "$as_me: WARNING: $ac_file contains a reference to the variable \`datarootdir'
+which seems to be undefined.  Please make sure it is defined." >&2;}
 
-for ac_file in : $CONFIG_HEADERS; do test "x$ac_file" = x: && continue
-  # Support "outfile[:infile[:infile...]]", defaulting infile="outfile.in".
+  rm -f "$tmp/stdin"
   case $ac_file in
-  - | *:- | *:-:* ) # input from stdin
-	cat >$tmp/stdin
-	ac_file_in=`echo "$ac_file" | sed 's,[^:]*:,,'`
-	ac_file=`echo "$ac_file" | sed 's,:.*,,'` ;;
-  *:* ) ac_file_in=`echo "$ac_file" | sed 's,[^:]*:,,'`
-	ac_file=`echo "$ac_file" | sed 's,:.*,,'` ;;
-  * )   ac_file_in=$ac_file.in ;;
+  -) cat "$tmp/out"; rm -f "$tmp/out";;
+  *) rm -f "$ac_file"; mv "$tmp/out" $ac_file;;
   esac
+ ;;
+  :H)
+  #
+  # CONFIG_HEADER
+  #
+_ACEOF
+
+# Transform confdefs.h into a sed script `conftest.defines', that
+# substitutes the proper values into config.h.in to produce config.h.
+rm -f conftest.defines conftest.tail
+# First, append a space to every undef/define line, to ease matching.
+echo 's/$/ /' >conftest.defines
+# Then, protect against being on the right side of a sed subst, or in
+# an unquoted here document, in config.status.  If some macros were
+# called several times there might be several #defines for the same
+# symbol, which is useless.  But do not sort them, since the last
+# AC_DEFINE must be honored.
+ac_word_re=[_$as_cr_Letters][_$as_cr_alnum]*
+# These sed commands are passed to sed as "A NAME B PARAMS C VALUE D", where
+# NAME is the cpp macro being defined, VALUE is the value it is being given.
+# PARAMS is the parameter list in the macro definition--in most cases, it's
+# just an empty string.
+ac_dA='s,^\\([	 #]*\\)[^	 ]*\\([	 ]*'
+ac_dB='\\)[	 (].*,\\1define\\2'
+ac_dC=' '
+ac_dD=' ,'
 
-  test x"$ac_file" != x- && { echo "$as_me:$LINENO: creating $ac_file" >&5
-echo "$as_me: creating $ac_file" >&6;}
-
-  # First look for the input files in the build tree, otherwise in the
-  # src tree.
-  ac_file_inputs=`IFS=:
-    for f in $ac_file_in; do
-      case $f in
-      -) echo $tmp/stdin ;;
-      [\\/$]*)
-	 # Absolute (can't be DOS-style, as IFS=:)
-	 test -f "$f" || { { echo "$as_me:$LINENO: error: cannot find input file: $f" >&5
-echo "$as_me: error: cannot find input file: $f" >&2;}
-   { (exit 1); exit 1; }; }
-	 # Do quote $f, to prevent DOS paths from being IFS'd.
-	 echo "$f";;
-      *) # Relative
-	 if test -f "$f"; then
-	   # Build tree
-	   echo "$f"
-	 elif test -f "$srcdir/$f"; then
-	   # Source tree
-	   echo "$srcdir/$f"
-	 else
-	   # /dev/null tree
-	   { { echo "$as_me:$LINENO: error: cannot find input file: $f" >&5
-echo "$as_me: error: cannot find input file: $f" >&2;}
-   { (exit 1); exit 1; }; }
-	 fi;;
-      esac
-    done` || { (exit 1); exit 1; }
-  # Remove the trailing spaces.
-  sed 's/[	 ]*$//' $ac_file_inputs >$tmp/in
-
-_ACEOF
-
-# Transform confdefs.h into two sed scripts, `conftest.defines' and
-# `conftest.undefs', that substitutes the proper values into
-# config.h.in to produce config.h.  The first handles `#define'
-# templates, and the second `#undef' templates.
-# And first: Protect against being on the right side of a sed subst in
-# config.status.  Protect against being in an unquoted here document
-# in config.status.
-rm -f conftest.defines conftest.undefs
-# Using a here document instead of a string reduces the quoting nightmare.
-# Putting comments in sed scripts is not portable.
-#
-# `end' is used to avoid that the second main sed command (meant for
-# 0-ary CPP macros) applies to n-ary macro definitions.
-# See the Autoconf documentation for `clear'.
-cat >confdef2sed.sed <<\_ACEOF
-s/[\\&,]/\\&/g
-s,[\\$`],\\&,g
-t clear
-: clear
-s,^[	 ]*#[	 ]*define[	 ][	 ]*\([^	 (][^	 (]*\)\(([^)]*)\)[	 ]*\(.*\)$,${ac_dA}\1${ac_dB}\1\2${ac_dC}\3${ac_dD},gp
-t end
-s,^[	 ]*#[	 ]*define[	 ][	 ]*\([^	 ][^	 ]*\)[	 ]*\(.*\)$,${ac_dA}\1${ac_dB}\1${ac_dC}\2${ac_dD},gp
-: end
-_ACEOF
-# If some macros were called several times there might be several times
-# the same #defines, which is useless.  Nevertheless, we may not want to
-# sort them, since we want the *last* AC-DEFINE to be honored.
-uniq confdefs.h | sed -n -f confdef2sed.sed >conftest.defines
-sed 's/ac_d/ac_u/g' conftest.defines >conftest.undefs
-rm -f confdef2sed.sed
+uniq confdefs.h |
+  sed -n '
+	t rset
+	:rset
+	s/^[	 ]*#[	 ]*define[	 ][	 ]*//
+	t ok
+	d
+	:ok
+	s/[\\&,]/\\&/g
+	s/^\('"$ac_word_re"'\)\(([^()]*)\)[	 ]*\(.*\)/ '"$ac_dA"'\1'"$ac_dB"'\2'"${ac_dC}"'\3'"$ac_dD"'/p
+	s/^\('"$ac_word_re"'\)[	 ]*\(.*\)/'"$ac_dA"'\1'"$ac_dB$ac_dC"'\2'"$ac_dD"'/p
+  ' >>conftest.defines
 
-# This sed command replaces #undef with comments.  This is necessary, for
+# Remove the space that was appended to ease matching.
+# Then replace #undef with comments.  This is necessary, for
 # example, in the case of _POSIX_SOURCE, which is predefined and required
 # on some systems where configure will not decide to define it.
-cat >>conftest.undefs <<\_ACEOF
-s,^[	 ]*#[	 ]*undef[	 ][	 ]*[a-zA-Z_][a-zA-Z_0-9]*,/* & */,
+# (The regexp can be short, since the line contains either #define or #undef.)
+echo 's/ $//
+s,^[	 #]*u.*,/* & */,' >>conftest.defines
+
+# Break up conftest.defines:
+ac_max_sed_lines=50
+
+# First sed command is:	 sed -f defines.sed $ac_file_inputs >"$tmp/out1"
+# Second one is:	 sed -f defines.sed "$tmp/out1" >"$tmp/out2"
+# Third one will be:	 sed -f defines.sed "$tmp/out2" >"$tmp/out1"
+# et cetera.
+ac_in='$ac_file_inputs'
+ac_out='"$tmp/out1"'
+ac_nxt='"$tmp/out2"'
+
+while :
+do
+  # Write a here document:
+    cat >>$CONFIG_STATUS <<_ACEOF
+    # First, check the format of the line:
+    cat >"\$tmp/defines.sed" <<\\CEOF
+/^[	 ]*#[	 ]*undef[	 ][	 ]*$ac_word_re[	 ]*\$/b def
+/^[	 ]*#[	 ]*define[	 ][	 ]*$ac_word_re[(	 ]/b def
+b
+:def
 _ACEOF
-
-# Break up conftest.defines because some shells have a limit on the size
-# of here documents, and old seds have small limits too (100 cmds).
-echo '  # Handle all the #define templates only if necessary.' >>$CONFIG_STATUS
-echo '  if grep "^[	 ]*#[	 ]*define" $tmp/in >/dev/null; then' >>$CONFIG_STATUS
-echo '  # If there are no defines, we may have an empty if/fi' >>$CONFIG_STATUS
-echo '  :' >>$CONFIG_STATUS
-rm -f conftest.tail
-while grep . conftest.defines >/dev/null
-do
-  # Write a limited-size here document to $tmp/defines.sed.
-  echo '  cat >$tmp/defines.sed <<CEOF' >>$CONFIG_STATUS
-  # Speed up: don't consider the non `#define' lines.
-  echo '/^[	 ]*#[	 ]*define/!b' >>$CONFIG_STATUS
-  # Work around the forget-to-reset-the-flag bug.
-  echo 't clr' >>$CONFIG_STATUS
-  echo ': clr' >>$CONFIG_STATUS
-  sed ${ac_max_here_lines}q conftest.defines >>$CONFIG_STATUS
+  sed ${ac_max_sed_lines}q conftest.defines >>$CONFIG_STATUS
   echo 'CEOF
-  sed -f $tmp/defines.sed $tmp/in >$tmp/out
-  rm -f $tmp/in
-  mv $tmp/out $tmp/in
-' >>$CONFIG_STATUS
-  sed 1,${ac_max_here_lines}d conftest.defines >conftest.tail
+    sed -f "$tmp/defines.sed"' "$ac_in >$ac_out" >>$CONFIG_STATUS
+  ac_in=$ac_out; ac_out=$ac_nxt; ac_nxt=$ac_in
+  sed 1,${ac_max_sed_lines}d conftest.defines >conftest.tail
+  grep . conftest.tail >/dev/null || break
   rm -f conftest.defines
   mv conftest.tail conftest.defines
 done
-rm -f conftest.defines
-echo '  fi # grep' >>$CONFIG_STATUS
-echo >>$CONFIG_STATUS
-
-# Break up conftest.undefs because some shells have a limit on the size
-# of here documents, and old seds have small limits too (100 cmds).
-echo '  # Handle all the #undef templates' >>$CONFIG_STATUS
-rm -f conftest.tail
-while grep . conftest.undefs >/dev/null
-do
-  # Write a limited-size here document to $tmp/undefs.sed.
-  echo '  cat >$tmp/undefs.sed <<CEOF' >>$CONFIG_STATUS
-  # Speed up: don't consider the non `#undef'
-  echo '/^[	 ]*#[	 ]*undef/!b' >>$CONFIG_STATUS
-  # Work around the forget-to-reset-the-flag bug.
-  echo 't clr' >>$CONFIG_STATUS
-  echo ': clr' >>$CONFIG_STATUS
-  sed ${ac_max_here_lines}q conftest.undefs >>$CONFIG_STATUS
-  echo 'CEOF
-  sed -f $tmp/undefs.sed $tmp/in >$tmp/out
-  rm -f $tmp/in
-  mv $tmp/out $tmp/in
-' >>$CONFIG_STATUS
-  sed 1,${ac_max_here_lines}d conftest.undefs >conftest.tail
-  rm -f conftest.undefs
-  mv conftest.tail conftest.undefs
-done
-rm -f conftest.undefs
+rm -f conftest.defines conftest.tail
 
+echo "ac_result=$ac_in" >>$CONFIG_STATUS
 cat >>$CONFIG_STATUS <<\_ACEOF
-  # Let's still pretend it is `configure' which instantiates (i.e., don't
-  # use $as_me), people would be surprised to read:
-  #    /* config.h.  Generated by config.status.  */
-  if test x"$ac_file" = x-; then
-    echo "/* Generated by configure.  */" >$tmp/config.h
-  else
-    echo "/* $ac_file.  Generated by configure.  */" >$tmp/config.h
-  fi
-  cat $tmp/in >>$tmp/config.h
-  rm -f $tmp/in
   if test x"$ac_file" != x-; then
-    if diff $ac_file $tmp/config.h >/dev/null 2>&1; then
+    echo "/* $configure_input  */" >"$tmp/config.h"
+    cat "$ac_result" >>"$tmp/config.h"
+    if diff $ac_file "$tmp/config.h" >/dev/null 2>&1; then
       { echo "$as_me:$LINENO: $ac_file is unchanged" >&5
 echo "$as_me: $ac_file is unchanged" >&6;}
     else
-      ac_dir=`(dirname "$ac_file") 2>/dev/null ||
-$as_expr X"$ac_file" : 'X\(.*[^/]\)//*[^/][^/]*/*$' \| \
-	 X"$ac_file" : 'X\(//\)[^/]' \| \
-	 X"$ac_file" : 'X\(//\)$' \| \
-	 X"$ac_file" : 'X\(/\)' \| \
-	 .     : '\(.\)' 2>/dev/null ||
-echo X"$ac_file" |
-    sed '/^X\(.*[^/]\)\/\/*[^/][^/]*\/*$/{ s//\1/; q; }
-  	  /^X\(\/\/\)[^/].*/{ s//\1/; q; }
-  	  /^X\(\/\/\)$/{ s//\1/; q; }
-  	  /^X\(\/\).*/{ s//\1/; q; }
-  	  s/.*/./; q'`
-      { if $as_mkdir_p; then
-    mkdir -p "$ac_dir"
-  else
-    as_dir="$ac_dir"
-    as_dirs=
-    while test ! -d "$as_dir"; do
-      as_dirs="$as_dir $as_dirs"
-      as_dir=`(dirname "$as_dir") 2>/dev/null ||
-$as_expr X"$as_dir" : 'X\(.*[^/]\)//*[^/][^/]*/*$' \| \
-	 X"$as_dir" : 'X\(//\)[^/]' \| \
-	 X"$as_dir" : 'X\(//\)$' \| \
-	 X"$as_dir" : 'X\(/\)' \| \
-	 .     : '\(.\)' 2>/dev/null ||
-echo X"$as_dir" |
-    sed '/^X\(.*[^/]\)\/\/*[^/][^/]*\/*$/{ s//\1/; q; }
-  	  /^X\(\/\/\)[^/].*/{ s//\1/; q; }
-  	  /^X\(\/\/\)$/{ s//\1/; q; }
-  	  /^X\(\/\).*/{ s//\1/; q; }
-  	  s/.*/./; q'`
-    done
-    test ! -n "$as_dirs" || mkdir $as_dirs
-  fi || { { echo "$as_me:$LINENO: error: cannot create directory \"$ac_dir\"" >&5
-echo "$as_me: error: cannot create directory \"$ac_dir\"" >&2;}
-   { (exit 1); exit 1; }; }; }
-
       rm -f $ac_file
-      mv $tmp/config.h $ac_file
+      mv "$tmp/config.h" $ac_file
     fi
   else
-    cat $tmp/config.h
-    rm -f $tmp/config.h
+    echo "/* $configure_input  */"
+    cat "$ac_result"
   fi
+  rm -f "$tmp/out12"
+# Compute $ac_file's index in $config_headers.
+_am_arg=$ac_file
+_am_stamp_count=1
+for _am_header in $config_headers :; do
+  case $_am_header in
+    $_am_arg | $_am_arg:* )
+      break ;;
+    * )
+      _am_stamp_count=`expr $_am_stamp_count + 1` ;;
+  esac
 done
-_ACEOF
-cat >>$CONFIG_STATUS <<\_ACEOF
+echo "timestamp for $_am_arg" >`$as_dirname -- "$_am_arg" ||
+$as_expr X"$_am_arg" : 'X\(.*[^/]\)//*[^/][^/]*/*$' \| \
+	 X"$_am_arg" : 'X\(//\)[^/]' \| \
+	 X"$_am_arg" : 'X\(//\)$' \| \
+	 X"$_am_arg" : 'X\(/\)' \| . 2>/dev/null ||
+echo X"$_am_arg" |
+    sed '/^X\(.*[^/]\)\/\/*[^/][^/]*\/*$/{
+	    s//\1/
+	    q
+	  }
+	  /^X\(\/\/\)[^/].*/{
+	    s//\1/
+	    q
+	  }
+	  /^X\(\/\/\)$/{
+	    s//\1/
+	    q
+	  }
+	  /^X\(\/\).*/{
+	    s//\1/
+	    q
+	  }
+	  s/.*/./; q'`/stamp-h$_am_stamp_count
+ ;;
+
+  :C)  { echo "$as_me:$LINENO: executing $ac_file commands" >&5
+echo "$as_me: executing $ac_file commands" >&6;}
+ ;;
+  esac
 
-#
-# CONFIG_COMMANDS section.
-#
-for ac_file in : $CONFIG_COMMANDS; do test "x$ac_file" = x: && continue
-  ac_dest=`echo "$ac_file" | sed 's,:.*,,'`
-  ac_source=`echo "$ac_file" | sed 's,[^:]*:,,'`
-  ac_dir=`(dirname "$ac_dest") 2>/dev/null ||
-$as_expr X"$ac_dest" : 'X\(.*[^/]\)//*[^/][^/]*/*$' \| \
-	 X"$ac_dest" : 'X\(//\)[^/]' \| \
-	 X"$ac_dest" : 'X\(//\)$' \| \
-	 X"$ac_dest" : 'X\(/\)' \| \
-	 .     : '\(.\)' 2>/dev/null ||
-echo X"$ac_dest" |
-    sed '/^X\(.*[^/]\)\/\/*[^/][^/]*\/*$/{ s//\1/; q; }
-  	  /^X\(\/\/\)[^/].*/{ s//\1/; q; }
-  	  /^X\(\/\/\)$/{ s//\1/; q; }
-  	  /^X\(\/\).*/{ s//\1/; q; }
-  	  s/.*/./; q'`
-  { if $as_mkdir_p; then
-    mkdir -p "$ac_dir"
+
+  case $ac_file$ac_mode in
+    "depfiles":C) test x"$AMDEP_TRUE" != x"" || for mf in $CONFIG_FILES; do
+  # Strip MF so we end up with the name of the file.
+  mf=`echo "$mf" | sed -e 's/:.*$//'`
+  # Check whether this is an Automake generated Makefile or not.
+  # We used to match only the files named `Makefile.in', but
+  # some people rename them; so instead we look at the file content.
+  # Grep'ing the first line is not enough: some people post-process
+  # each Makefile.in and add a new line on top of each file to say so.
+  # Grep'ing the whole file is not good either: AIX grep has a line
+  # limit of 2048, but all sed's we know have understand at least 4000.
+  if sed -n 's,^#.*generated by automake.*,X,p' "$mf" | grep X >/dev/null 2>&1; then
+    dirpart=`$as_dirname -- "$mf" ||
+$as_expr X"$mf" : 'X\(.*[^/]\)//*[^/][^/]*/*$' \| \
+	 X"$mf" : 'X\(//\)[^/]' \| \
+	 X"$mf" : 'X\(//\)$' \| \
+	 X"$mf" : 'X\(/\)' \| . 2>/dev/null ||
+echo X"$mf" |
+    sed '/^X\(.*[^/]\)\/\/*[^/][^/]*\/*$/{
+	    s//\1/
+	    q
+	  }
+	  /^X\(\/\/\)[^/].*/{
+	    s//\1/
+	    q
+	  }
+	  /^X\(\/\/\)$/{
+	    s//\1/
+	    q
+	  }
+	  /^X\(\/\).*/{
+	    s//\1/
+	    q
+	  }
+	  s/.*/./; q'`
   else
-    as_dir="$ac_dir"
+    continue
+  fi
+  # Extract the definition of DEPDIR, am__include, and am__quote
+  # from the Makefile without running `make'.
+  DEPDIR=`sed -n 's/^DEPDIR = //p' < "$mf"`
+  test -z "$DEPDIR" && continue
+  am__include=`sed -n 's/^am__include = //p' < "$mf"`
+  test -z "am__include" && continue
+  am__quote=`sed -n 's/^am__quote = //p' < "$mf"`
+  # When using ansi2knr, U may be empty or an underscore; expand it
+  U=`sed -n 's/^U = //p' < "$mf"`
+  # Find all dependency output files, they are included files with
+  # $(DEPDIR) in their names.  We invoke sed twice because it is the
+  # simplest approach to changing $(DEPDIR) to its actual value in the
+  # expansion.
+  for file in `sed -n "
+    s/^$am__include $am__quote\(.*(DEPDIR).*\)$am__quote"'$/\1/p' <"$mf" | \
+       sed -e 's/\$(DEPDIR)/'"$DEPDIR"'/g' -e 's/\$U/'"$U"'/g'`; do
+    # Make sure the directory exists.
+    test -f "$dirpart/$file" && continue
+    fdir=`$as_dirname -- "$file" ||
+$as_expr X"$file" : 'X\(.*[^/]\)//*[^/][^/]*/*$' \| \
+	 X"$file" : 'X\(//\)[^/]' \| \
+	 X"$file" : 'X\(//\)$' \| \
+	 X"$file" : 'X\(/\)' \| . 2>/dev/null ||
+echo X"$file" |
+    sed '/^X\(.*[^/]\)\/\/*[^/][^/]*\/*$/{
+	    s//\1/
+	    q
+	  }
+	  /^X\(\/\/\)[^/].*/{
+	    s//\1/
+	    q
+	  }
+	  /^X\(\/\/\)$/{
+	    s//\1/
+	    q
+	  }
+	  /^X\(\/\).*/{
+	    s//\1/
+	    q
+	  }
+	  s/.*/./; q'`
+    { as_dir=$dirpart/$fdir
+  case $as_dir in #(
+  -*) as_dir=./$as_dir;;
+  esac
+  test -d "$as_dir" || { $as_mkdir_p && mkdir -p "$as_dir"; } || {
     as_dirs=
-    while test ! -d "$as_dir"; do
-      as_dirs="$as_dir $as_dirs"
-      as_dir=`(dirname "$as_dir") 2>/dev/null ||
+    while :; do
+      case $as_dir in #(
+      *\'*) as_qdir=`echo "$as_dir" | sed "s/'/'\\\\\\\\''/g"`;; #(
+      *) as_qdir=$as_dir;;
+      esac
+      as_dirs="'$as_qdir' $as_dirs"
+      as_dir=`$as_dirname -- "$as_dir" ||
 $as_expr X"$as_dir" : 'X\(.*[^/]\)//*[^/][^/]*/*$' \| \
 	 X"$as_dir" : 'X\(//\)[^/]' \| \
 	 X"$as_dir" : 'X\(//\)$' \| \
-	 X"$as_dir" : 'X\(/\)' \| \
-	 .     : '\(.\)' 2>/dev/null ||
+	 X"$as_dir" : 'X\(/\)' \| . 2>/dev/null ||
 echo X"$as_dir" |
-    sed '/^X\(.*[^/]\)\/\/*[^/][^/]*\/*$/{ s//\1/; q; }
-  	  /^X\(\/\/\)[^/].*/{ s//\1/; q; }
-  	  /^X\(\/\/\)$/{ s//\1/; q; }
-  	  /^X\(\/\).*/{ s//\1/; q; }
-  	  s/.*/./; q'`
+    sed '/^X\(.*[^/]\)\/\/*[^/][^/]*\/*$/{
+	    s//\1/
+	    q
+	  }
+	  /^X\(\/\/\)[^/].*/{
+	    s//\1/
+	    q
+	  }
+	  /^X\(\/\/\)$/{
+	    s//\1/
+	    q
+	  }
+	  /^X\(\/\).*/{
+	    s//\1/
+	    q
+	  }
+	  s/.*/./; q'`
+      test -d "$as_dir" && break
     done
-    test ! -n "$as_dirs" || mkdir $as_dirs
-  fi || { { echo "$as_me:$LINENO: error: cannot create directory \"$ac_dir\"" >&5
-echo "$as_me: error: cannot create directory \"$ac_dir\"" >&2;}
+    test -z "$as_dirs" || eval "mkdir $as_dirs"
+  } || test -d "$as_dir" || { { echo "$as_me:$LINENO: error: cannot create directory $as_dir" >&5
+echo "$as_me: error: cannot create directory $as_dir" >&2;}
    { (exit 1); exit 1; }; }; }
+    # echo "creating $dirpart/$file"
+    echo '# dummy' > "$dirpart/$file"
+  done
+done
+ ;;
 
-  ac_builddir=.
-
-if test "$ac_dir" != .; then
-  ac_dir_suffix=/`echo "$ac_dir" | sed 's,^\.[\\/],,'`
-  # A "../" for each directory in $ac_dir_suffix.
-  ac_top_builddir=`echo "$ac_dir_suffix" | sed 's,/[^\\/]*,../,g'`
-else
-  ac_dir_suffix= ac_top_builddir=
-fi
-
-case $srcdir in
-  .)  # No --srcdir option.  We are building in place.
-    ac_srcdir=.
-    if test -z "$ac_top_builddir"; then
-       ac_top_srcdir=.
-    else
-       ac_top_srcdir=`echo $ac_top_builddir | sed 's,/$,,'`
-    fi ;;
-  [\\/]* | ?:[\\/]* )  # Absolute path.
-    ac_srcdir=$srcdir$ac_dir_suffix;
-    ac_top_srcdir=$srcdir ;;
-  *) # Relative path.
-    ac_srcdir=$ac_top_builddir$srcdir$ac_dir_suffix
-    ac_top_srcdir=$ac_top_builddir$srcdir ;;
-esac
-
-# Do not use `cd foo && pwd` to compute absolute paths, because
-# the directories may not exist.
-case `pwd` in
-.) ac_abs_builddir="$ac_dir";;
-*)
-  case "$ac_dir" in
-  .) ac_abs_builddir=`pwd`;;
-  [\\/]* | ?:[\\/]* ) ac_abs_builddir="$ac_dir";;
-  *) ac_abs_builddir=`pwd`/"$ac_dir";;
-  esac;;
-esac
-case $ac_abs_builddir in
-.) ac_abs_top_builddir=${ac_top_builddir}.;;
-*)
-  case ${ac_top_builddir}. in
-  .) ac_abs_top_builddir=$ac_abs_builddir;;
-  [\\/]* | ?:[\\/]* ) ac_abs_top_builddir=${ac_top_builddir}.;;
-  *) ac_abs_top_builddir=$ac_abs_builddir/${ac_top_builddir}.;;
-  esac;;
-esac
-case $ac_abs_builddir in
-.) ac_abs_srcdir=$ac_srcdir;;
-*)
-  case $ac_srcdir in
-  .) ac_abs_srcdir=$ac_abs_builddir;;
-  [\\/]* | ?:[\\/]* ) ac_abs_srcdir=$ac_srcdir;;
-  *) ac_abs_srcdir=$ac_abs_builddir/$ac_srcdir;;
-  esac;;
-esac
-case $ac_abs_builddir in
-.) ac_abs_top_srcdir=$ac_top_srcdir;;
-*)
-  case $ac_top_srcdir in
-  .) ac_abs_top_srcdir=$ac_abs_builddir;;
-  [\\/]* | ?:[\\/]* ) ac_abs_top_srcdir=$ac_top_srcdir;;
-  *) ac_abs_top_srcdir=$ac_abs_builddir/$ac_top_srcdir;;
-  esac;;
-esac
-
-
-  { echo "$as_me:$LINENO: executing $ac_dest commands" >&5
-echo "$as_me: executing $ac_dest commands" >&6;}
-  case $ac_dest in
-    default-1 ) test -z "$CONFIG_HEADERS" || echo timestamp > stamp-h ;;
   esac
-done
-_ACEOF
+done # for ac_tag
 
-cat >>$CONFIG_STATUS <<\_ACEOF
 
 { (exit 0); exit 0; }
 _ACEOF
@@ -11615,3 +16295,20 @@
   $ac_cs_success || { (exit 1); exit 1; }
 fi
 
+
+{ echo "$as_me:$LINENO: result: -----------------------------------------
+including drivers:
+  $DRIVERS
+-----------------------------------------
+including plugins:
+  $PLUGINS
+-----------------------------------------
+" >&5
+echo "${ECHO_T}-----------------------------------------
+including drivers:
+  $DRIVERS
+-----------------------------------------
+including plugins:
+  $PLUGINS
+-----------------------------------------
+" >&6; }
diff -urN lcd4linux-0.10.0/configure.in lcd4linux-0.11.0-SVN/configure.in
--- lcd4linux-0.10.0/configure.in	2005-06-10 13:20:07.000000000 +0200
+++ lcd4linux-0.11.0-SVN/configure.in	2009-01-13 05:54:45.000000000 +0100
@@ -1,10 +1,15 @@
 #                                               -*- Autoconf -*-
 # Process this file with autoconf to produce a configure script.
 
+
+# $Id: configure.in 957 2009-01-13 04:02:35Z michael $
+# $URL: https://ssl.bulix.org/svn/lcd4linux/trunk/configure.in $
+
+
 # LCD4Linux autoconf script
 #
-# Copyright (C) 1999, 2000, 2001, 2002, 2003 Michael Reinelt <reinelt@eunet.at>
-# Copyright (C) 2004 The LCD4Linux Team <lcd4linux-devel@users.sourceforge.net>
+# Copyright (C) 1999, 2000, 2001, 2002, 2003 Michael Reinelt <michael@reinelt.co.at>
+# Copyright (C) 2004, 2005, 2006, 2007 The LCD4Linux Team <lcd4linux-devel@users.sourceforge.net>
 #
 # This file is part of LCD4Linux.
 #
@@ -23,9 +28,9 @@
 # Foundation, Inc., 675 Mass Ave, Cambridge, MA 02139, USA.
 
 AC_PREREQ(2.59)
-AC_INIT([LCD4Linux],[0.10.0],[lcd4linux-users@lists.sourceforge.net])
+AC_INIT([LCD4Linux],[0.11.0-SVN],[lcd4linux-users@lists.sourceforge.net])
 AC_CONFIG_SRCDIR([lcd4linux.c])
-AM_INIT_AUTOMAKE([lcd4linux],0.10.0)
+AM_INIT_AUTOMAKE([lcd4linux],0.11.0-SVN)
 AM_CONFIG_HEADER(config.h)
 
 # Checks for programs.
@@ -46,6 +51,7 @@
 AC_CHECK_CURSES
 
 # Checks for X11
+AC_PATH_X
 AC_PATH_XTRA
 # double-check for X11
 if test "$no_x" != "yes"; then
@@ -59,20 +65,35 @@
 # check for gd.h
 AC_CHECK_HEADERS(gd/gd.h gd.h, [has_gd="true"; break], [has_gd="false"])
 
+# check for sys/io.h (RouterBoard driver)
+AC_CHECK_HEADERS(sys/io.h, [has_io_h="true"], [has_io_h="false"])
+
 # check for usb.h
 AC_CHECK_HEADERS(usb.h, [has_usb="true"], [has_usb="false"])
 
+# check for luise.h
+AC_CHECK_HEADERS(luise.h, [has_luise="true"], [has_luise="false"])
+
 # check for serdisplib
 AC_CHECK_HEADERS(serdisplib/serdisp.h, [has_serdisplib="true"], [has_serdisplib="false"])
 
+# check for st2205 libs
+AC_CHECK_HEADERS(st2205.h, [has_st2205="true"], [has_st2205="false"])
+
+# check for LCD-Linux
+AC_CHECK_HEADERS(linux/lcd-linux.h linux/hd44780.h, [has_lcd_linux="true"], [has_lcd_linux="false"; break])
+
+# check for ftdi.h (ULA200)
+AC_CHECK_HEADERS(ftdi.h, [has_ftdi="true"], [has_ftdi="false"; break])
+
 # check for python
 AC_MSG_CHECKING(if python support is wanted)
 AC_ARG_WITH(python,
 [  --with-python           enable python support [[default=no]]],
 [AC_MSG_RESULT($withval)], [AC_MSG_RESULT(no)])
 if test "$with_python" = "yes"; then
-  sinclude(python.m4)
-  PYTHON__DEVEL
+  sinclude(ac_python_devel.m4)
+  AC_PYTHON_DEVEL
 fi
 
 # drivers
@@ -84,10 +105,9 @@
 # Checks for header files.
 AC_HEADER_DIRENT
 AC_HEADER_STDC
-AC_CHECK_HEADERS([arpa/inet.h fcntl.h netdb.h netinet/in.h stdlib.h string.h sys/ioctl.h sys/socket.h sys/statfs.h sys/vfs.h sys/time.h syslog.h termios.h unistd.h])
-AC_CHECK_HEADERS(sys/io.h asm/io.h)
+AC_CHECK_HEADERS([arpa/inet.h fcntl.h netdb.h netinet/in.h stdlib.h string.h sys/ioctl.h sys/socket.h sys/time.h sys/vfs.h syslog.h termios.h unistd.h])
+AC_CHECK_HEADERS(asm/io.h)
 AC_CHECK_HEADERS(linux/parport.h linux/ppdev.h)
-AC_CHECK_HEADERS(asm/msr.h)
 
 # Checks for typedefs, structures, and compiler characteristics.
 AC_C_CONST
@@ -95,28 +115,42 @@
 AC_TYPE_OFF_T
 AC_TYPE_PID_T
 AC_TYPE_SIZE_T
+AC_TYPE_SSIZE_T
 AC_HEADER_TIME
 AC_TYPE_UID_T
 
+
 # Checks for library functions.
 AC_FUNC_CLOSEDIR_VOID
 AC_FUNC_ERROR_AT_LINE
 AC_FUNC_FORK
-AC_PROG_GCC_TRADITIONAL
 
 # uClibc has no getloadavg()
 # AC_FUNC_GETLOADAVG sounds promising, but does not really work
 #AC_FUNC_GETLOADAVG
 
-#removed for uClibc compatibility
+AC_PROG_GCC_TRADITIONAL
+
+# removed for uClibc compatibility
 #AC_FUNC_MALLOC
 #AC_FUNC_REALLOC
 
+AC_FUNC_SELECT_ARGTYPES
 AC_TYPE_SIGNAL
 AC_FUNC_STAT
 AC_FUNC_STRFTIME
 AC_FUNC_STRTOD
-AC_CHECK_FUNCS([dup2 floor gethostbyname gettimeofday memset pow putenv regcomp socket sqrt strcasecmp strchr strdup strerror strncasecmp strndup strpbrk strrchr strstr strtol uname])
+AC_CHECK_FUNCS([dup2 floor gethostbyname gettimeofday memmove memset pow putenv regcomp select socket sqrt strcasecmp strchr strcspn strdup strerror strncasecmp strndup strpbrk strrchr strstr strtol strtoul uname])
 
 AC_CONFIG_FILES([Makefile])
 AC_OUTPUT
+
+AC_MSG_RESULT(
+[-----------------------------------------]
+[including drivers:]
+[  $DRIVERS]
+[-----------------------------------------]
+[including plugins:]
+[  $PLUGINS]
+[-----------------------------------------]
+)
diff -urN lcd4linux-0.10.0/CREDITS lcd4linux-0.11.0-SVN/CREDITS
--- lcd4linux-0.10.0/CREDITS	2005-01-09 11:48:06.000000000 +0100
+++ lcd4linux-0.11.0-SVN/CREDITS	2008-12-31 08:05:54.000000000 +0100
@@ -1 +1,4 @@
+$Id: CREDITS 730 2007-01-14 13:50:28Z michael $
+$URL: https://ssl.bulix.org/svn/lcd4linux/trunk/CREDITS $
+
 see http://lcd4linux.bulix.org for an up-to-date list of contributors!
diff -urN lcd4linux-0.10.0/curses.m4 lcd4linux-0.11.0-SVN/curses.m4
--- lcd4linux-0.10.0/curses.m4	2005-06-01 14:18:52.000000000 +0200
+++ lcd4linux-0.11.0-SVN/curses.m4	2008-12-31 08:05:54.000000000 +0100
@@ -1,3 +1,7 @@
+dnl $Id: curses.m4 729 2007-01-14 13:44:38Z michael $
+dnl $URL: https://ssl.bulix.org/svn/lcd4linux/trunk/curses.m4 $
+
+
 dnl Curses detection: Munged from Midnight Commander's configure.in
 dnl
 dnl What it does:
diff -urN lcd4linux-0.10.0/debug.c lcd4linux-0.11.0-SVN/debug.c
--- lcd4linux-0.10.0/debug.c	2005-05-08 06:32:43.000000000 +0200
+++ lcd4linux-0.11.0-SVN/debug.c	2008-12-31 08:05:54.000000000 +0100
@@ -1,8 +1,9 @@
-/* $Id: debug.c,v 1.13 2005/05/08 04:32:43 reinelt Exp $
+/* $Id: debug.c 840 2007-09-09 12:17:42Z michael $
+ * $URL: https://ssl.bulix.org/svn/lcd4linux/trunk/debug.c $
  *
  * debug() and error() functions
  *
- * Copyright (C) 1999, 2000 Michael Reinelt <reinelt@eunet.at>
+ * Copyright (C) 1999, 2000 Michael Reinelt <michael@reinelt.co.at>
  * Copyright (C) 2004 The LCD4Linux Team <lcd4linux-devel@users.sourceforge.net>
  *
  * This file is part of LCD4Linux.
@@ -21,56 +22,6 @@
  * along with this program; if not, write to the Free Software
  * Foundation, Inc., 675 Mass Ave, Cambridge, MA 02139, USA.
  *
- *
- * $Log: debug.c,v $
- * Revision 1.13  2005/05/08 04:32:43  reinelt
- * CodingStyle added and applied
- *
- * Revision 1.12  2005/01/18 06:30:22  reinelt
- * added (C) to all copyright statements
- *
- * Revision 1.11  2004/06/26 12:04:59  reinelt
- *
- * uh-oh... the last CVS log message messed up things a lot...
- *
- * Revision 1.10  2004/06/26 09:27:20  reinelt
- *
- * added '-W' to CFLAGS
- * changed all C++ comments to C ones
- * cleaned up a lot of signed/unsigned mistakes
- *
- * Revision 1.9  2004/06/20 10:09:54  reinelt
- *
- * 'const'ified the whole source
- *
- * Revision 1.8  2004/05/26 11:37:36  reinelt
- *
- * Curses driver ported.
- *
- * Revision 1.7  2004/02/10 07:42:35  reinelt
- * cut off all old-style files which are no longer used with NextGeneration
- *
- * Revision 1.6  2003/10/05 17:58:50  reinelt
- * libtool junk; copyright messages cleaned up
- *
- * Revision 1.5  2003/08/24 05:17:58  reinelt
- * liblcd4linux patch from Patrick Schemitz
- *
- * Revision 1.4  2003/08/08 06:58:06  reinelt
- * improved forking
- *
- * Revision 1.3  2001/03/12 12:39:36  reinelt
- *
- * reworked autoconf a lot: drivers may be excluded, #define's went to config.h
- *
- * Revision 1.2  2001/03/09 13:08:11  ltoetsch
- * Added Text driver
- *
- * Revision 1.1  2000/11/28 20:20:38  reinelt
- *
- * added debug.c
- * things like that should not hapen. debug.c exists for a few months now, but was never added to CVS. Shit happens....
- *
  */
 
 /* 
diff -urN lcd4linux-0.10.0/debug.h lcd4linux-0.11.0-SVN/debug.h
--- lcd4linux-0.10.0/debug.h	2005-05-08 06:32:43.000000000 +0200
+++ lcd4linux-0.11.0-SVN/debug.h	2008-12-31 08:05:54.000000000 +0100
@@ -1,8 +1,9 @@
-/* $Id: debug.h,v 1.10 2005/05/08 04:32:43 reinelt Exp $
+/* $Id: debug.h 840 2007-09-09 12:17:42Z michael $
+ * $URL: https://ssl.bulix.org/svn/lcd4linux/trunk/debug.h $
  *
  * debug messages
  *
- * Copyright (C) 1999, 2000 Michael Reinelt <reinelt@eunet.at>
+ * Copyright (C) 1999, 2000 Michael Reinelt <michael@reinelt.co.at>
  * Copyright (C) 2004 The LCD4Linux Team <lcd4linux-devel@users.sourceforge.net>
  *
  * This file is part of LCD4Linux.
@@ -21,49 +22,6 @@
  * along with this program; if not, write to the Free Software
  * Foundation, Inc., 675 Mass Ave, Cambridge, MA 02139, USA.
  *
- *
- * $Log: debug.h,v $
- * Revision 1.10  2005/05/08 04:32:43  reinelt
- * CodingStyle added and applied
- *
- * Revision 1.9  2005/01/18 06:30:22  reinelt
- * added (C) to all copyright statements
- *
- * Revision 1.8  2004/06/20 10:09:54  reinelt
- *
- * 'const'ified the whole source
- *
- * Revision 1.7  2004/04/12 04:55:59  reinelt
- * emitted a BIG FAT WARNING if msr.h could not be found (and therefore
- * the gettimeofday() delay loop would be used)
- *
- * Revision 1.6  2003/10/05 17:58:50  reinelt
- * libtool junk; copyright messages cleaned up
- *
- * Revision 1.5  2003/08/24 05:17:58  reinelt
- * liblcd4linux patch from Patrick Schemitz
- *
- * Revision 1.4  2001/09/12 05:37:22  reinelt
- *
- * fixed a bug in seti.c (file was never closed, lcd4linux run out of fd's
- *
- * improved socket debugging
- *
- * Revision 1.3  2001/03/14 13:19:29  ltoetsch
- * Added pop3/imap4 mail support
- *
- * Revision 1.2  2000/08/10 09:44:09  reinelt
- *
- * new debugging scheme: error(), info(), debug()
- * uses syslog if in daemon mode
- *
- * Revision 1.1  2000/04/15 11:13:54  reinelt
- *
- * added '-d' (debugging) switch
- * added several debugging messages
- * removed config entry 'Delay' for HD44780 driver
- * delay loop for HD44780 will be calibrated automatically
- *
  */
 
 #ifndef _DEBUG_H_
@@ -73,7 +31,7 @@
 extern int running_background;
 extern int verbose_level;
 
-void message(const int level, const char *format, ...);
+void message(const int level, const char *format, ...) __attribute__ ((format(__printf__, 2, 3)));
 
 #define debug(args...) message (2, __FILE__ ": " args)
 #define info(args...)  message (1, args)
diff -urN lcd4linux-0.10.0/depcomp lcd4linux-0.11.0-SVN/depcomp
--- lcd4linux-0.10.0/depcomp	1970-01-01 01:00:00.000000000 +0100
+++ lcd4linux-0.11.0-SVN/depcomp	2008-12-31 08:06:27.000000000 +0100
@@ -0,0 +1,589 @@
+#! /bin/sh
+# depcomp - compile a program generating dependencies as side-effects
+
+scriptversion=2007-03-29.01
+
+# Copyright (C) 1999, 2000, 2003, 2004, 2005, 2006, 2007 Free Software
+# Foundation, Inc.
+
+# This program is free software; you can redistribute it and/or modify
+# it under the terms of the GNU General Public License as published by
+# the Free Software Foundation; either version 2, or (at your option)
+# any later version.
+
+# This program is distributed in the hope that it will be useful,
+# but WITHOUT ANY WARRANTY; without even the implied warranty of
+# MERCHANTABILITY or FITNESS FOR A PARTICULAR PURPOSE.  See the
+# GNU General Public License for more details.
+
+# You should have received a copy of the GNU General Public License
+# along with this program; if not, write to the Free Software
+# Foundation, Inc., 51 Franklin Street, Fifth Floor, Boston, MA
+# 02110-1301, USA.
+
+# As a special exception to the GNU General Public License, if you
+# distribute this file as part of a program that contains a
+# configuration script generated by Autoconf, you may include it under
+# the same distribution terms that you use for the rest of that program.
+
+# Originally written by Alexandre Oliva <oliva@dcc.unicamp.br>.
+
+case $1 in
+  '')
+     echo "$0: No command.  Try \`$0 --help' for more information." 1>&2
+     exit 1;
+     ;;
+  -h | --h*)
+    cat <<\EOF
+Usage: depcomp [--help] [--version] PROGRAM [ARGS]
+
+Run PROGRAMS ARGS to compile a file, generating dependencies
+as side-effects.
+
+Environment variables:
+  depmode     Dependency tracking mode.
+  source      Source file read by `PROGRAMS ARGS'.
+  object      Object file output by `PROGRAMS ARGS'.
+  DEPDIR      directory where to store dependencies.
+  depfile     Dependency file to output.
+  tmpdepfile  Temporary file to use when outputing dependencies.
+  libtool     Whether libtool is used (yes/no).
+
+Report bugs to <bug-automake@gnu.org>.
+EOF
+    exit $?
+    ;;
+  -v | --v*)
+    echo "depcomp $scriptversion"
+    exit $?
+    ;;
+esac
+
+if test -z "$depmode" || test -z "$source" || test -z "$object"; then
+  echo "depcomp: Variables source, object and depmode must be set" 1>&2
+  exit 1
+fi
+
+# Dependencies for sub/bar.o or sub/bar.obj go into sub/.deps/bar.Po.
+depfile=${depfile-`echo "$object" |
+  sed 's|[^\\/]*$|'${DEPDIR-.deps}'/&|;s|\.\([^.]*\)$|.P\1|;s|Pobj$|Po|'`}
+tmpdepfile=${tmpdepfile-`echo "$depfile" | sed 's/\.\([^.]*\)$/.T\1/'`}
+
+rm -f "$tmpdepfile"
+
+# Some modes work just like other modes, but use different flags.  We
+# parameterize here, but still list the modes in the big case below,
+# to make depend.m4 easier to write.  Note that we *cannot* use a case
+# here, because this file can only contain one case statement.
+if test "$depmode" = hp; then
+  # HP compiler uses -M and no extra arg.
+  gccflag=-M
+  depmode=gcc
+fi
+
+if test "$depmode" = dashXmstdout; then
+   # This is just like dashmstdout with a different argument.
+   dashmflag=-xM
+   depmode=dashmstdout
+fi
+
+case "$depmode" in
+gcc3)
+## gcc 3 implements dependency tracking that does exactly what
+## we want.  Yay!  Note: for some reason libtool 1.4 doesn't like
+## it if -MD -MP comes after the -MF stuff.  Hmm.
+## Unfortunately, FreeBSD c89 acceptance of flags depends upon
+## the command line argument order; so add the flags where they
+## appear in depend2.am.  Note that the slowdown incurred here
+## affects only configure: in makefiles, %FASTDEP% shortcuts this.
+  for arg
+  do
+    case $arg in
+    -c) set fnord "$@" -MT "$object" -MD -MP -MF "$tmpdepfile" "$arg" ;;
+    *)  set fnord "$@" "$arg" ;;
+    esac
+    shift # fnord
+    shift # $arg
+  done
+  "$@"
+  stat=$?
+  if test $stat -eq 0; then :
+  else
+    rm -f "$tmpdepfile"
+    exit $stat
+  fi
+  mv "$tmpdepfile" "$depfile"
+  ;;
+
+gcc)
+## There are various ways to get dependency output from gcc.  Here's
+## why we pick this rather obscure method:
+## - Don't want to use -MD because we'd like the dependencies to end
+##   up in a subdir.  Having to rename by hand is ugly.
+##   (We might end up doing this anyway to support other compilers.)
+## - The DEPENDENCIES_OUTPUT environment variable makes gcc act like
+##   -MM, not -M (despite what the docs say).
+## - Using -M directly means running the compiler twice (even worse
+##   than renaming).
+  if test -z "$gccflag"; then
+    gccflag=-MD,
+  fi
+  "$@" -Wp,"$gccflag$tmpdepfile"
+  stat=$?
+  if test $stat -eq 0; then :
+  else
+    rm -f "$tmpdepfile"
+    exit $stat
+  fi
+  rm -f "$depfile"
+  echo "$object : \\" > "$depfile"
+  alpha=ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz
+## The second -e expression handles DOS-style file names with drive letters.
+  sed -e 's/^[^:]*: / /' \
+      -e 's/^['$alpha']:\/[^:]*: / /' < "$tmpdepfile" >> "$depfile"
+## This next piece of magic avoids the `deleted header file' problem.
+## The problem is that when a header file which appears in a .P file
+## is deleted, the dependency causes make to die (because there is
+## typically no way to rebuild the header).  We avoid this by adding
+## dummy dependencies for each header file.  Too bad gcc doesn't do
+## this for us directly.
+  tr ' ' '
+' < "$tmpdepfile" |
+## Some versions of gcc put a space before the `:'.  On the theory
+## that the space means something, we add a space to the output as
+## well.
+## Some versions of the HPUX 10.20 sed can't process this invocation
+## correctly.  Breaking it into two sed invocations is a workaround.
+    sed -e 's/^\\$//' -e '/^$/d' -e '/:$/d' | sed -e 's/$/ :/' >> "$depfile"
+  rm -f "$tmpdepfile"
+  ;;
+
+hp)
+  # This case exists only to let depend.m4 do its work.  It works by
+  # looking at the text of this script.  This case will never be run,
+  # since it is checked for above.
+  exit 1
+  ;;
+
+sgi)
+  if test "$libtool" = yes; then
+    "$@" "-Wp,-MDupdate,$tmpdepfile"
+  else
+    "$@" -MDupdate "$tmpdepfile"
+  fi
+  stat=$?
+  if test $stat -eq 0; then :
+  else
+    rm -f "$tmpdepfile"
+    exit $stat
+  fi
+  rm -f "$depfile"
+
+  if test -f "$tmpdepfile"; then  # yes, the sourcefile depend on other files
+    echo "$object : \\" > "$depfile"
+
+    # Clip off the initial element (the dependent).  Don't try to be
+    # clever and replace this with sed code, as IRIX sed won't handle
+    # lines with more than a fixed number of characters (4096 in
+    # IRIX 6.2 sed, 8192 in IRIX 6.5).  We also remove comment lines;
+    # the IRIX cc adds comments like `#:fec' to the end of the
+    # dependency line.
+    tr ' ' '
+' < "$tmpdepfile" \
+    | sed -e 's/^.*\.o://' -e 's/#.*$//' -e '/^$/ d' | \
+    tr '
+' ' ' >> $depfile
+    echo >> $depfile
+
+    # The second pass generates a dummy entry for each header file.
+    tr ' ' '
+' < "$tmpdepfile" \
+   | sed -e 's/^.*\.o://' -e 's/#.*$//' -e '/^$/ d' -e 's/$/:/' \
+   >> $depfile
+  else
+    # The sourcefile does not contain any dependencies, so just
+    # store a dummy comment line, to avoid errors with the Makefile
+    # "include basename.Plo" scheme.
+    echo "#dummy" > "$depfile"
+  fi
+  rm -f "$tmpdepfile"
+  ;;
+
+aix)
+  # The C for AIX Compiler uses -M and outputs the dependencies
+  # in a .u file.  In older versions, this file always lives in the
+  # current directory.  Also, the AIX compiler puts `$object:' at the
+  # start of each line; $object doesn't have directory information.
+  # Version 6 uses the directory in both cases.
+  dir=`echo "$object" | sed -e 's|/[^/]*$|/|'`
+  test "x$dir" = "x$object" && dir=
+  base=`echo "$object" | sed -e 's|^.*/||' -e 's/\.o$//' -e 's/\.lo$//'`
+  if test "$libtool" = yes; then
+    tmpdepfile1=$dir$base.u
+    tmpdepfile2=$base.u
+    tmpdepfile3=$dir.libs/$base.u
+    "$@" -Wc,-M
+  else
+    tmpdepfile1=$dir$base.u
+    tmpdepfile2=$dir$base.u
+    tmpdepfile3=$dir$base.u
+    "$@" -M
+  fi
+  stat=$?
+
+  if test $stat -eq 0; then :
+  else
+    rm -f "$tmpdepfile1" "$tmpdepfile2" "$tmpdepfile3"
+    exit $stat
+  fi
+
+  for tmpdepfile in "$tmpdepfile1" "$tmpdepfile2" "$tmpdepfile3"
+  do
+    test -f "$tmpdepfile" && break
+  done
+  if test -f "$tmpdepfile"; then
+    # Each line is of the form `foo.o: dependent.h'.
+    # Do two passes, one to just change these to
+    # `$object: dependent.h' and one to simply `dependent.h:'.
+    sed -e "s,^.*\.[a-z]*:,$object:," < "$tmpdepfile" > "$depfile"
+    # That's a tab and a space in the [].
+    sed -e 's,^.*\.[a-z]*:[	 ]*,,' -e 's,$,:,' < "$tmpdepfile" >> "$depfile"
+  else
+    # The sourcefile does not contain any dependencies, so just
+    # store a dummy comment line, to avoid errors with the Makefile
+    # "include basename.Plo" scheme.
+    echo "#dummy" > "$depfile"
+  fi
+  rm -f "$tmpdepfile"
+  ;;
+
+icc)
+  # Intel's C compiler understands `-MD -MF file'.  However on
+  #    icc -MD -MF foo.d -c -o sub/foo.o sub/foo.c
+  # ICC 7.0 will fill foo.d with something like
+  #    foo.o: sub/foo.c
+  #    foo.o: sub/foo.h
+  # which is wrong.  We want:
+  #    sub/foo.o: sub/foo.c
+  #    sub/foo.o: sub/foo.h
+  #    sub/foo.c:
+  #    sub/foo.h:
+  # ICC 7.1 will output
+  #    foo.o: sub/foo.c sub/foo.h
+  # and will wrap long lines using \ :
+  #    foo.o: sub/foo.c ... \
+  #     sub/foo.h ... \
+  #     ...
+
+  "$@" -MD -MF "$tmpdepfile"
+  stat=$?
+  if test $stat -eq 0; then :
+  else
+    rm -f "$tmpdepfile"
+    exit $stat
+  fi
+  rm -f "$depfile"
+  # Each line is of the form `foo.o: dependent.h',
+  # or `foo.o: dep1.h dep2.h \', or ` dep3.h dep4.h \'.
+  # Do two passes, one to just change these to
+  # `$object: dependent.h' and one to simply `dependent.h:'.
+  sed "s,^[^:]*:,$object :," < "$tmpdepfile" > "$depfile"
+  # Some versions of the HPUX 10.20 sed can't process this invocation
+  # correctly.  Breaking it into two sed invocations is a workaround.
+  sed 's,^[^:]*: \(.*\)$,\1,;s/^\\$//;/^$/d;/:$/d' < "$tmpdepfile" |
+    sed -e 's/$/ :/' >> "$depfile"
+  rm -f "$tmpdepfile"
+  ;;
+
+hp2)
+  # The "hp" stanza above does not work with aCC (C++) and HP's ia64
+  # compilers, which have integrated preprocessors.  The correct option
+  # to use with these is +Maked; it writes dependencies to a file named
+  # 'foo.d', which lands next to the object file, wherever that
+  # happens to be.
+  # Much of this is similar to the tru64 case; see comments there.
+  dir=`echo "$object" | sed -e 's|/[^/]*$|/|'`
+  test "x$dir" = "x$object" && dir=
+  base=`echo "$object" | sed -e 's|^.*/||' -e 's/\.o$//' -e 's/\.lo$//'`
+  if test "$libtool" = yes; then
+    tmpdepfile1=$dir$base.d
+    tmpdepfile2=$dir.libs/$base.d
+    "$@" -Wc,+Maked
+  else
+    tmpdepfile1=$dir$base.d
+    tmpdepfile2=$dir$base.d
+    "$@" +Maked
+  fi
+  stat=$?
+  if test $stat -eq 0; then :
+  else
+     rm -f "$tmpdepfile1" "$tmpdepfile2"
+     exit $stat
+  fi
+
+  for tmpdepfile in "$tmpdepfile1" "$tmpdepfile2"
+  do
+    test -f "$tmpdepfile" && break
+  done
+  if test -f "$tmpdepfile"; then
+    sed -e "s,^.*\.[a-z]*:,$object:," "$tmpdepfile" > "$depfile"
+    # Add `dependent.h:' lines.
+    sed -ne '2,${; s/^ *//; s/ \\*$//; s/$/:/; p;}' "$tmpdepfile" >> "$depfile"
+  else
+    echo "#dummy" > "$depfile"
+  fi
+  rm -f "$tmpdepfile" "$tmpdepfile2"
+  ;;
+
+tru64)
+   # The Tru64 compiler uses -MD to generate dependencies as a side
+   # effect.  `cc -MD -o foo.o ...' puts the dependencies into `foo.o.d'.
+   # At least on Alpha/Redhat 6.1, Compaq CCC V6.2-504 seems to put
+   # dependencies in `foo.d' instead, so we check for that too.
+   # Subdirectories are respected.
+   dir=`echo "$object" | sed -e 's|/[^/]*$|/|'`
+   test "x$dir" = "x$object" && dir=
+   base=`echo "$object" | sed -e 's|^.*/||' -e 's/\.o$//' -e 's/\.lo$//'`
+
+   if test "$libtool" = yes; then
+      # With Tru64 cc, shared objects can also be used to make a
+      # static library.  This mechanism is used in libtool 1.4 series to
+      # handle both shared and static libraries in a single compilation.
+      # With libtool 1.4, dependencies were output in $dir.libs/$base.lo.d.
+      #
+      # With libtool 1.5 this exception was removed, and libtool now
+      # generates 2 separate objects for the 2 libraries.  These two
+      # compilations output dependencies in $dir.libs/$base.o.d and
+      # in $dir$base.o.d.  We have to check for both files, because
+      # one of the two compilations can be disabled.  We should prefer
+      # $dir$base.o.d over $dir.libs/$base.o.d because the latter is
+      # automatically cleaned when .libs/ is deleted, while ignoring
+      # the former would cause a distcleancheck panic.
+      tmpdepfile1=$dir.libs/$base.lo.d   # libtool 1.4
+      tmpdepfile2=$dir$base.o.d          # libtool 1.5
+      tmpdepfile3=$dir.libs/$base.o.d    # libtool 1.5
+      tmpdepfile4=$dir.libs/$base.d      # Compaq CCC V6.2-504
+      "$@" -Wc,-MD
+   else
+      tmpdepfile1=$dir$base.o.d
+      tmpdepfile2=$dir$base.d
+      tmpdepfile3=$dir$base.d
+      tmpdepfile4=$dir$base.d
+      "$@" -MD
+   fi
+
+   stat=$?
+   if test $stat -eq 0; then :
+   else
+      rm -f "$tmpdepfile1" "$tmpdepfile2" "$tmpdepfile3" "$tmpdepfile4"
+      exit $stat
+   fi
+
+   for tmpdepfile in "$tmpdepfile1" "$tmpdepfile2" "$tmpdepfile3" "$tmpdepfile4"
+   do
+     test -f "$tmpdepfile" && break
+   done
+   if test -f "$tmpdepfile"; then
+      sed -e "s,^.*\.[a-z]*:,$object:," < "$tmpdepfile" > "$depfile"
+      # That's a tab and a space in the [].
+      sed -e 's,^.*\.[a-z]*:[	 ]*,,' -e 's,$,:,' < "$tmpdepfile" >> "$depfile"
+   else
+      echo "#dummy" > "$depfile"
+   fi
+   rm -f "$tmpdepfile"
+   ;;
+
+#nosideeffect)
+  # This comment above is used by automake to tell side-effect
+  # dependency tracking mechanisms from slower ones.
+
+dashmstdout)
+  # Important note: in order to support this mode, a compiler *must*
+  # always write the preprocessed file to stdout, regardless of -o.
+  "$@" || exit $?
+
+  # Remove the call to Libtool.
+  if test "$libtool" = yes; then
+    while test $1 != '--mode=compile'; do
+      shift
+    done
+    shift
+  fi
+
+  # Remove `-o $object'.
+  IFS=" "
+  for arg
+  do
+    case $arg in
+    -o)
+      shift
+      ;;
+    $object)
+      shift
+      ;;
+    *)
+      set fnord "$@" "$arg"
+      shift # fnord
+      shift # $arg
+      ;;
+    esac
+  done
+
+  test -z "$dashmflag" && dashmflag=-M
+  # Require at least two characters before searching for `:'
+  # in the target name.  This is to cope with DOS-style filenames:
+  # a dependency such as `c:/foo/bar' could be seen as target `c' otherwise.
+  "$@" $dashmflag |
+    sed 's:^[  ]*[^: ][^:][^:]*\:[    ]*:'"$object"'\: :' > "$tmpdepfile"
+  rm -f "$depfile"
+  cat < "$tmpdepfile" > "$depfile"
+  tr ' ' '
+' < "$tmpdepfile" | \
+## Some versions of the HPUX 10.20 sed can't process this invocation
+## correctly.  Breaking it into two sed invocations is a workaround.
+    sed -e 's/^\\$//' -e '/^$/d' -e '/:$/d' | sed -e 's/$/ :/' >> "$depfile"
+  rm -f "$tmpdepfile"
+  ;;
+
+dashXmstdout)
+  # This case only exists to satisfy depend.m4.  It is never actually
+  # run, as this mode is specially recognized in the preamble.
+  exit 1
+  ;;
+
+makedepend)
+  "$@" || exit $?
+  # Remove any Libtool call
+  if test "$libtool" = yes; then
+    while test $1 != '--mode=compile'; do
+      shift
+    done
+    shift
+  fi
+  # X makedepend
+  shift
+  cleared=no
+  for arg in "$@"; do
+    case $cleared in
+    no)
+      set ""; shift
+      cleared=yes ;;
+    esac
+    case "$arg" in
+    -D*|-I*)
+      set fnord "$@" "$arg"; shift ;;
+    # Strip any option that makedepend may not understand.  Remove
+    # the object too, otherwise makedepend will parse it as a source file.
+    -*|$object)
+      ;;
+    *)
+      set fnord "$@" "$arg"; shift ;;
+    esac
+  done
+  obj_suffix="`echo $object | sed 's/^.*\././'`"
+  touch "$tmpdepfile"
+  ${MAKEDEPEND-makedepend} -o"$obj_suffix" -f"$tmpdepfile" "$@"
+  rm -f "$depfile"
+  cat < "$tmpdepfile" > "$depfile"
+  sed '1,2d' "$tmpdepfile" | tr ' ' '
+' | \
+## Some versions of the HPUX 10.20 sed can't process this invocation
+## correctly.  Breaking it into two sed invocations is a workaround.
+    sed -e 's/^\\$//' -e '/^$/d' -e '/:$/d' | sed -e 's/$/ :/' >> "$depfile"
+  rm -f "$tmpdepfile" "$tmpdepfile".bak
+  ;;
+
+cpp)
+  # Important note: in order to support this mode, a compiler *must*
+  # always write the preprocessed file to stdout.
+  "$@" || exit $?
+
+  # Remove the call to Libtool.
+  if test "$libtool" = yes; then
+    while test $1 != '--mode=compile'; do
+      shift
+    done
+    shift
+  fi
+
+  # Remove `-o $object'.
+  IFS=" "
+  for arg
+  do
+    case $arg in
+    -o)
+      shift
+      ;;
+    $object)
+      shift
+      ;;
+    *)
+      set fnord "$@" "$arg"
+      shift # fnord
+      shift # $arg
+      ;;
+    esac
+  done
+
+  "$@" -E |
+    sed -n -e '/^# [0-9][0-9]* "\([^"]*\)".*/ s:: \1 \\:p' \
+       -e '/^#line [0-9][0-9]* "\([^"]*\)".*/ s:: \1 \\:p' |
+    sed '$ s: \\$::' > "$tmpdepfile"
+  rm -f "$depfile"
+  echo "$object : \\" > "$depfile"
+  cat < "$tmpdepfile" >> "$depfile"
+  sed < "$tmpdepfile" '/^$/d;s/^ //;s/ \\$//;s/$/ :/' >> "$depfile"
+  rm -f "$tmpdepfile"
+  ;;
+
+msvisualcpp)
+  # Important note: in order to support this mode, a compiler *must*
+  # always write the preprocessed file to stdout, regardless of -o,
+  # because we must use -o when running libtool.
+  "$@" || exit $?
+  IFS=" "
+  for arg
+  do
+    case "$arg" in
+    "-Gm"|"/Gm"|"-Gi"|"/Gi"|"-ZI"|"/ZI")
+	set fnord "$@"
+	shift
+	shift
+	;;
+    *)
+	set fnord "$@" "$arg"
+	shift
+	shift
+	;;
+    esac
+  done
+  "$@" -E |
+  sed -n '/^#line [0-9][0-9]* "\([^"]*\)"/ s::echo "`cygpath -u \\"\1\\"`":p' | sort | uniq > "$tmpdepfile"
+  rm -f "$depfile"
+  echo "$object : \\" > "$depfile"
+  . "$tmpdepfile" | sed 's% %\\ %g' | sed -n '/^\(.*\)$/ s::	\1 \\:p' >> "$depfile"
+  echo "	" >> "$depfile"
+  . "$tmpdepfile" | sed 's% %\\ %g' | sed -n '/^\(.*\)$/ s::\1\::p' >> "$depfile"
+  rm -f "$tmpdepfile"
+  ;;
+
+none)
+  exec "$@"
+  ;;
+
+*)
+  echo "Unknown depmode $depmode" 1>&2
+  exit 1
+  ;;
+esac
+
+exit 0
+
+# Local Variables:
+# mode: shell-script
+# sh-indentation: 2
+# eval: (add-hook 'write-file-hooks 'time-stamp)
+# time-stamp-start: "scriptversion="
+# time-stamp-format: "%:y-%02m-%02d.%02H"
+# time-stamp-end: "$"
+# End:
diff -urN lcd4linux-0.10.0/drivers.m4 lcd4linux-0.11.0-SVN/drivers.m4
--- lcd4linux-0.10.0/drivers.m4	1970-01-01 01:00:00.000000000 +0100
+++ lcd4linux-0.11.0-SVN/drivers.m4	2009-01-13 05:54:45.000000000 +0100
@@ -0,0 +1,705 @@
+dnl $Id: drivers.m4 957 2009-01-13 04:02:35Z michael $
+dnl $URL: https://ssl.bulix.org/svn/lcd4linux/trunk/drivers.m4 $
+
+
+dnl LCD4Linux Drivers conf part
+dnl
+dnl Copyright (C) 1999, 2000, 2001, 2002, 2003 Michael Reinelt <michael@reinelt.co.at>
+dnl Copyright (C) 2004 The LCD4Linux Team <lcd4linux-devel@users.sourceforge.net>
+dnl
+dnl This file is part of LCD4Linux.
+dnl
+dnl LCD4Linux is free software; you can redistribute it and/or modify
+dnl it under the terms of the GNU General Public License as published by
+dnl the Free Software Foundation; either version 2, or (at your option)
+dnl any later version.
+dnl
+dnl LCD4Linux is distributed in the hope that it will be useful,
+dnl but WITHOUT ANY WARRANTY; without even the implied warranty of
+dnl MERCHANTABILITY or FITNESS FOR A PARTICULAR PURPOSE.  See the
+dnl GNU General Public License for more details.
+dnl
+dnl You should have received a copy of the GNU General Public License
+dnl along with this program; if not, write to the Free Software
+dnl Foundation, Inc., 675 Mass Ave, Cambridge, MA 02139, USA.
+
+AC_MSG_CHECKING([which drivers to compile])
+AC_ARG_WITH(
+  drivers,
+  [  --with-drivers=<list>   compile driver for displays in <list>,]
+  [                        drivers may be separated with commas,]
+  [                        'all' (default) compiles all available drivers,]
+  [                        drivers may be excluded with 'all,!<driver>',]
+  [                        (try 'all,\!<driver>' if your shell complains...)]
+  [                        possible drivers are:]
+  [                        BeckmannEgle, BWCT, CrystalFontz, Curses, Cwlinux, D4D,]
+  [                        G15, HD44780, IRLCD, LCD2USB LCDLinux, LCDTerm, LPH7508,]
+  [                        LUIse, M50530, MatrixOrbital, MilfordInstruments, Noritake,]
+  [                        NULL, PNG, PPM, Pertelian, PHAnderson, picoLCD, picoLCDGraphic,]
+  [                        RouterBoard, Sample, serdisplib, SimpleLCD, st2205, T6963, Trefon,]
+  [                        ULA200, USBLCD, USBHUB, WincorNixdorf, X11],
+  drivers=$withval,
+  drivers=all
+)
+
+drivers=`echo $drivers|sed 's/,/ /g'`
+
+for driver in $drivers; do
+
+   case $driver in
+      !*)
+         val="no"
+         driver=`echo $driver|cut -c 2-`
+         ;;
+       *)
+         val="yes"
+         ;;
+   esac
+
+   case "$driver" in
+      all)
+         BECKMANNEGLE="yes"
+         BWCT="yes"
+         CRYSTALFONTZ="yes"
+         CURSES="yes"
+         CWLINUX="yes"
+         D4D="yes"
+         EA232graphic="yes"
+         G15="yes"
+         HD44780="yes"
+	 IRLCD="yes"
+         LCD2USB="yes"
+	 LCDLINUX="yes"
+         LCDTERM="yes"
+         LEDMATRIX="yes"
+	 LPH7508="yes"
+         LUISE="yes"
+         M50530="yes"
+         MATRIXORBITAL="yes"
+         MILINST="yes"
+         NORITAKE="yes"
+         NULL="yes"
+         PERTELIAN="yes"
+         PHANDERSON="yes"
+         PICOLCD="yes"
+	 PICOLCDGRAPHIC="yes"
+         PNG="yes"
+         PPM="yes"
+         ROUTERBOARD="yes"
+         SAMPLE="yes"
+         ST2205="yes"
+	 SERDISPLIB="yes"
+         SIMPLELCD="yes"
+         T6963="yes"
+         Trefon="yes"
+         ULA200="yes"
+	 USBHUB="yes"
+         USBLCD="yes"
+	 WINCORNIXDORF="yes"
+         X11="yes"
+         ;;
+      BeckmannEgle)
+         BECKMANNEGLE=$val
+         ;;
+      BWCT)
+         BWCT=$val
+         ;;
+      CrystalFontz)
+         CRYSTALFONTZ=$val
+         ;;
+      Curses)
+         CURSES=$val
+         ;;
+      Cwlinux)
+         CWLINUX=$val
+         ;;
+      D4D)
+         D4D=$val
+         ;;
+      EA232graphic)
+         EA232graphic=$val
+         ;;
+      G15)
+         G15=$val
+         ;;
+      HD44780)
+         HD44780=$val
+	 ;;
+      HD44780-I2C)
+         HD44780_I2C=$val
+	 ;;
+      IRLCD)
+         IRLCD=$val
+         ;;
+      LCD2USB)
+         LCD2USB=$val
+         ;;
+      LCDLinux)
+         LCDLINUX=$val
+	 ;;
+      LCDTerm)
+         LCDTERM=$val
+	 ;;
+      LEDMatrix)
+         LEDMATRIX=$val
+	 ;;
+      LPH7508)
+         LPH7508=$val
+         ;;
+      LUIse)
+         LUISE=$val
+         ;;
+      M50530)
+         M50530=$val
+         ;;
+      MatrixOrbital)
+         MATRIXORBITAL=$val
+         ;;
+      MilfordInstruments)
+         MILINST=$val
+         ;;
+      Noritake)
+         NORITAKE=$val;
+         ;;
+      NULL)
+         NULL=$val;
+         ;;
+      Pertelian)
+         PERTELIAN=$val
+         ;;
+      PHAnderson)
+         PHANDERSON=$val
+         ;;
+      picoLCD)
+         PICOLCD=$val
+         ;;
+      picoLCDGraphic)
+         PICOLCDGRAPHIC=$val
+         ;;
+
+      PNG)
+         PNG=$val
+         ;;
+      PPM)
+         PPM=$val
+         ;;
+      RouterBoard)
+         ROUTERBOARD=$val
+         ;;
+      Sample)
+         SAMPLE=$val
+         ;;
+      serdisplib)
+         SERDISPLIB=$val;
+         ;;
+      SimpleLCD)
+         SIMPLELCD=$val
+         ;;
+      st2205)
+         ST2205=$val
+         ;;
+      T6963)
+         T6963=$val
+         ;;
+      Trefon)
+         Trefon=$val
+         ;;
+      ULA200)
+         ULA200=$val
+         ;;
+      USBHUB)
+         USBHUB=$val
+         ;;
+      USBLCD)
+         USBLCD=$val
+         ;;
+      WincorNixdorf)
+         WINCORNIXDORF=$val
+         ;;
+      X11)
+         X11=$val
+         ;;
+      *)
+         AC_MSG_ERROR([Unknown driver '$driver'])
+         ;;
+   esac
+done
+
+AC_MSG_RESULT([done])
+
+
+# generic display drivers
+TEXT="no"
+GRAPHIC="no"
+IMAGE="no"
+GPIO="no"
+
+# generiv I/O drivers
+PARPORT="no"
+SERIAL="no"
+I2C="no"
+KEYPAD="no"
+
+# generic libraries
+LIBUSB="no"
+LIBFTDI="no"
+
+if test "$BECKMANNEGLE" = "yes"; then
+   TEXT="yes"
+   GPIO="yes"
+   SERIAL="yes"
+   DRIVERS="$DRIVERS drv_BeckmannEgle.o"
+   AC_DEFINE(WITH_BECKMANNEGLE,1,[Beckmann&Egle driver])
+fi
+
+if test "$BWCT" = "yes"; then
+   if test "$has_usb" = "true"; then
+      TEXT="yes"
+      DRIVERS="$DRIVERS drv_BWCT.o"
+      LIBUSB="yes"
+      AC_DEFINE(WITH_BWCT,1,[BWCT driver])
+   else
+      AC_MSG_WARN(usb.h not found: BWCT driver disabled)
+   fi
+fi
+
+if test "$CRYSTALFONTZ" = "yes"; then
+   TEXT="yes"
+   GPIO="yes"
+   SERIAL="yes"
+   KEYPAD="yes"
+   DRIVERS="$DRIVERS drv_Crystalfontz.o"
+   AC_DEFINE(WITH_CRYSTALFONTZ,1,[Crystalfontz driver])
+fi
+
+if test "$CURSES" = "yes"; then
+   if test "$has_curses" = true; then
+      TEXT="yes"
+      KEYPAD="yes"
+      DRIVERS="$DRIVERS drv_Curses.o"
+      DRVLIBS="$DRVLIBS $CURSES_LIBS"
+      CPPFLAGS="$CPPFLAGS $CURSES_INCLUDES"
+      AC_DEFINE(WITH_CURSES,1,[Curses driver])
+   else
+      AC_MSG_WARN(curses not found: Curses driver disabled)
+   fi
+fi
+
+if test "$CWLINUX" = "yes"; then
+   TEXT="yes"
+   GPIO="yes"
+   SERIAL="yes"
+   KEYPAD="yes"
+   DRIVERS="$DRIVERS drv_Cwlinux.o"
+   AC_DEFINE(WITH_CWLINUX,1,[CwLinux driver])
+fi
+
+if test "$D4D" = "yes"; then
+   TEXT="yes"
+   GRAPHIC="yes"
+   SERIAL="yes"
+   DRIVERS="$DRIVERS drv_D4D.o"
+   AC_DEFINE(WITH_D4D,1,[D4D driver])
+fi
+
+if test "$EA232graphic" = "yes"; then
+   GRAPHIC="yes"
+   SERIAL="yes"
+   GPIO="yes"
+   DRIVERS="$DRIVERS drv_EA232graphic.o"
+   AC_DEFINE(WITH_EA232graphic,1,[Electronic Assembly RS232 graphic driver])
+fi
+
+if test "$G15" = "yes"; then
+   if test "$has_usb" = "true"; then
+      GRAPHIC="yes"
+      LIBUSB="yes"
+      DRIVERS="$DRIVERS drv_G15.o"
+      AC_DEFINE(WITH_G15,1,[G-15 driver])
+   else
+      AC_MSG_WARN(usb.h not found: G15 driver disabled)
+   fi
+fi
+
+if test "$HD44780" = "yes"; then
+   TEXT="yes"
+   PARPORT="yes"
+   I2C="yes"
+   GPIO="yes"
+   KEYPAD="yes"
+   DRIVERS="$DRIVERS drv_HD44780.o"
+   AC_DEFINE(WITH_HD44780,1,[HD44780 driver])
+fi
+
+if test "$HD44780_I2C" = "yes"; then
+   TEXT="yes"
+   I2C="yes"
+   GPIO="yes"
+   DRIVERS="$DRIVERS drv_HD44780.o"
+   AC_DEFINE(WITH_HD44780,1,[HD44780 driver])
+fi
+
+if test "$IRLCD" = "yes"; then
+   if test "$has_usb" = "true"; then
+      TEXT="yes"
+      SERIAL="yes"
+      DRIVERS="$DRIVERS drv_IRLCD.o"
+      LIBUSB="yes"
+      AC_DEFINE(WITH_IRLCD,1,[IRLCD driver])
+   else
+      AC_MSG_WARN(usb.h not found: IRLCD driver disabled)
+   fi
+fi
+
+if test "$LCD2USB" = "yes"; then
+   if test "$has_usb" = "true"; then
+      TEXT="yes"
+      SERIAL="yes"
+      KEYPAD="yes"
+      DRIVERS="$DRIVERS drv_LCD2USB.o"
+      LIBUSB="yes"
+      AC_DEFINE(WITH_LCD2USB,1,[LCD2USB driver])
+   else
+      AC_MSG_WARN(usb.h not found: LCD2USB driver disabled)
+   fi
+fi
+
+if test "$LCDLINUX" = "yes"; then
+   if test "$has_lcd_linux" = true; then
+      TEXT="yes"
+      DRIVERS="$DRIVERS drv_LCDLinux.o"
+      AC_DEFINE(WITH_LCDLINUX,1,[LCD-Linux driver])
+   else
+      AC_MSG_WARN(linux/lcd-linux.h or linux/hd44780.h not found: LCD-Linux driver disabled)
+   fi
+fi
+
+if test "$LCDTERM" = "yes"; then
+   TEXT="yes"
+   SERIAL="yes"
+   DRIVERS="$DRIVERS drv_LCDTerm.o"
+   AC_DEFINE(WITH_LCDTERM,1,[LCDTerm driver])
+fi
+
+if test "$LEDMATRIX" = "yes"; then
+   GRAPHIC="yes"
+   DRIVERS="$DRIVERS drv_LEDMatrix.o"
+   AC_DEFINE(WITH_LEDMATRIX,1,[LEDMatrix driver])
+fi
+
+if test "$LPH7508" = "yes"; then
+   GRAPHIC="yes"
+   GPIO="yes"
+   PARPORT="yes"
+   DRIVERS="$DRIVERS drv_LPH7508.o"
+   AC_DEFINE(WITH_LPH7508,1,[LPH7508 driver])
+fi
+
+if test "$LUISE" = "yes"; then
+   if test "$has_luise" = "true"; then
+      GRAPHIC="yes"
+      DRIVERS="$DRIVERS drv_LUIse.o"
+      DRVLIBS="$DRVLIBS -L/usr/local/lib -lluise"
+      AC_DEFINE(WITH_LUISE,1,[LUIse driver])
+   else
+      AC_MSG_WARN(luise.h not found: LUIse driver disabled)
+   fi
+fi
+
+if test "$M50530" = "yes"; then
+   TEXT="yes"
+   GPIO="yes"
+   PARPORT="yes"
+   DRIVERS="$DRIVERS drv_M50530.o"
+   AC_DEFINE(WITH_M50530,1,[M50530 driver])
+fi
+
+if test "$MATRIXORBITAL" = "yes"; then
+   TEXT="yes"
+   GPIO="yes"
+   SERIAL="yes"
+   DRIVERS="$DRIVERS drv_MatrixOrbital.o"
+   AC_DEFINE(WITH_MATRIXORBITAL,1,[MatrixOrbital driver])
+fi
+
+if test "$MILINST" = "yes"; then
+   TEXT="yes"
+   SERIAL="yes"
+   DRIVERS="$DRIVERS drv_MilfordInstruments.o"
+   AC_DEFINE(WITH_MILINST,1,[Milford Instruments driver])
+fi
+
+if test "$NORITAKE" = "yes"; then
+   TEXT="yes"
+   GRAPHIC="yes"
+   PARPORT="yes"
+   DRIVERS="$DRIVERS drv_Noritake.o"
+   AC_DEFINE(WITH_NORITAKE,1,[Noritake driver])
+fi
+
+if test "$NULL" = "yes"; then
+   TEXT="yes"
+   DRIVERS="$DRIVERS drv_NULL.o"
+   AC_DEFINE(WITH_NULL,1,[NULL driver])
+fi
+
+if test "$PERTELIAN" = "yes"; then
+   # select either text or graphics mode
+   TEXT="yes"
+   # select bus: serial (including USB), parallel or i2c
+   SERIAL="yes"
+   DRIVERS="$DRIVERS drv_Pertelian.o"
+   AC_DEFINE(WITH_PERTELIAN,1,[Pertelian driver])
+fi
+
+if test "$PHANDERSON" = "yes"; then
+   TEXT="yes"
+   SERIAL="yes"
+   DRIVERS="$DRIVERS drv_PHAnderson.o"
+   AC_DEFINE(WITH_PHANDERSON,1,[PHAnderson driver])
+fi
+
+if test "$PICOLCD" = "yes"; then
+   if test "$has_usb" = "true"; then
+      TEXT="yes"
+      GPIO="yes"
+      SERIAL="yes"
+      LIBUSB="yes"
+      DRIVERS="$DRIVERS drv_picoLCD.o"
+      AC_DEFINE(WITH_PICOLCD,1,[picoLCD driver])
+   else
+      AC_MSG_WARN(usb.h not found: picoLCD driver disabled)
+   fi
+fi
+
+if test "$PICOLCDGRAPHIC" = "yes"; then
+   if test "$has_usb" = "true"; then
+      TEXT="yes"
+      GRAPHIC="yes"
+      GPIO="yes"
+      SERIAL="yes"
+      LIBUSB="yes"
+      DRIVERS="$DRIVERS drv_picoLCDGraphic.o"
+      AC_DEFINE(WITH_PICOLCDGRAPHIC,1,[picoLCDGraphic driver])
+   else
+      AC_MSG_WARN(usb.h not found: picoLCDGraphic driver disabled)
+   fi
+fi
+
+if test "$PNG" = "yes"; then
+   if test "$has_gd" = "true"; then
+      IMAGE="yes"
+      AC_DEFINE(WITH_PNG,1,[PNG driver])
+   else
+      AC_MSG_WARN(gd.h not found: PNG driver disabled)
+   fi
+fi
+
+if test "$PPM" = "yes"; then
+   IMAGE="yes"
+   AC_DEFINE(WITH_PPM,1,[PPM driver])
+fi
+
+if test "$ROUTERBOARD" = "yes"; then
+   if test "$has_io_h" = "true"; then
+      TEXT="yes"
+      GPIO="yes"
+      DRIVERS="$DRIVERS drv_RouterBoard.o"
+      AC_DEFINE(WITH_ROUTERBOARD,1,[RouterBoard driver])
+   else
+      AC_MSG_WARN(sys/io.h not found: RouterBoard driver disabled)
+   fi
+fi
+
+if test "$SAMPLE" = "yes"; then
+   # select either text or graphics mode
+   TEXT="yes"
+   GRAPHIC="yes"
+   # support for GPIO's
+   GPIO="yes"
+   # select bus: serial (including USB), parallel or i2c
+   SERIAL="yes"
+   PARPORT="yes"
+   #I2C="yes"
+   DRIVERS="$DRIVERS drv_Sample.o"
+   AC_DEFINE(WITH_SAMPLE,1,[Sample driver])
+fi
+
+if test "$SERDISPLIB" = "yes"; then
+   if test "$has_serdisplib" = "true"; then
+      GRAPHIC="yes"
+      DRIVERS="$DRIVERS drv_serdisplib.o"
+      DRVLIBS="$DRVLIBS -L/usr/local/lib -lserdisp"
+      AC_DEFINE(WITH_SERDISPLIB,1,[serdisplib driver])
+      if test "$has_usb" = "true"; then
+         LIBUSB="yes"
+      fi
+   else
+      AC_MSG_WARN(serdisp.h not found: serdisplib driver disabled)
+   fi
+fi
+
+if test "$SIMPLELCD" = "yes"; then
+   TEXT="yes"
+   SERIAL="yes"
+   DRIVERS="$DRIVERS drv_SimpleLCD.o"
+   AC_DEFINE(WITH_SIMPLELCD,1,[SimpleLCD driver])
+fi
+
+if test "$ST2205" = "yes"; then
+   if test "$has_st2205" = "true"; then
+      GRAPHIC="yes"
+      DRIVERS="$DRIVERS drv_st2205.o"
+      DRVLIBS="$DRVLIBS -L/usr/local/lib -lst2205"
+      AC_DEFINE(WITH_ST2205,1,[st2205 driver])
+   else
+      AC_MSG_WARN(st2205.h not found: st2205 driver disabled)
+   fi
+fi
+
+if test "$T6963" = "yes"; then
+   GRAPHIC="yes"
+   PARPORT="yes"
+   DRIVERS="$DRIVERS drv_T6963.o"
+   AC_DEFINE(WITH_T6963,1,[T6963 driver])
+fi
+
+if test "$Trefon" = "yes"; then
+   if test "$has_usb" = "true"; then
+      TEXT="yes"
+      DRIVERS="$DRIVERS drv_Trefon.o"
+      LIBUSB="yes"
+      AC_DEFINE(WITH_TREFON,1,[TREFON driver])
+   else
+      AC_MSG_WARN(usb.h not found: Trefon driver disabled)
+   fi
+fi
+
+if test "$ULA200" = "yes"; then
+   if test "$has_ftdi" = "true"; then
+      TEXT="yes"
+      LIBUSB="yes"
+      LIBFTDI="yes"
+      DRIVERS="$DRIVERS drv_ula200.o"
+      AC_DEFINE(WITH_ULA200,1,[ULA200 driver])
+   else
+      AC_MSG_WARN(ftdi.h not found: ULA200 driver disabled)
+   fi
+fi
+
+if test "$USBHUB" = "yes"; then
+   if test "$has_usb" = "true"; then
+      GPIO="yes"
+      DRIVERS="$DRIVERS drv_USBHUB.o"
+      LIBUSB="yes"
+      AC_DEFINE(WITH_USBHUB,1,[USBHUB driver])
+   else
+      AC_MSG_WARN(usb.h not found: USB-Hub driver disabled)
+   fi
+fi
+
+if test "$USBLCD" = "yes"; then
+   TEXT="yes"
+   SERIAL="yes"
+   DRIVERS="$DRIVERS drv_USBLCD.o"
+   if test "$has_usb" = "true"; then
+      LIBUSB="yes"
+   fi
+   AC_DEFINE(WITH_USBLCD,1,[USBLCD driver])
+fi
+
+if test "$WINCORNIXDORF" = "yes"; then
+   TEXT="yes"
+   SERIAL="yes"
+   DRIVERS="$DRIVERS drv_WincorNixdorf.o"
+   AC_DEFINE(WITH_WINCORNIXDORF,1,[WincorNixdorf driver])
+fi
+
+if test "$X11" = "yes"; then
+   if test "$no_x" = "yes"; then
+      AC_MSG_WARN(X11 headers or libraries not available: X11 driver disabled)
+   else
+      GRAPHIC="yes"
+      KEYPAD="yes"
+      DRIVERS="$DRIVERS drv_X11.o"
+      if test "x$ac_x_libraries" = "x"; then
+	DRVLIBS="$DRVLIBS -lX11"
+      else
+        DRVLIBS="$DRVLIBS -L$ac_x_libraries -lX11"
+      fi
+      CPP_FLAGS="$CPPFLAGS $X_CFLAGS"
+      AC_DEFINE(WITH_X11, 1, [X11 driver])
+   fi
+fi
+
+
+# Image driver
+if test "$IMAGE" = "yes"; then
+   GRAPHIC="yes"
+   DRIVERS="$DRIVERS drv_Image.o"
+fi
+
+if test "$DRIVERS" = ""; then
+   AC_MSG_ERROR([You should activate at least one driver...])
+fi
+
+# generic text driver
+if test "$TEXT" = "yes"; then
+   DRIVERS="$DRIVERS drv_generic_text.o"
+fi
+
+# generic graphic driver
+if test "$GRAPHIC" = "yes"; then
+   DRIVERS="$DRIVERS drv_generic_graphic.o"
+   if test "$has_gd" = "true"; then
+      DRIVERS="$DRIVERS widget_image.o"
+      DRVLIBS="$DRVLIBS -lgd"
+      AC_DEFINE(WITH_GD, 1, [GD library])
+      AC_DEFINE(WITH_IMAGE, 1, [image widget])
+   fi
+fi
+
+# generic GPIO driver
+if test "$GPIO" = "yes"; then
+   DRIVERS="$DRIVERS drv_generic_gpio.o"
+fi
+
+# generic parport driver
+if test "$PARPORT" = "yes"; then
+   DRIVERS="$DRIVERS drv_generic_parport.o"
+   AC_DEFINE(WITH_PARPORT, 1, [parport bus driver])
+fi
+
+# generic serial driver
+if test "$SERIAL" = "yes"; then
+   DRIVERS="$DRIVERS drv_generic_serial.o"
+   AC_DEFINE(WITH_SERIAL, 1, [serial bus driver])
+fi
+
+# generic i2c driver
+if test "$I2C" = "yes"; then
+   DRIVERS="$DRIVERS drv_generic_i2c.o"
+   AC_DEFINE(WITH_I2C, 1, [I2C bus driver])
+fi
+
+# generic keypad driver
+if test "$KEYPAD" = "yes"; then
+   DRIVERS="$DRIVERS drv_generic_keypad.o"
+fi
+
+# libusb
+if test "$LIBUSB" = "yes"; then
+   DRVLIBS="$DRVLIBS -lusb"
+fi
+
+# libftdi
+if test "$LIBFTDI" = "yes"; then
+   DRVLIBS="$DRVLIBS -lftdi"
+fi
+
+if test "$DRIVERS" = ""; then
+   AC_MSG_ERROR([You should include at least one driver...])
+fi
+   
+AC_SUBST(DRIVERS)
+AC_SUBST(DRVLIBS)
diff -urN lcd4linux-0.10.0/drv_BeckmannEgle.c lcd4linux-0.11.0-SVN/drv_BeckmannEgle.c
--- lcd4linux-0.10.0/drv_BeckmannEgle.c	2005-05-08 06:32:44.000000000 +0200
+++ lcd4linux-0.11.0-SVN/drv_BeckmannEgle.c	2008-12-31 08:05:54.000000000 +0100
@@ -1,7 +1,8 @@
-/* $Id: drv_BeckmannEgle.c,v 1.15 2005/05/08 04:32:44 reinelt Exp $
+/* $Id: drv_BeckmannEgle.c 840 2007-09-09 12:17:42Z michael $
+ * $URL: https://ssl.bulix.org/svn/lcd4linux/trunk/drv_BeckmannEgle.c $
  *
  * driver for Beckmann+Egle "Mini Terminals" and "Compact Terminals"
- * Copyright (C) 2000 Michael Reinelt <reinelt@eunet.at>
+ * Copyright (C) 2000 Michael Reinelt <michael@reinelt.co.at>
  * Copyright (C) 2004 The LCD4Linux Team <lcd4linux-devel@users.sourceforge.net>
  *
  * This file is part of LCD4Linux.
@@ -20,75 +21,6 @@
  * along with this program; if not, write to the Free Software
  * Foundation, Inc., 675 Mass Ave, Cambridge, MA 02139, USA.
  *
- *
- * $Log: drv_BeckmannEgle.c,v $
- * Revision 1.15  2005/05/08 04:32:44  reinelt
- * CodingStyle added and applied
- *
- * Revision 1.14  2005/01/18 06:30:22  reinelt
- * added (C) to all copyright statements
- *
- * Revision 1.13  2004/07/14 04:44:44  reinelt
- *
- * Beckmann+Egle fix
- * added smaple widget for the PPP plugin
- *
- * Revision 1.12  2004/06/29 04:49:30  reinelt
- *
- * B+E enhanced port detection
- *
- * Revision 1.11  2004/06/26 12:04:59  reinelt
- *
- * uh-oh... the last CVS log message messed up things a lot...
- *
- * Revision 1.10  2004/06/26 09:27:20  reinelt
- *
- * added '-W' to CFLAGS
- * changed all C++ comments to C ones
- * cleaned up a lot of signed/unsigned mistakes
- *
- * Revision 1.9  2004/06/26 06:12:15  reinelt
- *
- * support for Beckmann+Egle Compact Terminals
- * some mostly cosmetic changes in the MatrixOrbital and USBLCD driver
- * added debugging to the generic serial driver
- * fixed a bug in the generic text driver where icons could be drawn outside
- * the display bounds
- *
- * Revision 1.8  2004/06/20 10:09:54  reinelt
- *
- * 'const'ified the whole source
- *
- * Revision 1.7  2004/06/06 06:51:59  reinelt
- *
- * do not display end splash screen if quiet=1
- *
- * Revision 1.6  2004/06/05 06:41:39  reinelt
- *
- * chancged splash screen again
- *
- * Revision 1.5  2004/06/05 06:13:11  reinelt
- *
- * splash screen for all text-based display drivers
- *
- * Revision 1.4  2004/06/02 09:41:19  reinelt
- *
- * prepared support for startup splash screen
- *
- * Revision 1.3  2004/06/02 05:14:16  reinelt
- *
- * fixed models listing for Beckmann+Egle driver
- * some cosmetic changes
- *
- * Revision 1.2  2004/05/31 05:38:02  reinelt
- *
- * fixed possible bugs with user-defined chars (clear high bits)
- * thanks to Andy Baxter for debugging the MilfordInstruments driver!
- *
- * Revision 1.1  2004/05/28 14:36:10  reinelt
- *
- * added drv_BeckmannEgle.c (forgotten at first check in :-)
- *
  */
 
 /* 
@@ -420,7 +352,7 @@
     /* read version */
     drv_generic_serial_write(ESC "?V", 3);
     usleep(100000);
-    if ((len = drv_generic_serial_read(buffer, -sizeof(buffer))) > 0) {
+    if ((len = drv_generic_serial_read(buffer, -1 * (int) sizeof(buffer))) > 0) {
 	int v, r, s;
 	if (sscanf(buffer, "V:%d.%d,%d;", &v, &r, &s) != 3) {
 	    error("%s: error parsing display identification <%*s>", Name, len, buffer);
@@ -499,7 +431,7 @@
 	    if (type != NULL) {
 		info("%s: Port %d: %s", Name, i, type);
 	    } else {
-		error("%s: internal error: port % unknown type %d", Name, i, cmd[3]);
+		error("%s: internal error: port %d unknown type %d", Name, i, cmd[3]);
 	    }
 	} else {
 	    error("%s: error fetching type of port %d", Name, i);
@@ -693,6 +625,8 @@
     WIDGET_CLASS wc;
     int ret;
 
+    info("%s: %s", Name, "$Rev: 840 $");
+
     /* start display */
     if ((ret = drv_BuE_start(section)) != 0) {
 	return ret;
@@ -794,8 +728,8 @@
 
 
 DRIVER drv_BeckmannEgle = {
-  name:Name,
-  list:drv_BuE_list,
-  init:drv_BuE_init,
-  quit:drv_BuE_quit,
+    .name = Name,
+    .list = drv_BuE_list,
+    .init = drv_BuE_init,
+    .quit = drv_BuE_quit,
 };
diff -urN lcd4linux-0.10.0/drv_BWCT.c lcd4linux-0.11.0-SVN/drv_BWCT.c
--- lcd4linux-0.10.0/drv_BWCT.c	2005-05-08 06:32:43.000000000 +0200
+++ lcd4linux-0.11.0-SVN/drv_BWCT.c	2008-12-31 08:05:54.000000000 +0100
@@ -1,8 +1,9 @@
-/* $Id: drv_BWCT.c,v 1.3 2005/05/08 04:32:43 reinelt Exp $
+/* $Id: drv_BWCT.c 899 2008-10-07 19:32:42Z bwalle $
+ * $URL: https://ssl.bulix.org/svn/lcd4linux/trunk/drv_BWCT.c $
  *
  * new style driver for BWCT USB LCD displays
  *
- * Copyright (C) 2003 Michael Reinelt <reinelt@eunet.at>
+ * Copyright (C) 2003 Michael Reinelt <michael@reinelt.co.at>
  * Copyright (C) 2004 The LCD4Linux Team <lcd4linux-devel@users.sourceforge.net>
  *
  * This file is part of LCD4Linux.
@@ -21,17 +22,6 @@
  * along with this program; if not, write to the Free Software
  * Foundation, Inc., 675 Mass Ave, Cambridge, MA 02139, USA.
  *
- *
- * $Log: drv_BWCT.c,v $
- * Revision 1.3  2005/05/08 04:32:43  reinelt
- * CodingStyle added and applied
- *
- * Revision 1.2  2005/01/18 06:30:22  reinelt
- * added (C) to all copyright statements
- *
- * Revision 1.1  2004/09/24 21:41:00  reinelt
- * new driver for the BWCT USB LCD interface board.
- *
  */
 
 /* 
@@ -82,7 +72,6 @@
 static usb_dev_handle *lcd;
 static int interface;
 
-extern int usb_debug;
 extern int got_signal;
 
 
@@ -99,7 +88,7 @@
 
     info("%s: scanning USB for BWCT LCD...", Name);
 
-    usb_debug = 0;
+    usb_set_debug(0);
 
     usb_init();
     usb_find_busses();
@@ -108,10 +97,10 @@
 
     for (bus = busses; bus; bus = bus->next) {
 	for (dev = bus->devices; dev; dev = dev->next) {
+	    int c;
 	    if (dev->descriptor.idVendor != LCD_USB_VENDOR)
 		continue;
 	    /* Loop through all of the configurations */
-	    int c;
 	    for (c = 0; c < dev->descriptor.bNumConfigurations; c++) {
 		int i;
 		for (i = 0; i < dev->config[c].bNumInterfaces; i++) {
@@ -258,7 +247,7 @@
     drv_BW_command(0x06);	/* curser moves to right, no shift */
 
 
-    if (cfg_number(section, "Contrast", 0, 0, 100, &contrast) > 0) {
+    if (cfg_number(section, "Contrast", 0, 0, 255, &contrast) > 0) {
 	drv_BW_contrast(contrast);
     }
 
@@ -320,6 +309,8 @@
     int asc255bug;
     int ret;
 
+    info("%s: %s", Name, "$Rev: 899 $");
+
     /* display preferences */
     XRES = 5;			/* pixel width of one char  */
     YRES = 8;			/* pixel height of one char  */
@@ -403,8 +394,8 @@
 
 
 DRIVER drv_BWCT = {
-  name:Name,
-  list:drv_BW_list,
-  init:drv_BW_init,
-  quit:drv_BW_quit,
+    .name = Name,
+    .list = drv_BW_list,
+    .init = drv_BW_init,
+    .quit = drv_BW_quit,
 };
diff -urN lcd4linux-0.10.0/drv.c lcd4linux-0.11.0-SVN/drv.c
--- lcd4linux-0.10.0/drv.c	2005-05-10 15:20:14.000000000 +0200
+++ lcd4linux-0.11.0-SVN/drv.c	2009-01-13 05:54:45.000000000 +0100
@@ -1,8 +1,9 @@
-/* $Id: drv.c,v 1.32 2005/05/10 13:20:14 reinelt Exp $
+/* $Id: drv.c 958 2009-01-13 04:21:29Z michael $
+ * $URL: https://ssl.bulix.org/svn/lcd4linux/trunk/drv.c $
  *
  * new framework for display drivers
  *
- * Copyright (C) 2003 Michael Reinelt <reinelt@eunet.at>
+ * Copyright (C) 2003 Michael Reinelt <michael@reinelt.co.at>
  * Copyright (C) 2004 The LCD4Linux Team <lcd4linux-devel@users.sourceforge.net>
  *
  * This file is part of LCD4Linux.
@@ -21,139 +22,9 @@
  * along with this program; if not, write to the Free Software
  * Foundation, Inc., 675 Mass Ave, Cambridge, MA 02139, USA.
  *
- *
- * $Log: drv.c,v $
- * Revision 1.32  2005/05/10 13:20:14  reinelt
- * added serdisplib driver
- *
- * Revision 1.31  2005/05/08 04:32:43  reinelt
- * CodingStyle added and applied
- *
- * Revision 1.30  2005/05/04 05:42:38  reinelt
- * Noritake driver added
- *
- * Revision 1.29  2005/04/24 04:33:46  reinelt
- * driver for TREFON USB LCD's added
- *
- * Revision 1.28  2005/02/24 07:06:48  reinelt
- * SimpleLCD driver added
- *
- * Revision 1.27  2005/01/30 06:43:22  reinelt
- * driver for LCD-Linux finished
- *
- * Revision 1.26  2005/01/22 22:57:57  reinelt
- * LCD-Linux driver added
- *
- * Revision 1.25  2005/01/18 06:30:22  reinelt
- * added (C) to all copyright statements
- *
- * Revision 1.24  2005/01/15 13:10:15  reinelt
- * LCDTerm driver added
- *
- * Revision 1.23  2004/09/24 21:41:00  reinelt
- * new driver for the BWCT USB LCD interface board.
- *
- * Revision 1.22  2004/08/29 13:03:41  reinelt
- *
- * added RouterBoard driver
- *
- * Revision 1.21  2004/06/26 12:04:59  reinelt
- *
- * uh-oh... the last CVS log message messed up things a lot...
- *
- * Revision 1.20  2004/06/26 09:27:20  reinelt
- *
- * added '-W' to CFLAGS
- * changed all C++ comments to C ones
- * cleaned up a lot of signed/unsigned mistakes
- *
- * Revision 1.19  2004/06/20 10:09:54  reinelt
- *
- * 'const'ified the whole source
- *
- * Revision 1.18  2004/06/06 06:51:59  reinelt
- *
- * do not display end splash screen if quiet=1
- *
- * Revision 1.17  2004/06/02 10:09:22  reinelt
- *
- * splash screen for HD44780
- *
- * Revision 1.16  2004/06/02 09:41:19  reinelt
- *
- * prepared support for startup splash screen
- *
- * Revision 1.15  2004/05/31 16:39:06  reinelt
- *
- * added NULL display driver (for debugging/profiling purposes)
- * added backlight/contrast initialisation for matrixOrbital
- * added Backlight initialisation for Cwlinux
- *
- * Revision 1.14  2004/05/28 13:51:42  reinelt
- *
- * ported driver for Beckmann+Egle Mini-Terminals
- * added 'flags' parameter to serial_init()
- *
- * Revision 1.13  2004/05/26 11:37:36  reinelt
- *
- * Curses driver ported.
- *
- * Revision 1.12  2004/05/26 05:03:27  reinelt
- *
- * MilfordInstruments driver ported
- *
- * Revision 1.11  2004/05/25 19:54:15  reinelt
- *
- * 'make distcheck' bugs fixed
- * release number changed to 0.10.0-RC1
- *
- * Revision 1.10  2004/05/25 14:26:29  reinelt
- *
- * added "Image" driver (was: Raster.c) for PPM and PNG creation
- * fixed some glitches in the X11 driver
- *
- * Revision 1.9  2004/02/24 05:55:04  reinelt
- *
- * X11 driver ported
- *
- * Revision 1.8  2004/02/15 21:43:43  reinelt
- * T6963 driver nearly finished
- * framework for graphic displays done
- * i2c_sensors patch from Xavier
- * some more old generation files removed
- *
- * Revision 1.7  2004/02/15 08:22:47  reinelt
- * ported USBLCD driver to NextGeneration
- * added drv_M50530.c (I forgot yesterday, sorry)
- * removed old drivers M50530.c and USBLCD.c
- *
- * Revision 1.6  2004/02/14 11:56:17  reinelt
- * M50530 driver ported
- * changed lots of 'char' to 'unsigned char'
- *
- * Revision 1.5  2004/01/27 06:34:14  reinelt
- * Cwlinux driver portet to NextGeneration (compiles, but not tested!)
- *
- * Revision 1.4  2004/01/21 12:36:19  reinelt
- * Crystalfontz NextGeneration driver added
- *
- * Revision 1.3  2004/01/20 15:32:49  reinelt
- * first version of Next Generation HD44780 (untested! but it compiles...)
- * some cleanup in the other drivers
- *
- * Revision 1.2  2004/01/10 10:20:22  reinelt
- * new MatrixOrbital changes
- *
- * Revision 1.1  2004/01/09 17:03:07  reinelt
- * initiated transfer to new driver architecture
- * new file 'drv.c' will someday replace 'display.c'
- * new file 'drv_MatrixOrbital.c' will replace 'MatrixOrbital.c'
- * due to this 'soft' transfer lcd4linux should stay usable during the switch
- * (at least I hope so)
- *
  */
 
-/* 
+/*
  * exported functions:
  *
  * drv_list (void)
@@ -162,27 +33,6 @@
  * drv_init (char *driver)
  *    initializes the named driver
  *
- * drv_query (int *rows, int *cols, int *xres, int *yres, int *bars, int *gpos)
- *    queries the attributes of the selected driver
- *
- * drv_clear ()
- *    clears the display
- *
- * int drv_put (int row, int col, char *text)
- *    writes text at row, col
- *
- * int drv_bar (int type, int row, int col, int max, int len1, int len2)
- *    draws a specified bar at row, col with len
- *
- * int drv_icon (int num, int seq, int row, int col)
- *    draws icon #num sequence #seq at row, col
- *
- * int drv_gpo (int num, int val)
- *    sets GPO #num to val
- *
- * int drv_flush (void)
- *    flushes the framebuffer to the display
- *
  * int drv_quit (void)
  *    de-initializes the driver
  */
@@ -202,21 +52,38 @@
 extern DRIVER drv_Crystalfontz;
 extern DRIVER drv_Curses;
 extern DRIVER drv_Cwlinux;
+extern DRIVER drv_D4D;
+extern DRIVER drv_EA232graphic;
+extern DRIVER drv_G15;
 extern DRIVER drv_HD44780;
 extern DRIVER drv_Image;
+extern DRIVER drv_IRLCD;
+extern DRIVER drv_LCD2USB;
 extern DRIVER drv_LCDLinux;
 extern DRIVER drv_LCDTerm;
+extern DRIVER drv_LEDMatrix;
+extern DRIVER drv_LPH7508;
+extern DRIVER drv_LUIse;
 extern DRIVER drv_M50530;
 extern DRIVER drv_MatrixOrbital;
 extern DRIVER drv_MilfordInstruments;
 extern DRIVER drv_Noritake;
 extern DRIVER drv_NULL;
+extern DRIVER drv_Pertelian;
+extern DRIVER drv_PHAnderson;
+extern DRIVER drv_picoLCD;
+extern DRIVER drv_picoLCDGraphic;
 extern DRIVER drv_RouterBoard;
+extern DRIVER drv_Sample;
+extern DRIVER drv_st2205;
 extern DRIVER drv_serdisplib;
 extern DRIVER drv_SimpleLCD;
 extern DRIVER drv_T6963;
 extern DRIVER drv_Trefon;
+extern DRIVER drv_ula200;
+extern DRIVER drv_USBHUB;
 extern DRIVER drv_USBLCD;
+extern DRIVER drv_WincorNixdorf;
 extern DRIVER drv_X11;
 
 /* output file for Image driver
@@ -235,24 +102,48 @@
 #ifdef WITH_CRYSTALFONTZ
     &drv_Crystalfontz,
 #endif
+#ifdef WITH_CURSES
+    &drv_Curses,
+#endif
 #ifdef WITH_CWLINUX
     &drv_Cwlinux,
 #endif
-#ifdef WITH_CURSES
-    &drv_Curses,
+#ifdef WITH_D4D
+    &drv_D4D,
+#endif
+#ifdef WITH_EA232graphic
+    &drv_EA232graphic,
+#endif
+#ifdef WITH_G15
+    &drv_G15,
 #endif
 #ifdef WITH_HD44780
     &drv_HD44780,
 #endif
-#if defined (WITH_PNG) || defined(WITH_PPM)
+#if (defined(WITH_PNG) && defined(WITH_GD)) || defined(WITH_PPM)
     &drv_Image,
 #endif
+#ifdef WITH_IRLCD
+    &drv_IRLCD,
+#endif
+#ifdef WITH_LCD2USB
+    &drv_LCD2USB,
+#endif
 #ifdef WITH_LCDLINUX
     &drv_LCDLinux,
 #endif
 #ifdef WITH_LCDTERM
     &drv_LCDTerm,
 #endif
+#ifdef WITH_LEDMATRIX
+    &drv_LEDMatrix,
+#endif
+#ifdef WITH_LPH7508
+    &drv_LPH7508,
+#endif
+#ifdef WITH_LUISE
+    &drv_LUIse,
+#endif
 #ifdef WITH_M50530
     &drv_M50530,
 #endif
@@ -268,9 +159,27 @@
 #ifdef WITH_NULL
     &drv_NULL,
 #endif
+#ifdef WITH_PERTELIAN
+    &drv_Pertelian,
+#endif
+#ifdef WITH_PHANDERSON
+    &drv_PHAnderson,
+#endif
+#ifdef WITH_PICOLCD
+    &drv_picoLCD,
+#endif
+#ifdef WITH_PICOLCDGRAPHIC
+    &drv_picoLCDGraphic,
+#endif
 #ifdef WITH_ROUTERBOARD
     &drv_RouterBoard,
 #endif
+#ifdef WITH_SAMPLE
+    &drv_Sample,
+#endif
+#ifdef WITH_ST2205
+    &drv_st2205,
+#endif
 #ifdef WITH_SERDISPLIB
     &drv_serdisplib,
 #endif
@@ -283,9 +192,18 @@
 #ifdef WITH_TREFON
     &drv_Trefon,
 #endif
+#ifdef WITH_ULA200
+    &drv_ula200,
+#endif
+#ifdef WITH_USBHUB
+    &drv_USBHUB,
+#endif
 #ifdef WITH_USBLCD
     &drv_USBLCD,
 #endif
+#ifdef WITH_WINCORNIXDORF
+    &drv_WincorNixdorf,
+#endif
 #ifdef WITH_X11
     &drv_X11,
 #endif
@@ -297,6 +215,10 @@
 static DRIVER *Drv = NULL;
 
 
+/* maybe we need this */
+extern int drv_SD_list_verbose(void);
+
+
 int drv_list(void)
 {
     int i;
@@ -309,6 +231,12 @@
 	    Driver[i]->list();
     }
     printf("\n");
+
+#ifdef WITH_SERDISPLIB
+    printf("\n");
+    drv_SD_list_verbose();
+#endif
+
     return 0;
 }
 
diff -urN lcd4linux-0.10.0/drv_Crystalfontz.c lcd4linux-0.11.0-SVN/drv_Crystalfontz.c
--- lcd4linux-0.10.0/drv_Crystalfontz.c	2005-05-08 06:32:44.000000000 +0200
+++ lcd4linux-0.11.0-SVN/drv_Crystalfontz.c	2008-12-31 08:05:54.000000000 +0100
@@ -1,8 +1,9 @@
-/* $Id: drv_Crystalfontz.c,v 1.34 2005/05/08 04:32:44 reinelt Exp $
+/* $Id: drv_Crystalfontz.c 906 2008-12-23 14:55:32Z michael $
+ * $URL: https://ssl.bulix.org/svn/lcd4linux/trunk/drv_Crystalfontz.c $
  *
  * new style driver for Crystalfontz display modules
  *
- * Copyright (C) 1999, 2000 Michael Reinelt <reinelt@eunet.at>
+ * Copyright (C) 1999, 2000 Michael Reinelt <michael@reinelt.co.at>
  * Copyright (C) 2004 The LCD4Linux Team <lcd4linux-devel@users.sourceforge.net>
  *
  * This file is part of LCD4Linux.
@@ -21,142 +22,6 @@
  * along with this program; if not, write to the Free Software
  * Foundation, Inc., 675 Mass Ave, Cambridge, MA 02139, USA.
  *
- *
- * $Log: drv_Crystalfontz.c,v $
- * Revision 1.34  2005/05/08 04:32:44  reinelt
- * CodingStyle added and applied
- *
- * Revision 1.33  2005/04/02 05:28:58  reinelt
- * fixed gcc4 warnings about signed/unsigned mismatches
- *
- * Revision 1.32  2005/03/23 12:23:35  reinelt
- * fixed some signed/unsigned char mismatches in the Crystalfontz driver (ticket #12)
- *
- * Revision 1.31  2005/02/24 07:06:48  reinelt
- * SimpleLCD driver added
- *
- * Revision 1.30  2005/01/18 06:30:22  reinelt
- * added (C) to all copyright statements
- *
- * Revision 1.29  2004/06/26 12:04:59  reinelt
- *
- * uh-oh... the last CVS log message messed up things a lot...
- *
- * Revision 1.28  2004/06/26 09:27:20  reinelt
- *
- * added '-W' to CFLAGS
- * changed all C++ comments to C ones
- * cleaned up a lot of signed/unsigned mistakes
- *
- * Revision 1.27  2004/06/20 10:09:54  reinelt
- *
- * 'const'ified the whole source
- *
- * Revision 1.26  2004/06/06 06:51:59  reinelt
- *
- * do not display end splash screen if quiet=1
- *
- * Revision 1.25  2004/06/05 06:41:39  reinelt
- *
- * chancged splash screen again
- *
- * Revision 1.24  2004/06/05 06:13:11  reinelt
- *
- * splash screen for all text-based display drivers
- *
- * Revision 1.23  2004/06/02 09:41:19  reinelt
- *
- * prepared support for startup splash screen
- *
- * Revision 1.22  2004/06/02 05:56:25  reinelt
- *
- * extended contrast range for Crystalfontz
- *
- * Revision 1.21  2004/06/01 06:45:28  reinelt
- *
- * some Fixme's processed
- * documented some code
- *
- * Revision 1.20  2004/05/31 05:38:02  reinelt
- *
- * fixed possible bugs with user-defined chars (clear high bits)
- * thanks to Andy Baxter for debugging the MilfordInstruments driver!
- *
- * Revision 1.19  2004/05/30 08:25:50  reinelt
- *
- * Crystalfontz 631 driver finished
- *
- * Revision 1.18  2004/05/28 13:51:42  reinelt
- *
- * ported driver for Beckmann+Egle Mini-Terminals
- * added 'flags' parameter to serial_init()
- *
- * Revision 1.17  2004/05/27 03:39:47  reinelt
- *
- * changed function naming scheme to plugin::function
- *
- * Revision 1.16  2004/05/26 11:37:36  reinelt
- *
- * Curses driver ported.
- *
- * Revision 1.15  2004/05/25 14:26:29  reinelt
- *
- * added "Image" driver (was: Raster.c) for PPM and PNG creation
- * fixed some glitches in the X11 driver
- *
- * Revision 1.14  2004/03/19 09:17:46  reinelt
- *
- * removed the extra 'goto' function, row and col are additional parameters
- * of the write() function now.
- *
- * Revision 1.13  2004/03/03 03:41:02  reinelt
- * Crystalfontz Contrast issue fixed
- *
- * Revision 1.12  2004/03/01 04:29:51  reinelt
- * cfg_number() returns -1 on error, 0 if value not found (but default val used),
- *  and 1 if value was used from the configuration.
- * HD44780 driver adopted to new cfg_number()
- * Crystalfontz 631 driver nearly finished
- *
- * Revision 1.11  2004/02/14 11:56:17  reinelt
- * M50530 driver ported
- * changed lots of 'char' to 'unsigned char'
- *
- * Revision 1.10  2004/02/05 07:10:23  reinelt
- * evaluator function names are no longer case-sensitive
- * Crystalfontz Fan PWM control, Fan RPM monitoring, temperature monitoring
- *
- * Revision 1.9  2004/02/04 19:10:51  reinelt
- * Crystalfontz driver nearly finished
- *
- * Revision 1.8  2004/02/01 08:05:12  reinelt
- * Crystalfontz 633 extensions (CRC checking and stuff)
- * Models table for HD44780
- * Noritake VFD BVrightness patch from Bill Paxton
- *
- * Revision 1.7  2004/01/30 20:57:56  reinelt
- * HD44780 patch from Martin Hejl
- * dmalloc integrated
- *
- * Revision 1.6  2004/01/29 04:40:02  reinelt
- * every .c file includes "config.h" now
- *
- * Revision 1.5  2004/01/25 05:30:09  reinelt
- * plugin_netdev for parsing /proc/net/dev added
- *
- * Revision 1.4  2004/01/23 07:04:03  reinelt
- * icons finished!
- *
- * Revision 1.3  2004/01/23 04:53:34  reinelt
- * icon widget added (not finished yet!)
- *
- * Revision 1.2  2004/01/22 07:57:45  reinelt
- * several bugs fixed where segfaulting on layout>display
- * Crystalfontz driver optimized, 632 display already works
- *
- * Revision 1.1  2004/01/21 12:36:19  reinelt
- * Crystalfontz NextGeneration driver added
- *
  */
 
 /* 
@@ -173,19 +38,24 @@
 #include <stdio.h>
 #include <string.h>
 #include <unistd.h>
+#include <sys/time.h>
 
 #include "debug.h"
 #include "cfg.h"
 #include "qprintf.h"
+#include "thread.h"
 #include "timer.h"
 #include "plugin.h"
 #include "widget.h"
 #include "widget_text.h"
 #include "widget_icon.h"
 #include "widget_bar.h"
+#include "widget_keypad.h"
 #include "drv.h"
 #include "drv_generic_text.h"
+#include "drv_generic_gpio.h"
 #include "drv_generic_serial.h"
+#include "drv_generic_keypad.h"
 
 
 static char Name[] = "Crystalfontz";
@@ -202,6 +72,7 @@
 /* packet from the display */
 struct {
     unsigned char type;
+    unsigned char code;
     unsigned char size;
     unsigned char data[16 + 1];	/* trailing '\0' */
 } Packet;
@@ -216,32 +87,30 @@
 static double Temperature[32] = { 0.0, };
 
 
-/* Fixme: GPO's not yet implemented */
-/* static int GPO[8]; */
-static int GPOS;
-
-
 typedef struct {
     int type;
     char *name;
     int rows;
     int cols;
+    int gpis;
     int gpos;
     int protocol;
     int payload;
 } MODEL;
 
-/* Fixme #1: number of gpo's should be verified */
+/* Fixme #1: number of GPI's & GPO's should be verified */
 /* Fixme #2: protocol should be verified */
+/* Fixme #3: number of keys on the keypad should be verified */
 
 static MODEL Models[] = {
-    {626, "626", 2, 16, 0, 1, 0},
-    {631, "631", 2, 20, 0, 3, 22},
-    {632, "632", 2, 16, 0, 1, 0},
-    {633, "633", 2, 16, 0, 2, 18},
-    {634, "634", 4, 20, 0, 1, 0},
-    {636, "636", 2, 16, 0, 1, 0},
-    {-1, "Unknown", -1, -1, 0, 0, 0}
+    {626, "626", 2, 16, 0, 0, 1, 0},
+    {631, "631", 2, 20, 4, 0, 3, 22},
+    {632, "632", 2, 16, 0, 0, 1, 0},
+    {633, "633", 2, 16, 4, 4, 2, 18},
+    {634, "634", 4, 20, 0, 0, 1, 0},
+    {635, "635", 4, 20, 4, 12, 3, 22},
+    {636, "636", 2, 16, 0, 0, 1, 0},
+    {-1, "Unknown", -1, -1, 0, 0, 0, 0}
 };
 
 
@@ -288,37 +157,64 @@
 
     switch (Packet.type) {
 
-    case 0x80:			/* Key Activity */
-	debug("Key Activity: %d", Packet.data[0]);
-	break;
+    case 0x02:
 
-    case 0x81:			/* Fan Speed Report */
-	if (Packet.data[1] == 0xff) {
-	    Fan_RPM[Packet.data[0]] = -1.0;
-	} else if (Packet.data[1] < 4) {
-	    Fan_RPM[Packet.data[0]] = 0.0;
-	} else {
-	    Fan_RPM[Packet.data[0]] = (double) 27692308L *(Packet.data[1] - 3) / (Packet.data[2] + 256 * Packet.data[3]);
-	}
-	break;
+	/* async response from display to host */
+	switch (Packet.code) {
 
-    case 0x82:			/* Temperature Sensor Report */
-	switch (Packet.data[3]) {
-	case 0:
-	    error("%s: 1-Wire device #%d: CRC error", Name, Packet.data[0]);
+	case 0x00:
+	    /* Key Activity */
+	    debug("Key Activity: %d", Packet.data[0]);
+	    drv_generic_keypad_press(Packet.data[0]);
 	    break;
-	case 1:
-	case 2:
-	    Temperature[Packet.data[0]] = (Packet.data[1] + 256 * Packet.data[2]) / 16.0;
+
+	case 0x01:
+	    /* Fan Speed Report */
+	    if (Packet.data[1] == 0xff) {
+		Fan_RPM[Packet.data[0]] = -1.0;
+	    } else if (Packet.data[1] < 4) {
+		Fan_RPM[Packet.data[0]] = 0.0;
+	    } else {
+		Fan_RPM[Packet.data[0]] =
+		    (double) 27692308L *(Packet.data[1] - 3) / (Packet.data[2] + 256 * Packet.data[3]);
+	    }
 	    break;
+
+	case 0x02:
+	    /* Temperature Sensor Report */
+	    switch (Packet.data[3]) {
+	    case 0:
+		error("%s: 1-Wire device #%d: CRC error", Name, Packet.data[0]);
+		break;
+	    case 1:
+	    case 2:
+		Temperature[Packet.data[0]] = (Packet.data[1] + 256 * Packet.data[2]) / 16.0;
+		break;
+	    default:
+		error("%s: 1-Wire device #%d: unknown CRC status %d", Name, Packet.data[0], Packet.data[3]);
+		break;
+	    }
+	    break;
+
 	default:
-	    error("%s: 1-Wire device #%d: unknown CRC status %d", Name, Packet.data[0], Packet.data[3]);
+	    /* this should not happen */
+	    error("%s: unexpected response type=0x%02x code=0x%02x size=%d", Name, Packet.type, Packet.code,
+		  Packet.size);
 	    break;
 	}
+
+	break;
+
+    case 0x03:
+	/* error response from display to host */
+	error("%s: error response type=0x%02x code=0x%02x size=%d", Name, Packet.type, Packet.code, Packet.size);
 	break;
 
     default:
-	/* just ignore packet */
+	/* these should not happen: */
+	/* type 0x00: command from host to display: should never come back */
+	/* type 0x01: command response from display to host: are processed within send() */
+	error("%s: unexpected packet type=0x%02x code=0x%02x size=%d", Name, Packet.type, Packet.code, Packet.size);
 	break;
     }
 
@@ -375,7 +271,8 @@
 	if (MSB(crc) != buffer[size + 3])
 	    goto GARBAGE;
 	/* process packet */
-	Packet.type = buffer[0];
+	Packet.type = buffer[0] >> 6;
+	Packet.code = buffer[0] & 0x3f;
 	Packet.size = size;
 	memcpy(Packet.data, buffer + 2, size);
 	Packet.data[size] = '\0';	/* trailing zero */
@@ -406,14 +303,16 @@
 }
 
 
-static void drv_CF_send(const int cmd, int len, const unsigned char *data)
+static void drv_CF_send(const unsigned char cmd, const unsigned char len, const unsigned char *data)
 {
-    unsigned char buffer[22];
+    /* 1 cmd + 1 len + 22 payload + 2 crc = 26 */
+    unsigned char buffer[26];
     unsigned short crc;
+    struct timeval now, end;
 
     if (len > Payload) {
 	error("%s: internal error: packet length %d exceeds payload size %d", Name, len, Payload);
-	len = sizeof(buffer) - 1;
+	return;
     }
 
     buffer[0] = cmd;
@@ -423,12 +322,114 @@
     buffer[len + 2] = LSB(crc);
     buffer[len + 3] = MSB(crc);
 
-#if 0
-    debug("Tx Packet %d len=%d", buffer[0], buffer[1]);
-#endif
-
     drv_generic_serial_write((char *) buffer, len + 4);
 
+    /* wait for acknowledge packet */
+    gettimeofday(&now, NULL);
+    while (1) {
+	/* delay 1 msec */
+	usleep(1 * 1000);
+	if (drv_CF_poll()) {
+	    if (Packet.type == 0x01 && Packet.code == cmd) {
+		/* this is the ack we're waiting for */
+		if (0) {
+		    gettimeofday(&end, NULL);
+		    debug("%s: ACK after %ld usec", Name,
+			  1000000 * (end.tv_sec - now.tv_sec) + end.tv_usec - now.tv_usec);
+		}
+		break;
+	    } else {
+		/* some other (maybe async) packet, just process it */
+		drv_CF_process_packet();
+	    }
+	}
+	gettimeofday(&end, NULL);
+	/* don't wait more than 250 msec */
+	if ((1000000 * (end.tv_sec - now.tv_sec) + end.tv_usec - now.tv_usec) > 250 * 1000) {
+	    error("%s: timeout waiting for response to cmd 0x%02x", Name, cmd);
+	    break;
+	}
+    }
+}
+
+
+/* check http://www.crystalfontz.com/products/634/cgrom.html */
+/* HINT: the input should using the ISO-8859-1 charset */
+void convertToCgrom2(char *str)
+{
+    unsigned int i;
+    for (i = 0; i < strlen(str); i++) {
+	switch ((unsigned char) str[i]) {
+	case 0x5d:		/* ] */
+	    str[i] = 252;
+	    break;
+	case 0x5b:		/* [ */
+	    str[i] = 250;
+	    break;
+	case 0x24:		/* $ */
+	    str[i] = 162;
+	    break;
+	case 0x40:		/* @ */
+	    str[i] = 160;
+	    break;
+	case 0x5c:		/* \ */
+	    str[i] = 251;
+	    break;
+	case 0x7b:		/* { */
+	    str[i] = 253;
+	    break;
+	case 0x7d:		/* } */
+	    str[i] = 255;
+	    break;
+	case 0x7c:
+	    str[i] = 254;	/* pipe */
+	    break;
+	case 0x27:
+	case 0x60:
+	case 0xB4:
+	    str[i] = 39;	/* ' */
+	    break;
+	case 0xe8:
+	    str[i] = 164;	/* french e */
+	    break;
+	case 0xe9:
+	    str[i] = 165;	/* french e */
+	    break;
+	case 0xc8:
+	    str[i] = 197;	/* french E */
+	    break;
+	case 0xc9:
+	    str[i] = 207;	/* french E */
+	    break;
+
+	case 0xe4:
+	    str[i] = 123;	/* small german ae */
+	    break;
+	case 0xc4:
+	    str[i] = 91;	/* big german ae */
+	    break;
+	case 0xf6:
+	    str[i] = 124;	/* small german oe */
+	    break;
+	case 0xd6:
+	    str[i] = 92;	/* big german oe */
+	    break;
+	case 0xfc:
+	    str[i] = 126;	/* small german ue */
+	    break;
+	case 0xdc:
+	    str[i] = 94;	/* big german ue */
+	    break;
+	case 0x5e:		/* ^ */
+	    str[i] = 253;
+	    break;
+	case 0x5f:		/* _ */
+	    str[i] = 254;
+	    break;
+	default:
+	    break;
+	}
+    }
 }
 
 
@@ -444,6 +445,11 @@
 	drv_generic_serial_write(cmd, 3);
     }
 
+    /* Model 634 and 632 use another ROM */
+    if (Model == 4 || Model == 2) {
+	convertToCgrom2((char *) data);
+    }
+
     drv_generic_serial_write(data, len);
 }
 
@@ -474,13 +480,13 @@
     unsigned char cmd[23];
 
     /* limit length */
-    if (col + l > 20)
-	l = 20 - col;
+    if (col + l > DCOLS)
+	l = DCOLS - col;
     if (l < 0)
 	l = 0;
 
     /* sanity check */
-    if (row >= 2 || col + l > 20) {
+    if (row >= DROWS || col + l > DCOLS) {
 	error("%s: internal error: write outside display bounds!", Name);
 	return;
     }
@@ -490,7 +496,6 @@
     memcpy(cmd + 2, data, l);
 
     drv_CF_send(31, l + 2, cmd);
-
 }
 
 
@@ -601,40 +606,110 @@
 }
 
 
-static int drv_CF_fan_pwm(int fan, int power)
+static int drv_CF_keypad(const int num)
 {
-    static unsigned char PWM[4] = { 100, };
+    int val = 0;
 
-    /* sanity check */
-    if (fan < 1 || fan > 4)
-	return -1;
+    switch (Protocol) {
+    case 1:
+    case 2:
+	break;
+    case 3:
+	if ((num < 7) || ((num > 12) && (num < 17)))
+	    val = WIDGET_KEY_PRESSED;
+	else
+	    val = WIDGET_KEY_RELEASED;
+	switch (num) {
+	case 1:
+	case 7:
+	    val += WIDGET_KEY_UP;
+	    break;
+	case 2:
+	case 8:
+	    val += WIDGET_KEY_DOWN;
+	    break;
+	case 3:
+	case 9:
+	    val += WIDGET_KEY_LEFT;
+	    break;
+	case 4:
+	case 10:
+	    val += WIDGET_KEY_RIGHT;
+	    break;
+	case 5:
+	case 11:
+	    val += WIDGET_KEY_CONFIRM;
+	    break;
+	case 6:
+	case 12:
+	    val += WIDGET_KEY_CANCEL;
+	    break;
 
-    /* fan ranges from 1 to 4 */
-    fan--;
+	    /* added for 631, too lazy to make new WIDGET_KEY defines */
+	case 13:
+	case 17:
+	    val += WIDGET_KEY_UP;	/* really UPLEFT */
+	    break;
+	case 14:
+	case 18:
+	    val += WIDGET_KEY_RIGHT;	/* really UPRIGHT */
+	    break;
+	case 15:
+	case 19:
+	    val += WIDGET_KEY_LEFT;	/* really DOWNLEFT */
+	    break;
+	case 16:
+	case 20:
+	    val += WIDGET_KEY_DOWN;	/* really DOWNRIGHT */
+	    break;
+	}
+	break;
+    }
+
+    return val;
+}
 
-    /* -1 is used to query the current power */
-    if (power == -1)
-	return PWM[fan];
-
-    if (power < 0)
-	power = 0;
-    if (power > 100)
-	power = 100;
-    PWM[fan] = power;
+
+static int drv_CF_GPI(const int num)
+{
+    if (num < 0 || num > 3) {
+	return 0;
+    }
+    return Fan_RPM[num];
+}
+
+
+static int drv_CF_GPO(const int num, const int val)
+{
+    static unsigned char PWM2[4] = { 0, 0, 0, 0 };
+    static unsigned char PWM3[2];
+
+    int v = val;
+
+    if (v < 0)
+	v = 0;
+    if (v > 100)
+	v = 100;
 
     switch (Protocol) {
     case 2:
-	drv_CF_send(17, 4, PWM);
+	PWM2[num] = v;
+	drv_CF_send(17, 4, PWM2);
+	break;
+    case 3:
+	PWM3[0] = num + 1;
+	PWM3[1] = v;
+	drv_CF_send(34, 2, PWM3);
 	break;
     }
 
-    return PWM[fan];
+    return v;
 }
 
 
 static int drv_CF_autodetect(void)
 {
-    int i, m;
+    int m;
 
     /* only autodetect newer displays */
     if (Protocol < 2)
@@ -643,42 +718,29 @@
     /* read display type */
     drv_CF_send(1, 0, NULL);
 
-    i = 0;
-    while (1) {
-	/* wait 10 msec */
-	usleep(10 * 1000);
-	/* packet available? */
-	if (drv_CF_poll()) {
-	    /* display type */
-	    if (Packet.type == 0x41) {
-		char t[7], c;
-		float h, v;
-		info("%s: display identifies itself as '%s'", Name, Packet.data);
-		if (sscanf((char *) Packet.data, "%6s:h%f,%c%f", t, &h, &c, &v) != 4) {
-		    error("%s: error parsing display identification string", Name);
-		    return -1;
-		}
-		info("%s: display type '%s', hardware version %3.1f, firmware version %c%3.1f", Name, t, h, c, v);
-		if (strncmp(t, "CFA", 3) == 0) {
-		    for (m = 0; Models[m].type != -1; m++) {
-			/* omit the 'CFA' */
-			if (strcasecmp(Models[m].name, t + 3) == 0)
-			    return m;
-		    }
-		}
-		error("%s: display type '%s' may be not supported!", Name, t);
-		return -1;
-	    }
-	    drv_CF_process_packet();
-	}
-	/* wait no longer than 300 msec */
-	if (++i > 30) {
-	    error("%s: display detection timed out", Name);
+    /* send() did already wait for response packet */
+    if (Packet.type == 0x01 && Packet.code == 0x01) {
+	char t[7], c;
+	float h, v;
+	info("%s: display identifies itself as '%s'", Name, Packet.data);
+	if (sscanf((char *) Packet.data, "%6s:h%f,%c%f", t, &h, &c, &v) != 4) {
+	    error("%s: error parsing display identification string", Name);
 	    return -1;
 	}
+	info("%s: display type '%s', hardware version %3.1f, firmware version %c%3.1f", Name, t, h, c, v);
+	if (strncmp(t, "CFA", 3) == 0) {
+	    for (m = 0; Models[m].type != -1; m++) {
+		/* omit the 'CFA' */
+		if (strcasecmp(Models[m].name, t + 3) == 0)
+		    return m;
+	    }
+	}
+	error("%s: display type '%s' may be not supported!", Name, t);
+	return -1;
     }
 
-    /* not reached */
+    error("%s: display detection failed!", Name);
+
     return -1;
 }
 
@@ -688,7 +750,8 @@
     static char buffer[17];
 
     snprintf(buffer, sizeof(buffer), "0x%02x%02x%02x%02x%02x%02x%02x%02x",
-	     Packet.data[1], Packet.data[2], Packet.data[3], Packet.data[4], Packet.data[5], Packet.data[6], Packet.data[7], Packet.data[8]);
+	     Packet.data[1], Packet.data[2], Packet.data[3], Packet.data[4], Packet.data[5], Packet.data[6],
+	     Packet.data[7], Packet.data[8]);
 
     return buffer;
 }
@@ -708,16 +771,18 @@
 	/* packet available? */
 	if (drv_CF_poll()) {
 	    /* DOW Device Info */
-	    if (Packet.type == 0x52) {
+	    if (Packet.type == 0x01 && Packet.code == 0x12) {
 		switch (Packet.data[1]) {
 		case 0x00:
 		    /* no device found */
 		    return 0;
 		case 0x22:
-		    info("%s: 1-Wire device #%d: DS1822 temperature sensor found at %s", Name, Packet.data[0], drv_CF_print_ROM());
+		    info("%s: 1-Wire device #%d: DS1822 temperature sensor found at %s", Name, Packet.data[0],
+			 drv_CF_print_ROM());
 		    return 1;
 		case 0x28:
-		    info("%s: 1-Wire device #%d: DS18B20 temperature sensor found at %s", Name, Packet.data[0], drv_CF_print_ROM());
+		    info("%s: 1-Wire device #%d: DS18B20 temperature sensor found at %s", Name, Packet.data[0],
+			 drv_CF_print_ROM());
 		    return 1;
 		default:
 		    info("%s: 1-Wire device #%d: unknown device found at %s", Name, Packet.data[0], drv_CF_print_ROM());
@@ -858,13 +923,15 @@
 	return -1;
     }
     if (i != -1 && Model != i) {
-	error("%s: %s.Model '%s' from %s does not match detected model '%s'", Name, section, model, cfg_source(), Models[i].name);
+	error("%s: %s.Model '%s' from %s does not match detected model '%s'", Name, section, model, cfg_source(),
+	      Models[i].name);
 	return -1;
     }
 
     /* initialize global variables */
     DROWS = Models[Model].rows;
     DCOLS = Models[Model].cols;
+    GPIS = Models[Model].gpis;
     GPOS = Models[Model].gpos;
     Protocol = Models[Model].protocol;
     Payload = Models[Model].payload;
@@ -946,31 +1013,12 @@
 	SetResult(&result, R_NUMBER, &backlight);
 	break;
     default:
-	error("%s.backlight(): wrong number of parameters");
+	error("%s.backlight(): wrong number of parameters", Name);
 	SetResult(&result, R_STRING, "");
     }
 }
 
 
-static void plugin_fan_pwm(RESULT * result, const int argc, RESULT * argv[])
-{
-    double pwm;
-
-    switch (argc) {
-    case 1:
-	pwm = drv_CF_fan_pwm(R2N(argv[0]), -1);
-	SetResult(&result, R_NUMBER, &pwm);
-	break;
-    case 2:
-	pwm = drv_CF_fan_pwm(R2N(argv[0]), R2N(argv[1]));
-	SetResult(&result, R_NUMBER, &pwm);
-	break;
-    default:
-	error("%s.pwm(): wrong number of parameters");
-	SetResult(&result, R_STRING, "");
-    }
-}
-
 /* Fixme: other plugins for Fans, Temperature sensors, ... */
 
 
@@ -982,6 +1030,8 @@
 /* using drv_generic_text_draw(W) */
 /* using drv_generic_text_icon_draw(W) */
 /* using drv_generic_text_bar_draw(W) */
+/* using drv_generic_gpio_draw(W) */
+/* using drv_generic_keypad_draw(W) */
 
 
 /****************************************/
@@ -1007,6 +1057,8 @@
     WIDGET_CLASS wc;
     int ret;
 
+    info("%s: %s", Name, "$Rev: 906 $");
+
     /* start display */
     if ((ret = drv_CF_start(section)) != 0) {
 	return ret;
@@ -1030,12 +1082,17 @@
 	GOTO_COST = -1;		/* there is no goto on 633 */
 	drv_generic_text_real_write = drv_CF_write2;
 	drv_generic_text_real_defchar = drv_CF_defchar23;
+	drv_generic_gpio_real_get = drv_CF_GPI;
+	drv_generic_gpio_real_set = drv_CF_GPO;
 	break;
     case 3:
 	CHAR0 = 0;		/* ASCII of first user-defineable char */
 	GOTO_COST = 3;		/* number of bytes a goto command requires */
 	drv_generic_text_real_write = drv_CF_write3;
 	drv_generic_text_real_defchar = drv_CF_defchar23;
+	drv_generic_gpio_real_get = drv_CF_GPI;
+	drv_generic_gpio_real_set = drv_CF_GPO;
+	drv_generic_keypad_real_press = drv_CF_keypad;
 	break;
     }
 
@@ -1065,6 +1122,14 @@
     if (Protocol == 2)
 	drv_generic_text_bar_add_segment(255, 255, 255, 255);	/* ASCII 255 = block */
 
+    /* initialize generic GPIO driver */
+    if ((ret = drv_generic_gpio_init(section, Name)) != 0)
+	return ret;
+
+    /* initialize generic key pad driver */
+    if ((ret = drv_generic_keypad_init(section, Name)) != 0)
+	return ret;
+
     /* register text widget */
     wc = Widget_Text;
     wc.draw = drv_generic_text_draw;
@@ -1083,9 +1148,6 @@
     /* register plugins */
     AddFunction("LCD::contrast", -1, plugin_contrast);
     AddFunction("LCD::backlight", -1, plugin_backlight);
-    if (Protocol == 2) {
-	AddFunction("LCD::fan_pwm", -1, plugin_fan_pwm);
-    }
 
     return 0;
 }
@@ -1095,9 +1157,11 @@
 int drv_CF_quit(const int quiet)
 {
 
-    info("%s: shutting down.", Name);
+    info("%s: shutting down display.", Name);
 
     drv_generic_text_quit();
+    drv_generic_gpio_quit();
+    drv_generic_keypad_quit();
 
     /* clear display */
     drv_CF_clear();
@@ -1114,8 +1178,8 @@
 
 
 DRIVER drv_Crystalfontz = {
-  name:Name,
-  list:drv_CF_list,
-  init:drv_CF_init,
-  quit:drv_CF_quit,
+    .name = Name,
+    .list = drv_CF_list,
+    .init = drv_CF_init,
+    .quit = drv_CF_quit,
 };
diff -urN lcd4linux-0.10.0/drv_Curses.c lcd4linux-0.11.0-SVN/drv_Curses.c
--- lcd4linux-0.10.0/drv_Curses.c	2005-05-08 06:32:44.000000000 +0200
+++ lcd4linux-0.11.0-SVN/drv_Curses.c	2008-12-31 08:05:54.000000000 +0100
@@ -1,8 +1,9 @@
-/* $Id: drv_Curses.c,v 1.10 2005/05/08 04:32:44 reinelt Exp $
+/* $Id: drv_Curses.c 840 2007-09-09 12:17:42Z michael $
+ * $URL: https://ssl.bulix.org/svn/lcd4linux/trunk/drv_Curses.c $
  *
  * pure ncurses based text driver
  *
- * Copyright (C) 2004 Michael Reinelt <reinelt@eunet.at>
+ * Copyright (C) 2004 Michael Reinelt <michael@reinelt.co.at>
  * Copyright (C) 2004 The LCD4Linux Team <lcd4linux-devel@users.sourceforge.net>
  *
  * based on the old Curses/Text driver which is
@@ -24,48 +25,6 @@
  * along with this program; if not, write to the Free Software
  * Foundation, Inc., 675 Mass Ave, Cambridge, MA 02139, USA.
  *
- *
- * $Log: drv_Curses.c,v $
- * Revision 1.10  2005/05/08 04:32:44  reinelt
- * CodingStyle added and applied
- *
- * Revision 1.9  2005/01/18 06:30:22  reinelt
- * added (C) to all copyright statements
- *
- * Revision 1.8  2004/06/26 12:04:59  reinelt
- *
- * uh-oh... the last CVS log message messed up things a lot...
- *
- * Revision 1.7  2004/06/26 09:27:20  reinelt
- *
- * added '-W' to CFLAGS
- * changed all C++ comments to C ones
- * cleaned up a lot of signed/unsigned mistakes
- *
- * Revision 1.6  2004/06/20 10:09:54  reinelt
- *
- * 'const'ified the whole source
- *
- * Revision 1.5  2004/06/06 06:51:59  reinelt
- *
- * do not display end splash screen if quiet=1
- *
- * Revision 1.4  2004/06/05 06:41:39  reinelt
- *
- * chancged splash screen again
- *
- * Revision 1.3  2004/06/05 06:13:11  reinelt
- *
- * splash screen for all text-based display drivers
- *
- * Revision 1.2  2004/06/02 09:41:19  reinelt
- *
- * prepared support for startup splash screen
- *
- * Revision 1.1  2004/05/26 11:37:36  reinelt
- *
- * Curses driver ported.
- *
  */
 
 /* 
@@ -88,12 +47,15 @@
 #include "debug.h"
 #include "cfg.h"
 #include "qprintf.h"
+#include "timer.h"
 #include "plugin.h"
 #include "widget.h"
 #include "widget_text.h"
 #include "widget_bar.h"
+#include "widget_keypad.h"
 #include "drv.h"
 #include "drv_generic_text.h"
+#include "drv_generic_keypad.h"
 
 
 static char Name[] = "Curses";
@@ -204,15 +166,18 @@
 	return -1;
     }
     if (sscanf(s, "%dx%d", &DCOLS, &DROWS) != 2 || DROWS < 1 || DCOLS < 1) {
-	error("%s: bad %s.Size '%s' from %s", Name, section, s, cfg_source);
+	error("%s: bad %s.Size '%s' from %s", Name, section, s, cfg_source());
 	free(s);
 	return -1;
     }
     free(s);
 
     initscr();
+    noecho();
     debug("%s: curses thinks that COLS=%d LINES=%d", Name, COLS, LINES);
     w = newwin(DROWS + 2, DCOLS + 2, 0, 0);
+    keypad(w, TRUE);
+    nodelay(w, TRUE);
 
     EROWS = LINES - DROWS - 3;
     if (EROWS > 99)
@@ -242,6 +207,50 @@
     return 0;
 }
 
+static void drv_Curs_timer(void __attribute__ ((unused)) * notused)
+{
+    int c;
+    while (1) {
+	c = wgetch(w);
+	if (c <= 0)
+	    break;
+	drv_generic_keypad_press(c);
+    }
+}
+
+static int drv_Curs_keypad(const int num)
+{
+    int val = 0;
+
+    switch (num) {
+    case KEY_UP:
+	debug("Key Up");
+	val += WIDGET_KEY_PRESSED;
+	val += WIDGET_KEY_UP;
+	break;
+    case KEY_DOWN:
+	debug("Key Down");
+	val += WIDGET_KEY_PRESSED;
+	val += WIDGET_KEY_DOWN;
+	break;
+    case KEY_LEFT:
+	debug("Key Left");
+	val += WIDGET_KEY_PRESSED;
+	val += WIDGET_KEY_LEFT;
+	break;
+    case KEY_RIGHT:
+	debug("Key Right");
+	val += WIDGET_KEY_PRESSED;
+	val += WIDGET_KEY_RIGHT;
+	break;
+    default:
+	debug("Unbound Key '%d'", num);
+	break;
+    }
+
+    return val;
+}
+
 
 /****************************************/
 /***            plugins               ***/
@@ -256,6 +265,7 @@
 
 /* using drv_generic_text_draw(W) */
 /* using drv_generic_text_bar_draw(W) */
+/* using drv_generic_keypad_draw(W) */
 
 
 /****************************************/
@@ -277,6 +287,8 @@
     WIDGET_CLASS wc;
     int ret;
 
+    info("%s: %s", Name, "$Rev: 840 $");
+
     /* display preferences */
     XRES = 1;			/* pixel width of one char  */
     YRES = 1;			/* pixel height of one char  */
@@ -287,6 +299,10 @@
     /* real worker functions */
     drv_generic_text_real_write = drv_Curs_write;
     drv_generic_text_real_defchar = drv_Curs_defchar;
+    drv_generic_keypad_real_press = drv_Curs_keypad;
+
+    /* regularly process display answers */
+    timer_add(drv_Curs_timer, NULL, 100, 0);
 
     /* start display */
     if ((ret = drv_Curs_start(section, quiet)) != 0) {
@@ -301,6 +317,10 @@
     if ((ret = drv_generic_text_bar_init(1)) != 0)
 	return ret;
 
+    /* initialize generic key pad driver */
+    if ((ret = drv_generic_keypad_init(section, Name)) != 0)
+	return ret;
+
     /* add fixed chars to the bar driver */
     drv_generic_text_bar_add_segment(0, 0, 255, 32);	/* ASCII  32 = blank */
     drv_generic_text_bar_add_segment(255, 255, 255, '*');	/* asterisk */
@@ -329,6 +349,7 @@
     info("%s: shutting down.", Name);
 
     drv_generic_text_quit();
+    drv_generic_keypad_quit();
 
     /* clear display */
     drv_Curs_clear();
@@ -345,8 +366,8 @@
 
 
 DRIVER drv_Curses = {
-  name:Name,
-  list:drv_Curs_list,
-  init:drv_Curs_init,
-  quit:drv_Curs_quit,
+    .name = Name,
+    .list = drv_Curs_list,
+    .init = drv_Curs_init,
+    .quit = drv_Curs_quit,
 };
diff -urN lcd4linux-0.10.0/drv_Cwlinux.c lcd4linux-0.11.0-SVN/drv_Cwlinux.c
--- lcd4linux-0.10.0/drv_Cwlinux.c	2005-05-08 06:32:44.000000000 +0200
+++ lcd4linux-0.11.0-SVN/drv_Cwlinux.c	2008-12-31 08:05:54.000000000 +0100
@@ -1,8 +1,9 @@
-/* $Id: drv_Cwlinux.c,v 1.22 2005/05/08 04:32:44 reinelt Exp $
+/* $Id: drv_Cwlinux.c 929 2008-12-31 06:40:59Z michael $
+ * $URL: https://ssl.bulix.org/svn/lcd4linux/trunk/drv_Cwlinux.c $
  *
  * new style driver for Cwlinux display modules
  *
- * Copyright (C) 1999, 2000 Michael Reinelt <reinelt@eunet.at>
+ * Copyright (C) 1999, 2000 Michael Reinelt <michael@reinelt.co.at>
  * Copyright (C) 2004 The LCD4Linux Team <lcd4linux-devel@users.sourceforge.net>
  *
  * This file is part of LCD4Linux.
@@ -21,104 +22,6 @@
  * along with this program; if not, write to the Free Software
  * Foundation, Inc., 675 Mass Ave, Cambridge, MA 02139, USA.
  *
- *
- * $Log: drv_Cwlinux.c,v $
- * Revision 1.22  2005/05/08 04:32:44  reinelt
- * CodingStyle added and applied
- *
- * Revision 1.21  2005/01/18 06:30:22  reinelt
- * added (C) to all copyright statements
- *
- * Revision 1.20  2004/11/28 15:50:24  reinelt
- * Cwlinux fixes (invalidation of user-defined chars)
- *
- * Revision 1.19  2004/06/26 12:04:59  reinelt
- *
- * uh-oh... the last CVS log message messed up things a lot...
- *
- * Revision 1.18  2004/06/26 09:27:20  reinelt
- *
- * added '-W' to CFLAGS
- * changed all C++ comments to C ones
- * cleaned up a lot of signed/unsigned mistakes
- *
- * Revision 1.17  2004/06/20 10:09:54  reinelt
- *
- * 'const'ified the whole source
- *
- * Revision 1.16  2004/06/06 06:51:59  reinelt
- *
- * do not display end splash screen if quiet=1
- *
- * Revision 1.15  2004/06/05 14:56:48  reinelt
- *
- * Cwlinux splash screen fixed
- * USBLCD splash screen fixed
- * plugin_i2c qprintf("%f") replaced with snprintf()
- *
- * Revision 1.14  2004/06/05 06:41:39  reinelt
- *
- * chancged splash screen again
- *
- * Revision 1.13  2004/06/05 06:13:11  reinelt
- *
- * splash screen for all text-based display drivers
- *
- * Revision 1.12  2004/06/02 09:41:19  reinelt
- *
- * prepared support for startup splash screen
- *
- * Revision 1.11  2004/06/01 06:45:29  reinelt
- *
- * some Fixme's processed
- * documented some code
- *
- * Revision 1.10  2004/05/31 21:05:13  reinelt
- *
- * fixed lots of bugs in the Cwlinux driver
- * do not emit EAGAIN error on the first retry
- * made plugin_i2c_sensors a bit less 'chatty'
- * moved init and exit functions to the bottom of plugin_pop3
- *
- * Revision 1.9  2004/05/31 16:39:06  reinelt
- *
- * added NULL display driver (for debugging/profiling purposes)
- * added backlight/contrast initialisation for matrixOrbital
- * added Backlight initialisation for Cwlinux
- *
- * Revision 1.8  2004/05/31 05:38:02  reinelt
- *
- * fixed possible bugs with user-defined chars (clear high bits)
- * thanks to Andy Baxter for debugging the MilfordInstruments driver!
- *
- * Revision 1.7  2004/05/28 13:51:42  reinelt
- *
- * ported driver for Beckmann+Egle Mini-Terminals
- * added 'flags' parameter to serial_init()
- *
- * Revision 1.6  2004/05/27 03:39:47  reinelt
- *
- * changed function naming scheme to plugin::function
- *
- * Revision 1.5  2004/05/26 11:37:36  reinelt
- *
- * Curses driver ported.
- *
- * Revision 1.4  2004/03/19 09:17:46  reinelt
- *
- * removed the extra 'goto' function, row and col are additional parameters
- * of the write() function now.
- *
- * Revision 1.3  2004/02/14 11:56:17  reinelt
- * M50530 driver ported
- * changed lots of 'char' to 'unsigned char'
- *
- * Revision 1.2  2004/01/29 04:40:02  reinelt
- * every .c file includes "config.h" now
- *
- * Revision 1.1  2004/01/27 06:34:14  reinelt
- * Cwlinux driver portet to NextGeneration (compiles, but not tested!)
- *
  */
 
 /* 
@@ -139,14 +42,18 @@
 #include "debug.h"
 #include "cfg.h"
 #include "qprintf.h"
+#include "timer.h"
 #include "plugin.h"
 #include "widget.h"
 #include "widget_text.h"
 #include "widget_icon.h"
 #include "widget_bar.h"
+#include "widget_keypad.h"
 #include "drv.h"
 #include "drv_generic_text.h"
+#include "drv_generic_gpio.h"
 #include "drv_generic_serial.h"
+#include "drv_generic_keypad.h"
 
 
 static char Name[] = "Cwlinux";
@@ -154,18 +61,21 @@
 static int Model;
 static int Protocol;
 
-/* Fixme: GPO's not yet implemented */
-/* static int GPO[8]; */
-static int GPOS;
-
+/* ring buffer for bytes received from the display */
+static unsigned char RingBuffer[256];
+static unsigned int RingRPos = 0;
+static unsigned int RingWPos = 0;
 
 typedef struct {
     int type;
     char *name;
     int rows;
     int cols;
-    int xres;
+    int xres;			/* pixel width of one char */
+    int yres;			/* pixel height of one char */
     int gpos;
+    int gpis;
+    int chars;			/* number of user definable chars */
     int protocol;
 } MODEL;
 
@@ -173,9 +83,11 @@
 /* Fixme: number of gpo's should be verified */
 
 static MODEL Models[] = {
-    {0x01, "CW1602", 2, 16, 5, 0, 1},
-    {0x02, "CW12232", 4, 20, 6, 0, 2},
-    {0xff, "Unknown", -1, -1, -1, -1, -1}
+    /* type, name, rows, cols, xres/char, yres/char, gpo's, gpi's, definable chars, protocol */
+    {0x01, "CW1602", 2, 16, 5, 7, 2, 2, 8, 1},
+    {0x02, "CW12232", 4, 20, 6, 8, 2, 2, 16, 2},
+    {0x03, "CW12832", 4, 21, 6, 8, 2, 2, 16, 2},
+    {0xff, "Unknown", -1, -1, -1, -1, -1, -1, -1, -1}
 };
 
 
@@ -183,10 +95,55 @@
 /***  hardware dependant functions    ***/
 /****************************************/
 
+static void drv_CW_process_input(void)
+{
+    while (RingRPos != RingWPos) {
+	drv_generic_keypad_press(RingBuffer[RingRPos++]);
+	if (RingRPos >= sizeof(RingBuffer))
+	    RingRPos = 0;
+    }
+}
+
+
+static int drv_CW_poll(void)
+{
+    while (1) {
+	char buffer[32];
+	int num, n;
+
+	num = drv_generic_serial_poll(buffer, sizeof(buffer));
+	if (num <= 0)
+	    break;		/* no more input */
+
+	/* put result into RingBuffer */
+	for (n = 0; n < num; n++) {
+	    RingBuffer[RingWPos++] = (unsigned char) buffer[n];
+	    if (RingWPos >= sizeof(RingBuffer))
+		RingWPos = 0;
+	}
+    }
+
+    if (RingRPos != RingWPos)
+	return 1;
+    else
+	return 0;
+}
+
+
+static void drv_CW_timer(void __attribute__ ((unused)) * notused)
+{
+    while (drv_CW_poll()) {
+	drv_CW_process_input();
+    }
+}
+
+
 static void drv_CW_send(const char *string, const int len)
 {
     drv_generic_serial_write(string, len);
     usleep(20);
+    if (drv_CW_poll())
+	drv_CW_process_input();
 }
 
 
@@ -218,7 +175,7 @@
 static void drv_CW12232_defchar(const int ascii, const unsigned char *buffer)
 {
     int i, j;
-    char cmd[10] = "\376Nn123456\375";
+    char cmd[10] = "\376Nn123456\375";	/* 0xfe 'N' [1..16] (6 Bytes Data) 0xfd */
 
     cmd[2] = (char) ascii;
 
@@ -237,6 +194,25 @@
 }
 
 
+static int drv_CW_GPO(const int num, const int val)
+{
+    /* Fixme: GPO's not yet implemented! */
+    error("%s: GPO's not yet implemented!", Name);
+    /* Fixme: num*val to avoid compiler warning */
+    return num * val;
+}
+
+
+static int drv_CW_GPI(const int num)
+{
+    if (num < 0 || num > GPIS) {
+	return 0;
+    }
+    error("%s: GPI's not yet implemented!", Name);
+    return num;
+}
+
+
 static void drv_CW_clear(void)
 {
 #if 1
@@ -262,8 +238,8 @@
 
     if (brightness < 0)
 	brightness = 0;
-    if (brightness > 255)
-	brightness = 255;
+    if (brightness > 8)
+	brightness = 8;
     Brightness = brightness;
 
     switch (Brightness) {
@@ -286,10 +262,43 @@
 }
 
 
+static int drv_CW_keypad(const int num)
+{
+    int val = WIDGET_KEY_PRESSED;
+
+    switch (num) {
+    case 65:
+	val += WIDGET_KEY_UP;
+	break;
+    case 66:
+	val += WIDGET_KEY_DOWN;
+	break;
+    case 67:
+	val += WIDGET_KEY_LEFT;
+	break;
+    case 68:
+	val += WIDGET_KEY_RIGHT;
+	break;
+    case 69:
+	val += WIDGET_KEY_CONFIRM;
+	break;
+    case 70:
+	val += WIDGET_KEY_CANCEL;
+	break;
+    default:
+	error("%s: unknown keypad value %d", Name, num);
+    }
+
+    debug("%s: key %c (0x%x) pressed", Name, num, num);
+    return val;
+}
+
+
 static int drv_CW_start(const char *section)
 {
     int i;
     char *model;
+    char buffer[16];
 
     model = cfg_get(section, "Model", NULL);
     if (model != NULL && *model != '\0') {
@@ -312,28 +321,37 @@
     if (drv_generic_serial_open(section, Name, 0) < 0)
 	return -1;
 
-    /* this does not work as I'd expect it... */
-#if 0
-    /* read firmware version */
-    generic_serial_read(buffer, sizeof(buffer));
-    usleep(100000);
-    generic_serial_write("\3761", 2);
-    usleep(100000);
-    generic_serial_write("\375", 1);
+    /* read firmware version: 0xfe '1' 0xfd */
+    drv_generic_serial_write("\3761\375", 3);
     usleep(100000);
-    if (generic_serial_read(buffer, 2) != 2) {
+    if (drv_generic_serial_read(buffer, 2) != 2) {
 	info("unable to read firmware version!");
+    } else {
+	info("Cwlinux Firmware V%d.%d", (int) buffer[0], (int) buffer[1]);
+    }
+
+    /* read model mumber: 0xfe 0x30 0xfd */
+    drv_generic_serial_write("\3760\375", 3);
+    usleep(100000);
+    if (drv_generic_serial_read(buffer, 2) != 2) {
+	info("unable to read model number!");
+    } else {
+	info("Cwlinux model CW%d%d", (int) buffer[0], (int) buffer[1]);
     }
-    info("Cwlinux Firmware %d.%d", (int) buffer[0], (int) buffer[1]);
-#endif
 
     /* initialize global variables */
     DROWS = Models[Model].rows;
     DCOLS = Models[Model].cols;
     XRES = Models[Model].xres;
+    YRES = Models[Model].yres;
     GPOS = Models[Model].gpos;
+    GPIS = Models[Model].gpis;
+    CHARS = Models[Model].chars;
     Protocol = Models[Model].protocol;
 
+    /* regularly process display input */
+    timer_add(drv_CW_timer, NULL, 250, 0);
+
     drv_CW_clear();
 
     drv_CW_send("\376D\375", 3);	/* auto line wrap off */
@@ -382,6 +400,8 @@
 /* using drv_generic_text_draw(W) */
 /* using drv_generic_text_icon_draw(W) */
 /* using drv_generic_text_bar_draw(W) */
+/* using drv_generic_gpio_draw(W) */
+/* using drv_generic_keypad_draw(W) */
 
 
 /****************************************/
@@ -407,10 +427,9 @@
     WIDGET_CLASS wc;
     int ret;
 
+    info("%s: %s", Name, "$Rev: 929 $");
+
     /* display preferences */
-    XRES = 6;			/* pixel width of one char  */
-    YRES = 8;			/* pixel height of one char  */
-    CHARS = 16;			/* number of user-defineable characters */
     CHAR0 = 1;			/* ASCII of first user-defineable char */
     GOTO_COST = 3;		/* number of bytes a goto command requires */
     INVALIDATE = 1;		/* re-defined chars must be re-sent to the display */
@@ -421,6 +440,9 @@
 
     /* real worker functions */
     drv_generic_text_real_write = drv_CW_write;
+    drv_generic_gpio_real_set = drv_CW_GPO;
+    drv_generic_gpio_real_get = drv_CW_GPI;
+    drv_generic_keypad_real_press = drv_CW_keypad;
 
     switch (Protocol) {
     case 1:
@@ -455,6 +477,14 @@
     /* add fixed chars to the bar driver */
     drv_generic_text_bar_add_segment(0, 0, 255, 32);	/* ASCII 32 = blank */
 
+    /* initialize generic GPIO driver */
+    if ((ret = drv_generic_gpio_init(section, Name)) != 0)
+	return ret;
+
+    /* initialize generic key pad driver */
+    if ((ret = drv_generic_keypad_init(section, Name)) != 0)
+	return ret;
+
     /* register text widget */
     wc = Widget_Text;
     wc.draw = drv_generic_text_draw;
@@ -483,6 +513,8 @@
 
     info("%s: shutting down.", Name);
     drv_generic_text_quit();
+    drv_generic_gpio_quit();
+    drv_generic_keypad_quit();
 
     /* clear display */
     drv_CW_clear();
@@ -499,8 +531,8 @@
 
 
 DRIVER drv_Cwlinux = {
-  name:Name,
-  list:drv_CW_list,
-  init:drv_CW_init,
-  quit:drv_CW_quit,
+    .name = Name,
+    .list = drv_CW_list,
+    .init = drv_CW_init,
+    .quit = drv_CW_quit,
 };
diff -urN lcd4linux-0.10.0/drv_D4D.c lcd4linux-0.11.0-SVN/drv_D4D.c
--- lcd4linux-0.10.0/drv_D4D.c	1970-01-01 01:00:00.000000000 +0100
+++ lcd4linux-0.11.0-SVN/drv_D4D.c	2008-12-31 08:06:27.000000000 +0100
@@ -0,0 +1,778 @@
+/* $Id: drv_D4D.c 897 2008-10-06 04:25:14Z michael $
+ * $URL: https://ssl.bulix.org/svn/lcd4linux/trunk/drv_D4D.c $
+ *
+ * LCD4Linux driver for 4D Systems Display Graphics Modules
+ *
+ * Copyright (C) 2008 Sven Killig <sven@killig.de>
+ * Modified from sample code by:
+ * Copyright (C) 2005 Michael Reinelt <michael@reinelt.co.at>
+ * Copyright (C) 2005, 2006, 2007 The LCD4Linux Team <lcd4linux-devel@users.sourceforge.net>
+ *
+ * This file is part of LCD4Linux.
+ *
+ * LCD4Linux is free software; you can redistribute it and/or modify
+ * it under the terms of the GNU General Public License as published by
+ * the Free Software Foundation; either version 2, or (at your option)
+ * any later version.
+ *
+ * LCD4Linux is distributed in the hope that it will be useful,
+ * but WITHOUT ANY WARRANTY; without even the implied warranty of
+ * MERCHANTABILITY or FITNESS FOR A PARTICULAR PURPOSE.  See the
+ * GNU General Public License for more details.
+ *
+ * You should have received a copy of the GNU General Public License
+ * along with this program; if not, write to the Free Software
+ * Foundation, Inc., 675 Mass Ave, Cambridge, MA 02139, USA.
+ *
+ */
+
+/*
+ *
+ * exported fuctions:
+ *
+ * struct DRIVER drv_D4D
+ *
+ */
+
+#include "config.h"
+
+#include <stdlib.h>
+#include <stdio.h>
+#include <unistd.h>
+#include <string.h>
+#include <errno.h>
+
+#include <termios.h>
+#include <fcntl.h>
+#include <math.h>
+
+#include "debug.h"
+#include "cfg.h"
+#include "qprintf.h"
+#include "udelay.h"
+#include "plugin.h"
+#include "widget.h"
+#include "widget_text.h"
+#include "widget_icon.h"
+#include "widget_bar.h"
+#include "drv.h"
+
+#include "drv_generic_text.h"
+#include "drv_generic_graphic.h"
+#include "drv_generic_serial.h"
+
+static char Name[] = "D4D";
+char NAME_[20];
+int FONT = 1, MODE = 0, EXTRA = 0, SECTOR = 0, SECTOR_SIZE, NOPOWERCYCLE = 0;
+/* int CONTRAST_; */
+
+#define address_mmsb(variable) ((variable >> 24) & 0xFF)
+#define address_mlsb(variable) ((variable >> 16) & 0xFF)
+#define address_lmsb(variable) ((variable >>  8) & 0xFF)
+#define address_llsb(variable)  (variable        & 0xFF)
+
+#define address_hi(variable)   ((variable >> 16) & 0xFF)
+#define address_mid(variable)  ((variable >>  8) & 0xFF)
+#define address_lo(variable)    (variable        & 0xFF)
+
+#define msb(variable)          ((variable >>  8) & 0xFF)
+#define lsb(variable)           (variable        & 0xFF)
+
+RGBA FG_COL_ = {.R = 0x00,.G = 0x00,.B = 0x00,.A = 0xff };
+RGBA BG_COL_ = {.R = 0xff,.G = 0xff,.B = 0xff,.A = 0xff };
+
+short int FG_COLOR, BG_COLOR;
+
+int RGB_24to16(int red, int grn, int blu)
+{
+    return (((red >> 3) << 11) | ((grn >> 2) << 5) | (blu >> 3));
+}
+
+int RGB_24to8(int red, int grn, int blu)
+{
+    return (((red >> 5) << 5) | ((grn >> 5) << 2) | (blu >> 6));
+}
+
+/****************************************/
+/***  hardware dependant functions    ***/
+/****************************************/
+
+
+static int drv_D4D_open(const char *section)
+{
+    int fd;
+    fd = drv_generic_serial_open(section, Name, 0);
+    if (fd < 0)
+	return -1;
+    fcntl(fd, F_SETFL, 0);	/* blocking read */
+    return 0;
+}
+
+
+static int drv_D4D_close(void)
+{
+    drv_generic_serial_close();
+    return 0;
+}
+
+
+static void drv_D4D_receive_ACK()
+{
+    char ret[1];
+    while (drv_generic_serial_read(ret, sizeof(ret)) != 1)
+	usleep(1);		/* loop should be unneccessary */
+    if (ret[0] == 0x15) {
+	error("NAK!");
+    } else if (ret[0] != 6) {
+	error("no ACK!");
+    }
+}
+
+static void drv_D4D_send_nowait(const char *data, const unsigned int len)
+{
+    drv_generic_serial_write(data, len);
+}
+
+static void drv_D4D_send(const char *data, const unsigned int len)
+{
+    drv_D4D_send_nowait(data, len);
+    drv_D4D_receive_ACK();
+}
+
+static void drv_D4D_send_nowait_extra(const char *data, const unsigned int len, unsigned char pos1, unsigned char pos2)
+{
+    /* possibly leave out bytes at pos1 and pos2 for older protocol format */
+    if (EXTRA) {
+	drv_D4D_send_nowait(data, len);
+    } else {
+	unsigned int i;
+	char send[1];
+	for (i = 0; i < len; i++) {
+	    if (!pos1 || i != pos1) {
+		if (!pos2 || i != pos2) {
+		    send[0] = data[i];
+		    drv_generic_serial_write(send, 1);
+		}
+	    }
+	}
+    }
+}
+
+static void drv_D4D_send_extra(const char *data, const unsigned int len, char pos1, char pos2)
+{
+    drv_D4D_send_nowait_extra(data, len, pos1, pos2);
+    drv_D4D_receive_ACK();
+}
+
+
+static void drv_D4D_clear(void)
+{
+    char cmd[] = { 'E' };
+    drv_D4D_send(cmd, sizeof(cmd));
+}
+
+
+static void drv_D4D_write(const int row, const int col, const char *data, int len)
+{
+    char out[len];
+    char user_char[len];
+    int user_x[len];
+    int user_y[len];
+    int i, k = 0;
+
+    if (!SECTOR) {		/* font in ROM */
+
+	for (i = 0; i < len; i++) {
+	    if (data[i] >= 31 && data[i] < CHAR0) {
+		out[i] = data[i];
+	    } else if (data[i] == '') {	/* mu */
+		if (FONT == 2)
+		    out[i] = 31;	/* undocumented */
+		else if (FONT == 0)
+		    out[i] = 'u';
+		else
+		    out[i] = 127;	/* undocumented */
+	    } else {
+		out[i] = ' ';
+		if (data[i] == '')
+		    user_char[k] = 0;	/* degree */
+		else
+		    user_char[k] = data[i] - CHAR0;
+		user_x[k] = (col + i) * XRES;
+		user_y[k] = row * YRES;
+		k++;
+	    }
+	}
+
+	char cmd[] = { 's', col, row, FONT, msb(FG_COLOR), lsb(FG_COLOR) };	/* normal chars */
+	drv_D4D_send_nowait(cmd, sizeof(cmd));
+	if (len > 256)
+	    len = 256;
+	drv_D4D_send_nowait(out, len);
+	char cmdNull[1];
+	cmdNull[0] = 0;
+	drv_D4D_send(cmdNull, 1);
+
+	char cmd_user[] = { 'D', 0, 0, 0, 0, 0, msb(FG_COLOR), lsb(FG_COLOR) };	/* user defined symbols */
+	for (i = 0; i < k; i++) {
+	    cmd_user[2] = user_char[i];
+	    cmd_user[3] = user_x[i];
+	    cmd_user[4] = msb(user_y[i]);
+	    cmd_user[5] = lsb(user_y[i]);
+	    drv_D4D_send_extra(cmd_user, sizeof(cmd_user), 1, 4);
+	}
+    } else {			/* font on SD card */
+	int sec;
+	char cmd_sd[] = { '@', 'I', 0, msb(row * YRES), lsb(row * YRES), XRES, msb(YRES), lsb(YRES), 16, 0, 0, 0 };
+	for (i = 0; i < len; i++) {
+	    cmd_sd[2] = (col + i) * XRES;
+	    sec = SECTOR + (unsigned char) data[i] * SECTOR_SIZE;
+	    cmd_sd[9] = address_hi(sec);
+	    cmd_sd[10] = address_mid(sec);
+	    cmd_sd[11] = address_lo(sec);
+	    drv_D4D_send_extra(cmd_sd, sizeof(cmd_sd), 3, 6);
+	}
+    }
+}
+
+
+static void drv_D4D_defchar(const int ascii, const unsigned char *matrix)
+{
+    /* error("drv_D4D_defchar"); */
+    char cmd[11];
+    int i;
+
+    cmd[0] = 'A';
+    cmd[1] = 0;
+    cmd[2] = ascii - CHAR0;
+
+    for (i = 0; i < 8; i++) {
+	cmd[i + 3] = *matrix++;
+    }
+    drv_D4D_send_extra(cmd, sizeof(cmd), 1, 0);
+}
+
+
+static void drv_D4D_blit(const int row, const int col, const int height, const int width)
+{
+    /* error("drv_D4D_blit(%i, %i, %i, %i)",row, col, height, width); */
+    int r, c;
+    RGBA rgb, pixel0_0, pixel;
+    short int color;
+    char colorArray[2];
+
+
+    /* optimization: single colour rectangle? */
+    pixel0_0 = drv_generic_graphic_rgb(0, 0);
+    char unicolor = 1;
+    for (r = row; r < row + height; r++) {
+	if (!unicolor)
+	    break;
+	for (c = col; c < col + width; c++) {
+	    if (!unicolor)
+		break;
+	    pixel = drv_generic_graphic_rgb(r, c);
+	    if (pixel0_0.R != pixel.R || pixel0_0.G != pixel.G || pixel0_0.B != pixel.B || pixel0_0.A != pixel.A)
+		unicolor = 0;
+	}
+    }
+
+    if (unicolor) {
+	color = RGB_24to16(pixel0_0.R, pixel0_0.G, pixel0_0.B);
+	char row2 = row + height - 1;
+	char cmdRect[] =
+	    { 'r', col, msb(row), lsb(row), col + width - 1, msb(row2), lsb(row2), msb(color), lsb(color) };
+	drv_D4D_send_extra(cmdRect, sizeof(cmdRect), 2, 5);
+    } else {
+	char cmd[] = { 'I', col, msb(row), lsb(row), width, msb(height), lsb(height), MODE };
+	drv_D4D_send_nowait_extra(cmd, sizeof(cmd), 2, 5);
+	for (r = row; r < row + height; r++) {
+	    for (c = col; c < col + width; c++) {
+		rgb = drv_generic_graphic_rgb(r, c);
+		if (MODE == 8) {
+		    colorArray[0] = RGB_24to8(rgb.R, rgb.G, rgb.B);
+		    drv_D4D_send_nowait(colorArray, 1);
+		} else {
+		    color = RGB_24to16(rgb.R, rgb.G, rgb.B);
+		    colorArray[0] = msb(color);
+		    drv_D4D_send_nowait(colorArray, 1);	/* doesn't werk if sent together (error: "partial write(/dev/tts/1): len=2 ret=1") */
+		    /* colorArray[1]=lsb(color); */
+		    colorArray[0] = lsb(color);
+		    drv_D4D_send_nowait(colorArray, 1);
+		}
+		/* drv_D4D_send_nowait(colorArray, MODE/8); */
+	    }
+	}
+	drv_D4D_receive_ACK();
+    }
+}
+
+
+static int drv_D4D_contrast(int contrast)
+{
+    if (contrast < 0)
+	contrast = 0;
+    if (contrast > 15)
+	contrast = 15;
+
+    char cmd[] = { 'Y', 2, contrast };
+    drv_D4D_send(cmd, sizeof(cmd));
+
+    /* CONTRAST_=contrast; */
+    return contrast;
+}
+
+
+static int drv_D4D_start(const char *section)
+{
+    /* error("drv_D4D_start()"); */
+    int contrast;
+    int xres_cfg = -1, yres_cfg = -1;
+    char *s;
+    char *color;
+
+    if (drv_D4D_open(section) < 0) {
+	return -1;
+    }
+
+    char cmd[] = { 'U' };
+    drv_D4D_send(cmd, sizeof(cmd));
+
+
+    char getVersion[] = { 'V', 0 };
+    drv_D4D_send_nowait(getVersion, sizeof(getVersion));
+    char answer[5];
+    drv_generic_serial_read(answer, sizeof(answer));
+    char *ids[] = { "uOLED", "uLCD", "uVGA" };
+    char *id;
+    if (answer[0] <= 2)
+	id = ids[(int) answer[0]];
+    else
+	id = "Unknown";
+    qprintf(NAME_, sizeof(NAME_), "%s H%u S%u", id, (int) answer[1], (int) answer[2]);
+    int res[2];
+    int i;
+    for (i = 0; i < 2; i++) {
+	switch ((unsigned char) answer[3 + i]) {
+	case 0x22:
+	    res[i] = 220;
+	    break;
+	case 0x28:
+	    res[i] = 128;
+	    break;
+	case 0x32:
+	    res[i] = 320;
+	    EXTRA = 1;
+	    break;
+	case 0x60:
+	    res[i] = 160;
+	    break;
+	case 0x64:
+	    res[i] = 64;
+	    break;
+	case 0x76:
+	    res[i] = 176;
+	    break;
+	case 0x96:
+	    res[i] = 96;
+	    break;
+	case 0x24:		/* undocumented? */
+	    res[i] = 240;
+	    break;
+	default:
+	    error("Can't detect display dimensions!");
+	    return -1;
+	}
+    }
+    DCOLS = res[0];
+    DROWS = res[1];
+
+
+    cfg_number(section, "Mode", 0, 0, 16, &MODE);
+
+    s = cfg_get(section, "Font", NULL);
+    if (s == NULL || *s == '\0') {
+	error("%s: no '%s.Font' entry from %s", Name, section, cfg_source());
+	return -1;
+    }
+    if (sscanf(s, "%dx%d", &xres_cfg, &yres_cfg) < 1 || xres_cfg < 0) {
+	error("%s: bad %s.Font '%s' from %s", Name, section, s, cfg_source());
+	free(s);
+	return -1;
+    }
+
+    if (yres_cfg == -1) {	/* font on SD card */
+	SECTOR = xres_cfg * 512;
+	char setAddress[] =
+	    { '@', 'A', address_mmsb(SECTOR), address_mlsb(SECTOR), address_lmsb(SECTOR), address_llsb(SECTOR) };
+	drv_D4D_send(setAddress, sizeof(setAddress));
+	char answer1[1];
+	char readByte[] = { '@', 'r' };
+	drv_D4D_send_nowait(readByte, sizeof(readByte));
+	drv_generic_serial_read(answer1, sizeof(answer1));
+	XRES = answer1[0];
+	drv_D4D_send_nowait(readByte, sizeof(readByte));
+	drv_generic_serial_read(answer1, sizeof(answer1));
+	YRES = answer1[0];
+	SECTOR = xres_cfg + 1;
+	SECTOR_SIZE = ceil((double) XRES * (double) YRES * 2.0 / 512.0);
+    } else {
+	XRES = xres_cfg;
+	YRES = yres_cfg;
+    }
+
+    if (MODE == 0) {
+
+	color = cfg_get(section, "foreground", "ffffff");
+	if (color2RGBA(color, &FG_COL_) < 0) {
+	    error("%s: ignoring illegal color '%s'", Name, color);
+	}
+	if (color)
+	    free(color);
+	FG_COLOR = RGB_24to16(FG_COL_.R, FG_COL_.G, FG_COL_.B);
+
+	color = cfg_get(section, "background", "000000");
+	if (color2RGBA(color, &BG_COL_) < 0) {
+	    error("%s: ignoring illegal color '%s'", Name, color);
+	}
+	if (color)
+	    free(color);
+	BG_COLOR = RGB_24to16(BG_COL_.R, BG_COL_.G, BG_COL_.B);
+
+	DCOLS = DCOLS / XRES;
+	DROWS = DROWS / YRES;
+	switch (yres_cfg) {	/* font in ROM */
+	case 8:
+	    switch (xres_cfg) {
+	    case 6:
+		FONT = 0;
+		break;
+	    case 8:
+		FONT = 1;
+		break;
+	    default:
+		error("%s: unknown width in %s.Font '%s' from %s", Name, section, s, cfg_source());
+		return -1;
+	    };
+	    break;
+	case 12:
+	    FONT = 2;
+	    break;
+	case 16:
+	    FONT = 3;
+	    break;
+	case -1:
+	    break;
+	default:
+	    error("%s: unknown height in %s.Font '%s' from %s", Name, section, s, cfg_source());
+	    return -1;
+	}
+    }
+
+    info("XRES=%i, YRES=%i;  DCOLS=%i, DROWS=%d;  FONT=%d, SECTOR=%i, SECTOR_SIZE=%i\n", XRES, YRES, DCOLS, DROWS,
+	 FONT, SECTOR, SECTOR_SIZE);
+
+
+
+    cfg_number(section, "NoPowerCycle", 0, 1, 65536, &NOPOWERCYCLE);
+    if (!NOPOWERCYCLE) {
+	char powerOn[] = { 'Y', 3, 1 };
+	drv_D4D_send(powerOn, sizeof(powerOn));
+
+	/*char background[] = {'B', msb(BG_COLOR), lsb(BG_COLOR)};
+	   drv_D4D_send(background, sizeof(background)); */
+    }
+
+    char opaque[] = { 'O', 1 };
+    drv_D4D_send(opaque, sizeof(opaque));
+
+    char penSize[] = { 'p', 0 };
+    drv_D4D_send(penSize, sizeof(penSize));
+
+
+    if (!MODE) {
+	unsigned char buffer[] = { 0x18, 0x24, 0x24, 0x18, 0, 0, 0, 0 };	/* degree */
+	drv_D4D_defchar(CHAR0, buffer);
+	CHARS--;
+	CHAR0++;
+    }
+
+    if (cfg_number(section, "Contrast", 0, 0, 255, &contrast) > 0) {
+	drv_D4D_contrast(contrast);
+    }
+
+    drv_D4D_clear();
+
+    return 0;
+}
+
+
+int drv_D4D_text_draw(WIDGET * W)
+{
+    short int FG_COLOR_old = FG_COLOR, BG_COLOR_old = BG_COLOR;
+    int ret;
+    RGBA fg, bg;
+    fg = W->fg_valid ? W->fg_color : FG_COL_;
+    bg = W->bg_valid ? W->bg_color : BG_COL_;
+    FG_COLOR = RGB_24to16(fg.R, fg.G, fg.B);
+    BG_COLOR = RGB_24to16(bg.R, bg.G, bg.B);
+    ret = drv_generic_text_draw(W);
+    FG_COLOR = FG_COLOR_old;
+    BG_COLOR = BG_COLOR_old;
+    return ret;
+}
+
+
+int lastVal[40 * 40 * 2];	/* ToDo: MAX_WIDGETS*2 */
+int drv_D4D_bar_draw(WIDGET * W)
+{
+    /* optimizations:
+       - draw filled rectangles instead of user defined bar characters
+       - cache last values */
+
+    WIDGET_BAR *Bar = W->data;
+    int row, col, len, res, max, val1, val2;
+    DIRECTION dir;
+    STYLE style;
+
+    row = W->row;
+    col = W->col;
+    dir = Bar->direction;
+    style = Bar->style;
+    len = Bar->length;
+
+    res = dir & (DIR_EAST | DIR_WEST) ? XRES : YRES;
+    max = len * res;
+    val1 = Bar->val1 * (double) (max);
+    val2 = Bar->val2 * (double) (max);
+
+    if (val1 < 1)
+	val1 = 1;
+    else if (val1 > max)
+	val1 = max;
+
+    if (val2 < 1)
+	val2 = 1;
+    else if (val2 > max)
+	val2 = max;
+
+    short int FG_COLOR_old = FG_COLOR, BG_COLOR_old = BG_COLOR;
+    RGBA fg, bg;
+    fg = W->fg_valid ? W->fg_color : FG_COL_;
+    bg = W->bg_valid ? W->bg_color : BG_COL_;
+    FG_COLOR = RGB_24to16(fg.R, fg.G, fg.B);
+    BG_COLOR = RGB_24to16(bg.R, bg.G, bg.B);
+
+    char cmd[9];
+    cmd[0] = 'r';
+    int val[2];
+    val[0] = val1;
+    val[1] = val2;
+    int i, vals;
+    int lastValIndex0 = row * DCOLS + col;
+    int cells = DROWS * DCOLS;
+    if (val1 == val2 && lastVal[lastValIndex0] == lastVal[lastValIndex0 + cells])
+	vals = 1;
+    else
+	vals = 2;
+    for (i = 0; i < vals; i++) {
+	int lastValIndex = lastValIndex0 + cells * (i /*+1 */ );
+	int y1 = row * YRES + (YRES / 2) * i;
+	cmd[2] = msb(y1);
+	cmd[3] = lsb(y1);
+	int y2 = y1 + (YRES) / vals - 1;
+	cmd[5] = msb(y2);
+	cmd[6] = lsb(y2);
+	if (val[i] > lastVal[lastValIndex]) {
+	    cmd[1] = col * XRES + lastVal[lastValIndex];
+	    cmd[4] = cmd[1] + val[i] - lastVal[lastValIndex] - 1;
+	    cmd[7] = msb(FG_COLOR);
+	    cmd[8] = lsb(FG_COLOR);
+	    drv_D4D_send_extra(cmd, sizeof(cmd), 2, 5);
+	} else if (val[i] < lastVal[lastValIndex]) {
+	    cmd[1] = col * XRES + val[i] - 1 + 1;
+	    cmd[4] = cmd[1] + lastVal[lastValIndex] - val[i];
+	    cmd[7] = msb(BG_COLOR);
+	    cmd[8] = lsb(BG_COLOR);
+	    drv_D4D_send_extra(cmd, sizeof(cmd), 2, 5);
+	}
+	lastVal[lastValIndex] = val[i];
+    }
+
+    FG_COLOR = FG_COLOR_old;
+    BG_COLOR = BG_COLOR_old;
+    return 0;
+}
+
+
+
+
+
+/****************************************/
+/***            plugins               ***/
+/****************************************/
+
+static void plugin_contrast(RESULT * result, RESULT * arg1)
+{
+    double contrast;
+
+    contrast = drv_D4D_contrast(R2N(arg1));
+    SetResult(&result, R_NUMBER, &contrast);
+}
+
+
+/****************************************/
+/***        widget callbacks          ***/
+/****************************************/
+
+
+/* using drv_generic_text_draw(W) */
+/* using drv_generic_text_icon_draw(W) */
+/* using drv_generic_text_bar_draw(W) */
+/* using drv_generic_gpio_draw(W) */
+
+
+/****************************************/
+/***        exported functions        ***/
+/****************************************/
+
+
+int drv_D4D_list(void)
+{
+    printf("4D Systems Display Graphics Modules");
+    return 0;
+}
+
+
+int drv_D4D_init(const char *section, const int quiet)
+{
+    /* error("drv_D4D_init()"); */
+    WIDGET_CLASS wc;
+    int ret;
+
+    info("%s: %s", Name, "$Rev: 897 $");
+
+    if ((ret = drv_D4D_start(section)) != 0)
+	return ret;
+
+    if (EXTRA)
+	CHARS = 64;
+    else
+	CHARS = 32;
+    CHAR0 = 128;
+    GOTO_COST = 7;
+
+    if (MODE) {
+	drv_generic_graphic_real_blit = drv_D4D_blit;
+    } else {
+	drv_generic_text_real_write = drv_D4D_write;
+	drv_generic_text_real_defchar = drv_D4D_defchar;
+    }
+
+
+
+
+    if (!quiet) {
+	char buffer[40];
+	qprintf(buffer, sizeof(buffer), "%s %dx%d", NAME_, DCOLS, DROWS);
+	if (MODE) {
+	    if (drv_generic_graphic_greet(buffer, "www.4dsystems.com.au")) {
+		sleep(3);
+		drv_generic_graphic_clear();
+	    }
+	} else {
+	    if (drv_generic_text_greet(buffer, "www.4dsystems.com.au")) {
+		sleep(3);
+		drv_D4D_clear();
+	    }
+	}
+    }
+
+
+    if (MODE) {
+	if ((ret = drv_generic_graphic_init(section, Name)) != 0)
+	    return ret;
+    } else {
+
+	if ((ret = drv_generic_text_init(section, Name)) != 0)
+	    return ret;
+
+	if ((ret = drv_generic_text_icon_init()) != 0)
+	    return ret;
+
+	if ((ret = drv_generic_text_bar_init(0)) != 0)
+	    return ret;
+
+	drv_generic_text_bar_add_segment(0, 0, 255, 32);
+
+
+	wc = Widget_Text;
+	wc.draw = drv_D4D_text_draw;
+	widget_register(&wc);
+
+	wc = Widget_Icon;
+	wc.draw = drv_generic_text_icon_draw;
+	widget_register(&wc);
+
+	wc = Widget_Bar;
+	wc.draw = drv_D4D_bar_draw;
+	widget_register(&wc);
+
+    }
+
+    AddFunction("LCD::contrast", 1, plugin_contrast);
+
+    return 0;
+}
+
+
+int drv_D4D_quit(const int quiet)
+{
+    /* error("drv_D4D_quit()"); */
+
+    info("%s: shutting down.", Name);
+
+    if (MODE == 0)
+	drv_generic_text_quit();
+
+
+    if (!NOPOWERCYCLE) {
+	drv_D4D_clear();
+    }
+
+    if (!quiet) {
+	if (MODE)
+	    drv_generic_graphic_greet("goodbye!", NULL);
+	else
+	    drv_generic_text_greet("goodbye!", NULL);
+    }
+
+    /* fade */
+    /*int i;
+       for(i=CONTRAST_;i>=0;i--) {
+       drv_D4D_contrast(i);
+       usleep(1000);
+       } */
+
+    if (MODE)
+	drv_generic_graphic_quit();
+
+    if (!NOPOWERCYCLE) {
+	char powerDown[] = { 'Y', 3, 0 };
+	drv_D4D_send(powerDown, sizeof(powerDown));
+    }
+
+    debug("closing connection");
+    drv_D4D_close();
+
+    return (0);
+}
+
+
+
+DRIVER drv_D4D = {
+    .name = Name,
+    .list = drv_D4D_list,
+    .init = drv_D4D_init,
+    .quit = drv_D4D_quit,
+};
diff -urN lcd4linux-0.10.0/drv_EA232graphic.c lcd4linux-0.11.0-SVN/drv_EA232graphic.c
--- lcd4linux-0.10.0/drv_EA232graphic.c	1970-01-01 01:00:00.000000000 +0100
+++ lcd4linux-0.11.0-SVN/drv_EA232graphic.c	2008-12-31 08:06:27.000000000 +0100
@@ -0,0 +1,554 @@
+/* $Id: drv_EA232graphic.c 840 2007-09-09 12:17:42Z michael $
+ * $URL: https://ssl.bulix.org/svn/lcd4linux/trunk/drv_EA232graphic.c $
+ *
+ * Driver for Electronic Assembly serial graphic display
+ *
+ * Copyright (C) 2007 Stefan Gmeiner <stefangmeiner@solnet.ch>
+ * Copyright (C) 2005 Michael Reinelt <michael@reinelt.co.at>
+ * Copyright (C) 2005, 2006, 2007 The LCD4Linux Team <lcd4linux-devel@users.sourceforge.net>
+ *
+ * This file is part of LCD4Linux.
+ *
+ * LCD4Linux is free software; you can redistribute it and/or modify
+ * it under the terms of the GNU General Public License as published by
+ * the Free Software Foundation; either version 2, or (at your option)
+ * any later version.
+ *
+ * LCD4Linux is distributed in the hope that it will be useful,
+ * but WITHOUT ANY WARRANTY; without even the implied warranty of
+ * MERCHANTABILITY or FITNESS FOR A PARTICULAR PURPOSE.  See the
+ * GNU General Public License for more details.
+ *
+ * You should have received a copy of the GNU General Public License
+ * along with this program; if not, write to the Free Software
+ * Foundation, Inc., 675 Mass Ave, Cambridge, MA 02139, USA.
+ *
+ */
+
+/*
+ * Electronic Assembly RS232 Graphic Displays
+ *
+ * This driver supports some of the Electronic Assembly serial graphic displays. Although
+ * most of this display support higher level operation like text and graphic command, non of
+ * these are used. Instead the lcd4linux graphic routines creates the graphic which is then
+ * transferd to the display.
+ * 
+ * FIXME: Some display have addition features such as GPI which are not yet implemented.
+ *
+ * Display          Protocol   Output  Contrast
+ * ============================================
+ * GE120-5NV24         1         8       yes
+ * GE128-6N3V24        1         8       no
+ * GE128-6N9V24        2         0       yes
+ * GE128-7KV24         3         8       no
+ * GE240-6KV24         3         8       no
+ * GE240-6KCV24        3         8       no
+ * GE240-7KV24         3         8       no
+ * GE240-7KLWV24       3         8       no
+ * GE240-6KLWV24       3         8       no
+ *
+ * Supported protocol commands:
+ *
+ *            Clear
+ * Protocol  Display  Set Output     Set Contrast    Bitmap                    Orientation
+ * =======================================================================================
+ *    1      DL       Y(0..7)(0..1)  K(0..20)        U(x)(y)(w)(h)(...)        Vertical
+ *    2      <ESC>DL  --             <ESC>DK(0..63)  <ESC>UL(x)(y)(w)(h)(...)  Vertical
+ *    3      DL       Y(0..7)(0..1)  --              U(x)(y)(w)(h)(...)        Horizontal
+ *
+ * Bitmap orientation:
+ *
+ * Vertical:        Byte-No.
+ *                 123456789....
+ *           Bit 0 *********
+ *           Bit 1 *********
+ *           Bit 2 *********
+ *           Bit 3 *********
+ *           Bit 4 *********
+ *           Bit 5 *********
+ *           Bit 6 *********
+ *           Bit 7 *********
+ *
+ * Horizontal:      Bit-No.
+ *                 76543210
+ *          Byte 0 ********
+ *          Byte 1 ********
+ *          Byte 3 ********
+ *          ...
+ *
+ *
+ */
+
+/* 
+ *
+ * exported fuctions:
+ *
+ * struct DRIVER drv_EA232graphic
+ *
+ */
+
+#include "config.h"
+
+#include <stdlib.h>
+#include <stdio.h>
+#include <string.h>
+#include <errno.h>
+#include <sys/time.h>
+#include <unistd.h>
+
+#include "debug.h"
+#include "cfg.h"
+#include "qprintf.h"
+#include "udelay.h"
+#include "plugin.h"
+#include "widget.h"
+#include "widget_text.h"
+#include "widget_icon.h"
+#include "widget_bar.h"
+#include "drv.h"
+
+/* graphic display */
+#include "drv_generic_graphic.h"
+
+/* serial port */
+#include "drv_generic_serial.h"
+
+/* GPO */
+#include "drv_generic_gpio.h"
+
+
+
+#define ESC ((char)27)
+#define MSB_BYTE 0x80
+#define LSB_BYTE 0x01
+
+static char Name[] = "EA232graphic";
+
+typedef struct {
+    char *name;
+    int columns;
+    int rows;
+    int max_contrast;
+    int default_contrast;
+    int gpo;
+    int protocol;
+} MODEL;
+
+static MODEL Models[] = {
+    /* Protocol 1 models */
+    {"GE120-5NV24", 120, 32, 20, 8, 8, 1},
+    {"GE128-6N3V24", 128, 64, 0, 0, 8, 1},
+
+    /* Protocol 2 models */
+    {"GE128-6N9V24", 128, 64, 63, 40, 0, 2},
+
+    /* Protocol 3 models */
+    {"GE128-7KV24", 128, 128, 0, 0, 8, 3},
+    {"GE240-6KV24", 240, 64, 0, 0, 8, 3},
+    {"GE240-6KCV24", 240, 64, 0, 0, 8, 3},
+    {"GE240-7KV24", 240, 128, 0, 0, 8, 3},
+    {"GE240-7KLWV24", 240, 128, 0, 0, 8, 3},
+    {"GE240-6KLWV24", 240, 64, 0, 0, 8, 3},
+
+    {NULL, 0, 0, 0, 0, 0, 0}
+};
+
+static MODEL *Model;
+
+
+/****************************************/
+/***  hardware dependant functions    ***/
+/****************************************/
+
+
+static int drv_EA232graphic_open(const char *section)
+{
+    /* open serial port */
+    /* don't mind about device, speed and stuff, this function will take care of */
+    if (drv_generic_serial_open(section, Name, 0) < 0)
+	return -1;
+
+    return 0;
+}
+
+
+static int drv_EA232graphic_close(void)
+{
+    drv_generic_serial_close();
+
+    return 0;
+}
+
+
+/* write data to the display */
+static void drv_EA232graphic_send(const char *data, const int len)
+{
+    drv_generic_serial_write(data, len);
+}
+
+
+/* delete Display */
+static void drv_EA232graphic_clear_display()
+{
+    char cmd[3];
+
+    switch (Model->protocol) {
+    case 1:
+    case 3:
+	cmd[0] = 'D';
+	cmd[1] = 'L';
+	drv_EA232graphic_send(cmd, 2);
+	break;
+
+    case 2:
+	cmd[0] = ESC;
+	cmd[1] = 'D';
+	cmd[2] = 'L';
+	drv_EA232graphic_send(cmd, 3);
+	break;
+    default:
+	error("%s: undefined protocol type", Name);
+	return;
+    }
+}
+
+
+
+/* copy framebuffer to display */
+static void drv_EA232graphic_blit(const int row, const int col, const int height, const int width)
+{
+
+    int r, c, l, p;
+    char *cmd;
+
+    /* calculate length of command */
+    l = 0;
+    switch (Model->protocol) {
+    case 1:
+    case 2:
+	l = ((height + 7) / 8) * width;
+	break;
+    case 3:
+	l = ((width + 7) / 8) * height;
+	break;
+    default:
+	error("%s: undefined protocol type", Name);
+	return;
+    }
+
+    /* add maximum length of command header */
+    cmd = (char *) malloc(l + 10);
+    if (cmd == NULL) {
+	error("%s: allocation of buffer failed: %s", Name, strerror(errno));
+	return;
+    }
+    p = 0;
+
+    /* write command header */
+    switch (Model->protocol) {
+    case 1:
+    case 3:
+	cmd[p++] = 'U';
+	cmd[p++] = col;
+	cmd[p++] = row;
+	cmd[p++] = width;
+	cmd[p++] = height;
+	break;
+    case 2:
+	cmd[p++] = ESC;
+	cmd[p++] = 'U';
+	cmd[p++] = 'L';
+	cmd[p++] = col;
+	cmd[p++] = row;
+	cmd[p++] = width;
+	cmd[p++] = height;
+	break;
+    default:
+	error("%s: undefined protocol type", Name);
+	free(cmd);
+	return;
+    }
+
+    /* clear all pixels */
+    memset(cmd + p, 0, l);
+
+    /* set pixels */
+    switch (Model->protocol) {
+    case 1:
+    case 2:
+	for (r = 0; r < height; r++) {
+	    for (c = 0; c < width; c++) {
+		if (drv_generic_graphic_black(r + row, c + col)) {
+		    cmd[(r / 8) * width + c + p] |= (LSB_BYTE << (r % 8));
+		}
+	    }
+	}
+	break;
+    case 3:
+	for (c = 0; c < width; c++) {
+	    for (r = 0; r < height; r++) {
+		if (drv_generic_graphic_black(r + row, c + col)) {
+		    cmd[(c / 8) * height + r + p] |= (MSB_BYTE >> (c % 8));
+		}
+	    }
+	}
+	break;
+    default:
+	error("%s: undefined protocol type", Name);
+	free(cmd);
+	return;
+    }
+
+    drv_EA232graphic_send(cmd, p + l);
+
+    free(cmd);
+}
+
+
+static int drv_EA232graphic_GPO(const int num, const int val)
+{
+    char cmd[4];
+
+    if (Model->gpo == 0) {
+	error("%s: GPO not supported on this model.", Name);
+	return -1;
+    }
+
+
+    if (Model->gpo < num) {
+	error("%s: GPO %d is not available.", Name, num);
+	return -1;
+    }
+
+    cmd[0] = 'Y';
+    cmd[1] = num;
+    cmd[2] = (val > 0) ? 1 : 0;
+
+    drv_EA232graphic_send(cmd, 3);
+
+    return 0;
+}
+
+
+/* adjust contast */
+static int drv_EA232graphic_contrast(int contrast)
+{
+    char cmd[4];
+
+    if (Model->max_contrast == 0) {
+	error("%s: contrast setting not support by model", Name);
+	return -1;
+    }
+
+    /* adjust limits according to the display */
+    if (contrast < 0)
+	contrast = 0;
+    if (contrast > Model->max_contrast)
+	contrast = Model->max_contrast;
+
+
+    switch (Model->protocol) {
+    case 1:
+	cmd[0] = 'K';
+	cmd[1] = contrast;
+	drv_EA232graphic_send(cmd, 2);
+	break;
+    case 2:
+	cmd[0] = ESC;
+	cmd[1] = 'D';
+	cmd[2] = 'K';
+	cmd[3] = contrast;
+	drv_EA232graphic_send(cmd, 4);
+	break;
+    default:
+	error("%s: undefined protocol type", Name);
+	return -1;
+    }
+
+    return contrast;
+}
+
+
+/* start graphic display */
+static int drv_EA232graphic_start(const char *section)
+{
+    char *s;
+    int contrast;
+    int i;
+
+    /* read model from configuration */
+    s = cfg_get(section, "Model", NULL);
+    if (s == NULL || *s == '\0') {
+	error("%s: no '%s.Model' entry from %s", Name, section, cfg_source());
+	return -1;
+    }
+
+    for (i = 0; Models[i].name != NULL; i++) {
+	if (strcasecmp(Models[i].name, s) == 0)
+	    break;
+    }
+    if (!Models[i].name) {
+	error("%s: %s.Model '%s' is unknown from %s", Name, section, s, cfg_source());
+	free(s);
+	return -1;
+    }
+    Model = &Models[i];
+    info("%s: using model '%s'", Name, Model->name);
+    free(s);
+
+    /* read display size from model configuration */
+    DROWS = Model->rows;
+    DCOLS = Model->columns;
+
+    /* set number of GPO's from model */
+    GPOS = Model->gpo;
+
+    /* read font size from configuration */
+    s = cfg_get(section, "Font", "6x8");
+    if (s == NULL || *s == '\0') {
+	error("%s: no '%s.Font' entry from %s", Name, section, cfg_source());
+	return -1;
+    }
+
+    XRES = -1;
+    YRES = -1;
+    if (sscanf(s, "%dx%d", &XRES, &YRES) != 2 || XRES < 1 || YRES < 1) {
+	error("%s: bad Font '%s' from %s", Name, s, cfg_source());
+	free(s);
+	return -1;
+    }
+
+    /* Fixme: provider other fonts someday... */
+    if (XRES != 6 && YRES != 8) {
+	error("%s: bad Font '%s' from %s (only 6x8 at the moment)", Name, s, cfg_source());
+	free(s);
+	return -1;
+    }
+    free(s);
+
+    /* open communication with the display */
+    if (drv_EA232graphic_open(section) < 0) {
+	return -1;
+    }
+
+    /* reset & initialize display */
+    drv_EA232graphic_clear_display();
+
+    if (cfg_number(section, "Contrast", Model->default_contrast, 0, Model->max_contrast, &contrast) > 0) {
+	drv_EA232graphic_contrast(contrast);
+    }
+
+    return 0;
+}
+
+
+/****************************************/
+/***            plugins               ***/
+/****************************************/
+
+static void plugin_contrast(RESULT * result, RESULT * arg1)
+{
+    double contrast;
+
+    contrast = drv_EA232graphic_contrast(R2N(arg1));
+    SetResult(&result, R_NUMBER, &contrast);
+}
+
+
+/****************************************/
+/***        widget callbacks          ***/
+/****************************************/
+
+
+/* using drv_generic_text_draw(W) */
+/* using drv_generic_text_icon_draw(W) */
+/* using drv_generic_text_bar_draw(W) */
+/* using drv_generic_gpio_draw(W) */
+
+
+/****************************************/
+/***        exported functions        ***/
+/****************************************/
+
+
+/* list models */
+int drv_EA232graphic_list(void)
+{
+    int i;
+
+    for (i = 0; Models[i].name; i++) {
+	printf("%s ", Models[i].name);
+    }
+
+    return 0;
+}
+
+
+/* initialize driver & display */
+int drv_EA232graphic_init(const char *section, const int quiet)
+{
+    int ret;
+
+    /* real worker functions */
+    drv_generic_graphic_real_blit = drv_EA232graphic_blit;
+    drv_generic_gpio_real_set = drv_EA232graphic_GPO;
+
+    /* start display */
+    if ((ret = drv_EA232graphic_start(section)) != 0)
+	return ret;
+
+    /* initialize generic graphic driver */
+    if ((ret = drv_generic_graphic_init(section, Name)) != 0)
+	return ret;
+
+    /* initialize GPO */
+    if (Model->gpo > 0 && (ret = drv_generic_gpio_init(section, Name)) != 0)
+	return ret;
+
+    if (!quiet) {
+	char buffer[40];
+	qprintf(buffer, sizeof(buffer), "%s %dx%d", Name, DCOLS, DROWS);
+	if (drv_generic_graphic_greet(buffer, NULL)) {
+	    sleep(3);
+	    drv_generic_graphic_clear();
+	}
+    }
+
+    /* register plugins */
+    AddFunction("LCD::contrast", 1, plugin_contrast);
+
+    return 0;
+}
+
+/* close driver & display */
+int drv_EA232graphic_quit(const int quiet)
+{
+
+    info("%s: shutting down.", Name);
+
+    /* clear display */
+    drv_generic_graphic_clear();
+
+    /* say goodbye... */
+    if (!quiet) {
+	drv_generic_graphic_greet("goodbye!", NULL);
+    }
+
+    drv_generic_graphic_quit();
+
+    if (Model->gpo > 0)
+	drv_generic_gpio_quit();
+
+    debug("%s: closing connection", Name);
+    drv_EA232graphic_close();
+
+    return (0);
+}
+
+/* use this one for a graphic display */
+DRIVER drv_EA232graphic = {
+    .name = Name,
+    .list = drv_EA232graphic_list,
+    .init = drv_EA232graphic_init,
+    .quit = drv_EA232graphic_quit,
+};
diff -urN lcd4linux-0.10.0/drv_G15.c lcd4linux-0.11.0-SVN/drv_G15.c
--- lcd4linux-0.10.0/drv_G15.c	1970-01-01 01:00:00.000000000 +0100
+++ lcd4linux-0.11.0-SVN/drv_G15.c	2009-01-14 12:29:12.000000000 +0100
@@ -0,0 +1,597 @@
+/* $Id: drv_G15.c 964 2009-01-14 10:29:12Z michael $
+ * $URL: https://ssl.bulix.org/svn/lcd4linux/trunk/drv_G15.c $
+ *
+ * Driver for Logitech G-15 keyboard LCD screen
+ *
+ * Copyright (C) 2006 Dave Ingram <dave@partis-project.net>
+ * Copyright (C) 2005 Michael Reinelt <michael@reinelt.co.at>
+ * Copyright (C) 2005 The LCD4Linux Team <lcd4linux-devel@users.sourceforge.net>
+ *
+ * This file is part of LCD4Linux.
+ *
+ * LCD4Linux is free software; you can redistribute it and/or modify
+ * it under the terms of the GNU General Public License as published by
+ * the Free Software Foundation; either version 2, or (at your option)
+ * any later version.
+ *
+ * LCD4Linux is distributed in the hope that it will be useful,
+ * but WITHOUT ANY WARRANTY; without even the implied warranty of
+ * MERCHANTABILITY or FITNESS FOR A PARTICULAR PURPOSE.  See the
+ * GNU General Public License for more details.
+ *
+ * You should have received a copy of the GNU General Public License
+ * along with this program; if not, write to the Free Software
+ * Foundation, Inc., 675 Mass Ave, Cambridge, MA 02139, USA.
+ *
+ */
+
+/* 
+ *
+ * exported fuctions:
+ *
+ * struct DRIVER drv_G15
+ *
+ */
+
+#include "config.h"
+
+#include <stdlib.h>
+#include <stdio.h>
+#include <string.h>
+#include <errno.h>
+
+#include <usb.h>
+#include <fcntl.h>
+#include <linux/input.h>
+#include <linux/uinput.h>
+
+#include "debug.h"
+#include "cfg.h"
+#include "qprintf.h"
+#include "udelay.h"
+#include "plugin.h"
+#include "drv.h"
+#include "drv_generic_graphic.h"
+#include "thread.h"
+
+#define G15_VENDOR 0x046d
+#define G15_DEVICE 0xc222
+#define M1730_DEVICE 0xc251
+
+#if 0
+#define DEBUG(x) debug("%s(): %s", __FUNCTION__, x);
+#else
+#define DEBUG(x)
+#endif
+
+#define KB_UPDOWN_PRESS
+
+static char Name[] = "G-15";
+
+static usb_dev_handle *g15_lcd;
+
+static unsigned char *g15_image;
+
+unsigned char g_key_states[18];
+unsigned char m_key_states[4];
+unsigned char l_key_states[5];
+
+static int uinput_fd;
+static int kb_mutex;
+static int kb_thread_pid;
+static int kb_single_keypress = 0;
+
+
+/****************************************/
+/***  hardware dependant functions    ***/
+/****************************************/
+
+
+void drv_G15_keyDown(unsigned char scancode)
+{
+    struct input_event event;
+    memset(&event, 0, sizeof(event));
+
+    event.type = EV_KEY;
+    event.code = scancode;
+    event.value = 1;
+    write(uinput_fd, &event, sizeof(event));
+}
+
+void drv_G15_keyUp(unsigned char scancode)
+{
+    struct input_event event;
+    memset(&event, 0, sizeof(event));
+
+    event.type = EV_KEY;
+    event.code = scancode;
+    event.value = 0;
+    write(uinput_fd, &event, sizeof(event));
+}
+
+void drv_G15_keyDownUp(unsigned char scancode)
+{
+    drv_G15_keyDown(scancode);
+    drv_G15_keyUp(scancode);
+
+}
+
+inline unsigned char drv_G15_evalScanCode(int key)
+{
+    /* first 12 G keys produce F1 - F12, thats 0x3a + key */
+    if (key < 12) {
+	return 0x3a + key;
+    }
+
+    /* the other keys produce Key '1' (above letters) + key, thats 0x1e + key */
+    else {
+	return 0x1e + key - 12;	/* sigh, half an hour to find  -12 .... */
+    }
+}
+
+void drv_G15_processKeyEvent(unsigned char *buffer)
+{
+    const int g_scancode_offset = 167;
+    const int m_scancode_offset = 187;
+    const int l_scancode_offset = 191;
+    int i;
+    int is_set;
+    unsigned char m_key_new_states[4];
+    unsigned char l_key_new_states[5];
+    unsigned char orig_scancode;
+
+#if 0
+    printf("%hhx %hhx %hhx %hhx %hhx %hhx %hhx %hhx %hhx \n\n", buffer[0], buffer[1], buffer[2], buffer[3], buffer[4],
+	   buffer[5], buffer[6], buffer[7], buffer[8]);
+    usleep(100);
+#endif
+
+    if (buffer[0] == 0x01) {
+	DEBUG("Checking keys: ");
+
+	for (i = 0; i < 18; ++i) {
+	    orig_scancode = drv_G15_evalScanCode(i);
+	    is_set = 0;
+
+	    if (buffer[1] == orig_scancode || buffer[2] == orig_scancode || buffer[3] == orig_scancode ||
+		buffer[4] == orig_scancode || buffer[5] == orig_scancode)
+		is_set = 1;
+
+	    if (!is_set && g_key_states[i] != 0) {
+		/* key was pressed but is no more */
+		if (!kb_single_keypress)
+		    drv_G15_keyUp(g_scancode_offset + i);
+		g_key_states[i] = 0;
+		debug("G%d going up", (i + 1));
+	    } else if (is_set && g_key_states[i] == 0) {
+		if (!kb_single_keypress)
+		    drv_G15_keyDown(g_scancode_offset + i);
+		else
+		    drv_G15_keyDownUp(g_scancode_offset + i);
+
+		g_key_states[i] = 1;
+		debug("G%d going down", (i + 1));
+	    }
+	}
+    } else {
+	if (buffer[0] == 0x02) {
+	    memset(m_key_new_states, 0, sizeof(m_key_new_states));
+
+	    if (buffer[6] & 0x01)
+		m_key_new_states[0] = 1;
+	    if (buffer[7] & 0x02)
+		m_key_new_states[1] = 1;
+	    if (buffer[8] & 0x04)
+		m_key_new_states[2] = 1;
+	    if (buffer[7] & 0x40)
+		m_key_new_states[3] = 1;
+
+	    for (i = 0; i < 4; ++i) {
+		if (!m_key_new_states[i] && m_key_states[i] != 0) {
+		    /* key was pressed but is no more */
+		    if (!kb_single_keypress)
+			drv_G15_keyUp(m_scancode_offset + i);
+		    m_key_states[i] = 0;
+		    debug("M%d going up", (i + 1));
+		} else if (m_key_new_states[i] && m_key_states[i] == 0) {
+		    if (!kb_single_keypress)
+			drv_G15_keyDown(m_scancode_offset + i);
+		    else
+			drv_G15_keyDownUp(m_scancode_offset + i);
+		    m_key_states[i] = 1;
+		    debug("M%d going down", (i + 1));
+		}
+	    }
+
+	    memset(l_key_new_states, 0, sizeof(l_key_new_states));
+	    if (buffer[8] & 0x80)
+		l_key_new_states[0] = 1;
+	    if (buffer[2] & 0x80)
+		l_key_new_states[1] = 1;
+	    if (buffer[3] & 0x80)
+		l_key_new_states[2] = 1;
+	    if (buffer[4] & 0x80)
+		l_key_new_states[3] = 1;
+	    if (buffer[5] & 0x80)
+		l_key_new_states[4] = 1;
+
+	    for (i = 0; i < 5; ++i) {
+		if (!l_key_new_states[i] && l_key_states[i] != 0) {
+		    /* key was pressed but is no more */
+		    if (!kb_single_keypress)
+			drv_G15_keyUp(l_scancode_offset + i);
+		    l_key_states[i] = 0;
+		    debug("L%d going up", (i + 1));
+		} else if (l_key_new_states[i] && l_key_states[i] == 0) {
+		    if (!kb_single_keypress)
+			drv_G15_keyDown(l_scancode_offset + i);
+		    else
+			drv_G15_keyDownUp(l_scancode_offset + i);
+		    l_key_states[i] = 1;
+		    debug("L%d going down", (i + 1));
+		}
+	    }
+
+	}
+    }
+}
+
+void drv_G15_closeUIDevice()
+{
+    DEBUG("closing device");
+    ioctl(uinput_fd, UI_DEV_DESTROY);
+    close(uinput_fd);
+}
+
+
+void drv_G15_initKeyHandling(char *device_filename)
+{
+    struct uinput_user_dev device;
+    int i;
+    DEBUG("Key Handling init")
+	uinput_fd = open(device_filename, O_RDWR);
+
+    if (uinput_fd < 0) {
+	info("Error, could not open the uinput device");
+	info("Compile your kernel for uinput, calling it a day now");
+	info("mknod uinput c 10 223");
+	abort();
+    }
+    memset(&device, 0, sizeof(device));
+    strncpy(device.name, "G15 Keys", UINPUT_MAX_NAME_SIZE);
+    device.id.bustype = BUS_USB;
+    device.id.version = 4;
+
+    ioctl(uinput_fd, UI_SET_EVBIT, EV_KEY);
+
+    for (i = 0; i < 256; ++i)
+	ioctl(uinput_fd, UI_SET_KEYBIT, i);
+
+    write(uinput_fd, &device, sizeof(device));
+
+    if (ioctl(uinput_fd, UI_DEV_CREATE)) {
+	info("Failed to create input device");
+	abort();
+    }
+
+/*  atexit(&closeDevice); */
+
+    memset(g_key_states, 0, sizeof(g_key_states));
+    memset(m_key_states, 0, sizeof(m_key_states));
+    memset(l_key_states, 0, sizeof(l_key_states));
+}
+
+
+static void drv_G15_KBThread(void __attribute__ ((unused)) * notused)
+{
+    unsigned char buffer[9];
+    int ret;
+    while (1) {
+	mutex_lock(kb_mutex);
+	ret = usb_bulk_read(g15_lcd, 0x81, (char *) buffer, 9, 10);
+/*      ret = usb_interrupt_read(g15_lcd, 0x81, (char*)buffer, 9, 10); */
+	mutex_unlock(kb_mutex);
+	if (ret == 9) {
+	    drv_G15_processKeyEvent(buffer);
+	}
+    }
+}
+
+static int drv_G15_open()
+{
+    struct usb_bus *bus;
+    struct usb_device *dev;
+    char dname[32] = { 0 };
+
+    g15_lcd = NULL;
+
+    info("%s: Scanning USB for G-15 keyboard...", Name);
+
+    usb_init();
+    usb_set_debug(0);
+    usb_find_busses();
+    usb_find_devices();
+
+    for (bus = usb_get_busses(); bus; bus = bus->next) {
+	for (dev = bus->devices; dev; dev = dev->next) {
+	    if ((g15_lcd = usb_open(dev))) {
+		if (dev->descriptor.idVendor == G15_VENDOR) {
+		    switch (dev->descriptor.idProduct) {
+		    case G15_DEVICE:
+		    case M1730_DEVICE:
+			{
+			    /* detach from the kernel if we need to */
+			    int retval = usb_get_driver_np(g15_lcd, 0, dname, 31);
+			    if (retval == 0 && strcmp(dname, "usbhid") == 0) {
+				usb_detach_kernel_driver_np(g15_lcd, 0);
+			    }
+			    usb_set_configuration(g15_lcd, 1);
+			    usleep(100);
+			    usb_claim_interface(g15_lcd, 0);
+			    return 0;
+			}
+		    default:
+			usb_close(g15_lcd);
+		    }
+		}
+	    }
+	}
+    }
+
+    return -1;
+}
+
+
+static int drv_G15_close(void)
+{
+    usb_release_interface(g15_lcd, 0);
+    if (g15_lcd)
+	usb_close(g15_lcd);
+
+    return 0;
+}
+
+
+static void drv_G15_update_img()
+{
+    int i, j, k;
+    unsigned char *output = malloc(160 * 43 * sizeof(unsigned char));
+
+    DEBUG("entered");
+    if (!output)
+	return;
+
+    DEBUG("memory allocated");
+    memset(output, 0, 160 * 43);
+    DEBUG("memory set");
+    output[0] = 0x03;
+    DEBUG("first output set");
+
+    for (k = 0; k < 6; k++) {
+	for (i = 0; i < 160; i++) {
+	    int maxj = (k == 5) ? 3 : 8;
+	    for (j = 0; j < maxj; j++) {
+		if (g15_image[(k * 1280) + i + (j * 160)])
+		    output[32 + i + (k * 160)] |= (1 << j);
+	    }
+	}
+    }
+
+    DEBUG("output array prepared");
+    mutex_lock(kb_mutex);
+    usb_interrupt_write(g15_lcd, 0x02, (char *) output, 992, 1000);
+    mutex_unlock(kb_mutex);
+    usleep(300);
+
+    DEBUG("data written to LCD");
+
+    free(output);
+
+    DEBUG("memory freed");
+    DEBUG("left");
+}
+
+
+
+/* for graphic displays only */
+static void drv_G15_blit(const int row, const int col, const int height, const int width)
+{
+    int r, c;
+
+    DEBUG("entered");
+
+    for (r = row; r < row + height; r++) {
+	for (c = col; c < col + width; c++) {
+	    g15_image[r * 160 + c] = drv_generic_graphic_black(r, c);
+	}
+    }
+
+    DEBUG("updating image");
+
+    drv_G15_update_img();
+
+    DEBUG("left");
+}
+
+
+/* start graphic display */
+static int drv_G15_start(const char *section)
+{
+    char *s;
+
+    DEBUG("entered");
+
+    /* read display size from config */
+    DROWS = 43;
+    DCOLS = 160;
+
+    DEBUG("display size set");
+
+    s = cfg_get(section, "Font", "6x8");
+    if (s == NULL || *s == '\0') {
+	error("%s: no '%s.Font' entry from %s", Name, section, cfg_source());
+	return -1;
+    }
+
+    XRES = -1;
+    YRES = -1;
+    if (sscanf(s, "%dx%d", &XRES, &YRES) != 2 || XRES < 1 || YRES < 1) {
+	error("%s: bad Font '%s' from %s", Name, s, cfg_source());
+	return -1;
+    }
+
+    /* Fixme: provider other fonts someday... */
+    if (XRES != 6 && YRES != 8) {
+	error("%s: bad Font '%s' from %s (only 6x8 at the moment)", Name, s, cfg_source());
+	return -1;
+    }
+
+    DEBUG("Finished config stuff");
+
+    DEBUG("allocating image buffer");
+    /* you surely want to allocate a framebuffer or something... */
+    g15_image = malloc(160 * 43 * sizeof(unsigned char));
+    if (!g15_image)
+	return -1;
+    DEBUG("allocated");
+    memset(g15_image, 0, 160 * 43);
+    DEBUG("zeroed");
+
+    /* open communication with the display */
+    DEBUG("opening display...");
+    if (drv_G15_open() < 0) {
+	DEBUG("opening failed");
+	return -1;
+    }
+    DEBUG("display open");
+
+    /* reset & initialize display */
+    DEBUG("clearing display");
+    drv_G15_update_img();
+    DEBUG("done");
+
+    /*
+       if (cfg_number(section, "Contrast", 0, 0, 255, &contrast) > 0) {
+       drv_G15_contrast(contrast);
+       }
+     */
+    s = cfg_get(section, "Uinput", "");
+    if (s != NULL && *s != '\0') {
+	cfg_number(section, "SingleKeyPress", 0, 0, 1, &kb_single_keypress);
+	drv_G15_initKeyHandling(s);
+
+	DEBUG("creating thread for keyboard");
+	kb_mutex = mutex_create();
+	kb_thread_pid = thread_create("G15_KBThread", drv_G15_KBThread, NULL);
+
+	DEBUG("done");
+    }
+    DEBUG("left");
+
+    return 0;
+}
+
+
+/****************************************/
+/***            plugins               ***/
+/****************************************/
+
+/* none */
+
+
+/****************************************/
+/***        exported functions        ***/
+/****************************************/
+
+
+/* list models */
+int drv_G15_list(void)
+{
+    printf("generic");
+    return 0;
+}
+
+
+/* initialize driver & display */
+int drv_G15_init(const char *section, const int quiet)
+{
+    int ret;
+
+    info("%s: %s", Name, "$Rev: 964 $");
+
+    DEBUG("entered");
+
+    /* real worker functions */
+    drv_generic_graphic_real_blit = drv_G15_blit;
+
+    /* start display */
+    if ((ret = drv_G15_start(section)) != 0)
+	return ret;
+
+    /* initialize generic graphic driver */
+    if ((ret = drv_generic_graphic_init(section, Name)) != 0)
+	return ret;
+
+    if (!quiet) {
+	char buffer[40];
+
+	qprintf(buffer, sizeof(buffer), "%s %dx%d", Name, DCOLS, DROWS);
+	if (drv_generic_graphic_greet(buffer, NULL)) {
+	    sleep(3);
+	    drv_generic_graphic_clear();
+	}
+    }
+
+    /* register plugins */
+    /* none at the moment... */
+
+
+    DEBUG("left");
+
+    return 0;
+}
+
+
+
+/* close driver & display */
+int drv_G15_quit(const int quiet)
+{
+    info("%s: shutting down.", Name);
+
+    DEBUG("clearing display");
+    /* clear display */
+    drv_generic_graphic_clear();
+
+    DEBUG("saying goodbye");
+    /* say goodbye... */
+    if (!quiet) {
+	drv_generic_graphic_greet("goodbye!", NULL);
+    }
+
+    DEBUG("generic_graphic_quit()");
+    drv_generic_graphic_quit();
+
+    mutex_destroy(kb_mutex);
+    usleep(10 * 1000);
+    thread_destroy(kb_thread_pid);
+
+    drv_G15_closeUIDevice();
+    DEBUG("closing UInputDev");
+
+
+    DEBUG("closing connection");
+    drv_G15_close();
+
+    DEBUG("freeing image alloc");
+    free(g15_image);
+
+    return (0);
+}
+
+
+DRIVER drv_G15 = {
+    .name = Name,
+    .list = drv_G15_list,
+    .init = drv_G15_init,
+    .quit = drv_G15_quit,
+};
diff -urN lcd4linux-0.10.0/drv_generic.c lcd4linux-0.11.0-SVN/drv_generic.c
--- lcd4linux-0.10.0/drv_generic.c	1970-01-01 01:00:00.000000000 +0100
+++ lcd4linux-0.11.0-SVN/drv_generic.c	2008-12-31 08:05:54.000000000 +0100
@@ -0,0 +1,115 @@
+/* $Id: drv_generic.c 840 2007-09-09 12:17:42Z michael $
+ * $URL: https://ssl.bulix.org/svn/lcd4linux/trunk/drv_generic.c $
+ *
+ * generic driver helper
+ *
+ * Copyright (C) 2006 Michael Reinelt <michael@reinelt.co.at>
+ * Copyright (C) 2006 The LCD4Linux Team <lcd4linux-devel@users.sourceforge.net>
+ *
+ * This file is part of LCD4Linux.
+ *
+ * LCD4Linux is free software; you can redistribute it and/or modify
+ * it under the terms of the GNU General Public License as published by
+ * the Free Software Foundation; either version 2, or (at your option)
+ * any later version.
+ *
+ * LCD4Linux is distributed in the hope that it will be useful,
+ * but WITHOUT ANY WARRANTY; without even the implied warranty of
+ * MERCHANTABILITY or FITNESS FOR A PARTICULAR PURPOSE.  See the
+ * GNU General Public License for more details.
+ *
+ * You should have received a copy of the GNU General Public License
+ * along with this program; if not, write to the Free Software
+ * Foundation, Inc., 675 Mass Ave, Cambridge, MA 02139, USA.
+ *
+ */
+
+/* 
+ *
+ * exported functions:
+ *
+ * drv_generic_init (void)
+ *   initializes generic stuff and registers plugins
+ *
+ */
+
+
+#include "config.h"
+
+#include <stdlib.h>
+#include <stdio.h>
+#include <string.h>
+
+#include "debug.h"
+#include "plugin.h"
+#include "drv_generic.h"
+
+#ifdef WITH_DMALLOC
+#include <dmalloc.h>
+#endif
+
+/* these values are chars (text displays) or pixels (graphic displays) */
+
+int LROWS = 0;			/* layout size: rows */
+int LCOLS = 0;			/* layout size: columns */
+
+int DROWS = 4;			/* display size:  rows */
+int DCOLS = 20;			/* display size: columns */
+
+int XRES = 6;			/* pixel widtht of one char */
+int YRES = 8;			/* pixel height of one char */
+
+
+void (*drv_generic_blit) () = NULL;
+
+
+static void my_drows(RESULT * result)
+{
+    double value = DROWS;
+    SetResult(&result, R_NUMBER, &value);
+}
+
+static void my_dcols(RESULT * result)
+{
+    double value = DCOLS;
+    SetResult(&result, R_NUMBER, &value);
+}
+
+static void my_xres(RESULT * result)
+{
+    double value = XRES;
+    SetResult(&result, R_NUMBER, &value);
+}
+
+static void my_yres(RESULT * result)
+{
+    double value = YRES;
+    SetResult(&result, R_NUMBER, &value);
+}
+
+static void my_lrows(RESULT * result)
+{
+    double value = LROWS;
+    SetResult(&result, R_NUMBER, &value);
+}
+
+static void my_lcols(RESULT * result)
+{
+    double value = LCOLS;
+    SetResult(&result, R_NUMBER, &value);
+}
+
+int drv_generic_init(void)
+{
+
+    AddFunction("LCD::height", 0, my_drows);
+    AddFunction("LCD::width", 0, my_dcols);
+
+    AddFunction("LCD::xres", 0, my_xres);
+    AddFunction("LCD::yres", 0, my_yres);
+
+    AddFunction("Layout::height", 0, my_lrows);
+    AddFunction("Layout::width", 0, my_lcols);
+
+    return 0;
+}
diff -urN lcd4linux-0.10.0/drv_generic_gpio.c lcd4linux-0.11.0-SVN/drv_generic_gpio.c
--- lcd4linux-0.10.0/drv_generic_gpio.c	1970-01-01 01:00:00.000000000 +0100
+++ lcd4linux-0.11.0-SVN/drv_generic_gpio.c	2008-12-31 08:05:54.000000000 +0100
@@ -0,0 +1,246 @@
+/* $Id: drv_generic_gpio.c 840 2007-09-09 12:17:42Z michael $
+ * $URL: https://ssl.bulix.org/svn/lcd4linux/trunk/drv_generic_gpio.c $
+ *
+ * generic driver helper for GPO's
+ *
+ * Copyright (C) 2005 Michael Reinelt <michael@reinelt.co.at>
+ * Copyright (C) 2005 The LCD4Linux Team <lcd4linux-devel@users.sourceforge.net>
+ *
+ * This file is part of LCD4Linux.
+ *
+ * LCD4Linux is free software; you can redistribute it and/or modify
+ * it under the terms of the GNU General Public License as published by
+ * the Free Software Foundation; either version 2, or (at your option)
+ * any later version.
+ *
+ * LCD4Linux is distributed in the hope that it will be useful,
+ * but WITHOUT ANY WARRANTY; without even the implied warranty of
+ * MERCHANTABILITY or FITNESS FOR A PARTICULAR PURPOSE.  See the
+ * GNU General Public License for more details.
+ *
+ * You should have received a copy of the GNU General Public License
+ * along with this program; if not, write to the Free Software
+ * Foundation, Inc., 675 Mass Ave, Cambridge, MA 02139, USA.
+ *
+ */
+
+/* 
+ *
+ * exported variables:
+ *
+ * extern int GPIS, GPOS;    number of Inputs and Outputs
+ *
+ *
+ * these functions must be implemented by the real driver:
+ *
+ * int (*drv_generic_gpio_real_set) (const int num, const int val);
+ *   sets GPO num to val, returns the actal value
+ *
+ * int (*drv_generic_gpio_real_get) (const int num);
+ *   reads GPI num
+ *
+ *
+ * exported fuctions:
+ *
+ * int drv_generic_gpio_init(const char *section, const char *driver)
+ *   initializes the generic GPIO driver
+ *
+ * int drv_generic_gpio_clear(void);
+ *   resets all GPO's
+ *
+ * int drv_generic_gpio_get (const int num)
+ *   returns value og GPI #num
+ *
+ * int drv_generic_gpio_draw(WIDGET * W)
+ *   'draws' GPO widget
+ *   calls drv_generic_gpio_real_set()
+ * 
+ * int drv_generic_gpio_quit(void)
+ *   closes the generic GPIO driver
+ *
+ */
+
+#include "config.h"
+
+#include <stdio.h>
+
+#include "debug.h"
+#include "plugin.h"
+#include "widget.h"
+#include "widget_gpo.h"
+
+#include "drv_generic_gpio.h"
+
+#ifdef WITH_DMALLOC
+#include <dmalloc.h>
+#endif
+
+#define MAX_GPIS 32
+#define MAX_GPOS 32
+
+
+static char *Section = NULL;
+static char *Driver = NULL;
+
+static int GPI[MAX_GPIS];
+static int GPO[MAX_GPOS];
+
+int GPOS = 0;
+int GPIS = 0;
+
+int (*drv_generic_gpio_real_set) () = NULL;
+int (*drv_generic_gpio_real_get) () = NULL;
+
+
+static void drv_generic_gpio_plugin_gpi(RESULT * result, RESULT * arg1)
+{
+    int num;
+    double val;
+
+    num = R2N(arg1);
+
+    if (num <= 0 || num > GPIS) {
+	error("%s::GPI(%d): GPI out of range (1..%d)", Driver, num, GPIS);
+	SetResult(&result, R_STRING, "");
+	return;
+    }
+
+    val = drv_generic_gpio_get(num - 1);
+    SetResult(&result, R_NUMBER, &val);
+}
+
+
+static void drv_generic_gpio_plugin_gpo(RESULT * result, const int argc, RESULT * argv[])
+{
+    int num, val;
+    double gpo;
+
+    switch (argc) {
+    case 1:
+	num = R2N(argv[0]);
+	if (num <= 0 || num > GPOS) {
+	    error("%s::GPO(%d): GPO out of range (1..%d)", Driver, num, GPOS);
+	    SetResult(&result, R_STRING, "");
+	    return;
+	}
+	gpo = GPO[num - 1];
+	SetResult(&result, R_NUMBER, &gpo);
+	break;
+    case 2:
+	num = R2N(argv[0]);
+	val = R2N(argv[1]);
+	if (num <= 0 || num > GPOS) {
+	    error("%s::GPO(%d): GPO out of range (1..%d)", Driver, num, GPOS);
+	    SetResult(&result, R_STRING, "");
+	    return;
+	}
+	if (GPO[num - 1] != val) {
+	    if (drv_generic_gpio_real_set)
+		GPO[num - 1] = drv_generic_gpio_real_set(num - 1, val);
+	}
+	gpo = GPO[num - 1];
+	SetResult(&result, R_NUMBER, &gpo);
+	break;
+    default:
+	error("%s::GPO(): wrong number of parameters", Driver);
+	SetResult(&result, R_STRING, "");
+    }
+}
+
+
+int drv_generic_gpio_init(const char *section, const char *driver)
+{
+    WIDGET_CLASS wc;
+
+    Section = (char *) section;
+    Driver = (char *) driver;
+
+    info("%s: using %d GPI's and %d GPO's", Driver, GPIS, GPOS);
+
+    /* reset all GPO's */
+    drv_generic_gpio_clear();
+
+    /* register gpo widget */
+    wc = Widget_GPO;
+    wc.draw = drv_generic_gpio_draw;
+    widget_register(&wc);
+
+    /* register plugins */
+    AddFunction("LCD::GPI", 1, drv_generic_gpio_plugin_gpi);
+    AddFunction("LCD::GPO", -1, drv_generic_gpio_plugin_gpo);
+
+    return 0;
+}
+
+
+int drv_generic_gpio_clear(void)
+{
+    int i;
+
+    /* clear GPI buffer */
+    for (i = 0; i < MAX_GPIS; i++) {
+	GPI[i] = 0;
+    }
+
+    /* clear GPO buffer */
+    for (i = 0; i < MAX_GPOS; i++) {
+	GPO[i] = 0;
+    }
+
+    /* really clear GPO's */
+    for (i = 0; i < GPOS; i++) {
+	if (drv_generic_gpio_real_set)
+	    GPO[i] = drv_generic_gpio_real_set(i, 0);
+
+    }
+
+    return 0;
+}
+
+
+int drv_generic_gpio_get(const int num)
+{
+    int val = 0;
+
+    if (num < 0 || num >= GPIS) {
+	error("%s: gpio_get(%d): GPI out of range (0..%d)", Driver, num + 1, GPIS);
+	return -1;
+    }
+
+    if (drv_generic_gpio_real_get)
+	val = drv_generic_gpio_real_get(num);
+
+    GPI[num] = val;
+
+    return val;
+}
+
+
+int drv_generic_gpio_draw(WIDGET * W)
+{
+    WIDGET_GPO *gpo = W->data;
+    int num, val;
+
+    num = W->row;
+    val = P2N(&gpo->expression);
+
+    if (num < 0 || num >= GPOS) {
+	error("%s: gpio_draw(%d): GPO out of range (0..%d)", Driver, num + 1, GPOS);
+	return -1;
+    }
+
+    if (GPO[num] != val) {
+	if (drv_generic_gpio_real_set)
+	    GPO[num] = drv_generic_gpio_real_set(num, val);
+    }
+
+    return 0;
+}
+
+
+int drv_generic_gpio_quit(void)
+{
+    info("%s: shutting down GPIO driver.", Driver);
+    drv_generic_gpio_clear();
+    return 0;
+}
diff -urN lcd4linux-0.10.0/drv_generic_gpio.h lcd4linux-0.11.0-SVN/drv_generic_gpio.h
--- lcd4linux-0.10.0/drv_generic_gpio.h	1970-01-01 01:00:00.000000000 +0100
+++ lcd4linux-0.11.0-SVN/drv_generic_gpio.h	2008-12-31 08:05:54.000000000 +0100
@@ -0,0 +1,47 @@
+/* $Id: drv_generic_gpio.h 840 2007-09-09 12:17:42Z michael $
+ * $URL: https://ssl.bulix.org/svn/lcd4linux/trunk/drv_generic_gpio.h $
+ *
+ * generic driver helper for GPIO's
+ *
+ * Copyright (C) 2005 Michael Reinelt <michael@reinelt.co.at>
+ * Copyright (C) 2005 The LCD4Linux Team <lcd4linux-devel@users.sourceforge.net>
+ *
+ * This file is part of LCD4Linux.
+ *
+ * LCD4Linux is free software; you can redistribute it and/or modify
+ * it under the terms of the GNU General Public License as published by
+ * the Free Software Foundation; either version 2, or (at your option)
+ * any later version.
+ *
+ * LCD4Linux is distributed in the hope that it will be useful,
+ * but WITHOUT ANY WARRANTY; without even the implied warranty of
+ * MERCHANTABILITY or FITNESS FOR A PARTICULAR PURPOSE.  See the
+ * GNU General Public License for more details.
+ *
+ * You should have received a copy of the GNU General Public License
+ * along with this program; if not, write to the Free Software
+ * Foundation, Inc., 675 Mass Ave, Cambridge, MA 02139, USA.
+ *
+ */
+
+
+#ifndef _DRV_GENERIC_GPO_H_
+#define _DRV_GENERIC_GPO_H_
+
+#include "widget.h"
+
+extern int GPIS;		/* number of GPO's */
+extern int GPOS;		/* number of GPO's */
+
+/* these function must be implemented by the real driver */
+extern int (*drv_generic_gpio_real_set) (const int num, const int val);
+extern int (*drv_generic_gpio_real_get) (const int num);
+
+/* generic functions and widget callbacks */
+int drv_generic_gpio_init(const char *section, const char *driver);
+int drv_generic_gpio_clear(void);
+int drv_generic_gpio_get(const int num);
+int drv_generic_gpio_draw(WIDGET * W);
+int drv_generic_gpio_quit(void);
+
+#endif
diff -urN lcd4linux-0.10.0/drv_generic_graphic.c lcd4linux-0.11.0-SVN/drv_generic_graphic.c
--- lcd4linux-0.10.0/drv_generic_graphic.c	2005-05-08 06:32:44.000000000 +0200
+++ lcd4linux-0.11.0-SVN/drv_generic_graphic.c	2009-01-13 13:55:23.000000000 +0100
@@ -1,8 +1,9 @@
-/* $Id
+/* $Id: drv_generic_graphic.c 959 2009-01-13 12:55:23Z michael $
+ * $URL: https://ssl.bulix.org/svn/lcd4linux/trunk/drv_generic_graphic.c $
  *
  * generic driver helper for graphic displays
  *
- * Copyright (C) 1999, 2000 Michael Reinelt <reinelt@eunet.at>
+ * Copyright (C) 1999, 2000 Michael Reinelt <michael@reinelt.co.at>
  * Copyright (C) 2004 The LCD4Linux Team <lcd4linux-devel@users.sourceforge.net>
  *
  * This file is part of LCD4Linux.
@@ -21,72 +22,6 @@
  * along with this program; if not, write to the Free Software
  * Foundation, Inc., 675 Mass Ave, Cambridge, MA 02139, USA.
  *
- *
- * $Log: drv_generic_graphic.c,v $
- * Revision 1.15  2005/05/08 04:32:44  reinelt
- * CodingStyle added and applied
- *
- * Revision 1.14  2005/01/18 06:30:23  reinelt
- * added (C) to all copyright statements
- *
- * Revision 1.13  2005/01/09 10:53:24  reinelt
- * small type in plugin_uname fixed
- * new homepage lcd4linux.bulix.org
- *
- * Revision 1.12  2004/06/26 12:04:59  reinelt
- *
- * uh-oh... the last CVS log message messed up things a lot...
- *
- * Revision 1.11  2004/06/26 09:27:21  reinelt
- *
- * added '-W' to CFLAGS
- * changed all C++ comments to C ones
- * cleaned up a lot of signed/unsigned mistakes
- *
- * Revision 1.10  2004/06/20 10:09:55  reinelt
- *
- * 'const'ified the whole source
- *
- * Revision 1.9  2004/06/09 06:40:29  reinelt
- *
- * splash screen for T6963 driver
- *
- * Revision 1.8  2004/06/08 21:46:38  reinelt
- *
- * splash screen for X11 driver (and generic graphic driver)
- *
- * Revision 1.7  2004/06/01 06:45:30  reinelt
- *
- * some Fixme's processed
- * documented some code
- *
- * Revision 1.6  2004/03/03 03:47:04  reinelt
- * big patch from Martin Hejl:
- * - use qprintf() where appropriate
- * - save CPU cycles on gettimeofday()
- * - add quit() functions to free allocated memory
- * - fixed lots of memory leaks
- *
- * Revision 1.5  2004/02/29 14:30:59  reinelt
- * icon visibility fix for generic graphics from Xavier
- *
- * Revision 1.4  2004/02/24 05:55:04  reinelt
- *
- * X11 driver ported
- *
- * Revision 1.3  2004/02/22 17:35:41  reinelt
- * some fixes for generic graphic driver and T6963
- * removed ^M from plugin_imon (Nico, are you editing under Windows?)
- *
- * Revision 1.2  2004/02/18 06:39:20  reinelt
- * T6963 driver for graphic displays finished
- *
- * Revision 1.1  2004/02/15 21:43:43  reinelt
- * T6963 driver nearly finished
- * framework for graphic displays done
- * i2c_sensors patch from Xavier
- * some more old generation files removed
- *
  */
 
 /* 
@@ -127,27 +62,41 @@
 #include "debug.h"
 #include "cfg.h"
 #include "plugin.h"
+#include "layout.h"
 #include "widget.h"
+#include "property.h"
 #include "widget_text.h"
 #include "widget_icon.h"
 #include "widget_bar.h"
+#include "widget_image.h"
+#include "rgb.h"
 #include "drv.h"
+#include "drv_generic.h"
 #include "drv_generic_graphic.h"
 #include "font_6x8.h"
+#include "font_6x8_bold.h"
 
 #ifdef WITH_DMALLOC
 #include <dmalloc.h>
 #endif
 
+/* pixel colors */
+RGBA FG_COL = {.R = 0x00,.G = 0x00,.B = 0x00,.A = 0xff };
+RGBA BG_COL = {.R = 0xff,.G = 0xff,.B = 0xff,.A = 0xff };
+RGBA BL_COL = {.R = 0xff,.G = 0xff,.B = 0xff,.A = 0x00 };
+RGBA NO_COL = {.R = 0x00,.G = 0x00,.B = 0x00,.A = 0x00 };
 
 static char *Section = NULL;
 static char *Driver = NULL;
 
-int DROWS, DCOLS;		/* display size (pixels!) */
-int LROWS, LCOLS;		/* layout size  (pixels!) */
-int XRES, YRES;			/* pixels of one char cell */
+/* framebuffer */
+static RGBA *drv_generic_graphic_FB[LAYERS] = { NULL, };
 
-unsigned char *drv_generic_graphic_FB = NULL;
+/* inverted colors */
+static int INVERTED = 0;
+
+/* must be implemented by the real driver */
+void (*drv_generic_graphic_real_blit) () = NULL;
 
 
 /****************************************/
@@ -156,8 +105,8 @@
 
 static void drv_generic_graphic_resizeFB(int rows, int cols)
 {
-    unsigned char *newFB;
-    int row, col;
+    RGBA *newFB;
+    int i, l, row, col;
 
     /* Layout FB is large enough */
     if (rows <= LROWS && cols <= LCOLS)
@@ -169,31 +118,110 @@
     if (cols < LCOLS)
 	cols = LCOLS;
 
-    /* allocate new Layout FB */
-    newFB = malloc(cols * rows * sizeof(char));
-    memset(newFB, 0, rows * cols * sizeof(char));
-
-    /* transfer contents */
-    if (drv_generic_graphic_FB != NULL) {
-	for (row = 0; row < LROWS; row++) {
-	    for (col = 0; col < LCOLS; col++) {
-		newFB[row * cols + col] = drv_generic_graphic_FB[row * LCOLS + col];
+    for (l = 0; l < LAYERS; l++) {
+
+	/* allocate and initialize new Layout FB */
+	newFB = malloc(cols * rows * sizeof(*newFB));
+	for (i = 0; i < rows * cols; i++)
+	    newFB[i] = NO_COL;
+
+	/* transfer contents */
+	if (drv_generic_graphic_FB[l] != NULL) {
+	    for (row = 0; row < LROWS; row++) {
+		for (col = 0; col < LCOLS; col++) {
+		    newFB[row * cols + col] = drv_generic_graphic_FB[l][row * LCOLS + col];
+		}
 	    }
+	    free(drv_generic_graphic_FB[l]);
 	}
-	free(drv_generic_graphic_FB);
+	drv_generic_graphic_FB[l] = newFB;
     }
-    drv_generic_graphic_FB = newFB;
 
     LCOLS = cols;
     LROWS = rows;
+
 }
 
+static void drv_generic_graphic_window(int pos, int size, int max, int *wpos, int *wsize)
+{
+    int p1 = pos;
+    int p2 = pos + size;
+
+    *wpos = 0;
+    *wsize = 0;
 
-int drv_generic_graphic_clear(void)
+    if (p1 > max || p2 < 0 || size < 1)
+	return;
+
+    if (p1 < 0)
+	p1 = 0;
+
+    if (p2 > max)
+	p2 = max;
+
+    *wpos = p1;
+    *wsize = p2 - p1;
+}
+
+static void drv_generic_graphic_blit(const int row, const int col, const int height, const int width)
 {
-    memset(drv_generic_graphic_FB, 0, DCOLS * DROWS * sizeof(*drv_generic_graphic_FB));
-    drv_generic_graphic_real_blit(0, 0, DROWS, DCOLS);
-    return 0;
+    if (drv_generic_graphic_real_blit) {
+	int r, c, h, w;
+	drv_generic_graphic_window(row, height, DROWS, &r, &h);
+	drv_generic_graphic_window(col, width, DCOLS, &c, &w);
+	if (h > 0 && w > 0) {
+	    drv_generic_graphic_real_blit(r, c, h, w);
+	}
+    }
+}
+
+static RGBA drv_generic_graphic_blend(const int row, const int col)
+{
+    int l, o;
+    RGBA p;
+    RGBA ret;
+
+    ret.R = BL_COL.R;
+    ret.G = BL_COL.G;
+    ret.B = BL_COL.B;
+    ret.A = 0x00;
+
+    /* find first opaque layer */
+    /* layers below are fully covered */
+    o = LAYERS - 1;
+    for (l = 0; l < LAYERS; l++) {
+	p = drv_generic_graphic_FB[l][row * LCOLS + col];
+	if (p.A == 255) {
+	    o = l;
+	    break;
+	}
+    }
+
+    for (l = o; l >= 0; l--) {
+	p = drv_generic_graphic_FB[l][row * LCOLS + col];
+	switch (p.A) {
+	case 0:
+	    break;
+	case 255:
+	    ret.R = p.R;
+	    ret.G = p.G;
+	    ret.B = p.B;
+	    ret.A = 0xff;
+	    break;
+	default:
+	    ret.R = (p.R * p.A + ret.R * (255 - p.A)) / 255;
+	    ret.G = (p.G * p.A + ret.G * (255 - p.A)) / 255;
+	    ret.B = (p.B * p.A + ret.B * (255 - p.A)) / 255;
+	    ret.A = 0xff;
+	}
+    }
+    if (INVERTED) {
+	ret.R = 255 - ret.R;
+	ret.G = 255 - ret.G;
+	ret.B = 255 - ret.B;
+    }
+
+    return ret;
 }
 
 
@@ -201,10 +229,18 @@
 /*** generic text handling            ***/
 /****************************************/
 
-static void drv_generic_graphic_render(const int row, const int col, const char *txt)
+static void drv_generic_graphic_render(const int layer, const int row, const int col, const RGBA fg, const RGBA bg,
+				       const char *style, const char *txt)
 {
-    int c, r, x, y;
-    int len = strlen(txt);
+    int c, r, x, y, len;
+
+    /* sanity checks */
+    if (layer < 0 || layer >= LAYERS) {
+	error("%s: layer %d out of bounds (0..%d)", Driver, layer, LAYERS - 1);
+	return;
+    }
+
+    len = strlen(txt);
 
     /* maybe grow layout framebuffer */
     drv_generic_graphic_resizeFB(row + YRES, col + XRES * len);
@@ -214,11 +250,22 @@
 
     /* render text into layout FB */
     while (*txt != '\0') {
+	unsigned char *chr;
+
+	if (strcasestr(style, "bold") != NULL) {
+	    chr = Font_6x8_bold[(int) *(unsigned char *) txt];
+	} else {
+	    chr = Font_6x8[(int) *(unsigned char *) txt];
+	}
+
 	for (y = 0; y < YRES; y++) {
 	    int mask = 1 << XRES;
 	    for (x = 0; x < XRES; x++) {
 		mask >>= 1;
-		drv_generic_graphic_FB[(r + y) * LCOLS + c + x] = Font_6x8[(int) *txt][y] & mask ? 1 : 0;
+		if (chr[y] & mask)
+		    drv_generic_graphic_FB[layer][(r + y) * LCOLS + c + x] = fg;
+		else
+		    drv_generic_graphic_FB[layer][(r + y) * LCOLS + c + x] = bg;
 	    }
 	}
 	c += XRES;
@@ -226,7 +273,7 @@
     }
 
     /* flush area */
-    drv_generic_graphic_real_blit(row, col, YRES, XRES * len);
+    drv_generic_graphic_blit(row, col, YRES, XRES * len);
 
 }
 
@@ -255,7 +302,8 @@
 
     for (i = 0; line1[i]; i++) {
 	if (strlen(line1[i]) <= cols) {
-	    drv_generic_graphic_render(YRES * 0, XRES * (cols - strlen(line1[i])) / 2, line1[i]);
+	    drv_generic_graphic_render(0, YRES * 0, XRES * ((cols - strlen(line1[i])) / 2), FG_COL, BG_COL, "norm",
+				       line1[i]);
 	    flag = 1;
 	    break;
 	}
@@ -264,7 +312,8 @@
     if (rows >= 2) {
 	for (i = 0; line2[i]; i++) {
 	    if (strlen(line2[i]) <= cols) {
-		drv_generic_graphic_render(YRES * 1, XRES * (cols - strlen(line2[i])) / 2, line2[i]);
+		drv_generic_graphic_render(0, YRES * 1, XRES * ((cols - strlen(line2[i])) / 2), FG_COL, BG_COL, "norm",
+					   line2[i]);
 		flag = 1;
 		break;
 	    }
@@ -274,7 +323,7 @@
     if (msg1 && rows >= 3) {
 	unsigned int len = strlen(msg1);
 	if (len <= cols) {
-	    drv_generic_graphic_render(YRES * 2, XRES * (cols - len) / 2, msg1);
+	    drv_generic_graphic_render(0, YRES * 2, XRES * ((cols - len) / 2), FG_COL, BG_COL, "norm", msg1);
 	    flag = 1;
 	}
     }
@@ -282,7 +331,7 @@
     if (msg2 && rows >= 4) {
 	unsigned int len = strlen(msg2);
 	if (len <= cols) {
-	    drv_generic_graphic_render(YRES * 3, XRES * (cols - len) / 2, msg2);
+	    drv_generic_graphic_render(0, YRES * 3, XRES * ((cols - len) / 2), FG_COL, BG_COL, "norm", msg2);
 	    flag = 1;
 	}
     }
@@ -294,7 +343,13 @@
 int drv_generic_graphic_draw(WIDGET * W)
 {
     WIDGET_TEXT *Text = W->data;
-    drv_generic_graphic_render(YRES * W->row, XRES * W->col, Text->buffer);
+    RGBA fg, bg;
+
+    fg = W->fg_valid ? W->fg_color : FG_COL;
+    bg = W->bg_valid ? W->bg_color : BG_COL;
+
+    drv_generic_graphic_render(W->layer, YRES * W->row, XRES * W->col, fg, bg, P2S(&Text->style), Text->buffer);
+
     return 0;
 }
 
@@ -306,32 +361,50 @@
 int drv_generic_graphic_icon_draw(WIDGET * W)
 {
     WIDGET_ICON *Icon = W->data;
+    RGBA fg, bg;
     unsigned char *bitmap = Icon->bitmap + YRES * Icon->curmap;
-    int row, col;
+    int layer, row, col;
     int x, y;
+    int visible;
 
+    layer = W->layer;
     row = YRES * W->row;
     col = XRES * W->col;
 
+    fg = W->fg_valid ? W->fg_color : FG_COL;
+    bg = W->bg_valid ? W->bg_color : BG_COL;
+
+    /* sanity check */
+    if (layer < 0 || layer >= LAYERS) {
+	error("%s: layer %d out of bounds (0..%d)", Driver, layer, LAYERS - 1);
+	return -1;
+    }
+
     /* maybe grow layout framebuffer */
     drv_generic_graphic_resizeFB(row + YRES, col + XRES);
 
+    /* Icon visible? */
+    visible = P2N(&Icon->visible) > 0;
+
     /* render icon */
     for (y = 0; y < YRES; y++) {
 	int mask = 1 << XRES;
 	for (x = 0; x < XRES; x++) {
 	    int i = (row + y) * LCOLS + col + x;
 	    mask >>= 1;
-	    if (Icon->visible) {
-		drv_generic_graphic_FB[i] = bitmap[y] & mask ? 1 : 0;
+	    if (visible) {
+		if (bitmap[y] & mask)
+		    drv_generic_graphic_FB[layer][i] = fg;
+		else
+		    drv_generic_graphic_FB[layer][i] = bg;
 	    } else {
-		drv_generic_graphic_FB[i] = 0;
+		drv_generic_graphic_FB[layer][i] = BG_COL;
 	    }
 	}
     }
 
     /* flush area */
-    drv_generic_graphic_real_blit(row, col, YRES, XRES);
+    drv_generic_graphic_blit(row, col, YRES, XRES);
 
     return 0;
 
@@ -345,15 +418,31 @@
 int drv_generic_graphic_bar_draw(WIDGET * W)
 {
     WIDGET_BAR *Bar = W->data;
-    int row, col, len, res, rev, max, val1, val2;
+    RGBA fg, bg, bar[2];
+    int layer, row, col, len, res, rev, max, val1, val2;
     int x, y;
     DIRECTION dir;
+    STYLE style;
 
+    layer = W->layer;
     row = YRES * W->row;
     col = XRES * W->col;
     dir = Bar->direction;
+    style = Bar->style;
     len = Bar->length;
 
+    fg = W->fg_valid ? W->fg_color : FG_COL;
+    bg = W->bg_valid ? W->bg_color : BG_COL;
+
+    bar[0] = Bar->color_valid[0] ? Bar->color[0] : fg;
+    bar[1] = Bar->color_valid[1] ? Bar->color[1] : fg;
+
+    /* sanity check */
+    if (layer < 0 || layer >= LAYERS) {
+	error("%s: layer %d out of bounds (0..%d)", Driver, layer, LAYERS - 1);
+	return -1;
+    }
+
     /* maybe grow layout framebuffer */
     if (dir & (DIR_EAST | DIR_WEST)) {
 	drv_generic_graphic_resizeFB(row + YRES, col + XRES * len);
@@ -387,22 +476,39 @@
     case DIR_EAST:
 	for (y = 0; y < YRES; y++) {
 	    int val = y < YRES / 2 ? val1 : val2;
+	    RGBA bcol = y < YRES / 2 ? bar[0] : bar[1];
+
 	    for (x = 0; x < max; x++) {
-		drv_generic_graphic_FB[(row + y) * LCOLS + col + x] = x < val ? !rev : rev;
+		if (x < val)
+		    drv_generic_graphic_FB[layer][(row + y) * LCOLS + col + x] = rev ? bg : bcol;
+		else
+		    drv_generic_graphic_FB[layer][(row + y) * LCOLS + col + x] = rev ? bcol : bg;
+
+		if (style) {
+		    drv_generic_graphic_FB[layer][(row) * LCOLS + col + x] = fg;
+		    drv_generic_graphic_FB[layer][(row + YRES - 1) * LCOLS + col + x] = fg;
+		}
+	    }
+	    if (style) {
+		drv_generic_graphic_FB[layer][(row + y) * LCOLS + col] = fg;
+		drv_generic_graphic_FB[layer][(row + y) * LCOLS + col + max - 1] = fg;
 	    }
 	}
 	break;
 
-    case DIR_SOUTH:
+    case DIR_NORTH:
 	val1 = max - val1;
 	val2 = max - val2;
 	rev = 1;
 
-    case DIR_NORTH:
-	for (y = 0; y < max; y++) {
-	    for (x = 0; x < XRES; x++) {
-		int val = x < XRES / 2 ? val1 : val2;
-		drv_generic_graphic_FB[(row + y) * LCOLS + col + x] = y < val ? !rev : rev;
+    case DIR_SOUTH:
+	for (x = 0; x < XRES; x++) {
+	    int val = x < XRES / 2 ? val1 : val2;
+	    for (y = 0; y < max; y++) {
+		if (y < val)
+		    drv_generic_graphic_FB[layer][(row + y) * LCOLS + col + x] = rev ? bg : fg;
+		else
+		    drv_generic_graphic_FB[layer][(row + y) * LCOLS + col + x] = rev ? fg : bg;
 	    }
 	}
 	break;
@@ -410,9 +516,9 @@
 
     /* flush area */
     if (dir & (DIR_EAST | DIR_WEST)) {
-	drv_generic_graphic_real_blit(row, col, YRES, XRES * len);
+	drv_generic_graphic_blit(row, col, YRES, XRES * len);
     } else {
-	drv_generic_graphic_real_blit(row, col, YRES * len, XRES);
+	drv_generic_graphic_blit(row, col, YRES * len, XRES);
     }
 
     return 0;
@@ -420,37 +526,189 @@
 
 
 /****************************************/
+/*** generic image handling           ***/
+/****************************************/
+
+int drv_generic_graphic_image_draw(WIDGET * W)
+{
+    WIDGET_IMAGE *Image = W->data;
+    int layer, row, col, width, height;
+    int x, y;
+    int visible;
+
+    layer = W->layer;
+    row = W->row;
+    col = W->col;
+    width = Image->width;
+    height = Image->height;
+
+    /* sanity check */
+    if (layer < 0 || layer >= LAYERS) {
+	error("%s: layer %d out of bounds (0..%d)", Driver, layer, LAYERS - 1);
+	return -1;
+    }
+
+    /* if no size or no image at all, do nothing */
+    if (width <= 0 || height <= 0 || Image->bitmap == NULL) {
+	return 0;
+    }
+
+    /* maybe grow layout framebuffer */
+    drv_generic_graphic_resizeFB(row + height, col + width);
+
+    /* render image */
+    visible = P2N(&Image->visible);
+    for (y = 0; y < height; y++) {
+	for (x = 0; x < width; x++) {
+	    int i = (row + y) * LCOLS + col + x;
+	    if (visible) {
+		drv_generic_graphic_FB[layer][i] = Image->bitmap[y * width + x];
+	    } else {
+		drv_generic_graphic_FB[layer][i] = BG_COL;
+	    }
+	}
+    }
+
+    /* flush area */
+    drv_generic_graphic_blit(row, col, height, width);
+
+    return 0;
+
+}
+
+
+/****************************************/
 /*** generic init/quit                ***/
 /****************************************/
 
 int drv_generic_graphic_init(const char *section, const char *driver)
 {
+    int i, l;
+    char *color;
+    WIDGET_CLASS wc;
+
     Section = (char *) section;
     Driver = (char *) driver;
 
     /* init layout framebuffer */
     LROWS = 0;
     LCOLS = 0;
-    drv_generic_graphic_FB = NULL;
+
+    for (l = 0; l < LAYERS; l++)
+	drv_generic_graphic_FB[l] = NULL;
+
     drv_generic_graphic_resizeFB(DROWS, DCOLS);
 
     /* sanity check */
-    if (drv_generic_graphic_FB == NULL) {
-	error("%s: framebuffer could not be allocated: malloc() failed", Driver);
-	return -1;
+    for (l = 0; l < LAYERS; l++) {
+	if (drv_generic_graphic_FB[l] == NULL) {
+	    error("%s: framebuffer could not be allocated: malloc() failed", Driver);
+	    return -1;
+	}
     }
 
+    /* init generic driver & register plugins */
+    drv_generic_init();
+
+    /* set default colors */
+    color = cfg_get(Section, "foreground", "000000ff");
+    if (color2RGBA(color, &FG_COL) < 0) {
+	error("%s: ignoring illegal color '%s'", Driver, color);
+    }
+    if (color)
+	free(color);
+
+    color = cfg_get(Section, "background", "ffffff00");
+    if (color2RGBA(color, &BG_COL) < 0) {
+	error("%s: ignoring illegal color '%s'", Driver, color);
+    }
+    if (color)
+	free(color);
+
+    color = cfg_get(Section, "basecolor", "ffffff");
+    if (color2RGBA(color, &BL_COL) < 0) {
+	error("%s: ignoring illegal color '%s'", Driver, color);
+    }
+    if (color)
+	free(color);
+
+    /* inverted display? */
+    cfg_number(section, "inverted", 0, 0, 1, &INVERTED);
+
+    /* register text widget */
+    wc = Widget_Text;
+    wc.draw = drv_generic_graphic_draw;
+    widget_register(&wc);
+
+    /* register icon widget */
+    wc = Widget_Icon;
+    wc.draw = drv_generic_graphic_icon_draw;
+    widget_register(&wc);
+
+    /* register bar widget */
+    wc = Widget_Bar;
+    wc.draw = drv_generic_graphic_bar_draw;
+    widget_register(&wc);
+
+    /* register image widget */
+#ifdef WITH_IMAGE
+    wc = Widget_Image;
+    wc.draw = drv_generic_graphic_image_draw;
+    widget_register(&wc);
+#endif
+
+    /* clear framebuffer but do not blit to display */
+    for (l = 0; l < LAYERS; l++)
+	for (i = 0; i < LCOLS * LROWS; i++)
+	    drv_generic_graphic_FB[l][i] = NO_COL;
+
     return 0;
 }
 
 
+int drv_generic_graphic_clear(void)
+{
+    int i, l;
+
+    for (l = 0; l < LAYERS; l++)
+	for (i = 0; i < LCOLS * LROWS; i++)
+	    drv_generic_graphic_FB[l][i] = NO_COL;
+
+    drv_generic_graphic_blit(0, 0, LROWS, LCOLS);
+
+    return 0;
+}
+
+
+RGBA drv_generic_graphic_rgb(const int row, const int col)
+{
+    return drv_generic_graphic_blend(row, col);
+}
+
+
+unsigned char drv_generic_graphic_gray(const int row, const int col)
+{
+    RGBA p = drv_generic_graphic_blend(row, col);
+    return (77 * p.R + 150 * p.G + 28 * p.B) / 255;
+}
+
+
+unsigned char drv_generic_graphic_black(const int row, const int col)
+{
+    return drv_generic_graphic_gray(row, col) < 127;
+}
+
+
 int drv_generic_graphic_quit(void)
 {
-    if (drv_generic_graphic_FB) {
-	free(drv_generic_graphic_FB);
-	drv_generic_graphic_FB = NULL;
-    }
+    int l;
 
+    for (l = 0; l < LAYERS; l++) {
+	if (drv_generic_graphic_FB[l]) {
+	    free(drv_generic_graphic_FB[l]);
+	    drv_generic_graphic_FB[l] = NULL;
+	}
+    }
     widget_unregister();
     return (0);
 }
diff -urN lcd4linux-0.10.0/drv_generic_graphic.h lcd4linux-0.11.0-SVN/drv_generic_graphic.h
--- lcd4linux-0.10.0/drv_generic_graphic.h	2005-05-08 06:32:44.000000000 +0200
+++ lcd4linux-0.11.0-SVN/drv_generic_graphic.h	2009-01-13 13:55:23.000000000 +0100
@@ -1,8 +1,9 @@
-/* $Id: drv_generic_graphic.h,v 1.9 2005/05/08 04:32:44 reinelt Exp $
+/* $Id: drv_generic_graphic.h 959 2009-01-13 12:55:23Z michael $
+ * $URL: https://ssl.bulix.org/svn/lcd4linux/trunk/drv_generic_graphic.h $
  *
  * generic driver helper for graphic displays
  *
- * Copyright (C) 1999, 2000 Michael Reinelt <reinelt@eunet.at>
+ * Copyright (C) 1999, 2000 Michael Reinelt <michael@reinelt.co.at>
  * Copyright (C) 2004 The LCD4Linux Team <lcd4linux-devel@users.sourceforge.net>
  *
  * This file is part of LCD4Linux.
@@ -21,66 +22,29 @@
  * along with this program; if not, write to the Free Software
  * Foundation, Inc., 675 Mass Ave, Cambridge, MA 02139, USA.
  *
- *
- * $Log: drv_generic_graphic.h,v $
- * Revision 1.9  2005/05/08 04:32:44  reinelt
- * CodingStyle added and applied
- *
- * Revision 1.8  2005/01/18 06:30:23  reinelt
- * added (C) to all copyright statements
- *
- * Revision 1.7  2004/06/26 12:04:59  reinelt
- *
- * uh-oh... the last CVS log message messed up things a lot...
- *
- * Revision 1.6  2004/06/26 09:27:21  reinelt
- *
- * added '-W' to CFLAGS
- * changed all C++ comments to C ones
- * cleaned up a lot of signed/unsigned mistakes
- *
- * Revision 1.5  2004/06/20 10:09:55  reinelt
- *
- * 'const'ified the whole source
- *
- * Revision 1.4  2004/06/08 21:46:38  reinelt
- *
- * splash screen for X11 driver (and generic graphic driver)
- *
- * Revision 1.3  2004/06/01 06:45:30  reinelt
- *
- * some Fixme's processed
- * documented some code
- *
- * Revision 1.2  2004/02/18 06:39:20  reinelt
- * T6963 driver for graphic displays finished
- *
- * Revision 1.1  2004/02/15 21:43:43  reinelt
- * T6963 driver nearly finished
- * framework for graphic displays done
- * i2c_sensors patch from Xavier
- * some more old generation files removed
- *
  */
 
 
 #ifndef _DRV_GENERIC_GRAPHIC_H_
 #define _DRV_GENERIC_GRAPHIC_H_
 
-
-#include <termios.h>
+#include "drv_generic.h"
 #include "widget.h"
+#include "rgb.h"
 
+extern RGBA FG_COL;		/* foreground color */
+extern RGBA BG_COL;		/* background color */
+extern RGBA BL_COL;		/* backlight color */
+extern RGBA NO_COL;		/* no color (completely transparent) */
 
-extern int DROWS, DCOLS;	/* display size */
-extern int LROWS, LCOLS;	/* layout size */
-extern int XRES, YRES;		/* pixel width/height of one char  */
+/* these functions must be implemented by the real driver */
+extern void (*drv_generic_graphic_real_blit) (const int row, const int col, const int height, const int width);
 
-/* framebuffer */
-extern unsigned char *drv_generic_graphic_FB;
+/* helper function to get pixel color or gray value */
+extern RGBA drv_generic_graphic_rgb(const int row, const int col);
+extern unsigned char drv_generic_graphic_gray(const int row, const int col);
+extern unsigned char drv_generic_graphic_black(const int row, const int col);
 
-/* these functions must be implemented by the real driver */
-void (*drv_generic_graphic_real_blit) (const int row, const int col, const int height, const int width);
 
 /* generic functions and widget callbacks */
 int drv_generic_graphic_init(const char *section, const char *driver);
diff -urN lcd4linux-0.10.0/drv_generic.h lcd4linux-0.11.0-SVN/drv_generic.h
--- lcd4linux-0.10.0/drv_generic.h	1970-01-01 01:00:00.000000000 +0100
+++ lcd4linux-0.11.0-SVN/drv_generic.h	2008-12-31 08:05:54.000000000 +0100
@@ -0,0 +1,43 @@
+/* $Id: drv_generic.h 840 2007-09-09 12:17:42Z michael $
+ * $URL: https://ssl.bulix.org/svn/lcd4linux/trunk/drv_generic.h $
+ *
+ * generic driver helper
+ *
+ * Copyright (C) 2006 Michael Reinelt <michael@reinelt.co.at>
+ * Copyright (C) 2006 The LCD4Linux Team <lcd4linux-devel@users.sourceforge.net>
+ *
+ * This file is part of LCD4Linux.
+ *
+ * LCD4Linux is free software; you can redistribute it and/or modify
+ * it under the terms of the GNU General Public License as published by
+ * the Free Software Foundation; either version 2, or (at your option)
+ * any later version.
+ *
+ * LCD4Linux is distributed in the hope that it will be useful,
+ * but WITHOUT ANY WARRANTY; without even the implied warranty of
+ * MERCHANTABILITY or FITNESS FOR A PARTICULAR PURPOSE.  See the
+ * GNU General Public License for more details.
+ *
+ * You should have received a copy of the GNU General Public License
+ * along with this program; if not, write to the Free Software
+ * Foundation, Inc., 675 Mass Ave, Cambridge, MA 02139, USA.
+ *
+ */
+
+
+#ifndef _DRV_GENERIC_H_
+#define _DRV_GENERIC_H_
+
+/* these values are chars (text displays) or pixels (graphic displays) */
+
+extern int LROWS, LCOLS;	/* layout size */
+extern int DROWS, DCOLS;	/* display size */
+
+extern int XRES, YRES;		/* pixel width/height of one char */
+
+/* these function must be implemented by the generic driver */
+extern void (*drv_generic_blit) (const int row, const int col, const int height, const int width);
+
+int drv_generic_init(void);
+
+#endif
diff -urN lcd4linux-0.10.0/drv_generic_i2c.c lcd4linux-0.11.0-SVN/drv_generic_i2c.c
--- lcd4linux-0.10.0/drv_generic_i2c.c	2005-06-01 14:50:25.000000000 +0200
+++ lcd4linux-0.11.0-SVN/drv_generic_i2c.c	2008-12-31 08:05:54.000000000 +0100
@@ -1,4 +1,5 @@
-/* $Id: drv_generic_i2c.c,v 1.5 2005/06/01 12:50:25 reinelt Exp $
+/* $Id: drv_generic_i2c.c 771 2007-02-25 12:27:26Z michael $
+ * $URL: https://ssl.bulix.org/svn/lcd4linux/trunk/drv_generic_i2c.c $
  *
  * generic driver helper for i2c displays
  *
@@ -21,29 +22,6 @@
  * along with this program; if not, write to the Free Software
  * Foundation, Inc., 675 Mass Ave, Cambridge, MA 02139, USA.
  *
- *
- * $Log: drv_generic_i2c.c,v $
- * Revision 1.5  2005/06/01 12:50:25  reinelt
- * ifdef'ed unused function to avoid compiler warning
- *
- * Revision 1.4  2005/05/31 20:42:55  lfcorreia
- * new file: lcd4linux_i2c.h
- * avoid the problems detecting the proper I2C kernel include files
- *
- * rearrange all the other autoconf stuff to remove I2C detection
- *
- * new method by Paul Kamphuis to write to the I2C device
- *
- * Revision 1.3  2005/05/08 04:32:44  reinelt
- * CodingStyle added and applied
- *
- * Revision 1.2  2005/04/05 05:12:57  reinelt
- * i2c patch from Paul (still does not work here :-(
- *
- * Revision 1.1  2005/03/28 19:39:23  reinelt
- * HD44780/I2C patch from Luis merged (still does not work for me)
- *
- *
  */
 
     /*
@@ -96,7 +74,7 @@
     data.byte = val;
     args.data = &data;
     if (ioctl(device, I2C_SMBUS, &args) < 0) {
-	info("I2C: device %s IOCTL failed !\n", device);
+	info("I2C: device %d IOCTL failed !\n", device);
     }
 }
 
@@ -125,20 +103,30 @@
     device = cfg_get(Section, "Device", NULL);
     dev = atoi(device);
     info("%s: initializing I2C bus %s", Driver, bus);
-    info("device %d", dev);
     if ((i2c_device = open(bus, O_WRONLY)) < 0) {
 	error("%s: I2C bus %s open failed !\n", Driver, bus);
-	return -1;
+	goto exit_error;
     }
-    info("%s: initializing I2C slave device 0x%x", Driver, dev);
+    info("%s: selecting slave device 0x%x", Driver, dev);
     if (ioctl(i2c_device, I2C_SLAVE, dev) < 0) {
+	error("%s: error selecting slave device 0x%x\n", Driver, dev);
+	goto exit_error;
+    }
+
+    info("%s: initializing I2C slave device 0x%x", Driver, dev);
+    if (i2c_smbus_write_quick(i2c_device, I2C_SMBUS_WRITE) < 0) {
 	error("%s: error initializing device 0x%x\n", Driver, dev);
 	close(i2c_device);
-	return -1;
     }
+
     return 0;
-}
 
+  exit_error:
+    free(bus);
+    free(device);
+    close(i2c_device);
+    return -1;
+}
 
 int drv_generic_i2c_close(void)
 {
@@ -146,7 +134,6 @@
     return 0;
 }
 
-
 unsigned char drv_generic_i2c_wire(const char *name, const char *deflt)
 {
     unsigned char w;
@@ -180,7 +167,7 @@
 }
 
 
-void drv_generic_i2c_command(const unsigned char command, const unsigned char *data, const unsigned char length)
+void drv_generic_i2c_command(const unsigned char command, /*const */ unsigned char *data, const unsigned char length)
 {
-    i2c_smbus_write_block_data(i2c_device, command, length, (unsigned char *) data);
+    i2c_smbus_write_block_data(i2c_device, command, length, data);
 }
diff -urN lcd4linux-0.10.0/drv_generic_i2c.h lcd4linux-0.11.0-SVN/drv_generic_i2c.h
--- lcd4linux-0.10.0/drv_generic_i2c.h	2005-06-01 06:37:04.000000000 +0200
+++ lcd4linux-0.11.0-SVN/drv_generic_i2c.h	2008-12-31 08:05:54.000000000 +0100
@@ -1,79 +1,61 @@
-/* $Id: drv_generic_i2c.h,v 1.4 2005/05/31 21:32:00 lfcorreia Exp $
- *
- * generic driver helper for i2c displays
- *
- * Copyright (C) 2005 Luis Correia <lfcorreia@users.sf.net>
- * Copyright (C) 2005 The LCD4Linux Team <lcd4linux-devel@users.sourceforge.net>
- *
- * This file is part of LCD4Linux.
- *
- * LCD4Linux is free software; you can redistribute it and/or modify
- * it under the terms of the GNU General Public License as published by
- * the Free Software Foundation; either version 2, or (at your option)
- * any later version.
- *
- * LCD4Linux is distributed in the hope that it will be useful,
- * but WITHOUT ANY WARRANTY; without even the implied warranty of
- * MERCHANTABILITY or FITNESS FOR A PARTICULAR PURPOSE.  See the
- * GNU General Public License for more details.
- *
- * You should have received a copy of the GNU General Public License
- * along with this program; if not, write to the Free Software
- * Foundation, Inc., 675 Mass Ave, Cambridge, MA 02139, USA.
- *
- *
- * $Log: drv_generic_i2c.h,v $
- * Revision 1.4  2005/05/31 21:32:00  lfcorreia
- * fix my email address
- *
- * Revision 1.3  2005/05/31 20:42:55  lfcorreia
- * new file: lcd4linux_i2c.h
- * avoid the problems detecting the proper I2C kernel include files
- *
- * rearrange all the other autoconf stuff to remove I2C detection
- *
- * new method by Paul Kamphuis to write to the I2C device
- *
- * Revision 1.2  2005/05/08 04:32:44  reinelt
- * CodingStyle added and applied
- *
- * Revision 1.1  2005/03/28 19:39:23  reinelt
- * HD44780/I2C patch from Luis merged (still does not work for me)
- *
- *
- */  
-    
-/* 
- *
- * exported fuctions:
- *
- * int drv_generic_i2c_open (void)
- *   reads 'Port' entry from config and opens
- *   the i2c port
- *   returns 0 if ok, -1 on failure
- *
- * int drv_generic_i2c_close (void)
- *   closes i2c port
- *   returns 0 if ok, -1 on failure
- *
- * unsigned char drv_generic_i2c_wire (char *name, char *deflt)
- *   reads wiring for one data signal from config
- *   returns 1<<bitpos or 255 on error
- *
- * void drv_generic_i2c_data (unsigned char value)
- *   put data bits on DB1..DB8
- *
- * void drv_generic_i2c_command(unsigned char command, unsigned char *data,unsigned char length)
- *   send command and the data to the i2c device
- * 
- */ 
-    
-#ifndef _DRV_GENERIC_I2C_H_
-#define _DRV_GENERIC_I2C_H_
-int drv_generic_i2c_open(const char *section, const char *driver);
-int drv_generic_i2c_close(void);
-unsigned char drv_generic_i2c_wire(const char *name, const char *deflt);
-void drv_generic_i2c_data(const unsigned char data);
-void drv_generic_i2c_command(const unsigned char command, const unsigned char *data, const unsigned char length);
-
-#endif				/*  */
+/* $Id: drv_generic_i2c.h 771 2007-02-25 12:27:26Z michael $
+ * $URL: https://ssl.bulix.org/svn/lcd4linux/trunk/drv_generic_i2c.h $
+ *
+ * generic driver helper for i2c displays
+ *
+ * Copyright (C) 2005 Luis Correia <lfcorreia@users.sf.net>
+ * Copyright (C) 2005 The LCD4Linux Team <lcd4linux-devel@users.sourceforge.net>
+ *
+ * This file is part of LCD4Linux.
+ *
+ * LCD4Linux is free software; you can redistribute it and/or modify
+ * it under the terms of the GNU General Public License as published by
+ * the Free Software Foundation; either version 2, or (at your option)
+ * any later version.
+ *
+ * LCD4Linux is distributed in the hope that it will be useful,
+ * but WITHOUT ANY WARRANTY; without even the implied warranty of
+ * MERCHANTABILITY or FITNESS FOR A PARTICULAR PURPOSE.  See the
+ * GNU General Public License for more details.
+ *
+ * You should have received a copy of the GNU General Public License
+ * along with this program; if not, write to the Free Software
+ * Foundation, Inc., 675 Mass Ave, Cambridge, MA 02139, USA.
+ *
+ */
+
+/* 
+ *
+ * exported fuctions:
+ *
+ * int drv_generic_i2c_open (void)
+ *   reads 'Port' entry from config and opens
+ *   the i2c port
+ *   returns 0 if ok, -1 on failure
+ *
+ * int drv_generic_i2c_close (void)
+ *   closes i2c port
+ *   returns 0 if ok, -1 on failure
+ *
+ * unsigned char drv_generic_i2c_wire (char *name, char *deflt)
+ *   reads wiring for one data signal from config
+ *   returns 1<<bitpos or 255 on error
+ *
+ * void drv_generic_i2c_data (unsigned char value)
+ *   put data bits on DB1..DB8
+ *
+ * void drv_generic_i2c_command(unsigned char command, unsigned char *data,unsigned char length)
+ *   send command and the data to the i2c device
+ * 
+ */
+
+#ifndef _DRV_GENERIC_I2C_H_
+#define _DRV_GENERIC_I2C_H_
+
+int drv_generic_i2c_open(const char *section, const char *driver);
+int drv_generic_i2c_close(void);
+unsigned char drv_generic_i2c_wire(const char *name, const char *deflt);
+void drv_generic_i2c_data(const unsigned char data);
+void drv_generic_i2c_command(const unsigned char command, /*const */ unsigned char *data, const unsigned char length);
+
+#endif
diff -urN lcd4linux-0.10.0/drv_generic_keypad.c lcd4linux-0.11.0-SVN/drv_generic_keypad.c
--- lcd4linux-0.10.0/drv_generic_keypad.c	1970-01-01 01:00:00.000000000 +0100
+++ lcd4linux-0.11.0-SVN/drv_generic_keypad.c	2008-12-31 08:05:54.000000000 +0100
@@ -0,0 +1,73 @@
+/* $Id: drv_generic_keypad.c 728 2007-01-14 11:14:38Z michael $
+ * $URL: https://ssl.bulix.org/svn/lcd4linux/trunk/drv_generic_keypad.c $
+ *
+ * generic driver helper for keypads
+ *
+ * Copyright (C) 2006 Chris Maj <cmaj@freedomcorpse.com>
+ * Copyright (C) 2006 The LCD4Linux Team <lcd4linux-devel@users.sourceforge.net>
+ *
+ * This file is part of LCD4Linux.
+ *
+ * LCD4Linux is free software; you can redistribute it and/or modify
+ * it under the terms of the GNU General Public License as published by
+ * the Free Software Foundation; either version 2, or (at your option)
+ * any later version.
+ *
+ * LCD4Linux is distributed in the hope that it will be useful,
+ * but WITHOUT ANY WARRANTY; without even the implied warranty of
+ * MERCHANTABILITY or FITNESS FOR A PARTICULAR PURPOSE.  See the
+ * GNU General Public License for more details.
+ *
+ * You should have received a copy of the GNU General Public License
+ * along with this program; if not, write to the Free Software
+ * Foundation, Inc., 675 Mass Ave, Cambridge, MA 02139, USA.
+ *
+ */
+
+#include <stdio.h>
+
+#include "debug.h"
+#include "widget.h"
+#include "widget_keypad.h"
+
+#include "drv_generic_keypad.h"
+
+static char *Section = NULL;
+static char *Driver = NULL;
+
+int (*drv_generic_keypad_real_press) () = NULL;
+
+int drv_generic_keypad_init(const char *section, const char *driver)
+{
+    WIDGET_CLASS wc;
+
+    Section = (char *) section;
+    Driver = (char *) driver;
+
+    /* register keypad widget */
+    wc = Widget_Keypad;
+    widget_register(&wc);
+
+    return 0;
+}
+
+int drv_generic_keypad_press(const int num)
+{
+    WIDGET *w;
+    int val = 0;
+
+    if (drv_generic_keypad_real_press)
+	val = drv_generic_keypad_real_press(num);
+
+    w = widget_find(WIDGET_TYPE_KEYPAD, &val);
+
+    if (w && w->class->draw)
+	w->class->draw(w);
+
+    return val;
+}
+
+int drv_generic_keypad_quit(void)
+{
+    return 0;
+}
diff -urN lcd4linux-0.10.0/drv_generic_keypad.h lcd4linux-0.11.0-SVN/drv_generic_keypad.h
--- lcd4linux-0.10.0/drv_generic_keypad.h	1970-01-01 01:00:00.000000000 +0100
+++ lcd4linux-0.11.0-SVN/drv_generic_keypad.h	2008-12-31 08:05:54.000000000 +0100
@@ -0,0 +1,38 @@
+/* $Id: drv_generic_keypad.h 856 2008-03-03 16:54:18Z michux $
+ * $URL: https://ssl.bulix.org/svn/lcd4linux/trunk/drv_generic_keypad.h $
+ *
+ * generic driver helper for keypads
+ *
+ * Copyright (C) 2006 Chris Maj <cmaj@freedomcorpse.com>
+ * Copyright (C) 2006 The LCD4Linux Team <lcd4linux-devel@users.sourceforge.net>
+ *
+ * This program is free software; you can redistribute it and/or modify
+ * it under the terms of the GNU General Public License as published by
+ * the Free Software Foundation; either version 2, or (at your option)
+ * any later version.
+ *
+ * This program is distributed in the hope that it will be useful,
+ * but WITHOUT ANY WARRANTY; without even the implied warranty of
+ * MERCHANTABILITY or FITNESS FOR A PARTICULAR PURPOSE.  See the
+ * GNU General Public License for more details.
+ *
+ * You should have received a copy of the GNU General Public License
+ * along with this program; if not, write to the Free Software
+ * Foundation, Inc., 675 Mass Ave, Cambridge, MA 02139, USA.
+ *
+ */
+
+#ifndef _DRV_GENERIC_KEYPAD_H_
+#define _DRV_GENERIC_KEYPAD_H_
+
+#include "widget.h"
+
+/* these functions must be implemented by the real driver */
+extern int (*drv_generic_keypad_real_press) (const int num);
+
+/* generic functions and widget callbacks */
+int drv_generic_keypad_init(const char *section, const char *driver);
+int drv_generic_keypad_press(const int num);
+int drv_generic_keypad_quit(void);
+
+#endif
diff -urN lcd4linux-0.10.0/drv_generic_parport.c lcd4linux-0.11.0-SVN/drv_generic_parport.c
--- lcd4linux-0.10.0/drv_generic_parport.c	2005-05-08 06:32:44.000000000 +0200
+++ lcd4linux-0.11.0-SVN/drv_generic_parport.c	2008-12-31 08:05:54.000000000 +0100
@@ -1,8 +1,9 @@
-/* $Id: drv_generic_parport.c,v 1.16 2005/05/08 04:32:44 reinelt Exp $
+/* $Id: drv_generic_parport.c 905 2008-12-23 13:37:07Z michael $
+ * $URL: https://ssl.bulix.org/svn/lcd4linux/trunk/drv_generic_parport.c $
  *
  * generic driver helper for serial and parport access
  *
- * Copyright (C) 1999, 2000 Michael Reinelt <reinelt@eunet.at>
+ * Copyright (C) 1999, 2000 Michael Reinelt <michael@reinelt.co.at>
  * Copyright (C) 2004 The LCD4Linux Team <lcd4linux-devel@users.sourceforge.net>
  *
  * This file is part of LCD4Linux.
@@ -21,76 +22,6 @@
  * along with this program; if not, write to the Free Software
  * Foundation, Inc., 675 Mass Ave, Cambridge, MA 02139, USA.
  *
- *
- * $Log: drv_generic_parport.c,v $
- * Revision 1.16  2005/05/08 04:32:44  reinelt
- * CodingStyle added and applied
- *
- * Revision 1.15  2005/05/05 08:36:12  reinelt
- * changed SELECT to SLCTIN
- *
- * Revision 1.14  2005/05/04 06:13:05  reinelt
- * parport_wire_status() added
- *
- * Revision 1.13  2005/01/18 06:30:23  reinelt
- * added (C) to all copyright statements
- *
- * Revision 1.12  2005/01/06 16:54:54  reinelt
- * M50530 fixes
- *
- * Revision 1.11  2004/09/18 15:58:57  reinelt
- * even more HD44780 cleanups, hardwiring for LCM-162
- *
- * Revision 1.10  2004/09/18 09:48:29  reinelt
- * HD44780 cleanup and prepararation for I2C backend
- * LCM-162 submodel framework
- *
- * Revision 1.9  2004/09/18 08:22:59  reinelt
- * drv_generic_parport_status() to read status lines
- *
- * Revision 1.8  2004/06/26 12:04:59  reinelt
- *
- * uh-oh... the last CVS log message messed up things a lot...
- *
- * Revision 1.7  2004/06/26 09:27:21  reinelt
- *
- * added '-W' to CFLAGS
- * changed all C++ comments to C ones
- * cleaned up a lot of signed/unsigned mistakes
- *
- * Revision 1.6  2004/06/20 10:09:55  reinelt
- *
- * 'const'ified the whole source
- *
- * Revision 1.5  2004/04/12 05:14:42  reinelt
- * another BIG FAT WARNING on the use of raw ports instead of ppdev
- *
- * Revision 1.4  2004/03/03 04:44:16  reinelt
- * changes (cosmetics?) to the big patch from Martin
- * hash patch un-applied
- *
- * Revision 1.3  2004/03/03 03:47:04  reinelt
- * big patch from Martin Hejl:
- * - use qprintf() where appropriate
- * - save CPU cycles on gettimeofday()
- * - add quit() functions to free allocated memory
- * - fixed lots of memory leaks
- *
- * Revision 1.2  2004/01/20 15:32:49  reinelt
- * first version of Next Generation HD44780 (untested! but it compiles...)
- * some cleanup in the other drivers
- *
- * Revision 1.1  2004/01/20 14:35:38  reinelt
- * drv_generic_parport added, code from parport.c
- *
- * Revision 1.2  2004/01/20 05:36:59  reinelt
- * moved text-display-specific stuff to drv_generic_text
- * moved all the bar stuff from drv_generic_bar to generic_text
- *
- * Revision 1.1  2004/01/20 04:51:39  reinelt
- * moved generic stuff from drv_MatrixOrbital to drv_generic
- * implemented new-stylish bars which are nearly finished
- *
  */
 
 #include "config.h"
@@ -134,6 +65,9 @@
 #define PARPORT_STATUS_BUSY       0x80
 #endif
 
+/* these signals are inverted by hardware on the parallel port */
+#define PARPORT_CONTROL_INVERTED (PARPORT_CONTROL_STROBE | PARPORT_CONTROL_SELECT | PARPORT_CONTROL_AUTOFD)
+
 #if !defined(WITH_OUTB) && !defined(WITH_PPDEV)
 #error neither outb() nor ppdev() possible
 #error cannot compile parallel port driver
@@ -151,6 +85,9 @@
 static unsigned short Port = 0;
 static char *PPdev = NULL;
 
+/* Any bits set here will have their logic inverted at the parallel port */
+static unsigned char inverted_control_bits = 0;
+
 /* initial value taken from linux/parport_pc.c */
 static unsigned char ctr = 0xc;
 
@@ -202,11 +139,12 @@
 	    return -1;
 	}
 #if 0
-	/* Fixme: this always fails here... */
+	/* PPEXCL fails if someone else uses the port (e.g. lp.ko) */
 	if (ioctl(PPfd, PPEXCL)) {
-	    debug("ioctl(%s, PPEXCL) failed: %s", PPdev, strerror(errno));
+	    info("%s: ioctl(%s, PPEXCL) failed: %s", PPdev, Driver, strerror(errno));
+	    info("%s: could not get exclusive access to %s.", Driver, PPdev);
 	} else {
-	    debug("ioctl(%s, PPEXCL) succeded.");
+	    info("%s: got exclusive access to %s.", Driver, PPdev);
 	}
 #endif
 
@@ -273,32 +211,43 @@
 static unsigned char drv_generic_parport_signal_ctrl(const char *name, const char *signal)
 {
     unsigned char wire;
+    int invert = 0;
+
+    /* Prefixing a signal name with '-' inverts the logic */
+    if (signal[0] == '-') {
+	invert = 1;
+	signal++;
+    }
 
     if (strcasecmp(signal, "STROBE") == 0) {
 	wire = PARPORT_CONTROL_STROBE;
-	info("%s: wiring: [DISPLAY:%s]<==>[PARPORT:STROBE (Pin 1)]", Driver, name);
+	info("%s: wiring: DISPLAY:%-9s - PARPORT:STROBE (Pin  1)%s", Driver, name, invert ? " [inverted]" : "");
     } else if (strcasecmp(signal, "AUTOFD") == 0) {
 	wire = PARPORT_CONTROL_AUTOFD;
-	info("%s: wiring: [DISPLAY:%s]<==>[PARPORT:AUTOFD (Pin 14)]", Driver, name);
+	info("%s: wiring: DISPLAY:%-9s - PARPORT:AUTOFD (Pin 14)%s", Driver, name, invert ? " [inverted]" : "");
     } else if (strcasecmp(signal, "INIT") == 0) {
 	wire = PARPORT_CONTROL_INIT;
-	info("%s: wiring: [DISPLAY:%s]<==>[PARPORT:INIT (Pin 16)]", Driver, name);
+	info("%s: wiring: DISPLAY:%-9s - PARPORT:INIT   (Pin 16)%s", Driver, name, invert ? " [inverted]" : "");
     } else if (strcasecmp(signal, "SLCTIN") == 0) {
 	wire = PARPORT_CONTROL_SELECT;
-	info("%s: wiring: [DISPLAY:%s]<==>[PARPORT:SLCTIN (Pin 17)]", Driver, name);
+	info("%s: wiring: DISPLAY:%-9s - PARPORT:SLCTIN (Pin 17)%s", Driver, name, invert ? " [inverted]" : "");
     } else if (strcasecmp(signal, "SELECT") == 0) {
 	wire = PARPORT_CONTROL_SELECT;
 	error("%s: SELECT is deprecated. Please use SLCTIN instead!", Driver);
-	info("%s: wiring: [DISPLAY:%s]<==>[PARPORT:SLCTIN (Pin 17)]", Driver, name);
+	info("%s: wiring: DISPLAY:%-9s - PARPORT:SLCTIN (Pin 17)%s", Driver, name, invert ? " [inverted]" : "");
     } else if (strcasecmp(signal, "GND") == 0) {
 	wire = 0;
-	info("%s: wiring: [DISPLAY:%s]<==>[PARPORT:GND]", Driver, name);
+	info("%s: wiring: DISPLAY:%-9s - PARPORT:GND", Driver, name);
     } else {
 	error("%s: unknown signal <%s> for control line <%s>", Driver, signal, name);
 	error("%s: should be STROBE, AUTOFD, INIT, SLCTIN or GND", Driver);
 	return 0xff;
     }
 
+    if (invert) {
+	inverted_control_bits |= wire;
+    }
+
     return wire;
 }
 
@@ -347,22 +296,22 @@
 
     if (strcasecmp(signal, "ERROR") == 0) {
 	wire = PARPORT_STATUS_ERROR;
-	info("%s: wiring: [DISPLAY:%s]<==>[PARPORT:ERROR (Pin 15)]", Driver, name);
+	info("%s: wiring: DISPLAY:%-9s - PARPORT:ERROR    (Pin 15)", Driver, name);
     } else if (strcasecmp(signal, "SELECT") == 0) {
 	wire = PARPORT_STATUS_SELECT;
-	info("%s: wiring: [DISPLAY:%s]<==>[PARPORT:SELECT (Pin 13)]", Driver, name);
+	info("%s: wiring: DISPLAY:%-9s - PARPORT:SELECT   (Pin 13)", Driver, name);
     } else if (strcasecmp(signal, "PAPEROUT") == 0) {
 	wire = PARPORT_STATUS_PAPEROUT;
-	info("%s: wiring: [DISPLAY:%s]<==>[PARPORT:PAPEROUT (Pin 12)]", Driver, name);
+	info("%s: wiring: DISPLAY:%-9s - PARPORT:PAPEROUT (Pin 12)", Driver, name);
     } else if (strcasecmp(signal, "ACK") == 0) {
 	wire = PARPORT_STATUS_ACK;
-	info("%s: wiring: [DISPLAY:%s]<==>[PARPORT:ACK (Pin 10)]", Driver, name);
+	info("%s: wiring: DISPLAY:%-9s - PARPORT:ACK      (Pin 10)", Driver, name);
     } else if (strcasecmp(signal, "BUSY") == 0) {
 	wire = PARPORT_STATUS_BUSY;
-	info("%s: wiring: [DISPLAY:%s]<==>[PARPORT:BUSY (Pin 11)]", Driver, name);
+	info("%s: wiring: DISPLAY:%-9s - PARPORT:BUSY     (Pin 11)", Driver, name);
     } else if (strcasecmp(signal, "GND") == 0) {
 	wire = 0;
-	info("%s: wiring: [DISPLAY:%s]<==>[PARPORT:GND]", Driver, name);
+	info("%s: wiring: DISPLAY:%-9s - PARPORT:GND", Driver, name);
     } else {
 	error("%s: unknown signal <%s> for status line <%s>", Driver, signal, name);
 	error("%s: should be ERROR, SELECT, PAPEROUT, ACK, BUSY or GND", Driver);
@@ -409,9 +358,9 @@
     }
     free(s);
     if (w == 0) {
-	info("%s: wiring: [DISPLAY:%s]<==>[PARPORT:GND]", Driver, name);
+	info("%s: wiring: DISPLAY:%-9s - PARPORT:GND", Driver, name);
     } else {
-	info("%s: wiring: [DISPLAY:%s]<==>[PARPORT:DB%d (Pin %d)]", Driver, name, w, w + 2);
+	info("%s: wiring: DISPLAY:%-9s - PARPORT:DB%d (Pin %2d)", Driver, name, w, w + 2);
     }
 
     w = 1 << w;
@@ -437,7 +386,9 @@
 
 unsigned char drv_generic_parport_status(void)
 {
-    unsigned char mask = PARPORT_STATUS_ERROR | PARPORT_STATUS_SELECT | PARPORT_STATUS_PAPEROUT | PARPORT_STATUS_ACK | PARPORT_STATUS_BUSY;
+    unsigned char mask =
+	PARPORT_STATUS_ERROR | PARPORT_STATUS_SELECT | PARPORT_STATUS_PAPEROUT | PARPORT_STATUS_ACK |
+	PARPORT_STATUS_BUSY;
 
     unsigned char data;
 
@@ -467,7 +418,7 @@
 	return;
 
     /* Strobe, Select and AutoFeed are inverted! */
-    val = mask & (value ^ (PARPORT_CONTROL_STROBE | PARPORT_CONTROL_SELECT | PARPORT_CONTROL_AUTOFD));
+    val = mask & (value ^ PARPORT_CONTROL_INVERTED ^ inverted_control_bits);
 
 #ifdef WITH_PPDEV
     if (PPdev) {
@@ -485,7 +436,7 @@
 }
 
 
-void drv_generic_parport_toggle(const unsigned char bits, const int level, const int delay)
+void drv_generic_parport_toggle(const unsigned char bits, const int level, const unsigned long delay)
 {
     unsigned char value1, value2;
 
@@ -499,9 +450,8 @@
     value2 = level ? 0 : bits;
 
     /* Strobe, Select and AutoFeed are inverted! */
-    value1 = bits & (value1 ^ (PARPORT_CONTROL_STROBE | PARPORT_CONTROL_SELECT | PARPORT_CONTROL_AUTOFD));
-    value2 = bits & (value2 ^ (PARPORT_CONTROL_STROBE | PARPORT_CONTROL_SELECT | PARPORT_CONTROL_AUTOFD));
-
+    value1 = bits & (value1 ^ PARPORT_CONTROL_INVERTED ^ inverted_control_bits);
+    value2 = bits & (value2 ^ PARPORT_CONTROL_INVERTED ^ inverted_control_bits);
 
 #ifdef WITH_PPDEV
     if (PPdev) {
@@ -579,6 +529,7 @@
 
     debug("%cSTROBE %cAUTOFD %cINIT %cSLCTIN",
 	  control & PARPORT_CONTROL_STROBE ? '-' : '+',
-	  control & PARPORT_CONTROL_AUTOFD ? '-' : '+', control & PARPORT_CONTROL_INIT ? '+' : '-', control & PARPORT_CONTROL_SELECT ? '-' : '+');
+	  control & PARPORT_CONTROL_AUTOFD ? '-' : '+', control & PARPORT_CONTROL_INIT ? '+' : '-',
+	  control & PARPORT_CONTROL_SELECT ? '-' : '+');
 
 }
diff -urN lcd4linux-0.10.0/drv_generic_parport.h lcd4linux-0.11.0-SVN/drv_generic_parport.h
--- lcd4linux-0.10.0/drv_generic_parport.h	2005-05-08 06:32:44.000000000 +0200
+++ lcd4linux-0.11.0-SVN/drv_generic_parport.h	2008-12-31 08:05:54.000000000 +0100
@@ -1,8 +1,9 @@
-/* $Id: drv_generic_parport.h,v 1.11 2005/05/08 04:32:44 reinelt Exp $
+/* $Id: drv_generic_parport.h 840 2007-09-09 12:17:42Z michael $
+ * $URL: https://ssl.bulix.org/svn/lcd4linux/trunk/drv_generic_parport.h $
  *
  * generic driver helper for parallel port displays
  *
- * Copyright (C) 1999, 2000 Michael Reinelt <reinelt@eunet.at>
+ * Copyright (C) 1999, 2000 Michael Reinelt <michael@reinelt.co.at>
  * Copyright (C) 2004 The LCD4Linux Team <lcd4linux-devel@users.sourceforge.net>
  *
  * This file is part of LCD4Linux.
@@ -21,47 +22,6 @@
  * along with this program; if not, write to the Free Software
  * Foundation, Inc., 675 Mass Ave, Cambridge, MA 02139, USA.
  *
- *
- * $Log: drv_generic_parport.h,v $
- * Revision 1.11  2005/05/08 04:32:44  reinelt
- * CodingStyle added and applied
- *
- * Revision 1.10  2005/05/04 06:13:05  reinelt
- * parport_wire_status() added
- *
- * Revision 1.9  2005/01/18 06:30:23  reinelt
- * added (C) to all copyright statements
- *
- * Revision 1.8  2004/10/17 09:24:31  reinelt
- * I2C support for HD44780 displays by Luis (does not work by now)
- *
- * Revision 1.7  2004/09/18 15:58:57  reinelt
- * even more HD44780 cleanups, hardwiring for LCM-162
- *
- * Revision 1.6  2004/09/18 08:22:59  reinelt
- * drv_generic_parport_status() to read status lines
- *
- * Revision 1.5  2004/06/26 12:04:59  reinelt
- *
- * uh-oh... the last CVS log message messed up things a lot...
- *
- * Revision 1.4  2004/06/26 09:27:21  reinelt
- *
- * added '-W' to CFLAGS
- * changed all C++ comments to C ones
- * cleaned up a lot of signed/unsigned mistakes
- *
- * Revision 1.3  2004/06/20 10:09:55  reinelt
- *
- * 'const'ified the whole source
- *
- * Revision 1.2  2004/01/20 15:32:49  reinelt
- * first version of Next Generation HD44780 (untested! but it compiles...)
- * some cleanup in the other drivers
- *
- * Revision 1.1  2004/01/20 14:35:38  reinelt
- * drv_generic_parport added, code from parport.c
- *
  */
 
 /* 
@@ -132,7 +92,7 @@
 void drv_generic_parport_direction(const int direction);
 unsigned char drv_generic_parport_status(void);
 void drv_generic_parport_control(const unsigned char mask, const unsigned char value);
-void drv_generic_parport_toggle(const unsigned char bit, const int level, const int delay);
+void drv_generic_parport_toggle(const unsigned char bit, const int level, const unsigned long delay);
 void drv_generic_parport_data(const unsigned char data);
 unsigned char drv_generic_parport_read(void);
 void drv_generic_parport_debug(void);
diff -urN lcd4linux-0.10.0/drv_generic_serial.c lcd4linux-0.11.0-SVN/drv_generic_serial.c
--- lcd4linux-0.10.0/drv_generic_serial.c	2005-05-08 06:32:44.000000000 +0200
+++ lcd4linux-0.11.0-SVN/drv_generic_serial.c	2008-12-31 08:05:54.000000000 +0100
@@ -1,8 +1,9 @@
-/* $Id: drv_generic_serial.c,v 1.17 2005/05/08 04:32:44 reinelt Exp $
+/* $Id: drv_generic_serial.c 890 2008-08-31 18:27:53Z sonic74 $
+ * $URL: https://ssl.bulix.org/svn/lcd4linux/trunk/drv_generic_serial.c $
  *
  * generic driver helper for serial and usbserial displays
  *
- * Copyright (C) 1999, 2000 Michael Reinelt <reinelt@eunet.at>
+ * Copyright (C) 1999, 2000 Michael Reinelt <michael@reinelt.co.at>
  * Copyright (C) 2004 The LCD4Linux Team <lcd4linux-devel@users.sourceforge.net>
  *
  * This file is part of LCD4Linux.
@@ -21,96 +22,9 @@
  * along with this program; if not, write to the Free Software
  * Foundation, Inc., 675 Mass Ave, Cambridge, MA 02139, USA.
  *
- *
- * $Log: drv_generic_serial.c,v $
- * Revision 1.17  2005/05/08 04:32:44  reinelt
- * CodingStyle added and applied
- *
- * Revision 1.16  2005/01/18 06:30:23  reinelt
- * added (C) to all copyright statements
- *
- * Revision 1.15  2004/06/26 12:04:59  reinelt
- *
- * uh-oh... the last CVS log message messed up things a lot...
- *
- * Revision 1.14  2004/06/26 09:27:21  reinelt
- *
- * added '-W' to CFLAGS
- * changed all C++ comments to C ones
- * cleaned up a lot of signed/unsigned mistakes
- *
- * Revision 1.13  2004/06/26 06:12:15  reinelt
- *
- * support for Beckmann+Egle Compact Terminals
- * some mostly cosmetic changes in the MatrixOrbital and USBLCD driver
- * added debugging to the generic serial driver
- * fixed a bug in the generic text driver where icons could be drawn outside
- * the display bounds
- *
- * Revision 1.12  2004/06/20 10:09:55  reinelt
- *
- * 'const'ified the whole source
- *
- * Revision 1.11  2004/06/01 06:45:30  reinelt
- *
- * some Fixme's processed
- * documented some code
- *
- * Revision 1.10  2004/05/31 21:05:13  reinelt
- *
- * fixed lots of bugs in the Cwlinux driver
- * do not emit EAGAIN error on the first retry
- * made plugin_i2c_sensors a bit less 'chatty'
- * moved init and exit functions to the bottom of plugin_pop3
- *
- * Revision 1.9  2004/05/28 13:51:42  reinelt
- *
- * ported driver for Beckmann+Egle Mini-Terminals
- * added 'flags' parameter to serial_init()
- *
- * Revision 1.8  2004/03/03 04:44:16  reinelt
- * changes (cosmetics?) to the big patch from Martin
- * hash patch un-applied
- *
- * Revision 1.7  2004/03/03 03:47:04  reinelt
- * big patch from Martin Hejl:
- * - use qprintf() where appropriate
- * - save CPU cycles on gettimeofday()
- * - add quit() functions to free allocated memory
- * - fixed lots of memory leaks
- *
- * Revision 1.6  2004/02/14 11:56:17  reinelt
- * M50530 driver ported
- * changed lots of 'char' to 'unsigned char'
- *
- * Revision 1.5  2004/02/04 19:10:51  reinelt
- * Crystalfontz driver nearly finished
- *
- * Revision 1.4  2004/02/01 08:05:12  reinelt
- * Crystalfontz 633 extensions (CRC checking and stuff)
- * Models table for HD44780
- * Noritake VFD BVrightness patch from Bill Paxton
- *
- * Revision 1.3  2004/01/29 04:40:02  reinelt
- * every .c file includes "config.h" now
- *
- * Revision 1.2  2004/01/25 05:30:09  reinelt
- * plugin_netdev for parsing /proc/net/dev added
- *
- * Revision 1.1  2004/01/20 14:26:09  reinelt
- * moved drv_generic to drv_generic_serial
- *
- * Revision 1.2  2004/01/20 05:36:59  reinelt
- * moved text-display-specific stuff to drv_generic_text
- * moved all the bar stuff from drv_generic_bar to generic_text
- *
- * Revision 1.1  2004/01/20 04:51:39  reinelt
- * moved generic stuff from drv_MatrixOrbital to drv_generic
- * implemented new-stylish bars which are nearly finished
- *
  */
 
-/* 
+/*
  *
  * exported fuctions:
  *
@@ -153,6 +67,8 @@
 #include "drv_generic_serial.h"
 
 
+extern int got_signal;
+
 static char *Section;
 static char *Driver;
 static char *Port;
@@ -305,7 +221,7 @@
 	return -1;
     }
 
-    if (cfg_number(section, "Speed", 19200, 1200, 115200, &i) < 0)
+    if (cfg_number(section, "Speed", 19200, 1200, 230400, &i) < 0)
 	return -1;
     switch (i) {
     case 1200:
@@ -332,6 +248,11 @@
     case 115200:
 	Speed = B115200;
 	break;
+#ifdef B230400
+    case 230400:
+	Speed = B230400;
+	break;
+#endif
     default:
 	error("%s: unsupported speed '%d' from %s", Driver, i, cfg_source());
 	return -1;
@@ -412,33 +333,37 @@
 
 void drv_generic_serial_write(const char *string, const int len)
 {
+    static int error = 0;
     int run, ret;
 
-#if 0
-    int i;
-    for (i = 0; i < len; i++) {
-	int c = string[i];
-	debug("serial_write: %03d %03o 0x%02x %c", c, c, c, iscntrl(c) ? '*' : c);
+    if (Device == -1) {
+	error("%s: write to closed port %s failed!", Driver, Port);
+	return;
     }
-#endif
 
-    if (Device == -1)
-	return;
     for (run = 0; run < 10; run++) {
 	ret = write(Device, string, len);
-	if (ret >= 0 || errno != EAGAIN)
+	if (ret >= 0 || errno != EAGAIN) {
 	    break;
-	if (run > 0)
+	}
+	/* EAGAIN: retry 10 times, emit message after 2nd retry */
+	if (run > 0) {
 	    info("%s: write(%s): EAGAIN #%d", Driver, Port, run);
+	}
 	usleep(1000);
     }
 
     if (ret < 0) {
 	error("%s: write(%s) failed: %s", Driver, Port, strerror(errno));
+	if (++error > 10) {
+	    error("%s: too much errors, giving up", Driver);
+	    got_signal = -1;
+	}
     } else if (ret != len) {
 	error("%s: partial write(%s): len=%d ret=%d", Driver, Port, len, ret);
+    } else {
+	error = 0;
     }
-
     return;
 }
 
diff -urN lcd4linux-0.10.0/drv_generic_serial.h lcd4linux-0.11.0-SVN/drv_generic_serial.h
--- lcd4linux-0.10.0/drv_generic_serial.h	2005-05-08 06:32:44.000000000 +0200
+++ lcd4linux-0.11.0-SVN/drv_generic_serial.h	2008-12-31 08:05:54.000000000 +0100
@@ -1,8 +1,9 @@
-/* $Id: drv_generic_serial.h,v 1.10 2005/05/08 04:32:44 reinelt Exp $
+/* $Id: drv_generic_serial.h 840 2007-09-09 12:17:42Z michael $
+ * $URL: https://ssl.bulix.org/svn/lcd4linux/trunk/drv_generic_serial.h $
  *
  * generic driver helper for serial and usbserial displays
  *
- * Copyright (C) 1999, 2000 Michael Reinelt <reinelt@eunet.at>
+ * Copyright (C) 1999, 2000 Michael Reinelt <michael@reinelt.co.at>
  * Copyright (C) 2004 The LCD4Linux Team <lcd4linux-devel@users.sourceforge.net>
  *
  * This file is part of LCD4Linux.
@@ -21,58 +22,6 @@
  * along with this program; if not, write to the Free Software
  * Foundation, Inc., 675 Mass Ave, Cambridge, MA 02139, USA.
  *
- *
- * $Log: drv_generic_serial.h,v $
- * Revision 1.10  2005/05/08 04:32:44  reinelt
- * CodingStyle added and applied
- *
- * Revision 1.9  2005/01/18 06:30:23  reinelt
- * added (C) to all copyright statements
- *
- * Revision 1.8  2004/06/26 12:04:59  reinelt
- *
- * uh-oh... the last CVS log message messed up things a lot...
- *
- * Revision 1.7  2004/06/26 09:27:21  reinelt
- *
- * added '-W' to CFLAGS
- * changed all C++ comments to C ones
- * cleaned up a lot of signed/unsigned mistakes
- *
- * Revision 1.6  2004/06/20 10:09:55  reinelt
- *
- * 'const'ified the whole source
- *
- * Revision 1.5  2004/06/01 06:45:30  reinelt
- *
- * some Fixme's processed
- * documented some code
- *
- * Revision 1.4  2004/05/28 13:51:42  reinelt
- *
- * ported driver for Beckmann+Egle Mini-Terminals
- * added 'flags' parameter to serial_init()
- *
- * Revision 1.3  2004/02/14 11:56:17  reinelt
- * M50530 driver ported
- * changed lots of 'char' to 'unsigned char'
- *
- * Revision 1.2  2004/02/01 08:05:12  reinelt
- * Crystalfontz 633 extensions (CRC checking and stuff)
- * Models table for HD44780
- * Noritake VFD BVrightness patch from Bill Paxton
- *
- * Revision 1.1  2004/01/20 14:26:09  reinelt
- * moved drv_generic to drv_generic_serial
- *
- * Revision 1.2  2004/01/20 05:36:59  reinelt
- * moved text-display-specific stuff to drv_generic_text
- * moved all the bar stuff from drv_generic_bar to generic_text
- *
- * Revision 1.1  2004/01/20 04:51:39  reinelt
- * moved generic stuff from drv_MatrixOrbital to drv_generic
- * implemented new-stylish bars which are nearly finished
- *
  */
 
 
diff -urN lcd4linux-0.10.0/drv_generic_text.c lcd4linux-0.11.0-SVN/drv_generic_text.c
--- lcd4linux-0.10.0/drv_generic_text.c	2005-05-08 06:32:44.000000000 +0200
+++ lcd4linux-0.11.0-SVN/drv_generic_text.c	2008-12-31 08:05:54.000000000 +0100
@@ -1,8 +1,9 @@
-/* $Id: drv_generic_text.c,v 1.27 2005/05/08 04:32:44 reinelt Exp $
+/* $Id: drv_generic_text.c 840 2007-09-09 12:17:42Z michael $
+ * $URL: https://ssl.bulix.org/svn/lcd4linux/trunk/drv_generic_text.c $
  *
  * generic driver helper for text-based displays
  *
- * Copyright (C) 1999, 2000 Michael Reinelt <reinelt@eunet.at>
+ * Copyright (C) 1999, 2000 Michael Reinelt <michael@reinelt.co.at>
  * Copyright (C) 2004 The LCD4Linux Team <lcd4linux-devel@users.sourceforge.net>
  *
  * This file is part of LCD4Linux.
@@ -21,129 +22,12 @@
  * along with this program; if not, write to the Free Software
  * Foundation, Inc., 675 Mass Ave, Cambridge, MA 02139, USA.
  *
- *
- * $Log: drv_generic_text.c,v $
- * Revision 1.27  2005/05/08 04:32:44  reinelt
- * CodingStyle added and applied
- *
- * Revision 1.26  2005/05/06 06:37:34  reinelt
- * hollow bar patch from geronet
- *
- * Revision 1.25  2005/02/24 07:06:48  reinelt
- * SimpleLCD driver added
- *
- * Revision 1.24  2005/01/18 06:30:23  reinelt
- * added (C) to all copyright statements
- *
- * Revision 1.23  2005/01/09 10:53:24  reinelt
- * small type in plugin_uname fixed
- * new homepage lcd4linux.bulix.org
- *
- * Revision 1.22  2004/11/28 15:50:24  reinelt
- * Cwlinux fixes (invalidation of user-defined chars)
- *
- * Revision 1.21  2004/06/26 12:04:59  reinelt
- *
- * uh-oh... the last CVS log message messed up things a lot...
- *
- * Revision 1.20  2004/06/26 09:27:21  reinelt
- *
- * added '-W' to CFLAGS
- * changed all C++ comments to C ones
- * cleaned up a lot of signed/unsigned mistakes
- *
- * Revision 1.19  2004/06/26 06:12:15  reinelt
- *
- * support for Beckmann+Egle Compact Terminals
- * some mostly cosmetic changes in the MatrixOrbital and USBLCD driver
- * added debugging to the generic serial driver
- * fixed a bug in the generic text driver where icons could be drawn outside
- * the display bounds
- *
- * Revision 1.18  2004/06/20 10:09:55  reinelt
- *
- * 'const'ified the whole source
- *
- * Revision 1.17  2004/06/05 06:41:40  reinelt
- *
- * chancged splash screen again
- *
- * Revision 1.16  2004/06/02 10:09:22  reinelt
- *
- * splash screen for HD44780
- *
- * Revision 1.15  2004/06/01 06:45:30  reinelt
- *
- * some Fixme's processed
- * documented some code
- *
- * Revision 1.14  2004/05/26 11:37:36  reinelt
- *
- * Curses driver ported.
- *
- * Revision 1.13  2004/03/19 09:17:46  reinelt
- *
- * removed the extra 'goto' function, row and col are additional parameters
- * of the write() function now.
- *
- * Revision 1.12  2004/03/03 03:47:04  reinelt
- * big patch from Martin Hejl:
- * - use qprintf() where appropriate
- * - save CPU cycles on gettimeofday()
- * - add quit() functions to free allocated memory
- * - fixed lots of memory leaks
- *
- * Revision 1.11  2004/02/15 21:43:43  reinelt
- * T6963 driver nearly finished
- * framework for graphic displays done
- * i2c_sensors patch from Xavier
- * some more old generation files removed
- *
- * Revision 1.10  2004/02/14 11:56:17  reinelt
- * M50530 driver ported
- * changed lots of 'char' to 'unsigned char'
- *
- * Revision 1.9  2004/02/07 13:45:23  reinelt
- * icon visibility patch #2 from Xavier
- *
- * Revision 1.8  2004/01/30 20:57:56  reinelt
- * HD44780 patch from Martin Hejl
- * dmalloc integrated
- *
- * Revision 1.7  2004/01/29 04:40:02  reinelt
- * every .c file includes "config.h" now
- *
- * Revision 1.6  2004/01/23 07:04:23  reinelt
- * icons finished!
- *
- * Revision 1.5  2004/01/23 04:53:54  reinelt
- * icon widget added (not finished yet!)
- *
- * Revision 1.4  2004/01/22 07:57:45  reinelt
- * several bugs fixed where segfaulting on layout>display
- * Crystalfontz driver optimized, 632 display already works
- *
- * Revision 1.3  2004/01/20 14:25:12  reinelt
- * some reorganization
- * moved drv_generic to drv_generic_serial
- * moved port locking stuff to drv_generic_serial
- *
- * Revision 1.2  2004/01/20 12:45:47  reinelt
- * "Default screen" working with MatrixOrbital
- *
- * Revision 1.1  2004/01/20 05:36:59  reinelt
- * moved text-display-specific stuff to drv_generic_text
- * moved all the bar stuff from drv_generic_bar to generic_text
- *
  */
 
 /* 
  *
  * exported variables:
  *
- * extern int DROWS, DCOLS;    display size
- * extern int LROWS, LCOLS;    layout size
- * extern int XRES,  YRES;     pixel width/height of one char
  * extern int CHARS, CHAR0;    number of user-defineable characters, ASCII of first char
  * extern int ICONS;           number of user-defineable characters reserved for icons
  * extern int GOTO_COST;       number of bytes a goto command requires
@@ -168,7 +52,7 @@
  *   renders Text widget into framebuffer
  *   calls drv_generic_text_real_write()
  *
- * int drv_generic_text_icon_init       (void);
+ * int drv_generic_text_icon_init (void);
  *   initializes the generic icon driver
  *   
  * int drv_generic_text_icon_draw (WIDGET *W);
@@ -208,6 +92,7 @@
 #include "widget_icon.h"
 #include "widget_bar.h"
 #include "drv.h"
+#include "drv_generic.h"
 #include "drv_generic_text.h"
 
 #ifdef WITH_DMALLOC
@@ -236,13 +121,6 @@
 static char *Section = NULL;
 static char *Driver = NULL;
 
-
-int DROWS = 20;			/* display size: rows */
-int DCOLS = 4;			/* display size: columns */
-int LROWS = 20;			/* layout size: rows */
-int LCOLS = 4;			/* layout size: columns */
-int XRES = 6;			/* pixels of one char cell */
-int YRES = 8;			/* pixels of one char cell */
 int CHARS = 0;			/* number of user-defineable characters */
 int CHAR0 = 0;			/* ASCII of first user-defineable char */
 int ICONS = 0;			/* number of user-defineable characters reserved for icons */
@@ -251,8 +129,13 @@
 int INVALIDATE = 0;		/* re-send a modified userdefined char? */
 
 
+void (*drv_generic_text_real_write) () = NULL;
+void (*drv_generic_text_real_defchar) () = NULL;
+
+
 static char *LayoutFB = NULL;
 static char *DisplayFB = NULL;
+static int *L2D = NULL;
 
 static int Single_Segments = 0;
 
@@ -262,7 +145,6 @@
 static BAR *BarFB = NULL;
 
 
-
 /****************************************/
 /*** generic Framebuffer stuff        ***/
 /****************************************/
@@ -270,6 +152,7 @@
 static void drv_generic_text_resizeFB(int rows, int cols)
 {
     char *newFB;
+    int *newL2D;
     BAR *newBar;
     int i, row, col;
 
@@ -284,8 +167,8 @@
 	cols = LCOLS;
 
     /* allocate new Layout FB */
-    newFB = malloc(cols * rows * sizeof(char));
-    memset(newFB, ' ', rows * cols * sizeof(char));
+    newFB = malloc(cols * rows * sizeof(*newFB));
+    memset(newFB, ' ', rows * cols * sizeof(*newFB));
 
     /* transfer contents */
     if (LayoutFB != NULL) {
@@ -298,6 +181,26 @@
     }
     LayoutFB = newFB;
 
+    /* allocate new transformer */
+    newL2D = malloc(cols * rows * sizeof(*newL2D));
+
+    /* intitialize translator */
+    for (row = 0; row < rows; row++) {
+	for (col = 0; col < cols; col++) {
+	    newL2D[row * cols + col] = row * DCOLS + col;
+	}
+    }
+
+    /* transfer transformer */
+    if (L2D != NULL) {
+	for (row = 0; row < LROWS; row++) {
+	    for (col = 0; col < LCOLS; col++) {
+		newL2D[row * cols + col] = L2D[row * LCOLS + col];
+	    }
+	}
+	free(L2D);
+    }
+    L2D = newL2D;
 
     /* resize Bar buffer */
     if (BarFB) {
@@ -328,6 +231,54 @@
 }
 
 
+static void drv_generic_text_blit(const int row, const int col, const int height, const int width)
+{
+    int lr, lc;			/* layout  row/col */
+    int dr, dc;			/* display row/col */
+    int p1, p2;			/* start/end positon of changed area */
+    int eq;			/* counter for equal contents */
+
+    /* loop over layout rows */
+    for (lr = row; lr < LROWS && lr < row + height; lr++) {
+	/* transform layout to display row */
+	dr = lr;
+	/* sanity check */
+	if (dr < 0 || dr >= DROWS)
+	    continue;
+	/* loop over layout cols */
+	for (lc = col; lc < LCOLS && lc < col + width; lc++) {
+	    /* transform layout to display column */
+	    dc = lc;
+	    /* sanity check */
+	    if (dc < 0 || dc >= DCOLS)
+		continue;
+	    /* find start of difference */
+	    if (DisplayFB[dr * DCOLS + dc] == LayoutFB[lr * LCOLS + lc])
+		continue;
+	    /* find end of difference */
+	    for (p1 = dc, p2 = p1, eq = 0, lc++; lc < LCOLS && lc < col + width; lc++) {
+		/* transform layout to display column */
+		dc = lc;
+		/* sanity check */
+		if (dc < 0 || dc >= DCOLS)
+		    continue;
+		if (DisplayFB[dr * DCOLS + dc] == LayoutFB[lr * LCOLS + lc]) {
+		    if (++eq > GOTO_COST)
+			break;
+		} else {
+		    p2 = dc;
+		    eq = 0;
+		}
+	    }
+	    /* send to display */
+	    memcpy(DisplayFB + dr * DCOLS + p1, LayoutFB + lr * LCOLS + p1, p2 - p1 + 1);
+	    if (drv_generic_text_real_write)
+		drv_generic_text_real_write(dr, p1, DisplayFB + dr * DCOLS + p1, p2 - p1 + 1);
+	}
+    }
+}
+
+
 /****************************************/
 /*** generic text handling            ***/
 /****************************************/
@@ -339,21 +290,26 @@
     Driver = (char *) driver;
 
     /* init display framebuffer */
-    DisplayFB = (char *) malloc(DCOLS * DROWS * sizeof(char));
-    memset(DisplayFB, ' ', DROWS * DCOLS * sizeof(char));
+    DisplayFB = (char *) malloc(DCOLS * DROWS * sizeof(*DisplayFB));
+    memset(DisplayFB, ' ', DROWS * DCOLS * sizeof(*DisplayFB));
 
     /* init layout framebuffer */
     LROWS = 0;
     LCOLS = 0;
     LayoutFB = NULL;
+    L2D = NULL;
     drv_generic_text_resizeFB(DROWS, DCOLS);
 
     /* sanity check */
-    if (LayoutFB == NULL || DisplayFB == NULL) {
+    if (DisplayFB == NULL || LayoutFB == NULL || L2D == NULL) {
 	error("%s: framebuffer could not be allocated: malloc() failed", Driver);
 	return -1;
     }
 
+    /* init generic driver & register plugins */
+    drv_generic_blit = drv_generic_text_blit;
+    drv_generic_init();
+
     return 0;
 }
 
@@ -380,7 +336,8 @@
 
     for (i = 0; line1[i]; i++) {
 	if (strlen(line1[i]) <= (unsigned) DCOLS) {
-	    drv_generic_text_real_write(0, (DCOLS - strlen(line1[i])) / 2, line1[i], strlen(line1[i]));
+	    if (drv_generic_text_real_write)
+		drv_generic_text_real_write(0, (DCOLS - strlen(line1[i])) / 2, line1[i], strlen(line1[i]));
 	    flag = 1;
 	    break;
 	}
@@ -389,7 +346,8 @@
     if (DROWS >= 2) {
 	for (i = 0; line2[i]; i++) {
 	    if (strlen(line2[i]) <= (unsigned) DCOLS) {
-		drv_generic_text_real_write(1, (DCOLS - strlen(line2[i])) / 2, line2[i], strlen(line2[i]));
+		if (drv_generic_text_real_write)
+		    drv_generic_text_real_write(1, (DCOLS - strlen(line2[i])) / 2, line2[i], strlen(line2[i]));
 		flag = 1;
 		break;
 	    }
@@ -399,7 +357,8 @@
     if (msg1 && DROWS >= 3) {
 	int len = strlen(msg1);
 	if (len <= DCOLS) {
-	    drv_generic_text_real_write(2, (DCOLS - len) / 2, msg1, len);
+	    if (drv_generic_text_real_write)
+		drv_generic_text_real_write(2, (DCOLS - len) / 2, msg1, len);
 	    flag = 1;
 	}
     }
@@ -407,7 +366,8 @@
     if (msg2 && DROWS >= 4) {
 	int len = strlen(msg2);
 	if (len <= DCOLS) {
-	    drv_generic_text_real_write(3, (DCOLS - len) / 2, msg2, len);
+	    if (drv_generic_text_real_write)
+		drv_generic_text_real_write(3, (DCOLS - len) / 2, msg2, len);
 	    flag = 1;
 	}
     }
@@ -419,45 +379,22 @@
 int drv_generic_text_draw(WIDGET * W)
 {
     WIDGET_TEXT *Text = W->data;
-    char *txt, *fb1, *fb2;
-    int row, col, col0, len, end;
+    char *txt;
+    int row, col, len;
 
     row = W->row;
     col = W->col;
     txt = Text->buffer;
     len = strlen(txt);
-    end = col + len;
 
     /* maybe grow layout framebuffer */
     drv_generic_text_resizeFB(row + 1, col + len);
 
-    fb1 = LayoutFB + row * LCOLS;
-    fb2 = DisplayFB + row * DCOLS;
-
     /* transfer new text into layout buffer */
-    memcpy(fb1 + col, txt, len);
+    memcpy(LayoutFB + row * LCOLS + col, txt, len);
 
-    if (row < DROWS) {
-	for (; col <= end && col < DCOLS; col++) {
-	    int pos1, pos2, equal;
-	    if (fb1[col] == fb2[col])
-		continue;
-	    col0 = col;
-	    for (pos1 = col, pos2 = pos1, col++, equal = 0; col <= end && col < DCOLS; col++) {
-		if (fb1[col] == fb2[col]) {
-		    /* If we find just one equal byte, we don't break, because this  */
-		    /* would require a goto, which takes several bytes, too. */
-		    if (GOTO_COST >= 0 && ++equal > GOTO_COST)
-			break;
-		} else {
-		    pos2 = col;
-		    equal = 0;
-		}
-	    }
-	    memcpy(fb2 + pos1, fb1 + pos1, pos2 - pos1 + 1);
-	    drv_generic_text_real_write(row, col0, fb2 + pos1, pos2 - pos1 + 1);
-	}
-    }
+    /* blit it */
+    drv_generic_text_blit(row, col, 1, len);
 
     return 0;
 }
@@ -466,20 +403,26 @@
 int drv_generic_text_quit(void)
 {
 
+    if (DisplayFB) {
+	free(DisplayFB);
+	DisplayFB = NULL;
+    }
+
     if (LayoutFB) {
 	free(LayoutFB);
 	LayoutFB = NULL;
     }
 
-    if (DisplayFB) {
-	free(DisplayFB);
-	DisplayFB = NULL;
+    if (L2D) {
+	free(L2D);
+	L2D = NULL;
     }
 
     if (BarFB) {
 	free(BarFB);
 	BarFB = NULL;
     }
+
     widget_unregister();
 
     return (0);
@@ -506,7 +449,7 @@
     static int icon_counter = 0;
     WIDGET_ICON *Icon = W->data;
     int row, col;
-    int l_idx, d_idx;
+    int visible;
     int invalidate = 0;
     unsigned char ascii;
 
@@ -531,29 +474,31 @@
 	Icon->ascii = CHAR0 + CHARS - icon_counter;
     }
 
+    /* Icon visible? */
+    visible = P2N(&Icon->visible) > 0;
+
     /* maybe redefine icon */
-    if (Icon->curmap != Icon->prvmap && Icon->visible) {
+    if (Icon->curmap != Icon->prvmap && visible) {
 	Icon->prvmap = Icon->curmap;
-	drv_generic_text_real_defchar(Icon->ascii, Icon->bitmap + YRES * Icon->curmap);
+	if (drv_generic_text_real_defchar)
+	    drv_generic_text_real_defchar(Icon->ascii, Icon->bitmap + YRES * Icon->curmap);
 	invalidate = INVALIDATE;
     }
 
     /* use blank if invisible */
-    ascii = Icon->visible ? Icon->ascii : ' ';
-
-    /* index into the two framebuffers */
-    l_idx = row * LCOLS + col;
-    d_idx = row * DCOLS + col;
+    ascii = visible ? Icon->ascii : ' ';
 
     /* transfer icon into layout buffer */
-    LayoutFB[l_idx] = ascii;
+    LayoutFB[row * LCOLS + col] = ascii;
 
-    /* maybe send icon to the display */
-    if (row < DROWS && col < DCOLS && (DisplayFB[d_idx] != ascii || invalidate)) {
-	DisplayFB[d_idx] = ascii;
-	drv_generic_text_real_write(row, col, DisplayFB + d_idx, 1);
+    /* ugly invalidation: change display FB to a wrong value so blit() will really send it */
+    if (invalidate) {
+	DisplayFB[row * DCOLS + col] = ~ascii;
     }
 
+    /* blit it */
+    drv_generic_text_blit(row, col, 1, 1);
+
     return 0;
 
 }
@@ -620,7 +565,8 @@
 }
 
 
-static void drv_generic_text_bar_create_bar(int row, int col, const DIRECTION dir, STYLE style, int len, int val1, int val2)
+static void drv_generic_text_bar_create_bar(int row, int col, const DIRECTION dir, STYLE style, int len, int val1,
+					    int val2)
 {
     int rev = 0, max;
     if (style)
@@ -638,7 +584,7 @@
 	    BarFB[row * LCOLS + col].dir = dir;
 	    BarFB[row * LCOLS + col].segment = -1;
 	    if (style && BarFB[row * LCOLS + col].style == 0)
-		BarFB[row * LCOLS + col].style = STYLE_HOLLOW;
+		BarFB[row * LCOLS + col].style = style;
 	    if (val1 >= XRES) {
 		BarFB[row * LCOLS + col].val1 = rev ? 0 : XRES;
 		val1 -= XRES;
@@ -660,13 +606,13 @@
 	    BarFB[row * LCOLS + col - 1].style = STYLE_LAST;
 	break;
 
-    case DIR_SOUTH:
+    case DIR_NORTH:
 	max = len * YRES;
 	val1 = max - val1;
 	val2 = max - val2;
 	rev = 1;
 
-    case DIR_NORTH:
+    case DIR_SOUTH:
 	while (len > 0 && row < LROWS) {
 	    BarFB[row * LCOLS + col].dir = dir;
 	    BarFB[row * LCOLS + col].segment = -1;
@@ -737,13 +683,15 @@
 		/* same style, same direction */
 		if (Segment[i].style == BarFB[n].style && Segment[i].dir & BarFB[n].dir)
 		    break;
+#if 0
 		/* hollow style, val(1,2) == 1, like '[' */
-/*                        if (l1 == 1 && l2 == 1 && Segment[i].style == STYLE_FIRST && BarFB[n].style == STYLE_HOLLOW)
-																										                								                              break;
-*//* hollow style, val(1,2) == 1, like ']' */
-/*                        if (l1 == 1 && l2 == 1 && Segment[i].style == STYLE_LAST && BarFB[n].style == STYLE_HOLLOW)
-                              break;
-*/ }
+		if (l1 == 1 && l2 == 1 && Segment[i].style == STYLE_FIRST && BarFB[n].style == STYLE_HOLLOW)
+		    break;
+		/* hollow style, val(1,2) == 1, like ']' */
+		if (l1 == 1 && l2 == 1 && Segment[i].style == STYLE_LAST && BarFB[n].style == STYLE_HOLLOW)
+		    break;
+#endif
+	    }
 	}
 	if (i == nSegment) {
 	    nSegment++;
@@ -786,18 +734,28 @@
     if (j2 > res)
 	j2 = res;
 
+    /* do not replace empty with non-empty */
     if (i1 == 0 && j1 != 0)
 	return 65535;
     if (i2 == 0 && j2 != 0)
 	return 65535;
+
+    /* do not replace full with non-full */
     if (i1 == res && j1 < res)
 	return 65535;
     if (i2 == res && j2 < res)
 	return 65535;
-    if (i1 == 1 && j1 != 1 && i2 > 0)
-	return 65535;
-    if (i2 == 1 && j2 != 1 && j1 > 0)
-	return 65535;
+
+    /* do not replace start line */
+    /* but only if there are at least some chars available */
+    if (CHARS - ICONS > 0) {
+	if (i1 == 1 && j1 != 1 && i2 > 0)
+	    return 65535;
+	if (i2 == 1 && j2 != 1 && j1 > 0)
+	    return 65535;
+    }
+
+    /* do not replace equal length with non-equal length */
     if (i1 == i2 && j1 != j2)
 	return 65535;
 
@@ -819,6 +777,7 @@
     for (i = 0; i < nSegment; i++) {
 	for (j = 0; j < nSegment; j++) {
 	    error[i][j] = drv_generic_text_bar_segment_error(i, j);
+	    /* debug ("[%d][%d] = %d", i, j, error[i][j]); */
 	}
     }
 
@@ -854,7 +813,8 @@
 	}
 #if 0
 	debug("pack_segment: n=%d i=%d j=%d min=%d", nSegment, pack_i, pack_j, min);
-	debug("Pack_segment: i1=%d i2=%d j1=%d j2=%d\n", Segment[pack_i].val1, Segment[pack_i].val2, Segment[pack_j].val1, Segment[pack_j].val2);
+	debug("Pack_segment: i1=%d i2=%d j1=%d j2=%d\n", Segment[pack_i].val1, Segment[pack_i].val2,
+	      Segment[pack_j].val1, Segment[pack_j].val2);
 #endif
 
 	nSegment--;
@@ -936,7 +896,8 @@
 	    }
 	    break;
 	}
-	drv_generic_text_real_defchar(CHAR0 + c, buffer);
+	if (drv_generic_text_real_defchar)
+	    drv_generic_text_real_defchar(CHAR0 + c, buffer);
 
 	/* maybe invalidate framebuffer */
 	if (INVALIDATE) {
@@ -953,7 +914,7 @@
 int drv_generic_text_bar_draw(WIDGET * W)
 {
     WIDGET_BAR *Bar = W->data;
-    int row, col, col0, len, res, max, val1, val2;
+    int row, col, len, res, max, val1, val2;
     int c, n, s;
     DIRECTION dir;
     STYLE style;
@@ -1025,33 +986,15 @@
 	    /* maybe invalidate display framebuffer */
 	    if (BarFB[n].invalid) {
 		BarFB[n].invalid = 0;
+		/* ugly invalidation: change display FB to a wrong value so blit() will really send it */
 		DisplayFB[row * DCOLS + col] = ~LayoutFB[n];
 	    }
 	}
     }
 
-    /* transfer differences to the display */
-    for (row = 0; row < DROWS; row++) {
-	for (col = 0; col < DCOLS; col++) {
-	    int pos1, pos2, equal;
-	    if (LayoutFB[row * LCOLS + col] == DisplayFB[row * DCOLS + col])
-		continue;
-	    col0 = col;
-	    for (pos1 = col, pos2 = pos1, col++, equal = 0; col < DCOLS; col++) {
-		if (LayoutFB[row * LCOLS + col] == DisplayFB[row * DCOLS + col]) {
-		    /* If we find just one equal byte, we don't break, because this  */
-		    /* would require a goto, which takes several bytes, too. */
-		    if (++equal > GOTO_COST)
-			break;
-		} else {
-		    pos2 = col;
-		    equal = 0;
-		}
-	    }
-	    memcpy(DisplayFB + row * DCOLS + pos1, LayoutFB + row * LCOLS + pos1, pos2 - pos1 + 1);
-	    drv_generic_text_real_write(row, col0, DisplayFB + row * DCOLS + pos1, pos2 - pos1 + 1);
-	}
-    }
+    /* blit whole layout FB */
+    drv_generic_text_blit(0, 0, LROWS, LCOLS);
+
 
     return 0;
 
diff -urN lcd4linux-0.10.0/drv_generic_text.h lcd4linux-0.11.0-SVN/drv_generic_text.h
--- lcd4linux-0.10.0/drv_generic_text.h	2005-05-08 06:32:44.000000000 +0200
+++ lcd4linux-0.11.0-SVN/drv_generic_text.h	2008-12-31 08:05:54.000000000 +0100
@@ -1,8 +1,9 @@
-/* $Id: drv_generic_text.h,v 1.18 2005/05/08 04:32:44 reinelt Exp $
+/* $Id: drv_generic_text.h 840 2007-09-09 12:17:42Z michael $
+ * $URL: https://ssl.bulix.org/svn/lcd4linux/trunk/drv_generic_text.h $
  *
  * generic driver helper for text-based displays
  *
- * Copyright (C) 1999, 2000 Michael Reinelt <reinelt@eunet.at>
+ * Copyright (C) 1999, 2000 Michael Reinelt <michael@reinelt.co.at>
  * Copyright (C) 2004 The LCD4Linux Team <lcd4linux-devel@users.sourceforge.net>
  *
  * This file is part of LCD4Linux.
@@ -21,80 +22,6 @@
  * along with this program; if not, write to the Free Software
  * Foundation, Inc., 675 Mass Ave, Cambridge, MA 02139, USA.
  *
- *
- * $Log: drv_generic_text.h,v $
- * Revision 1.18  2005/05/08 04:32:44  reinelt
- * CodingStyle added and applied
- *
- * Revision 1.17  2005/01/18 06:30:23  reinelt
- * added (C) to all copyright statements
- *
- * Revision 1.16  2004/11/28 15:50:24  reinelt
- * Cwlinux fixes (invalidation of user-defined chars)
- *
- * Revision 1.15  2004/06/26 12:04:59  reinelt
- *
- * uh-oh... the last CVS log message messed up things a lot...
- *
- * Revision 1.14  2004/06/26 09:27:21  reinelt
- *
- * added '-W' to CFLAGS
- * changed all C++ comments to C ones
- * cleaned up a lot of signed/unsigned mistakes
- *
- * Revision 1.13  2004/06/20 10:09:56  reinelt
- *
- * 'const'ified the whole source
- *
- * Revision 1.12  2004/06/05 06:41:40  reinelt
- *
- * chancged splash screen again
- *
- * Revision 1.11  2004/06/02 10:09:22  reinelt
- *
- * splash screen for HD44780
- *
- * Revision 1.10  2004/06/01 06:45:30  reinelt
- *
- * some Fixme's processed
- * documented some code
- *
- * Revision 1.9  2004/05/26 11:37:36  reinelt
- *
- * Curses driver ported.
- *
- * Revision 1.8  2004/03/19 09:17:46  reinelt
- *
- * removed the extra 'goto' function, row and col are additional parameters
- * of the write() function now.
- *
- * Revision 1.7  2004/02/18 06:39:20  reinelt
- * T6963 driver for graphic displays finished
- *
- * Revision 1.6  2004/02/15 21:43:43  reinelt
- * T6963 driver nearly finished
- * framework for graphic displays done
- * i2c_sensors patch from Xavier
- * some more old generation files removed
- *
- * Revision 1.5  2004/02/14 11:56:17  reinelt
- * M50530 driver ported
- * changed lots of 'char' to 'unsigned char'
- *
- * Revision 1.4  2004/01/23 07:04:24  reinelt
- * icons finished!
- *
- * Revision 1.3  2004/01/23 04:53:55  reinelt
- * icon widget added (not finished yet!)
- *
- * Revision 1.2  2004/01/22 07:57:45  reinelt
- * several bugs fixed where segfaulting on layout>display
- * Crystalfontz driver optimized, 632 display already works
- *
- * Revision 1.1  2004/01/20 05:36:59  reinelt
- * moved text-display-specific stuff to drv_generic_text
- * moved all the bar stuff from drv_generic_bar to generic_text
- *
  */
 
 
@@ -102,21 +29,17 @@
 #define _DRV_GENERIC_TEXT_H_
 
 
-#include <termios.h>
+#include "drv_generic.h"
 #include "widget.h"
 
-
-extern int DROWS, DCOLS;	/* display size */
-extern int LROWS, LCOLS;	/* layout size */
-extern int XRES, YRES;		/* pixel width/height of one char  */
 extern int CHARS, CHAR0;	/* number of user-defineable characters, ASCII of first char */
 extern int ICONS;		/* number of user-defineable characters reserved for icons */
 extern int GOTO_COST;		/* number of bytes a goto command requires */
 extern int INVALIDATE;		/* re-send a modified userdefined char? */
 
 /* these functions must be implemented by the real driver */
-void (*drv_generic_text_real_write) (const int row, const int col, const char *data, const int len);
-void (*drv_generic_text_real_defchar) (const int ascii, const unsigned char *matrix);
+extern void (*drv_generic_text_real_write) (const int row, const int col, const char *data, const int len);
+extern void (*drv_generic_text_real_defchar) (const int ascii, const unsigned char *matrix);
 
 /* generic functions and widget callbacks */
 int drv_generic_text_init(const char *section, const char *driver);
diff -urN lcd4linux-0.10.0/drv.h lcd4linux-0.11.0-SVN/drv.h
--- lcd4linux-0.10.0/drv.h	2005-05-08 06:32:43.000000000 +0200
+++ lcd4linux-0.11.0-SVN/drv.h	2008-12-31 08:05:54.000000000 +0100
@@ -1,8 +1,9 @@
-/* $Id: drv.h,v 1.10 2005/05/08 04:32:43 reinelt Exp $
+/* $Id: drv.h 840 2007-09-09 12:17:42Z michael $
+ * $URL: https://ssl.bulix.org/svn/lcd4linux/trunk/drv.h $
  *
  * new framework for display drivers
  *
- * Copyright (C) 1999-2003 Michael Reinelt <reinelt@eunet.at>
+ * Copyright (C) 1999-2003 Michael Reinelt <michael@reinelt.co.at>
  * Copyright (C) 2004 The LCD4Linux Team <lcd4linux-devel@users.sourceforge.net>
  *
  * This file is part of LCD4Linux.
@@ -21,53 +22,6 @@
  * along with this program; if not, write to the Free Software
  * Foundation, Inc., 675 Mass Ave, Cambridge, MA 02139, USA.
  *
- *
- * $Log: drv.h,v $
- * Revision 1.10  2005/05/08 04:32:43  reinelt
- * CodingStyle added and applied
- *
- * Revision 1.9  2005/01/18 06:30:22  reinelt
- * added (C) to all copyright statements
- *
- * Revision 1.8  2004/06/26 12:04:59  reinelt
- *
- * uh-oh... the last CVS log message messed up things a lot...
- *
- * Revision 1.7  2004/06/26 09:27:20  reinelt
- *
- * added '-W' to CFLAGS
- * changed all C++ comments to C ones
- * cleaned up a lot of signed/unsigned mistakes
- *
- * Revision 1.6  2004/06/20 10:09:54  reinelt
- *
- * 'const'ified the whole source
- *
- * Revision 1.5  2004/06/06 06:51:59  reinelt
- *
- * do not display end splash screen if quiet=1
- *
- * Revision 1.4  2004/06/02 09:41:19  reinelt
- *
- * prepared support for startup splash screen
- *
- * Revision 1.3  2004/01/20 15:32:49  reinelt
- * first version of Next Generation HD44780 (untested! but it compiles...)
- * some cleanup in the other drivers
- *
- * Revision 1.2  2004/01/10 20:22:33  reinelt
- * added new function 'cfg_list()' (not finished yet)
- * added layout.c (will replace processor.c someday)
- * added widget_text.c (will be the first and most important widget)
- * modified lcd4linux.c so that old-style configs should work, too
- *
- * Revision 1.1  2004/01/09 17:03:07  reinelt
- * initiated transfer to new driver architecture
- * new file 'drv.c' will someday replace 'display.c'
- * new file 'drv_MatrixOrbital.c' will replace 'MatrixOrbital.c'
- * due to this 'soft' transfer lcd4linux should stay usable during the switch
- * (at least I hope so)
- *
  */
 
 #ifndef _DRV_H_
diff -urN lcd4linux-0.10.0/drv_HD44780.c lcd4linux-0.11.0-SVN/drv_HD44780.c
--- lcd4linux-0.10.0/drv_HD44780.c	2005-06-09 19:41:47.000000000 +0200
+++ lcd4linux-0.11.0-SVN/drv_HD44780.c	2008-12-31 08:05:54.000000000 +0100
@@ -1,8 +1,9 @@
-/* $Id: drv_HD44780.c,v 1.54 2005/06/09 17:41:47 reinelt Exp $
+/* $Id: drv_HD44780.c 905 2008-12-23 13:37:07Z michael $
+ * $URL: https://ssl.bulix.org/svn/lcd4linux/trunk/drv_HD44780.c $
  *
  * new style driver for HD44780-based displays
  *
- * Copyright (C) 2003 Michael Reinelt <reinelt@eunet.at>
+ * Copyright (C) 2003 Michael Reinelt <michael@reinelt.co.at>
  * Copyright (C) 2004 The LCD4Linux Team <lcd4linux-devel@users.sourceforge.net>
  *
  * Support for I2C bus
@@ -30,221 +31,6 @@
  * along with this program; if not, write to the Free Software
  * Foundation, Inc., 675 Mass Ave, Cambridge, MA 02139, USA.
  *
- *
- * $Log: drv_HD44780.c,v $
- * Revision 1.54  2005/06/09 17:41:47  reinelt
- * M50530 fixes (many thanks to Szymon Bieganski)
- *
- * Revision 1.53  2005/06/01 11:17:54  pk_richman
- * marked unused parameters
- *
- * Revision 1.52  2005/05/31 21:28:42  lfcorreia
- * fix typo
- *
- * Revision 1.50  2005/05/31 20:42:55  lfcorreia
- * new file: lcd4linux_i2c.h
- * avoid the problems detecting the proper I2C kernel include files
- *
- * rearrange all the other autoconf stuff to remove I2C detection
- *
- * new method by Paul Kamphuis to write to the I2C device
- *
- * Revision 1.49  2005/05/08 04:32:44  reinelt
- * CodingStyle added and applied
- *
- * Revision 1.48  2005/05/05 08:36:12  reinelt
- * changed SELECT to SLCTIN
- *
- * Revision 1.47  2005/03/28 22:29:23  reinelt
- * HD44780 multiple displays patch from geronet
- *
- * Revision 1.46  2005/03/28 19:39:23  reinelt
- * HD44780/I2C patch from Luis merged (still does not work for me)
- *
- * Revision 1.45  2005/03/25 15:44:43  reinelt
- * HD44780 Backlight fixed (thanks to geronet)
- *
- * Revision 1.44  2005/01/29 09:30:56  reinelt
- * minor HD44780 cleanups
- *
- * Revision 1.43  2005/01/18 06:30:23  reinelt
- * added (C) to all copyright statements
- *
- * Revision 1.42  2005/01/17 06:38:48  reinelt
- * info about backlight and brightness
- *
- * Revision 1.41  2005/01/17 06:29:24  reinelt
- * added software-controlled backlight support to HD44780
- *
- * Revision 1.40  2004/11/30 05:01:25  reinelt
- * removed compiler warnings for deactivated i2c bus
- *
- * Revision 1.39  2004/10/17 09:24:31  reinelt
- * I2C support for HD44780 displays by Luis (does not work by now)
- *
- * Revision 1.38  2004/09/19 09:31:19  reinelt
- * HD44780 busy flag checking improved: fall back to busy-waiting if too many errors occur
- *
- * Revision 1.37  2004/09/18 15:58:57  reinelt
- * even more HD44780 cleanups, hardwiring for LCM-162
- *
- * Revision 1.36  2004/09/18 10:57:29  reinelt
- * more parport/i2c cleanups
- *
- * Revision 1.35  2004/09/18 09:48:29  reinelt
- * HD44780 cleanup and prepararation for I2C backend
- * LCM-162 submodel framework
- *
- * Revision 1.34  2004/09/18 08:22:59  reinelt
- * drv_generic_parport_status() to read status lines
- *
- * Revision 1.33  2004/08/29 13:03:41  reinelt
- *
- * added RouterBoard driver
- *
- * Revision 1.32  2004/06/26 12:04:59  reinelt
- *
- * uh-oh... the last CVS log message messed up things a lot...
- *
- * Revision 1.31  2004/06/26 09:27:20  reinelt
- *
- * added '-W' to CFLAGS
- * changed all C++ comments to C ones
- * cleaned up a lot of signed/unsigned mistakes
- *
- * Revision 1.30  2004/06/20 10:09:54  reinelt
- *
- * 'const'ified the whole source
- *
- * Revision 1.29  2004/06/06 06:51:59  reinelt
- *
- * do not display end splash screen if quiet=1
- *
- * Revision 1.28  2004/06/05 06:41:39  reinelt
- *
- * chancged splash screen again
- *
- * Revision 1.27  2004/06/05 06:13:11  reinelt
- *
- * splash screen for all text-based display drivers
- *
- * Revision 1.26  2004/06/02 10:09:22  reinelt
- *
- * splash screen for HD44780
- *
- * Revision 1.25  2004/06/02 09:41:19  reinelt
- *
- * prepared support for startup splash screen
- *
- * Revision 1.24  2004/06/01 06:45:29  reinelt
- *
- * some Fixme's processed
- * documented some code
- *
- * Revision 1.23  2004/05/31 05:38:02  reinelt
- *
- * fixed possible bugs with user-defined chars (clear high bits)
- * thanks to Andy Baxter for debugging the MilfordInstruments driver!
- *
- * Revision 1.22  2004/05/27 03:39:47  reinelt
- *
- * changed function naming scheme to plugin::function
- *
- * Revision 1.21  2004/05/26 11:37:36  reinelt
- *
- * Curses driver ported.
- *
- * Revision 1.20  2004/05/22 04:23:49  reinelt
- *
- * removed 16*x fix again (next time think before commit :-)
- *
- * Revision 1.19  2004/05/22 04:21:02  reinelt
- *
- * fix for display RAM layout on 16x4 displays (thanks to toxicated101)
- *
- * Revision 1.18  2004/03/20 07:31:32  reinelt
- * support for HD66712 (which has a different RAM layout)
- * further threading development
- *
- * Revision 1.17  2004/03/19 09:17:46  reinelt
- *
- * removed the extra 'goto' function, row and col are additional parameters
- * of the write() function now.
- *
- * Revision 1.16  2004/03/11 06:39:58  reinelt
- * big patch from Martin:
- * - reuse filehandles
- * - memory leaks fixed
- * - earlier busy-flag checking with HD44780
- * - reuse memory for strings in RESULT and hash
- * - netdev_fast to wavid time-consuming regex
- *
- * Revision 1.15  2004/03/03 03:47:04  reinelt
- * big patch from Martin Hejl:
- * - use qprintf() where appropriate
- * - save CPU cycles on gettimeofday()
- * - add quit() functions to free allocated memory
- * - fixed lots of memory leaks
- *
- * Revision 1.14  2004/03/01 04:29:51  reinelt
- * cfg_number() returns -1 on error, 0 if value not found (but default val used),
- *  and 1 if value was used from the configuration.
- * HD44780 driver adopted to new cfg_number()
- * Crystalfontz 631 driver nearly finished
- *
- * Revision 1.13  2004/02/15 21:43:43  reinelt
- * T6963 driver nearly finished
- * framework for graphic displays done
- * i2c_sensors patch from Xavier
- * some more old generation files removed
- *
- * Revision 1.12  2004/02/14 11:56:17  reinelt
- * M50530 driver ported
- * changed lots of 'char' to 'unsigned char'
- *
- * Revision 1.11  2004/02/04 19:10:51  reinelt
- * Crystalfontz driver nearly finished
- *
- * Revision 1.10  2004/02/02 05:22:16  reinelt
- * Brightness fpr Noritake Displays avaliable as a plugin
- *
- * Revision 1.9  2004/02/01 11:51:22  hejl
- * Fixes for busy flag
- *
- * Revision 1.8  2004/02/01 08:05:12  reinelt
- * Crystalfontz 633 extensions (CRC checking and stuff)
- * Models table for HD44780
- * Noritake VFD BVrightness patch from Bill Paxton
- *
- * Revision 1.7  2004/01/30 07:12:35  reinelt
- * HD44780 busy-flag support from Martin Hejl
- * loadavg() uClibc replacement from Martin Heyl
- * round() uClibc replacement from Martin Hejl
- * warning in i2c_sensors fixed
- * [
- *
- * Revision 1.6  2004/01/29 04:40:02  reinelt
- * every .c file includes "config.h" now
- *
- * Revision 1.5  2004/01/23 07:04:17  reinelt
- * icons finished!
- *
- * Revision 1.4  2004/01/23 04:53:48  reinelt
- * icon widget added (not finished yet!)
- *
- * Revision 1.3  2004/01/22 07:57:45  reinelt
- * several bugs fixed where segfaulting on layout>display
- * Crystalfontz driver optimized, 632 display already works
- *
- * Revision 1.2  2004/01/21 06:39:27  reinelt
- * HD44780 missed the "clear display' sequence
- * asc255bug handling added
- * HD44780 tested, works here!
- *
- * Revision 1.1  2004/01/20 15:32:49  reinelt
- * first version of Next Generation HD44780 (untested! but it compiles...)
- * some cleanup in the other drivers
- *
  */
 
 /* 
@@ -277,9 +63,16 @@
 #include "widget_text.h"
 #include "widget_icon.h"
 #include "widget_bar.h"
+#include "widget_keypad.h"
 #include "drv.h"
 #include "drv_generic_text.h"
+#include "drv_generic_gpio.h"
+
+#ifdef WITH_PARPORT
 #include "drv_generic_parport.h"
+#include "drv_generic_keypad.h"
+#include "widget_keypad.h"
+#endif
 
 #ifdef WITH_I2C
 #include "drv_generic_i2c.h"
@@ -292,29 +85,14 @@
 static int Capabilities;
 
 
-/* low level communication timings [nanoseconds]
- * as these values differ from spec to spec,
- * we use the worst-case values.
- */
-
-#define T_CYCLE 1000		/* Enable cycle time */
-#define T_PW     450		/* Enable pulse width */
-#define T_AS      60		/* Address setup time */
-#define T_H       40		/* Data hold time */
-#define T_AH      20		/* Address hold time */
-
-
-/* HD44780 execution timings [microseconds]
- * as these values differ from spec to spec,
- * we use the worst-case values.
- */
-
-#define T_INIT1 4100		/* first init sequence:  4.1 msec */
-#define T_INIT2  100		/* second init sequence: 100 usec */
-#define T_EXEC    80		/* normal execution time */
-#define T_WRCG   120		/* CG RAM Write */
-#define T_CLEAR 2250		/* Clear Display */
-
+/* Timings */
+#ifdef WITH_PARPORT
+static int T_CY, T_PW, T_AS, T_AH;
+#endif
+static int T_INIT1, T_INIT2, T_EXEC, T_WRCG, T_CLEAR, T_HOME, T_ONOFF;
+#ifdef WITH_PARPORT
+static int T_POWER, T_GPO_ST, T_GPO_PW;
+#endif
 
 static int Bits = 0;
 static int numControllers = 0;
@@ -331,8 +109,13 @@
 static unsigned char SIGNAL_ENABLE2;
 static unsigned char SIGNAL_ENABLE3;
 static unsigned char SIGNAL_ENABLE4;
-static unsigned char SIGNAL_BACKLIGHT;
+
 static unsigned char SIGNAL_GPO;
+static unsigned char SIGNAL_GPI;
+#ifdef WITH_PARPORT
+static unsigned char SIGNAL_BACKLIGHT;
+static unsigned char SIGNAL_POWER;
+#endif
 
 /* maximum time to wait for the busy-flag (in usec) */
 #define MAX_BUSYFLAG_WAIT 10000
@@ -341,13 +124,17 @@
 #define MAX_BUSYFLAG_ERRORS 20
 
 /* flag for busy-waiting vs. busy flag checking */
+#ifdef WITH_PARPORT
 static int UseBusy = 0;
+#endif
 
+/* which data bits should have their logic inverted */
+static int invert_data_bits = 0;
 
-/* Fixme: GPO's not yet implemented */
-static int GPOS;
-/* static int GPO=0; */
-
+/* buffer holding the GPIO state */
+#ifdef WITH_PARPORT
+static unsigned char GPO = 0;
+#endif
 
 typedef struct {
     int type;
@@ -363,13 +150,14 @@
 #define CAP_BUSY4BIT   (1<<5)
 #define CAP_HD66712    (1<<6)
 #define CAP_LCM162     (1<<7)
+#define CAP_GPI        (1<<8)
 
 #define BUS_PP  CAP_PARPORT
 #define BUS_I2C CAP_I2C
 
 
 static MODEL Models[] = {
-    {0x01, "generic", CAP_PARPORT | CAP_I2C | CAP_GPO | CAP_BACKLIGHT},
+    {0x01, "generic", CAP_PARPORT | CAP_I2C | CAP_GPO | CAP_GPI | CAP_BACKLIGHT},
     {0x02, "Noritake", CAP_PARPORT | CAP_I2C | CAP_GPO | CAP_BRIGHTNESS},
     {0x03, "Soekris", CAP_PARPORT | CAP_BUSY4BIT},
     {0x04, "HD66712", CAP_PARPORT | CAP_I2C | CAP_GPO | CAP_BACKLIGHT | CAP_HD66712},
@@ -383,8 +171,9 @@
 /****************************************/
 
 static int (*drv_HD_load) (const char *section);
-static void (*drv_HD_command) (const unsigned char controller, const unsigned char cmd, const int delay);
-static void (*drv_HD_data) (const unsigned char controller, const char *string, const int len, const int delay);
+static void (*drv_HD_command) (const unsigned char controller, const unsigned char cmd, const unsigned long delay);
+static void (*drv_HD_data) (const unsigned char controller, const char *string, const int len,
+			    const unsigned long delay);
 static void (*drv_HD_stop) (void);
 
 
@@ -393,6 +182,8 @@
 /***  parport dependant functions     ***/
 /****************************************/
 
+#ifdef WITH_PARPORT
+
 static void drv_HD_PP_busy(const int controller)
 {
     static unsigned int errors = 0;
@@ -435,7 +226,7 @@
 		/* Set RW, clear RS */
 		drv_generic_parport_control(SIGNAL_RW | SIGNAL_RS, SIGNAL_RW);
 	    } else {
-		drv_generic_parport_data(SIGNAL_RW);
+		drv_generic_parport_data(SIGNAL_RW ^ invert_data_bits);
 	    }
 
 	    /* Address set-up time */
@@ -445,7 +236,7 @@
 	    if (Bits == 8) {
 		drv_generic_parport_control(enable, enable);
 	    } else {
-		drv_generic_parport_data(SIGNAL_RW | enable);
+		drv_generic_parport_data((SIGNAL_RW | enable) ^ invert_data_bits);
 	    }
 
 	    counter = 0;
@@ -480,7 +271,7 @@
 		    /* get the current time */
 		    gettimeofday(&now, NULL);
 		    if (now.tv_sec == end.tv_sec ? now.tv_usec >= end.tv_usec : now.tv_sec >= end.tv_sec) {
-			error("%s: timeout waiting for busy flag on controller %x (%x)", Name, ctrlmask, data);
+			error("%s: timeout waiting for busy flag on controller %x (0x%02x)", Name, ctrlmask, data);
 			if (++errors >= MAX_BUSYFLAG_ERRORS) {
 			    error("%s: too many busy flag failures, turning off busy flag checking.", Name);
 			    UseBusy = 0;
@@ -501,9 +292,9 @@
 		drv_generic_parport_control(SIGNAL_RW | SIGNAL_RS, 0);
 	    } else {
 		/* Lower EN */
-		drv_generic_parport_data(SIGNAL_RW);
+		drv_generic_parport_data(SIGNAL_RW ^ invert_data_bits);
 		ndelay(T_AH);
-		drv_generic_parport_data(0);
+		drv_generic_parport_data(0 ^ invert_data_bits);
 	    }
 
 	    /* set data-lines to output */
@@ -534,19 +325,19 @@
     /* clear ENABLE */
     /* put data on DB1..DB4 */
     /* nibble already contains RS bit! */
-    drv_generic_parport_data(nibble);
+    drv_generic_parport_data(nibble ^ invert_data_bits);
 
     /* Address set-up time */
     ndelay(T_AS);
 
     /* rise ENABLE */
-    drv_generic_parport_data(nibble | enable);
+    drv_generic_parport_data((nibble | enable) ^ invert_data_bits);
 
     /* Enable pulse width */
     ndelay(T_PW);
 
     /* lower ENABLE */
-    drv_generic_parport_data(nibble);
+    drv_generic_parport_data(nibble ^ invert_data_bits);
 }
 
 
@@ -555,15 +346,15 @@
     /* send high nibble of the data */
     drv_HD_PP_nibble(controller, ((data >> 4) & 0x0f) | RS);
 
-    /* Make sure we honour T_CYCLE */
-    ndelay(T_CYCLE - T_AS - T_PW);
+    /* Make sure we honour T_CY */
+    ndelay(T_CY - T_AS - T_PW);
 
     /* send low nibble of the data */
     drv_HD_PP_nibble(controller, (data & 0x0f) | RS);
 }
 
 
-static void drv_HD_PP_command(const unsigned char controller, const unsigned char cmd, const int delay)
+static void drv_HD_PP_command(const unsigned char controller, const unsigned char cmd, const unsigned long delay)
 {
     unsigned char enable;
 
@@ -586,7 +377,7 @@
 	    enable |= SIGNAL_ENABLE4;
 
 	/* put data on DB1..DB8 */
-	drv_generic_parport_data(cmd);
+	drv_generic_parport_data(cmd ^ invert_data_bits);
 
 	/* clear RW and RS */
 	drv_generic_parport_control(SIGNAL_RW | SIGNAL_RS, 0);
@@ -610,7 +401,7 @@
 }
 
 
-static void drv_HD_PP_data(const unsigned char controller, const char *string, const int len, const int delay)
+static void drv_HD_PP_data(const unsigned char controller, const char *string, const int len, const unsigned long delay)
 {
     int l = len;
     unsigned char enable;
@@ -652,7 +443,7 @@
 	    }
 
 	    /* put data on DB1..DB8 */
-	    drv_generic_parport_data(*(string++));
+	    drv_generic_parport_data((*(string++)) ^ invert_data_bits);
 
 	    /* send command */
 	    drv_generic_parport_toggle(enable, 1, T_PW);
@@ -720,6 +511,8 @@
 	    return -1;
 	if ((SIGNAL_GPO = drv_generic_parport_hardwire_ctrl("GPO", "GND")) == 0xff)
 	    return -1;
+	if ((SIGNAL_POWER = drv_generic_parport_hardwire_ctrl("POWER", "GND")) == 0xff)
+	    return -1;
     } else {
 	if (Bits == 8) {
 	    if ((SIGNAL_RS = drv_generic_parport_wire_ctrl("RS", "AUTOFD")) == 0xff)
@@ -748,11 +541,15 @@
 	    if ((SIGNAL_ENABLE4 = drv_generic_parport_wire_data("ENABLE4", "GND")) == 0xff)
 		return -1;
 	}
-	/* backlight and GPO are always control signals */
+	/* backlight GPO and power are always control signals */
 	if ((SIGNAL_BACKLIGHT = drv_generic_parport_wire_ctrl("BACKLIGHT", "GND")) == 0xff)
 	    return -1;
 	if ((SIGNAL_GPO = drv_generic_parport_wire_ctrl("GPO", "GND")) == 0xff)
 	    return -1;
+	if ((SIGNAL_GPI = drv_generic_parport_wire_ctrl("GPI", "GND")) == 0xff)
+	    return -1;
+	if ((SIGNAL_POWER = drv_generic_parport_wire_ctrl("POWER", "GND")) == 0xff)
+	    return -1;
     }
 
     /* clear capabilities if corresponding signal is GND */
@@ -762,19 +559,70 @@
     if (SIGNAL_GPO == 0) {
 	Capabilities &= ~CAP_GPO;
     }
+    if (SIGNAL_GPI == 0) {
+	Capabilities &= ~CAP_GPI;
+    }
 
+    /* Timings */
+
+    /* low level communication timings [nanoseconds]
+     * as these values differ from spec to spec,
+     * we use the worst-case default values, but allow
+     * modification from the config file.
+     */
+    T_CY = timing(Name, section, "CY", 1000, "ns");	/* Enable cycle time */
+    T_PW = timing(Name, section, "PW", 450, "ns");	/* Enable pulse width */
+    T_AS = timing(Name, section, "AS", 140, "ns");	/* Address setup time */
+    T_AH = timing(Name, section, "AH", 20, "ns");	/* Address hold time */
+
+    /* GPO timing */
+    if (SIGNAL_GPO != 0) {
+	T_GPO_ST = timing(Name, section, "GPO_ST", 20, "ns");	/* 74HCT573 set-up time */
+	T_GPO_PW = timing(Name, section, "GPO_PW", 230, "ns");	/* 74HCT573 enable pulse width */
+    } else {
+	T_GPO_ST = 0;
+	T_GPO_PW = 0;
+    }
+
+    /* HD44780 execution timings [microseconds]
+     * as these values differ from spec to spec,
+     * we use the worst-case default values, but allow
+     * modification from the config file.
+     */
+    T_INIT1 = timing(Name, section, "INIT1", 4100, "us");	/* first init sequence: 4.1 msec */
+    T_INIT2 = timing(Name, section, "INIT2", 100, "us");	/* second init sequence: 100 usec */
+    T_EXEC = timing(Name, section, "EXEC", 80, "us");	/* normal execution time */
+    T_WRCG = timing(Name, section, "WRCG", 120, "us");	/* CG RAM Write */
+    T_CLEAR = timing(Name, section, "CLEAR", 2250, "us");	/* Clear Display */
+    T_HOME = timing(Name, section, "HOME", 2250, "us");	/* Return Cursor Home */
+    T_ONOFF = timing(Name, section, "ONOFF", 2250, "us");	/* Display On/Off Control */
+
+    /* Power-on delay */
+    if (SIGNAL_POWER != 0) {
+	T_POWER = timing(Name, section, "POWER", 500, "ms");
+    } else {
+	T_POWER = 0;
+    }
 
     /* clear all signals */
     if (Bits == 8) {
-	drv_generic_parport_control(SIGNAL_RS |
-				    SIGNAL_RW | SIGNAL_ENABLE | SIGNAL_ENABLE2 | SIGNAL_ENABLE3 | SIGNAL_ENABLE4 | SIGNAL_BACKLIGHT | SIGNAL_GPO, 0);
+	drv_generic_parport_control(SIGNAL_RS | SIGNAL_RW |
+				    SIGNAL_ENABLE | SIGNAL_ENABLE2 | SIGNAL_ENABLE3 | SIGNAL_ENABLE4 |
+				    SIGNAL_BACKLIGHT | SIGNAL_GPO | SIGNAL_POWER, 0);
     } else {
-	drv_generic_parport_data(0);
+	drv_generic_parport_control(SIGNAL_BACKLIGHT | SIGNAL_GPO | SIGNAL_POWER, 0);
+	drv_generic_parport_data(0 ^ invert_data_bits);
     }
 
     /* set direction: write */
     drv_generic_parport_direction(0);
 
+    /* raise power pin */
+    if (SIGNAL_POWER != 0) {
+	drv_generic_parport_control(SIGNAL_POWER, SIGNAL_POWER);
+	udelay(1000 * T_POWER);
+    }
+
     /* initialize *all* controllers */
     if (Bits == 8) {
 	drv_HD_PP_command(allControllers, 0x30, T_INIT1);	/* 8 Bit mode, wait 4.1 ms */
@@ -826,15 +674,19 @@
     /* clear all signals */
     if (Bits == 8) {
 	drv_generic_parport_control(SIGNAL_RS |
-				    SIGNAL_RW | SIGNAL_ENABLE | SIGNAL_ENABLE2 | SIGNAL_ENABLE3 | SIGNAL_ENABLE4 | SIGNAL_BACKLIGHT | SIGNAL_GPO, 0);
+				    SIGNAL_RW | SIGNAL_ENABLE | SIGNAL_ENABLE2 | SIGNAL_ENABLE3 | SIGNAL_ENABLE4 |
+				    SIGNAL_BACKLIGHT | SIGNAL_GPO, 0);
     } else {
-	drv_generic_parport_data(0);
+	drv_generic_parport_data(0 ^ invert_data_bits);
+	drv_generic_parport_control(SIGNAL_BACKLIGHT | SIGNAL_GPO | SIGNAL_POWER, 0);
     }
 
     drv_generic_parport_close();
 
 }
 
+#endif
+
 
 #ifdef WITH_I2C
 
@@ -903,7 +755,7 @@
 
 
 static void drv_HD_I2C_command(const unsigned char controller, const unsigned char cmd, __attribute__ ((unused))
-			       const int delay)
+			       const unsigned long delay)
 {
     /* send data with RS disabled */
     drv_HD_I2C_nibble(controller, ((cmd >> 4) & 0x0f));
@@ -911,7 +763,7 @@
 }
 
 static void drv_HD_I2C_data(const unsigned char controller, const char *string, const int len, __attribute__ ((unused))
-			    const int delay)
+			    const unsigned long delay)
 {
     int l = len;
 
@@ -958,7 +810,7 @@
     drv_HD_I2C_nibble(allControllers, 0x03);
     udelay(T_INIT2);		/* 4 Bit mode, wait 100 us */
     drv_HD_I2C_nibble(allControllers, 0x03);
-    udelay(T_INIT2);		/* 4 Bit mode, wait 4.1 ms */
+    udelay(T_INIT1);		/* 4 Bit mode, wait 4.1 ms */
     drv_HD_I2C_nibble(allControllers, 0x02);
     udelay(T_INIT2);		/* 4 Bit mode, wait 100 us */
     drv_HD_I2C_command(allControllers, 0x28, T_EXEC);	/* 4 Bit mode, 1/16 duty cycle, 5x8 font */
@@ -1012,7 +864,8 @@
 	return -1;
 
     if (0) {
-	debug("goto: [%d,%d] mask=%d, controller=%d, size:%dx%d", row, col, currController, controller, CROWS[controller], CCOLS[controller]);
+	debug("goto: [%d,%d] mask=%d, controller=%d, size:%dx%d", row, col, currController, controller,
+	      CROWS[controller], CCOLS[controller]);
     }
 
     /* 16x1 Displays are organized as 8x2 :-( */
@@ -1064,6 +917,8 @@
 }
 
 
+#ifdef WITH_PARPORT
+
 static int drv_HD_backlight(int backlight)
 {
     if (!(Capabilities & CAP_BACKLIGHT))
@@ -1079,6 +934,8 @@
     return backlight;
 }
 
+#endif
+
 
 static int drv_HD_brightness(int brightness)
 {
@@ -1101,26 +958,67 @@
 }
 
 
-/* Fixme: GPO's */
-#if 0
-static void drv_HD_setGPO(const int bits)
+#ifdef WITH_PARPORT
+
+static int drv_HD_GPO(const int num, const int val)
 {
-    if (Lcd.gpos > 0) {
+    int v;
 
-	/* put data on DB1..DB8 */
-	drv_generic_parport_data(bits);
+    if (val > 0) {
+	/* set bit */
+	v = 1;
+	GPO |= 1 << num;
+    } else {
+	/* clear bit */
+	v = 0;
+	GPO &= ~(1 << num);
+    }
 
-	/* 74HCT573 set-up time */
-	ndelay(20);
+    /* put data on DB1..DB8 */
+    drv_generic_parport_data(GPO ^ invert_data_bits);
 
-	/* send data */
-	/* 74HCT573 enable pulse width = 24ns */
-	drv_generic_parport_toggle(SIGNAL_GPO, 1, 230);
-    }
+    /* 74HCT573 set-up time */
+    ndelay(T_GPO_ST);
+
+    /* send data */
+    /* 74HCT573 enable pulse width */
+    drv_generic_parport_toggle(SIGNAL_GPO, 1, T_GPO_PW);
+
+    return v;
+}
+
+static int drv_HD_GPI(const int num)
+{
+    int v;
+
+    /* switch to read mode */
+    drv_generic_parport_direction(1);
+    drv_generic_parport_control(SIGNAL_GPI, SIGNAL_GPI);
+
+    /* 74HCT573 set-up time + enable pulse width */
+    ndelay(T_GPO_ST + T_GPO_PW);
+
+    /* read data from DB1..DB8 */
+    v = drv_generic_parport_read() ^ invert_data_bits;
+
+    /* switch back to write mode */
+    drv_generic_parport_control(SIGNAL_GPI, 0);
+    drv_generic_parport_direction(0);
+
+    return (v >> num) & 1;
 }
+
 #endif
 
 
+#ifdef WITH_PARPORT
+
+
+static int drv_HD_LCM162_keypad_handler(const int num)
+{
+    return num;
+}
+
 static void drv_HD_LCM162_timer(void __attribute__ ((unused)) * notused)
 {
     static unsigned char data = 0x00;
@@ -1142,18 +1040,40 @@
     if (data != temp) {
 	data = temp;
 
+	int KEYPAD_VAL = 0;
 	keynum = (data & mask3 ? 1 : 0) + (data & mask5 ? 2 : 0);
+	switch (keynum) {
+	default:
+	case 0:
+	    KEYPAD_VAL = WIDGET_KEY_CANCEL;
+	    break;
+	case 1:
+	    KEYPAD_VAL = WIDGET_KEY_UP;
+	    break;
+	case 2:
+	    KEYPAD_VAL = WIDGET_KEY_CONFIRM;
+	    break;
+	case 3:
+	    KEYPAD_VAL = WIDGET_KEY_DOWN;
+	    break;
+	}
+
 	updown = (data & mask6 ? 1 : 0);
+	KEYPAD_VAL += updown ? WIDGET_KEY_PRESSED : WIDGET_KEY_RELEASED;
+
+	drv_generic_keypad_press(KEYPAD_VAL);
 
 	debug("key %d press %d", keynum, updown);
     }
 }
 
+#endif
+
 
 static int drv_HD_start(const char *section, const int quiet)
 {
     char *model, *size, *bus;
-    int rows = -1, cols = -1, gpos = -1, i;
+    int rows = -1, cols = -1, gpos = -1, gpis = -1, i;
     int size_defined = 0;
     int size_missing = 0;
 
@@ -1186,14 +1106,23 @@
     }
 
     if (strcasecmp(bus, "parport") == 0) {
+
+#ifdef WITH_PARPORT
 	info("%s: using parallel port", Name);
 	Bus = BUS_PP;
 	drv_HD_load = drv_HD_PP_load;
 	drv_HD_command = drv_HD_PP_command;
 	drv_HD_data = drv_HD_PP_data;
 	drv_HD_stop = drv_HD_PP_stop;
+#else
+	error("%s: %s.Bus '%s' from %s not available:", Name, section, bus, cfg_source());
+	error("%s: lcd4linux was compiled without parport support!", Name);
+	free(bus);
+	return -1;
+#endif
 
     } else if (strcasecmp(bus, "i2c") == 0) {
+
 #ifdef WITH_I2C
 	info("%s: using I2C bus", Name);
 	Bus = BUS_I2C;
@@ -1297,17 +1226,34 @@
 	gpos = 0;
     }
     GPOS = gpos;
-    if (gpos > 0) {
+    if (GPOS > 0) {
 	info("%s: using %d GPO's", Name, GPOS);
     }
 
+    if (cfg_number(section, "GPIs", 0, 0, 8, &gpis) < 0)
+	return -1;
+    if (gpis > 0 && !(Capabilities & CAP_GPI)) {
+	error("%s: Model '%s' does not support GPI's!", Name, Models[Model].name);
+	gpis = 0;
+    }
+    GPIS = gpis;
+    if (GPIS > 0) {
+	info("%s: using %d GPI's", Name, GPIS);
+    }
+
+    if (cfg_number(section, "InvertDataBits", 0, 0, 256, &invert_data_bits) < 0)
+	return -1;
+    if (invert_data_bits) {
+	info("%s: inverting data bits (mask %02X)", Name, invert_data_bits);
+    }
+
     if (drv_HD_load(section) < 0) {
 	error("%s: start display failed!", Name);
 	return -1;
     }
 
     drv_HD_command(allControllers, 0x08, T_EXEC);	/* Controller off, cursor off, blink off */
-    drv_HD_command(allControllers, 0x0c, T_CLEAR);	/* Display on, cursor off, blink off, wait 1.64 ms */
+    drv_HD_command(allControllers, 0x0c, T_ONOFF);	/* Display on, cursor off, blink off, wait 1.64 ms */
     drv_HD_command(allControllers, 0x06, T_EXEC);	/* curser moves to right, no shift */
 
     if ((Capabilities & CAP_HD66712) && DROWS > 2) {
@@ -1317,9 +1263,10 @@
     }
 
     drv_HD_clear();		/* clear *all* displays */
-    drv_HD_command(allControllers, 0x03, T_CLEAR);	/* return home */
+    drv_HD_command(allControllers, 0x03, T_HOME);	/* return home */
 
     /* maybe set backlight */
+#ifdef WITH_PARPORT
     if (Capabilities & CAP_BACKLIGHT) {
 	int backlight;
 	if (cfg_number(section, "Backlight", 0, 0, 1, &backlight) > 0) {
@@ -1327,6 +1274,7 @@
 	    drv_HD_backlight(backlight);
 	}
     }
+#endif
 
     /* maybe set brightness */
     if (Capabilities & CAP_BRIGHTNESS) {
@@ -1338,9 +1286,12 @@
     }
 
     /* install keypad polling timer for LCM-162 */
+#ifdef WITH_PARPORT
     if (Capabilities & CAP_LCM162) {
 	timer_add(drv_HD_LCM162_timer, NULL, 10, 0);
+	drv_generic_keypad_real_press = drv_HD_LCM162_keypad_handler;
     }
+#endif
 
     if (!quiet) {
 	char buffer[40];
@@ -1360,6 +1311,7 @@
 /****************************************/
 
 
+#ifdef WITH_PARPORT
 static void plugin_backlight(RESULT * result, RESULT * arg1)
 {
     double backlight;
@@ -1367,7 +1319,7 @@
     backlight = drv_HD_backlight(R2N(arg1));
     SetResult(&result, R_NUMBER, &backlight);
 }
-
+#endif
 
 static void plugin_brightness(RESULT * result, RESULT * arg1)
 {
@@ -1386,6 +1338,7 @@
 /* using drv_generic_text_draw(W) */
 /* using drv_generic_text_icon_draw(W) */
 /* using drv_generic_text_bar_draw(W) */
+/* using drv_generic_gpio_draw(W) */
 
 
 /****************************************/
@@ -1412,6 +1365,8 @@
     int asc255bug;
     int ret;
 
+    info("%s: %s", Name, "$Rev: 905 $");
+
     /* display preferences */
     XRES = 5;			/* pixel width of one char  */
     YRES = 8;			/* pixel height of one char  */
@@ -1422,7 +1377,10 @@
     /* real worker functions */
     drv_generic_text_real_write = drv_HD_write;
     drv_generic_text_real_defchar = drv_HD_defchar;
-
+#ifdef WITH_PARPORT
+    drv_generic_gpio_real_set = drv_HD_GPO;
+    drv_generic_gpio_real_get = drv_HD_GPI;
+#endif
 
     /* start display */
     if ((ret = drv_HD_start(section, quiet)) != 0)
@@ -1449,6 +1407,13 @@
     if (!asc255bug)
 	drv_generic_text_bar_add_segment(255, 255, 255, 255);	/* ASCII 255 = block */
 
+    /* initialize generic GPIO driver */
+    if ((ret = drv_generic_gpio_init(section, Name)) != 0)
+	return ret;
+
+    if ((ret = drv_generic_keypad_init(section, Name)) != 0)
+	return ret;
+
     /* register text widget */
     wc = Widget_Text;
     wc.draw = drv_generic_text_draw;
@@ -1465,9 +1430,11 @@
     widget_register(&wc);
 
     /* register plugins */
+#ifdef WITH_PARPORT
     if (Capabilities & CAP_BACKLIGHT) {
 	AddFunction("LCD::backlight", 1, plugin_backlight);
     }
+#endif
     if (Capabilities & CAP_BRIGHTNESS) {
 	AddFunction("LCD::brightness", 1, plugin_brightness);
     }
@@ -1480,9 +1447,10 @@
 int drv_HD_quit(const int quiet)
 {
 
-    info("%s: shutting down.", Name);
+    info("%s: shutting down display.", Name);
 
     drv_generic_text_quit();
+    drv_generic_gpio_quit();
 
     /* clear display */
     drv_HD_clear();
@@ -1499,8 +1467,8 @@
 
 
 DRIVER drv_HD44780 = {
-  name:Name,
-  list:drv_HD_list,
-  init:drv_HD_init,
-  quit:drv_HD_quit,
+    .name = Name,
+    .list = drv_HD_list,
+    .init = drv_HD_init,
+    .quit = drv_HD_quit,
 };
diff -urN lcd4linux-0.10.0/drv_Image.c lcd4linux-0.11.0-SVN/drv_Image.c
--- lcd4linux-0.10.0/drv_Image.c	2005-05-08 06:32:44.000000000 +0200
+++ lcd4linux-0.11.0-SVN/drv_Image.c	2008-12-31 08:05:54.000000000 +0100
@@ -1,8 +1,9 @@
-/* $Id: drv_Image.c,v 1.12 2005/05/08 04:32:44 reinelt Exp $
+/* $Id: drv_Image.c 840 2007-09-09 12:17:42Z michael $
+ * $URL: https://ssl.bulix.org/svn/lcd4linux/trunk/drv_Image.c $
  *
  * new style Image (PPM/PNG) Driver for LCD4Linux 
  *
- * Copyright (C) 2003 Michael Reinelt <reinelt@eunet.at>
+ * Copyright (C) 2003 Michael Reinelt <michael@reinelt.co.at>
  * Copyright (C) 2004 The LCD4Linux Team <lcd4linux-devel@users.sourceforge.net>
  *
  * This file is part of LCD4Linux.
@@ -21,56 +22,6 @@
  * along with this program; if not, write to the Free Software
  * Foundation, Inc., 675 Mass Ave, Cambridge, MA 02139, USA.
  *
- *
- * $Log: drv_Image.c,v $
- * Revision 1.12  2005/05/08 04:32:44  reinelt
- * CodingStyle added and applied
- *
- * Revision 1.11  2005/01/18 06:30:23  reinelt
- * added (C) to all copyright statements
- *
- * Revision 1.10  2004/11/29 04:42:07  reinelt
- * removed the 99999 msec limit on widget update time (thanks to Petri Damsten)
- *
- * Revision 1.9  2004/06/26 12:04:59  reinelt
- *
- * uh-oh... the last CVS log message messed up things a lot...
- *
- * Revision 1.8  2004/06/26 09:27:20  reinelt
- *
- * added '-W' to CFLAGS
- * changed all C++ comments to C ones
- * cleaned up a lot of signed/unsigned mistakes
- *
- * Revision 1.7  2004/06/20 10:09:54  reinelt
- *
- * 'const'ified the whole source
- *
- * Revision 1.6  2004/06/19 08:20:19  reinelt
- *
- * compiler warning in image driver fixed
- * bar bug in USBLCD driver fixed
- *
- * Revision 1.5  2004/06/06 06:51:59  reinelt
- *
- * do not display end splash screen if quiet=1
- *
- * Revision 1.4  2004/06/02 09:41:19  reinelt
- *
- * prepared support for startup splash screen
- *
- * Revision 1.3  2004/05/31 06:24:42  reinelt
- *
- * fixed symlink security issue with the image driver
- *
- * Revision 1.2  2004/05/29 23:30:20  reinelt
- *
- * fixed a compiler issue with drv_Image.c (thanks to Frank Stratmann)
- *
- * Revision 1.1  2004/05/25 14:27:21  reinelt
- *
- * added drv_Image.c (this time really!)
- *
  */
 
 /* 
@@ -93,7 +44,9 @@
 #include <fcntl.h>
 #include <sys/time.h>
 
+
 #ifdef WITH_PNG
+
 #ifdef HAVE_GD_GD_H
 #include <gd/gd.h>
 #else
@@ -104,6 +57,12 @@
 #error "cannot compile PNG driver"
 #endif
 #endif
+
+#if GD2_VERS != 2
+#error "lcd4linux requires libgd version 2"
+#error "cannot compile PNG driver"
+#endif
+
 #endif
 
 
@@ -112,10 +71,6 @@
 #include "timer.h"
 #include "qprintf.h"
 #include "plugin.h"
-#include "widget.h"
-#include "widget_text.h"
-#include "widget_icon.h"
-#include "widget_bar.h"
 #include "drv.h"
 #include "drv_generic_graphic.h"
 
@@ -125,9 +80,7 @@
 
 static char Name[] = "Image";
 
-static enum { PPM, PNG } Format;
-
-static unsigned int fg_col, bg_col, hg_col;
+static enum { NIL, PPM, PNG } Format;
 
 static int pixel = -1;		/* pointsize in pixel */
 static int pgap = 0;		/* gap between points */
@@ -137,7 +90,8 @@
 
 static int dimx, dimy;		/* total window dimension in pixel */
 
-static unsigned char *drv_IMG_FB = NULL;
+static RGBA BC;
+static RGBA *drv_IMG_FB = NULL;
 
 static int dirty = 1;
 
@@ -149,10 +103,9 @@
 static int drv_IMG_flush_PPM(void)
 {
     static int seq = 0;
-    static unsigned char *bitbuf = NULL;
+    static RGBA *bitbuf = NULL;
     static unsigned char *rowbuf = NULL;
-    int xsize, ysize, row, col;
-    unsigned char R[3], G[3], B[3];
+    int xsize, ysize, row, col, i;
     char path[256], tmp[256], buffer[256];
     int fd;
 
@@ -161,19 +114,21 @@
 
     if (bitbuf == NULL) {
 	if ((bitbuf = malloc(xsize * ysize * sizeof(*bitbuf))) == NULL) {
-	    error("%s: malloc(%d) failed: %s", Name, xsize * ysize * sizeof(*bitbuf), strerror(errno));
+	    error("%s: malloc() failed: %s", Name, strerror(errno));
 	    return -1;
 	}
     }
 
     if (rowbuf == NULL) {
 	if ((rowbuf = malloc(3 * xsize * sizeof(*rowbuf))) == NULL) {
-	    error("Raster: malloc(%d) failed: %s", 3 * xsize * sizeof(*rowbuf), strerror(errno));
+	    error("Raster: malloc() failed: %s", strerror(errno));
 	    return -1;
 	}
     }
 
-    memset(bitbuf, 0, xsize * ysize * sizeof(*bitbuf));
+    for (i = 0; i < xsize * ysize; i++) {
+	bitbuf[i] = BC;
+    }
 
     for (row = 0; row < DROWS; row++) {
 	int y = border + (row / YRES) * rgap + row * (pixel + pgap);
@@ -182,7 +137,7 @@
 	    int a, b;
 	    for (a = 0; a < pixel; a++)
 		for (b = 0; b < pixel; b++)
-		    bitbuf[y * xsize + x + a * xsize + b] = drv_IMG_FB[row * DCOLS + col] + 1;
+		    bitbuf[y * xsize + x + a * xsize + b] = drv_IMG_FB[row * DCOLS + col];
 	}
     }
 
@@ -206,25 +161,13 @@
 	return -1;
     }
 
-    R[0] = 0xff & bg_col >> 16;
-    G[0] = 0xff & bg_col >> 8;
-    B[0] = 0xff & bg_col;
-
-    R[1] = 0xff & hg_col >> 16;
-    G[1] = 0xff & hg_col >> 8;
-    B[1] = 0xff & hg_col;
-
-    R[2] = 0xff & fg_col >> 16;
-    G[2] = 0xff & fg_col >> 8;
-    B[2] = 0xff & fg_col;
-
     for (row = 0; row < ysize; row++) {
 	int c = 0;
 	for (col = 0; col < xsize; col++) {
-	    int i = bitbuf[row * xsize + col];
-	    rowbuf[c++] = R[i];
-	    rowbuf[c++] = G[i];
-	    rowbuf[c++] = B[i];
+	    RGBA p = bitbuf[row * xsize + col];
+	    rowbuf[c++] = p.R;
+	    rowbuf[c++] = p.G;
+	    rowbuf[c++] = p.B;
 	}
 	if (write(fd, rowbuf, c) < 0) {
 	    error("%s: write(%s) failed: %s", Name, tmp, strerror(errno));
@@ -254,27 +197,20 @@
     FILE *fp;
     int fd;
     gdImagePtr im;
-    int bg, hg, fg;
 
     xsize = 2 * border + (DCOLS / XRES - 1) * cgap + DCOLS * pixel + (DCOLS - 1) * pgap;
     ysize = 2 * border + (DROWS / YRES - 1) * rgap + DROWS * pixel + (DROWS - 1) * pgap;
 
-    im = gdImageCreate(xsize, ysize);
-
-    /* first color = background */
-    bg = gdImageColorAllocate(im, 0xff & bg_col >> 16, 0xff & bg_col >> 8, 0xff & bg_col);
-
-    hg = gdImageColorAllocate(im, 0xff & hg_col >> 16, 0xff & hg_col >> 8, 0xff & hg_col);
-
-
-    fg = gdImageColorAllocate(im, 0xff & fg_col >> 16, 0xff & fg_col >> 8, 0xff & fg_col);
-
+    im = gdImageCreateTrueColor(xsize, ysize);
+    gdImageFilledRectangle(im, 0, 0, xsize, ysize, gdTrueColor(BC.R, BC.G, BC.B));
 
     for (row = 0; row < DROWS; row++) {
 	int y = border + (row / YRES) * rgap + row * (pixel + pgap);
 	for (col = 0; col < DCOLS; col++) {
 	    int x = border + (col / XRES) * cgap + col * (pixel + pgap);
-	    gdImageFilledRectangle(im, x, y, x + pixel - 1, y + pixel - 1, drv_IMG_FB[row * DCOLS + col] ? fg : hg);
+	    RGBA p = drv_IMG_FB[row * DCOLS + col];
+	    int c = gdTrueColor(p.R, p.G, p.B);
+	    gdImageFilledRectangle(im, x, y, x + pixel - 1, y + pixel - 1, c);
 	}
     }
 
@@ -330,15 +266,15 @@
 	drv_IMG_flush_PNG();
 #endif
 	break;
+    default:
+	break;
     }
 }
 
 
-static void drv_IMG_timer(void *notused)
+static void drv_IMG_timer( __attribute__ ((unused))
+			  void *notused)
 {
-    /* avoid compiler warning */
-    notused = notused;
-
     if (dirty) {
 	drv_IMG_flush();
 	dirty = 0;
@@ -350,11 +286,12 @@
 {
     int r, c;
 
-    for (r = row; r < row + height && r < DROWS; r++) {
-	for (c = col; c < col + width && c < DCOLS; c++) {
-	    unsigned char p = drv_generic_graphic_FB[r * LCOLS + c];
-	    if (drv_IMG_FB[r * DCOLS + c] != p) {
-		drv_IMG_FB[r * DCOLS + c] = p;
+    for (r = row; r < row + height; r++) {
+	for (c = col; c < col + width; c++) {
+	    RGBA p1 = drv_IMG_FB[r * DCOLS + c];
+	    RGBA p2 = drv_generic_graphic_rgb(r, c);
+	    if (p1.R != p2.R || p1.G != p2.G || p1.B != p2.B) {
+		drv_IMG_FB[r * DCOLS + c] = p2;
 		dirty = 1;
 	    }
 	}
@@ -364,6 +301,7 @@
 
 static int drv_IMG_start(const char *section)
 {
+    int i;
     char *s;
 
     if (output == NULL || *output == '\0') {
@@ -379,11 +317,21 @@
 	return -1;
     }
 
+    Format = NIL;
+
+#ifdef WITH_PPM
     if (strcmp(s, "PPM") == 0) {
 	Format = PPM;
-    } else if (strcmp(s, "PNG") == 0) {
+    }
+#endif
+
+#ifdef WITH_PNG
+    if (strcmp(s, "PNG") == 0) {
 	Format = PNG;
-    } else {
+    }
+#endif
+
+    if (Format == NIL) {
 	error("%s: bad %s.Format '%s' from %s", Name, section, s, cfg_source());
 	free(s);
 	return -1;
@@ -427,35 +375,21 @@
     if (cfg_number(section, "border", 0, 0, -1, &border) < 0)
 	return -1;
 
-    if (sscanf(s = cfg_get(NULL, "foreground", "#102000"), "#%x", &fg_col) != 1) {
-	error("%s: bad %s.foreground color '%s' from %s", Name, section, s, cfg_source());
-	free(s);
-	return -1;
+    s = cfg_get(section, "basecolor", "000000ff");
+    if (color2RGBA(s, &BC) < 0) {
+	error("%s: ignoring illegal color '%s'", Name, s);
     }
     free(s);
 
-    if (sscanf(s = cfg_get(NULL, "halfground", "#70c000"), "#%x", &hg_col) != 1) {
-	error("%s: bad %s.halfground color '%s' from %s", Name, section, s, cfg_source());
-	free(s);
-	return -1;
-    }
-    free(s);
-
-    if (sscanf(s = cfg_get(NULL, "background", "#80d000"), "#%x", &bg_col) != 1) {
-	error("%s: bad %s.background color '%s' from %s", Name, section, s, cfg_source());
-	free(s);
-	return -1;
-    }
-    free(s);
-
-    drv_IMG_FB = malloc(DCOLS * DROWS);
+    drv_IMG_FB = malloc(DCOLS * DROWS * sizeof(*drv_IMG_FB));
     if (drv_IMG_FB == NULL) {
 	error("%s: framebuffer could not be allocated: malloc() failed", Name);
 	return -1;
     }
 
-    memset(drv_IMG_FB, 0, DCOLS * DROWS * sizeof(*drv_IMG_FB));
-
+    for (i = 0; i < DCOLS * DROWS; i++) {
+	drv_IMG_FB[i] = BC;
+    }
 
     dimx = DCOLS * pixel + (DCOLS - 1) * pgap + (DCOLS / XRES - 1) * cgap;
     dimy = DROWS * pixel + (DROWS - 1) * pgap + (DROWS / YRES - 1) * rgap;
@@ -482,16 +416,6 @@
 
 
 /****************************************/
-/***        widget callbacks          ***/
-/****************************************/
-
-
-/* using drv_generic_graphic_draw(W) */
-/* using drv_generic_graphic_icon_draw(W) */
-/* using drv_generic_graphic_bar_draw(W) */
-
-
-/****************************************/
 /***        exported functions        ***/
 /****************************************/
 
@@ -499,7 +423,12 @@
 /* list models */
 int drv_IMG_list(void)
 {
-    printf("PPM PNG");
+#ifdef WITH_PPM
+    printf("PPM ");
+#endif
+#ifdef WITH_PNG
+    printf("PNG ");
+#endif
     return 0;
 }
 
@@ -508,9 +437,10 @@
 int drv_IMG_init(const char *section, const __attribute__ ((unused))
 		 int quiet)
 {
-    WIDGET_CLASS wc;
     int ret;
 
+    info("%s: %s", Name, "$Rev: 840 $");
+
     /* real worker functions */
     drv_generic_graphic_real_blit = drv_IMG_blit;
 
@@ -522,21 +452,6 @@
     if ((ret = drv_generic_graphic_init(section, Name)) != 0)
 	return ret;
 
-    /* register text widget */
-    wc = Widget_Text;
-    wc.draw = drv_generic_graphic_draw;
-    widget_register(&wc);
-
-    /* register icon widget */
-    wc = Widget_Icon;
-    wc.draw = drv_generic_graphic_icon_draw;
-    widget_register(&wc);
-
-    /* register bar widget */
-    wc = Widget_Bar;
-    wc.draw = drv_generic_graphic_bar_draw;
-    widget_register(&wc);
-
     /* register plugins */
     /* none at the moment... */
 
@@ -563,8 +478,8 @@
 
 
 DRIVER drv_Image = {
-  name:Name,
-  list:drv_IMG_list,
-  init:drv_IMG_init,
-  quit:drv_IMG_quit,
+    .name = Name,
+    .list = drv_IMG_list,
+    .init = drv_IMG_init,
+    .quit = drv_IMG_quit,
 };
diff -urN lcd4linux-0.10.0/drv_IRLCD.c lcd4linux-0.11.0-SVN/drv_IRLCD.c
--- lcd4linux-0.10.0/drv_IRLCD.c	1970-01-01 01:00:00.000000000 +0100
+++ lcd4linux-0.11.0-SVN/drv_IRLCD.c	2008-12-31 08:06:27.000000000 +0100
@@ -0,0 +1,406 @@
+/* $Id: drv_IRLCD.c 899 2008-10-07 19:32:42Z bwalle $
+ * $URL: https://ssl.bulix.org/svn/lcd4linux/trunk/drv_IRLCD.c $
+ *
+ **************************************************************************
+ * Driver for IRLCD : simple USB1.1 LCD + IR Receiver based on ATtiny2313 *
+ **************************************************************************
+ * Hardware from http://www.xs4all.nl/~dicks/avr/usbtiny/index.html :     *
+ *        [USBtiny LIRC compatible IR receiver and LCD controller]        *
+ * Ths driver is based on LCD2USB software by Till Harbaum, adapted to    *
+ * USBTiny protocol by Jean-Philippe Civade                               *
+ **************************************************************************
+ *
+ * The IR receiving par is compatible with IgrPlug protocol
+ * and can be used from LIRC.
+ *
+ * Copyright (C) 2008 Jean-Philippe Civade <jp@civade.com> (for porting to IRLCD)
+ * Copyright (C) 2005 Till Harbaum <till@harbaum.org> (for LCD2USB friver)
+ * Copyright (C) 2005, 2006, 2007, 2008 The LCD4Linux Team <lcd4linux-devel@users.sourceforge.net>
+ *
+ * This file is part of LCD4Linux.
+ *
+ * LCD4Linux is free software; you can redistribute it and/or modify
+ * it under the terms of the GNU General Public License as published by
+ * the Free Software Foundation; either version 2, or (at your option)
+ * any later version.
+ *
+ * LCD4Linux is distributed in the hope that it will be useful,
+ * but WITHOUT ANY WARRANTY; without even the implied warranty of
+ * MERCHANTABILITY or FITNESS FOR A PARTICULAR PURPOSE.  See the
+ * GNU General Public License for more details.
+ *
+ * You should have received a copy of the GNU General Public License
+ * along with this program; if not, write to the Free Software
+ * Foundation, Inc., 675 Mass Ave, Cambridge, MA 02139, USA.
+ *
+ */
+
+/* 
+ *
+ * exported fuctions:
+ *
+ * struct DRIVER drv_IRLCD
+ *
+ */
+
+#include "config.h"
+
+#include <stdlib.h>
+#include <stdio.h>
+#include <unistd.h>
+#include <string.h>
+#include <errno.h>
+#include <termios.h>
+#include <fcntl.h>
+#include <ctype.h>
+#include <sys/ioctl.h>
+#include <sys/time.h>
+
+#include <usb.h>
+
+#include "debug.h"
+#include "cfg.h"
+#include "qprintf.h"
+#include "udelay.h"
+#include "plugin.h"
+#include "widget.h"
+#include "widget_text.h"
+#include "widget_icon.h"
+#include "widget_bar.h"
+#include "drv.h"
+
+#include "drv_generic_text.h"
+
+/* vid/pid of IRLCD */
+#define LCD_USB_VENDOR 0x03EB	/* for Atmel device */
+#define LCD_USB_DEVICE 0x0002
+
+/* Protocole IR/LCD */
+#define LCD_INSTR      20
+#define LCD_DATA       21
+
+static char Name[] = "IRLCD";
+static char *device_id = NULL, *bus_id = NULL;
+
+static usb_dev_handle *lcd;
+
+extern int got_signal;
+
+/****************************************/
+/***  hardware dependant functions    ***/
+/****************************************/
+
+static int drv_IRLCD_open(char *bus_id, char *device_id)
+{
+    struct usb_bus *busses, *bus;
+    struct usb_device *dev;
+
+    lcd = NULL;
+
+    info("%s: scanning USB for IRLCD interface ...", Name);
+
+    if (bus_id != NULL)
+	info("%s: scanning for bus id: %s", Name, bus_id);
+
+    if (device_id != NULL)
+	info("%s: scanning for device id: %s", Name, device_id);
+
+    usb_set_debug(0);
+
+    usb_init();
+    usb_find_busses();
+    usb_find_devices();
+    busses = usb_get_busses();
+
+    for (bus = busses; bus; bus = bus->next) {
+	/* search this bus if no bus id was given or if this is the given bus id */
+	if (!bus_id || (bus_id && !strcasecmp(bus->dirname, bus_id))) {
+
+	    for (dev = bus->devices; dev; dev = dev->next) {
+		/* search this device if no device id was given or if this is the given device id */
+		if (!device_id || (device_id && !strcasecmp(dev->filename, device_id))) {
+
+		    if ((dev->descriptor.idVendor == LCD_USB_VENDOR) && (dev->descriptor.idProduct == LCD_USB_DEVICE)) {
+			info("%s: found IRLCD interface on bus %s device %s", Name, bus->dirname, dev->filename);
+			lcd = usb_open(dev);
+			if (usb_claim_interface(lcd, 0) < 0) {
+			    error("%s: usb_claim_interface() failed!", Name);
+			    return -1;
+			}
+			return 0;
+		    }
+		}
+	    }
+	}
+    }
+    return -1;
+}
+
+
+static int drv_IRLCD_close(void)
+{
+    usb_release_interface(lcd, 0);
+    usb_close(lcd);
+
+    return 0;
+}
+
+
+/* Send a buffer to lcd via a control message */
+static int drv_IRLCD_send(int request, unsigned char *buffer, int size)
+{
+    if (usb_control_msg(lcd, USB_TYPE_VENDOR | USB_RECIP_DEVICE | USB_ENDPOINT_OUT,	/* bRequestType */
+			request,	/* bRequest (LCD_INSTR / LCD_DATA) */
+			0,	/* wValue (0) */
+			0,	/* wIndex (0) */
+			(char *) buffer,	/* pointer to destination buffer */
+			size,	/* wLength */
+			1000) < 0) {	/* Timeout in millisectonds */
+	error("%s: USB request failed! Trying to reconnect device.", Name);
+
+	usb_release_interface(lcd, 0);
+	usb_close(lcd);
+
+	/* try to close and reopen connection */
+	if (drv_IRLCD_open(bus_id, device_id) < 0) {
+	    error("%s: could not re-detect IRLCD USB LCD", Name);
+	    got_signal = -1;
+	    return -1;
+	}
+	/* and try to re-send command */
+	if (usb_control_msg(lcd, USB_TYPE_VENDOR | USB_RECIP_DEVICE | USB_ENDPOINT_OUT,	/* bRequestType  */
+			    request,	/* bRequest (LCD_INSTR / LCD_DATA) */
+			    0,	/* wValue (0) */
+			    0,	/* wIndex (0) */
+			    (char *) buffer,	/* pointer to destination buffer */
+			    size,	/* wLength */
+			    1000) < 0) {	/* Timeout in millisectonds */
+	    error("%s: retried USB request failed, aborting!", Name);
+	    got_signal = -1;
+	    return -1;
+	}
+
+	info("%s: Device successfully reconnected.", Name);
+    }
+
+    return 0;
+}
+
+
+/* text mode displays only */
+static void drv_IRLCD_clear(void)
+{
+    unsigned char cmd[1];
+
+    cmd[0] = 0x01;		/* clear */
+    drv_IRLCD_send(LCD_INSTR, cmd, 1);
+    cmd[0] = 0x03;		/* home */
+    drv_IRLCD_send(LCD_INSTR, cmd, 1);
+}
+
+
+/* text mode displays only */
+static void drv_IRLCD_write(const int row, const int col, const char *data, int len)
+{
+    unsigned char cmd[1];
+    static int pos;
+
+    /* for 2 lines display */
+    pos = (row % 2) * 64 + (row / 2) * 20 + col;
+
+    /* do the cursor positioning here */
+    cmd[0] = 0x80 | pos;
+
+    /* do positionning */
+    drv_IRLCD_send(LCD_INSTR, cmd, 1);
+
+    /* send string to the display */
+    drv_IRLCD_send(LCD_DATA, (unsigned char *) data, len);
+
+}
+
+/* text mode displays only */
+static void drv_IRLCD_defchar(const int ascii, const unsigned char *matrix)
+{
+    unsigned char cmd[10];
+    int i;
+
+    /* Write to CGRAM */
+    cmd[0] = 0x40 | 8 * ascii;
+    drv_IRLCD_send(LCD_INSTR, cmd, 1);
+
+
+    /* send bitmap to the display */
+    for (i = 0; i < 8; i++) {
+	cmd[i] = matrix[i] & 0x1f;
+    }
+    drv_IRLCD_send(LCD_DATA, cmd, 8);
+}
+
+
+/* start text mode display */
+static int drv_IRLCD_start(const char *section)
+{
+    int rows = -1, cols = -1;
+    char *s;
+
+    s = cfg_get(section, "Size", NULL);
+    if (s == NULL || *s == '\0') {
+	error("%s: no '%s.Size' entry from %s", Name, section, cfg_source());
+	return -1;
+    }
+    if (sscanf(s, "%dx%d", &cols, &rows) != 2 || rows < 1 || cols < 1) {
+	error("%s: bad %s.Size '%s' from %s", Name, section, s, cfg_source());
+	free(s);
+	return -1;
+    }
+
+    DROWS = rows;
+    DCOLS = cols;
+
+    /* bus id and device id are strings and not just intergers, since */
+    /* the windows port of libusb treats them as strings. And this way */
+    /* we keep windows compatibility ... just in case ... */
+    bus_id = cfg_get(section, "Bus", NULL);
+    device_id = cfg_get(section, "Device", NULL);
+
+    if (drv_IRLCD_open(bus_id, device_id) < 0) {
+	error("%s: could not find a IRLC USB LCD", Name);
+	return -1;
+    }
+
+    /* reset & initialize display */
+    drv_IRLCD_clear();		/* clear display */
+
+    return 0;
+}
+
+
+/****************************************/
+/***            plugins               ***/
+/****************************************/
+/* no plugins capabilities */
+
+/****************************************/
+/***        widget callbacks          ***/
+/****************************************/
+/* using drv_generic_text_draw(W) */
+/* using drv_generic_text_icon_draw(W) */
+/* using drv_generic_text_bar_draw(W) */
+/* using drv_generic_gpio_draw(W) */
+
+
+/****************************************/
+/***        exported functions        ***/
+/****************************************/
+
+/* list models */
+int drv_IRLCD_list(void)
+{
+    printf("generic");
+    return 0;
+}
+
+/* initialize driver & display */
+int drv_IRLCD_init(const char *section, const int quiet)
+{
+    WIDGET_CLASS wc;
+    int asc255bug;
+    int ret;
+
+    info("%s: %s", Name, "$Rev: 899 $");
+
+    /* display preferences */
+    XRES = 5;			/* pixel width of one char  */
+    YRES = 8;			/* pixel height of one char  */
+    CHARS = 8;			/* number of user-defineable characters */
+    CHAR0 = 0;			/* ASCII of first user-defineable char */
+    GOTO_COST = 2;		/* number of bytes a goto command requires */
+
+    /* real worker functions */
+    drv_generic_text_real_write = drv_IRLCD_write;
+    drv_generic_text_real_defchar = drv_IRLCD_defchar;
+
+    /* start display */
+    if ((ret = drv_IRLCD_start(section)) != 0)
+	return ret;
+
+    if (!quiet) {
+	char buffer[40];
+	qprintf(buffer, sizeof(buffer), "%s %dx%d", Name, DCOLS, DROWS);
+	if (drv_generic_text_greet(buffer, " www.civade.com")) {
+	    sleep(3);
+	    drv_IRLCD_clear();
+	}
+    }
+
+    /* initialize generic text driver */
+    if ((ret = drv_generic_text_init(section, Name)) != 0)
+	return ret;
+
+    /* initialize generic icon driver */
+    if ((ret = drv_generic_text_icon_init()) != 0)
+	return ret;
+
+    /* initialize generic bar driver */
+    if ((ret = drv_generic_text_bar_init(0)) != 0)
+	return ret;
+
+    /* add fixed chars to the bar driver */
+    /* most displays have a full block on ascii 255, but some have kind of  */
+    /* an 'inverted P'. If you specify 'asc255bug 1 in the config, this */
+    /* char will not be used, but rendered by the bar driver */
+    cfg_number(section, "asc255bug", 0, 0, 1, &asc255bug);
+    drv_generic_text_bar_add_segment(0, 0, 255, 32);	/* ASCII  32 = blank */
+    if (!asc255bug)
+	drv_generic_text_bar_add_segment(255, 255, 255, 255);	/* ASCII 255 = block */
+
+    /* register text widget */
+    wc = Widget_Text;
+    wc.draw = drv_generic_text_draw;
+    widget_register(&wc);
+
+    /* register icon widget */
+    wc = Widget_Icon;
+    wc.draw = drv_generic_text_icon_draw;
+    widget_register(&wc);
+
+    /* register bar widget */
+    wc = Widget_Bar;
+    wc.draw = drv_generic_text_bar_draw;
+    widget_register(&wc);
+
+    return 0;
+}
+
+
+/* close driver & display */
+/* use this function for a text display */
+int drv_IRLCD_quit(const int quiet)
+{
+
+    info("%s: shutting down.", Name);
+
+    drv_generic_text_quit();
+
+    /* clear display */
+    drv_IRLCD_clear();
+
+    /* say goodbye... */
+    if (!quiet) {
+	drv_generic_text_greet("goodbye!", NULL);
+    }
+
+    debug("closing usb connection");
+    drv_IRLCD_close();
+
+    return (0);
+}
+
+/* use this one for a text display */
+DRIVER drv_IRLCD = {
+    .name = Name,
+    .list = drv_IRLCD_list,
+    .init = drv_IRLCD_init,
+    .quit = drv_IRLCD_quit,
+};
diff -urN lcd4linux-0.10.0/drv_LCD2USB.c lcd4linux-0.11.0-SVN/drv_LCD2USB.c
--- lcd4linux-0.10.0/drv_LCD2USB.c	1970-01-01 01:00:00.000000000 +0100
+++ lcd4linux-0.11.0-SVN/drv_LCD2USB.c	2008-12-31 08:05:54.000000000 +0100
@@ -0,0 +1,679 @@
+/* $Id: drv_LCD2USB.c 899 2008-10-07 19:32:42Z bwalle $
+ * $URL: https://ssl.bulix.org/svn/lcd4linux/trunk/drv_LCD2USB.c $
+ *
+ * driver for USB2LCD display interface
+ * see http://www.harbaum.org/till/lcd2usb for schematics
+ *
+ * Copyright 2005 Till Harbaum <till@harbaum.org>
+ * Copyright 2005 The LCD4Linux Team <lcd4linux-devel@users.sourceforge.net>
+ *
+ * This file is part of LCD4Linux.
+ *
+ * LCD4Linux is free software; you can redistribute it and/or modify
+ * it under the terms of the GNU General Public License as published by
+ * the Free Software Foundation; either version 2, or (at your option)
+ * any later version.
+ *
+ * LCD4Linux is distributed in the hope that it will be useful,
+ * but WITHOUT ANY WARRANTY; without even the implied warranty of
+ * MERCHANTABILITY or FITNESS FOR A PARTICULAR PURPOSE.  See the
+ * GNU General Public License for more details.
+ *
+ * You should have received a copy of the GNU General Public License
+ * along with this program; if not, write to the Free Software
+ * Foundation, Inc., 675 Mass Ave, Cambridge, MA 02139, USA.
+ *
+ */
+
+/* 
+ *
+ * exported fuctions:
+ *
+ * struct DRIVER drv_LCD2USB
+ *
+ */
+
+#include "config.h"
+
+#include <stdlib.h>
+#include <stdio.h>
+#include <string.h>
+#include <errno.h>
+#include <unistd.h>
+#include <termios.h>
+#include <fcntl.h>
+#include <ctype.h>
+#include <sys/ioctl.h>
+#include <sys/time.h>
+
+#include <usb.h>
+
+#include "debug.h"
+#include "cfg.h"
+#include "timer.h"
+#include "qprintf.h"
+#include "plugin.h"
+#include "widget.h"
+#include "widget_text.h"
+#include "widget_icon.h"
+#include "widget_bar.h"
+#include "widget_keypad.h"
+#include "drv.h"
+#include "drv_generic_text.h"
+#include "drv_generic_keypad.h"
+
+/* vid/pid donated by FTDI */
+#define LCD_USB_VENDOR 0x0403
+#define LCD_USB_DEVICE 0xC630
+
+/* number of buttons on display */
+#define L2U_BUTTONS        (2)
+
+#define LCD_ECHO           (0<<5)
+#define LCD_CMD            (1<<5)
+#define LCD_DATA           (2<<5)
+#define LCD_SET            (3<<5)
+#define LCD_GET            (4<<5)
+
+/* target is a bit map for CMD/DATA */
+#define LCD_CTRL_0              (1<<3)
+#define LCD_CTRL_1              (1<<4)
+#define LCD_BOTH           (LCD_CTRL_0 | LCD_CTRL_1)
+
+/* target is value to set */
+#define LCD_SET_CONTRAST   (LCD_SET | (0<<3))
+#define LCD_SET_BRIGHTNESS (LCD_SET | (1<<3))
+#define LCD_SET_RESERVED0  (LCD_SET | (2<<3))
+#define LCD_SET_RESERVED1  (LCD_SET | (3<<3))
+
+/* target is value to get */
+#define LCD_GET_FWVER      (LCD_GET | (0<<3))
+#define LCD_GET_BUTTONS    (LCD_GET | (1<<3))
+#define LCD_GET_CTRL       (LCD_GET | (2<<3))
+#define LCD_GET_RESERVED1  (LCD_GET | (3<<3))
+
+static char Name[] = "LCD2USB";
+static char *device_id = NULL, *bus_id = NULL;
+
+static usb_dev_handle *lcd;
+static int controllers = 0;
+
+extern int got_signal;
+
+/****************************************/
+/***  hardware dependant functions    ***/
+/****************************************/
+
+static int drv_L2U_open(char *bus_id, char *device_id)
+{
+    struct usb_bus *busses, *bus;
+    struct usb_device *dev;
+
+    lcd = NULL;
+
+    info("%s: scanning USB for LCD2USB interface ...", Name);
+
+    if (bus_id != NULL)
+	info("%s: scanning for bus id: %s", Name, bus_id);
+
+    if (device_id != NULL)
+	info("%s: scanning for device id: %s", Name, device_id);
+
+    usb_set_debug(0);
+
+    usb_init();
+    usb_find_busses();
+    usb_find_devices();
+    busses = usb_get_busses();
+
+    for (bus = busses; bus; bus = bus->next) {
+	/* search this bus if no bus id was given or if this is the given bus id */
+	if (!bus_id || (bus_id && !strcasecmp(bus->dirname, bus_id))) {
+
+	    for (dev = bus->devices; dev; dev = dev->next) {
+		/* search this device if no device id was given or if this is the given device id */
+		if (!device_id || (device_id && !strcasecmp(dev->filename, device_id))) {
+
+		    if ((dev->descriptor.idVendor == LCD_USB_VENDOR) && (dev->descriptor.idProduct == LCD_USB_DEVICE)) {
+			info("%s: found LCD2USB interface on bus %s device %s", Name, bus->dirname, dev->filename);
+			lcd = usb_open(dev);
+			if (usb_claim_interface(lcd, 0) < 0) {
+			    error("%s: usb_claim_interface() failed!", Name);
+			    return -1;
+			}
+			return 0;
+		    }
+		}
+	    }
+	}
+    }
+    return -1;
+}
+
+
+static int drv_L2U_close(void)
+{
+    usb_release_interface(lcd, 0);
+    usb_close(lcd);
+
+    return 0;
+}
+
+
+static int drv_L2U_send(int request, int value, int index)
+{
+    if (usb_control_msg(lcd, USB_TYPE_VENDOR, request, value, index, NULL, 0, 1000) < 0) {
+	error("%s: USB request failed! Trying to reconnect device.", Name);
+
+	usb_release_interface(lcd, 0);
+	usb_close(lcd);
+
+	/* try to close and reopen connection */
+	if (drv_L2U_open(bus_id, device_id) < 0) {
+	    error("%s: could not re-detect LCD2USB USB LCD", Name);
+	    got_signal = -1;
+	    return -1;
+	}
+	/* and try to re-send command */
+	if (usb_control_msg(lcd, USB_TYPE_VENDOR, request, value, index, NULL, 0, 1000) < 0) {
+	    error("%s: retried USB request failed, aborting!", Name);
+	    got_signal = -1;
+	    return -1;
+	}
+
+	info("%s: Device successfully reconnected.", Name);
+    }
+
+    return 0;
+}
+
+/* send a number of 16 bit words to the lcd2usb interface */
+/* and verify that they are correctly returned by the echo */
+/* command. This may be used to check the reliability of */
+/* the usb interfacing */
+#define ECHO_NUM 100
+
+int drv_L2U_echo(void)
+{
+    int i, nBytes, errors = 0;
+    unsigned short val, ret;
+
+    for (i = 0; i < ECHO_NUM; i++) {
+	val = rand() & 0xffff;
+
+	nBytes = usb_control_msg(lcd,
+				 USB_TYPE_VENDOR | USB_RECIP_DEVICE | USB_ENDPOINT_IN,
+				 LCD_ECHO, val, 0, (char *) &ret, sizeof(ret), 1000);
+
+	if (nBytes < 0) {
+	    error("%s: USB request failed!", Name);
+	    return -1;
+	}
+
+	if (val != ret)
+	    errors++;
+    }
+
+    if (errors) {
+	error("%s: ERROR, %d out of %d echo transfers failed!", Name, errors, ECHO_NUM);
+	return -1;
+    } else
+	info("%s: echo test successful", Name);
+
+    return 0;
+}
+
+/* get a value from the lcd2usb interface */
+static int drv_L2U_get(unsigned char cmd)
+{
+    unsigned char buffer[2];
+    int nBytes;
+
+    /* send control request and accept return value */
+    nBytes = usb_control_msg(lcd,
+			     USB_TYPE_VENDOR | USB_RECIP_DEVICE | USB_ENDPOINT_IN,
+			     cmd, 0, 0, (char *) buffer, sizeof(buffer), 1000);
+
+    if (nBytes < 0) {
+	error("%s: USB request failed!", Name);
+	return -1;
+    }
+
+    return buffer[0] + 256 * buffer[1];
+}
+
+/* get lcd2usb interface firmware version */
+static void drv_L2U_get_version(void)
+{
+    int ver = drv_L2U_get(LCD_GET_FWVER);
+
+    if (ver != -1)
+	info("%s: firmware version %d.%02d", Name, ver & 0xff, ver >> 8);
+    else
+	error("%s: unable to read firmware version", Name);
+}
+
+/* get the bit mask of installed LCD controllers (0 = no */
+/* lcd found, 1 = single controller display, 3 = dual */
+/* controller display */
+static void drv_L2U_get_controllers(void)
+{
+    controllers = drv_L2U_get(LCD_GET_CTRL);
+
+    if (controllers != -1) {
+	if (controllers)
+	    info("%s: installed controllers: %s%s", Name,
+		 (controllers & 1) ? "CTRL0" : "", (controllers & 2) ? " CTRL1" : "");
+	else
+	    error("%s: no controllers found", Name);
+    } else {
+	error("%s: unable to read installed controllers", Name);
+	controllers = 0;	/* don't access any controllers */
+    }
+
+    /* convert into controller map matching our protocol */
+    controllers = ((controllers & 1) ? LCD_CTRL_0 : 0) | ((controllers & 2) ? LCD_CTRL_1 : 0);
+}
+
+/* get state of the two optional buttons */
+static unsigned long drv_L2U_get_buttons(void)
+{
+    int buttons = drv_L2U_get(LCD_GET_BUTTONS);
+
+    if (buttons == -1) {
+	error("%s: unable to read button state", Name);
+	buttons = 0;
+    }
+
+    return buttons;
+}
+
+
+/* to increase performance, a little buffer is being used to */
+/* collect command bytes of the same type before transmitting them */
+#define BUFFER_MAX_CMD 4	/* current protocol supports up to 4 bytes */
+int buffer_current_type = -1;	/* nothing in buffer yet */
+int buffer_current_fill = 0;	/* -"- */
+unsigned char buffer[BUFFER_MAX_CMD];
+
+/* command format: 
+ * 7 6 5 4 3 2 1 0
+ * C C C T T R L L
+ *
+ * TT = target bit map 
+ * R = reserved for future use, set to 0
+ * LL = number of bytes in transfer - 1 
+ */
+
+/* flush command queue due to buffer overflow / content */
+/* change or due to explicit request */
+static void drv_L2U_flush(void)
+{
+    int request, value, index;
+
+    /* anything to flush? ignore request if not */
+    if (buffer_current_type == -1)
+	return;
+
+    /* build request byte */
+    request = buffer_current_type | (buffer_current_fill - 1);
+
+    /* fill value and index with buffer contents. endianess should IMHO not */
+    /* be a problem, since usb_control_msg() will handle this. */
+    value = buffer[0] | (buffer[1] << 8);
+    index = buffer[2] | (buffer[3] << 8);
+
+    if (controllers) {
+	/* send current buffer contents */
+	drv_L2U_send(request, value, index);
+    }
+
+    /* buffer is now free again */
+    buffer_current_type = -1;
+    buffer_current_fill = 0;
+}
+
+/* enqueue a command into the buffer */
+static void drv_L2U_enqueue(int command_type, int value)
+{
+    if ((buffer_current_type >= 0) && (buffer_current_type != command_type))
+	drv_L2U_flush();
+
+    /* add new item to buffer */
+    buffer_current_type = command_type;
+    buffer[buffer_current_fill++] = value;
+
+    /* flush buffer if it's full */
+    if (buffer_current_fill == BUFFER_MAX_CMD)
+	drv_L2U_flush();
+}
+
+static void drv_L2U_command(const unsigned char ctrl, const unsigned char cmd)
+{
+    drv_L2U_enqueue(LCD_CMD | (ctrl & controllers), cmd);
+}
+
+
+static void drv_L2U_clear(void)
+{
+    drv_L2U_command(LCD_BOTH, 0x01);	/* clear display */
+    drv_L2U_command(LCD_BOTH, 0x03);	/* return home */
+}
+
+static void drv_L2U_write(int row, const int col, const char *data, int len)
+{
+    int pos, ctrl = LCD_CTRL_0;
+
+    /* displays with more two rows and 20 columns have a logical width */
+    /* of 40 chars and use more than one controller */
+    if ((DROWS > 2) && (DCOLS > 20) && (row > 1)) {
+	/* use second controller */
+	row -= 2;
+	ctrl = LCD_CTRL_1;
+    }
+
+    /* 16x4 Displays use a slightly different layout */
+    if (DCOLS == 16 && DROWS == 4) {
+	pos = (row % 2) * 64 + (row / 2) * 16 + col;
+    } else {
+	pos = (row % 2) * 64 + (row / 2) * 20 + col;
+    }
+
+    drv_L2U_command(ctrl, 0x80 | pos);
+
+    while (len--) {
+	drv_L2U_enqueue(LCD_DATA | (ctrl & controllers), *data++);
+    }
+
+    drv_L2U_flush();
+}
+
+static void drv_L2U_defchar(const int ascii, const unsigned char *matrix)
+{
+    int i;
+
+    drv_L2U_command(LCD_BOTH, 0x40 | 8 * ascii);
+
+    for (i = 0; i < 8; i++) {
+	drv_L2U_enqueue(LCD_DATA | (LCD_BOTH & controllers), *matrix++ & 0x1f);
+    }
+
+    drv_L2U_flush();
+}
+
+static int drv_L2U_contrast(int contrast)
+{
+    if (contrast < 0)
+	contrast = 0;
+    if (contrast > 255)
+	contrast = 255;
+
+    drv_L2U_send(LCD_SET_CONTRAST, contrast, 0);
+
+    return contrast;
+}
+
+static int drv_L2U_brightness(int brightness)
+{
+    if (brightness < 0)
+	brightness = 0;
+    if (brightness > 255)
+	brightness = 255;
+
+    drv_L2U_send(LCD_SET_BRIGHTNESS, brightness, 0);
+
+    return brightness;
+}
+
+static void drv_L2U_timer(void __attribute__ ((unused)) * notused)
+{
+    static unsigned long last_but = 0;
+    unsigned long new_but = drv_L2U_get_buttons();
+    int i;
+
+    /* check if button state changed */
+    if (new_but ^ last_but) {
+
+	/* send single keypad events for all changed buttons */
+	for (i = 0; i < L2U_BUTTONS; i++)
+	    if ((new_but & (1 << i)) ^ (last_but & (1 << i)))
+		drv_generic_keypad_press(((new_but & (1 << i)) ? 0x80 : 0) | i);
+    }
+
+    last_but = new_but;
+}
+
+static int drv_L2U_keypad(const int num)
+{
+    int val = 0;
+
+    /* check for key press event */
+    if (num & 0x80)
+	val = WIDGET_KEY_PRESSED;
+    else
+	val = WIDGET_KEY_RELEASED;
+
+    if ((num & 0x7f) == 0)
+	val += WIDGET_KEY_UP;
+
+    if ((num & 0x7f) == 1)
+	val += WIDGET_KEY_DOWN;
+
+    return val;
+}
+
+static int drv_L2U_start(const char *section, const int quiet)
+{
+    int contrast, brightness;
+    int rows = -1, cols = -1;
+    char *s;
+
+    s = cfg_get(section, "Size", NULL);
+    if (s == NULL || *s == '\0') {
+	error("%s: no '%s.Size' entry from %s", Name, section, cfg_source());
+	return -1;
+    }
+    if (sscanf(s, "%dx%d", &cols, &rows) != 2 || rows < 1 || cols < 1) {
+	error("%s: bad %s.Size '%s' from %s", Name, section, s, cfg_source());
+	free(s);
+	return -1;
+    }
+
+    DROWS = rows;
+    DCOLS = cols;
+
+    /* bus id and device id are strings and not just intergers, since */
+    /* the windows port of libusb treats them as strings. And this way */
+    /* we keep windows compatibility ... just in case ... */
+    bus_id = cfg_get(section, "Bus", NULL);
+    device_id = cfg_get(section, "Device", NULL);
+
+    if (drv_L2U_open(bus_id, device_id) < 0) {
+	error("%s: could not find a LCD2USB USB LCD", Name);
+	return -1;
+    }
+
+    /* test interface reliability */
+    drv_L2U_echo();
+
+    /* get some infos from the interface */
+    drv_L2U_get_version();
+    drv_L2U_get_controllers();
+    if (!controllers)
+	return -1;
+
+    /* regularly request key state */
+    /* Fixme: make 100msec configurable */
+    timer_add(drv_L2U_timer, NULL, 100, 0);
+
+    if (cfg_number(section, "Contrast", 0, 0, 255, &contrast) > 0) {
+	drv_L2U_contrast(contrast);
+    }
+
+    if (cfg_number(section, "Brightness", 0, 0, 255, &brightness) > 0) {
+	drv_L2U_brightness(brightness);
+    }
+
+    drv_L2U_clear();		/* clear display */
+
+    if (!quiet) {
+	char buffer[40];
+	qprintf(buffer, sizeof(buffer), "%s %dx%d", Name, DCOLS, DROWS);
+	if (drv_generic_text_greet(buffer, "www.harbaum.org/till")) {
+	    sleep(3);
+	    drv_L2U_clear();
+	}
+    }
+
+    return 0;
+}
+
+
+/****************************************/
+/***            plugins               ***/
+/****************************************/
+
+static void plugin_contrast(RESULT * result, RESULT * arg1)
+{
+    double contrast;
+
+    contrast = drv_L2U_contrast(R2N(arg1));
+    SetResult(&result, R_NUMBER, &contrast);
+}
+
+
+static void plugin_brightness(RESULT * result, RESULT * arg1)
+{
+    double brightness;
+
+    brightness = drv_L2U_brightness(R2N(arg1));
+    SetResult(&result, R_NUMBER, &brightness);
+}
+
+
+/****************************************/
+/***        widget callbacks          ***/
+/****************************************/
+
+
+/* using drv_generic_text_draw(W) */
+/* using drv_generic_text_icon_draw(W) */
+/* using drv_generic_text_bar_draw(W) */
+
+
+/****************************************/
+/***        exported functions        ***/
+/****************************************/
+
+
+/* list models */
+int drv_L2U_list(void)
+{
+    printf("generic");
+    return 0;
+}
+
+
+/* initialize driver & display */
+int drv_L2U_init(const char *section, const int quiet)
+{
+    WIDGET_CLASS wc;
+    int asc255bug;
+    int ret;
+
+    info("%s: %s", Name, "$Rev: 899 $");
+
+    /* display preferences */
+    XRES = 5;			/* pixel width of one char  */
+    YRES = 8;			/* pixel height of one char  */
+    CHARS = 8;			/* number of user-defineable characters */
+    CHAR0 = 0;			/* ASCII of first user-defineable char */
+    GOTO_COST = 2;		/* number of bytes a goto command requires */
+
+    /* real worker functions */
+    drv_generic_text_real_write = drv_L2U_write;
+    drv_generic_text_real_defchar = drv_L2U_defchar;
+    drv_generic_keypad_real_press = drv_L2U_keypad;
+
+    /* start display */
+    if ((ret = drv_L2U_start(section, quiet)) != 0)
+	return ret;
+
+    /* initialize generic text driver */
+    if ((ret = drv_generic_text_init(section, Name)) != 0)
+	return ret;
+
+    /* initialize generic icon driver */
+    if ((ret = drv_generic_text_icon_init()) != 0)
+	return ret;
+
+    /* initialize generic bar driver */
+    if ((ret = drv_generic_text_bar_init(0)) != 0)
+	return ret;
+
+    /* add fixed chars to the bar driver */
+    /* most displays have a full block on ascii 255, but some have kind of  */
+    /* an 'inverted P'. If you specify 'asc255bug 1 in the config, this */
+    /* char will not be used, but rendered by the bar driver */
+    cfg_number(section, "asc255bug", 0, 0, 1, &asc255bug);
+    drv_generic_text_bar_add_segment(0, 0, 255, 32);	/* ASCII  32 = blank */
+    if (!asc255bug)
+	drv_generic_text_bar_add_segment(255, 255, 255, 255);	/* ASCII 255 = block */
+
+    /* initialize generic key pad driver */
+    if ((ret = drv_generic_keypad_init(section, Name)) != 0)
+	return ret;
+
+    /* register text widget */
+    wc = Widget_Text;
+    wc.draw = drv_generic_text_draw;
+    widget_register(&wc);
+
+    /* register icon widget */
+    wc = Widget_Icon;
+    wc.draw = drv_generic_text_icon_draw;
+    widget_register(&wc);
+
+    /* register bar widget */
+    wc = Widget_Bar;
+    wc.draw = drv_generic_text_bar_draw;
+    widget_register(&wc);
+
+    /* register plugins */
+    AddFunction("LCD::contrast", 1, plugin_contrast);
+    AddFunction("LCD::brightness", 1, plugin_brightness);
+
+    return 0;
+}
+
+
+/* close driver & display */
+int drv_L2U_quit(const int quiet)
+{
+
+    info("%s: shutting down.", Name);
+
+    drv_generic_text_quit();
+    drv_generic_keypad_quit();
+
+    /* clear display */
+    drv_L2U_clear();
+
+    /* say goodbye... */
+    if (!quiet) {
+	drv_generic_text_greet("That's all, folks!", NULL);
+    }
+
+    debug("closing USB connection");
+    drv_L2U_close();
+
+    return (0);
+}
+
+
+DRIVER drv_LCD2USB = {
+    .name = Name,
+    .list = drv_L2U_list,
+    .init = drv_L2U_init,
+    .quit = drv_L2U_quit,
+};
diff -urN lcd4linux-0.10.0/drv_LCDLinux.c lcd4linux-0.11.0-SVN/drv_LCDLinux.c
--- lcd4linux-0.10.0/drv_LCDLinux.c	2005-05-08 06:32:44.000000000 +0200
+++ lcd4linux-0.11.0-SVN/drv_LCDLinux.c	2008-12-31 08:05:54.000000000 +0100
@@ -1,9 +1,10 @@
-/* $Id: drv_LCDLinux.c,v 1.8 2005/05/08 04:32:44 reinelt Exp $
+/* $Id: drv_LCDLinux.c 904 2008-12-23 13:28:14Z michael $
+ * $URL: https://ssl.bulix.org/svn/lcd4linux/trunk/drv_LCDLinux.c $
  *
  * driver for the LCD-Linux HD44780 kernel driver
  * http://lcd-linux.sourceforge.net
  *
- * Copyright (C) 2005 Michael Reinelt <reinelt@eunet.at>
+ * Copyright (C) 2005 Michael Reinelt <michael@reinelt.co.at>
  * Copyright (C) 2005 The LCD4Linux Team <lcd4linux-devel@users.sourceforge.net>
  *
  * This file is part of LCD4Linux.
@@ -22,32 +23,6 @@
  * along with this program; if not, write to the Free Software
  * Foundation, Inc., 675 Mass Ave, Cambridge, MA 02139, USA.
  *
- *
- * $Log: drv_LCDLinux.c,v $
- * Revision 1.8  2005/05/08 04:32:44  reinelt
- * CodingStyle added and applied
- *
- * Revision 1.7  2005/05/02 05:15:46  reinelt
- * make busy-flag checking configurable for LCD-Linux driver
- *
- * Revision 1.6  2005/04/30 06:02:09  reinelt
- * LCD-Linux display size set up from lcd4linux.conf
- *
- * Revision 1.5  2005/04/09 07:36:42  reinelt
- * updated LCD-Linux driver to version 0.8.8
- *
- * Revision 1.4  2005/02/24 07:06:48  reinelt
- * SimpleLCD driver added
- *
- * Revision 1.3  2005/02/24 06:51:40  reinelt
- * LCD-Linux driver GOTO_COST corrected
- *
- * Revision 1.2  2005/01/30 06:43:22  reinelt
- * driver for LCD-Linux finished
- *
- * Revision 1.1  2005/01/22 22:57:57  reinelt
- * LCD-Linux driver added
- *
  */
 
 /* 
@@ -81,8 +56,9 @@
 #include "drv.h"
 #include "drv_generic_text.h"
 
-#include "drv_LCDLinux.h"
-
+#define LCD_LINUX_MAIN
+#include <linux/lcd-linux.h>
+#include <linux/hd44780.h>
 
 static char Name[] = "LCD-Linux";
 static char Device[] = "/dev/lcd";
@@ -118,8 +94,8 @@
 
 static void drv_LL_clear(void)
 {
-    /* Fixme: is there no otherway to clear the display? */
-    drv_LL_send("\14", 1);	/* Form Feed */
+    /* No return value check since this ioctl cannot fail */
+    ioctl(lcdlinux_fd, LCDL_CLEAR_DISP);
 }
 
 
@@ -136,20 +112,17 @@
 
 static void drv_LL_defchar(const int ascii, const unsigned char *matrix)
 {
-    char buffer[8];
-    int pos = 1024 + ascii;
+    char buf[9];
     int i;
 
-    for (i = 0; i < 8; i++) {
-	buffer[i] = *matrix++ & 0x1f;
+    buf[0] = ascii;
+    for (i = 1; i < 9; i++) {
+	buf[i] = *matrix++ & 0x1f;
     }
 
-    if (lseek(lcdlinux_fd, pos, SEEK_SET) == (off_t) - 1) {
-	error("%s: lseek(%s) failed: %s", Name, Device, strerror(errno));
+    if (ioctl(lcdlinux_fd, LCDL_SET_CGRAM_CHAR, &buf) != 0) {
+	error("%s: ioctl(LCDL_SET_CGRAM_CHAR) failed: %s", Name, strerror(errno));
     }
-
-    drv_LL_send(buffer, 8);
-
 }
 
 
@@ -157,8 +130,8 @@
 {
     char *s;
     int rows = -1, cols = -1;
-    int use_busy = 0;
-    struct lcd_driver buf;
+    int use_busy = 0, bus4bits = 0, commit = 0;
+    struct lcd_parameters buf;
 
     /* emit version information */
     info("%s: Version %s", Name, LCD_LINUX_VERSION);
@@ -183,59 +156,71 @@
 
     /* get display size */
     memset(&buf, 0, sizeof(buf));
-    if (ioctl(lcdlinux_fd, IOCTL_GET_PARAM, &buf) != 0) {
-	error("%s: ioctl(IOCTL_GET_PARAM) failed: %s", Name, strerror(errno));
+    if (ioctl(lcdlinux_fd, LCDL_GET_PARAM, &buf) != 0) {
+	error("%s: ioctl(LCDL_GET_PARAM) failed: %s", Name, strerror(errno));
 	error("%s: Could not query display information!", Name);
 	return -1;
     }
-    info("%s: %dx%d display at 0x%x, %d controllers, flags=0x%02x:", Name, buf.disp_cols, buf.cntr_rows, buf.io, buf.num_cntr, buf.flags);
-
-    info("%s:   /proc support %sabled", Name, buf.flags & LCD_PROC_ON ? "en" : "dis");
-    info("%s:   tty support %sabled", Name, buf.flags & LCD_ETTY_ON ? "en" : "dis");
-    info("%s:   console support %sabled", Name, buf.flags & LCD_CONSOLE ? "en" : "dis");
-    info("%s:   bus width %d bits", Name, buf.flags & LCD_4BITS_BUS ? 4 : 8);
-    info("%s:   font size %s", Name, buf.flags & LCD_5X10_FONT ? "5x10" : "5x8");
-    info("%s:   busy-flag checking %sabled", Name, buf.flags & LCD_CHECK_BF ? "en" : "dis");
-
+    info("%s: %dx%d display with %d controllers, flags=0x%02lx:",
+	 Name, buf.cntr_cols, buf.cntr_rows * buf.num_cntr, buf.num_cntr, buf.flags);
+    info("%s:   busy-flag checking %sabled", Name, (buf.flags & HD44780_CHECK_BF) ? "en" : "dis");
+    info("%s:   bus width %d bits", Name, (buf.flags & HD44780_4BITS_BUS) ? 4 : 8);
+    info("%s:   font size %s", Name, (buf.flags & HD44780_5X10_FONT) ? "5x10" : "5x8");
+
+    /* overwrite width size from lcd4linux.conf */
+    if (buf.vs_rows || buf.vs_cols) {
+	info("%s: disabling virtual screen", Name);
+	buf.vs_rows = 0;
+	buf.vs_cols = 0;
+	commit = 1;
+    }
 
-    /* overwrite with size from lcd4linux.conf */
-    if ((rows > 0 && rows != buf.cntr_rows) || (cols > 0 && cols != buf.disp_cols)) {
+    if ((rows > 0 && rows != buf.cntr_rows * buf.num_cntr) || (cols > 0 && cols != buf.cntr_cols)) {
 	info("%s: changing size to %dx%d", Name, cols, rows);
-	buf.cntr_rows = rows;
-	buf.disp_cols = cols;
-	if (ioctl(lcdlinux_fd, IOCTL_SET_PARAM, &buf) != 0) {
-	    error("%s: ioctl(IOCTL_SET_PARAM) failed: %s", Name, strerror(errno));
-	    error("%s: Could not set display geometry!", Name);
-	    return -1;
-	}
+	buf.cntr_rows = rows / buf.num_cntr;
+	buf.cntr_cols = cols;
+	commit = 1;
     }
 
-    DROWS = buf.cntr_rows;
-    DCOLS = buf.disp_cols;
+    DROWS = buf.cntr_rows * buf.num_cntr;
+    DCOLS = buf.cntr_cols;
 
     /* overwrite busy-flag checking from lcd4linux.conf */
     cfg_number(section, "UseBusy", 0, 0, 1, &use_busy);
-    if (use_busy && !(buf.flags & LCD_CHECK_BF)) {
+    if (use_busy && !(buf.flags & HD44780_CHECK_BF)) {
 	info("%s: activating busy-flag checking", Name);
-	buf.flags |= LCD_CHECK_BF;
-	if (ioctl(lcdlinux_fd, IOCTL_SET_PARAM, &buf) != 0) {
-	    error("%s: ioctl(IOCTL_SET_PARAM) failed: %s", Name, strerror(errno));
-	    error("%s: Could not activate busy-flag checking!", Name);
-	    return -1;
-	}
-    } else if (!use_busy && (buf.flags & LCD_CHECK_BF)) {
+	buf.flags |= HD44780_CHECK_BF;
+	commit = 1;
+    } else if (!use_busy && (buf.flags & HD44780_CHECK_BF)) {
 	info("%s: deactivating busy-flag checking", Name);
-	buf.flags &= ~LCD_CHECK_BF;
-	if (ioctl(lcdlinux_fd, IOCTL_SET_PARAM, &buf) != 0) {
-	    error("%s: ioctl(IOCTL_SET_PARAM) failed: %s", Name, strerror(errno));
-	    error("%s: Could not deactivate busy-flag checking!", Name);
-	    return -1;
-	}
+	buf.flags &= ~HD44780_CHECK_BF;
+	commit = 1;
+    }
+
+    /* overwrite bus length from lcd4linux.conf */
+    cfg_number(section, "Bus4Bit", 0, 0, 1, &bus4bits);
+    if (bus4bits && !(buf.flags & HD44780_4BITS_BUS)) {
+	info("%s: setting bus length to 4 bits", Name);
+	buf.flags |= HD44780_4BITS_BUS;
+	commit = 1;
+    } else if (!bus4bits && (buf.flags & HD44780_4BITS_BUS)) {
+	info("%s: setting bus length to 8 bits", Name);
+	buf.flags &= ~HD44780_4BITS_BUS;
+	commit = 1;
+    }
+
+    if (commit && ioctl(lcdlinux_fd, LCDL_SET_PARAM, &buf) != 0) {
+	error("%s: ioctl(LCDL_SET_PARAM) failed: %s", Name, strerror(errno));
+	return -1;
     }
 
     /* initialize display */
     drv_LL_clear();		/* clear display */
 
+    /* Disable control characters interpretation. */
+    /* No return value check since this ioctl cannot fail */
+    ioctl(lcdlinux_fd, LCDL_RAW_MODE, 1);
+
     if (!quiet) {
 	char buffer[40];
 	qprintf(buffer, sizeof(buffer), "%s %dx%d", Name, DCOLS, DROWS);
@@ -286,6 +271,8 @@
     int asc255bug;
     int ret;
 
+    info("%s: %s", Name, "$Rev: 904 $");
+
     /* display preferences */
     XRES = 5;			/* pixel width of one char  */
     YRES = 8;			/* pixel height of one char  */
@@ -361,6 +348,10 @@
 	drv_generic_text_greet("goodbye!", NULL);
     }
 
+    /* Enable control characters interpretation. */
+    /* No return value check since this ioctl cannot fail */
+    ioctl(lcdlinux_fd, LCDL_RAW_MODE, 0);
+
     /* close device */
     close(lcdlinux_fd);
 
@@ -369,8 +360,8 @@
 
 
 DRIVER drv_LCDLinux = {
-  name:Name,
-  list:drv_LL_list,
-  init:drv_LL_init,
-  quit:drv_LL_quit,
+    .name = Name,
+    .list = drv_LL_list,
+    .init = drv_LL_init,
+    .quit = drv_LL_quit,
 };
diff -urN lcd4linux-0.10.0/drv_LCDLinux.h lcd4linux-0.11.0-SVN/drv_LCDLinux.h
--- lcd4linux-0.10.0/drv_LCDLinux.h	2005-05-08 06:32:44.000000000 +0200
+++ lcd4linux-0.11.0-SVN/drv_LCDLinux.h	1970-01-01 01:00:00.000000000 +0100
@@ -1,92 +0,0 @@
-/* lcd.h
- *
- * $Id: drv_LCDLinux.h,v 1.4 2005/05/08 04:32:44 reinelt Exp $
- *
- * LCD driver for HD44780 compatible displays connected to the parallel port.
- * 
- * External interface header file.
- * 
- * Copyright (C) 2004, 2005  Mattia Jona-Lasinio (mjona@users.sourceforge.net)
- *
- *  This program is free software; you can redistribute it and/or modify
- *  it under the terms of the GNU General Public License as published by
- *  the Free Software Foundation; either version 2 of the License, or
- *  (at your option) any later version.
- *
- *  This program is distributed in the hope that it will be useful,
- *  but WITHOUT ANY WARRANTY; without even the implied warranty of
- *  MERCHANTABILITY or FITNESS FOR A PARTICULAR PURPOSE.  See the
- *  GNU General Public License for more details.
- *
- *  You should have received a copy of the GNU General Public License
- *  along with this program; if not, write to the Free Software
- *  Foundation, Inc., 59 Temple Place, Suite 330, Boston, MA  02111-1307  USA
- *
- */
-
-#ifndef LCD_H
-#define LCD_H
-
-#define LCD_LINUX_VERSION	"0.8.9-CVS"	/* Version number */
-
-#define LCD_MAJOR		120	/* Major number for this device
-					 * Set this to 0 for dynamic allocation
-					 */
-
-#include <linux/types.h>
-
-struct lcd_driver {
-    /* Hardware */
-    unsigned short io;		/* Parport base address */
-    unsigned short flags;	/* Flags (see Documentation) */
-
-    /* Display geometry */
-    unsigned short num_cntr;	/* Number of available controllers */
-    unsigned short cntr_rows;	/* Rows per controller */
-    unsigned short disp_cols;	/* Columns */
-    unsigned short frames;	/* Framebuffer frames */
-
-    unsigned short tabstop;	/* Length of tab character */
-};
-
-/* IOCTLs */
-#include <asm/ioctl.h>
-#define IOCTL_SET_PARAM		_IOW(LCD_MAJOR, 0, struct lcd_driver *)
-#define IOCTL_GET_PARAM		_IOR(LCD_MAJOR, 1, struct lcd_driver *)
-
-#define LCD_PROC_ON	0x0001	/* Enable the /proc filesystem support */
-#define LCD_ETTY_ON	0x0002	/* Enable the tty support */
-#define LCD_CONSOLE	0x0004	/* Enable the console support */
-#define LCD_4BITS_BUS	0x0008	/* Set the bus length to 4 bits */
-#define LCD_5X10_FONT	0x0010	/* Use 5x10 dots fonts */
-#define LCD_CHECK_BF	0x0020	/* Do busy flag checking */
-
-
-
-#ifdef __KERNEL__		/* The rest is for kernel only */
-
-#include <linux/version.h>
-
-#ifndef KERNEL_VERSION
-#define KERNEL_VERSION(a,b,c) (((a) << 16) + ((b) << 8) + (c))
-#endif
-
-#ifndef LINUX_VERSION_CODE
-#error - LINUX_VERSION_CODE undefined.
-#endif
-
-/* External interface */
-int lcd_init(struct lcd_driver *);
-void lcd_exit(void);
-int lcd_ioctl(unsigned int, void *);
-#if LINUX_VERSION_CODE >= KERNEL_VERSION(2,2,0)
-ssize_t lcd_write(const char *, size_t, unsigned int);
-ssize_t lcd_read(char *, size_t, unsigned int);
-#else
-int lcd_write(const char *, int, unsigned int);
-int lcd_read(char *, int, unsigned int);
-#endif
-
-#endif				/* __KERNEL__ */
-
-#endif				/* External interface included */
diff -urN lcd4linux-0.10.0/drv_LCDTerm.c lcd4linux-0.11.0-SVN/drv_LCDTerm.c
--- lcd4linux-0.10.0/drv_LCDTerm.c	2005-05-08 06:32:44.000000000 +0200
+++ lcd4linux-0.11.0-SVN/drv_LCDTerm.c	2008-12-31 08:05:54.000000000 +0100
@@ -1,9 +1,10 @@
-/* $Id: drv_LCDTerm.c,v 1.4 2005/05/08 04:32:44 reinelt Exp $
+/* $Id: drv_LCDTerm.c 840 2007-09-09 12:17:42Z michael $
+ * $URL: https://ssl.bulix.org/svn/lcd4linux/trunk/drv_LCDTerm.c $
  *
  * driver for the LCDTerm serial-to-HD44780 adapter boards
  * http://www.bobblick.com/techref/projects/lcdterm/lcdterm.html
  *
- * Copyright (C) 2005 Michael Reinelt <reinelt@eunet.at>
+ * Copyright (C) 2005 Michael Reinelt <michael@reinelt.co.at>
  * Copyright (C) 2005 The LCD4Linux Team <lcd4linux-devel@users.sourceforge.net>
  *
  * This file is part of LCD4Linux.
@@ -22,20 +23,6 @@
  * along with this program; if not, write to the Free Software
  * Foundation, Inc., 675 Mass Ave, Cambridge, MA 02139, USA.
  *
- *
- * $Log: drv_LCDTerm.c,v $
- * Revision 1.4  2005/05/08 04:32:44  reinelt
- * CodingStyle added and applied
- *
- * Revision 1.3  2005/01/22 22:57:57  reinelt
- * LCD-Linux driver added
- *
- * Revision 1.2  2005/01/18 06:30:23  reinelt
- * added (C) to all copyright statements
- *
- * Revision 1.1  2005/01/15 13:13:57  reinelt
- * LCDTerm driver added, take 2
- *
  */
 
 /* 
@@ -211,6 +198,8 @@
     int asc255bug;
     int ret;
 
+    info("%s: %s", Name, "$Rev: 840 $");
+
     /* display preferences */
     XRES = 5;			/* pixel width of one char  */
     YRES = 8;			/* pixel height of one char  */
@@ -295,8 +284,8 @@
 
 
 DRIVER drv_LCDTerm = {
-  name:Name,
-  list:drv_LT_list,
-  init:drv_LT_init,
-  quit:drv_LT_quit,
+    .name = Name,
+    .list = drv_LT_list,
+    .init = drv_LT_init,
+    .quit = drv_LT_quit,
 };
diff -urN lcd4linux-0.10.0/drv_LEDMatrix.c lcd4linux-0.11.0-SVN/drv_LEDMatrix.c
--- lcd4linux-0.10.0/drv_LEDMatrix.c	1970-01-01 01:00:00.000000000 +0100
+++ lcd4linux-0.11.0-SVN/drv_LEDMatrix.c	2008-12-31 08:06:27.000000000 +0100
@@ -0,0 +1,320 @@
+/* $Id: drv_LEDMatrix.c 774 2007-02-26 10:29:46Z michael $
+ * $URL: https://ssl.bulix.org/svn/lcd4linux/trunk/drv_LEDMatrix.c $
+ *
+ * LED matrix driver for LCD4Linux 
+ * (see http://www.harbaum.org/till/ledmatrix for hardware)
+ *
+ * Copyright (C) 2006 Till Harbaum <till@harbaum.org>
+ *
+ * This file is part of LCD4Linux.
+ *
+ * LCD4Linux is free software; you can redistribute it and/or modify
+ * it under the terms of the GNU General Public License as published by
+ * the Free Software Foundation; either version 2, or (at your option)
+ * any later version.
+ *
+ * LCD4Linux is distributed in the hope that it will be useful,
+ * but WITHOUT ANY WARRANTY; without even the implied warranty of
+ * MERCHANTABILITY or FITNESS FOR A PARTICULAR PURPOSE.  See the
+ * GNU General Public License for more details.
+ *
+ * You should have received a copy of the GNU General Public License
+ * along with this program; if not, write to the Free Software
+ * Foundation, Inc., 675 Mass Ave, Cambridge, MA 02139, USA.
+ *
+ */
+
+/* 
+ *
+ * exported fuctions:
+ *
+ * struct DRIVER drv_LEDMatrix
+ *
+ */
+
+/*
+ * Options:
+ * IPAddress
+ */
+
+#include "config.h"
+
+#include <stdlib.h>
+#include <stdio.h>
+#include <string.h>
+#include <errno.h>
+#include <unistd.h>
+#include <termios.h>
+#include <fcntl.h>
+#include <sys/time.h>
+
+/* include network specific headers */
+#include <arpa/inet.h>
+#include <sys/socket.h>
+#include <netinet/in.h>
+#include <sys/select.h>
+#include <netdb.h>
+
+#include "debug.h"
+#include "cfg.h"
+#include "qprintf.h"
+#include "plugin.h"
+#include "widget.h"
+#include "widget_text.h"
+#include "widget_icon.h"
+#include "widget_bar.h"
+#include "drv.h"
+#include "drv_generic_graphic.h"
+
+/* display command bytes */
+#define DSP_CMD_ECHO  0
+#define DSP_CMD_NOP   1
+#define DSP_CMD_IMAGE 2
+#define DSP_CMD_ACK   3
+#define DSP_CMD_IR    4
+#define DSP_CMD_BEEP  5
+
+#define DSP_DEFAULT_PORT 4711
+
+#define DSP_MEM (80 * 32 * 2 / 8)
+
+#define DEFAULT_X_OFFSET   1	/* with a font width of 6 */
+
+static char Name[] = "LEDMatrix";
+static char *IPAddress = NULL;
+static int sock = -1;
+static struct sockaddr_in dsp_addr;
+static unsigned char tx_buffer[DSP_MEM + 1];
+static int port = DSP_DEFAULT_PORT;
+
+static void drv_LEDMatrix_blit(const int row, const int col, const int height, const int width)
+{
+    int r, c, i;
+    fd_set rfds;
+    struct timeval tv;
+    unsigned char reply[256];
+    struct sockaddr_in cli_addr;
+    socklen_t fromlen;
+    int ack = 0;
+    int timeout = 10;
+
+    for (r = row; r < row + height; r++) {
+	for (c = col; c < col + width; c++) {
+	    /* LEDMATRIX supports three colors: 10b == green, 01b == red, 11b == amber */
+
+	    unsigned char color = 0;
+	    RGBA p = drv_generic_graphic_rgb(r, c);
+	    if (p.G >= 128)
+		color |= 0x80;
+	    if (p.R >= 128)
+		color |= 0x40;
+	    /* ignore blue ... */
+
+	    tx_buffer[1 + 20 * r + c / 4] &= ~(0xc0 >> (2 * (c & 3)));
+	    tx_buffer[1 + 20 * r + c / 4] |= color >> (2 * (c & 3));
+	}
+    }
+
+    /* scan entire display */
+    tx_buffer[0] = DSP_CMD_IMAGE;
+
+    do {
+
+	if ((sendto(sock, tx_buffer, DSP_MEM + 1, 0, (struct sockaddr *) &dsp_addr, sizeof(dsp_addr))) != DSP_MEM + 1)
+	    error("%s: sendto error on socket", Name);
+
+	/* now wait for reply */
+
+	FD_ZERO(&rfds);
+	FD_SET(sock, &rfds);
+	tv.tv_sec = 0;
+	tv.tv_usec = 100000;
+
+	/* wait 1 sec for ack */
+	if ((i = select(FD_SETSIZE, &rfds, NULL, NULL, &tv)) < 0) {
+	    info("%s: Select error: %s", Name, strerror(errno));
+	}
+
+	if (FD_ISSET(sock, &rfds)) {
+	    /* wait for ack */
+	    fromlen = sizeof(dsp_addr);
+	    i = recvfrom(sock, reply, sizeof(reply), 0, (struct sockaddr *) &cli_addr, &fromlen);
+	    if (i < 0) {
+		info("%s: Receive error: %s", Name, strerror(errno));
+	    } else {
+		if ((i == 2) && (reply[0] == DSP_CMD_ACK) && (reply[1] == DSP_CMD_IMAGE)) {
+		    ack = 1;
+		} else if ((i > 1) && (reply[0] == DSP_CMD_IR)) {
+		    /* maybe used later: */
+		    /* ir_receive(reply+1, i-1); */
+		} else {
+		    info("%s: Unexpected reply message", Name);
+		}
+	    }
+	}
+	timeout--;
+    } while ((!ack) && (timeout > 0));
+
+    if (timeout == 0) {
+	error("%s: display reply timeout", Name);
+    }
+}
+
+static int drv_LEDMatrix_start(const char *section)
+{
+    char *s;
+    struct sockaddr_in cli_addr;
+    struct hostent *hp;
+    int val;
+
+    IPAddress = cfg_get(section, "IPAddress", NULL);
+    if (IPAddress == NULL || *IPAddress == '\0') {
+	error("%s: no '%s.IPAddress' entry from %s", Name, section, cfg_source());
+	return -1;
+    }
+
+    if (cfg_number(section, "Port", 0, 0, 65535, &val) > 0) {
+	info("%s: port set to %d", Name, val);
+	port = val;
+    } else {
+	info("%s: using default port %d", Name, port);
+    }
+
+    /* display size is hard coded */
+    DCOLS = 80;
+    DROWS = 32;
+
+    if (sscanf(s = cfg_get(section, "font", "6x8"), "%dx%d", &XRES, &YRES) != 2 || XRES < 1 || YRES < 1) {
+	error("%s: bad %s.Font '%s' from %s", Name, section, s, cfg_source());
+	free(s);
+	return -1;
+    }
+    free(s);
+
+    /* contact display */
+    info("%s: contacting %s", Name, IPAddress);
+
+    /* try to resolve as a hostname */
+    if ((hp = gethostbyname(IPAddress)) == NULL) {
+	error("%s: unable to resolve hostname %s: %s", Name, IPAddress, strerror(errno));
+	return -1;
+    }
+
+    /* open datagram socket */
+    if ((sock = socket(AF_INET, SOCK_DGRAM, 0)) < 0) {
+	error("%s: could not create socket: %s", Name, strerror(errno));
+	return -1;
+    }
+
+    memset((char *) &dsp_addr, 0, sizeof(dsp_addr));
+    dsp_addr.sin_family = AF_INET;
+    dsp_addr.sin_addr.s_addr = *(int *) hp->h_addr;
+    dsp_addr.sin_port = htons(port);
+
+    cli_addr.sin_family = AF_INET;
+    cli_addr.sin_addr.s_addr = htons(INADDR_ANY);
+    cli_addr.sin_port = htons(port);
+
+    if (bind(sock, (struct sockaddr *) &cli_addr, sizeof(cli_addr)) < 0) {
+	error("%s: can't bind local address: %s", Name, strerror(errno));
+	return -1;
+    }
+
+    memset(tx_buffer, 0, sizeof(tx_buffer));
+
+    return 0;
+}
+
+
+
+/****************************************/
+/***            plugins               ***/
+/****************************************/
+
+/* none at the moment... */
+
+
+/****************************************/
+/***        widget callbacks          ***/
+/****************************************/
+
+
+/* using drv_generic_graphic_draw(W) */
+/* using drv_generic_graphic_icon_draw(W) */
+/* using drv_generic_graphic_bar_draw(W) */
+
+
+/****************************************/
+/***        exported functions        ***/
+/****************************************/
+
+
+/* list models */
+int drv_LEDMatrix_list(void)
+{
+    return 0;
+}
+
+
+/* initialize driver & display */
+int drv_LEDMatrix_init(const char *section, const __attribute__ ((unused))
+		       int quiet)
+{
+    WIDGET_CLASS wc;
+    int ret;
+
+    /* real worker functions */
+    drv_generic_graphic_real_blit = drv_LEDMatrix_blit;
+
+    /* start display */
+    if ((ret = drv_LEDMatrix_start(section)) != 0)
+	return ret;
+
+    /* initialize generic graphic driver */
+    if ((ret = drv_generic_graphic_init(section, Name)) != 0)
+	return ret;
+
+    /* register text widget */
+    wc = Widget_Text;
+    wc.draw = drv_generic_graphic_draw;
+    widget_register(&wc);
+
+    /* register icon widget */
+    wc = Widget_Icon;
+    wc.draw = drv_generic_graphic_icon_draw;
+    widget_register(&wc);
+
+    /* register bar widget */
+    wc = Widget_Bar;
+    wc.draw = drv_generic_graphic_bar_draw;
+    widget_register(&wc);
+
+    /* register plugins */
+    /* none at the moment... */
+
+
+    return 0;
+}
+
+
+/* close driver & display */
+int drv_LEDMatrix_quit(const __attribute__ ((unused))
+		       int quiet)
+{
+
+    info("%s: shutting down.", Name);
+    drv_generic_graphic_quit();
+
+    if (sock != -1)
+	close(sock);
+
+    return (0);
+}
+
+
+DRIVER drv_LEDMatrix = {
+    .name = Name,
+    .list = drv_LEDMatrix_list,
+    .init = drv_LEDMatrix_init,
+    .quit = drv_LEDMatrix_quit,
+};
diff -urN lcd4linux-0.10.0/drv_LPH7508.c lcd4linux-0.11.0-SVN/drv_LPH7508.c
--- lcd4linux-0.10.0/drv_LPH7508.c	1970-01-01 01:00:00.000000000 +0100
+++ lcd4linux-0.11.0-SVN/drv_LPH7508.c	2008-12-31 08:05:54.000000000 +0100
@@ -0,0 +1,528 @@
+/* $Id: drv_LPH7508.c 840 2007-09-09 12:17:42Z michael $
+ * $URL: https://ssl.bulix.org/svn/lcd4linux/trunk/drv_LPH7508.c $
+ *
+ * driver for Pollin LPH7508
+ *
+ * Copyright (C) 2005 Michael Reinelt <michael@reinelt.co.at>
+ * Copyright (C) 2005 The LCD4Linux Team <lcd4linux-devel@users.sourceforge.net>
+ *
+ * This file is part of LCD4Linux.
+ *
+ * LCD4Linux is free software; you can redistribute it and/or modify
+ * it under the terms of the GNU General Public License as published by
+ * the Free Software Foundation; either version 2, or (at your option)
+ * any later version.
+ *
+ * LCD4Linux is distributed in the hope that it will be useful,
+ * but WITHOUT ANY WARRANTY; without even the implied warranty of
+ * MERCHANTABILITY or FITNESS FOR A PARTICULAR PURPOSE.  See the
+ * GNU General Public License for more details.
+ *
+ * You should have received a copy of the GNU General Public License
+ * along with this program; if not, write to the Free Software
+ * Foundation, Inc., 675 Mass Ave, Cambridge, MA 02139, USA.
+ *
+ */
+
+/* 
+ *
+ * exported fuctions:
+ *
+ * struct DRIVER drv_LPH7508
+ *
+ */
+
+#include "config.h"
+
+#include <stdlib.h>
+#include <stdio.h>
+#include <string.h>
+#include <errno.h>
+#include <unistd.h>
+#include <termios.h>
+#include <fcntl.h>
+#include <sys/time.h>
+
+#include "debug.h"
+#include "cfg.h"
+#include "qprintf.h"
+#include "udelay.h"
+#include "plugin.h"
+#include "drv.h"
+#include "drv_generic_graphic.h"
+#include "drv_generic_gpio.h"
+#include "drv_generic_parport.h"
+
+#ifdef WITH_DMALLOC
+#include <dmalloc.h>
+#endif
+
+static char Name[] = "LPH7508";
+
+
+static unsigned char SIGNAL_RES;
+static unsigned char SIGNAL_CS1;
+static unsigned char SIGNAL_RW;
+static unsigned char SIGNAL_A0;
+
+static int PAGES, SROWS, SCOLS;
+
+static unsigned char *Buffer1, *Buffer2;
+
+
+
+/****************************************/
+/***  hardware dependant functions    ***/
+/****************************************/
+
+static void drv_L7_write_ctrl(const unsigned char data)
+{
+    /* put data on DB1..DB8 */
+    drv_generic_parport_data(data);
+
+    /* CS1 = high, RW = low, A0 = low */
+    drv_generic_parport_control(SIGNAL_CS1 | SIGNAL_RW | SIGNAL_A0, SIGNAL_CS1);
+
+    /* Address Setup Time = 10 ns */
+    /* Data Setup Time = 20 ns */
+    ndelay(20);
+
+    /* Control L Pulse Width = 22 ns */
+    drv_generic_parport_toggle(SIGNAL_CS1, 0, 22);
+
+    /* Address & Data Hold Time = 10 ns */
+    ndelay(10);
+}
+
+
+static void drv_L7_write_data(const unsigned char data)
+{
+    /* put data on DB1..DB8 */
+    drv_generic_parport_data(data);
+
+    /* CS1 = high, RW = low, A0 = high */
+    drv_generic_parport_control(SIGNAL_CS1 | SIGNAL_RW | SIGNAL_A0, SIGNAL_CS1 | SIGNAL_A0);
+
+    /* Address Setup Time = 10 ns */
+    /* Data Setup Time = 20 ns */
+    ndelay(20);
+
+    /* Control L Pulse Width = 22 ns */
+    drv_generic_parport_toggle(SIGNAL_CS1, 0, 22);
+
+    /* Address & Data Hold Time = 10 ns */
+    ndelay(10);
+}
+
+
+static void drv_L7_page(int page)
+{
+    static int cp = -1;
+
+    if (page != cp) {
+	cp = page;
+	drv_L7_write_ctrl(0xb0 | cp);
+    }
+
+}
+
+
+static void drv_L7_put(int col, int val)
+{
+    static int cc = -1;
+
+    /* select page 8 */
+    drv_L7_page(8);
+
+    if (col != cc) {
+	cc = col;
+	drv_L7_write_ctrl(0x00 | (cc & 0x0f));
+	drv_L7_write_ctrl(0x10 | (cc >> 4));
+    }
+    drv_L7_write_data(val);
+    cc++;
+}
+
+
+static void drv_L7_clear(void)
+{
+    int p, c;
+
+    for (p = 0; p < PAGES; p++) {
+	/* select page */
+	drv_L7_page(p);
+	/* select column address */
+	drv_L7_write_ctrl(0x00);
+	drv_L7_write_ctrl(0x10);
+	for (c = 0; c < SCOLS; c++) {
+	    drv_L7_write_data(0);
+	}
+    }
+}
+
+
+static void drv_L7_blit(const int row, const int col, const int height, const int width)
+{
+    int r, p, c, a;
+    unsigned char m;
+
+    /* transfer layout to display framebuffer */
+    for (r = row; r < row + height; r++) {
+	/* do not process extra row for symbols */
+	if (r >= SROWS - 1)
+	    break;
+	/* page */
+	p = r / 8;
+	for (c = col; c < col + width; c++) {
+	    if (c >= SCOLS)
+		break;
+	    /* RAM address */
+	    a = p * SCOLS + c;
+	    /* bit mask */
+	    m = 1 << (r % 8);
+	    if (drv_generic_graphic_black(r, c)) {
+		/* set bit */
+		Buffer1[a] |= m;
+	    } else {
+		/* clear bit */
+		Buffer1[a] &= ~m;
+	    }
+	}
+    }
+
+    /* process display framebuffer */
+    for (p = row / 8; p <= (row + height) / 8; p++) {
+	int i, j, a, e;
+	if (p >= PAGES)
+	    break;
+	for (i = col; i < col + width; i++) {
+	    if (i >= SCOLS)
+		break;
+	    a = p * SCOLS + i;
+	    if (Buffer1[a] == Buffer2[a])
+		continue;
+	    for (j = i, e = 0; i < col + width; i++) {
+		a = p * SCOLS + i;
+		if (Buffer1[a] == Buffer2[a]) {
+		    if (++e > 2)
+			break;
+		} else {
+		    e = 0;
+		}
+	    }
+	    /* select page */
+	    drv_L7_page(p);
+	    /* column address */
+	    /* first column address = 32 */
+	    drv_L7_write_ctrl(0x00 | ((j + 32) & 0x0f));
+	    drv_L7_write_ctrl(0x10 | ((j + 32) >> 4));
+	    /* data */
+	    for (j = j; j <= i - e; j++) {
+		a = p * SCOLS + j;
+		drv_L7_write_data(Buffer1[a]);
+		Buffer2[a] = Buffer1[a];
+	    }
+	}
+    }
+}
+
+
+static int drv_L7_GPO(const int num, const int val)
+{
+    int v = 0;
+
+    switch (num) {
+    case 0:
+	/* battery symbol */
+	v = (val > 0) ? 1 : 0;
+	drv_L7_put(32, v);
+	break;
+    case 1:
+	/* battery level */
+	if (val < 0) {
+	    v = 0;
+	    drv_L7_put(46, v);
+	    drv_L7_put(47, v);
+	    drv_L7_put(48, v);
+	    drv_L7_put(49, v);
+	} else {
+	    v = val & 0x0f;
+	    drv_L7_put(46, (v & 1) ? 1 : 0);
+	    drv_L7_put(47, (v & 2) ? 1 : 0);
+	    drv_L7_put(48, (v & 4) ? 1 : 0);
+	    drv_L7_put(49, (v & 8) ? 1 : 0);
+	}
+	break;
+    case 2:
+	/* earpiece */
+	v = (val > 0) ? 1 : 0;
+	drv_L7_put(59, v);
+	break;
+    case 3:
+	/* triangle */
+	v = (val > 0) ? 1 : 0;
+	drv_L7_put(69, v);
+	Buffer1[8 * SCOLS + 69 - 32] = (val > 0);
+	break;
+    case 4:
+	/* head */
+	v = (val > 0) ? 1 : 0;
+	drv_L7_put(83, v);
+	Buffer1[8 * SCOLS + 83 - 32] = (val > 0);
+	break;
+    case 5:
+	/* message */
+	v = (val > 0) ? 1 : 0;
+	drv_L7_put(98, v);
+	Buffer1[8 * SCOLS + 98 - 32] = (val > 0);
+	break;
+    case 6:
+	/* antenna */
+	v = (val > 0) ? 1 : 0;
+	drv_L7_put(117, v);
+	Buffer1[8 * SCOLS + 117 - 32] = (val > 0);
+	break;
+    case 7:
+	/* signal level */
+	if (val < 0) {
+	    v = 0;
+	    drv_L7_put(112, v);
+	    drv_L7_put(113, v);
+	    drv_L7_put(114, v);
+	    drv_L7_put(115, v);
+	} else {
+	    v = val & 0x0f;
+	    drv_L7_put(112, (v & 1) ? 1 : 0);
+	    drv_L7_put(113, (v & 2) ? 1 : 0);
+	    drv_L7_put(114, (v & 4) ? 1 : 0);
+	    drv_L7_put(115, (v & 8) ? 1 : 0);
+	}
+	break;
+    }
+
+    return v;
+}
+
+
+static int drv_L7_contrast(int contrast)
+{
+    if (contrast < 0)
+	contrast = 0;
+    if (contrast > 31)
+	contrast = 31;
+
+    drv_L7_write_ctrl(0x80 | contrast);
+
+    return contrast;
+}
+
+
+static int drv_L7_start(const char *section)
+{
+    char *s;
+    int contrast;
+
+    /* fixed size */
+    DROWS = 64;
+    DCOLS = 100;
+    GPOS = 8;
+
+    /* SED1560 display RAM layout */
+    PAGES = 8;
+    SROWS = 64;
+    SCOLS = 166;
+
+    s = cfg_get(section, "Font", "6x8");
+    if (s == NULL || *s == '\0') {
+	error("%s: no '%s.Font' entry from %s", Name, section, cfg_source());
+	return -1;
+    }
+
+    XRES = -1;
+    YRES = -1;
+    if (sscanf(s, "%dx%d", &XRES, &YRES) != 2 || XRES < 1 || YRES < 1) {
+	error("%s: bad Font '%s' from %s", Name, s, cfg_source());
+	return -1;
+    }
+
+    /* Fixme: provider other fonts someday... */
+    if (XRES != 6 && YRES != 8) {
+	error("%s: bad Font '%s' from %s (only 6x8 at the moment)", Name, s, cfg_source());
+	return -1;
+    }
+
+    /* provide room for page 8 (symbols) */
+    Buffer1 = malloc(PAGES * SCOLS);
+    if (Buffer1 == NULL) {
+	error("%s: framebuffer #1 could not be allocated: malloc() failed", Name);
+	return -1;
+    }
+
+    Buffer2 = malloc(PAGES * SCOLS);
+    if (Buffer2 == NULL) {
+	error("%s: framebuffer #2 could not be allocated: malloc() failed", Name);
+	return -1;
+    }
+
+    memset(Buffer1, 0, PAGES * SCOLS * sizeof(*Buffer1));
+    memset(Buffer2, 0, PAGES * SCOLS * sizeof(*Buffer2));
+
+    if (drv_generic_parport_open(section, Name) != 0) {
+	error("%s: could not initialize parallel port!", Name);
+	return -1;
+    }
+
+    if ((SIGNAL_RES = drv_generic_parport_hardwire_ctrl("RES", "INIT")) == 0xff)
+	return -1;
+    if ((SIGNAL_CS1 = drv_generic_parport_hardwire_ctrl("CS1", "STROBE")) == 0xff)
+	return -1;
+    if ((SIGNAL_RW = drv_generic_parport_hardwire_ctrl("RW", "SLCTIN")) == 0xff)
+	return -1;
+    if ((SIGNAL_A0 = drv_generic_parport_hardwire_ctrl("A0", "AUTOFD")) == 0xff)
+	return -1;
+
+    /* rise RES, CS1, RW and A0 */
+    drv_generic_parport_control(SIGNAL_RES | SIGNAL_CS1 | SIGNAL_RW | SIGNAL_A0,
+				SIGNAL_RES | SIGNAL_CS1 | SIGNAL_RW | SIGNAL_A0);
+
+    /* set direction: write */
+    drv_generic_parport_direction(0);
+
+    /* reset display: lower RESET for 1 usec */
+    drv_generic_parport_control(SIGNAL_RES, 0);
+    udelay(1);
+    drv_generic_parport_control(SIGNAL_RES, SIGNAL_RES);
+    udelay(100);
+
+    /* just to make sure: send a software reset */
+    drv_L7_write_ctrl(0xe2);
+    udelay(20000);
+
+    drv_L7_write_ctrl(0xAE);	/* Display off */
+    drv_L7_write_ctrl(0x40);	/* Start Display Line = 0 */
+    drv_L7_write_ctrl(0x20);	/* reverse line driving off */
+    drv_L7_write_ctrl(0xCC);	/* OutputStatus = $0C, 102x64 */
+    drv_L7_write_ctrl(0xA0);	/* ADC = normal */
+    drv_L7_write_ctrl(0xA9);	/* LCD-Duty = 1/64 */
+    drv_L7_write_ctrl(0xAB);	/* LCD-Duty +1 (1/65, symbols) */
+    drv_L7_write_ctrl(0x25);	/* power supply on */
+    udelay(100 * 1000);		/* wait 100 msec */
+    drv_L7_write_ctrl(0xED);	/* power supply on completion */
+    drv_L7_write_ctrl(0x8F);	/* Contrast medium */
+    drv_L7_write_ctrl(0xA4);	/* Display Test off */
+    drv_L7_write_ctrl(0xAF);	/* Display on */
+    drv_L7_write_ctrl(0xA6);	/* Display on */
+
+    /* clear display */
+    drv_L7_clear();
+
+    if (cfg_number(section, "Contrast", 15, 0, 31, &contrast) > 0) {
+	drv_L7_contrast(contrast);
+    }
+
+    return 0;
+}
+
+
+/****************************************/
+/***            plugins               ***/
+/****************************************/
+
+
+static void plugin_contrast(RESULT * result, RESULT * arg1)
+{
+    double contrast = drv_L7_contrast(R2N(arg1));
+    SetResult(&result, R_NUMBER, &contrast);
+}
+
+
+/****************************************/
+/***        exported functions        ***/
+/****************************************/
+
+
+/* list models */
+int drv_L7_list(void)
+{
+    printf("LPH7508");
+    return 0;
+}
+
+
+/* initialize driver & display */
+int drv_L7_init(const char *section, const int quiet)
+{
+    int ret;
+
+    info("%s: %s", Name, "$Rev: 840 $");
+
+    /* real worker functions */
+    drv_generic_graphic_real_blit = drv_L7_blit;
+    drv_generic_gpio_real_set = drv_L7_GPO;
+
+    /* start display */
+    if ((ret = drv_L7_start(section)) != 0)
+	return ret;
+
+    /* initialize generic graphic driver */
+    if ((ret = drv_generic_graphic_init(section, Name)) != 0)
+	return ret;
+
+    /* initialize generic GPIO driver */
+    if ((ret = drv_generic_gpio_init(section, Name)) != 0)
+	return ret;
+
+    if (!quiet) {
+	char buffer[40];
+	qprintf(buffer, sizeof(buffer), "%s %dx%d", Name, DCOLS, DROWS);
+	if (drv_generic_graphic_greet(buffer, NULL)) {
+	    sleep(3);
+	    drv_generic_graphic_clear();
+	}
+    }
+
+
+    /* register plugins */
+    AddFunction("LCD::contrast", 1, plugin_contrast);
+
+
+    return 0;
+}
+
+
+/* close driver & display */
+int drv_L7_quit(const int quiet)
+{
+
+    info("%s: shutting down display.", Name);
+
+    drv_generic_graphic_clear();
+
+    if (!quiet) {
+	drv_generic_graphic_greet("goodbye!", NULL);
+    }
+
+    drv_generic_graphic_quit();
+    drv_generic_gpio_quit();
+    drv_generic_parport_close();
+
+    if (Buffer1) {
+	free(Buffer1);
+	Buffer1 = NULL;
+    }
+
+    if (Buffer2) {
+	free(Buffer2);
+	Buffer2 = NULL;
+    }
+
+    return (0);
+}
+
+
+DRIVER drv_LPH7508 = {
+    .name = Name,
+    .list = drv_L7_list,
+    .init = drv_L7_init,
+    .quit = drv_L7_quit,
+};
diff -urN lcd4linux-0.10.0/drv_LUIse.c lcd4linux-0.11.0-SVN/drv_LUIse.c
--- lcd4linux-0.10.0/drv_LUIse.c	1970-01-01 01:00:00.000000000 +0100
+++ lcd4linux-0.11.0-SVN/drv_LUIse.c	2008-12-31 08:05:54.000000000 +0100
@@ -0,0 +1,336 @@
+/* $Id: drv_LUIse.c 798 2007-05-04 11:35:52Z michael $
+ * $URL: https://ssl.bulix.org/svn/lcd4linux/trunk/drv_LUIse.c $
+ *
+ * LUIse lcd4linux driver
+ *
+ * Copyright (C) 2005 Theo Schneider <theo@schneider-berlin.net>
+ * Copyright (C) 2005 The LCD4Linux Team <lcd4linux-devel@users.sourceforge.net>
+ *
+ * This file is part of LCD4Linux.
+ *
+ * LCD4Linux is free software; you can redistribute it and/or modify
+ * it under the terms of the GNU General Public License as published by
+ * the Free Software Foundation; either version 2, or (at your option)
+ * any later version.
+ *
+ * LCD4Linux is distributed in the hope that it will be useful,
+ * but WITHOUT ANY WARRANTY; without even the implied warranty of
+ * MERCHANTABILITY or FITNESS FOR A PARTICULAR PURPOSE.  See the
+ * GNU General Public License for more details.
+ *
+ * You should have received a copy of the GNU General Public License
+ * along with this program; if not, write to the Free Software
+ * Foundation, Inc., 675 Mass Ave, Cambridge, MA 02139, USA.
+ *
+ */
+
+/* 
+ *
+ * exported fuctions:
+ *
+ * struct DRIVER drv_LUIse
+ *
+ */
+
+#include "config.h"
+
+#include <stdlib.h>
+#include <stdio.h>
+#include <string.h>
+#include <errno.h>
+
+#include <usb.h>
+#include <luise.h>
+
+#include "debug.h"
+#include "cfg.h"
+#include "qprintf.h"
+#include "udelay.h"
+#include "plugin.h"
+#include "drv.h"
+#include "drv_generic_graphic.h"
+
+static char Name[] = "LUIse";
+
+/* default Wert */
+static int devNum = 0;
+
+
+
+/****************************************/
+/***  hardware dependant functions    ***/
+/****************************************/
+static void drv_LUIse_clear(void)
+{
+    unsigned char buf[9600];
+    int x;
+
+    // clear text
+    LUI_Text(devNum, 0, 0, 320, 240, 0, 0, 1, 1, "");
+
+    // clear picture
+    for (x = 0; x < 9600; x++)
+	buf[x] = 0x00;
+    LUI_Bitmap(devNum, 0, 0, 0, 0, 0, DCOLS, DROWS, DCOLS, DROWS, buf);
+    LUI_Bitmap(devNum, 1, 0, 0, 0, 0, DCOLS, DROWS, DCOLS, DROWS, buf);
+}
+
+
+static void drv_LUIse_blit(const int row, const int col, const int height, const int width)
+{
+    int r, c;
+
+    for (r = row; r < row + height; r++) {
+	for (c = col; c < col + width; c++) {
+	    if (drv_generic_graphic_black(r, c)) {
+		LUI_SetPixel(devNum, 0, c, r, 1);
+	    } else {
+		LUI_SetPixel(devNum, 0, c, r, 0);
+	    }
+	}
+    }
+}
+
+static int drv_LUIse_contrast(int contrast)
+{
+    /* adjust limits according to the display */
+    if (contrast < 0)
+	contrast = 0;
+    if (contrast > 255)
+	contrast = 255;
+
+    LUI_SetContrast(devNum, contrast);
+
+    return contrast;
+}
+
+static int drv_LUIse_backlight(int backlight)
+{
+    if (backlight < 0)
+	backlight = 0;
+    if (backlight > 1)
+	backlight = 1;
+
+    LUI_CCFL(devNum, backlight);
+
+    return backlight;
+}
+
+
+/* start graphic display */
+static int drv_LUIse_start(const char *section)
+{
+    char *s;
+    int gfxmode, gfxinvert, ScreenRotation, IOrefresh;
+    int contrast, backlight;
+
+    /* read devNum from config */
+    s = cfg_get(section, "DeviceNum", 0);
+    if (s == NULL || *s == '\0') {
+	error("%s: no '%s.DeviceNum' entry from %s", Name, section, cfg_source());
+	return -1;
+    }
+    if (sscanf(s, "%d", &devNum) < 0 || devNum > 4) {
+	error("%s: bad DeviceNum '%s' from %s", Name, s, cfg_source());
+	return -1;
+    }
+    info("%s: using DeviceNum '%d'", Name, devNum);
+
+    /* open communication with the display */
+    if (LUI_OpenDevice(devNum) > 0) {
+	error("unable to open DeviceNum: %d", devNum);
+	return -1;
+    }
+
+    /*
+     * 0 : gfxmode              0 = or, 1 = and, 2 = xor
+     * 0 : gfxinvert            0 = normal, 1 = invert
+     * 0 : ScreenRotation       0 =, 1 =, 2 =, 3 =, 
+     * 2 : IOrefresh            0 = 25ms...255=256*25ms
+     */
+
+    s = cfg_get(section, "Mode", "0.0.0.2");
+    if (s == NULL || *s == '\0') {
+	error("%s: no '%s.Mode' entry from %s", Name, section, cfg_source());
+	return -1;
+    }
+
+    if (sscanf(s, "%d.%d.%d.%d", &gfxmode, &gfxinvert, &ScreenRotation, &IOrefresh) != 4 ||
+	gfxmode < 0 || gfxmode > 2 || gfxinvert < 0 || gfxinvert > 1 ||
+	ScreenRotation < 0 || ScreenRotation > 255 || IOrefresh < 0 || IOrefresh > 255) {
+	error("%s: bad Mode '%s' from %s", Name, s, cfg_source());
+	return -1;
+    }
+
+    if (LUI_LCDmode(devNum, gfxmode, gfxinvert, ScreenRotation, IOrefresh) > 0) {
+	error("Error LUI_LCDmode");
+	return -1;
+    }
+
+    switch (ScreenRotation) {
+    case 0:{
+	    DCOLS = 320;
+	    DROWS = 240;
+	    break;
+	}
+    case 1:{
+	    DCOLS = 240;
+	    DROWS = 320;
+	    break;
+	}
+    case 2:{
+	    DCOLS = 320;
+	    DROWS = 240;
+	    break;
+	}
+    case 3:{
+	    DCOLS = 240;
+	    DROWS = 320;
+	    break;
+	}
+    }
+
+    s = cfg_get(section, "Font", "6x8");
+    if (s == NULL || *s == '\0') {
+	error("%s: no '%s.Font' entry from %s", Name, section, cfg_source());
+	return -1;
+    }
+
+    XRES = -1;
+    YRES = -1;
+    if (sscanf(s, "%dx%d", &XRES, &YRES) != 2 || XRES < 1 || YRES < 1) {
+	error("%s: bad Font '%s' from %s", Name, s, cfg_source());
+	return -1;
+    }
+
+    /* Fixme: provider other fonts someday... */
+    if (XRES != 6 && YRES != 8) {
+	error("%s: bad Font '%s' from %s (only 6x8 at the moment)", Name, s, cfg_source());
+	return -1;
+    }
+
+    if (cfg_number(section, "Contrast", 128, 0, 255, &contrast) > 0) {
+	drv_LUIse_contrast(contrast);
+    }
+
+    if (cfg_number(section, "Backlight", 0, 0, 1, &backlight) > 0) {
+	drv_LUIse_backlight(backlight);
+    }
+
+    s = cfg_get(section, "Backpicture", NULL);
+    if (s == NULL || *s == '\0') {
+	error("%s: no '%s.Backpicture' entry from %s", Name, section, cfg_source());
+    } else {
+	drv_LUIse_clear();
+	if (LUI_BMPfile(devNum, 1, 0, 0, 0, 0, DCOLS, DROWS, s)) {
+	    error("%s: Sorry unable to load: %s", Name, s);
+	    return -1;
+	}
+    }
+
+    return 0;
+}
+
+
+/****************************************/
+/***            plugins               ***/
+/****************************************/
+
+static void plugin_contrast(RESULT * result, RESULT * arg1)
+{
+    double contrast;
+
+    contrast = drv_LUIse_contrast(R2N(arg1));
+    SetResult(&result, R_NUMBER, &contrast);
+}
+
+static void plugin_backlight(RESULT * result, RESULT * arg1)
+{
+    double backlight;
+
+    backlight = drv_LUIse_backlight(R2N(arg1));
+    SetResult(&result, R_NUMBER, &backlight);
+}
+
+
+/****************************************/
+/***        exported functions        ***/
+/****************************************/
+
+
+/* list models */
+int drv_LUIse_list(void)
+{
+    printf("generic");
+    return 0;
+}
+
+/* initialize driver & display */
+int drv_LUIse_init(const char *section, const int quiet)
+{
+    int ret;
+
+    info("%s: %s", Name, "$Rev: 798 $");
+
+    /* real worker functions */
+    drv_generic_graphic_real_blit = drv_LUIse_blit;
+
+    /* start display */
+    if ((ret = drv_LUIse_start(section)) != 0)
+	return ret;
+
+    /* initialize generic graphic driver */
+    if ((ret = drv_generic_graphic_init(section, Name)) != 0)
+	return ret;
+
+    if (!quiet) {
+	char buffer[40];
+	qprintf(buffer, sizeof(buffer), "%s %dx%d", Name, DCOLS, DROWS);
+	if (drv_generic_graphic_greet(buffer, NULL)) {
+	    sleep(3);
+	    drv_generic_graphic_clear();
+	}
+    }
+
+    /* register plugins */
+    AddFunction("LCD::contrast", 1, plugin_contrast);
+    AddFunction("LCD::backlight", 1, plugin_backlight);
+
+    return 0;
+}
+
+/* close driver & display */
+/* use this function for a graphic display */
+int drv_LUIse_quit(const int quiet)
+{
+
+    info("%s: shutting down.", Name);
+
+    /* clear display */
+    drv_LUIse_clear();
+
+    /* set default for Contrast, ScreenRotation, gfxmode, gfxinvert, IOrefresh */
+    LUI_SetContrast(devNum, 128);
+    LUI_LCDmode(devNum, 0, 0, 0, 2);
+
+
+    /* say goodbye... */
+    if (!quiet) {
+	drv_generic_graphic_greet("goodbye!", NULL);
+    }
+
+    drv_generic_graphic_quit();
+
+    debug("closing connection");
+    LUI_CloseDevice(devNum);
+
+    return (0);
+}
+
+/* use this one for a graphic display */
+DRIVER drv_LUIse = {
+    .name = Name,
+    .list = drv_LUIse_list,
+    .init = drv_LUIse_init,
+    .quit = drv_LUIse_quit,
+};
diff -urN lcd4linux-0.10.0/drv_M50530.c lcd4linux-0.11.0-SVN/drv_M50530.c
--- lcd4linux-0.10.0/drv_M50530.c	2005-06-09 19:41:47.000000000 +0200
+++ lcd4linux-0.11.0-SVN/drv_M50530.c	2008-12-31 08:05:54.000000000 +0100
@@ -1,8 +1,9 @@
-/* $Id: drv_M50530.c,v 1.19 2005/06/09 17:41:47 reinelt Exp $
+/* $Id: drv_M50530.c 840 2007-09-09 12:17:42Z michael $
+ * $URL: https://ssl.bulix.org/svn/lcd4linux/trunk/drv_M50530.c $
  *
  * new style driver for M50530-based displays
  *
- * Copyright (C) 2003 Michael Reinelt <reinelt@eunet.at>
+ * Copyright (C) 2003 Michael Reinelt <michael@reinelt.co.at>
  * Copyright (C) 2004 The LCD4Linux Team <lcd4linux-devel@users.sourceforge.net>
  *
  * This file is part of LCD4Linux.
@@ -21,89 +22,6 @@
  * along with this program; if not, write to the Free Software
  * Foundation, Inc., 675 Mass Ave, Cambridge, MA 02139, USA.
  *
- *
- * $Log: drv_M50530.c,v $
- * Revision 1.19  2005/06/09 17:41:47  reinelt
- * M50530 fixes (many thanks to Szymon Bieganski)
- *
- * Revision 1.18  2005/05/08 04:32:44  reinelt
- * CodingStyle added and applied
- *
- * Revision 1.17  2005/05/05 08:36:12  reinelt
- * changed SELECT to SLCTIN
- *
- * Revision 1.16  2005/01/18 06:30:23  reinelt
- * added (C) to all copyright statements
- *
- * Revision 1.15  2005/01/06 16:54:53  reinelt
- * M50530 fixes
- *
- * Revision 1.14  2004/06/26 12:04:59  reinelt
- *
- * uh-oh... the last CVS log message messed up things a lot...
- *
- * Revision 1.13  2004/06/26 09:27:20  reinelt
- *
- * added '-W' to CFLAGS
- * changed all C++ comments to C ones
- * cleaned up a lot of signed/unsigned mistakes
- *
- * Revision 1.12  2004/06/20 10:09:54  reinelt
- *
- * 'const'ified the whole source
- *
- * Revision 1.11  2004/06/06 06:51:59  reinelt
- *
- * do not display end splash screen if quiet=1
- *
- * Revision 1.10  2004/06/05 06:41:39  reinelt
- *
- * chancged splash screen again
- *
- * Revision 1.9  2004/06/05 06:13:12  reinelt
- *
- * splash screen for all text-based display drivers
- *
- * Revision 1.8  2004/06/02 09:41:19  reinelt
- *
- * prepared support for startup splash screen
- *
- * Revision 1.7  2004/06/01 06:45:29  reinelt
- *
- * some Fixme's processed
- * documented some code
- *
- * Revision 1.6  2004/05/31 05:38:02  reinelt
- *
- * fixed possible bugs with user-defined chars (clear high bits)
- * thanks to Andy Baxter for debugging the MilfordInstruments driver!
- *
- * Revision 1.5  2004/05/29 15:53:28  reinelt
- *
- * M50530: reset parport signals on exit
- * plugin_ppp: ppp() has two parameters, not three
- * lcd4linux.conf.sample: diskstats() corrected
- *
- * Revision 1.4  2004/05/26 11:37:36  reinelt
- *
- * Curses driver ported.
- *
- * Revision 1.3  2004/03/19 09:17:46  reinelt
- *
- * removed the extra 'goto' function, row and col are additional parameters
- * of the write() function now.
- *
- * Revision 1.2  2004/02/15 21:43:43  reinelt
- * T6963 driver nearly finished
- * framework for graphic displays done
- * i2c_sensors patch from Xavier
- * some more old generation files removed
- *
- * Revision 1.1  2004/02/15 08:22:47  reinelt
- * ported USBLCD driver to NextGeneration
- * added drv_M50530.c (I forgot yesterday, sorry)
- * removed old drivers M50530.c and USBLCD.c
- *
  */
 
 /* 
@@ -136,12 +54,19 @@
 #include "widget_bar.h"
 #include "drv.h"
 #include "drv_generic_text.h"
+#include "drv_generic_gpio.h"
 #include "drv_generic_parport.h"
 
 static char Name[] = "M50530";
 
 static int Model;
 
+/* Timings */
+static int T_SU, T_W, T_D, T_H;
+static int T_INIT, T_EXEC, T_CLEAR;
+static int T_GPO_ST, T_GPO_PW;
+
+static unsigned char SIGNAL_RW;
 static unsigned char SIGNAL_EX;
 static unsigned char SIGNAL_IOC1;
 static unsigned char SIGNAL_IOC2;
@@ -151,9 +76,17 @@
 static int DDRAM;
 static int DUTY;
 
-/* Fixme: GPO's not yet implemented */
-static int GPOS;
-/* static int GPO=0; */
+/* maximum time to wait for the busy-flag (in usec) */
+#define MAX_BUSYFLAG_WAIT 10000
+
+/* maximum busy flag errors before falling back to busy-waiting */
+#define MAX_BUSYFLAG_ERRORS 20
+
+/* flag for busy-waiting vs. busy flag checking */
+static int UseBusy = 0;
+
+/* buffer holding the GPO state */
+static unsigned char GPO = 0;
 
 
 typedef struct {
@@ -171,33 +104,123 @@
 /***  hardware dependant functions    ***/
 /****************************************/
 
+static void drv_M5_busy(void)
+{
+    static unsigned int errors = 0;
+
+    unsigned char data = 0xFF;
+    unsigned char busymask = 0x88;
+    unsigned int counter;
+
+    /* set data-lines to input */
+    drv_generic_parport_direction(1);
+
+    /* clear I/OC1 and I/OC2, set R/W */
+    drv_generic_parport_control(SIGNAL_IOC1 | SIGNAL_IOC2 | SIGNAL_RW, SIGNAL_RW);
+
+    /* Control data setup time */
+    ndelay(T_SU);
+
+    counter = 0;
+    while (1) {
+
+	/* rise enable */
+	drv_generic_parport_control(SIGNAL_EX, SIGNAL_EX);
+
+	/* data output delay time */
+	ndelay(T_D);
+
+	/* read the busy flag */
+	data = drv_generic_parport_read();
+
+	/* lower enable */
+	/* as T_D is larger than T_W, we don't need to delay again */
+	drv_generic_parport_control(SIGNAL_EX, 0);
+
+	if ((data & busymask) == 0) {
+	    errors = 0;
+	    break;
+	}
+
+	/* make sure we don't wait forever
+	 * - but only check after 5 iterations
+	 * that way, we won't slow down normal mode
+	 * (where we don't need the timeout anyway) 
+	 */
+	counter++;
+
+	if (counter >= 5) {
+	    struct timeval now, end;
+
+	    if (counter == 5) {
+		/* determine the time when the timeout has expired */
+		gettimeofday(&end, NULL);
+		end.tv_usec += MAX_BUSYFLAG_WAIT;
+		while (end.tv_usec > 1000000) {
+		    end.tv_usec -= 1000000;
+		    end.tv_sec++;
+		}
+	    }
+
+	    /* get the current time */
+	    gettimeofday(&now, NULL);
+	    if (now.tv_sec == end.tv_sec ? now.tv_usec >= end.tv_usec : now.tv_sec >= end.tv_sec) {
+		error("%s: timeout waiting for busy flag (0x%02x)", Name, data);
+		if (++errors >= MAX_BUSYFLAG_ERRORS) {
+		    error("%s: too many busy flag failures, turning off busy flag checking.", Name);
+		    UseBusy = 0;
+		}
+		break;
+	    }
+	}
+    }
+
+    /* clear R/W */
+    drv_generic_parport_control(SIGNAL_RW, 0);
+
+    /* honour data hold time */
+    ndelay(T_H);
+
+    /* set data-lines to output */
+    drv_generic_parport_direction(0);
+
+}
+
+
 static void drv_M5_command(const unsigned int cmd, const int delay)
 {
 
+    if (UseBusy)
+	drv_M5_busy();
+
     /* put data on DB1..DB8 */
     drv_generic_parport_data(cmd & 0xff);
 
     /* set I/OC1 */
     /* set I/OC2 */
-    drv_generic_parport_control(SIGNAL_IOC1 | SIGNAL_IOC2, (cmd & 0x100 ? SIGNAL_IOC1 : 0) | (cmd & 0x200 ? SIGNAL_IOC2 : 0));
+    /* clear RW */
+    drv_generic_parport_control(SIGNAL_IOC1 | SIGNAL_IOC2 | SIGNAL_RW,
+				(cmd & 0x100 ? SIGNAL_IOC1 : 0) | (cmd & 0x200 ? SIGNAL_IOC2 : 0));
 
     /* Control data setup time */
-    ndelay(200);
+    ndelay(T_SU);
 
     /* send command */
-    /* EX signal pulse width = 500ns */
-    /* Fixme: why 500 ns? Datasheet says 200ns */
-    drv_generic_parport_toggle(SIGNAL_EX, 1, 500);
-
-    /* wait */
-    udelay(delay);
+    drv_generic_parport_toggle(SIGNAL_EX, 1, T_W);
 
+    if (UseBusy) {
+	/* honour data hold time */
+	ndelay(T_H);
+    } else {
+	/* wait for command completion */
+	udelay(delay);
+    }
 }
 
 
 static void drv_M5_clear(void)
 {
-    drv_M5_command(0x0001, 1250);	/* clear display */
+    drv_M5_command(0x0001, T_CLEAR);	/* clear display */
 }
 
 
@@ -213,11 +236,11 @@
 	pos = (row - 4) * (DDRAM >> DUTY) + (DDRAM >> DUTY) / 2 + col;
     }
 
-    drv_M5_command(0x300 | pos, 20);
+    drv_M5_command(0x300 | pos, T_EXEC);
 
     while (l--) {
 	cmd = *(unsigned char *) data++;
-	drv_M5_command(0x200 | cmd, 20);
+	drv_M5_command(0x200 | cmd, T_EXEC);
     }
 }
 
@@ -226,32 +249,40 @@
 {
     int i;
 
-    drv_M5_command(0x300 + DDRAM + 8 * (ascii - CHAR0), 20);
+    drv_M5_command(0x300 + DDRAM + 8 * (ascii - CHAR0), T_EXEC);
 
     for (i = 0; i < YRES; i++) {
-	drv_M5_command(0x200 | (matrix[i] & 0x3f), 20);
+	drv_M5_command(0x200 | (matrix[i] & 0x3f), T_EXEC);
     }
 }
 
 
-/* Fixme: GPO's */
-#if 0
-static void drv_M5_setGPO(const int bits)
+static int drv_M5_GPO(const int num, const int val)
 {
-    if (Lcd.gpos > 0) {
+    int v;
+
+    if (val > 0) {
+	/* set bit */
+	v = 1;
+	GPO |= 1 << num;
+    } else {
+	/* clear bit */
+	v = 0;
+	GPO &= ~(1 << num);
+    }
 
-	/* put data on DB1..DB8 */
-	drv_generic_parport_data(bits);
+    /* put data on DB1..DB8 */
+    drv_generic_parport_data(GPO);
 
-	/* 74HCT573 set-up time */
-	ndelay(20);
+    /* 74HCT573 set-up time */
+    ndelay(T_GPO_ST);
 
-	/* send data */
-	/* 74HCT573 enable pulse width = 24ns */
-	drv_generic_parport_toggle(SIGNAL_GPO, 1, 24);
-    }
+    /* send data */
+    /* 74HCT573 enable pulse width */
+    drv_generic_parport_toggle(SIGNAL_GPO, 1, T_GPO_PW);
+
+    return v;
 }
-#endif
 
 
 static int drv_M5_start(const char *section, const int quiet)
@@ -320,7 +351,7 @@
 
 
     if (DCOLS * DROWS > 256) {
-	error("%s: %s.Size '%dx%d' is too big, would require %d bytes", Name, section, DCOLS, DROWS, DCOLS * DROWS, cfg_source());
+	error("%s: %s.Size '%dx%d' is too big, would require %d bytes", Name, section, DCOLS, DROWS, DCOLS * DROWS);
 	return -1;
     } else if (DCOLS * DROWS > 224) {
 	DDRAM = 256;
@@ -345,13 +376,17 @@
     if (cfg_number(section, "GPOs", 0, 0, 8, &n) < 0)
 	return -1;
     GPOS = n;
-    info("%s: controlling %d GPO's", Name, GPOS);
+    if (GPOS > 0) {
+	info("%s: controlling %d GPO's", Name, GPOS);
+    }
 
     if (drv_generic_parport_open(section, Name) != 0) {
 	error("%s: could not initialize parallel port!", Name);
 	return -1;
     }
 
+    if ((SIGNAL_RW = drv_generic_parport_wire_ctrl("RW", "GND")) == 0xff)
+	return -1;
     if ((SIGNAL_EX = drv_generic_parport_wire_ctrl("EX", "STROBE")) == 0xff)
 	return -1;
     if ((SIGNAL_IOC1 = drv_generic_parport_wire_ctrl("IOC1", "SLCTIN")) == 0xff)
@@ -361,11 +396,52 @@
     if ((SIGNAL_GPO = drv_generic_parport_wire_ctrl("GPO", "GND")) == 0xff)
 	return -1;
 
+    /* Timings */
+
+    /* low level communication timings [nanoseconds]
+     * we use the worst-case default values, but allow
+     * modification from the config file.
+     */
+
+    T_SU = timing(Name, section, "SU", 200, "ns");	/* control data setup time */
+    T_W = timing(Name, section, "W", 500, "ns");	/* EX signal pulse width */
+    T_D = timing(Name, section, "D", 300, "ns");	/* Data output delay time */
+    T_H = timing(Name, section, "H", 100, "ns");	/* Data hold time */
+
+    /* GPO timing */
+    if (SIGNAL_GPO != 0) {
+	T_GPO_ST = timing(Name, section, "GPO_ST", 20, "ns");	/* 74HCT573 set-up time */
+	T_GPO_PW = timing(Name, section, "GPO_PW", 230, "ns");	/* 74HCT573 enable pulse width */
+    } else {
+	T_GPO_ST = 0;
+	T_GPO_PW = 0;
+    }
+
+    /* M50530 execution timings [microseconds]
+     * we use the worst-case default values, but allow
+     * modification from the config file.
+     */
+
+    T_EXEC = timing(Name, section, "EXEC", 20, "us");	/* normal execution time */
+    T_CLEAR = timing(Name, section, "CLEAR", 1250, "us");	/* 'clear display' execution time */
+    T_INIT = timing(Name, section, "INIT", 2000, "us");	/* mysterious initialization time */
+
+
+    /* maybe use busy-flag from now on  */
+    cfg_number(section, "UseBusy", 0, 0, 1, &UseBusy);
+
+    /* make sure we don't use the busy flag with RW wired to GND */
+    if (UseBusy && !SIGNAL_RW) {
+	error("%s: busy-flag checking is impossible with RW wired to GND!", Name);
+	UseBusy = 0;
+    }
+    info("%s: %susing busy-flag checking", Name, UseBusy ? "" : "not ");
+
     /* clear all signals */
-    drv_generic_parport_control(SIGNAL_EX | SIGNAL_IOC1 | SIGNAL_IOC2 | SIGNAL_GPO, 0);
+    drv_generic_parport_control(SIGNAL_RW | SIGNAL_EX | SIGNAL_IOC1 | SIGNAL_IOC2 | SIGNAL_GPO, 0);
 
     /* for some mysterious reason, this delay is necessary... */
-    udelay(2000);
+    udelay(T_INIT);
 
     /* set direction: write */
     drv_generic_parport_direction(0);
@@ -421,7 +497,7 @@
 
 
     debug("SET FUNCTION MODE 0x%02x", SF);
-    drv_M5_command(SF, 20);
+    drv_M5_command(SF, T_EXEC);
 
 
     /* set display (SD) mode:
@@ -437,7 +513,7 @@
 
     /* SD: 0x20 = 00100000 */
     /* SD: turn off display */
-    drv_M5_command(0x0020, 20);
+    drv_M5_command(0x0020, T_EXEC);
 
 
     /* set entry (SE) mode:
@@ -454,12 +530,12 @@
 
     /* SE: 0x50 = 01010000 */
     /* SE: increment display start after Write */
-    drv_M5_command(0x0050, 20);
+    drv_M5_command(0x0050, T_EXEC);
 
 
     /* SD: 0x30 = 00110000 */
     /* SD: turn on display */
-    drv_M5_command(0x0030, 20);
+    drv_M5_command(0x0030, T_EXEC);
 
 
     drv_M5_clear();
@@ -491,6 +567,7 @@
 /* using drv_generic_text_draw(W) */
 /* using drv_generic_text_icon_draw(W) */
 /* using drv_generic_text_bar_draw(W) */
+/* using drv_generic_gpio_draw(W) */
 
 
 /****************************************/
@@ -516,6 +593,8 @@
     WIDGET_CLASS wc;
     int ret;
 
+    info("%s: %s", Name, "$Rev: 840 $");
+
     /* display preferences */
     XRES = -1;			/* pixel width of one char  */
     YRES = -1;			/* pixel height of one char  */
@@ -526,6 +605,7 @@
     /* real worker functions */
     drv_generic_text_real_write = drv_M5_write;
     drv_generic_text_real_defchar = drv_M5_defchar;
+    drv_generic_gpio_real_set = drv_M5_GPO;
 
 
     /* start display */
@@ -547,6 +627,10 @@
     /* add fixed chars to the bar driver */
     drv_generic_text_bar_add_segment(0, 0, 255, 32);	/* ASCII  32 = blank */
 
+    /* initialize generic GPIO driver */
+    if ((ret = drv_generic_gpio_init(section, Name)) != 0)
+	return ret;
+
     /* register text widget */
     wc = Widget_Text;
     wc.draw = drv_generic_text_draw;
@@ -576,6 +660,7 @@
     info("%s: shutting down.", Name);
 
     drv_generic_text_quit();
+    drv_generic_gpio_quit();
 
     /* clear display */
     drv_M5_clear();
@@ -586,7 +671,7 @@
     }
 
     /* clear all signals */
-    drv_generic_parport_control(SIGNAL_EX | SIGNAL_IOC1 | SIGNAL_IOC2 | SIGNAL_GPO, 0);
+    drv_generic_parport_control(SIGNAL_RW | SIGNAL_EX | SIGNAL_IOC1 | SIGNAL_IOC2 | SIGNAL_GPO, 0);
 
     /* close port */
     drv_generic_parport_close();
@@ -596,8 +681,8 @@
 
 
 DRIVER drv_M50530 = {
-  name:Name,
-  list:drv_M5_list,
-  init:drv_M5_init,
-  quit:drv_M5_quit,
+    .name = Name,
+    .list = drv_M5_list,
+    .init = drv_M5_init,
+    .quit = drv_M5_quit,
 };
diff -urN lcd4linux-0.10.0/drv_MatrixOrbital.c lcd4linux-0.11.0-SVN/drv_MatrixOrbital.c
--- lcd4linux-0.10.0/drv_MatrixOrbital.c	2005-05-08 06:32:44.000000000 +0200
+++ lcd4linux-0.11.0-SVN/drv_MatrixOrbital.c	2008-12-31 08:05:54.000000000 +0100
@@ -1,8 +1,9 @@
-/* $Id: drv_MatrixOrbital.c,v 1.39 2005/05/08 04:32:44 reinelt Exp $
+/* $Id: drv_MatrixOrbital.c 840 2007-09-09 12:17:42Z michael $
+ * $URL: https://ssl.bulix.org/svn/lcd4linux/trunk/drv_MatrixOrbital.c $
  *
  * new style driver for Matrix Orbital serial display modules
  *
- * Copyright (C) 1999, 2000 Michael Reinelt <reinelt@eunet.at>
+ * Copyright (C) 1999, 2000 Michael Reinelt <michael@reinelt.co.at>
  * Copyright (C) 2004 The LCD4Linux Team <lcd4linux-devel@users.sourceforge.net>
  *
  * This file is part of LCD4Linux.
@@ -21,172 +22,6 @@
  * along with this program; if not, write to the Free Software
  * Foundation, Inc., 675 Mass Ave, Cambridge, MA 02139, USA.
  *
- *
- * $Log: drv_MatrixOrbital.c,v $
- * Revision 1.39  2005/05/08 04:32:44  reinelt
- * CodingStyle added and applied
- *
- * Revision 1.38  2005/01/22 12:44:41  reinelt
- * MatrixOrbital backlight micro-fix
- *
- * Revision 1.37  2005/01/18 06:30:23  reinelt
- * added (C) to all copyright statements
- *
- * Revision 1.36  2004/06/26 12:04:59  reinelt
- *
- * uh-oh... the last CVS log message messed up things a lot...
- *
- * Revision 1.35  2004/06/26 09:27:20  reinelt
- *
- * added '-W' to CFLAGS
- * changed all C++ comments to C ones
- * cleaned up a lot of signed/unsigned mistakes
- *
- * Revision 1.34  2004/06/26 06:12:15  reinelt
- *
- * support for Beckmann+Egle Compact Terminals
- * some mostly cosmetic changes in the MatrixOrbital and USBLCD driver
- * added debugging to the generic serial driver
- * fixed a bug in the generic text driver where icons could be drawn outside
- * the display bounds
- *
- * Revision 1.33  2004/06/20 10:09:54  reinelt
- *
- * 'const'ified the whole source
- *
- * Revision 1.32  2004/06/06 06:51:59  reinelt
- *
- * do not display end splash screen if quiet=1
- *
- * Revision 1.31  2004/06/05 06:41:39  reinelt
- *
- * chancged splash screen again
- *
- * Revision 1.30  2004/06/05 06:13:12  reinelt
- *
- * splash screen for all text-based display drivers
- *
- * Revision 1.29  2004/06/02 09:41:19  reinelt
- *
- * prepared support for startup splash screen
- *
- * Revision 1.28  2004/06/01 06:45:29  reinelt
- *
- * some Fixme's processed
- * documented some code
- *
- * Revision 1.27  2004/05/31 21:23:16  reinelt
- *
- * some cleanups in the MatrixOrbital driver
- *
- * Revision 1.26  2004/05/31 16:39:06  reinelt
- *
- * added NULL display driver (for debugging/profiling purposes)
- * added backlight/contrast initialisation for matrixOrbital
- * added Backlight initialisation for Cwlinux
- *
- * Revision 1.25  2004/05/31 05:38:02  reinelt
- *
- * fixed possible bugs with user-defined chars (clear high bits)
- * thanks to Andy Baxter for debugging the MilfordInstruments driver!
- *
- * Revision 1.24  2004/05/28 13:51:42  reinelt
- *
- * ported driver for Beckmann+Egle Mini-Terminals
- * added 'flags' parameter to serial_init()
- *
- * Revision 1.23  2004/05/27 03:39:47  reinelt
- *
- * changed function naming scheme to plugin::function
- *
- * Revision 1.22  2004/05/26 11:37:36  reinelt
- *
- * Curses driver ported.
- *
- * Revision 1.21  2004/03/19 09:17:46  reinelt
- *
- * removed the extra 'goto' function, row and col are additional parameters
- * of the write() function now.
- *
- * Revision 1.20  2004/02/14 11:56:17  reinelt
- * M50530 driver ported
- * changed lots of 'char' to 'unsigned char'
- *
- * Revision 1.19  2004/01/29 04:40:02  reinelt
- * every .c file includes "config.h" now
- *
- * Revision 1.18  2004/01/23 07:04:22  reinelt
- * icons finished!
- *
- * Revision 1.17  2004/01/23 04:53:50  reinelt
- * icon widget added (not finished yet!)
- *
- * Revision 1.16  2004/01/22 07:57:45  reinelt
- * several bugs fixed where segfaulting on layout>display
- * Crystalfontz driver optimized, 632 display already works
- *
- * Revision 1.15  2004/01/21 12:36:19  reinelt
- * Crystalfontz NextGeneration driver added
- *
- * Revision 1.14  2004/01/20 15:32:49  reinelt
- * first version of Next Generation HD44780 (untested! but it compiles...)
- * some cleanup in the other drivers
- *
- * Revision 1.13  2004/01/20 14:25:12  reinelt
- * some reorganization
- * moved drv_generic to drv_generic_serial
- * moved port locking stuff to drv_generic_serial
- *
- * Revision 1.12  2004/01/20 12:45:47  reinelt
- * "Default screen" working with MatrixOrbital
- *
- * Revision 1.11  2004/01/20 05:36:59  reinelt
- * moved text-display-specific stuff to drv_generic_text
- * moved all the bar stuff from drv_generic_bar to generic_text
- *
- * Revision 1.10  2004/01/20 04:51:39  reinelt
- * moved generic stuff from drv_MatrixOrbital to drv_generic
- * implemented new-stylish bars which are nearly finished
- *
- * Revision 1.9  2004/01/18 21:25:16  reinelt
- * Framework for bar widget opened
- *
- * Revision 1.8  2004/01/15 07:47:02  reinelt
- * debian/ postinst and watch added (did CVS forget about them?)
- * evaluator: conditional expressions (a?b:c) added
- * text widget nearly finished
- *
- * Revision 1.7  2004/01/14 11:33:00  reinelt
- * new plugin 'uname' which does what it's called
- * text widget nearly finished
- * first results displayed on MatrixOrbital
- *
- * Revision 1.6  2004/01/11 18:26:02  reinelt
- * further widget and layout processing
- *
- * Revision 1.5  2004/01/11 09:26:15  reinelt
- * layout starts to exist...
- *
- * Revision 1.4  2004/01/10 20:22:33  reinelt
- * added new function 'cfg_list()' (not finished yet)
- * added layout.c (will replace processor.c someday)
- * added widget_text.c (will be the first and most important widget)
- * modified lcd4linux.c so that old-style configs should work, too
- *
- * Revision 1.3  2004/01/10 17:34:40  reinelt
- * further matrixOrbital changes
- * widgets initialized
- *
- * Revision 1.2  2004/01/10 10:20:22  reinelt
- * new MatrixOrbital changes
- *
- * Revision 1.1  2004/01/09 17:03:07  reinelt
- * initiated transfer to new driver architecture
- * new file 'drv.c' will someday replace 'display.c'
- * new file 'drv_MatrixOrbital.c' will replace 'MatrixOrbital.c'
- * due to this 'soft' transfer lcd4linux should stay usable during the switch
- * (at least I hope so)
- *
  */
 
 /* 
@@ -203,6 +38,7 @@
 #include <stdio.h>
 #include <string.h>
 #include <unistd.h>
+#include <time.h>
 
 #include "debug.h"
 #include "cfg.h"
@@ -213,6 +49,7 @@
 #include "widget_bar.h"
 #include "drv.h"
 #include "drv_generic_text.h"
+#include "drv_generic_gpio.h"
 #include "drv_generic_serial.h"
 
 
@@ -221,16 +58,12 @@
 static int Model;
 static int Protocol;
 
-/* Fixme: GPO's not yet implemented */
-/* static int GPO[8]; */
-static int GPOS;
-
-
 typedef struct {
     int type;
     char *name;
     int rows;
     int cols;
+    int gpis;
     int gpos;
     int protocol;
 } MODEL;
@@ -239,32 +72,33 @@
 /* Fixme #2: protocol should be verified */
 
 static MODEL Models[] = {
-    {0x01, "LCD0821", 2, 8, 0, 1},
-    {0x03, "LCD2021", 2, 20, 0, 1},
-    {0x04, "LCD1641", 4, 16, 0, 1},
-    {0x05, "LCD2041", 4, 20, 0, 1},
-    {0x06, "LCD4021", 2, 40, 0, 1},
-    {0x07, "LCD4041", 4, 40, 0, 1},
-    {0x08, "LK202-25", 2, 20, 0, 2},
-    {0x09, "LK204-25", 4, 20, 0, 2},
-    {0x0a, "LK404-55", 4, 40, 0, 2},
-    {0x0b, "VFD2021", 2, 20, 0, 1},
-    {0x0c, "VFD2041", 4, 20, 0, 1},
-    {0x0d, "VFD4021", 2, 40, 0, 1},
-    {0x0e, "VK202-25", 2, 20, 0, 1},
-    {0x0f, "VK204-25", 4, 20, 0, 1},
-    {0x10, "GLC12232", -1, -1, 0, 1},
-    {0x13, "GLC24064", -1, -1, 0, 1},
-    {0x15, "GLK24064-25", -1, -1, 0, 1},
-    {0x22, "GLK12232-25", -1, -1, 0, 1},
-    {0x31, "LK404-AT", 4, 40, 0, 2},
-    {0x32, "VFD1621", 2, 16, 0, 1},
-    {0x33, "LK402-12", 2, 40, 0, 2},
-    {0x34, "LK162-12", 2, 16, 0, 2},
-    {0x35, "LK204-25PC", 4, 20, 0, 2},
-    {0x36, "LK202-24-USB", 2, 20, 0, 2},
-    {0x38, "LK204-24-USB", 4, 20, 0, 2},
-    {0xff, "Unknown", -1, -1, 0, 0}
+    {0x01, "LCD0821", 2, 8, 0, 1, 1},
+    {0x03, "LCD2021", 2, 20, 0, 1, 1},
+    {0x04, "LCD1641", 4, 16, 0, 1, 1},
+    {0x05, "LCD2041", 4, 20, 0, 1, 1},
+    {0x06, "LCD4021", 2, 40, 0, 1, 1},
+    {0x07, "LCD4041", 4, 40, 0, 1, 1},
+    {0x08, "LK202-25", 2, 20, 8, 8, 2},
+    {0x09, "LK204-25", 4, 20, 8, 8, 2},
+    {0x0a, "LK404-55", 4, 40, 8, 8, 2},
+    {0x0b, "VFD2021", 2, 20, 0, 1, 1},
+    {0x0c, "VFD2041", 4, 20, 0, 1, 1},
+    {0x0d, "VFD4021", 2, 40, 0, 1, 1},
+    {0x0e, "VK202-25", 2, 20, 0, 1, 1},
+    {0x0f, "VK204-25", 4, 20, 0, 1, 1},
+    {0x10, "GLC12232", -1, -1, 0, 1, 1},
+    {0x13, "GLC24064", -1, -1, 0, 1, 1},
+    {0x15, "GLK24064-25", -1, -1, 0, 1, 1},
+    {0x22, "GLK12232-25", -1, -1, 0, 1, 1},
+    {0x31, "LK404-AT", 4, 40, 8, 8, 2},
+    {0x32, "VFD1621", 2, 16, 0, 1, 1},
+    {0x33, "LK402-12", 2, 40, 8, 8, 2},
+    {0x34, "LK162-12", 2, 16, 8, 8, 2},
+    {0x35, "LK204-25PC", 4, 20, 8, 8, 2},
+    {0x36, "LK202-24-USB", 2, 20, 8, 8, 2},
+    {0x38, "LK204-24-USB", 4, 20, 8, 8, 2},
+    {0x39, "VK204-24-USB", 4, 20, 8, 8, 2},
+    {0xff, "Unknown", -1, -1, 0, 0, 0}
 };
 
 
@@ -361,111 +195,87 @@
 }
 
 
-static int drv_MO_gpo(int num, int val)
+static int drv_MO_GPI(const int num)
 {
-    static int GPO[6] = { -1, -1, -1, -1, -1, -1 };
-    char cmd[3] = "\376";
+    static int GPI[8] = { -1, -1, -1, -1, -1, -1, -1, -1 };
+    static time_t T[8], now;
 
-    if (num < 1)
-	num = 1;
-    if (num > 6)
-	num = 6;
-
-    /* -1 is used to query the current GPO */
-    if (val == -1)
-	return GPO[num - 1];
-
-    if (val < 0)
-	val = 0;
-    if (val > 1)
-	val = 1;
-    GPO[num - 1] = val;
+
+    if (num < 0 || num > 7) {
+	return 0;
+    }
+
+    /* read RPM every two seconds */
+    if (time(&now) - T[num] >= 2) {
+
+	char cmd[3];
+	unsigned char ans[7];
+
+	T[num] = now;
+
+	cmd[0] = '\376';
+	cmd[1] = '\301';
+	cmd[2] = (char) num + 1;
+	drv_generic_serial_write(cmd, 3);
+	usleep(100000);
+
+	if (drv_generic_serial_read((char *) ans, 7) == 7) {
+	    if (ans[0] == 0x23 && ans[1] == 0x2a && ans[2] == 0x03 && ans[3] == 0x52 && ans[4] == num + 1) {
+		GPI[num] = 18750000 / (256 * ans[5] + ans[6]);
+	    } else {
+		error("%s: strange answer %02x %02x %02x %02x %02x %02x %02x", Name, ans[0], ans[1], ans[2], ans[3],
+		      ans[4], ans[5], ans[6]);
+	    }
+	}
+    }
+
+    return GPI[num];
+}
+
+
+static int drv_MO_GPO(const int num, const int val)
+{
+    int v = 0;
+    char cmd[4];
 
     switch (Protocol) {
     case 1:
-	if (num == 1) {
+	if (num == 0) {
 	    if (val > 0) {
+		v = 1;
 		drv_generic_serial_write("\376W", 2);	/* GPO on */
 	    } else {
+		v = 0;
 		drv_generic_serial_write("\376V", 2);	/* GPO off */
 	    }
-	} else {
-	    GPO[num - 1] = -1;
 	}
 	break;
 
     case 2:
-	if (val > 0) {
+	if (val <= 0) {
+	    v = 0;
+	    cmd[0] = '\376';
+	    cmd[1] = 'V';	/* GPO off */
+	    cmd[2] = (char) num + 1;
+	    drv_generic_serial_write(cmd, 3);
+	} else if (val >= 255) {
+	    v = 255;
+	    cmd[0] = '\376';
 	    cmd[1] = 'W';	/* GPO on */
+	    cmd[2] = (char) num + 1;
+	    drv_generic_serial_write(cmd, 3);
 	} else {
-	    cmd[1] = 'V';	/* GPO off */
+	    v = val;
+	    cmd[0] = '\376';
+	    cmd[1] = '\300';	/* PWM control */
+	    cmd[2] = (char) num + 1;
+	    cmd[3] = (char) v;
+	    drv_generic_serial_write(cmd, 4);
 	}
-	cmd[2] = (char) num;
-	drv_generic_serial_write(cmd, 3);
 	break;
     }
 
-    return GPO[num - 1];
-}
-
-
-static int drv_MO_pwm(int num, int val)
-{
-    static int PWM[6] = { -1, -1, -1, -1, -1, -1 };
-    char cmd[4] = "\376\300";
-
-    if (num < 1)
-	num = 1;
-    if (num > 6)
-	num = 6;
-
-    /* -1 is used to query the current PWM */
-    if (val == -1)
-	return PWM[num - 1];
-
-    if (val < 0)
-	val = 0;
-    if (val > 255)
-	val = 255;
-    PWM[num - 1] = val;
-
-    cmd[2] = (char) num;
-    cmd[3] = (char) val;
-    drv_generic_serial_write(cmd, 4);
-
-    return val;
-}
-
-
-static int drv_MO_rpm(int num)
-{
-    static int RPM[6] = { -1, -1, -1, -1, -1, -1 };
-    char cmd[3] = "\376\301";
-    char buffer[7];
-
-    if (num < 1)
-	num = 1;
-    if (num > 6)
-	num = 6;
-
-    cmd[2] = (char) num;
-    drv_generic_serial_write(cmd, 3);
-
-    usleep(100000);
-    drv_generic_serial_read(buffer, 7);
-
-    debug("rpm: buffer[0]=0x%01x", buffer[0]);
-    debug("rpm: buffer[1]=0x%01x", buffer[1]);
-    debug("rpm: buffer[2]=0x%01x", buffer[2]);
-    debug("rpm: buffer[3]=0x%01x", buffer[3]);
-    debug("rpm: buffer[4]=0x%01x", buffer[4]);
-    debug("rpm: buffer[5]=0x%01x", buffer[5]);
-    debug("rpm: buffer[6]=0x%01x", buffer[6]);
-
-    /* Fixme: RPM calculations??? */
-    RPM[num - 1] = 42;
-
-    return RPM[num - 1];
+    return v;
 }
 
 
@@ -513,7 +323,8 @@
 
 	    /* auto-dedection matches specified model? */
 	    if (Models[i].type != 0xff && Model != i) {
-		error("%s: %s.Model '%s' from %s does not match dedected Model '%s'", Name, section, model, cfg_source(), Models[i].name);
+		error("%s: %s.Model '%s' from %s does not match dedected Model '%s'", Name, section, model,
+		      cfg_source(), Models[i].name);
 		return -1;
 	    }
 
@@ -525,6 +336,7 @@
     /* initialize global variables */
     DROWS = Models[Model].rows;
     DCOLS = Models[Model].cols;
+    GPIS = Models[Model].gpis;
     GPOS = Models[Model].gpos;
     Protocol = Models[Model].protocol;
 
@@ -618,55 +430,6 @@
 }
 
 
-static void plugin_gpo(RESULT * result, const int argc, RESULT * argv[])
-{
-    double gpo;
-
-    switch (argc) {
-    case 1:
-	gpo = drv_MO_gpo(R2N(argv[0]), -1);
-	SetResult(&result, R_NUMBER, &gpo);
-	break;
-    case 2:
-	gpo = drv_MO_gpo(R2N(argv[0]), R2N(argv[1]));
-	SetResult(&result, R_NUMBER, &gpo);
-	break;
-    default:
-	error("%s:gpo(): wrong number of parameters", Name);
-	SetResult(&result, R_STRING, "");
-    }
-}
-
-
-static void plugin_pwm(RESULT * result, const int argc, RESULT * argv[])
-{
-    double pwm;
-
-    switch (argc) {
-    case 1:
-	pwm = drv_MO_pwm(R2N(argv[0]), -1);
-	SetResult(&result, R_NUMBER, &pwm);
-	break;
-    case 2:
-	pwm = drv_MO_pwm(R2N(argv[0]), R2N(argv[1]));
-	SetResult(&result, R_NUMBER, &pwm);
-	break;
-    default:
-	error("%s:pwm(): wrong number of parameters", Name);
-	SetResult(&result, R_STRING, "");
-    }
-}
-
-
-static void plugin_rpm(RESULT * result, RESULT * arg1)
-{
-    double rpm;
-
-    rpm = drv_MO_rpm(R2N(arg1));
-    SetResult(&result, R_NUMBER, &rpm);
-}
-
-
 /****************************************/
 /***        widget callbacks          ***/
 /****************************************/
@@ -674,6 +437,7 @@
 /* using drv_generic_text_draw(W) */
 /* using drv_generic_text_icon_draw(W) */
 /* using drv_generic_text_bar_draw(W) */
+/* using drv_generic_gpio_draw(W) */
 
 
 /****************************************/
@@ -699,6 +463,8 @@
     WIDGET_CLASS wc;
     int ret;
 
+    info("%s: %s", Name, "$Rev: 840 $");
+
     /* display preferences */
     XRES = 5;			/* pixel width of one char  */
     YRES = 8;			/* pixel height of one char  */
@@ -709,6 +475,8 @@
     /* real worker functions */
     drv_generic_text_real_write = drv_MO_write;
     drv_generic_text_real_defchar = drv_MO_defchar;
+    drv_generic_gpio_real_get = drv_MO_GPI;
+    drv_generic_gpio_real_set = drv_MO_GPO;
 
 
     /* start display */
@@ -731,6 +499,10 @@
     drv_generic_text_bar_add_segment(0, 0, 255, 32);	/* ASCII  32 = blank */
     drv_generic_text_bar_add_segment(255, 255, 255, 255);	/* ASCII 255 = block */
 
+    /* initialize generic GPIO driver */
+    if ((ret = drv_generic_gpio_init(section, Name)) != 0)
+	return ret;
+
     /* register text widget */
     wc = Widget_Text;
     wc.draw = drv_generic_text_draw;
@@ -749,9 +521,6 @@
     /* register plugins */
     AddFunction("LCD::contrast", -1, plugin_contrast);
     AddFunction("LCD::backlight", -1, plugin_backlight);
-    AddFunction("LCD::gpo", -1, plugin_gpo);
-    AddFunction("LCD::pwm", -1, plugin_pwm);
-    AddFunction("LCD::rpm", 1, plugin_rpm);
 
     return 0;
 }
@@ -761,9 +530,10 @@
 int drv_MO_quit(const int quiet)
 {
 
-    info("%s: shutting down.", Name);
+    info("%s: shutting down display.", Name);
 
     drv_generic_text_quit();
+    drv_generic_gpio_quit();
 
     /* clear display */
     drv_MO_clear();
@@ -780,8 +550,8 @@
 
 
 DRIVER drv_MatrixOrbital = {
-  name:Name,
-  list:drv_MO_list,
-  init:drv_MO_init,
-  quit:drv_MO_quit,
+    .name = Name,
+    .list = drv_MO_list,
+    .init = drv_MO_init,
+    .quit = drv_MO_quit,
 };
diff -urN lcd4linux-0.10.0/drv_MilfordInstruments.c lcd4linux-0.11.0-SVN/drv_MilfordInstruments.c
--- lcd4linux-0.10.0/drv_MilfordInstruments.c	2005-05-08 06:32:44.000000000 +0200
+++ lcd4linux-0.11.0-SVN/drv_MilfordInstruments.c	2008-12-31 08:05:54.000000000 +0100
@@ -1,4 +1,5 @@
-/* $Id: drv_MilfordInstruments.c,v 1.14 2005/05/08 04:32:44 reinelt Exp $
+/* $Id: drv_MilfordInstruments.c 840 2007-09-09 12:17:42Z michael $
+ * $URL: https://ssl.bulix.org/svn/lcd4linux/trunk/drv_MilfordInstruments.c $
  *
  * driver for Milford Instruments 'BPK' piggy-back serial interface board
  * for standard Hitachi 44780 compatible lcd modules.
@@ -7,7 +8,7 @@
  * Copyright (C) 2004 The LCD4Linux Team <lcd4linux-devel@users.sourceforge.net>
  *
  * based on the MatrixOrbital driver which is
- * Copyright (C) 1999, 2000 Michael Reinelt <reinelt@eunet.at>
+ * Copyright (C) 1999, 2000 Michael Reinelt <michael@reinelt.co.at>
  *
  * This file is part of LCD4Linux.
  *
@@ -25,60 +26,6 @@
  * along with this program; if not, write to the Free Software
  * Foundation, Inc., 675 Mass Ave, Cambridge, MA 02139, USA.
  *
- *
- * $Log: drv_MilfordInstruments.c,v $
- * Revision 1.14  2005/05/08 04:32:44  reinelt
- * CodingStyle added and applied
- *
- * Revision 1.13  2005/01/18 06:30:23  reinelt
- * added (C) to all copyright statements
- *
- * Revision 1.12  2004/06/26 12:04:59  reinelt
- *
- * uh-oh... the last CVS log message messed up things a lot...
- *
- * Revision 1.11  2004/06/26 09:27:21  reinelt
- *
- * added '-W' to CFLAGS
- * changed all C++ comments to C ones
- * cleaned up a lot of signed/unsigned mistakes
- *
- * Revision 1.10  2004/06/20 10:09:54  reinelt
- *
- * 'const'ified the whole source
- *
- * Revision 1.9  2004/06/06 06:51:59  reinelt
- *
- * do not display end splash screen if quiet=1
- *
- * Revision 1.8  2004/06/05 06:41:40  reinelt
- *
- * chancged splash screen again
- *
- * Revision 1.7  2004/06/05 06:13:12  reinelt
- *
- * splash screen for all text-based display drivers
- *
- * Revision 1.6  2004/06/02 09:41:19  reinelt
- *
- * prepared support for startup splash screen
- *
- * Revision 1.5  2004/05/31 05:38:02  reinelt
- *
- * fixed possible bugs with user-defined chars (clear high bits)
- * thanks to Andy Baxter for debugging the MilfordInstruments driver!
- *
- * Revision 1.4  2004/05/31 01:31:01  andy-b
- *
- *
- * fixed bug in Milford Instruments driver which drew extra graphics chars in
- * odd places when drawing double bars. (the display doesn't like it if you put
- * the escape character 0xfe inside a define char sequence).
- *
- * Revision 1.1  2004/05/26 05:03:27  reinelt
- *
- * MilfordInstruments driver ported
- *
  */
 
 /* 
@@ -252,6 +199,8 @@
     WIDGET_CLASS wc;
     int ret;
 
+    info("%s: %s", Name, "$Rev: 840 $");
+
     /* display preferences */
     XRES = 5;			/* pixel width of one char  */
     YRES = 8;			/* pixel height of one char  */
@@ -329,8 +278,8 @@
 
 
 DRIVER drv_MilfordInstruments = {
-  name:Name,
-  list:drv_MI_list,
-  init:drv_MI_init,
-  quit:drv_MI_quit,
+    .name = Name,
+    .list = drv_MI_list,
+    .init = drv_MI_init,
+    .quit = drv_MI_quit,
 };
diff -urN lcd4linux-0.10.0/drv_Noritake.c lcd4linux-0.11.0-SVN/drv_Noritake.c
--- lcd4linux-0.10.0/drv_Noritake.c	2005-05-08 06:32:44.000000000 +0200
+++ lcd4linux-0.11.0-SVN/drv_Noritake.c	2008-12-31 08:05:54.000000000 +0100
@@ -1,4 +1,5 @@
-/* $Id: drv_Noritake.c,v 1.4 2005/05/08 04:32:44 reinelt Exp $
+/* $Id: drv_Noritake.c 771 2007-02-25 12:27:26Z michael $
+ * $URL: https://ssl.bulix.org/svn/lcd4linux/trunk/drv_Noritake.c $
  * 
  * Driver for a Noritake GU128x32-311 graphical display.
  * 
@@ -21,25 +22,6 @@
  * along with this program; if not, write to the Free Software
  * Foundation, Inc., 675 Mass Ave, Cambridge, MA 02139, USA.
  *
- * $Log: drv_Noritake.c,v $
- * Revision 1.4  2005/05/08 04:32:44  reinelt
- * CodingStyle added and applied
- *
- * Revision 1.3  2005/05/05 08:36:12  reinelt
- * changed SELECT to SLCTIN
- *
- * Revision 1.2  2005/05/04 07:18:44  obconseil
- * Driver modified according to Michels's recommendations :
- *
- * - Suppressed linux/parport.h depandancy. It was not needed anyway.
- * - Compile-time disable the wait_busy polling function, replaced with a time wait.
- * - Replaced the hardwire_* calls by their wire_* equivalent, to adapt other wirings.
- * - Created a "Models" structure, containing parameters for the display.
- * - Other cleanups, to remove compile-time warnings.
- *
- * Revision 1.1  2005/05/04 05:42:38  reinelt
- * Noritake driver added
- *
  */
 
 /*
@@ -121,8 +103,12 @@
 static unsigned char SIGNAL_WR;	/* Write        OUTPUT, negative logic, pport STOBE */
 static unsigned char SIGNAL_RESET;	/* Reset,       OUTPUT, negative logic, pport INIT */
 static unsigned char SIGNAL_BLANK;	/* Blank,       OUTPUT , negative logic, pport SELECT-IN */
-																																																																																		       /* static unsigned char SIGNAL_BUSY; *//* Busy,        INPUT , positive logic, pport BUSY, not used */
-																																																																																       /* static unsigned char SIGNAL_FRP; *//* Frame Pulse, INPUT , positive logic, pport ACK, not used */
+
+#if 0
+static unsigned char SIGNAL_BUSY;	/* Busy,        INPUT , positive logic, pport BUSY, not used */
+static unsigned char SIGNAL_FRP;	/* Frame Pulse, INPUT , positive logic, pport ACK, not used */
+#endif
+
 void (*drv_Noritake_clear) (void);
 
 /* Data port is positive logic */
@@ -154,8 +140,10 @@
 
 static void drv_GU311_send_char(char c)
 {
-    //drv_GU311_wait_busy(); /* ensuite the display is ready to take the command */
+#if 0
     /* Disabled because all the cables does not have the busy line linked. */
+    drv_GU311_wait_busy();	/* ensuite the display is ready to take the command */
+#endif
     drv_generic_parport_data(c);
     ndelay(30);			/* delay to ensure data line stabilisation on long cables */
     drv_generic_parport_control(SIGNAL_WR, 0);	/* write line to enable */
@@ -342,6 +330,8 @@
     WIDGET_CLASS wc;
     int ret;
 
+    info("%s: %s", Name, "$Rev: 771 $");
+
     /* start display */
     if ((ret = drv_Noritake_start(section)) != 0)
 	return ret;
@@ -392,8 +382,8 @@
 
 
 DRIVER drv_Noritake = {
-  name:Name,
-  list:drv_Noritake_list,
-  init:drv_Noritake_init,
-  quit:drv_Noritake_quit,
+    .name = Name,
+    .list = drv_Noritake_list,
+    .init = drv_Noritake_init,
+    .quit = drv_Noritake_quit,
 };
diff -urN lcd4linux-0.10.0/drv_NULL.c lcd4linux-0.11.0-SVN/drv_NULL.c
--- lcd4linux-0.10.0/drv_NULL.c	2005-05-08 06:32:44.000000000 +0200
+++ lcd4linux-0.11.0-SVN/drv_NULL.c	2008-12-31 08:05:54.000000000 +0100
@@ -1,8 +1,9 @@
-/* $Id: drv_NULL.c,v 1.8 2005/05/08 04:32:44 reinelt Exp $
+/* $Id: drv_NULL.c 840 2007-09-09 12:17:42Z michael $
+ * $URL: https://ssl.bulix.org/svn/lcd4linux/trunk/drv_NULL.c $
  *
  * NULL driver (for testing)
  *
- * Copyright (C) 2004 Michael Reinelt <reinelt@eunet.at>
+ * Copyright (C) 2004 Michael Reinelt <michael@reinelt.co.at>
  * Copyright (C) 2004 The LCD4Linux Team <lcd4linux-devel@users.sourceforge.net>
  *
  * This file is part of LCD4Linux.
@@ -21,42 +22,6 @@
  * along with this program; if not, write to the Free Software
  * Foundation, Inc., 675 Mass Ave, Cambridge, MA 02139, USA.
  *
- *
- * $Log: drv_NULL.c,v $
- * Revision 1.8  2005/05/08 04:32:44  reinelt
- * CodingStyle added and applied
- *
- * Revision 1.7  2005/01/18 06:30:23  reinelt
- * added (C) to all copyright statements
- *
- * Revision 1.6  2004/06/26 12:04:59  reinelt
- *
- * uh-oh... the last CVS log message messed up things a lot...
- *
- * Revision 1.5  2004/06/26 09:27:21  reinelt
- *
- * added '-W' to CFLAGS
- * changed all C++ comments to C ones
- * cleaned up a lot of signed/unsigned mistakes
- *
- * Revision 1.4  2004/06/20 10:09:54  reinelt
- *
- * 'const'ified the whole source
- *
- * Revision 1.3  2004/06/06 06:51:59  reinelt
- *
- * do not display end splash screen if quiet=1
- *
- * Revision 1.2  2004/06/02 09:41:19  reinelt
- *
- * prepared support for startup splash screen
- *
- * Revision 1.1  2004/05/31 16:39:06  reinelt
- *
- * added NULL display driver (for debugging/profiling purposes)
- * added backlight/contrast initialisation for matrixOrbital
- * added Backlight initialisation for Cwlinux
- *
  */
 
 /* 
@@ -119,7 +84,7 @@
 	return -1;
     }
     if (sscanf(s, "%dx%d", &DCOLS, &DROWS) != 2 || DROWS < 1 || DCOLS < 1) {
-	error("%s: bad %s.Size '%s' from %s", Name, section, s, cfg_source);
+	error("%s: bad %s.Size '%s' from %s", Name, section, s, cfg_source());
 	free(s);
 	return -1;
     }
@@ -164,6 +129,8 @@
     WIDGET_CLASS wc;
     int ret;
 
+    info("%s: %s", Name, "$Rev: 840 $");
+
     /* display preferences */
     XRES = 6;			/* pixel width of one char  */
     YRES = 8;			/* pixel height of one char  */
@@ -221,8 +188,8 @@
 
 
 DRIVER drv_NULL = {
-  name:Name,
-  list:drv_NULL_list,
-  init:drv_NULL_init,
-  quit:drv_NULL_quit,
+    .name = Name,
+    .list = drv_NULL_list,
+    .init = drv_NULL_init,
+    .quit = drv_NULL_quit,
 };
diff -urN lcd4linux-0.10.0/drv_Pertelian.c lcd4linux-0.11.0-SVN/drv_Pertelian.c
--- lcd4linux-0.10.0/drv_Pertelian.c	1970-01-01 01:00:00.000000000 +0100
+++ lcd4linux-0.11.0-SVN/drv_Pertelian.c	2008-12-31 08:05:54.000000000 +0100
@@ -0,0 +1,331 @@
+/* $Id: drv_Pertelian.c 908 2008-12-24 08:28:24Z michael $
+ * $URL: https://ssl.bulix.org/svn/lcd4linux/trunk/drv_Pertelian.c $
+ *
+ * Pertelian lcd4linux driver
+ * Copyright (C) 2007 Andy Powell <lcd4linux@automted.it> 
+ *
+ * Copyright (C) 2005 Michael Reinelt <michael@reinelt.co.at>
+ * Copyright (C) 2005, 2006, 2007 The LCD4Linux Team <lcd4linux-devel@users.sourceforge.net>
+ *
+ * This file is part of LCD4Linux.
+ *
+ * LCD4Linux is free software; you can redistribute it and/or modify
+ * it under the terms of the GNU General Public License as published by
+ * the Free Software Foundation; either version 2, or (at your option)
+ * any later version.
+ *
+ * LCD4Linux is distributed in the hope that it will be useful,
+ * but WITHOUT ANY WARRANTY; without even the implied warranty of
+ * MERCHANTABILITY or FITNESS FOR A PARTICULAR PURPOSE.  See the
+ * GNU General Public License for more details.
+ *
+ * You should have received a copy of the GNU General Public License
+ * along with this program; if not, write to the Free Software
+ * Foundation, Inc., 675 Mass Ave, Cambridge, MA 02139, USA.
+ *
+ */
+
+/* 
+ *
+ * exported fuctions:
+ *
+ * struct DRIVER drv_Pertelian
+ *
+ */
+
+#include "config.h"
+
+#include <stdlib.h>
+#include <stdio.h>
+#include <unistd.h>
+#include <string.h>
+#include <errno.h>
+
+#include "debug.h"
+#include "cfg.h"
+#include "qprintf.h"
+#include "udelay.h"
+#include "plugin.h"
+#include "widget.h"
+#include "widget_text.h"
+#include "widget_icon.h"
+#include "widget_bar.h"
+#include "drv.h"
+
+#include "drv_generic_text.h"
+#include "drv_generic_serial.h"
+
+static char Name[] = "Pertelian";
+
+static unsigned char rowoffset[4] = { 0x80, 0x80 + 0x40, 0x80 + 0x14, 0x80 + 0x40 + 0x14 };
+
+#define PERTELIAN_LCDCOMMAND 0xfe
+
+/****************************************/
+/***  hardware dependant functions    ***/
+/****************************************/
+
+
+static int drv_Pertelian_open(const char *section)
+{
+    if (drv_generic_serial_open(section, Name, 0) < 0)
+	return -1;
+    return 0;
+}
+
+
+static int drv_Pertelian_close(void)
+{
+    drv_generic_serial_close();
+    return 0;
+}
+
+
+static void drv_Pertelian_send(const char *data, const unsigned int len)
+{
+    unsigned int i;
+
+    /* Pertelian interface seems to offer no buffering at all
+       so we have to slow things down a tad yes 1usec is enough  */
+
+    for (i = 0; i < len; i++) {
+	drv_generic_serial_write(&data[i], 1);
+	usleep(100);
+    }
+}
+
+
+static void drv_Pertelian_clear(void)
+{
+    char cmd[2];
+
+    cmd[0] = PERTELIAN_LCDCOMMAND;
+    cmd[1] = 0x01;
+    drv_Pertelian_send(cmd, 2);
+}
+
+
+static void drv_Pertelian_write(const int row, const int col, const char *data, int len)
+{
+    char cmd[3];
+
+    cmd[0] = PERTELIAN_LCDCOMMAND;
+    cmd[1] = ((rowoffset[row]) + (col));
+    drv_Pertelian_send(cmd, 2);
+    drv_Pertelian_send(data, len);
+}
+
+
+static void drv_Pertelian_defchar(const int ascii, const unsigned char *matrix)
+{
+    char cmd[11] = "";
+    int i;
+
+    cmd[0] = PERTELIAN_LCDCOMMAND;
+    cmd[1] = (0x40 + (8 * ascii));
+    for (i = 0; i < 8; i++) {
+	cmd[i + 2] = matrix[i] & 0x1f;
+    }
+    drv_Pertelian_send(cmd, 10);
+}
+
+
+static int drv_Pertelian_backlight(int backlight)
+{
+    char cmd[2];
+
+    if (backlight <= 0)
+	backlight = 2;
+    else if (backlight >= 1)
+	backlight = 3;
+
+    cmd[0] = PERTELIAN_LCDCOMMAND;
+    cmd[1] = backlight;
+
+    drv_Pertelian_send(cmd, 2);
+
+    return backlight;
+}
+
+
+static int drv_Pertelian_start(const char *section)
+{
+    int backlight;
+    int rows = -1, cols = -1;
+    char *s;
+    char cmd[12] = "";
+
+    s = cfg_get(section, "Size", NULL);
+    if (s == NULL || *s == '\0') {
+	error("%s: no '%s.Size' entry from %s", Name, section, cfg_source());
+	return -1;
+    }
+    if (sscanf(s, "%dx%d", &cols, &rows) != 2 || rows < 1 || cols < 1) {
+	error("%s: bad %s.Size '%s' from %s", Name, section, s, cfg_source());
+	free(s);
+	return -1;
+    }
+
+    DROWS = rows;
+    DCOLS = cols;
+
+    /* open communication with the display */
+    if (drv_Pertelian_open(section) < 0) {
+	return -1;
+    }
+
+    /* reset & initialize display */
+    cmd[0] = PERTELIAN_LCDCOMMAND;
+    cmd[1] = 0x38;
+    cmd[2] = PERTELIAN_LCDCOMMAND;
+    cmd[3] = 0x06;
+    cmd[4] = PERTELIAN_LCDCOMMAND;
+    cmd[5] = 0x10;		/* move cursor on data write */
+    cmd[6] = PERTELIAN_LCDCOMMAND;
+    cmd[7] = 0x0c;
+    cmd[8] = 0x0c;
+
+    drv_Pertelian_send(cmd, 8);
+
+    if (cfg_number(section, "Backlight", 0, 0, 1, &backlight) > 0) {
+	drv_Pertelian_backlight(backlight);
+    }
+
+    drv_Pertelian_clear();	/* clear display */
+    return 0;
+}
+
+
+/****************************************/
+/***            plugins               ***/
+/****************************************/
+
+static void plugin_backlight(RESULT * result, RESULT * arg1)
+{
+    double backlight = 0;
+    backlight = drv_Pertelian_backlight(R2N(arg1));
+    SetResult(&result, R_NUMBER, &backlight);
+}
+
+/****************************************/
+/***        widget callbacks          ***/
+/****************************************/
+
+
+/* using drv_generic_text_draw(W) */
+/* using drv_generic_text_icon_draw(W) */
+/* using drv_generic_text_bar_draw(W) */
+/* using drv_generic_gpio_draw(W) */
+
+
+/****************************************/
+/***        exported functions        ***/
+/****************************************/
+
+
+/* list models */
+int drv_Pertelian_list(void)
+{
+    printf("generic");
+    return 0;
+}
+
+
+/* initialize driver & display */
+int drv_Pertelian_init(const char *section, const int quiet)
+{
+    WIDGET_CLASS wc;
+    int ret;
+
+    info("%s: %s", Name, "$Rev: 908 $");
+
+    /* display preferences */
+    XRES = 5;			/* pixel width of one char  */
+    YRES = 8;			/* pixel height of one char  */
+    CHARS = 8;			/* number of user-defineable characters */
+    CHAR0 = 0;			/* ASCII of first user-defineable char */
+    GOTO_COST = 2;		/* number of bytes a goto command requires */
+
+    /* real worker functions */
+    drv_generic_text_real_write = drv_Pertelian_write;
+    drv_generic_text_real_defchar = drv_Pertelian_defchar;
+
+
+    /* start display */
+    if ((ret = drv_Pertelian_start(section)) != 0)
+	return ret;
+
+    if (!quiet) {
+	char buffer[40];
+	qprintf(buffer, sizeof(buffer), "%s %dx%d", Name, DCOLS, DROWS);
+	if (drv_generic_text_greet(buffer, "LinITX.com")) {
+	    sleep(3);
+	    drv_Pertelian_clear();
+	}
+    }
+
+    /* initialize generic text driver */
+    if ((ret = drv_generic_text_init(section, Name)) != 0)
+	return ret;
+
+    /* initialize generic icon driver */
+    if ((ret = drv_generic_text_icon_init()) != 0)
+	return ret;
+
+    /* initialize generic bar driver */
+    if ((ret = drv_generic_text_bar_init(0)) != 0)
+	return ret;
+
+    /* add fixed chars to the bar driver */
+    drv_generic_text_bar_add_segment(0, 0, 255, 32);	/* ASCII  32 = blank */
+
+
+    /* register text widget */
+    wc = Widget_Text;
+    wc.draw = drv_generic_text_draw;
+    widget_register(&wc);
+
+    /* register icon widget */
+    wc = Widget_Icon;
+    wc.draw = drv_generic_text_icon_draw;
+    widget_register(&wc);
+
+    /* register bar widget */
+    wc = Widget_Bar;
+    wc.draw = drv_generic_text_bar_draw;
+    widget_register(&wc);
+    AddFunction("LCD::backlight", 1, plugin_backlight);
+    return 0;
+}
+
+
+/* close driver & display */
+int drv_Pertelian_quit(const int quiet)
+{
+
+    info("%s: shutting down.", Name);
+
+    drv_generic_text_quit();
+
+    /* clear display */
+    drv_Pertelian_clear();
+
+    /* say goodbye... */
+    if (!quiet) {
+	drv_generic_text_greet("goodbye!", NULL);
+    }
+
+    drv_Pertelian_backlight(0);
+    debug("closing connection");
+    drv_Pertelian_close();
+
+    return (0);
+}
+
+
+DRIVER drv_Pertelian = {
+    .name = Name,
+    .list = drv_Pertelian_list,
+    .init = drv_Pertelian_init,
+    .quit = drv_Pertelian_quit,
+};
diff -urN lcd4linux-0.10.0/drv_PHAnderson.c lcd4linux-0.11.0-SVN/drv_PHAnderson.c
--- lcd4linux-0.10.0/drv_PHAnderson.c	1970-01-01 01:00:00.000000000 +0100
+++ lcd4linux-0.11.0-SVN/drv_PHAnderson.c	2008-12-31 08:05:54.000000000 +0100
@@ -0,0 +1,416 @@
+/* $Id: drv_PHAnderson.c 840 2008-11-19 23:56:42 guimli $
+ * $URL: https://ssl.bulix.org/svn/lcd4linux/trunk/drv_PHAnderson.c $
+ *
+ * driver for the PHAnderson serial-to-HD44780 adapter boards
+ * http://www.phanderson.com/lcd106/lcd107.html
+ * http://moderndevice.com/Docs/LCD117CommandSummary.doc
+ * http://wulfden.org/TheShoppe/k107/index.shtml
+ *
+ * Copyright (C) 2008 Nicolas Weill <guimli@free.fr>
+ * Copyright (C) 2005 The LCD4Linux Team <lcd4linux-devel@users.sourceforge.net>
+ *
+ * This file is part of LCD4Linux.
+ *
+ * LCD4Linux is free software; you can redistribute it and/or modify
+ * it under the terms of the GNU General Public License as published by
+ * the Free Software Foundation; either version 2, or (at your option)
+ * any later version.
+ *
+ * LCD4Linux is distributed in the hope that it will be useful,
+ * but WITHOUT ANY WARRANTY; without even the implied warranty of
+ * MERCHANTABILITY or FITNESS FOR A PARTICULAR PURPOSE.  See the
+ * GNU General Public License for more details.
+ *
+ * You should have received a copy of the GNU General Public License
+ * along with this program; if not, write to the Free Software
+ * Foundation, Inc., 675 Mass Ave, Cambridge, MA 02139, USA.
+ *
+ */
+
+/* 
+ *
+ * exported fuctions:
+ *
+ * struct DRIVER drv_PHAnderson
+ *
+ */
+
+#include "config.h"
+
+#include <stdlib.h>
+#include <unistd.h>
+#include <string.h>
+
+#include "debug.h"
+#include "cfg.h"
+#include "qprintf.h"
+#include "udelay.h"
+#include "plugin.h"
+#include "widget.h"
+#include "widget_text.h"
+#include "widget_icon.h"
+#include "widget_bar.h"
+#include "drv.h"
+#include "drv_generic_text.h"
+#include "drv_generic_serial.h"
+
+#define PHAnderson_CMD  '?'
+
+static char Name[] = "PHAnderson";
+
+static int T_READ, T_WRITE, T_BOOT;
+
+
+/****************************************/
+/***  hardware dependant functions    ***/
+/****************************************/
+
+static int drv_PHAnderson_open(const char *section)
+{
+    if (drv_generic_serial_open(section, Name, 0) < 0)
+	return -1;
+
+    return 0;
+}
+
+
+static int drv_PHAnderson_close(void)
+{
+    drv_generic_serial_close();
+
+    return 0;
+}
+
+
+static void drv_PHAnderson_send(const char *data, const unsigned int len)
+{
+    char buffer[255];
+    unsigned int i, j;
+
+    j = 0;
+    for (i = 0; i < len; i++) {
+	if (data[i] < 8) {
+	    buffer[j++] = '?';
+	    buffer[j++] = '0' + data[i];
+	    drv_generic_serial_write(buffer, j);
+	    udelay(T_READ);
+
+	    j = 0;
+	} else {
+	    buffer[j++] = data[i];
+	}
+    }
+
+    if (j > 0) {
+	drv_generic_serial_write(buffer, j);
+    }
+}
+
+
+static void drv_PHAnderson_clear(void)
+{
+    char cmd[2];
+
+    cmd[0] = '?';
+    cmd[1] = 'f';
+    drv_PHAnderson_send(cmd, 2);
+}
+
+
+static void drv_PHAnderson_write(const int row, const int col, const char *data, int len)
+{
+    char cmd[7];
+
+    cmd[0] = '?';
+    cmd[1] = 'y';
+    cmd[2] = row + '0';
+    cmd[3] = '?';
+    cmd[4] = 'x';
+    cmd[5] = col / 10 + '0';
+    cmd[6] = col % 10 + '0';
+    drv_PHAnderson_send(cmd, 7);
+
+    drv_PHAnderson_send(data, len);
+}
+
+
+static void drv_PHAnderson_defchar(const int ascii, const unsigned char *matrix)
+{
+    char cmd[19];
+    int i;
+
+    cmd[0] = '?';
+    cmd[1] = 'D';
+    cmd[2] = ascii + '0';
+
+    for (i = 0; i < 8; i++) {
+	cmd[i * 2 + 3] = ((matrix[i] >> 4) & 1) + '0';
+	cmd[i * 2 + 4] = (((matrix[i] & 0x0F) < 10) ? (matrix[i] & 0x0F) + '0' : (matrix[i] & 0x0F) + '7');
+    }
+    drv_PHAnderson_send(cmd, 19);
+    udelay(T_WRITE);
+}
+
+
+static int drv_PHAnderson_blacklight(int blacklight)
+{
+    char cmd[4];
+
+    if (blacklight < 0)
+	blacklight = 0;
+    if (blacklight > 255)
+	blacklight = 255;
+
+    cmd[0] = '?';
+    cmd[1] = 'B';
+    cmd[2] = (((blacklight >> 4) < 10) ? (blacklight >> 4) + '0' : (blacklight >> 4) + '7');
+    cmd[3] = (((blacklight & 0x0F) < 10) ? (blacklight & 0x0F) + '0' : (blacklight & 0x0F) + '7');
+    drv_PHAnderson_send(cmd, 4);
+    udelay(T_WRITE);
+
+    return blacklight;
+}
+
+static int drv_PHAnderson_bootscreen(const char *bootmsg)
+{
+    char cmd[255];
+    int i, j, k;
+
+    i = 0;
+    j = 0;
+    k = 0;
+
+    if (bootmsg == NULL || *bootmsg == '\0') {
+	cmd[0] = '?';
+	cmd[1] = 'S';
+	cmd[2] = '0';
+	drv_PHAnderson_send(cmd, 3);
+	udelay(T_WRITE);
+    } else {
+	cmd[0] = '?';
+	cmd[1] = 'S';
+	cmd[2] = '2';
+	drv_PHAnderson_send(cmd, 3);
+	udelay(T_WRITE);
+	cmd[0] = '?';
+	cmd[1] = 'C';
+	for (i = 0; i < DROWS; i++) {
+	    cmd[2] = '0' + i;
+	    for (k = 0; k < DCOLS; k++) {
+		if (bootmsg[j] != '\0') {
+		    cmd[3 + k] = bootmsg[j];
+		    j++;
+		} else {
+		    cmd[3 + k] = ' ';
+		}
+	    }
+	    drv_PHAnderson_send(cmd, k + 3);
+	    udelay(T_BOOT);
+	}
+    }
+
+    return j;
+}
+
+static int drv_PHAnderson_start(const char *section)
+{
+    int blacklight;
+    int rows = -1, cols = -1;
+    char *s;
+    char cmd[255];
+
+    s = cfg_get(section, "Size", NULL);
+    if (s == NULL || *s == '\0') {
+	error("%s: no '%s.Size' entry from %s", Name, section, cfg_source());
+	return -1;
+    }
+    if (sscanf(s, "%dx%d", &cols, &rows) != 2 || rows < 1 || cols < 1) {
+	error("%s: bad %s.Size '%s' from %s", Name, section, s, cfg_source());
+	free(s);
+	return -1;
+    }
+
+    DROWS = rows;
+    DCOLS = cols;
+
+    /* PHAnderson execution timings [milliseconds]
+     * we use the worst-case default values, but allow
+     * modification from the config file.
+     */
+
+    T_WRITE = timing(Name, section, "WRITE", 170, "ms") * 1000;	/* write eeprom time */
+    T_READ = timing(Name, section, "READ", 10, "ms") * 1000;	/* read eeprom time */
+    T_BOOT = timing(Name, section, "BOOT", 300, "ms") * 1000;	/* boot screen write eeprom time */
+
+    if (drv_PHAnderson_open(section) < 0) {
+	return -1;
+    }
+
+    /* Define screen size */
+    cmd[0] = '?';
+    cmd[1] = 'G';
+    cmd[2] = rows + '0';
+    cmd[3] = (cols / 10) + '0';
+    cmd[4] = (cols % 10) + '0';
+    drv_PHAnderson_send(cmd, 5);
+    udelay(T_WRITE);
+
+    /* Hide cursor */
+    cmd[0] = '?';
+    cmd[1] = 'c';
+    cmd[2] = '0';
+    drv_PHAnderson_send(cmd, 3);
+    udelay(T_WRITE);
+
+    if (cfg_number(section, "Blacklight", 0, 0, 255, &blacklight) > 0) {
+	drv_PHAnderson_blacklight(blacklight);
+    }
+
+    s = cfg_get(section, "Bootscreen", NULL);
+    printf(s);
+    drv_PHAnderson_bootscreen(s);
+
+    drv_PHAnderson_clear();	/* clear display */
+
+    return 0;
+}
+
+/****************************************/
+/***            plugins               ***/
+/****************************************/
+
+static void plugin_blacklight(RESULT * result, RESULT * arg1)
+{
+    double blacklight;
+
+    blacklight = drv_PHAnderson_blacklight(R2N(arg1));
+    SetResult(&result, R_NUMBER, &blacklight);
+}
+
+static void plugin_bootscreen(RESULT * result, RESULT * arg1)
+{
+    double bootmsg;
+
+    bootmsg = drv_PHAnderson_bootscreen(R2S(arg1));
+    SetResult(&result, R_NUMBER, &bootmsg);
+}
+
+/****************************************/
+/***        widget callbacks          ***/
+/****************************************/
+
+
+/* using drv_generic_text_draw(W) */
+/* using drv_generic_text_icon_draw(W) */
+/* using drv_generic_text_bar_draw(W) */
+
+
+/****************************************/
+/***        exported functions        ***/
+/****************************************/
+
+
+/* list models */
+int drv_PHAnderson_list(void)
+{
+    printf("generic");
+    return 0;
+}
+
+int drv_PHAnderson_init(const char *section, const int quiet)
+{
+    WIDGET_CLASS wc;
+    int ret;
+
+    info("%s: %s", Name, "$Rev: 840 $");
+
+    /* display preferences */
+    XRES = 5;			/* pixel width of one char  */
+    YRES = 8;			/* pixel height of one char  */
+    CHARS = 8;			/* number of user-defineable characters */
+    CHAR0 = 0;			/* ASCII of first user-defineable char */
+    GOTO_COST = 7;		/* number of bytes a goto command requires */
+
+    /* real worker functions */
+    drv_generic_text_real_write = drv_PHAnderson_write;
+    drv_generic_text_real_defchar = drv_PHAnderson_defchar;
+
+    /* start display */
+    if ((ret = drv_PHAnderson_start(section)) != 0)
+	return ret;
+
+    if (!quiet) {
+	char buffer[40];
+	qprintf(buffer, sizeof(buffer), "%s %dx%d", Name, DCOLS, DROWS);
+	if (drv_generic_text_greet(buffer, "www.bwct.de")) {
+	    sleep(3);
+	    drv_PHAnderson_clear();
+	}
+    }
+
+    /* initialize generic text driver */
+    if ((ret = drv_generic_text_init(section, Name)) != 0)
+	return ret;
+
+    /* initialize generic icon driver */
+    if ((ret = drv_generic_text_icon_init()) != 0)
+	return ret;
+
+    /* initialize generic bar driver */
+    if ((ret = drv_generic_text_bar_init(0)) != 0)
+	return ret;
+
+    /* add fixed chars to the bar driver */
+    drv_generic_text_bar_add_segment(0, 0, 0, 32);	/* ASCII  32 = blank */
+
+    /* register text widget */
+    wc = Widget_Text;
+    wc.draw = drv_generic_text_draw;
+    widget_register(&wc);
+
+    /* register icon widget */
+    wc = Widget_Icon;
+    wc.draw = drv_generic_text_icon_draw;
+    widget_register(&wc);
+
+    /* register bar widget */
+    wc = Widget_Bar;
+    wc.draw = drv_generic_text_bar_draw;
+    widget_register(&wc);
+
+    /* register plugins */
+    AddFunction("LCD::blacklight", 1, plugin_blacklight);
+
+    AddFunction("LCD::bootscreen", 1, plugin_bootscreen);
+
+    return 0;
+}
+
+
+int drv_PHAnderson_quit(const int quiet)
+{
+
+    info("%s: shutting down.", Name);
+
+    drv_generic_text_quit();
+
+    drv_PHAnderson_clear();
+
+    /* say goodbye... */
+    if (!quiet) {
+	drv_generic_text_greet("goodbye!", NULL);
+    }
+
+    debug("closing connection");
+    drv_PHAnderson_close();
+
+    return (0);
+}
+
+
+DRIVER drv_PHAnderson = {
+    .name = Name,
+    .list = drv_PHAnderson_list,
+    .init = drv_PHAnderson_init,
+    .quit = drv_PHAnderson_quit,
+};
diff -urN lcd4linux-0.10.0/drv_picoLCD.c lcd4linux-0.11.0-SVN/drv_picoLCD.c
--- lcd4linux-0.10.0/drv_picoLCD.c	1970-01-01 01:00:00.000000000 +0100
+++ lcd4linux-0.11.0-SVN/drv_picoLCD.c	2009-01-06 08:15:46.000000000 +0100
@@ -0,0 +1,492 @@
+/* $Id: drv_picoLCD.c 947 2009-01-06 07:15:46Z michael $
+ * $URL: https://ssl.bulix.org/svn/lcd4linux/trunk/drv_picoLCD.c $
+ *
+ * driver for picoLCD displays from mini-box.com
+ *
+ * Copyright (C) 2005 Michael Reinelt <michael@reinelt.co.at>
+ * Copyright (C) 2005, 2006, 2007 The LCD4Linux Team <lcd4linux-devel@users.sourceforge.net>
+ *
+ * Copyright (C) 2007 Nicu Pavel, Mini-Box.com <npavel@mini-box.com>
+ *
+ * This file is part of LCD4Linux.
+ *
+ * LCD4Linux is free software; you can redistribute it and/or modify
+ * it under the terms of the GNU General Public License as published by
+ * the Free Software Foundation; either version 2, or (at your option)
+ * any later version.
+ *
+ * LCD4Linux is distributed in the hope that it will be useful,
+ * but WITHOUT ANY WARRANTY; without even the implied warranty of
+ * MERCHANTABILITY or FITNESS FOR A PARTICULAR PURPOSE.  See the
+ * GNU General Public License for more details.
+ *
+ * You should have received a copy of the GNU General Public License
+ * along with this program; if not, write to the Free Software
+ * Foundation, Inc., 675 Mass Ave, Cambridge, MA 02139, USA.
+ *
+ */
+
+/* 
+ *
+ * exported fuctions:
+ *
+ * struct DRIVER drv_picoLCD
+ *
+ */
+
+#include "config.h"
+
+#include <stdlib.h>
+#include <stdio.h>
+#include <string.h>
+#include <errno.h>
+#include <unistd.h>
+#include <termios.h>
+#include <fcntl.h>
+#include <sys/ioctl.h>
+#include <sys/time.h>
+
+#include <usb.h>
+
+#include "debug.h"
+#include "cfg.h"
+#include "qprintf.h"
+#include "udelay.h"
+#include "plugin.h"
+#include "widget.h"
+#include "widget_text.h"
+#include "widget_icon.h"
+#include "widget_bar.h"
+#include "drv.h"
+#include "drv_generic_text.h"
+#include "drv_generic_gpio.h"
+#include "drv_generic_keypad.h"
+
+
+
+#define picoLCD_VENDOR  0x04d8
+#define picoLCD_DEVICE  0x0002
+
+static char Name[] = "picoLCD";
+
+static unsigned int gpo = 0;
+
+static char *Buffer;
+static char *BufPtr;
+
+static usb_dev_handle *lcd;
+
+
+
+/****************************************/
+/***  hardware dependant functions    ***/
+/****************************************/
+
+static int drv_pL_open(void)
+{
+    struct usb_bus *busses, *bus;
+    struct usb_device *dev;
+    char driver[1024];
+    char product[1024];
+    char manufacturer[1024];
+    char serialnumber[1024];
+    int ret;
+
+    lcd = NULL;
+
+    info("%s: scanning for picoLCD...", Name);
+
+    usb_set_debug(0);
+
+    usb_init();
+    usb_find_busses();
+    usb_find_devices();
+    busses = usb_get_busses();
+
+    for (bus = busses; bus; bus = bus->next) {
+	for (dev = bus->devices; dev; dev = dev->next) {
+	    if ((dev->descriptor.idVendor == picoLCD_VENDOR) && (dev->descriptor.idProduct == picoLCD_DEVICE)) {
+
+		info("%s: found picoLCD on bus %s device %s", Name, bus->dirname, dev->filename);
+
+		lcd = usb_open(dev);
+
+		ret = usb_get_driver_np(lcd, 0, driver, sizeof(driver));
+
+		if (ret == 0) {
+		    info("%s: interface 0 already claimed by '%s'", Name, driver);
+		    info("%s: attempting to detach driver...", Name);
+		    if (usb_detach_kernel_driver_np(lcd, 0) < 0) {
+			error("%s: usb_detach_kernel_driver_np() failed!", Name);
+			return -1;
+		    }
+		}
+
+		usb_set_configuration(lcd, 1);
+		usleep(100);
+
+		if (usb_claim_interface(lcd, 0) < 0) {
+		    error("%s: usb_claim_interface() failed!", Name);
+		    return -1;
+		}
+
+		usb_set_altinterface(lcd, 0);
+
+		usb_get_string_simple(lcd, dev->descriptor.iProduct, product, sizeof(product));
+		usb_get_string_simple(lcd, dev->descriptor.iManufacturer, manufacturer, sizeof(manufacturer));
+		usb_get_string_simple(lcd, dev->descriptor.iSerialNumber, serialnumber, sizeof(serialnumber));
+
+		info("%s: Manufacturer='%s' Product='%s' SerialNumber='%s'", Name, manufacturer, product, serialnumber);
+
+		return 0;
+	    }
+	}
+    }
+    error("%s: could not find a picoLCD", Name);
+    return -1;
+}
+
+
+static int drv_pL_close(void)
+{
+    usb_release_interface(lcd, 0);
+    usb_close(lcd);
+
+    return 0;
+}
+
+
+static void drv_pL_send(unsigned char *data, int size)
+{
+    usb_interrupt_write(lcd, USB_ENDPOINT_OUT + 1, (char *) data, size, 1000);
+}
+
+static int drv_pL_read(unsigned char *data, int size)
+{
+    return usb_interrupt_read(lcd, USB_ENDPOINT_OUT + 1, (char *) data, size, 1000);
+}
+
+
+
+static void drv_pL_clear(void)
+{
+    unsigned char cmd[1] = { 0x94 };	/* clear display */
+    drv_pL_send(cmd, 1);
+}
+
+static int drv_pL_contrast(int contrast)
+{
+    unsigned char cmd[2] = { 0x92 };	/* set contrast */
+
+    if (contrast < 0)
+	contrast = 0;
+    if (contrast > 255)
+	contrast = 255;
+
+    cmd[1] = contrast;
+    drv_pL_send(cmd, 2);
+
+    return contrast;
+}
+
+
+static int drv_pL_backlight(int backlight)
+{
+    unsigned char cmd[2] = { 0x91 };	/* set backlight */
+
+    if (backlight < 0)
+	backlight = 0;
+    if (backlight > 1)
+	backlight = 1;
+
+    cmd[1] = backlight;
+    drv_pL_send(cmd, 2);
+
+    return backlight;
+}
+
+#define _USBLCD_MAX_DATA_LEN          24
+#define IN_REPORT_KEY_STATE           0x11
+static int drv_pL_gpi( __attribute__ ((unused))
+		      int num)
+{
+    int ret;
+    unsigned char read_packet[_USBLCD_MAX_DATA_LEN];
+    ret = drv_pL_read(read_packet, _USBLCD_MAX_DATA_LEN);
+    if ((ret > 0) && (read_packet[0] == IN_REPORT_KEY_STATE)) {
+	debug("picoLCD: pressed key= 0x%02x\n", read_packet[1]);
+	return read_packet[1];
+    }
+    return 0;
+}
+
+static int drv_pL_gpo(int num, int val)
+{
+    unsigned char cmd[2] = { 0x81 };	/* set GPO */
+
+    if (num < 0)
+	num = 0;
+    if (num > 7)
+	num = 7;
+
+    if (val < 0)
+	val = 0;
+    if (val > 1)
+	val = 1;
+
+    /* set led bit to 1 or 0 */
+    if (val)
+	gpo |= 1 << num;
+    else
+	gpo &= ~(1 << num);
+
+    cmd[1] = gpo;
+    drv_pL_send(cmd, 2);
+
+    return val;
+}
+
+
+static void drv_pL_write(const int row, const int col, const char *data, int len)
+{
+    unsigned char cmd[64];
+    int i;
+
+    cmd[0] = 0x98;		/* goto/write */
+    cmd[1] = row;
+    cmd[2] = col;
+    cmd[3] = len;
+
+    i = 4;
+    while (len--) {
+	cmd[i++] = *data++;
+    }
+
+    drv_pL_send(cmd, i);
+}
+
+static void drv_pL_defchar(const int ascii, const unsigned char *matrix)
+{
+    unsigned char cmd[10] = { 0x9c };	/* define character */
+    int i;
+
+    cmd[1] = ascii;
+    for (i = 0; i < 8; i++) {
+	cmd[i + 2] = *matrix++ & 0x1f;
+    }
+
+    drv_pL_send(cmd, 10);
+}
+
+
+static int drv_pL_start(const char *section, const int quiet)
+{
+    int rows = -1, cols = -1;
+    int value;
+    char *s;
+
+    s = cfg_get(section, "Size", NULL);
+    if (s == NULL || *s == '\0') {
+	error("%s: no '%s.Size' entry from %s", Name, section, cfg_source());
+	return -1;
+    }
+    if (sscanf(s, "%dx%d", &cols, &rows) != 2 || rows < 1 || cols < 1) {
+	error("%s: bad %s.Size '%s' from %s", Name, section, s, cfg_source());
+	free(s);
+	return -1;
+    }
+
+    DROWS = rows;
+    DCOLS = cols;
+
+    if (drv_pL_open() < 0) {
+	return -1;
+    }
+
+    /* Init the command buffer */
+    Buffer = (char *) malloc(1024);
+    if (Buffer == NULL) {
+	error("%s: coommand buffer could not be allocated: malloc() failed", Name);
+	return -1;
+    }
+    BufPtr = Buffer;
+
+    if (cfg_number(section, "Contrast", 0, 0, 255, &value) > 0) {
+	info("Setting contrast to %d", value);
+	drv_pL_contrast(value);
+    }
+
+    if (cfg_number(section, "Backlight", 0, 0, 1, &value) > 0) {
+	info("Setting backlight to %d", value);
+	drv_pL_backlight(value);
+    }
+
+    drv_pL_clear();		/* clear display */
+
+    if (!quiet) {
+	char buffer[40];
+	qprintf(buffer, sizeof(buffer), "%s %dx%d", Name, DCOLS, DROWS);
+	if (drv_generic_text_greet(buffer, "http://www.picolcd.com")) {
+	    sleep(3);
+	    drv_pL_clear();
+	}
+    }
+
+    return 0;
+}
+
+
+/****************************************/
+/***            plugins               ***/
+/****************************************/
+
+static void plugin_contrast(RESULT * result, RESULT * arg1)
+{
+    double contrast;
+
+    contrast = drv_pL_contrast(R2N(arg1));
+    SetResult(&result, R_NUMBER, &contrast);
+}
+
+static void plugin_backlight(RESULT * result, RESULT * arg1)
+{
+    double backlight;
+
+    backlight = drv_pL_backlight(R2N(arg1));
+    SetResult(&result, R_NUMBER, &backlight);
+}
+
+static void plugin_gpo(RESULT * result, RESULT * argv[])
+{
+    double gpo;
+    gpo = drv_pL_gpo(R2N(argv[0]), R2N(argv[1]));
+    SetResult(&result, R_NUMBER, &gpo);
+}
+
+/****************************************/
+/***        widget callbacks          ***/
+/****************************************/
+
+
+/* using drv_generic_text_draw(W) */
+/* using drv_generic_text_icon_draw(W) */
+/* using drv_generic_text_bar_draw(W) */
+
+
+/****************************************/
+/***        exported functions        ***/
+/****************************************/
+
+
+/* list models */
+int drv_pL_list(void)
+{
+    printf("generic");
+    return 0;
+}
+
+
+/* initialize driver & display */
+int drv_pL_init(const char *section, const int quiet)
+{
+    WIDGET_CLASS wc;
+    int ret;
+
+    info("%s: %s", Name, "$Rev: 947 $");
+
+    /* display preferences */
+    XRES = 5;			/* pixel width of one char  */
+    YRES = 8;			/* pixel height of one char  */
+    CHARS = 8;			/* number of user-defineable characters */
+    CHAR0 = 0;			/* ASCII of first user-defineable char */
+    GPOS = 8;
+    GPIS = 1;
+    INVALIDATE = 1;
+    GOTO_COST = 2;		/* number of bytes a goto command requires */
+
+    /* real worker functions */
+    drv_generic_text_real_write = drv_pL_write;
+    drv_generic_text_real_defchar = drv_pL_defchar;
+    drv_generic_gpio_real_set = drv_pL_gpo;
+    drv_generic_gpio_real_get = drv_pL_gpi;
+
+    /* start display */
+    if ((ret = drv_pL_start(section, quiet)) != 0)
+	return ret;
+
+    /* initialize generic text driver */
+    if ((ret = drv_generic_text_init(section, Name)) != 0)
+	return ret;
+
+    /* initialize generic icon driver */
+    if ((ret = drv_generic_text_icon_init()) != 0)
+	return ret;
+
+    /* initialize generic bar driver */
+    if ((ret = drv_generic_text_bar_init(0)) != 0)
+	return ret;
+
+    drv_generic_text_bar_add_segment(0, 0, 255, 32);
+
+    /* GPO's init */
+    if ((ret = drv_generic_gpio_init(section, Name)) != 0)
+	return ret;
+
+    /* register text widget */
+    wc = Widget_Text;
+    wc.draw = drv_generic_text_draw;
+    widget_register(&wc);
+
+    /* register icon widget */
+    wc = Widget_Icon;
+    wc.draw = drv_generic_text_icon_draw;
+    widget_register(&wc);
+
+    /* register bar widget */
+    wc = Widget_Bar;
+    wc.draw = drv_generic_text_bar_draw;
+    widget_register(&wc);
+
+    /* register plugins */
+    AddFunction("LCD::contrast", -1, plugin_contrast);
+    AddFunction("LCD::backlight", -1, plugin_backlight);
+    AddFunction("LCD::gpo", -1, plugin_gpo);
+
+    return 0;
+}
+
+
+/* close driver & display */
+int drv_pL_quit(const int quiet)
+{
+
+    info("%s: shutting down.", Name);
+
+    drv_generic_text_quit();
+
+    /* clear display */
+    drv_pL_clear();
+
+    /* say goodbye... */
+    if (!quiet) {
+	drv_generic_text_greet("goodbye!", NULL);
+    }
+
+    drv_pL_close();
+
+    if (Buffer) {
+	free(Buffer);
+	Buffer = NULL;
+	BufPtr = Buffer;
+    }
+
+    return (0);
+}
+
+
+DRIVER drv_picoLCD = {
+    .name = Name,
+    .list = drv_pL_list,
+    .init = drv_pL_init,
+    .quit = drv_pL_quit,
+};
diff -urN lcd4linux-0.10.0/drv_picoLCDGraphic.c lcd4linux-0.11.0-SVN/drv_picoLCDGraphic.c
--- lcd4linux-0.10.0/drv_picoLCDGraphic.c	1970-01-01 01:00:00.000000000 +0100
+++ lcd4linux-0.11.0-SVN/drv_picoLCDGraphic.c	2008-12-31 08:05:54.000000000 +0100
@@ -0,0 +1,612 @@
+/* $Id: drv_picoLCDGraphic.c 899 2008-10-07 19:32:42Z bwalle $
+ * $URL: https://ssl.bulix.org/svn/lcd4linux/trunk/drv_picoLCDGraphic.c $
+ *
+ * driver for picoLCD Graphic(256x64) displays from mini-box.com
+ *
+ * Copyright (C) 2005 Michael Reinelt <michael@reinelt.co.at>
+ * Copyright (C) 2005, 2006, 2007 The LCD4Linux Team <lcd4linux-devel@users.sourceforge.net>
+ *
+ * Copyright (C) 2008 Nicu Pavel, Mini-Box.com <npavel@mini-box.com>
+ *
+ * This file is part of LCD4Linux.
+ *
+ * LCD4Linux is free software; you can redistribute it and/or modify
+ * it under the terms of the GNU General Public License as published by
+ * the Free Software Foundation; either version 2, or (at your option)
+ * any later version.
+ *
+ * LCD4Linux is distributed in the hope that it will be useful,
+ * but WITHOUT ANY WARRANTY; without even the implied warranty of
+ * MERCHANTABILITY or FITNESS FOR A PARTICULAR PURPOSE.  See the
+ * GNU General Public License for more details.
+ *
+ * You should have received a copy of the GNU General Public License
+ * along with this program; if not, write to the Free Software
+ * Foundation, Inc., 675 Mass Ave, Cambridge, MA 02139, USA.
+ *
+ */
+
+/* 
+ *
+ * exported fuctions:
+ *
+ * struct DRIVER drv_picoLCDGraphic
+ *
+ */
+
+#include "config.h"
+
+#include <stdlib.h>
+#include <stdio.h>
+#include <string.h>
+#include <errno.h>
+#include <unistd.h>
+#include <termios.h>
+#include <fcntl.h>
+#include <sys/ioctl.h>
+#include <sys/time.h>
+
+#include <usb.h>
+
+#include "debug.h"
+#include "cfg.h"
+#include "qprintf.h"
+#include "udelay.h"
+#include "plugin.h"
+#include "widget.h"
+#include "widget_text.h"
+#include "widget_icon.h"
+#include "widget_bar.h"
+#include "drv.h"
+#include "drv_generic_gpio.h"
+#include "drv_generic_keypad.h"
+#include "drv_generic_graphic.h"
+
+
+
+#define picoLCD_VENDOR  0x04d8
+#define picoLCD_DEVICE  0xc002
+
+#define OUT_REPORT_LED_STATE		0x81
+#define OUT_REPORT_LCD_BACKLIGHT	0x91
+#define OUT_REPORT_LCD_CONTRAST		0x92
+
+#define OUT_REPORT_CMD			0x94
+#define OUT_REPORT_DATA			0x95
+#define OUT_REPORT_CMD_DATA		0x96
+
+#define SCREEN_H			64
+#define SCREEN_W			256
+
+
+#if 1
+#define DEBUG(x) debug("%s(): %s", __FUNCTION__, x);
+#else
+#define DEBUG(x)
+#endif
+
+
+static char Name[] = "picoLCDGraphic";
+static unsigned char *pLG_framebuffer;
+
+/* used to display white text on black background or inverse */
+unsigned char inverted = 0;
+
+static unsigned int gpo = 0;
+
+static char *Buffer;
+static char *BufPtr;
+
+static usb_dev_handle *lcd;
+
+
+
+/****************************************/
+/***  hardware dependant functions    ***/
+/****************************************/
+
+static int drv_pLG_open(void)
+{
+    struct usb_bus *busses, *bus;
+    struct usb_device *dev;
+    char driver[1024];
+    char product[1024];
+    char manufacturer[1024];
+    char serialnumber[1024];
+    int ret;
+
+    lcd = NULL;
+
+    info("%s: scanning for picoLCD 256x64...", Name);
+
+    usb_set_debug(0);
+
+    usb_init();
+    usb_find_busses();
+    usb_find_devices();
+    busses = usb_get_busses();
+
+    for (bus = busses; bus; bus = bus->next) {
+	for (dev = bus->devices; dev; dev = dev->next) {
+	    if ((dev->descriptor.idVendor == picoLCD_VENDOR) && (dev->descriptor.idProduct == picoLCD_DEVICE)) {
+
+		info("%s: found picoLCD on bus %s device %s", Name, bus->dirname, dev->filename);
+
+		lcd = usb_open(dev);
+
+		ret = usb_get_driver_np(lcd, 0, driver, sizeof(driver));
+
+		if (ret == 0) {
+		    info("%s: interface 0 already claimed by '%s'", Name, driver);
+		    info("%s: attempting to detach driver...", Name);
+		    if (usb_detach_kernel_driver_np(lcd, 0) < 0) {
+			error("%s: usb_detach_kernel_driver_np() failed!", Name);
+			return -1;
+		    }
+		}
+
+		usb_set_configuration(lcd, 1);
+		usleep(100);
+
+		if (usb_claim_interface(lcd, 0) < 0) {
+		    error("%s: usb_claim_interface() failed!", Name);
+		    return -1;
+		}
+
+		usb_set_altinterface(lcd, 0);
+
+		usb_get_string_simple(lcd, dev->descriptor.iProduct, product, sizeof(product));
+		usb_get_string_simple(lcd, dev->descriptor.iManufacturer, manufacturer, sizeof(manufacturer));
+		usb_get_string_simple(lcd, dev->descriptor.iSerialNumber, serialnumber, sizeof(serialnumber));
+
+		info("%s: Manufacturer='%s' Product='%s' SerialNumber='%s'", Name, manufacturer, product, serialnumber);
+
+		return 0;
+	    }
+	}
+    }
+    error("%s: could not find a picoLCD", Name);
+    return -1;
+}
+
+
+static void drv_pLG_send(unsigned char *data, int size)
+{
+    int ret;
+    ret = usb_interrupt_write(lcd, USB_ENDPOINT_OUT + 1, (char *) data, size, 1000);
+    //fprintf(stderr, "%s written %d bytes\n", __FUNCTION__, ret);
+}
+
+static int drv_pLG_close(void)
+{
+    usb_release_interface(lcd, 0);
+    usb_close(lcd);
+
+    return 0;
+}
+
+static void drv_pLG_update_img()
+{
+    unsigned char cmd3[64] = { OUT_REPORT_CMD_DATA };	/* send command + data */
+    unsigned char cmd4[64] = { OUT_REPORT_DATA };	/* send data only */
+
+    int index, bit, x, y;
+    unsigned char cs, line;
+    unsigned char pixel;
+
+    info("In %s\n", __FUNCTION__);
+
+
+    for (cs = 0; cs < 4; cs++) {
+	unsigned char chipsel = (cs << 2);	//chipselect
+	for (line = 0; line < 8; line++) {
+	    //ha64_1.setHIDPkt(OUT_REPORT_CMD_DATA, 8+3+32, 8, chipsel, 0x02, 0x00, 0x00, 0xb8|j, 0x00, 0x00, 0x40);
+	    cmd3[0] = OUT_REPORT_CMD_DATA;
+	    cmd3[1] = chipsel;
+	    cmd3[2] = 0x02;
+	    cmd3[3] = 0x00;
+	    cmd3[4] = 0x00;
+	    cmd3[5] = 0xb8 | line;
+	    cmd3[6] = 0x00;
+	    cmd3[7] = 0x00;
+	    cmd3[8] = 0x40;
+	    cmd3[9] = 0x00;
+	    cmd3[10] = 0x00;
+	    cmd3[11] = 32;
+
+	    //ha64_2.setHIDPkt(OUT_REPORT_DATA, 4+32, 4, chipsel | 0x01, 0x00, 0x00, 32);
+
+	    cmd4[0] = OUT_REPORT_DATA;
+	    cmd4[1] = chipsel | 0x01;
+	    cmd4[2] = 0x00;
+	    cmd4[3] = 0x00;
+	    cmd4[4] = 32;
+
+	    for (index = 0; index < 32; index++) {
+		pixel = 0x00;
+
+		for (bit = 0; bit < 8; bit++) {
+		    x = cs * 64 + index;
+		    y = (line * 8 + bit + 0) % SCREEN_H;
+
+		    if (pLG_framebuffer[y * 256 + x] ^ inverted)
+			pixel |= (1 << bit);
+		}
+		cmd3[12 + index] = pixel;
+	    }
+
+	    for (index = 32; index < 64; index++) {
+		pixel = 0x00;
+
+		for (bit = 0; bit < 8; bit++) {
+		    x = cs * 64 + index;
+		    y = (line * 8 + bit + 0) % SCREEN_H;
+		    if (pLG_framebuffer[y * 256 + x] ^ inverted)
+			pixel |= (1 << bit);
+		}
+
+		cmd4[5 + (index - 32)] = pixel;
+	    }
+
+	    drv_pLG_send(cmd3, 44);
+	    drv_pLG_send(cmd4, 38);
+	}
+    }
+
+    //drv_pLG_clear();
+}
+
+
+/* for graphic displays only */
+static void drv_pLG_blit(const int row, const int col, const int height, const int width)
+{
+    int r, c;
+
+    //DEBUG(fprintf(stderr, "In %s called with row %d col %d height %d width %d\n", __FUNCTION__, row, col, height, width));
+
+    for (r = row; r < row + height; r++) {
+	for (c = col; c < col + width; c++) {
+	    pLG_framebuffer[r * 256 + c] = drv_generic_graphic_black(r, c);
+	    //fprintf(stderr, "%d", pLG_framebuffer[r * 256 + c]);
+	}
+	//fprintf(stderr, "\n");
+    }
+
+    /*
+       for (r = 0; r < 64; r++) {
+       for(c = 0; c < 256; c++) {
+       fprintf(stderr, "%d", pLG_framebuffer[r * 256 + c]); 
+       }
+       fprintf(stderr, "\n");
+       }
+     */
+    drv_pLG_update_img();
+}
+
+
+void drv_pLG_clear(void)
+{
+    unsigned char cmd[3] = { 0x93, 0x01, 0x00 };	/* init display */
+    unsigned char cmd2[9] = { OUT_REPORT_CMD };	/* init display */
+    unsigned char cmd3[64] = { OUT_REPORT_CMD_DATA };	/* clear screen */
+    unsigned char cmd4[64] = { OUT_REPORT_CMD_DATA };	/* clear screen */
+
+    int init, index;
+    unsigned char cs, line;
+
+
+    info("In %s\n", __FUNCTION__);
+    drv_pLG_send(cmd, 3);
+
+    for (init = 0; init < 4; init++) {
+	unsigned char cs = ((init << 2) & 0xFF);
+
+	cmd2[0] = OUT_REPORT_CMD;
+	cmd2[1] = cs;
+	cmd2[2] = 0x02;
+	cmd2[3] = 0x00;
+	cmd2[4] = 0x64;
+	cmd2[5] = 0x3F;
+	cmd2[6] = 0x00;
+	cmd2[7] = 0x64;
+	cmd2[8] = 0xC0;
+
+	drv_pLG_send(cmd2, 9);
+    }
+
+
+    for (cs = 0; cs < 4; cs++) {
+	unsigned char chipsel = (cs << 2);	//chipselect
+	for (line = 0; line < 8; line++) {
+	    //ha64_1.setHIDPkt(OUT_REPORT_CMD_DATA, 8+3+32, 8, cs, 0x02, 0x00, 0x00, 0xb8|j, 0x00, 0x00, 0x40);
+	    cmd3[0] = OUT_REPORT_CMD_DATA;
+	    cmd3[1] = chipsel;
+	    cmd3[2] = 0x02;
+	    cmd3[3] = 0x00;
+	    cmd3[4] = 0x00;
+	    cmd3[5] = 0xb8 | line;
+	    cmd3[6] = 0x00;
+	    cmd3[7] = 0x00;
+	    cmd3[8] = 0x40;
+	    cmd3[9] = 0x00;
+	    cmd3[10] = 0x00;
+	    cmd3[11] = 32;
+
+	    unsigned char temp = 0;
+
+	    for (index = 0; index < 32; index++) {
+		cmd3[12 + index] = temp;
+	    }
+
+	    drv_pLG_send(cmd3, 64);
+
+	    //ha64_2.setHIDPkt(OUT_REPORT_DATA, 4+32, 4, cs | 0x01, 0x00, 0x00, 32);
+
+	    cmd4[0] = OUT_REPORT_DATA;
+	    cmd4[1] = chipsel | 0x01;
+	    cmd4[2] = 0x00;
+	    cmd4[3] = 0x00;
+	    cmd4[4] = 32;
+
+	    for (index = 32; index < 64; index++) {
+		temp = 0x00;
+		cmd4[5 + (index - 32)] = temp;
+	    }
+	    drv_pLG_send(cmd4, 64);
+	}
+    }
+}
+
+static int drv_pLG_contrast(int contrast)
+{
+    unsigned char cmd[2] = { 0x92 };	/* set contrast */
+
+    if (contrast < 0)
+	contrast = 0;
+    if (contrast > 255)
+	contrast = 255;
+
+    cmd[1] = contrast;
+    drv_pLG_send(cmd, 2);
+
+    return contrast;
+}
+
+
+static int drv_pLG_backlight(int backlight)
+{
+    unsigned char cmd[2] = { 0x91 };	/* set backlight */
+
+    if (backlight < 0)
+	backlight = 0;
+    if (backlight >= 1)
+	backlight = 200;
+
+    cmd[1] = backlight;
+    drv_pLG_send(cmd, 2);
+
+    return backlight;
+}
+
+static int drv_pLG_gpo(int num, int val)
+{
+    unsigned char cmd[2] = { 0x81 };	/* set GPO */
+
+    if (num < 0)
+	num = 0;
+    if (num > 7)
+	num = 7;
+
+    if (val < 0)
+	val = 0;
+    if (val > 1)
+	val = 1;
+
+    /* set led bit to 1 or 0 */
+    if (val)
+	gpo |= 1 << num;
+    else
+	gpo &= ~(1 << num);
+
+    cmd[1] = gpo;
+    //drv_pLG_send(cmd, 2);
+
+    return val;
+}
+
+static int drv_pLG_start(const char *section, const int quiet)
+{
+    int rows = -1, cols = -1;
+    int value;
+    char *s;
+
+    s = cfg_get(section, "Size", NULL);
+    if (s == NULL || *s == '\0') {
+	error("%s: no '%s.Size' entry from %s", Name, section, cfg_source());
+	return -1;
+    }
+    if (sscanf(s, "%dx%d", &cols, &rows) != 2 || rows < 1 || cols < 1) {
+	error("%s: bad %s.Size '%s' from %s", Name, section, s, cfg_source());
+	free(s);
+	return -1;
+    }
+
+    if (cfg_number(section, "Inverted", 0, 0, 1, &value) > 0) {
+	info("Setting display inverted to %d", value);
+	inverted = value;
+    }
+
+    DROWS = SCREEN_H;
+    DCOLS = SCREEN_W;
+
+    if (drv_pLG_open() < 0) {
+	return -1;
+    }
+
+    /* Init the command buffer */
+    Buffer = (char *) malloc(1024);
+    if (Buffer == NULL) {
+	error("%s: coommand buffer could not be allocated: malloc() failed", Name);
+	return -1;
+    }
+    BufPtr = Buffer;
+
+    /* Init framebuffer buffer */
+    pLG_framebuffer = malloc(SCREEN_W * SCREEN_H * sizeof(unsigned char));
+    if (!pLG_framebuffer)
+	return -1;
+
+    DEBUG("allocated");
+    memset(pLG_framebuffer, 0, SCREEN_W * SCREEN_H);
+    DEBUG("zeroed");
+
+    if (cfg_number(section, "Contrast", 0, 0, 255, &value) > 0) {
+	info("Setting contrast to %d", value);
+	drv_pLG_contrast(value);
+    }
+
+    if (cfg_number(section, "Backlight", 0, 0, 1, &value) > 0) {
+	info("Setting backlight to %d", value);
+	drv_pLG_backlight(value);
+    }
+
+    drv_pLG_clear();		/* clear display */
+
+    if (!quiet) {
+	char buffer[40];
+	qprintf(buffer, sizeof(buffer), "%s %dx%d", Name, SCREEN_W, SCREEN_H);
+	if (drv_generic_graphic_greet(buffer, "http://www.picolcd.com")) {
+	    sleep(3);
+	    drv_pLG_clear();
+	}
+    }
+
+    return 0;
+}
+
+
+/****************************************/
+/***            plugins               ***/
+/****************************************/
+
+static void plugin_contrast(RESULT * result, RESULT * arg1)
+{
+    double contrast;
+
+    contrast = drv_pLG_contrast(R2N(arg1));
+    SetResult(&result, R_NUMBER, &contrast);
+}
+
+static void plugin_backlight(RESULT * result, RESULT * arg1)
+{
+    double backlight;
+
+    backlight = drv_pLG_backlight(R2N(arg1));
+    SetResult(&result, R_NUMBER, &backlight);
+}
+
+static void plugin_gpo(RESULT * result, RESULT * argv[])
+{
+    double gpo;
+    gpo = drv_pLG_gpo(R2N(argv[0]), R2N(argv[1]));
+    SetResult(&result, R_NUMBER, &gpo);
+}
+
+
+/****************************************/
+/***        widget callbacks          ***/
+/****************************************/
+
+
+/* using drv_generic_text_draw(W) */
+/* using drv_generic_text_icon_draw(W) */
+/* using drv_generic_text_bar_draw(W) */
+
+
+/****************************************/
+/***        exported functions        ***/
+/****************************************/
+
+
+/* list models */
+int drv_pLG_list(void)
+{
+    printf("picoLCD 256x64 Graphic LCD");
+    return 0;
+}
+
+
+/* initialize driver & display */
+int drv_pLG_init(const char *section, const int quiet)
+{
+    int ret;
+
+    info("%s: %s", Name, "$Rev: 899 $");
+
+    info("PICOLCD Graphic initialization\n");
+
+    /* display preferences */
+    XRES = 6;			/* pixel width of one char  */
+    YRES = 8;			/* pixel height of one char  */
+    GPOS = 8;
+
+    /* real worker functions */
+    drv_generic_graphic_real_blit = drv_pLG_blit;
+
+    /* start display */
+    if ((ret = drv_pLG_start(section, quiet)) != 0)
+	return ret;
+
+
+    /* initialize generic graphic driver */
+    if ((ret = drv_generic_graphic_init(section, Name)) != 0)
+	return ret;
+
+    /* GPO's init */
+
+    if ((ret = drv_generic_gpio_init(section, Name)) != 0)
+	return ret;
+
+    /* register plugins */
+
+    AddFunction("LCD::contrast", -1, plugin_contrast);
+    AddFunction("LCD::backlight", -1, plugin_backlight);
+    AddFunction("LCD::gpo", -1, plugin_gpo);
+
+    return 0;
+}
+
+
+/* close driver & display */
+int drv_pLG_quit(const int quiet)
+{
+
+    info("%s: shutting down.", Name);
+
+    drv_generic_graphic_quit();
+
+    /* clear display */
+    drv_pLG_clear();
+
+    /* say goodbye... */
+    if (!quiet) {
+	drv_generic_graphic_greet("goodbye!", NULL);
+    }
+
+    drv_pLG_close();
+
+    if (Buffer) {
+	free(Buffer);
+	BufPtr = NULL;
+    }
+
+    return (0);
+}
+
+
+DRIVER drv_picoLCDGraphic = {
+    .name = Name,
+    .list = drv_pLG_list,
+    .init = drv_pLG_init,
+    .quit = drv_pLG_quit,
+};
diff -urN lcd4linux-0.10.0/drv_RouterBoard.c lcd4linux-0.11.0-SVN/drv_RouterBoard.c
--- lcd4linux-0.10.0/drv_RouterBoard.c	2005-05-08 06:32:44.000000000 +0200
+++ lcd4linux-0.11.0-SVN/drv_RouterBoard.c	2008-12-31 08:05:54.000000000 +0100
@@ -1,4 +1,5 @@
-/* $Id: drv_RouterBoard.c,v 1.5 2005/05/08 04:32:44 reinelt Exp $
+/* $Id: drv_RouterBoard.c 771 2007-02-25 12:27:26Z michael $
+ * $URL: https://ssl.bulix.org/svn/lcd4linux/trunk/drv_RouterBoard.c $
  *
  * driver for the "Router Board LCD port" 
  * see port details at http://www.routerboard.com
@@ -24,21 +25,6 @@
  * along with this program; if not, write to the Free Software
  * Foundation, Inc., 675 Mass Ave, Cambridge, MA 02139, USA.
  *
- *
- * $Log: drv_RouterBoard.c,v $
- * Revision 1.5  2005/05/08 04:32:44  reinelt
- * CodingStyle added and applied
- *
- * Revision 1.4  2005/01/18 06:30:23  reinelt
- * added (C) to all copyright statements
- *
- * Revision 1.3  2004/08/30 12:48:52  rjoco77
- *  * Added backlight update immediatelly
- *
- * Revision 1.2  2004/08/29 20:07:55  reinelt
- *
- * Patch from Joco: Make RouterBoard Backlight configurable
- *
  */
 
 
@@ -133,6 +119,7 @@
 #include "widget_bar.h"
 #include "drv.h"
 #include "drv_generic_text.h"
+#include "drv_generic_gpio.h"
 
 
 /* #define RB_WITH_LEDS 1 */
@@ -182,14 +169,12 @@
 #define T_CLEAR 1680		/* Clear Display */
 #define T_AS      60		/* Address setup time */
 
-/* Fixme: GPO's not yet implemented */
-static int GPOS;
-/* static int GPO=0; */
 
-/* Fixme: This actually ARE the GPO's... */
-static unsigned RB_Leds = 0;
+/* buffer holding the GPO state */
+static unsigned char GPO = 0;
 
-static unsigned RB_BackLight = 0;
+/* buffor holding backlight and LED states */
+static unsigned int RB_Leds = 0;
 
 typedef struct {
     int type;
@@ -221,8 +206,8 @@
 
     memset(sacl, 0, sizeof(struct sockaddr_in));
     sacl->sin_family = AF_INET;
-    sacl->sin_port = htons(3333);	//Listen Port
-    sacl->sin_addr.s_addr = inet_addr("127.0.0.1");	//Listen Address
+    sacl->sin_port = htons(3333);	/* Listen Port */
+    sacl->sin_addr.s_addr = inet_addr("127.0.0.1");	/* Listen Address */
 
     if ((sock_c = socket(AF_INET, SOCK_DGRAM, 0)) < 0) {
 	error("Socket open failed");
@@ -249,8 +234,8 @@
 	len = sizeof(struct sockaddr_in);
 	if ((size = recvfrom(sock_c, sock_msg, MAXMSG_SIZE, 0, (struct sockaddr *) sacl, (socklen_t *) & len)) < 0);
 	else {
-	    RB_Leds = sock_msg[0] & 0x0F;
-	    RB_Leds = RB_Leds << 12;
+	    RB_Leds &= 0x0fff;
+	    RB_Leds |= (sock_msg[0] & 0x0F) << 12;
 	    /* fprintf(stderr, "Received data %s\n",sock_msg); */
 	}
     }
@@ -258,21 +243,21 @@
 
 #endif
 
-/* IOCS0 port number can read from PCI Configuration Space Function 0 (F0) */
-/* at index 74h as 16 bit value (see [GEODE] 5.3.1 pg.151 and pg.176 Table 5-29 */
 
-static unsigned getIocs0Port(void)
+static void drv_RB_outw(const unsigned int data)
 {
-    static unsigned ret = 0;
+    static unsigned int port = 0;
 
-    /*get IO permission, here you can't use ioperm command */
-    iopl(3);
-
-    if (!ret) {
+    /* IOCS0 port number can read from PCI Configuration Space Function 0 (F0) */
+    /* at index 74h as 16 bit value (see [GEODE] 5.3.1 pg.151 and pg.176 Table 5-29 */
+    if (port == 0) {
+	/* get IO permission, here you can't use ioperm command */
+	iopl(3);
 	outl(0x80009074, CAR);
-	ret = inw(CDR);
+	port = inw(CDR);
     }
-    return ret;
+
+    outw(data | RB_Leds, port);
 }
 
 
@@ -280,20 +265,21 @@
 {
     /* -1 is used to query  the current Backlight */
     if (backlight == -1) {
-	if (RB_BackLight > 0)
-	    return 1;		// because RB_Backlight actually is 0x0800 or 0
-	return 0;
+	return (RB_Leds & LCD_BACKLIGHT) ? 1 : 0;
     }
 
-    if (backlight < 0)
-	backlight = 0;
-    if (backlight > 1)
+    if (backlight > 0) {
+	/* set bit */
+	RB_Leds |= LCD_BACKLIGHT;
 	backlight = 1;
-
-    RB_BackLight = backlight ? LCD_BACKLIGHT : 0;
+    } else {
+	backlight = 0;
+	/* clear bit */
+	RB_Leds &= ~LCD_BACKLIGHT;
+    }
 
     /* Set backlight output */
-    outw(RB_Leds | RB_BackLight, getIocs0Port());
+    drv_RB_outw(0);
 
     return backlight;
 }
@@ -304,13 +290,11 @@
 static void drv_RB_command(const unsigned char cmd, const int delay)
 {
 
-    outw(RB_Leds | LCD_INITX | RB_BackLight | cmd, getIocs0Port());
-
+    drv_RB_outw(LCD_INITX | cmd);
     ndelay(T_AS);
+    drv_RB_outw(cmd);
 
-    outw(RB_Leds | RB_BackLight | cmd, getIocs0Port());
-
-    // wait for command completion
+    /* wait for command completion */
     udelay(delay);
 
 }
@@ -329,13 +313,11 @@
 
 	ch = *(string++);
 
-	outw(RB_Leds | LCD_AFDX | LCD_INITX | RB_BackLight | ch, getIocs0Port());
-
+	drv_RB_outw(ch | LCD_AFDX | LCD_INITX);
 	ndelay(T_AS);
+	drv_RB_outw(ch | LCD_AFDX);
 
-	outw(RB_Leds | LCD_AFDX | RB_BackLight | ch, getIocs0Port());
-
-	// wait for command completion
+	/* wait for command completion */
 	udelay(delay);
 
     }
@@ -394,12 +376,28 @@
 }
 
 
-/* Fixme: GPO's */
-#if 0
-static void drv_RB_setGPO(const int bits)
+static int drv_RB_GPO(const int num, const int val)
 {
+    int v;
+
+    if (val > 0) {
+	/* set bit */
+	v = 1;
+	GPO |= 1 << num;
+    } else {
+	/* clear bit */
+	v = 0;
+	GPO &= ~(1 << num);
+    }
+
+    RB_Leds &= 0x0fff;
+    RB_Leds |= GPO << 12;
+
+    drv_RB_outw(0);
+
+    return v;
 }
-#endif
+
 
 static int drv_RB_start(const char *section, const int quiet)
 {
@@ -445,10 +443,12 @@
 	drv_RB_backlight(l);
     }
 
-    if (cfg_number(section, "GPOs", 0, 0, 8, &gpos) < 0)
+    if (cfg_number(section, "GPOs", 0, 0, 4, &gpos) < 0)
 	return -1;
-    info("%s: controlling %d GPO's", Name, gpos);
-
+    GPOS = gpos;
+    if (GPOS > 0) {
+	info("%s: using %d GPO's", Name, GPOS);
+    }
 #ifdef RB_WITH_LEDS
 
     if (drv_RB_sock_init() < 0) {
@@ -461,7 +461,6 @@
 
     DROWS = rows;
     DCOLS = cols;
-    GPOS = gpos;
 
     drv_RB_command(0x30, T_INIT1);	/* 8 Bit mode, wait 4.1 ms */
     drv_RB_command(0x30, T_INIT2);	/* 8 Bit mode, wait 100 us */
@@ -525,6 +524,7 @@
 /* using drv_generic_text_draw(W) */
 /* using drv_generic_text_icon_draw(W) */
 /* using drv_generic_text_bar_draw(W) */
+/* using drv_generic_gpio_draw(W) */
 
 
 /****************************************/
@@ -550,6 +550,8 @@
     int asc255bug;
     int ret;
 
+    info("%s: %s", Name, "$Rev: 771 $");
+
     /* display preferences */
     XRES = 5;			/* pixel width of one char  */
     YRES = 8;			/* pixel height of one char  */
@@ -560,6 +562,7 @@
     /* real worker functions */
     drv_generic_text_real_write = drv_RB_write;
     drv_generic_text_real_defchar = drv_RB_defchar;
+    drv_generic_gpio_real_set = drv_RB_GPO;
 
 
     /* start display */
@@ -587,6 +590,10 @@
     if (!asc255bug)
 	drv_generic_text_bar_add_segment(255, 255, 255, 255);	/* ASCII 255 = block */
 
+    /* initialize generic GPIO driver */
+    if ((ret = drv_generic_gpio_init(section, Name)) != 0)
+	return ret;
+
     /* register text widget */
     wc = Widget_Text;
     wc.draw = drv_generic_text_draw;
@@ -616,6 +623,7 @@
     info("%s: shutting down.", Name);
 
     drv_generic_text_quit();
+    drv_generic_gpio_quit();
 
     /* clear *both* displays */
     drv_RB_clear();
@@ -625,10 +633,8 @@
 	drv_generic_text_greet("goodbye!", NULL);
     }
 #ifdef RB_WITH_LEDS
-
     close(sock_c);
     free(sacl);			/*close network socket */
-
 #endif
 
     return (0);
@@ -636,53 +642,52 @@
 
 
 DRIVER drv_RouterBoard = {
-  name:Name,
-  list:drv_RB_list,
-  init:drv_RB_init,
-  quit:drv_RB_quit,
+    .name = Name,
+    .list = drv_RB_list,
+    .init = drv_RB_init,
+    .quit = drv_RB_quit,
 };
 
 
 
-/* 
+#if 0
 
 Simple example to send led status to port 3333
 #include <stdio.h>
 #include <arpa/inet.h>
 #include <errno.h>
-
-int send_packet (unsigned char leds)
+int send_packet(unsigned char leds)
 {
     struct sockaddr_in *sas;
     int sock;
     char msg[20];
-    msg[0]=leds;
-    msg[1]=0;
-    
+    msg[0] = leds;
+    msg[1] = 0;
+
     if ((sock = socket(AF_INET, SOCK_DGRAM, IPPROTO_UDP)) < 0) {
 	fprintf(stderr, "Socket option failed.\n");
 	return -1;
     }
-    
-    if (( sas = (struct sockaddr_in *) malloc(sizeof(struct sockaddr_in))) == NULL) 
-            return -1 ;
-    memset( sas, 0, sizeof(struct sockaddr_in));
+
+    if ((sas = (struct sockaddr_in *) malloc(sizeof(struct sockaddr_in))) == NULL)
+	return -1;
+    memset(sas, 0, sizeof(struct sockaddr_in));
     sas->sin_family = AF_INET;
     sas->sin_port = htons(3333);
     sas->sin_addr.s_addr = inet_addr("127.0.0.1");
-    if(sendto(sock,msg,6, 0, (struct sockaddr *) sas, sizeof(struct sockaddr_in)) > 0) 
-      { free(sas);
+    if (sendto(sock, msg, 6, 0, (struct sockaddr *) sas, sizeof(struct sockaddr_in)) > 0) {
+	free(sas);
 	return 1;
-       }  //sent ok to dest
-
+    }
+    /* sent ok to dest */
     free(sas);
-    return -1;	//Send failed
+    return -1;			/* Send failed */
 }
-  
-int main ()
+
+int main()
 {
- send_packet(0x03);
- return 0;
-} 
+    send_packet(0x03);
+    return 0;
+}
 
-*/
+#endif
diff -urN lcd4linux-0.10.0/drv_Sample.c lcd4linux-0.11.0-SVN/drv_Sample.c
--- lcd4linux-0.10.0/drv_Sample.c	1970-01-01 01:00:00.000000000 +0100
+++ lcd4linux-0.11.0-SVN/drv_Sample.c	2008-12-31 08:05:54.000000000 +0100
@@ -0,0 +1,601 @@
+/* $Id: drv_Sample.c 840 2007-09-09 12:17:42Z michael $
+ * $URL: https://ssl.bulix.org/svn/lcd4linux/trunk/drv_Sample.c $
+ *
+ * sample lcd4linux driver
+ *
+ * Copyright (C) 2005 Michael Reinelt <michael@reinelt.co.at>
+ * Copyright (C) 2005, 2006, 2007 The LCD4Linux Team <lcd4linux-devel@users.sourceforge.net>
+ *
+ * This file is part of LCD4Linux.
+ *
+ * LCD4Linux is free software; you can redistribute it and/or modify
+ * it under the terms of the GNU General Public License as published by
+ * the Free Software Foundation; either version 2, or (at your option)
+ * any later version.
+ *
+ * LCD4Linux is distributed in the hope that it will be useful,
+ * but WITHOUT ANY WARRANTY; without even the implied warranty of
+ * MERCHANTABILITY or FITNESS FOR A PARTICULAR PURPOSE.  See the
+ * GNU General Public License for more details.
+ *
+ * You should have received a copy of the GNU General Public License
+ * along with this program; if not, write to the Free Software
+ * Foundation, Inc., 675 Mass Ave, Cambridge, MA 02139, USA.
+ *
+ */
+
+/* 
+ *
+ * exported fuctions:
+ *
+ * struct DRIVER drv_Sample
+ *
+ */
+
+#include "config.h"
+
+#include <stdlib.h>
+#include <stdio.h>
+#include <unistd.h>
+#include <string.h>
+#include <errno.h>
+
+#include "debug.h"
+#include "cfg.h"
+#include "qprintf.h"
+#include "udelay.h"
+#include "plugin.h"
+#include "widget.h"
+#include "widget_text.h"
+#include "widget_icon.h"
+#include "widget_bar.h"
+#include "drv.h"
+
+/* text mode display? */
+#include "drv_generic_text.h"
+
+/* graphic display? */
+#include "drv_generic_graphic.h"
+
+/* GPO's? */
+#include "drv_generic_gpio.h"
+
+/* serial port? */
+#include "drv_generic_serial.h"
+
+/* parallel port? */
+#include "drv_generic_parport.h"
+
+/* i2c bus? */
+#ifdef WITH_I2C
+#include "drv_generic_i2c.h"
+#endif
+
+
+static char Name[] = "Sample";
+
+
+/* for parallel port displays only */
+/* use whatever lines you need */
+static unsigned char SIGNAL_RS;
+static unsigned char SIGNAL_EX;
+
+
+
+/****************************************/
+/***  hardware dependant functions    ***/
+/****************************************/
+
+/* low-level parallel port stuff */
+/* example for sending one byte over the wire */
+static void drv_Sample_bang(const unsigned int data)
+{
+    /* put data on DB1..DB8 */
+    drv_generic_parport_data(data & 0xff);
+
+    /* set/clear some signals */
+    drv_generic_parport_control(SIGNAL_RS, SIGNAL_RS);
+
+    /* data setup time (e.g. 200 ns) */
+    ndelay(200);
+
+    /* send byte */
+    /* signal pulse width 500ns */
+    drv_generic_parport_toggle(SIGNAL_EX, 1, 500);
+
+    /* wait for command completion (e.g. 100 us) */
+    udelay(100);
+}
+
+
+static int drv_Sample_open(const char *section)
+{
+    /* open serial port */
+    /* don't mind about device, speed and stuff, this function will take care of */
+
+    if (drv_generic_serial_open(section, Name, 0) < 0)
+	return -1;
+
+
+    /* opening the parallel port is a bit more tricky: */
+    /* you have to do all the bit-banging yourself... */
+
+    if (drv_generic_parport_open(section, Name) != 0) {
+	error("%s: could not initialize parallel port!", Name);
+	return -1;
+    }
+
+    /* read the wiring from config */
+    if ((SIGNAL_EX = drv_generic_parport_wire_ctrl("EX", "STROBE")) == 0xff)
+	return -1;
+    if ((SIGNAL_RS = drv_generic_parport_wire_ctrl("RS", "INIT")) == 0xff)
+	return -1;
+
+    /* clear all signals */
+    drv_generic_parport_control(SIGNAL_EX | SIGNAL_RS, 0);
+
+    /* set direction: write */
+    drv_generic_parport_direction(0);
+
+    return 0;
+}
+
+
+static int drv_Sample_close(void)
+{
+    /* close whatever port you've opened */
+    drv_generic_parport_close();
+    drv_generic_serial_close();
+
+    return 0;
+}
+
+
+/* dummy function that sends something to the display */
+static void drv_Sample_send(const char *data, const unsigned int len)
+{
+    unsigned int i;
+
+    /* send data to the serial port is easy... */
+    drv_generic_serial_write(data, len);
+
+    /* sending data to the parallel port is a bit more tricky... */
+    for (i = 0; i < len; i++) {
+	drv_Sample_bang(*data++);
+    }
+}
+
+
+/* text mode displays only */
+static void drv_Sample_clear(void)
+{
+    char cmd[1];
+
+    /* do whatever is necessary to clear the display */
+    /* assume 0x01 to be a 'clear display' command */
+    cmd[0] = 0x01;
+    drv_Sample_send(cmd, 1);
+}
+
+
+/* text mode displays only */
+static void drv_Sample_write(const int row, const int col, const char *data, int len)
+{
+    char cmd[3];
+
+    /* do the cursor positioning here */
+    /* assume 0x02 to be a 'Goto' command */
+    cmd[0] = 0x02;
+    cmd[1] = row;
+    cmd[2] = col;
+    drv_Sample_send(cmd, 3);
+
+    /* send string to the display */
+    drv_Sample_send(data, len);
+
+}
+
+/* text mode displays only */
+static void drv_Sample_defchar(const int ascii, const unsigned char *matrix)
+{
+    char cmd[10];
+    int i;
+
+    /* call the 'define character' function */
+    /* assume 0x03 to be the 'defchar' command */
+    cmd[0] = 0x03;
+    cmd[1] = ascii;
+
+    /* send bitmap to the display */
+    for (i = 0; i < 8; i++) {
+	cmd[i + 2] = *matrix++;
+    }
+    drv_Sample_send(cmd, 10);
+}
+
+
+/* for graphic displays only */
+static void drv_Sample_blit(const int row, const int col, const int height, const int width)
+{
+    int r, c;
+
+    for (r = row; r < row + height; r++) {
+	for (c = col; c < col + width; c++) {
+	    /* drv_generic_graphic_black() returns 1 if pixel is black */
+	    /* drv_generic_graphic_gray() returns a gray value 0..255 */
+	    /* drv_generic_graphic_rgb() returns a RGB color */
+	    if (drv_generic_graphic_black(r, c)) {
+		/* set bit */
+	    } else {
+		/* clear bit */
+	    }
+	}
+    }
+}
+
+
+/* remove unless you have GPO's */
+static int drv_Sample_GPO(const int num, const int val)
+{
+    char cmd[4];
+
+    /* assume 0x42 to be the 'GPO' command */
+    cmd[0] = 0x42;
+    cmd[1] = num;
+    cmd[2] = (val > 0) ? 1 : 0;
+
+    drv_Sample_send(cmd, 3);
+
+    return 0;
+}
+
+
+/* example function used in a plugin */
+static int drv_Sample_contrast(int contrast)
+{
+    char cmd[2];
+
+    /* adjust limits according to the display */
+    if (contrast < 0)
+	contrast = 0;
+    if (contrast > 255)
+	contrast = 255;
+
+    /* call a 'contrast' function */
+    /* assume 0x04 to be the 'set contrast' command */
+    cmd[0] = 0x04;
+    cmd[1] = contrast;
+    drv_Sample_send(cmd, 2);
+
+    return contrast;
+}
+
+
+/* start text mode display */
+static int drv_Sample_start(const char *section)
+{
+    int contrast;
+    int rows = -1, cols = -1;
+    char *s;
+    char cmd[1];
+
+    s = cfg_get(section, "Size", NULL);
+    if (s == NULL || *s == '\0') {
+	error("%s: no '%s.Size' entry from %s", Name, section, cfg_source());
+	return -1;
+    }
+    if (sscanf(s, "%dx%d", &cols, &rows) != 2 || rows < 1 || cols < 1) {
+	error("%s: bad %s.Size '%s' from %s", Name, section, s, cfg_source());
+	free(s);
+	return -1;
+    }
+
+    DROWS = rows;
+    DCOLS = cols;
+
+    /* number of GPO's; remove if you don't have them */
+    GPOS = 8;
+
+    /* open communication with the display */
+    if (drv_Sample_open(section) < 0) {
+	return -1;
+    }
+
+    /* reset & initialize display */
+    /* assume 0x00 to be a 'reset' command */
+    cmd[0] = 0x00;
+    drv_Sample_send(cmd, 0);
+
+    if (cfg_number(section, "Contrast", 0, 0, 255, &contrast) > 0) {
+	drv_Sample_contrast(contrast);
+    }
+
+    drv_Sample_clear();		/* clear display */
+
+    return 0;
+}
+
+
+/* start graphic display */
+static int drv_Sample_start2(const char *section)
+{
+    char *s;
+    char cmd[1];
+    int contrast;
+
+    /* read display size from config */
+    s = cfg_get(section, "Size", NULL);
+    if (s == NULL || *s == '\0') {
+	error("%s: no '%s.Size' entry from %s", Name, section, cfg_source());
+	return -1;
+    }
+
+    DROWS = -1;
+    DCOLS = -1;
+    if (sscanf(s, "%dx%d", &DCOLS, &DROWS) != 2 || DCOLS < 1 || DROWS < 1) {
+	error("%s: bad Size '%s' from %s", Name, s, cfg_source());
+	return -1;
+    }
+
+    s = cfg_get(section, "Font", "6x8");
+    if (s == NULL || *s == '\0') {
+	error("%s: no '%s.Font' entry from %s", Name, section, cfg_source());
+	return -1;
+    }
+
+    XRES = -1;
+    YRES = -1;
+    if (sscanf(s, "%dx%d", &XRES, &YRES) != 2 || XRES < 1 || YRES < 1) {
+	error("%s: bad Font '%s' from %s", Name, s, cfg_source());
+	return -1;
+    }
+
+    /* Fixme: provider other fonts someday... */
+    if (XRES != 6 && YRES != 8) {
+	error("%s: bad Font '%s' from %s (only 6x8 at the moment)", Name, s, cfg_source());
+	return -1;
+    }
+
+    /* you surely want to allocate a framebuffer or something... */
+
+    /* open communication with the display */
+    if (drv_Sample_open(section) < 0) {
+	return -1;
+    }
+
+    /* reset & initialize display */
+    /* assume 0x00 to be a 'reset' command */
+    cmd[0] = 0x00;
+    drv_Sample_send(cmd, 1);
+
+    if (cfg_number(section, "Contrast", 0, 0, 255, &contrast) > 0) {
+	drv_Sample_contrast(contrast);
+    }
+
+    return 0;
+}
+
+
+/****************************************/
+/***            plugins               ***/
+/****************************************/
+
+static void plugin_contrast(RESULT * result, RESULT * arg1)
+{
+    double contrast;
+
+    contrast = drv_Sample_contrast(R2N(arg1));
+    SetResult(&result, R_NUMBER, &contrast);
+}
+
+
+/****************************************/
+/***        widget callbacks          ***/
+/****************************************/
+
+
+/* using drv_generic_text_draw(W) */
+/* using drv_generic_text_icon_draw(W) */
+/* using drv_generic_text_bar_draw(W) */
+/* using drv_generic_gpio_draw(W) */
+
+
+/****************************************/
+/***        exported functions        ***/
+/****************************************/
+
+
+/* list models */
+int drv_Sample_list(void)
+{
+    printf("generic");
+    return 0;
+}
+
+
+/* initialize driver & display */
+/* use this function for a text display */
+int drv_Sample_init(const char *section, const int quiet)
+{
+    WIDGET_CLASS wc;
+    int ret;
+
+    info("%s: %s", Name, "$Rev: 840 $");
+
+    /* display preferences */
+    XRES = 5;			/* pixel width of one char  */
+    YRES = 8;			/* pixel height of one char  */
+    CHARS = 8;			/* number of user-defineable characters */
+    CHAR0 = 0;			/* ASCII of first user-defineable char */
+    GOTO_COST = 2;		/* number of bytes a goto command requires */
+
+    /* real worker functions */
+    drv_generic_text_real_write = drv_Sample_write;
+    drv_generic_text_real_defchar = drv_Sample_defchar;
+
+    /* remove unless you have GPO's */
+    drv_generic_gpio_real_set = drv_Sample_GPO;
+
+
+    /* start display */
+    if ((ret = drv_Sample_start(section)) != 0)
+	return ret;
+
+    if (!quiet) {
+	char buffer[40];
+	qprintf(buffer, sizeof(buffer), "%s %dx%d", Name, DCOLS, DROWS);
+	if (drv_generic_text_greet(buffer, "www.bwct.de")) {
+	    sleep(3);
+	    drv_Sample_clear();
+	}
+    }
+
+    /* initialize generic text driver */
+    if ((ret = drv_generic_text_init(section, Name)) != 0)
+	return ret;
+
+    /* initialize generic icon driver */
+    if ((ret = drv_generic_text_icon_init()) != 0)
+	return ret;
+
+    /* initialize generic bar driver */
+    if ((ret = drv_generic_text_bar_init(0)) != 0)
+	return ret;
+
+    /* add fixed chars to the bar driver */
+    drv_generic_text_bar_add_segment(0, 0, 255, 32);	/* ASCII  32 = blank */
+
+
+    /* initialize generic GPIO driver */
+    /* remove unless you have GPO's */
+    if ((ret = drv_generic_gpio_init(section, Name)) != 0)
+	return ret;
+
+    /* register text widget */
+    wc = Widget_Text;
+    wc.draw = drv_generic_text_draw;
+    widget_register(&wc);
+
+    /* register icon widget */
+    wc = Widget_Icon;
+    wc.draw = drv_generic_text_icon_draw;
+    widget_register(&wc);
+
+    /* register bar widget */
+    wc = Widget_Bar;
+    wc.draw = drv_generic_text_bar_draw;
+    widget_register(&wc);
+
+    /* register plugins */
+    AddFunction("LCD::contrast", 1, plugin_contrast);
+
+    return 0;
+}
+
+
+/* initialize driver & display */
+/* use this function for a graphic display */
+int drv_Sample_init2(const char *section, const int quiet)
+{
+    int ret;
+
+    /* real worker functions */
+    drv_generic_graphic_real_blit = drv_Sample_blit;
+
+    /* remove unless you have GPO's */
+    drv_generic_gpio_real_set = drv_Sample_GPO;
+
+    /* start display */
+    if ((ret = drv_Sample_start2(section)) != 0)
+	return ret;
+
+    /* initialize generic graphic driver */
+    if ((ret = drv_generic_graphic_init(section, Name)) != 0)
+	return ret;
+
+    if (!quiet) {
+	char buffer[40];
+	qprintf(buffer, sizeof(buffer), "%s %dx%d", Name, DCOLS, DROWS);
+	if (drv_generic_graphic_greet(buffer, NULL)) {
+	    sleep(3);
+	    drv_generic_graphic_clear();
+	}
+    }
+
+    /* register plugins */
+    AddFunction("LCD::contrast", 1, plugin_contrast);
+
+    return 0;
+}
+
+
+
+/* close driver & display */
+/* use this function for a text display */
+int drv_Sample_quit(const int quiet)
+{
+
+    info("%s: shutting down.", Name);
+
+    drv_generic_text_quit();
+
+    /* remove unless you have GPO's */
+    drv_generic_gpio_quit();
+
+    /* clear display */
+    drv_Sample_clear();
+
+    /* say goodbye... */
+    if (!quiet) {
+	drv_generic_text_greet("goodbye!", NULL);
+    }
+
+    debug("closing connection");
+    drv_Sample_close();
+
+    return (0);
+}
+
+/* close driver & display */
+/* use this function for a graphic display */
+int drv_Sample_quit2(const int quiet)
+{
+
+    info("%s: shutting down.", Name);
+
+    /* clear display */
+    drv_generic_graphic_clear();
+
+    /* remove unless you have GPO's */
+    drv_generic_gpio_quit();
+
+    /* say goodbye... */
+    if (!quiet) {
+	drv_generic_graphic_greet("goodbye!", NULL);
+    }
+
+    drv_generic_graphic_quit();
+
+    debug("closing connection");
+    drv_Sample_close();
+
+    return (0);
+}
+
+
+/* use this one for a text display */
+DRIVER drv_Sample = {
+    .name = Name,
+    .list = drv_Sample_list,
+    .init = drv_Sample_init,
+    .quit = drv_Sample_quit,
+};
+
+
+/* use this one for a graphic display */
+DRIVER drv_Sample2 = {
+    .name = Name,
+    .list = drv_Sample_list,
+    .init = drv_Sample_init2,
+    .quit = drv_Sample_quit2,
+};
diff -urN lcd4linux-0.10.0/drv_serdisplib.c lcd4linux-0.11.0-SVN/drv_serdisplib.c
--- lcd4linux-0.10.0/drv_serdisplib.c	2005-05-28 11:06:14.000000000 +0200
+++ lcd4linux-0.11.0-SVN/drv_serdisplib.c	2009-01-13 05:54:45.000000000 +0100
@@ -1,8 +1,9 @@
-/* $Id: drv_serdisplib.c,v 1.5 2005/05/28 09:06:14 reinelt Exp $
+/* $Id: drv_serdisplib.c 958 2009-01-13 04:21:29Z michael $
+ * $URL: https://ssl.bulix.org/svn/lcd4linux/trunk/drv_serdisplib.c $
  *
  * driver for serdisplib displays
  *
- * Copyright (C) 2005 Michael Reinelt <reinelt@eunet.at>
+ * Copyright (C) 2005 Michael Reinelt <michael@reinelt.co.at>
  * Copyright (C) 2005 The LCD4Linux Team <lcd4linux-devel@users.sourceforge.net>
  *
  * This file is part of LCD4Linux.
@@ -21,23 +22,6 @@
  * along with this program; if not, write to the Free Software
  * Foundation, Inc., 675 Mass Ave, Cambridge, MA 02139, USA.
  *
- *
- * $Log: drv_serdisplib.c,v $
- * Revision 1.5  2005/05/28 09:06:14  reinelt
- * serdisplib cosmetics
- *
- * Revision 1.4  2005/05/12 14:55:47  reinelt
- * plugins for serdisplib driver
- *
- * Revision 1.3  2005/05/12 05:52:43  reinelt
- * serdisplib GET_VERSION_MAJOR macro
- *
- * Revision 1.2  2005/05/11 04:27:49  reinelt
- * small serdisplib bugs fixed
- *
- * Revision 1.1  2005/05/10 13:20:14  reinelt
- * added serdisplib driver
- *
  */
 
 /* 
@@ -49,6 +33,7 @@
  */
 
 #include "config.h"
+#include "debug.h"		// verbose_level
 
 #include <stdlib.h>
 #include <stdio.h>
@@ -70,10 +55,6 @@
 #include "cfg.h"
 #include "qprintf.h"
 #include "plugin.h"
-#include "widget.h"
-#include "widget_text.h"
-#include "widget_icon.h"
-#include "widget_bar.h"
 #include "drv.h"
 #include "drv_generic_graphic.h"
 
@@ -86,6 +67,8 @@
 static serdisp_CONN_t *sdcd;
 static serdisp_t *dd;
 
+int NUMCOLS = 1;
+
 
 /****************************************/
 /***  hardware dependant functions    ***/
@@ -94,12 +77,13 @@
 static void drv_SD_blit(const int row, const int col, const int height, const int width)
 {
     int r, c;
-    long color;
+    RGBA p;
 
     for (r = row; r < row + height; r++) {
 	for (c = col; c < col + width; c++) {
-	    color = drv_generic_graphic_FB[r * LCOLS + c] ? SD_COL_BLACK : SD_COL_WHITE;
-	    serdisp_setcolour(dd, c, r, color);
+	    p = drv_generic_graphic_rgb(r, c);
+	    // printf("blit (%d,%d) A%d.R%d.G%d.B%d\n", c, r, p.A, p.R, p.G, p.B);
+	    serdisp_setcolour(dd, c, r, serdisp_pack2ARGB(0xff, p.R, p.G, p.B));
 	}
     }
 
@@ -202,9 +186,19 @@
 	return -1;
     }
 
+    /* print supported options by display */
+    info("%s: options supported by display %s:", Name, model);
+    serdisp_options_t optiondesc;
+    optiondesc.name = "";	/* start the iteration with assigning an empty string before the first call */
+    while (serdisp_nextoptiondescription(dd, &optiondesc)) {
+	info("  %s", optiondesc.name);
+    }
+
+
     DROWS = serdisp_getheight(dd);
     DCOLS = serdisp_getwidth(dd);
-    info("%s: display size %dx%d", Name, DCOLS, DROWS);
+    NUMCOLS = serdisp_getcolours(dd);
+    info("%s: display size %dx%d, %d colors", Name, DCOLS, DROWS, NUMCOLS);
 
     XRES = -1;
     YRES = -1;
@@ -288,24 +282,42 @@
 
 
 /****************************************/
-/***        widget callbacks          ***/
+/***        exported functions        ***/
 /****************************************/
 
 
-/* using drv_generic_graphic_draw(W) */
-/* using drv_generic_graphic_icon_draw(W) */
-/* using drv_generic_graphic_bar_draw(W) */
+/* list models */
+int drv_SD_list(void)
+{
+    serdisp_display_t displaydesc;
 
+    displaydesc.dispname = "";
+    while (serdisp_nextdisplaydescription(&displaydesc)) {
+	printf("%s ", displaydesc.dispname);
+    }
 
-/****************************************/
-/***        exported functions        ***/
-/****************************************/
+    return 0;
+}
 
 
-/* list models */
-int drv_SD_list(void)
+/* verbosely list models (special case for serdisplib) */
+int drv_SD_list_verbose(void)
 {
-    printf("%s", "any");
+    serdisp_display_t displaydesc;
+    long version;
+
+    version = serdisp_getversioncode();
+    printf("%s: header version %d.%d, library version %d.%d, available sub-drivers:\n\n", Name,
+	   SERDISP_VERSION_MAJOR, SERDISP_VERSION_MINOR,
+	   SERDISP_VERSION_GET_MAJOR(version), SERDISP_VERSION_GET_MINOR(version));
+
+    printf("display name        alias names           description\n");
+    printf("------------------  --------------------  -----------------------------------\n");
+    displaydesc.dispname = "";
+    while (serdisp_nextdisplaydescription(&displaydesc)) {
+	printf("   %-15s  %-20s  %-35s\n", displaydesc.dispname, displaydesc.aliasnames, displaydesc.description);
+    }
+
     return 0;
 }
 
@@ -313,9 +325,10 @@
 /* initialize driver & display */
 int drv_SD_init(const char *section, const int quiet)
 {
-    WIDGET_CLASS wc;
     int ret;
 
+    info("%s: %s", Name, "$Rev: 958 $");
+
     /* real worker functions */
     drv_generic_graphic_real_blit = drv_SD_blit;
 
@@ -336,21 +349,6 @@
 	}
     }
 
-    /* register text widget */
-    wc = Widget_Text;
-    wc.draw = drv_generic_graphic_draw;
-    widget_register(&wc);
-
-    /* register icon widget */
-    wc = Widget_Icon;
-    wc.draw = drv_generic_graphic_icon_draw;
-    widget_register(&wc);
-
-    /* register bar widget */
-    wc = Widget_Bar;
-    wc.draw = drv_generic_graphic_bar_draw;
-    widget_register(&wc);
-
     /* register plugins */
     AddFunction("LCD::contrast", 1, plugin_contrast);
     AddFunction("LCD::backlight", 1, plugin_backlight);
@@ -382,8 +380,8 @@
 
 
 DRIVER drv_serdisplib = {
-  name:Name,
-  list:drv_SD_list,
-  init:drv_SD_init,
-  quit:drv_SD_quit,
+    .name = Name,
+    .list = drv_SD_list,
+    .init = drv_SD_init,
+    .quit = drv_SD_quit,
 };
diff -urN lcd4linux-0.10.0/drv_SimpleLCD.c lcd4linux-0.11.0-SVN/drv_SimpleLCD.c
--- lcd4linux-0.10.0/drv_SimpleLCD.c	2005-05-08 06:32:44.000000000 +0200
+++ lcd4linux-0.11.0-SVN/drv_SimpleLCD.c	2008-12-31 08:05:54.000000000 +0100
@@ -1,4 +1,5 @@
-/* $Id: drv_SimpleLCD.c,v 1.4 2005/05/08 04:32:44 reinelt Exp $
+/* $Id: drv_SimpleLCD.c 771 2007-02-25 12:27:26Z michael $
+ * $URL: https://ssl.bulix.org/svn/lcd4linux/trunk/drv_SimpleLCD.c $
  * 
  * driver for a simple serial terminal.
  * 
@@ -21,21 +22,6 @@
  * along with this program; if not, write to the Free Software
  * Foundation, Inc., 675 Mass Ave, Cambridge, MA 02139, USA.
  *
- * $Log: drv_SimpleLCD.c,v $
- * Revision 1.4  2005/05/08 04:32:44  reinelt
- * CodingStyle added and applied
- *
- * Revision 1.3  2005/04/20 05:49:21  reinelt
- * Changed the code to add some VT100-compatible control sequences (see the comments above).
- * A configfile boolean option 'VT100_Support' (default to 1) indicate if the display in
- * used support these control-sequences or not.
- *
- * Revision 1.2  2005/04/02 05:28:58  reinelt
- * fixed gcc4 warnings about signed/unsigned mismatches
- *
- * Revision 1.1  2005/02/24 07:06:48  reinelt
- * SimpleLCD driver added
- *
  */
 
 /*
@@ -124,7 +110,7 @@
 /****************************************/
 
 /** No clear function on SimpleLCD : Just send CR-LF * number of lines **/
-void drv_SL_simple_clear(void)
+static void drv_SL_simple_clear(void)
 {
     char cmd[2];
     int i;
@@ -137,7 +123,7 @@
 }
 
 /** vt-100 mode : send the ESC-code **/
-void drv_SL_vt100_clear(void)
+static void drv_SL_vt100_clear(void)
 {
     char cmd[4];
     cmd[0] = 0x1b;
@@ -145,9 +131,10 @@
     cmd[2] = '2';
     cmd[3] = 'J';
     drv_generic_serial_write(cmd, 4);
+
 }
 
-void drv_SL_clear(void)
+static void drv_SL_clear(void)
 {
     vt100_mode == 1 ? drv_SL_vt100_clear() : drv_SL_simple_clear();
 }
@@ -156,6 +143,7 @@
 /* If full_commit = true, then the whole buffer is to be sent to screen.
    if full_commit = false, then only the last line is to be sent (faster on slow screens)
 */
+
 static void drv_SL_commit(int full_commit)
 {
     int row;
@@ -198,6 +186,7 @@
 static int drv_SL_start(const char *section, const int quiet)
 {
     int rows = -1, cols = -1;
+    int value;
     unsigned int flags = 0;
     char *s;
     char *model = 0;
@@ -209,9 +198,10 @@
 	    vt100_mode = 1;
     }
 
-    cfg_number(section, "BarCharValue", 0, 0, 255, &flags);
-    bar_char = flags;
-    cfg_number(section, "Options", 0, 0, 0xffff, &flags);
+    cfg_number(section, "BarCharValue", 0, 0, 255, &value);
+    bar_char = value;
+    cfg_number(section, "Options", 0, 0, 0xffff, &value);
+    flags = value;
     if (drv_generic_serial_open(section, Name, flags) < 0)
 	return -1;
 
@@ -294,6 +284,8 @@
     WIDGET_CLASS wc;
     int ret;
 
+    info("%s: %s", Name, "$Rev: 771 $");
+
     /* display preferences */
     XRES = 5;			/* pixel width of one char  */
     YRES = 8;			/* pixel height of one char  */
@@ -303,7 +295,6 @@
     GOTO_COST = -1;		/* number of bytes a goto command requires */
 
 
-
     /* start display */
     if ((ret = drv_SL_start(section, quiet)) != 0)
 	return ret;
@@ -352,8 +343,8 @@
 
 
 DRIVER drv_SimpleLCD = {
-  name:Name,
-  list:drv_SL_list,
-  init:drv_SL_init,
-  quit:drv_SL_quit,
+    .name = Name,
+    .list = drv_SL_list,
+    .init = drv_SL_init,
+    .quit = drv_SL_quit,
 };
diff -urN lcd4linux-0.10.0/drv_st2205.c lcd4linux-0.11.0-SVN/drv_st2205.c
--- lcd4linux-0.10.0/drv_st2205.c	1970-01-01 01:00:00.000000000 +0100
+++ lcd4linux-0.11.0-SVN/drv_st2205.c	2009-01-11 16:17:31.000000000 +0100
@@ -0,0 +1,247 @@
+/* $Id: drv_st2205.c 952 2009-01-11 15:15:15Z michux $
+ * $URL: https://ssl.bulix.org/svn/lcd4linux/trunk/drv_st2205.c $
+ *
+ * ST2205U-driven hacked picture frame driver.
+ * See http://picframe.spritesserver.nl/ for more info.
+ * 
+ * Copyright (C) 2008 Jeroen Domburg <picframe@spritesmods.com>
+ * Modified from sample code by:
+ * Copyright (C) 2005 Michael Reinelt <michael@reinelt.co.at>
+ * Copyright (C) 2005, 2006, 2007 The LCD4Linux Team <lcd4linux-devel@users.sourceforge.net>
+ *
+ * This file is part of LCD4Linux.
+ *
+ * LCD4Linux is free software; you can redistribute it and/or modify
+ * it under the terms of the GNU General Public License as published by
+ * the Free Software Foundation; either version 2, or (at your option)
+ * any later version.
+ *
+ * LCD4Linux is distributed in the hope that it will be useful,
+ * but WITHOUT ANY WARRANTY; without even the implied warranty of
+ * MERCHANTABILITY or FITNESS FOR A PARTICULAR PURPOSE.  See the
+ * GNU General Public License for more details.
+ *
+ * You should have received a copy of the GNU General Public License
+ * along with this program; if not, write to the Free Software
+ * Foundation, Inc., 675 Mass Ave, Cambridge, MA 02139, USA.
+ *
+ */
+
+/* 
+ *
+ * exported fuctions:
+ *
+ * struct DRIVER drv_st2205
+ *
+ */
+
+#include "config.h"
+
+#include <stdlib.h>
+#include <stdio.h>
+#include <unistd.h>
+#include <string.h>
+#include <errno.h>
+
+#include <st2205.h>
+
+#include "debug.h"
+#include "cfg.h"
+#include "qprintf.h"
+#include "udelay.h"
+#include "plugin.h"
+#include "widget.h"
+#include "widget_text.h"
+#include "widget_icon.h"
+#include "widget_bar.h"
+#include "drv.h"
+
+#include "drv_generic_graphic.h"
+
+static char Name[] = "st2205";
+/* libst2205 handle */
+static st2205_handle *h;
+/* Display data */
+static unsigned char *fb;
+
+static int drv_st2205_open(const char *section)
+{
+    char *dev;
+
+    dev = cfg_get(section, "Port", NULL);
+    if (dev == NULL || *dev == '\0') {
+	error("st2205: no '%s.Port' entry from %s", section, cfg_source());
+	return -1;
+    }
+
+    h = st2205_open(dev);
+    if (h == NULL) {
+	error("st2205: cannot open st2205 device %s", dev);
+	return -1;
+    }
+
+    return 0;
+}
+
+
+static int drv_st2205_close(void)
+{
+    st2205_close(h);
+
+    return 0;
+}
+
+
+static void drv_st2205_blit(const int row, const int col, const int height, const int width)
+{
+    int r, c;
+    RGBA p;
+    for (r = row; r < row + height; r++) {
+	for (c = col; c < col + width; c++) {
+	    p = drv_generic_graphic_rgb(r, c);
+	    fb[(r * h->width + c) * 3 + 0] = p.R;
+	    fb[(r * h->width + c) * 3 + 1] = p.G;
+	    fb[(r * h->width + c) * 3 + 2] = p.B;
+	}
+    }
+    st2205_send_data(h, fb);
+}
+
+
+/* start graphic display */
+static int drv_st2205_start2(const char *section)
+{
+    char *s;
+
+    s = cfg_get(section, "Font", "6x8");
+    if (s == NULL || *s == '\0') {
+	error("%s: no '%s.Font' entry from %s", Name, section, cfg_source());
+	return -1;
+    }
+
+    XRES = -1;
+    YRES = -1;
+    if (sscanf(s, "%dx%d", &XRES, &YRES) != 2 || XRES < 1 || YRES < 1) {
+	error("%s: bad Font '%s' from %s", Name, s, cfg_source());
+	return -1;
+    }
+
+    /* Fixme: provider other fonts someday... */
+    if (XRES != 6 && YRES != 8) {
+	error("%s: bad Font '%s' from %s (only 6x8 at the moment)", Name, s, cfg_source());
+	return -1;
+    }
+
+
+    /* open communication with the display */
+    if (drv_st2205_open(section) < 0) {
+	return -1;
+    }
+
+    /* you surely want to allocate a framebuffer or something... */
+    fb = malloc(h->height * h->width * 3);
+
+    /* set width/height from st2205 firmware specs */
+    DROWS = h->width;
+    DCOLS = h->height;
+
+    return 0;
+}
+
+/****************************************/
+/***            plugins               ***/
+/****************************************/
+
+static void plugin_backlight(RESULT * result, RESULT * arg1)
+{
+    int bl_on;
+    bl_on = (R2N(arg1) == 0 ? 0 : 1);
+    st2205_backlight(h, bl_on);
+    SetResult(&result, R_NUMBER, &bl_on);
+}
+
+
+/****************************************/
+/***        widget callbacks          ***/
+/****************************************/
+
+
+/* using drv_generic_text_draw(W) */
+/* using drv_generic_text_icon_draw(W) */
+/* using drv_generic_text_bar_draw(W) */
+/* using drv_generic_gpio_draw(W) */
+
+
+/****************************************/
+/***        exported functions        ***/
+/****************************************/
+
+
+/* list models */
+int drv_st2205_list(void)
+{
+    printf("generic");
+    return 0;
+}
+
+
+/* initialize driver & display */
+int drv_st2205_init2(const char *section, const int quiet)
+{
+    int ret;
+
+    /* real worker functions */
+    drv_generic_graphic_real_blit = drv_st2205_blit;
+
+    /* start display */
+    if ((ret = drv_st2205_start2(section)) != 0)
+	return ret;
+
+    /* initialize generic graphic driver */
+    if ((ret = drv_generic_graphic_init(section, Name)) != 0)
+	return ret;
+
+    if (!quiet) {
+	char buffer[40];
+	qprintf(buffer, sizeof(buffer), "%s %dx%d", Name, DCOLS, DROWS);
+	if (drv_generic_graphic_greet(buffer, NULL)) {
+	    sleep(3);
+	    drv_generic_graphic_clear();
+	}
+    }
+
+    /* register plugins */
+    AddFunction("LCD::backlight", 1, plugin_backlight);
+
+    return 0;
+}
+
+
+/* close driver & display */
+int drv_st2205_quit2(const int quiet)
+{
+    info("%s: shutting down.", Name);
+
+    /* clear display */
+    drv_generic_graphic_clear();
+
+    /* say goodbye... */
+    if (!quiet) {
+	drv_generic_graphic_greet("goodbye!", NULL);
+    }
+
+    drv_generic_graphic_quit();
+
+    debug("closing connection");
+    drv_st2205_close();
+
+    return (0);
+}
+
+
+DRIVER drv_st2205 = {
+    .name = Name,
+    .list = drv_st2205_list,
+    .init = drv_st2205_init2,
+    .quit = drv_st2205_quit2,
+};
diff -urN lcd4linux-0.10.0/drv_T6963.c lcd4linux-0.11.0-SVN/drv_T6963.c
--- lcd4linux-0.10.0/drv_T6963.c	2005-05-08 06:32:44.000000000 +0200
+++ lcd4linux-0.11.0-SVN/drv_T6963.c	2008-12-31 08:05:54.000000000 +0100
@@ -1,8 +1,9 @@
-/* $Id: drv_T6963.c,v 1.16 2005/05/08 04:32:44 reinelt Exp $
+/* $Id: drv_T6963.c 840 2007-09-09 12:17:42Z michael $
+ * $URL: https://ssl.bulix.org/svn/lcd4linux/trunk/drv_T6963.c $
  *
  * new style driver for T6963-based displays
  *
- * Copyright (C) 2003 Michael Reinelt <reinelt@eunet.at>
+ * Copyright (C) 2003 Michael Reinelt <michael@reinelt.co.at>
  * Copyright (C) 2004 The LCD4Linux Team <lcd4linux-devel@users.sourceforge.net>
  *
  * This file is part of LCD4Linux.
@@ -21,72 +22,6 @@
  * along with this program; if not, write to the Free Software
  * Foundation, Inc., 675 Mass Ave, Cambridge, MA 02139, USA.
  *
- *
- * $Log: drv_T6963.c,v $
- * Revision 1.16  2005/05/08 04:32:44  reinelt
- * CodingStyle added and applied
- *
- * Revision 1.15  2005/05/05 08:36:12  reinelt
- * changed SELECT to SLCTIN
- *
- * Revision 1.14  2005/01/18 06:30:23  reinelt
- * added (C) to all copyright statements
- *
- * Revision 1.13  2004/12/22 20:24:02  reinelt
- * T6963 fix for displays > 8 rows
- *
- * Revision 1.12  2004/06/26 12:04:59  reinelt
- *
- * uh-oh... the last CVS log message messed up things a lot...
- *
- * Revision 1.11  2004/06/26 09:27:21  reinelt
- *
- * added '-W' to CFLAGS
- * changed all C++ comments to C ones
- * cleaned up a lot of signed/unsigned mistakes
- *
- * Revision 1.10  2004/06/20 10:09:54  reinelt
- *
- * 'const'ified the whole source
- *
- * Revision 1.9  2004/06/17 06:23:39  reinelt
- *
- * hash handling rewritten to solve performance issues
- *
- * Revision 1.8  2004/06/09 06:40:29  reinelt
- *
- * splash screen for T6963 driver
- *
- * Revision 1.7  2004/06/06 06:51:59  reinelt
- *
- * do not display end splash screen if quiet=1
- *
- * Revision 1.6  2004/06/02 09:41:19  reinelt
- *
- * prepared support for startup splash screen
- *
- * Revision 1.5  2004/06/01 06:45:30  reinelt
- *
- * some Fixme's processed
- * documented some code
- *
- * Revision 1.4  2004/02/24 05:55:04  reinelt
- *
- * X11 driver ported
- *
- * Revision 1.3  2004/02/22 17:35:41  reinelt
- * some fixes for generic graphic driver and T6963
- * removed ^M from plugin_imon (Nico, are you editing under Windows?)
- *
- * Revision 1.2  2004/02/18 06:39:20  reinelt
- * T6963 driver for graphic displays finished
- *
- * Revision 1.1  2004/02/15 21:43:43  reinelt
- * T6963 driver nearly finished
- * framework for graphic displays done
- * i2c_sensors patch from Xavier
- * some more old generation files removed
- *
  */
 
 /* 
@@ -113,10 +48,6 @@
 #include "qprintf.h"
 #include "udelay.h"
 #include "plugin.h"
-#include "widget.h"
-#include "widget_text.h"
-#include "widget_icon.h"
-#include "widget_bar.h"
 #include "drv.h"
 #include "drv_generic_graphic.h"
 #include "drv_generic_parport.h"
@@ -139,6 +70,19 @@
 };
 
 
+/* font width of display */
+static int CELL;
+
+/* text rows/columns */
+static int TROWS, TCOLS;
+
+/* SingleScan or DualScan */
+static int DualScan = 0;
+
+/* Timings */
+static int T_ACC, T_OH, T_PW, T_DH, T_CDS;
+
+/* soft-wiring */
 static unsigned char SIGNAL_CE;
 static unsigned char SIGNAL_CD;
 static unsigned char SIGNAL_RD;
@@ -164,8 +108,8 @@
     /* lower CE and RD */
     drv_generic_parport_control(SIGNAL_CE | SIGNAL_RD, 0);
 
-    /* Access Time: 150 ns  */
-    ndelay(150);
+    /* Access Time */
+    ndelay(T_ACC);
 
     /* wait for STA0=1 and STA1=1 */
     n = 0;
@@ -181,8 +125,8 @@
     /* rise RD and CE */
     drv_generic_parport_control(SIGNAL_RD | SIGNAL_CE, SIGNAL_RD | SIGNAL_CE);
 
-    /* Output Hold Time: 50 ns  */
-    ndelay(50);
+    /* Output Hold Time */
+    ndelay(T_OH);
 
     /* turn on data line drivers */
     drv_generic_parport_direction(0);
@@ -200,8 +144,8 @@
     /* lower RD and CE */
     drv_generic_parport_control(SIGNAL_RD | SIGNAL_CE, 0);
 
-    /* Access Time: 150 ns  */
-    ndelay(150);
+    /* Access Time */
+    ndelay(T_ACC);
 
     /* wait for STA3=1 */
     n = 0;
@@ -217,8 +161,8 @@
     /* rise RD and CE */
     drv_generic_parport_control(SIGNAL_RD | SIGNAL_CE, SIGNAL_RD | SIGNAL_CE);
 
-    /* Output Hold Time: 50 ns  */
-    ndelay(50);
+    /* Output Hold Time */
+    ndelay(T_OH);
 
     /* turn on data line drivers */
     drv_generic_parport_direction(0);
@@ -237,13 +181,13 @@
     drv_generic_parport_control(SIGNAL_WR | SIGNAL_CE, 0);
 
     /* Pulse width */
-    ndelay(80);
+    ndelay(T_PW);
 
     /* rise WR and CE */
     drv_generic_parport_control(SIGNAL_WR | SIGNAL_CE, SIGNAL_WR | SIGNAL_CE);
 
     /* Data Hold Time */
-    ndelay(40);
+    ndelay(T_DH);
 }
 
 
@@ -259,19 +203,19 @@
     drv_generic_parport_control(SIGNAL_CD, 0);
 
     /* C/D Setup Time */
-    ndelay(20);
+    ndelay(T_CDS);
 
     /* lower WR and CE */
     drv_generic_parport_control(SIGNAL_WR | SIGNAL_CE, 0);
 
     /* Pulse Width */
-    ndelay(80);
+    ndelay(T_PW);
 
     /* rise WR and CE */
     drv_generic_parport_control(SIGNAL_WR | SIGNAL_CE, SIGNAL_WR | SIGNAL_CE);
 
     /* Data Hold Time */
-    ndelay(40);
+    ndelay(T_DH);
 
     /* rise CD */
     drv_generic_parport_control(SIGNAL_CD, SIGNAL_CD);
@@ -290,19 +234,19 @@
     drv_generic_parport_control(SIGNAL_CD, 0);
 
     /* C/D Setup Time */
-    ndelay(20);
+    ndelay(T_CDS);
 
     /* lower WR and CE */
     drv_generic_parport_control(SIGNAL_WR | SIGNAL_CE, 0);
 
     /* Pulse Width */
-    ndelay(80);
+    ndelay(T_PW);
 
     /* rise WR and CE */
     drv_generic_parport_control(SIGNAL_WR | SIGNAL_CE, SIGNAL_WR | SIGNAL_CE);
 
     /* Data Hold Time */
-    ndelay(40);
+    ndelay(T_DH);
 
     /* rise CD */
     drv_generic_parport_control(SIGNAL_CD, SIGNAL_CD);
@@ -332,7 +276,7 @@
     drv_T6_send_word(0x24, addr);	/* Set Adress Pointer */
     drv_T6_write_cmd(0xb0);	/* Set Data Auto Write */
     for (i = 0; i < len; i++) {
-	drv_T6_write_auto(0);
+	drv_T6_write_auto(0x0);
 	if (bug) {
 	    bug = 0;
 	    debug("bug occured at byte %d of %d", i, len);
@@ -347,7 +291,7 @@
 {
     int i;
 
-    drv_T6_send_word(0x24, 0x0200 + addr);	/* Set Adress Pointer */
+    drv_T6_send_word(0x24, addr);	/* Set Adress Pointer */
     drv_T6_write_cmd(0xb0);	/* Set Data Auto Write */
     for (i = 0; i < len; i++) {
 	drv_T6_write_auto(*(data++));
@@ -363,64 +307,43 @@
 
 static void drv_T6_blit(const int row, const int col, const int height, const int width)
 {
-    int i, j, e, m;
-    int r, c;
+    int r, c, a, b;
+    int i, j, e, n;
+    int base;
 
     for (r = row; r < row + height; r++) {
 	for (c = col; c < col + width; c++) {
-	    unsigned char mask = 1 << (XRES - 1 - c % XRES);
-	    if (drv_generic_graphic_FB[r * LCOLS + c]) {
+	    unsigned char mask = 1 << (CELL - 1 - c % CELL);
+	    if (drv_generic_graphic_black(r, c)) {
 		/* set bit */
-		Buffer1[(r * DCOLS + c) / XRES] |= mask;
+		Buffer1[(r * DCOLS + c) / CELL] |= mask;
 	    } else {
 		/* clear bit */
-		Buffer1[(r * DCOLS + c) / XRES] &= ~mask;
+		Buffer1[(r * DCOLS + c) / CELL] &= ~mask;
 	    }
 	}
-    }
-
-    /* upper half */
-
-    /* max address */
-    if (row + height - 1 < 64) {
-	m = ((row + height - 1) * DCOLS + col + width) / XRES;
-    } else {
-	m = (64 * DCOLS + col + width) / XRES;
-    }
-
-    for (i = (row * DCOLS + col) / XRES; i <= m; i++) {
-	if (Buffer1[i] == Buffer2[i])
-	    continue;
-	for (j = i, e = 0; i <= m; i++) {
-	    if (Buffer1[i] == Buffer2[i]) {
-		if (++e > 4)
-		    break;
-	    } else {
-		e = 0;
+	a = (r * DCOLS + col) / CELL;
+	b = (r * DCOLS + col + width + CELL - 1) / CELL;
+	for (i = a; i <= b; i++) {
+	    if (Buffer1[i] == Buffer2[i])
+		continue;
+	    for (j = i, e = 0; i <= b; i++) {
+		if (Buffer1[i] == Buffer2[i]) {
+		    if (++e > 4)
+			break;
+		} else {
+		    e = 0;
+		}
 	    }
-	}
-	memcpy(Buffer2 + j, Buffer1 + j, i - j - e + 1);
-	drv_T6_copy(j, Buffer1 + j, i - j - e + 1);
-    }
-
-    /* lower half */
-
-    /* max address */
-    m = ((row + height - 1) * DCOLS + col + width) / XRES;
-
-    for (i = (64 * DCOLS + col) / XRES; i <= m; i++) {
-	if (Buffer1[i] == Buffer2[i])
-	    continue;
-	for (j = i, e = 0; i <= m; i++) {
-	    if (Buffer1[i] == Buffer2[i]) {
-		if (++e > 4)
-		    break;
+	    if (DualScan && r >= DROWS / 2) {
+		base = 0x8200 - DCOLS * DROWS / 2 / CELL;
 	    } else {
-		e = 0;
+		base = 0x0200;
 	    }
+	    n = i - j - e + 1;
+	    memcpy(Buffer2 + j, Buffer1 + j, n);
+	    drv_T6_copy(base + j, Buffer1 + j, n);
 	}
-	memcpy(Buffer2 + j, Buffer1 + j, i - j - e + 1);
-	drv_T6_copy(j, Buffer1 + j, i - j - e + 1);
     }
 }
 
@@ -428,7 +351,6 @@
 static int drv_T6_start(const char *section)
 {
     char *model, *s;
-    int rows, TROWS, TCOLS;
 
     model = cfg_get(section, "Model", "generic");
     if (model != NULL && *model != '\0') {
@@ -442,7 +364,6 @@
 	    return -1;
 	}
 	Model = i;
-	info("%s: using model '%s'", Name, Models[Model].name);
     } else {
 	error("%s: empty '%s.Model' entry from %s", Name, section, cfg_source());
 	return -1;
@@ -462,27 +383,24 @@
 	return -1;
     }
 
-    s = cfg_get(section, "Font", "6x8");
-    if (s == NULL || *s == '\0') {
-	error("%s: no '%s.Font' entry from %s", Name, section, cfg_source());
+    if (sscanf(s = cfg_get(section, "font", "6x8"), "%dx%d", &XRES, &YRES) != 2 || XRES < 1 || YRES < 1) {
+	error("%s: bad %s.Font '%s' from %s", Name, section, s, cfg_source());
+	free(s);
 	return -1;
     }
+    free(s);
 
-    XRES = -1;
-    YRES = -1;
-    if (sscanf(s, "%dx%d", &XRES, &YRES) != 2 || XRES < 1 || YRES < 1) {
-	error("%s: bad Font '%s' from %s", Name, s, cfg_source());
-	return -1;
-    }
 
-    /* Fixme: provider other fonts someday... */
-    if (XRES != 6 && YRES != 8) {
-	error("%s: bad Font '%s' from %s (only 6x8 at the moment)", Name, s, cfg_source());
-	return -1;
-    }
+    /* get font width of display */
+    cfg_number(section, "Cell", 6, 5, 8, &CELL);
+
+    TROWS = DROWS / 8;		/* text rows */
+    TCOLS = DCOLS / CELL;	/* text columns */
+
+    /* get DualScan mode */
+    cfg_number(section, "DualScan", 0, 0, 1, &DualScan);
 
-    TROWS = DROWS / YRES;	/* text rows */
-    TCOLS = DCOLS / XRES;	/* text cols */
+    info("%s: %dx%d %sScan %d bits/cell", Name, DCOLS, DROWS, DualScan ? "Dual" : "Single", CELL);
 
     Buffer1 = malloc(TCOLS * DROWS);
     if (Buffer1 == NULL) {
@@ -490,7 +408,6 @@
 	return -1;
     }
 
-    debug("malloc buffer 2 (%d*%d)=%d", TCOLS, DROWS, TCOLS * DROWS);
     Buffer2 = malloc(TCOLS * DROWS);
     if (Buffer2 == NULL) {
 	error("%s: framebuffer #2 could not be allocated: malloc() failed", Name);
@@ -505,6 +422,7 @@
 	return -1;
     }
 
+    /* soft-wiring */
     if ((SIGNAL_CE = drv_generic_parport_wire_ctrl("CE", "STROBE")) == 0xff)
 	return -1;
     if ((SIGNAL_CD = drv_generic_parport_wire_ctrl("CD", "SLCTIN")) == 0xff)
@@ -514,8 +432,17 @@
     if ((SIGNAL_WR = drv_generic_parport_wire_ctrl("WR", "INIT")) == 0xff)
 	return -1;
 
+    /* timings */
+    T_ACC = timing(Name, section, "ACC", 150, "ns");	/* Access Time */
+    T_OH = timing(Name, section, "OH", 50, "ns");	/* Output Hold Time */
+    T_PW = timing(Name, section, "PW", 80, "ns");	/* CE, RD, WR Pulse Width */
+    T_DH = timing(Name, section, "DH", 40, "ns");	/* Data Hold Time */
+    T_CDS = timing(Name, section, "CDS", 100, "ns");	/* C/D Setup Time */
+
+
     /* rise CE, CD, RD and WR */
-    drv_generic_parport_control(SIGNAL_CE | SIGNAL_CD | SIGNAL_RD | SIGNAL_WR, SIGNAL_CE | SIGNAL_CD | SIGNAL_RD | SIGNAL_WR);
+    drv_generic_parport_control(SIGNAL_CE | SIGNAL_CD | SIGNAL_RD | SIGNAL_WR,
+				SIGNAL_CE | SIGNAL_CD | SIGNAL_RD | SIGNAL_WR);
     /* set direction: write */
     drv_generic_parport_direction(0);
 
@@ -537,16 +464,16 @@
 
     /* clear display */
 
-    /* upper half */
-    rows = TROWS > 8 ? 8 : TROWS;
-    drv_T6_clear(0x0000, TCOLS * rows);	/* clear text area  */
-    drv_T6_clear(0x0200, TCOLS * rows * 8);	/* clear graphic area */
-
-    /* lower half */
-    if (TROWS > 8) {
-	rows = TROWS - 8;
-	drv_T6_clear(0x8000, TCOLS * rows);	/* clear text area #2 */
-	drv_T6_clear(0x8200, TCOLS * rows * 8);	/* clear graphic area #2 */
+    if (DualScan) {
+	/* upper half */
+	drv_T6_clear(0x0000, TCOLS * TROWS / 2);	/* clear text area  */
+	drv_T6_clear(0x0200, TCOLS * TROWS * 8 / 2);	/* clear graphic area */
+	/* lower half */
+	drv_T6_clear(0x8000, TCOLS * TROWS / 2);	/* clear text area  */
+	drv_T6_clear(0x8200, TCOLS * TROWS * 8 / 2);	/* clear graphic area */
+    } else {
+	drv_T6_clear(0x0000, TCOLS * TROWS);	/* clear text area  */
+	drv_T6_clear(0x0200, TCOLS * TROWS * 8);	/* clear graphic area */
     }
 
     return 0;
@@ -561,16 +488,6 @@
 
 
 /****************************************/
-/***        widget callbacks          ***/
-/****************************************/
-
-
-/* using drv_generic_graphic_draw(W) */
-/* using drv_generic_graphic_icon_draw(W) */
-/* using drv_generic_graphic_bar_draw(W) */
-
-
-/****************************************/
 /***        exported functions        ***/
 /****************************************/
 
@@ -590,9 +507,10 @@
 /* initialize driver & display */
 int drv_T6_init(const char *section, const int quiet)
 {
-    WIDGET_CLASS wc;
     int ret;
 
+    info("%s: %s", Name, "$Rev: 840 $");
+
     /* real worker functions */
     drv_generic_graphic_real_blit = drv_T6_blit;
 
@@ -613,21 +531,6 @@
 	}
     }
 
-    /* register text widget */
-    wc = Widget_Text;
-    wc.draw = drv_generic_graphic_draw;
-    widget_register(&wc);
-
-    /* register icon widget */
-    wc = Widget_Icon;
-    wc.draw = drv_generic_graphic_icon_draw;
-    widget_register(&wc);
-
-    /* register bar widget */
-    wc = Widget_Bar;
-    wc.draw = drv_generic_graphic_bar_draw;
-    widget_register(&wc);
-
     /* register plugins */
     /* none at the moment... */
 
@@ -666,8 +569,8 @@
 
 
 DRIVER drv_T6963 = {
-  name:Name,
-  list:drv_T6_list,
-  init:drv_T6_init,
-  quit:drv_T6_quit,
+    .name = Name,
+    .list = drv_T6_list,
+    .init = drv_T6_init,
+    .quit = drv_T6_quit,
 };
diff -urN lcd4linux-0.10.0/drv_Trefon.c lcd4linux-0.11.0-SVN/drv_Trefon.c
--- lcd4linux-0.10.0/drv_Trefon.c	2005-05-08 06:32:44.000000000 +0200
+++ lcd4linux-0.11.0-SVN/drv_Trefon.c	2008-12-31 08:05:54.000000000 +0100
@@ -1,8 +1,9 @@
-/* $Id: drv_Trefon.c,v 1.3 2005/05/08 04:32:44 reinelt Exp $
+/* $Id: drv_Trefon.c 899 2008-10-07 19:32:42Z bwalle $
+ * $URL: https://ssl.bulix.org/svn/lcd4linux/trunk/drv_Trefon.c $
  *
- * driver for TREFON USB LCD displays
+ * driver for TREFON USB LCD displays - http://www.trefon.de
  *
- * Copyright (C) 2005 Michael Reinelt <reinelt@eunet.at>
+ * Copyright (C) 2005 Michael Reinelt <michael@reinelt.co.at>
  * Copyright (C) 2005 The LCD4Linux Team <lcd4linux-devel@users.sourceforge.net>
  *
  * This file is part of LCD4Linux.
@@ -21,17 +22,6 @@
  * along with this program; if not, write to the Free Software
  * Foundation, Inc., 675 Mass Ave, Cambridge, MA 02139, USA.
  *
- *
- * $Log: drv_Trefon.c,v $
- * Revision 1.3  2005/05/08 04:32:44  reinelt
- * CodingStyle added and applied
- *
- * Revision 1.2  2005/04/24 05:27:09  reinelt
- * Trefon Backlight added
- *
- * Revision 1.1  2005/04/24 04:33:46  reinelt
- * driver for TREFON USB LCD's added
- *
  */
 
 /* 
@@ -82,9 +72,6 @@
 static usb_dev_handle *lcd;
 static int interface;
 
-extern int usb_debug;
-extern int got_signal;
-
 
 /****************************************/
 /***  hardware dependant functions    ***/
@@ -99,7 +86,7 @@
 
     info("%s: scanning USB for TREFON LCD...", Name);
 
-    usb_debug = 0;
+    usb_set_debug(0);
 
     usb_init();
     usb_find_busses();
@@ -137,22 +124,22 @@
 }
 
 
-static void drv_TF_send(char *data, int size)
+static void drv_TF_send(unsigned char *data, int size)
 {
-    char buffer[64];
+    unsigned char buffer[64];
 
     /* the controller always wants a 64-byte packet */
     memset(buffer, 0, 64);
     memcpy(buffer, data, size);
 
-    // Endpoint hardcoded to 2
-    usb_bulk_write(lcd, 2, buffer, 64, 2000);
+    /* Endpoint hardcoded to 2 */
+    usb_bulk_write(lcd, 2, (char *) buffer, 64, 2000);
 }
 
 
 static void drv_TF_command(const unsigned char cmd)
 {
-    char buffer[4] = { PKT_START, PKT_CTRL, 0, PKT_END };
+    unsigned char buffer[4] = { PKT_START, PKT_CTRL, 0, PKT_END };
     buffer[2] = cmd;
     drv_TF_send(buffer, 4);
 }
@@ -166,40 +153,42 @@
 
 static void drv_TF_write(const int row, const int col, const char *data, const int len)
 {
-    char buffer[64];
-    char *p;
-    int pos;
-
-    /* 16x4 Displays use a slightly different layout */
-    if (DCOLS == 16 && DROWS == 4) {
-	pos = (row % 2) * 64 + (row / 2) * 16 + col;
+    unsigned char buffer[64];
+    unsigned char *p;
+    int pos = 0;
+
+    if (DCOLS == 8 && DROWS == 1) {	/* 8x1 Characters */
+	pos = row * 0x40 + col;
+    } else if (DCOLS == 16 && DROWS == 2) {	/* 16x2 Characters */
+	pos = row * 0x40 + col;
+    } else if (DCOLS == 20 && DROWS == 4) {	/* 20x4 Characters */
+	pos = row * 0x20 + col;
     } else {
-	pos = (row % 2) * 64 + (row / 2) * 20 + col;
+	error("%s: internal error: DCOLS=%d DROWS=%d", Name, DCOLS, DROWS);
+	return;
     }
 
-    /* I'd like to combine the GOTO and the data into one packet, 
-     * unfortunately the Trefon doesn't like it :-(
-     */
-
-    drv_TF_command(0x80 | pos);
-
+    /* combine the GOTO and the data into one packet */
     p = buffer;
     *p++ = PKT_START;
-    *p++ = PKT_DATA;
+    *p++ = PKT_CTRL;		/* Goto */
+    *p++ = 0x80 | pos;
+    *p++ = PKT_DATA;		/* Data */
     *p++ = (char) len;
     for (pos = 0; pos < len; pos++) {
 	*p++ = *data++;
     }
     *p++ = PKT_END;
 
-    drv_TF_send(buffer, len + 3);
+    drv_TF_send(buffer, len + 5);
 }
 
+
 static void drv_TF_defchar(const int ascii, const unsigned char *matrix)
 {
 
-    char buffer[14] = "\002\006x\002x01234567\377";
-    char *p;
+    unsigned char buffer[14];
+    unsigned char *p;
     int i;
 
     p = buffer;
@@ -219,7 +208,7 @@
 
 static int drv_TF_backlight(int backlight)
 {
-    char buffer[4] = { PKT_START, PKT_BACKLIGHT, 0, PKT_END };
+    unsigned char buffer[4] = { PKT_START, PKT_BACKLIGHT, 0, PKT_END };
 
     if (backlight < 0)
 	backlight = 0;
@@ -233,6 +222,21 @@
 }
 
 
+/* test for existing resolutions from TREFON USB-LCDs (TEXT-Mode only) */
+int drv_TF_valid_resolution(int rows, int cols)
+{
+
+    if (rows == 1 && cols == 8) {
+	return 0;
+    } else if (rows == 2 && cols == 16) {
+	return 0;
+    } else if (rows == 4 && cols == 20) {
+	return 0;
+    }
+    return -1;
+}
+
+
 static int drv_TF_start(const char *section, const int quiet)
 {
     int backlight;
@@ -244,8 +248,8 @@
 	error("%s: no '%s.Size' entry from %s", Name, section, cfg_source());
 	return -1;
     }
-    if (sscanf(s, "%dx%d", &cols, &rows) != 2 || rows < 1 || cols < 1) {
-	error("%s: bad %s.Size '%s' from %s", Name, section, s, cfg_source());
+    if (sscanf(s, "%dx%d", &cols, &rows) != 2 || drv_TF_valid_resolution(rows, cols) < 0) {
+	error("%s: bad %s.Size '%s' (only 8x1/16x2/20x4) from %s", Name, section, s, cfg_source());
 	free(s);
 	return -1;
     }
@@ -320,6 +324,8 @@
     int asc255bug;
     int ret;
 
+    info("%s: %s", Name, "$Rev: 899 $");
+
     /* display preferences */
     XRES = 5;			/* pixel width of one char  */
     YRES = 8;			/* pixel height of one char  */
@@ -403,8 +409,8 @@
 
 
 DRIVER drv_Trefon = {
-  name:Name,
-  list:drv_TF_list,
-  init:drv_TF_init,
-  quit:drv_TF_quit,
+    .name = Name,
+    .list = drv_TF_list,
+    .init = drv_TF_init,
+    .quit = drv_TF_quit,
 };
diff -urN lcd4linux-0.10.0/drv_ula200.c lcd4linux-0.11.0-SVN/drv_ula200.c
--- lcd4linux-0.10.0/drv_ula200.c	1970-01-01 01:00:00.000000000 +0100
+++ lcd4linux-0.11.0-SVN/drv_ula200.c	2008-12-31 08:06:27.000000000 +0100
@@ -0,0 +1,791 @@
+/* $Id: drv_ula200.c 897 2008-10-06 04:25:14Z michael $
+ * $URL: https://ssl.bulix.org/svn/lcd4linux/trunk/drv_ula200.c $
+ *
+ * ULA200 driver for lcd4linux
+ *
+ * Copyright (C) 2008 Bernhard Walle <bernhard.walle@gmx.de>
+ *
+ * This file is part of LCD4Linux.
+ *
+ * LCD4Linux is free software; you can redistribute it and/or modify
+ * it under the terms of the GNU General Public License as published by
+ * the Free Software Foundation; either version 2, or (at your option)
+ * any later version.
+ *
+ * LCD4Linux is distributed in the hope that it will be useful,
+ * but WITHOUT ANY WARRANTY; without even the implied warranty of
+ * MERCHANTABILITY or FITNESS FOR A PARTICULAR PURPOSE.  See the
+ * GNU General Public License for more details.
+ *
+ * You should have received a copy of the GNU General Public License
+ * along with this program; if not, write to the Free Software
+ * Foundation, Inc., 675 Mass Ave, Cambridge, MA 02139, USA.
+ *
+ */
+
+/*
+ * Driver for the ELV ULA200 USB device. The device can control one
+ * HD44780 display up to 4x20 characters.
+ *
+ * Implemented functions:
+ *   - displaying characters :-)
+ *   - controlling the backlight
+ *
+ * Todo:
+ *   - input buttons
+ *
+ * Configuration:
+ *   - Size (XxY): size of the display (e.g. '20x4')
+ *   - Backlight (0/1): initial state of the backlight
+ *
+ * Author:
+ *   Bernhard Walle <bernhard.walle@gmx.de>
+ *
+ * exported fuctions:
+ *   struct DRIVER drv_ula200
+ *
+ */
+
+#include "config.h"
+
+#include <stdlib.h>
+#include <stdio.h>
+#include <unistd.h>
+#include <string.h>
+#include <errno.h>
+
+#include <ftdi.h>
+
+#include "debug.h"
+#include "cfg.h"
+#include "qprintf.h"
+#include "udelay.h"
+#include "plugin.h"
+#include "widget.h"
+#include "widget_text.h"
+#include "widget_icon.h"
+#include "widget_bar.h"
+#include "drv.h"
+
+/* text mode display? */
+#include "drv_generic_text.h"
+
+/****************************************/
+/***        Global variables          ***/
+/****************************************/
+
+static char Name[] = "ULA200";
+static struct ftdi_context *Ftdi = NULL;
+
+
+/****************************************/
+/***        Constants                 ***/
+/****************************************/
+
+/* USB connection */
+#define ULA200_VENDOR_ID    	0x0403
+#define ULA200_PRODUCT_ID   	0xf06d
+
+/* connection parameters */
+#define	ULA200_BAUDRATE		19200
+#define ULA200_DATABITS		BITS_8
+#define	ULA200_STOPBITS		STOP_BIT_1
+#define ULA200_PARITY		EVEN
+
+/* character constants used for the communication */
+#define ULA200_CH_STX  		0x02
+#define ULA200_CH_ETX  		0x03
+#define ULA200_CH_ENQ  		0x05
+#define ULA200_CH_ACK  		0x06
+#define ULA200_CH_NAK  		0x15
+#define ULA200_CH_DC2  		0x12
+#define ULA200_CH_DC3  		0x13
+
+/* commands used for the communication (names are German) */
+#define ULA200_CMD_POSITION	'p'	/* 'position' */
+#define ULA200_CMD_STRING	's'	/* 'string' */
+#define ULA200_CMD_CLEAR	'l'	/* 'loeschen' */
+#define ULA200_CMD_BACKLIGHT	'h'	/* 'hintergrund' */
+#define ULA200_CMD_CHAR     	'c'	/* 'character' */
+
+/* raw register access */
+#define ULA200_RS_DATA     	0x00	/* data */
+#define ULA200_RS_INSTR    	0x01	/* instruction */
+#define ULA200_SETCHAR		0x40	/* set user-defined character */
+
+/* character sizes */
+#define ULA200_CELLWIDTH 	5
+#define ULA200_CELLHEIGHT	8
+
+/* internal implementation constants */
+#define ULA200_BUFFER_LENGTH	1024
+#define ULA200_MAXLEN		512
+#define ULA200_MAX_REPEATS	20
+
+/* define TRUE and FALSE for better code readability if not already defined */
+#ifndef TRUE
+#   define TRUE 1
+#endif
+#ifndef FALSE
+#   define FALSE 0
+#endif
+
+
+/****************************************/
+/***        Macros                    ***/
+/****************************************/
+
+#define ULA200_ERROR(msg, ...) \
+	error("%s: In %s():%d: " msg, Name, \
+	    __FUNCTION__, __LINE__, ##__VA_ARGS__)
+
+#define ULA200_INFO(msg, ...) \
+	info("%s: " msg, Name, ##__VA_ARGS__)
+
+#define ULA200_DEBUG(msg, ...) \
+	debug("%s: In %s():%d: " msg, Name, \
+	    __FUNCTION__, __LINE__, ##__VA_ARGS__)
+
+#define ULA200_TRACE() \
+	debug("%s: Calling %s()", Name, __FUNCTION__)
+
+
+/****************************************/
+/***        Prototypes                ***/
+/****************************************/
+
+static int drv_ula200_ftdi_read_response(void);
+static int drv_ula200_ftdi_usb_read(void);
+static int drv_ula200_ftdi_write_command(const unsigned char *, int);
+static int drv_ula200_backlight(int);
+static int drv_ula200_close(void);
+
+static void plugin_backlight(RESULT *, RESULT *);
+
+/****************************************/
+/***        Internal (helper) funcs   ***/
+/****************************************/
+
+/**
+ * Write a command to the display. Adds the STX and ETX header/trailer.
+ *
+ * @param[in] data the data bytes
+ * @param[in] length the number of bytes in data which are valid
+ * @return 0 on success, negative value on error
+ */
+static int drv_ula200_ftdi_write_command(const unsigned char *data, int length)
+{
+    int i, err;
+    int repeat_count = 0;
+    int pos = 0;
+    unsigned char buffer[ULA200_BUFFER_LENGTH];
+
+    /* check for the maximum length */
+    if (length > ULA200_MAXLEN) {
+	return -EINVAL;
+    }
+
+    /* fill the array */
+    buffer[pos++] = ULA200_CH_STX;
+    for (i = 0; i < length; i++) {
+	if (data[i] == ULA200_CH_STX) {
+	    buffer[pos++] = ULA200_CH_ENQ;
+	    buffer[pos++] = ULA200_CH_DC2;
+	} else if (data[i] == ULA200_CH_ETX) {
+	    buffer[pos++] = ULA200_CH_ENQ;
+	    buffer[pos++] = ULA200_CH_DC3;
+	} else if (data[i] == ULA200_CH_ENQ) {
+	    buffer[pos++] = ULA200_CH_ENQ;
+	    buffer[pos++] = ULA200_CH_NAK;
+	} else {
+	    buffer[pos++] = data[i];
+	}
+    }
+    buffer[pos++] = ULA200_CH_ETX;
+
+    do {
+	/* ULA200_DEBUG("ftdi_write_data(%p, %d)", buffer, pos); */
+	err = ftdi_write_data(Ftdi, buffer, pos);
+	if (err < 0) {
+	    ULA200_ERROR("ftdi_write_data() failed");
+	    return -1;
+	}
+    }
+    while (!drv_ula200_ftdi_read_response() && (repeat_count++ < ULA200_MAX_REPEATS));
+
+    return 0;
+}
+
+/**
+ * Reads a character from USB.
+ *
+ * @return a positive value between 0 and 255 indicates the character that
+ *         has been read successfully, -1 indicates an error
+ */
+static int drv_ula200_ftdi_usb_read(void)
+{
+    unsigned char buffer[1];
+    int err;
+
+    while ((err = ftdi_read_data(Ftdi, buffer, 1)) == 0);
+    return err >= 0 ? buffer[0] : -1;
+}
+
+
+/**
+ * Reads the response of the display. Currently, key input is ignored
+ * and only ACK / NACK is read.
+ *
+ * @return TRUE on success (ACK), FALSE on failure (NACK)
+ */
+static int drv_ula200_ftdi_read_response(void)
+{
+    int result = FALSE;
+    int answer_read = FALSE;
+    int ret;
+    int ch;
+
+    while (!answer_read) {
+	/* wait until STX */
+	do {
+	    ret = drv_ula200_ftdi_usb_read();
+	    /* ULA200_DEBUG("STX drv_ula200_ftdi_usb_read = %d", ret); */
+	} while ((ret != ULA200_CH_STX) && (ret > 0));
+
+	if (ret < 0) {
+	    return FALSE;
+	}
+
+	/* read next char */
+	ch = drv_ula200_ftdi_usb_read();
+	/* ULA200_DEBUG("drv_ula200_ftdi_usb_read = %d", ch); */
+
+	switch (ch) {
+	case 't':
+	    ch = drv_ula200_ftdi_usb_read();
+	    /* ULA200_DEBUG("drv_ula200_ftdi_usb_read = %d", ch); */
+	    /* ignore currently */
+	    break;
+
+	case ULA200_CH_ACK:
+	    answer_read = TRUE;
+	    result = TRUE;
+	    break;
+
+	case ULA200_CH_NAK:
+	    answer_read = TRUE;
+	    result = FALSE;
+	    break;
+
+	default:
+	    answer_read = TRUE;
+	    ULA200_ERROR("Read invalid answer");
+	}
+
+	/* wait until ETX */
+	do {
+	    ret = drv_ula200_ftdi_usb_read();
+	    /* ULA200_DEBUG("ETX drv_ula200_ftdi_usb_read = %d", ret); */
+	} while ((ret != ULA200_CH_ETX) && (ret > 0));
+
+	if (ret < 0) {
+	    return FALSE;
+	}
+    }
+
+    return result;
+}
+
+static int drv_ula200_ftdi_enable_raw_mode(void)
+{
+    unsigned char command[3];
+
+    command[0] = 'R';
+    command[1] = 'E';
+    command[2] = '1';
+    return drv_ula200_ftdi_write_command(command, 3);
+}
+
+
+/**
+ * Writes raw data (access the HD44780 registers directly.
+ *
+ * @param[in] flags ULA200_RS_DATA or ULA200_RS_INSTR
+ * @param[in] ch the real data
+ * @return 0 on success, a negative value on error
+ */
+static int drv_ula200_ftdi_rawdata(unsigned char flags, unsigned char ch)
+{
+    unsigned char command[3];
+    int err;
+
+    command[0] = 'R';
+    command[1] = flags == ULA200_RS_DATA ? '2' : '0';
+    command[2] = ch;
+    err = drv_ula200_ftdi_write_command(command, 3);
+    if (err < 0) {
+	ULA200_ERROR("ula200_ftdi_write_command() failed");
+	return -1;
+    }
+
+    return 0;
+}
+
+/**
+ * Sets the cursor position.
+ *
+ * @param[in] x the x coordinate of the position
+ * @param[in] y the y coordinate of the position
+ * @return 0 on success, a negative value on error
+ */
+static int drv_ula200_set_position(int x, int y)
+{
+    unsigned char command[3];
+    int err;
+
+    if (y >= 2) {
+	y -= 2;
+	x += DCOLS;		/* XXX: multiply by 2? */
+    }
+
+    command[0] = ULA200_CMD_POSITION;
+    command[1] = x;
+    command[2] = y;
+    err = drv_ula200_ftdi_write_command(command, 3);
+    if (err < 0) {
+	ULA200_ERROR("ula200_ftdi_write_command() failed");
+    }
+
+    return err;
+}
+
+/**
+ * Sends the text
+ *
+ * @param[in] data the data bytes
+ * @param[in] len the number of valid bytes in @p data
+ * @return 0 on success, a negative value on error
+ */
+static int drv_ula200_send_text(const unsigned char *data, int len)
+{
+    unsigned char buffer[ULA200_BUFFER_LENGTH];
+    int err;
+
+    if (len > ULA200_MAXLEN) {
+	return -EINVAL;
+    }
+
+    buffer[0] = ULA200_CMD_STRING;
+    buffer[1] = len;
+    memcpy(buffer + 2, data, len);
+    buffer[2 + len] = 0;	/* only necessary for the debug message */
+
+    /* ULA200_DEBUG("Text: =%s= (%d)", buffer+2, len); */
+
+    err = drv_ula200_ftdi_write_command(buffer, len + 2);
+    if (err < 0) {
+	ULA200_ERROR("ula200_ftdi_write_command() failed");
+	return -1;
+    }
+
+    return 0;
+}
+
+/**
+ * Sends one character.
+ *
+ * @param[in] ch the character to send
+ * @return 0 on success, a negative value on error
+ */
+static int drv_ula200_send_char(char ch)
+{
+    unsigned char buffer[2];
+    int err;
+
+    buffer[0] = ULA200_CMD_CHAR;
+    buffer[1] = ch;
+
+    err = drv_ula200_ftdi_write_command(buffer, 2);
+    if (err < 0) {
+	ULA200_ERROR("ula200_ftdi_write_command() failed");
+	return -1;
+    }
+
+    return 0;
+}
+
+/**
+ * Opens the ULA200 display. Uses libftdi to initialise the USB communication to
+ * the display.
+ *
+ @ @return a value less then zero on failure, 0 on success
+ */
+static int drv_ula200_open(void)
+{
+    int err;
+
+    /* check if the device was already open */
+    if (Ftdi != NULL) {
+	ULA200_ERROR("open called although device was already open");
+	drv_ula200_close();
+    }
+
+    /* get memory for the device descriptor */
+    Ftdi = malloc(sizeof(struct ftdi_context));
+    if (Ftdi == NULL) {
+	ULA200_ERROR("Memory allocation failed");
+	return -1;
+    }
+
+    /* open the ftdi library */
+    ftdi_init(Ftdi);
+    Ftdi->usb_write_timeout = 20;
+    Ftdi->usb_read_timeout = 20;
+
+    /* open the device */
+    err = ftdi_usb_open(Ftdi, ULA200_VENDOR_ID, ULA200_PRODUCT_ID);
+    if (err < 0) {
+	ULA200_ERROR("ftdi_usb_open() failed");
+	free(Ftdi);
+	Ftdi = NULL;
+	return -1;
+    }
+
+    /* set the baudrate */
+    err = ftdi_set_baudrate(Ftdi, ULA200_BAUDRATE);
+    if (err < 0) {
+	ULA200_ERROR("ftdi_set_baudrate() failed");
+	ftdi_usb_close(Ftdi);
+	free(Ftdi);
+	Ftdi = NULL;
+	return -1;
+    }
+    /* set communication parameters */
+    err = ftdi_set_line_property(Ftdi, ULA200_DATABITS, ULA200_STOPBITS, ULA200_PARITY);
+    if (err < 0) {
+	ULA200_ERROR("ftdi_set_line_property() failed");
+	ftdi_usb_close(Ftdi);
+	free(Ftdi);
+	Ftdi = NULL;
+	return -1;
+    }
+
+    return 0;
+}
+
+/**
+ * Closes the display.
+ *
+ * @return 0 on success, a negative value on failure
+ */
+static int drv_ula200_close(void)
+{
+    ULA200_TRACE();
+
+    ftdi_usb_purge_buffers(Ftdi);
+    ftdi_usb_close(Ftdi);
+    ftdi_deinit(Ftdi);
+
+    free(Ftdi);
+    Ftdi = NULL;
+
+    return 0;
+}
+
+/**
+ * Clears the contents of the display.
+ *
+ * @return 0 on success, a negative value on error
+ */
+static void drv_ula200_clear(void)
+{
+    unsigned const char command[] = { ULA200_CMD_CLEAR };
+    int err;
+
+    ULA200_TRACE();
+
+    err = drv_ula200_ftdi_write_command(command, 1);
+    if (err < 0) {
+	ULA200_ERROR("ula200_ftdi_write_command() failed");
+    }
+}
+
+/**
+ * Writes data to the display.
+ *
+ * @param[in] row the row where the data should be written to
+ * @param[in] col the column where the data should be written to
+ * @param[in] data the data that should actually be written
+ * @param[in] len the number of valid bytes in @p data
+ */
+static void drv_ula200_write(const int row, const int col, const char *data, int len)
+{
+    int ret;
+
+    /* do the cursor positioning here */
+    ret = drv_ula200_set_position(col, row);
+    if (ret < 0) {
+	ULA200_ERROR("drv_ula200_set_position() failed");
+	return;
+    }
+
+    /* send string to the display */
+    if (len == 1) {
+	ret = drv_ula200_send_char(data[0]);
+    } else {
+	ret = drv_ula200_send_text((unsigned char *) data, len);
+    }
+    if (ret < 0) {
+	ULA200_ERROR("drv_ula200_send_text() failed");
+	return;
+    }
+}
+
+/* text mode displays only */
+static void drv_ula200_defchar(const int ascii, const unsigned char *matrix)
+{
+    int err, i;
+
+    if (ascii >= 8) {
+	ULA200_ERROR("Invalid value in drv_ula200_defchar");
+	return;
+    }
+
+    /* Tell the HD44780 we will redefine char number 'ascii' */
+    err = drv_ula200_ftdi_rawdata(ULA200_RS_INSTR, ULA200_SETCHAR | (ascii * 8));
+    if (err < 0) {
+	ULA200_ERROR("drv_ula200_ftdi_rawdata() failed");
+	return;
+    }
+
+    /* Send the subsequent rows */
+    for (i = 0; i < YRES; i++) {
+	err = drv_ula200_ftdi_rawdata(ULA200_RS_DATA, *matrix++ & 0x1f);
+	if (err < 0) {
+	    ULA200_ERROR("ula200_ftdi_rawdata() failed");
+	    return;
+	}
+    }
+}
+
+/**
+ * Controls the backlight of the ULA200 display.
+ *
+ * @param[in] backlight a negative value if the backlight should be turned off,
+ *            a positive value if it should be turned on
+ * @return 0 on success, any other value on failure
+ */
+static int drv_ula200_backlight(int backlight)
+{
+    unsigned char cmd[2] = { ULA200_CMD_BACKLIGHT };
+    int ret;
+
+    if (backlight <= 0) {
+	backlight = '0';
+    } else {
+	backlight = '1';
+    }
+
+    cmd[1] = backlight;
+    ret = drv_ula200_ftdi_write_command(cmd, 2);
+    if (ret < 0) {
+	ULA200_ERROR("ula200_ftdi_write_command() failed");
+    }
+
+    return backlight == '1';
+}
+
+/**
+ * Starts the display.
+ *
+ * @param[in] section the section of the configuration file
+ * @return 0 on success, a negative value on failure
+ */
+static int drv_ula200_start(const char *section)
+{
+    int rows = -1, cols = -1;
+    char *s;
+    int backlight = 0;
+    int err;
+
+    s = cfg_get(section, "Size", NULL);
+    if (s == NULL || *s == '\0') {
+	ULA200_ERROR("No '%s.Size' entry from %s", section, cfg_source());
+	return -1;
+    }
+    if (sscanf(s, "%dx%d", &cols, &rows) != 2 || rows < 1 || cols < 1) {
+	ULA200_ERROR("Bad %s.Size '%s' from %s", section, s, cfg_source());
+	free(s);
+	return -1;
+    }
+
+    DROWS = rows;
+    DCOLS = cols;
+
+    /* open communication with the display */
+    err = drv_ula200_open();
+    if (err < 0) {
+	return -1;
+    }
+
+    cfg_number(section, "Backlight", 0, 0, 1, &backlight);
+    err = drv_ula200_backlight(backlight);
+    if (err < 0) {
+	ULA200_ERROR("drv_ula200_backlight() failed");
+	return -1;
+    }
+
+    /* clear display */
+    drv_ula200_clear();
+
+    /* enable raw mode for defining own chars */
+    drv_ula200_ftdi_enable_raw_mode();
+
+    return 0;
+}
+
+/****************************************/
+/***            plugins               ***/
+/****************************************/
+
+/**
+ * Backlight plugin
+ */
+static void plugin_backlight(RESULT * result, RESULT * arg1)
+{
+    double backlight;
+
+    backlight = drv_ula200_backlight(R2N(arg1));
+    SetResult(&result, R_NUMBER, &backlight);
+}
+
+/****************************************/
+/***        exported functions        ***/
+/****************************************/
+
+/**
+ * list models
+ *
+ * @return 0 on success, a negative value on failure
+ */
+int drv_ula200_list(void)
+{
+    printf("generic");
+    return 0;
+}
+
+/**
+ * initialize driver & display
+ *
+ * @param[in] section the name of the section in the configuration file
+ * @param[in] quiet TRUE on quiet mode
+ * @return 0 on success, any negative error value on failure
+ */
+/* use this function for a text display */
+int drv_ula200_init(const char *section, const int quiet)
+{
+    WIDGET_CLASS wc;
+    int ret;
+
+    ULA200_INFO("%s", "$Rev: 897 $");
+
+    /* display preferences */
+    XRES = ULA200_CELLWIDTH;	/* pixel width of one char  */
+    YRES = ULA200_CELLHEIGHT;	/* pixel height of one char  */
+    CHARS = 7;			/* number of user-defineable characters */
+    CHAR0 = 1;			/* ASCII of first user-defineable char */
+    GOTO_COST = 4;		/* number of bytes a goto command requires */
+
+    /* real worker functions */
+    drv_generic_text_real_write = drv_ula200_write;
+    drv_generic_text_real_defchar = drv_ula200_defchar;
+
+    /* start display */
+    if ((ret = drv_ula200_start(section)) != 0) {
+	return ret;
+    }
+
+    if (!quiet) {
+	char buffer[40];
+	qprintf(buffer, sizeof(buffer), "%s %dx%d", Name, DCOLS, DROWS);
+	if (drv_generic_text_greet(buffer, "ULA 200")) {
+	    sleep(3);
+	    drv_ula200_clear();
+	}
+    }
+
+    /* initialize generic text driver */
+    if ((ret = drv_generic_text_init(section, Name)) != 0)
+	return ret;
+
+    /* initialize generic icon driver */
+    if ((ret = drv_generic_text_icon_init()) != 0)
+	return ret;
+
+    /* initialize generic bar driver */
+    if ((ret = drv_generic_text_bar_init(0)) != 0)
+	return ret;
+
+    /* add fixed chars to the bar driver */
+    drv_generic_text_bar_add_segment(0, 0, 255, 32);	/* ASCII  32 = blank */
+
+    /* register text widget */
+    wc = Widget_Text;
+    wc.draw = drv_generic_text_draw;
+    widget_register(&wc);
+
+    /* register icon widget */
+    wc = Widget_Icon;
+    wc.draw = drv_generic_text_icon_draw;
+    widget_register(&wc);
+
+    /* register bar widget */
+    wc = Widget_Bar;
+    wc.draw = drv_generic_text_bar_draw;
+    widget_register(&wc);
+
+    /* register plugins */
+    AddFunction("LCD::backlight", -1, plugin_backlight);
+
+    return 0;
+}
+
+/**
+ * close driver & display
+ *
+ * @param[in] quiet TRUE on quiet mode
+ * @return 0 on success, any negative error value on failure
+ */
+/* use this function for a text display */
+int drv_ula200_quit(int quiet)
+{
+    ULA200_INFO("shutting down.");
+
+    drv_generic_text_quit();
+
+    /* turn backlight off */
+    drv_ula200_backlight(0);
+
+    /* clear display */
+    drv_ula200_clear();
+
+    /* say goodbye... */
+    if (!quiet) {
+	drv_generic_text_greet("goodbye!", NULL);
+    }
+
+    debug("closing connection");
+    drv_ula200_close();
+
+    return 0;
+}
+
+/* use this one for a text display */
+DRIVER drv_ula200 = {
+    .name = Name,
+    .list = drv_ula200_list,
+    .init = drv_ula200_init,
+    .quit = drv_ula200_quit,
+};
+
+/* :indentSize=4:tabSize=8:noTabs=false: */
diff -urN lcd4linux-0.10.0/drv_USBHUB.c lcd4linux-0.11.0-SVN/drv_USBHUB.c
--- lcd4linux-0.10.0/drv_USBHUB.c	1970-01-01 01:00:00.000000000 +0100
+++ lcd4linux-0.11.0-SVN/drv_USBHUB.c	2008-12-31 08:06:27.000000000 +0100
@@ -0,0 +1,340 @@
+/* $Id: drv_USBHUB.c 840 2007-09-09 12:17:42Z michael $
+ * $URL: https://ssl.bulix.org/svn/lcd4linux/trunk/drv_USBHUB.c $
+ *
+ * new style driver for USBLCD displays
+ *
+ * Copyright (C) 2006 Ernst Bachmann <e.bachmann@xebec.de>
+ * Copyright (C) 2004,2006 The LCD4Linux Team <lcd4linux-devel@users.sourceforge.net>
+ *
+ * Based on the USBLCD driver Copyright (C) 2003 Michael Reinelt <michael@reinelt.co.at>
+ *
+ * This file is part of LCD4Linux.
+ *
+ * LCD4Linux is free software; you can redistribute it and/or modify
+ * it under the terms of the GNU General Public License as published by
+ * the Free Software Foundation; either version 2, or (at your option)
+ * any later version.
+ *
+ * LCD4Linux is distributed in the hope that it will be useful,
+ * but WITHOUT ANY WARRANTY; without even the implied warranty of
+ * MERCHANTABILITY or FITNESS FOR A PARTICULAR PURPOSE.  See the
+ * GNU General Public License for more details.
+ *
+ * You should have received a copy of the GNU General Public License
+ * along with this program; if not, write to the Free Software
+ * Foundation, Inc., 675 Mass Ave, Cambridge, MA 02139, USA.
+ *
+ */
+
+/* 
+ *
+ * exported fuctions:
+ *
+ * struct DRIVER drv_USBHUB
+ *
+ */
+
+#include "config.h"
+
+#ifdef HAVE_USB_H
+# include <usb.h>
+#else
+# error The USB-HUB driver only makes sense with USB support
+#endif
+
+#include "debug.h"
+#include "cfg.h"
+#include "qprintf.h"
+#include "udelay.h"
+#include "drv.h"
+#include "drv_generic_gpio.h"
+
+
+
+#define HUB_CONTROL_PORT 0x23
+#define HUB_SET_FEATURE 3
+#define HUB_SET_INDICATOR 22
+
+static char Name[] = "USBHUB";
+
+/* TODO: Better not specify defaults here, 
+ * instead look for the first suitable HUB arround if
+ * no Vendor/Product specified in config.
+ */
+
+static unsigned int hubVendor = 0x0409;
+static unsigned int hubProduct = 0x0058;
+
+static usb_dev_handle *hub = NULL;
+
+typedef struct _usb_hub_descriptor {
+    u_int8_t bLength;
+    u_int8_t bDescriptorType;
+    u_int8_t nNbrPorts;
+    u_int8_t wHubCharacteristicLow;
+    u_int8_t wHubCharacteristicHigh;
+    u_int8_t bPwrOn2PwrGood;
+    u_int8_t bHubContrCurrent;
+    u_int8_t deviceRemovable;
+    u_int8_t PortPwrCtrlMask[8];
+} usb_hub_descriptor;
+
+/****************************************/
+/***  hardware dependant functions    ***/
+/****************************************/
+
+
+static int drv_UH_open(void)
+{
+    struct usb_bus *busses, *bus;
+    struct usb_device *dev;
+
+    hub = NULL;
+
+    info("%s: scanning for an USB HUB (0x%04x:0x%04x)...", Name, hubVendor, hubProduct);
+
+    usb_init();
+    usb_find_busses();
+    usb_find_devices();
+    busses = usb_get_busses();
+
+    for (bus = busses; bus; bus = bus->next) {
+	for (dev = bus->devices; dev; dev = dev->next) {
+	    if ((dev->descriptor.idVendor == hubVendor) && (dev->descriptor.idProduct == hubProduct)) {
+
+		unsigned int v = dev->descriptor.bcdDevice;
+
+		info("%s: found USBHUB V%1d%1d.%1d%1d on bus %s device %s", Name,
+		     (v & 0xF000) >> 12, (v & 0xF00) >> 8, (v & 0xF0) >> 4, (v & 0xF), bus->dirname, dev->filename);
+
+		if (dev->descriptor.bDeviceClass != USB_CLASS_HUB) {
+		    error("%s: the specified device claims to be no HUB", Name);
+		    return -1;
+		}
+
+		hub = usb_open(dev);
+		if (!hub) {
+		    error("%s: usb_open() failed!", Name);
+		    return -1;
+		}
+		return 0;
+	    }
+	}
+    }
+    error("%s: could not find a USB HUB", Name);
+    return -1;
+}
+
+
+static int drv_UH_close(void)
+{
+    debug("closing USB handle");
+
+    usb_close(hub);
+
+    return 0;
+}
+
+
+/*
+ * Set the Indicator status on port "num+1" to val.
+ * according to the USB Specification, the following values would be allowed:
+ *
+ *   0 : Automatic color (display link state etc)
+ *   1 : Amber
+ *   2 : Green
+ *   3 : Off
+ *   4..255: Reserved
+ *
+ */
+
+static int drv_UH_set(const int num, const int val)
+{
+    int ret;
+
+    if (!hub)
+	return -1;
+
+    if (val < 0 || val > 3) {
+	info("%s: value %d out of range (0..3)", Name, val);
+	return -1;
+    }
+
+    if ((ret = usb_control_msg(hub,
+			       HUB_CONTROL_PORT,
+			       HUB_SET_FEATURE, HUB_SET_INDICATOR, (val << 8) | (num + 1), NULL, 0, 1000)) != 0) {
+	info("%s: usb_control_msg failed with %d", Name, ret);
+	return -1;
+    }
+
+    return 0;
+}
+
+
+static int drv_UH_start(const char *section, const __attribute__ ((unused))
+			int quiet)
+{
+    char *buf;
+
+    usb_hub_descriptor hub_desc;
+    int ret;
+
+
+    buf = cfg_get(section, "Vendor", NULL);
+    if (buf) {
+	if (!*buf) {
+	    error("%s: Strange Vendor Specification", Name);
+	    return -1;
+	}
+	if (sscanf(buf, "0x%x", &hubVendor) != 1) {
+	    error("%s: Strange Vendor Specification: [%s]", Name, buf);
+	    return -1;
+	}
+    }
+
+    buf = cfg_get(section, "Product", NULL);
+    if (buf) {
+	if (!*buf) {
+	    error("%s: Strange Product Specification", Name);
+	    return -1;
+	}
+	if (sscanf(buf, "0x%x", &hubProduct) != 1) {
+	    error("%s: Strange Product Specification: [%s]", Name, buf);
+	    return -1;
+	}
+    }
+
+    if (drv_UH_open() < 0) {
+	return -1;
+    }
+
+
+    if ((ret = usb_control_msg(hub,
+			       USB_ENDPOINT_IN | USB_TYPE_CLASS | USB_RECIP_DEVICE,
+			       USB_REQ_GET_DESCRIPTOR, USB_DT_HUB << 8, 0, (char *) &hub_desc, sizeof(hub_desc),
+			       1000)) <= 8) {
+	error("%s: hub_get_descriptor failed with %d", Name, ret);
+	drv_UH_close();
+	return -1;
+    }
+    GPOS = hub_desc.nNbrPorts;
+    debug("%s: HUB claims to have %d ports. Configuring them as GPOs", Name, GPOS);
+    if (!(hub_desc.wHubCharacteristicLow & 0x80)) {
+	error("%s: HUB claims to have no Indicator LEDs (Characteristics 0x%04x). Bailing out.", Name,
+	      (hub_desc.wHubCharacteristicHigh << 8) | hub_desc.wHubCharacteristicLow);
+	/* The HUB Tells us that there are no LEDs to control. Breaking? Maybe don't trust it and continue anyways? */
+	drv_UH_close();
+	return -1;
+
+    }
+
+    return 0;
+}
+
+
+/****************************************/
+/***            plugins               ***/
+/****************************************/
+
+/* none at the moment... */
+
+
+/****************************************/
+/***        widget callbacks          ***/
+/****************************************/
+
+
+/* using drv_generic_text_draw(W) */
+/* using drv_generic_text_icon_draw(W) */
+/* using drv_generic_text_bar_draw(W) */
+
+
+/****************************************/
+/***        exported functions        ***/
+/****************************************/
+
+
+/* list models */
+int drv_UH_list(void)
+{
+    printf("generic");
+    return 0;
+}
+
+
+/* initialize driver & display */
+int drv_UH_init(const char *section, const int quiet)
+{
+    int ret;
+    int i;
+
+    info("%s: %s", Name, "$Rev: 840 $");
+
+
+
+    /* start display */
+    if ((ret = drv_UH_start(section, quiet)) != 0)
+	return ret;
+
+
+    /* real worker functions */
+    drv_generic_gpio_real_set = drv_UH_set;
+
+
+    /* initialize generic GPIO driver */
+    if ((ret = drv_generic_gpio_init(section, Name)) != 0)
+	return ret;
+
+    /* register gpio widget, done already by generic_gpio */
+
+    /* register plugins */
+    /* none at the moment... */
+
+    /* greeting */
+    if (!quiet) {
+	/* Light all LEDS green for a greeting */
+	for (i = 0; i < GPOS; ++i) {
+	    drv_UH_set(i, 2);
+	}
+	sleep(1);
+	for (i = 0; i < GPOS; ++i) {
+	    drv_UH_set(i, 3);	/* OFF */
+	}
+    }
+
+
+    return 0;
+}
+
+
+/* close driver & display */
+int drv_UH_quit(const int quiet)
+{
+    int i;
+    debug("%s: shutting down.", Name);
+
+    /* say goodbye... */
+    if (!quiet) {
+	/* Light all LEDS amber for a goodbye */
+	for (i = 0; i < GPOS; ++i) {
+	    drv_UH_set(i, 1);
+	}
+	sleep(1);
+
+    }
+
+    drv_generic_gpio_quit();
+
+    drv_UH_close();
+
+    info("%s: shutdown complete.", Name);
+    return 0;
+}
+
+
+DRIVER drv_USBHUB = {
+    .name = Name,
+    .list = drv_UH_list,
+    .init = drv_UH_init,
+    .quit = drv_UH_quit,
+};
diff -urN lcd4linux-0.10.0/drv_USBLCD.c lcd4linux-0.11.0-SVN/drv_USBLCD.c
--- lcd4linux-0.10.0/drv_USBLCD.c	2005-05-08 06:32:44.000000000 +0200
+++ lcd4linux-0.11.0-SVN/drv_USBLCD.c	2008-12-31 08:05:54.000000000 +0100
@@ -1,8 +1,9 @@
-/* $Id: drv_USBLCD.c,v 1.23 2005/05/08 04:32:44 reinelt Exp $
+/* $Id: drv_USBLCD.c 899 2008-10-07 19:32:42Z bwalle $
+ * $URL: https://ssl.bulix.org/svn/lcd4linux/trunk/drv_USBLCD.c $
  *
  * new style driver for USBLCD displays
  *
- * Copyright (C) 2003 Michael Reinelt <reinelt@eunet.at>
+ * Copyright (C) 2003 Michael Reinelt <michael@reinelt.co.at>
  * Copyright (C) 2004 The LCD4Linux Team <lcd4linux-devel@users.sourceforge.net>
  *
  * based on the old-style USBLCD driver which is 
@@ -24,104 +25,6 @@
  * along with this program; if not, write to the Free Software
  * Foundation, Inc., 675 Mass Ave, Cambridge, MA 02139, USA.
  *
- *
- * $Log: drv_USBLCD.c,v $
- * Revision 1.23  2005/05/08 04:32:44  reinelt
- * CodingStyle added and applied
- *
- * Revision 1.22  2005/04/24 04:33:46  reinelt
- * driver for TREFON USB LCD's added
- *
- * Revision 1.21  2005/04/02 05:28:58  reinelt
- * fixed gcc4 warnings about signed/unsigned mismatches
- *
- * Revision 1.20  2005/01/30 06:43:22  reinelt
- * driver for LCD-Linux finished
- *
- * Revision 1.19  2005/01/18 06:30:23  reinelt
- * added (C) to all copyright statements
- *
- * Revision 1.18  2004/12/22 20:24:02  reinelt
- * T6963 fix for displays > 8 rows
- *
- * Revision 1.17  2004/10/02 09:31:58  reinelt
- * USBLCD driver modified to use libusb
- *
- * Revision 1.16  2004/09/24 21:41:00  reinelt
- * new driver for the BWCT USB LCD interface board.
- *
- * Revision 1.15  2004/06/26 12:04:59  reinelt
- *
- * uh-oh... the last CVS log message messed up things a lot...
- *
- * Revision 1.14  2004/06/26 09:27:21  reinelt
- *
- * added '-W' to CFLAGS
- * changed all C++ comments to C ones
- * cleaned up a lot of signed/unsigned mistakes
- *
- * Revision 1.13  2004/06/26 06:12:15  reinelt
- *
- * support for Beckmann+Egle Compact Terminals
- * some mostly cosmetic changes in the MatrixOrbital and USBLCD driver
- * added debugging to the generic serial driver
- * fixed a bug in the generic text driver where icons could be drawn outside
- * the display bounds
- *
- * Revision 1.12  2004/06/20 10:09:54  reinelt
- *
- * 'const'ified the whole source
- *
- * Revision 1.11  2004/06/19 08:20:19  reinelt
- *
- * compiler warning in image driver fixed
- * bar bug in USBLCD driver fixed
- *
- * Revision 1.10  2004/06/06 06:51:59  reinelt
- *
- * do not display end splash screen if quiet=1
- *
- * Revision 1.9  2004/06/05 14:56:48  reinelt
- *
- * Cwlinux splash screen fixed
- * USBLCD splash screen fixed
- * plugin_i2c qprintf("%f") replaced with snprintf()
- *
- * Revision 1.8  2004/06/05 06:41:40  reinelt
- *
- * chancged splash screen again
- *
- * Revision 1.7  2004/06/05 06:13:12  reinelt
- *
- * splash screen for all text-based display drivers
- *
- * Revision 1.6  2004/06/02 09:41:19  reinelt
- *
- * prepared support for startup splash screen
- *
- * Revision 1.5  2004/05/31 05:38:02  reinelt
- *
- * fixed possible bugs with user-defined chars (clear high bits)
- * thanks to Andy Baxter for debugging the MilfordInstruments driver!
- *
- * Revision 1.4  2004/05/26 11:37:36  reinelt
- *
- * Curses driver ported.
- *
- * Revision 1.3  2004/05/23 08:58:30  reinelt
- *
- * icon bug with USBLCD fixed
- *
- * Revision 1.2  2004/03/19 09:17:46  reinelt
- *
- * removed the extra 'goto' function, row and col are additional parameters
- * of the write() function now.
- *
- * Revision 1.1  2004/02/15 08:22:47  reinelt
- * ported USBLCD driver to NextGeneration
- * added drv_M50530.c (I forgot yesterday, sorry)
- * removed old drivers M50530.c and USBLCD.c
- *
  */
 
 /* 
@@ -183,12 +86,8 @@
 static usb_dev_handle *lcd;
 static int interface;
 
-extern int usb_debug;
-
 #endif
 
-extern int got_signal;
-
 
 
 /****************************************/
@@ -206,7 +105,7 @@
 
     info("%s: scanning for USBLCD...", Name);
 
-    usb_debug = 0;
+    usb_set_debug(0);
 
     usb_init();
     usb_find_busses();
@@ -260,7 +159,7 @@
 
     if (use_libusb) {
 #ifdef HAVE_USB_H
-	// Fixme: Endpoint hardcoded to 1 ???
+	/* Fixme: Endpoint hardcoded to 1 ??? */
 	usb_bulk_write(lcd, 1, Buffer, BufPtr - Buffer, 1000);
 #endif
     } else {
@@ -501,6 +400,8 @@
     int asc255bug;
     int ret;
 
+    info("%s: %s", Name, "$Rev: 899 $");
+
     /* display preferences */
     XRES = 5;			/* pixel width of one char  */
     YRES = 8;			/* pixel height of one char  */
@@ -600,8 +501,8 @@
 
 
 DRIVER drv_USBLCD = {
-  name:Name,
-  list:drv_UL_list,
-  init:drv_UL_init,
-  quit:drv_UL_quit,
+    .name = Name,
+    .list = drv_UL_list,
+    .init = drv_UL_init,
+    .quit = drv_UL_quit,
 };
diff -urN lcd4linux-0.10.0/drv_WincorNixdorf.c lcd4linux-0.11.0-SVN/drv_WincorNixdorf.c
--- lcd4linux-0.10.0/drv_WincorNixdorf.c	1970-01-01 01:00:00.000000000 +0100
+++ lcd4linux-0.11.0-SVN/drv_WincorNixdorf.c	2008-12-31 08:05:54.000000000 +0100
@@ -0,0 +1,276 @@
+/* $Id: drv_WincorNixdorf.c 840 2007-09-09 12:17:42Z michael $
+ * $URL: https://ssl.bulix.org/svn/lcd4linux/trunk/drv_WincorNixdorf.c $
+ * 
+ * driver for WincorNixdorf serial cashier displays BA63 and BA66
+ * 
+ * Copyright (C) 2005 Michael Reinelt <michael@reinelt.co.at>
+ * Copyright (C) 2005 The LCD4Linux Team <lcd4linux-devel@users.sourceforge.net>
+ *
+ * based on the SimpleLCD driver which is
+ * Copyright (C) 2005 Julien Aube <ob@obconseil.net>
+ *
+ * This file is part of LCD4Linux.
+ *
+ * LCD4Linux is free software; you can redistribute it and/or modify
+ * it under the terms of the GNU General Public License as published by
+ * the Free Software Foundation; either version 2, or (at your option)
+ * any later version.
+ *
+ * LCD4Linux is distributed in the hope that it will be useful,
+ * but WITHOUT ANY WARRANTY; without even the implied warranty of
+ * MERCHANTABILITY or FITNESS FOR A PARTICULAR PURPOSE.  See the
+ * GNU General Public License for more details.
+ *
+ * You should have received a copy of the GNU General Public License
+ * along with this program; if not, write to the Free Software
+ * Foundation, Inc., 675 Mass Ave, Cambridge, MA 02139, USA.
+ *
+ */
+
+/* 
+ *
+ * exported fuctions:
+ *
+ * struct DRIVER drv_WincorNixdorf
+ *
+ */
+
+#include "config.h"
+
+#include <stdlib.h>
+#include <string.h>
+#include <unistd.h>
+#include <termios.h>
+
+#include "debug.h"
+#include "cfg.h"
+#include "qprintf.h"
+#include "plugin.h"
+#include "widget.h"
+#include "widget_text.h"
+#include "widget_bar.h"
+#include "drv.h"
+#include "drv_generic_text.h"
+#include "drv_generic_serial.h"
+
+
+#define ESC "\033"
+
+
+static char Name[] = "WincorNixdorf";
+
+typedef struct {
+    int type;
+    char *name;
+    int rows;
+    int cols;
+} MODEL;
+
+static MODEL Models[] = {
+    {63, "BA63", 2, 20},
+    {66, "BA66", 4, 20},
+    {-1, "unknown", -1, -1},
+};
+
+static int Model;
+
+
+/****************************************/
+/***  hardware dependant functions    ***/
+/****************************************/
+
+static void drv_WN_clear(void)
+{
+    drv_generic_serial_write(ESC "[2J", 4);
+}
+
+
+static void drv_WN_write(const int row, const int col, const char *data, int len)
+{
+    char cmd[8] = ESC "[r;ccH";
+
+    cmd[2] = '1' + row;
+    cmd[4] = '0' + (col / 10);
+    cmd[5] = '1' + (col % 10);
+
+    drv_generic_serial_write(cmd, 7);
+    drv_generic_serial_write(data, len);
+}
+
+
+static int drv_WN_start(const char *section, const int quiet)
+{
+    int i, len;
+    int selftest;
+    char *model = NULL;
+    char buffer[32];
+
+    model = cfg_get(section, "Model", NULL);
+    if (model == NULL && *model == '\0') {
+	error("%s: no '%s.Model' entry from %s", Name, section, cfg_source());
+	return -1;
+    }
+
+    for (i = 0; Models[i].type != -1; i++) {
+	if (strcasecmp(Models[i].name, model) == 0)
+	    break;
+    }
+    if (Models[i].type == -1) {
+	error("%s: %s.Model '%s' is unknown from %s", Name, section, model, cfg_source());
+	return -1;
+    }
+    Model = i;
+    info("%s: using model '%s'", Name, Models[Model].name);
+
+    /* initialize global variables */
+    DROWS = Models[Model].rows;
+    DCOLS = Models[Model].cols;
+
+    if (drv_generic_serial_open(section, Name, CS8 | PARENB | PARODD) < 0)
+	return -1;
+
+    /* real worker functions */
+    drv_generic_text_real_write = drv_WN_write;
+
+    cfg_number(section, "SelfTest", 0, 0, 1, &selftest);
+    if (selftest) {
+	info("%s: initiating display selftest sequence", Name);
+
+	/* read display identification */
+	drv_generic_serial_write(ESC "[0c", 4);
+	usleep(100 * 1000);
+
+	if ((len = drv_generic_serial_read(buffer, -1 * (int) sizeof(buffer))) > 0) {
+	    info("%s: waiting 15 seconds for selftest", Name);
+	    drv_generic_serial_write(buffer, len);
+	    sleep(15);
+	    info("%s: selftest finished", Name);
+	} else {
+	    info("%s: selftest initiation failed", Name);
+	}
+    }
+
+    /* clear display */
+    drv_WN_clear();
+
+    if (!quiet) {
+	char buffer[40];
+	qprintf(buffer, sizeof(buffer), "%s %dx%d", Name, DCOLS, DROWS);
+	if (drv_generic_text_greet(buffer, NULL)) {
+	    sleep(3);
+	    drv_WN_clear();
+	}
+    }
+
+    return 0;
+}
+
+
+/****************************************/
+/***            plugins               ***/
+/****************************************/
+
+/* none */
+
+
+/****************************************/
+/***        widget callbacks          ***/
+/****************************************/
+
+
+/* using drv_generic_text_draw(W) */
+
+
+/****************************************/
+/***        exported functions        ***/
+/****************************************/
+
+
+/* list models */
+int drv_WN_list(void)
+{
+    printf("BA63 BA66");
+    return 0;
+}
+
+
+/* initialize driver & display */
+int drv_WN_init(const char *section, const int quiet)
+{
+    WIDGET_CLASS wc;
+    int ascii;
+    int ret;
+
+    info("%s: %s", Name, "$Rev: 840 $");
+
+    /* display preferences */
+    XRES = 5;			/* pixel width of one char  */
+    YRES = 7;			/* pixel height of one char  */
+    CHARS = 0;			/* number of user-defineable characters */
+    CHAR0 = 0;			/* ASCII of first user-defineable char */
+    ICONS = 0;			/* number of user-defineable characters reserved for icons */
+    GOTO_COST = 6;		/* number of bytes a goto command requires */
+
+    /* start display */
+    if ((ret = drv_WN_start(section, quiet)) != 0)
+	return ret;
+
+    /* initialize generic text driver */
+    if ((ret = drv_generic_text_init(section, Name)) != 0)
+	return ret;
+
+    /* initialize generic bar driver */
+    if ((ret = drv_generic_text_bar_init(1)) != 0)
+	return ret;
+
+    cfg_number(section, "BarChar", '*', 1, 255, &ascii);
+
+    /* add fixed chars to the bar driver */
+    drv_generic_text_bar_add_segment(0, 0, 255, 32);	/* ASCII  32 = blank */
+    drv_generic_text_bar_add_segment(255, 255, 255, ascii);
+
+    /* register text widget */
+    wc = Widget_Text;
+    wc.draw = drv_generic_text_draw;
+    widget_register(&wc);
+
+    /* register bar widget */
+    wc = Widget_Bar;
+    wc.draw = drv_generic_text_bar_draw;
+    widget_register(&wc);
+
+    /* register plugins */
+    /* none */
+
+    return 0;
+}
+
+
+/* close driver & display */
+int drv_WN_quit(const int quiet)
+{
+
+    info("%s: shutting down.", Name);
+
+    drv_generic_text_quit();
+
+    /* clear display */
+    drv_WN_clear();
+
+    /* say goodbye... */
+    if (!quiet) {
+	drv_generic_text_greet("goodbye!", NULL);
+    }
+
+    drv_generic_serial_close();
+
+    return (0);
+}
+
+
+DRIVER drv_WincorNixdorf = {
+    .name = Name,
+    .list = drv_WN_list,
+    .init = drv_WN_init,
+    .quit = drv_WN_quit,
+};
diff -urN lcd4linux-0.10.0/drv_X11.c lcd4linux-0.11.0-SVN/drv_X11.c
--- lcd4linux-0.10.0/drv_X11.c	2005-05-08 06:32:44.000000000 +0200
+++ lcd4linux-0.11.0-SVN/drv_X11.c	2009-01-15 07:29:47.000000000 +0100
@@ -1,9 +1,10 @@
-/* $Id: drv_X11.c,v 1.11 2005/05/08 04:32:44 reinelt Exp $
+/* $Id: drv_X11.c 966 2009-01-14 18:27:30Z volker $
+ * $URL: https://ssl.bulix.org/svn/lcd4linux/trunk/drv_X11.c $
  *
  * new style X11 Driver for LCD4Linux 
  *
- * Copyright (C) 2003 Michael Reinelt <reinelt@eunet.at>
- * Copyright (C) 2004 The LCD4Linux Team <lcd4linux-devel@users.sourceforge.net>
+ * Copyright (C) 2003 Michael Reinelt <michael@reinelt.co.at>
+ * Copyright (C) 2004, 2008 The LCD4Linux Team <lcd4linux-devel@users.sourceforge.net>
  *
  * based on the old XWindow.c which is
  * Copyright (C) 2000 Herbert Rosmanith <herp@wildsau.idv.uni-linz.ac.at>
@@ -24,52 +25,6 @@
  * along with this program; if not, write to the Free Software
  * Foundation, Inc., 675 Mass Ave, Cambridge, MA 02139, USA.
  *
- *
- * $Log: drv_X11.c,v $
- * Revision 1.11  2005/05/08 04:32:44  reinelt
- * CodingStyle added and applied
- *
- * Revision 1.10  2005/01/18 06:30:23  reinelt
- * added (C) to all copyright statements
- *
- * Revision 1.9  2004/11/29 04:42:07  reinelt
- * removed the 99999 msec limit on widget update time (thanks to Petri Damsten)
- *
- * Revision 1.8  2004/06/26 12:04:59  reinelt
- *
- * uh-oh... the last CVS log message messed up things a lot...
- *
- * Revision 1.7  2004/06/26 09:27:21  reinelt
- *
- * added '-W' to CFLAGS
- * changed all C++ comments to C ones
- * cleaned up a lot of signed/unsigned mistakes
- *
- * Revision 1.6  2004/06/20 10:09:54  reinelt
- *
- * 'const'ified the whole source
- *
- * Revision 1.5  2004/06/08 21:46:38  reinelt
- *
- * splash screen for X11 driver (and generic graphic driver)
- *
- * Revision 1.4  2004/06/06 06:51:59  reinelt
- *
- * do not display end splash screen if quiet=1
- *
- * Revision 1.3  2004/06/02 09:41:19  reinelt
- *
- * prepared support for startup splash screen
- *
- * Revision 1.2  2004/05/25 14:26:29  reinelt
- *
- * added "Image" driver (was: Raster.c) for PPM and PNG creation
- * fixed some glitches in the X11 driver
- *
- * Revision 1.1  2004/02/24 05:55:04  reinelt
- *
- * X11 driver ported
- *
  */
 
 /* 
@@ -99,12 +54,12 @@
 #include "qprintf.h"
 #include "timer.h"
 #include "plugin.h"
-#include "widget.h"
-#include "widget_text.h"
-#include "widget_icon.h"
-#include "widget_bar.h"
+#include "rgb.h"
 #include "drv.h"
+#include "widget.h"
+#include "widget_keypad.h"
 #include "drv_generic_graphic.h"
+#include "drv_generic_keypad.h"
 
 #ifdef WITH_DMALLOC
 #include <dmalloc.h>
@@ -112,25 +67,30 @@
 
 static char Name[] = "X11";
 
-static char *fg_col, *bg_col, *hg_col;
-
 static int pixel = -1;		/* pointsize in pixel */
 static int pgap = 0;		/* gap between points */
 static int rgap = 0;		/* row gap between lines */
 static int cgap = 0;		/* column gap between characters */
 static int border = 0;		/* window border */
+static int buttons = 0;		/* number of keypad buttons */
+static int btnwidth = 0;
+static int btnheight = 0;
 
 static int dimx, dimy;		/* total window dimension in pixel */
+static Atom wmDeleteMessage;
 
-static unsigned char *drv_X11_FB = NULL;
+static RGBA *drv_X11_FB = NULL;	/* framebuffer */
+
+static RGBA BP_COL = {.R = 0xff,.G = 0xff,.B = 0xff,.A = 0x00 };	/* pixel background color */
+static RGBA BR_COL = {.R = 0xff,.G = 0xff,.B = 0xff,.A = 0x00 };	/* border color */
 
 static Display *dp;
 static int sc, dd;
 static Window w, rw;
 static Visual *vi;
-static GC fg_gc, bg_gc, hg_gc;
+static GC gc;
 static Colormap cm;
-static XColor fg_xc, bg_xc, hg_xc;
+static XColor xc;
 static Pixmap pm;
 
 
@@ -138,26 +98,106 @@
 /***  hardware dependant functions    ***/
 /****************************************/
 
+static void drv_X11_color(RGBA c, int brightness)
+{
+    xc.red = brightness * c.R;
+    xc.green = brightness * c.G;
+    xc.blue = brightness * c.B;
+    xc.flags = DoRed | DoGreen | DoBlue;
+    if (XAllocColor(dp, cm, &xc) == False) {
+	error("%s: XAllocColor(%02x%02x%02x) failed!", Name, c.R, c.G, c.B);
+    }
+    XSetForeground(dp, gc, xc.pixel);
+    XSetBackground(dp, gc, xc.pixel);
+
+}
+
+
 static void drv_X11_blit(const int row, const int col, const int height, const int width)
 {
     int r, c;
-    int dirty = 0;
 
-    for (r = row; r < row + height && r < DROWS; r++) {
+    for (r = row; r < row + height; r++) {
 	int y = border + (r / YRES) * rgap + r * (pixel + pgap);
-	for (c = col; c < col + width && c < DCOLS; c++) {
+	for (c = col; c < col + width; c++) {
 	    int x = border + (c / XRES) * cgap + c * (pixel + pgap);
-	    unsigned char p = drv_generic_graphic_FB[r * LCOLS + c];
-	    if (drv_X11_FB[r * DCOLS + c] != p) {
-		XFillRectangle(dp, w, p ? fg_gc : hg_gc, x, y, pixel, pixel);
-		drv_X11_FB[r * DCOLS + c] = p;
-		dirty = 1;
+	    RGBA p1 = drv_X11_FB[r * DCOLS + c];
+	    RGBA p2 = drv_generic_graphic_rgb(r, c);
+	    if (p1.R != p2.R || p1.G != p2.G || p1.B != p2.B) {
+		XClearArea(dp, w, x, y, pixel, pixel, 1);
+		drv_X11_FB[r * DCOLS + c] = p2;
 	    }
 	}
     }
-    if (dirty) {
-	XSync(dp, False);
+}
+
+
+static int drv_X11_brightness(int brightness)
+{
+    static int Brightness = 255;
+
+    /* -1 is used to query the current brightness */
+    if (brightness == -1)
+	return Brightness;
+
+    if (brightness < 0)
+	brightness = 0;
+    if (brightness > 255)
+	brightness = 255;
+
+    if (Brightness != brightness) {
+
+	float dim = brightness / 255.0;
+
+	debug("%s: set brightness to %d%%", Name, (int) (dim * 100));
+
+	BL_COL.R = BP_COL.R * dim;
+	BL_COL.G = BP_COL.G * dim;
+	BL_COL.B = BP_COL.B * dim;
+
+	/* set new background */
+	drv_X11_color(BR_COL, brightness);
+	XSetWindowBackground(dp, w, xc.pixel);
+
+	/* redraw every LCD pixel */
+	drv_X11_blit(0, 0, LROWS, LCOLS);
+
+	/* remember new brightness */
+	Brightness = brightness;
+    }
+
+    return Brightness;
+}
+
+
+static int drv_X11_keypad(const int num)
+{
+    int val = WIDGET_KEY_PRESSED;
+
+    switch (num) {
+    case 1:
+	val += WIDGET_KEY_UP;
+	break;
+    case 2:
+	val += WIDGET_KEY_DOWN;
+	break;
+    case 3:
+	val += WIDGET_KEY_LEFT;
+	break;
+    case 4:
+	val += WIDGET_KEY_RIGHT;
+	break;
+    case 5:
+	val += WIDGET_KEY_CONFIRM;
+	break;
+    case 6:
+	val += WIDGET_KEY_CANCEL;
+	break;
+    default:
+	error("%s: unknown keypad value %d", Name, num);
     }
+
+    return val;
 }
 
 
@@ -174,6 +214,17 @@
     int r, c;
     int x0, y0;
     int x1, y1;
+    XFontStruct *xfs;
+    int xoffset = border + (DCOLS / XRES) * cgap + DCOLS * (pixel + pgap);
+    int yoffset = border + (DROWS / YRES) * rgap;
+    int yk;
+    char *s;
+    char unknownTxt[10];
+    XRectangle rect[DROWS * DCOLS];
+    int nrect = 0;
+    RGBA col;
+    RGBA lastCol = { 0, 0, 0, 0 };
+    int hasLastCol = 0;
 
     x0 = x - pixel;
     x1 = x + pixel + width;
@@ -188,10 +239,72 @@
 	    int xc = border + (c / XRES) * cgap + c * (pixel + pgap);
 	    if (xc < x0 || xc > x1)
 		continue;
-	    XFillRectangle(dp, w, drv_generic_graphic_FB[r * LCOLS + c] ? fg_gc : hg_gc, xc, yc, pixel, pixel);
+	    col = drv_generic_graphic_rgb(r, c);
+	    if (hasLastCol) {
+		/* if the color of this pixel is different to the last pixels draw the old ones */
+		if (col.R != lastCol.R || col.G != lastCol.G || col.B != lastCol.B) {
+		    drv_X11_color(lastCol, 255);
+		    XFillRectangles(dp, w, gc, rect, nrect);
+		    nrect = 0;
+		    lastCol = col;
+		}
+		rect[nrect].x = xc;
+		rect[nrect].y = yc;
+		rect[nrect].width = pixel;
+		rect[nrect].height = pixel;
+		nrect++;
+	    } else {
+		/* 1st shot: no old color */
+		drv_X11_color(col, 255);
+		XFillRectangle(dp, w, gc, xc, yc, pixel, pixel);
+		lastCol = col;
+		hasLastCol = 1;
+	    }
+	}
+    }
+    /* draw the last block of rectangles */
+    drv_X11_color(lastCol, 255);
+    XFillRectangles(dp, w, gc, rect, nrect);
+
+    /* Keypad on the right side */
+    if (x1 >= xoffset) {
+	xfs = XQueryFont(dp, XGContextFromGC(DefaultGC(dp, 0)));
+	if (drv_X11_brightness(-1) > 127) {
+	    drv_X11_color(FG_COL, 255);
+	} else {
+	    drv_X11_color(BG_COL, 255);
+	}
+	for (r = 0; r < buttons; r++) {
+	    yk = yoffset + r * (btnheight + pgap);
+	    switch (r) {
+	    case 0:
+		s = "Up";
+		break;
+	    case 1:
+		s = "Down";
+		break;
+	    case 2:
+		s = "Left";
+		break;
+	    case 3:
+		s = "Right";
+		break;
+	    case 4:
+		s = "Confirm";
+		break;
+	    case 5:
+		s = "Cancel";
+		break;
+	    default:
+		snprintf(unknownTxt, sizeof(unknownTxt), "#%d??", r);
+		s = unknownTxt;
+	    }
+	    XDrawRectangle(dp, w, gc, xoffset, yk, btnwidth, btnheight - 2);
+	    XDrawString(dp, w, gc,
+			xoffset + btnwidth / 2 - (xfs->max_bounds.width * strlen(s)) / 2,
+			yk + btnheight / 2 + xfs->max_bounds.ascent / 2, s, strlen(s));
 	}
     }
-    XSync(dp, False);
 }
 
 
@@ -199,24 +312,86 @@
 			  void *notused)
 {
     XEvent ev;
+    XRectangle exp;
+    int xoffset = border + (DCOLS / XRES) * cgap + DCOLS * (pixel + pgap);
+    int yoffset = border + (DROWS / YRES) * rgap;
+    static int btn = 0;
 
-    if (XCheckWindowEvent(dp, w, ExposureMask, &ev) == 0)
+    if (XCheckWindowEvent(dp, w, ExposureMask | ButtonPressMask | ButtonReleaseMask, &ev) == 0)
 	return;
-    if (ev.type == Expose) {
-	drv_X11_expose(ev.xexpose.x, ev.xexpose.y, ev.xexpose.width, ev.xexpose.height);
+
+    switch (ev.type) {
+
+    case Expose:
+	/* collect all expose events in eventqueue */
+	exp.x = ev.xexpose.x;
+	exp.y = ev.xexpose.y;
+	exp.width = ev.xexpose.width;
+	exp.height = ev.xexpose.height;
+	while (XCheckWindowEvent(dp, w, ExposureMask, &ev)) {
+	    if (ev.xexpose.x < exp.x) {
+		exp.width += exp.x - ev.xexpose.x;
+		exp.x -= exp.x - ev.xexpose.x;
+	    }
+	    if (ev.xexpose.y < exp.y) {
+		exp.height += exp.y - ev.xexpose.y;
+		exp.y -= exp.y - ev.xexpose.y;
+	    }
+	    if (ev.xexpose.x + ev.xexpose.width > exp.x + exp.width) {
+		exp.width += ev.xexpose.x + ev.xexpose.width - (exp.x + exp.width);
+	    }
+	    if (ev.xexpose.y + ev.xexpose.height > exp.y + exp.height) {
+		exp.height += ev.xexpose.y + ev.xexpose.height - (exp.y + exp.height);
+	    }
+	}
+	drv_X11_expose(exp.x, exp.y, exp.width, exp.height);
+	break;
+
+    case ButtonPress:
+	if (ev.xbutton.x >= xoffset && ev.xbutton.x <= xoffset + btnwidth
+	    && ev.xbutton.y >= yoffset && ev.xbutton.y <= yoffset + buttons * btnheight + (buttons - 1) * pgap) {
+	    btn = (ev.xbutton.y - yoffset) / (btnheight + pgap) + 1;	/* btn 0 is unused */
+	    debug("button %d pressed", btn);
+	    drv_X11_color(BG_COL, 255);
+	    XFillRectangle(dp, w, gc, xoffset + 1, yoffset + (btn - 1) * (btnheight + pgap) + 1, btnwidth - 1,
+			   btnheight - 2 - 1);
+	    drv_generic_keypad_press(btn);
+	}
+	break;
+
+    case ButtonRelease:
+	if (ev.xbutton.x >= xoffset && ev.xbutton.x <= xoffset + btnwidth
+	    && ev.xbutton.y >= yoffset && ev.xbutton.y <= yoffset + buttons * btnheight + (buttons - 1) * pgap) {
+	    btn = (ev.xbutton.y - yoffset) / (btnheight + pgap) + 1;	/* btn 0 is unused */
+	    debug("button %d released", btn);
+	    XClearArea(dp, w, xoffset, yoffset + (btn - 1) * (btnheight + pgap), btnwidth, btnheight - 2,
+		       1 /* true */ );
+	}
+	break;
+
+    case ClientMessage:
+        if ((Atom)(ev.xclient.data.l[0]) == wmDeleteMessage) {
+            info("%s: Window closed by WindowManager, quit.", Name);
+            exit(0);
+        } else {
+            debug("%s: Got client message 0x%lx %lx %lx %lx %lx", Name, ev.xclient.data.l[0],
+                  ev.xclient.data.l[1], ev.xclient.data.l[2], ev.xclient.data.l[3], ev.xclient.data.l[4]);
+        }
+
+    default:
+	debug("%s: unknown XEvent %d", Name, ev.type);
     }
 }
 
 
 static int drv_X11_start(const char *section)
 {
+    int i;
     char *s;
     XSetWindowAttributes wa;
     XSizeHints sh;
-    XColor dummy;
     XEvent ev;
 
-
     /* read display size from config */
     if (sscanf(s = cfg_get(section, "Size", "120x32"), "%dx%d", &DCOLS, &DROWS) != 2 || DCOLS < 1 || DROWS < 1) {
 	error("%s: bad %s.Size '%s' from %s", Name, section, s, cfg_source());
@@ -254,25 +429,40 @@
     if (cfg_number(section, "border", 0, 0, -1, &border) < 0)
 	return -1;
 
-    fg_col = cfg_get(section, "foreground", "#000000");
-    bg_col = cfg_get(section, "background", "#80d000");
-    hg_col = cfg_get(section, "halfground", "#70c000");
-    if (*fg_col == '\\')
-	fg_col++;
-    if (*bg_col == '\\')
-	bg_col++;
-    if (*hg_col == '\\')
-	hg_col++;
+    /* special case for the X11 driver: 
+     * the border color may be different from the backlight color
+     * the backlicht color is the color of an inactive pixel
+     * the border color is the color of the border and gaps between pixels
+     * for the brightness pugin we need a copy of BL_COL, we call it BP_COL
+     */
+    s = cfg_get(section, "basecolor", "000000ff");
+    if (color2RGBA(s, &BP_COL) < 0) {
+	error("%s: ignoring illegal color '%s'", Name, s);
+    }
+    free(s);
+    BL_COL = BP_COL;
+
+    BR_COL = BP_COL;
+    if ((s = cfg_get(section, "bordercolor", NULL)) != NULL) {
+	if (color2RGBA(s, &BR_COL) < 0) {
+	    error("%s: ignoring illegal color '%s'", Name, s);
+	}
+	free(s);
+    }
 
+    /* virtual keyboard: number of buttons (0..6) */
+    if (cfg_number(section, "buttons", 0, 0, 6, &buttons) < 0)
+	return -1;
 
-    drv_X11_FB = malloc(DCOLS * DROWS);
+    drv_X11_FB = malloc(DCOLS * DROWS * sizeof(*drv_X11_FB));
     if (drv_X11_FB == NULL) {
 	error("%s: framebuffer could not be allocated: malloc() failed", Name);
 	return -1;
     }
 
-    /* init with 255 so all 'halfground' pixels will be drawn */
-    memset(drv_X11_FB, 255, DCOLS * DROWS * sizeof(*drv_X11_FB));
+    for (i = 0; i < DCOLS * DROWS; i++) {
+	drv_X11_FB[i] = NO_COL;
+    }
 
     if ((dp = XOpenDisplay(NULL)) == NULL) {
 	error("%s: can't open display", Name);
@@ -280,58 +470,50 @@
     }
 
     sc = DefaultScreen(dp);
-    fg_gc = DefaultGC(dp, sc);
+    gc = DefaultGC(dp, sc);
     vi = DefaultVisual(dp, sc);
     dd = DefaultDepth(dp, sc);
     rw = DefaultRootWindow(dp);
     cm = DefaultColormap(dp, sc);
 
-    if (XAllocNamedColor(dp, cm, fg_col, &fg_xc, &dummy) == False) {
-	error("%s: can't alloc foreground color '%s'", Name, fg_col);
-	return -1;
-    }
-
-    if (XAllocNamedColor(dp, cm, bg_col, &bg_xc, &dummy) == False) {
-	error("%s: can't alloc background color '%s'", Name, bg_col);
-	return -1;
-    }
-
-    if (XAllocNamedColor(dp, cm, hg_col, &hg_xc, &dummy) == False) {
-	error("%s: can't alloc halfground color '%s'", Name, hg_col);
-	return -1;
-    }
-
     dimx = DCOLS * pixel + (DCOLS - 1) * pgap + (DCOLS / XRES - 1) * cgap;
     dimy = DROWS * pixel + (DROWS - 1) * pgap + (DROWS / YRES - 1) * rgap;
+    if (buttons != 0) {
+	btnwidth = (DCOLS * pixel + (DCOLS - 1) * pgap) / 10;
+	btnheight = (DROWS * pixel + (DROWS - 1) * pgap) / buttons;
+    }
 
-    wa.event_mask = ExposureMask;
-
-    w = XCreateWindow(dp, rw, 0, 0, dimx + 2 * border, dimy + 2 * border, 0, 0, InputOutput, vi, CWEventMask, &wa);
-
-    pm = XCreatePixmap(dp, w, dimx, dimy, dd);
+    wa.event_mask = ExposureMask | ButtonPressMask | ButtonReleaseMask;
 
-    sh.min_width = sh.max_width = dimx + 2 * border;
+    sh.min_width = sh.max_width = dimx + 2 * border + btnwidth;
     sh.min_height = sh.max_height = dimy + 2 * border;
     sh.flags = PPosition | PSize | PMinSize | PMaxSize;
 
-    XSetWMProperties(dp, w, NULL, NULL, NULL, 0, &sh, NULL, NULL);
-
+    if (sh.min_width > DisplayWidth(dp, sc) || sh.min_height > DisplayHeight(dp, sc)) {
+        error("%s: Warning: X11-Window with dimensions (%d,%d) is greater than display (%d,%d)!",
+              Name, sh.min_width, sh.min_height, DisplayWidth(dp, sc), DisplayHeight(dp, sc));
+        if (sh.min_width > 32767 || sh.min_height > 32676) {
+            /* XProtocol data size exceeded */
+            exit(1);
+        }
+    }
+    w = XCreateWindow(dp, rw, 0, 0, sh.min_width, sh.min_height, 0, 0, InputOutput, vi, CWEventMask, &wa);
 
-    XSetForeground(dp, fg_gc, fg_xc.pixel);
-    XSetBackground(dp, fg_gc, bg_xc.pixel);
+    pm = XCreatePixmap(dp, w, dimx, dimy, dd);
 
-    bg_gc = XCreateGC(dp, w, 0, NULL);
-    XSetForeground(dp, bg_gc, bg_xc.pixel);
-    XSetBackground(dp, bg_gc, fg_xc.pixel);
-
-    hg_gc = XCreateGC(dp, w, 0, NULL);
-    XSetForeground(dp, hg_gc, hg_xc.pixel);
-    XSetBackground(dp, hg_gc, fg_xc.pixel);
+    XSetWMProperties(dp, w, NULL, NULL, NULL, 0, &sh, NULL, NULL);
+    wmDeleteMessage = XInternAtom(dp, "WM_DELETE_WINDOW", False);
+    /* XSetWMProtocols(dp, w, &wmDeleteMessage, 1); *to be tested* */
 
-    XFillRectangle(dp, pm, bg_gc, 0, 0, dimx + 2 * border, dimy + 2 * border);
-    XSetWindowBackground(dp, w, bg_xc.pixel);
+    drv_X11_color(BR_COL, 255);
+    XSetWindowBackground(dp, w, xc.pixel);
     XClearWindow(dp, w);
 
+    /* set brightness (after first background painting) */
+    if (cfg_number(section, "Brightness", 255, 0, 255, &i) > 0) {
+	drv_X11_brightness(i);
+    }
+
     XStoreName(dp, w, "LCD4Linux");
     XMapWindow(dp, w);
 
@@ -356,17 +538,24 @@
 /***            plugins               ***/
 /****************************************/
 
-/* none at the moment... */
-
-
-/****************************************/
-/***        widget callbacks          ***/
-/****************************************/
-
+static void plugin_brightness(RESULT * result, const int argc, RESULT * argv[])
+{
+    double brightness;
 
-/* using drv_generic_graphic_draw(W) */
-/* using drv_generic_graphic_icon_draw(W) */
-/* using drv_generic_graphic_bar_draw(W) */
+    switch (argc) {
+    case 0:
+	brightness = drv_X11_brightness(-1);
+	SetResult(&result, R_NUMBER, &brightness);
+	break;
+    case 1:
+	brightness = drv_X11_brightness(R2N(argv[0]));
+	SetResult(&result, R_NUMBER, &brightness);
+	break;
+    default:
+	error("%s.brightness(): wrong number of parameters", Name);
+	SetResult(&result, R_STRING, "");
+    }
+}
 
 
 /****************************************/
@@ -377,7 +566,7 @@
 /* list models */
 int drv_X11_list(void)
 {
-    printf("any");
+    printf("any X11 server");
     return 0;
 }
 
@@ -385,50 +574,47 @@
 /* initialize driver & display */
 int drv_X11_init(const char *section, const int quiet)
 {
-    WIDGET_CLASS wc;
+    RGBA bl_col;
     int ret;
 
-    /* real worker functions */
-    drv_generic_graphic_real_blit = drv_X11_blit;
+    info("%s: %s", Name, "$Rev: 966 $");
 
     /* start display */
     if ((ret = drv_X11_start(section)) != 0)
 	return ret;
 
+    /* real worker functions */
+    drv_generic_graphic_real_blit = drv_X11_blit;
+    drv_generic_keypad_real_press = drv_X11_keypad;
+
     /* initialize generic graphic driver */
+    /* save BL_COL which may already be dimmed */
+    bl_col = BL_COL;
     if ((ret = drv_generic_graphic_init(section, Name)) != 0)
 	return ret;
+    BL_COL = bl_col;
+
+    /* initialize generic key pad driver */
+    if ((ret = drv_generic_keypad_init(section, Name)) != 0)
+	return ret;
 
-    /* initially expose window */
     drv_generic_graphic_clear();
+
+    /* initially expose window */
     drv_X11_expose(0, 0, dimx + 2 * border, dimy + 2 * border);
 
     if (!quiet) {
 	char buffer[40];
 	qprintf(buffer, sizeof(buffer), "%s %dx%d", Name, DCOLS, DROWS);
 	if (drv_generic_graphic_greet(buffer, NULL)) {
+	    drv_X11_expose(0, 0, dimx + 2 * border, dimy + 2 * border);
 	    sleep(3);
 	    drv_generic_graphic_clear();
 	}
     }
 
-    /* register text widget */
-    wc = Widget_Text;
-    wc.draw = drv_generic_graphic_draw;
-    widget_register(&wc);
-
-    /* register icon widget */
-    wc = Widget_Icon;
-    wc.draw = drv_generic_graphic_icon_draw;
-    widget_register(&wc);
-
-    /* register bar widget */
-    wc = Widget_Bar;
-    wc.draw = drv_generic_graphic_bar_draw;
-    widget_register(&wc);
-
     /* register plugins */
-    /* none at the moment... */
+    AddFunction("LCD::brightness", -1, plugin_brightness);
 
 
     return 0;
@@ -442,6 +628,7 @@
 
     info("%s: shutting down.", Name);
     drv_generic_graphic_quit();
+    drv_generic_keypad_quit();
 
     if (drv_X11_FB) {
 	free(drv_X11_FB);
@@ -453,8 +640,8 @@
 
 
 DRIVER drv_X11 = {
-  name:Name,
-  list:drv_X11_list,
-  init:drv_X11_init,
-  quit:drv_X11_quit,
+    .name = Name,
+    .list = drv_X11_list,
+    .init = drv_X11_init,
+    .quit = drv_X11_quit,
 };
diff -urN lcd4linux-0.10.0/evaluator.c lcd4linux-0.11.0-SVN/evaluator.c
--- lcd4linux-0.10.0/evaluator.c	2005-05-08 06:32:44.000000000 +0200
+++ lcd4linux-0.11.0-SVN/evaluator.c	2009-01-06 07:55:32.000000000 +0100
@@ -1,8 +1,9 @@
-/* $Id: evaluator.c,v 1.25 2005/05/08 04:32:44 reinelt Exp $
+/* $Id: evaluator.c 946 2009-01-06 06:55:32Z michael $
+ * $URL: https://ssl.bulix.org/svn/lcd4linux/trunk/evaluator.c $
  *
  * expression evaluation
  *
- * Copyright (C) 1999, 2000 Michael Reinelt <reinelt@eunet.at>
+ * Copyright (C) 1999, 2000 Michael Reinelt <michael@reinelt.co.at>
  * Copyright (C) 2004 The LCD4Linux Team <lcd4linux-devel@users.sourceforge.net>
  *
  * This file is part of LCD4Linux.
@@ -21,111 +22,6 @@
  * along with this program; if not, write to the Free Software
  * Foundation, Inc., 675 Mass Ave, Cambridge, MA 02139, USA.
  *
- *
- * $Log: evaluator.c,v $
- * Revision 1.25  2005/05/08 04:32:44  reinelt
- * CodingStyle added and applied
- *
- * Revision 1.24  2005/03/30 04:57:50  reinelt
- * Evaluator speedup: use bsearch for finding functions and variables
- *
- * Revision 1.23  2005/01/18 06:30:23  reinelt
- * added (C) to all copyright statements
- *
- * Revision 1.22  2004/06/26 12:04:59  reinelt
- *
- * uh-oh... the last CVS log message messed up things a lot...
- *
- * Revision 1.21  2004/06/26 09:27:21  reinelt
- *
- * added '-W' to CFLAGS
- * changed all C++ comments to C ones
- * cleaned up a lot of signed/unsigned mistakes
- *
- * Revision 1.20  2004/06/20 10:09:56  reinelt
- *
- * 'const'ified the whole source
- *
- * Revision 1.19  2004/04/12 11:12:25  reinelt
- * added plugin_isdn, removed old ISDN client
- * fixed some real bad bugs in the evaluator
- *
- * Revision 1.18  2004/03/11 06:39:58  reinelt
- * big patch from Martin:
- * - reuse filehandles
- * - memory leaks fixed
- * - earlier busy-flag checking with HD44780
- * - reuse memory for strings in RESULT and hash
- * - netdev_fast to wavid time-consuming regex
- *
- * Revision 1.17  2004/03/08 18:45:52  hejl
- * fixed segfault when using string concatenation
- *
- * Revision 1.16  2004/03/08 04:33:08  reinelt
- * string concatenation fixed
- *
- * Revision 1.15  2004/03/06 20:31:16  reinelt
- * Complete rewrite of the evaluator to get rid of the code
- * from mark Morley (because of license issues).
- * The new Evaluator does a pre-compile of expressions, and
- * stores them in trees. Therefore it should be reasonable faster...
- *
- * Revision 1.14  2004/03/03 03:47:04  reinelt
- * big patch from Martin Hejl:
- * - use qprintf() where appropriate
- * - save CPU cycles on gettimeofday()
- * - add quit() functions to free allocated memory
- * - fixed lots of memory leaks
- *
- * Revision 1.13  2004/02/26 21:42:45  reinelt
- * memory leak fixes from Martin
- *
- * Revision 1.12  2004/02/05 07:10:23  reinelt
- * evaluator function names are no longer case-sensitive
- * Crystalfontz Fan PWM control, Fan RPM monitoring, temperature monitoring
- *
- * Revision 1.11  2004/01/30 20:57:56  reinelt
- * HD44780 patch from Martin Hejl
- * dmalloc integrated
- *
- * Revision 1.10  2004/01/29 04:40:02  reinelt
- * every .c file includes "config.h" now
- *
- * Revision 1.9  2004/01/15 07:47:02  reinelt
- * debian/ postinst and watch added (did CVS forget about them?)
- * evaluator: conditional expressions (a?b:c) added
- * text widget nearly finished
- *
- * Revision 1.8  2004/01/12 03:51:01  reinelt
- * evaluating the 'Variables' section in the config file
- *
- * Revision 1.7  2004/01/07 10:15:41  reinelt
- * small glitch in evaluator fixed
- * made config table sorted and access with bsearch(),
- * which should be much faster
- *
- * Revision 1.6  2004/01/06 23:01:37  reinelt
- * more copyright issues
- *
- * Revision 1.5  2004/01/06 17:33:45  reinelt
- * Evaluator: functions with variable argument lists
- * Evaluator: plugin_sample.c and README.Plugins added
- *
- * Revision 1.4  2004/01/06 15:19:12  reinelt
- * Evaluator rearrangements...
- *
- * Revision 1.3  2003/10/11 06:01:52  reinelt
- * renamed expression.{c,h} to client.{c,h}
- * added config file client
- * new functions 'AddNumericVariable()' and 'AddStringVariable()'
- * new parameter '-i' for interactive mode
- *
- * Revision 1.2  2003/10/06 05:47:27  reinelt
- * operators: ==, \!=, <=, >=
- *
- * Revision 1.1  2003/10/06 04:34:06  reinelt
- * expression evaluator added
- *
  */
 
 
@@ -212,12 +108,18 @@
     O_COL,			/* colon in a?b:c */
     O_OR,			/* logical OR */
     O_AND,			/* logical AND */
-    O_EQ,			/* equal */
-    O_NE,			/* not equal */
-    O_LT,			/* less than */
-    O_LE,			/* less or equal */
-    O_GT,			/* greater than */
-    O_GE,			/* greater or equal */
+    O_NEQ,			/* numeric equal */
+    O_NNE,			/* numeric not equal */
+    O_NLT,			/* numeric less than */
+    O_NLE,			/* numeric less or equal */
+    O_NGT,			/* numeric greater than */
+    O_NGE,			/* numeric greater or equal */
+    O_SEQ,			/* string equal */
+    O_SNE,			/* string not equal */
+    O_SLT,			/* string less than */
+    O_SLE,			/* string less or equal */
+    O_SGT,			/* string greater than */
+    O_SGE,			/* string greater or equal */
     O_ADD,			/* addition */
     O_SUB,			/* subtraction */
     O_SGN,			/* sign '-' */
@@ -261,17 +163,17 @@
 
 
 
-/* operators */
+/* non-alphanumeric operators */
 /* IMPORTANT! list must be sorted by length! */
-static PATTERN Pattern[] = {
+static PATTERN Pattern1[] = {
     {";", 1, O_LST},		/* expression lists */
     {"=", 1, O_SET},		/* variable assignements */
     {"?", 1, O_CND},		/* conditional a?b:c */
     {":", 1, O_COL},		/* colon a?b:c */
     {"|", 1, O_OR},		/* logical OR */
     {"&", 1, O_AND},		/* logical AND */
-    {"<", 1, O_LT},		/* less than */
-    {">", 1, O_GT},		/* greater than */
+    {"<", 1, O_NLT},		/* numeric less than */
+    {">", 1, O_NGT},		/* numeric greater than */
     {"+", 1, O_ADD},		/* addition */
     {"-", 1, O_SUB},		/* subtraction or sign */
     {".", 1, O_CAT},		/* string concatenation */
@@ -283,10 +185,21 @@
     {"(", 1, O_BRO},		/* open brace */
     {",", 1, O_COM},		/* comma (argument seperator) */
     {")", 1, O_BRC},		/* closing brace */
-    {"==", 2, O_EQ},		/* equal */
-    {"!=", 2, O_NE},		/* not equal */
-    {"<=", 2, O_LE},		/* less or equal */
-    {">=", 2, O_GE}		/* greater or equal */
+    {"==", 2, O_NEQ},		/* numeric equal */
+    {"!=", 2, O_NNE},		/* numeric not equal */
+    {"<=", 2, O_NLE},		/* numeric less or equal */
+    {">=", 2, O_NGE}		/* numeric greater or equal */
+};
+
+/* alphanumeric operators */
+/* IMPORTANT! list must be sorted by length! */
+static PATTERN Pattern2[] = {
+    {"eq", 2, O_SEQ},		/* string equal */
+    {"ne", 2, O_SNE},		/* string not equal */
+    {"lt", 2, O_SLT},		/* string less than */
+    {"le", 2, O_SLE},		/* string less or equal */
+    {"gt", 2, O_SGT},		/* string greater than */
+    {"ge", 2, O_SGE}		/* string greater or equal */
 };
 
 
@@ -296,18 +209,42 @@
 static TOKEN Token = T_UNDEF;
 static OPERATOR Operator = O_UNDEF;
 
-static VARIABLE *Variable = NULL;
-static int nVariable = 0;
+static VARIABLE Variable[255];
+static unsigned int nVariable = 0;
 
 static FUNCTION *Function = NULL;
-static int nFunction = 0;
+static unsigned int nFunction = 0;
+
+
+/* strndup() may be not available on several platforms */
+#ifndef HAVE_STRNDUP
+char *strndup(const char *source, size_t len)
+{
+    char *tmp = NULL;
+
+    if (source == NULL)
+	return NULL;
+
+    if (len >= strlen(source))
+	return strdup(source);
+
+    tmp = malloc(len + 1);
+    if (tmp == 0)
+	return NULL;
+
+    strncpy(tmp, source, len);
+    tmp[len] = '\0';
+
+    return (tmp);
+}
+#endif
 
 
 void DelResult(RESULT * result)
 {
     result->type = 0;
+    result->size = 0;
     result->number = 0.0;
-    result->length = -1;
     if (result->string) {
 	free(result->string);
 	result->string = NULL;
@@ -332,37 +269,14 @@
 	return NULL;
     }
     result->type = 0;
+    result->size = 0;
     result->number = 0.0;
-    result->length = -1;
     result->string = NULL;
 
     return result;
 }
 
 
-static RESULT *DupResult(RESULT * result)
-{
-    RESULT *result2;
-
-    if ((result2 = NewResult()) == NULL)
-	return NULL;
-
-    result2->type = result->type;
-    result2->number = result->number;
-
-    if (result->length >= 0) {
-	result2->length = result->length;
-	result2->string = malloc(result2->length);
-	strcpy(result2->string, result->string);
-    } else {
-	result2->length = -1;
-	result2->string = NULL;
-    }
-
-    return result2;
-}
-
-
 RESULT *SetResult(RESULT ** result, const int type, const void *value)
 {
     if (*result == NULL) {
@@ -374,8 +288,8 @@
 
     if (type == R_NUMBER) {
 	(*result)->type = R_NUMBER;
+	(*result)->size = 0;
 	(*result)->number = *(double *) value;
-	(*result)->length = -1;
 	(*result)->string = NULL;
     }
 
@@ -383,14 +297,13 @@
 	int len = strlen((char *) value);
 	(*result)->type = R_STRING;
 	(*result)->number = 0.0;
-	if ((*result)->string == NULL || len > (*result)->length) {
+	if ((*result)->string == NULL || len >= (*result)->size) {
 	    /* buffer is either empty or too small */
 	    if ((*result)->string)
 		free((*result)->string);
 	    /* allocate memory in multiples of CHUNK_SIZE */
-	    /* note that length does not count the trailing \0 */
-	    (*result)->length = CHUNK_SIZE * (len / CHUNK_SIZE + 1) - 1;
-	    (*result)->string = malloc((*result)->length + 1);
+	    (*result)->size = CHUNK_SIZE * ((len + 1) / CHUNK_SIZE + 1);
+	    (*result)->string = malloc((*result)->size);
 	}
 	strcpy((*result)->string, value);
     } else {
@@ -402,6 +315,35 @@
 }
 
 
+RESULT *CopyResult(RESULT ** result, RESULT * value)
+{
+    if (*result == NULL) {
+	if ((*result = NewResult()) == NULL)
+	    return NULL;
+    }
+
+    (*result)->type = value->type;
+    (*result)->number = value->number;
+
+    if (value->string == NULL) {
+	(*result)->size = 0;
+	if ((*result)->string)
+	    free((*result)->string);
+	(*result)->string = NULL;
+    } else {
+	/* is buffer large enough? */
+	if ((*result)->string == NULL || value->size > (*result)->size) {
+	    if ((*result)->string)
+		free((*result)->string);
+	    (*result)->size = value->size;
+	    (*result)->string = malloc((*result)->size);
+	}
+	strcpy((*result)->string, value->string);
+    }
+    return *result;
+}
+
+
 double R2N(RESULT * result)
 {
     if (result == NULL) {
@@ -409,6 +351,10 @@
 	return 0.0;
     }
 
+    if (result->type == 0) {
+	return 0.0;
+    }
+
     if (result->type & R_NUMBER) {
 	return result->number;
     }
@@ -431,6 +377,10 @@
 	return NULL;
     }
 
+    if (result->type == 0) {
+	return NULL;
+    }
+
     if (result->type & R_STRING) {
 	return result->string;
     }
@@ -439,9 +389,9 @@
 	result->type |= R_STRING;
 	if (result->string)
 	    free(result->string);
-	result->length = CHUNK_SIZE - 1;
-	result->string = malloc(CHUNK_SIZE);
-	snprintf(result->string, CHUNK_SIZE, "%g", result->number);
+	result->size = CHUNK_SIZE;
+	result->string = malloc(result->size);
+	snprintf(result->string, result->size, "%g", result->number);
 	return result->string;
     }
 
@@ -451,29 +401,16 @@
 }
 
 
-/* bsearch compare function for variables */
-static int LookupVariable(const void *a, const void *b)
-{
-    char *key = (char *) a;
-    VARIABLE *var = (VARIABLE *) b;
-
-    return strcmp(key, var->name);
-}
-
-
-/* qsort compare function for variables */
-static int SortVariable(const void *a, const void *b)
-{
-    VARIABLE *va = (VARIABLE *) a;
-    VARIABLE *vb = (VARIABLE *) b;
-
-    return strcmp(va->name, vb->name);
-}
-
-
 static VARIABLE *FindVariable(const char *name)
 {
-    return bsearch(name, Variable, nVariable, sizeof(VARIABLE), LookupVariable);
+    unsigned int i;
+
+    for (i = 0; i < nVariable; i++) {
+	if (strcmp(name, Variable[i].name) == 0) {
+	    return &Variable[i];
+	}
+    }
+    return NULL;
 }
 
 
@@ -483,17 +420,19 @@
 
     V = FindVariable(name);
     if (V != NULL) {
-	FreeResult(V->value);
-	V->value = DupResult(value);
+	CopyResult(&V->value, value);
 	return 1;
     }
 
+    if (nVariable >= sizeof(Variable) / sizeof(Variable[0])) {
+	error("Evaluator: cannot set variable <%s>: out of slots", name);
+	return -1;
+    }
+
     nVariable++;
-    Variable = realloc(Variable, nVariable * sizeof(VARIABLE));
     Variable[nVariable - 1].name = strdup(name);
-    Variable[nVariable - 1].value = DupResult(value);
-
-    qsort(Variable, nVariable, sizeof(VARIABLE), SortVariable);
+    Variable[nVariable - 1].value = NULL;
+    CopyResult(&Variable[nVariable - 1].value, value);
 
     return 0;
 }
@@ -523,14 +462,12 @@
 
 void DeleteVariables(void)
 {
-    int i;
+    unsigned int i;
 
     for (i = 0; i < nVariable; i++) {
 	free(Variable[i].name);
 	FreeResult(Variable[i].value);
     }
-    free(Variable);
-    Variable = NULL;
     nVariable = 0;
 }
 
@@ -577,7 +514,7 @@
 
 void DeleteFunctions(void)
 {
-    int i;
+    unsigned int i;
 
     for (i = 0; i < nFunction; i++) {
 	free(Function[i].name);
@@ -615,6 +552,7 @@
 
     /* names */
     if (is_alpha(*ExprPtr)) {
+	int i;
 	char *start = ExprPtr;
 	while (is_alnum(*ExprPtr))
 	    ExprPtr++;
@@ -625,6 +563,16 @@
 	}
 	Word = strndup(start, ExprPtr - start);
 	Token = T_NAME;
+
+	/* check for alphanumeric operators */
+	for (i = sizeof(Pattern2) / sizeof(Pattern2[0]) - 1; i >= 0; i--) {
+	    if (strcmp(Word, Pattern2[i].pattern) == 0) {
+		Token = T_OPERATOR;
+		Operator = Pattern2[i].op;
+		break;
+	    }
+	}
+
     }
 
     /* numbers */
@@ -652,15 +600,15 @@
 	    ExprPtr++;
     }
 
-    /* operators */
+    /* non-alpha operators */
     else {
 	int i;
-	for (i = sizeof(Pattern) / sizeof(Pattern[0]) - 1; i >= 0; i--) {
-	    int len = Pattern[i].len;
-	    if (strncmp(ExprPtr, Pattern[i].pattern, Pattern[i].len) == 0) {
+	for (i = sizeof(Pattern1) / sizeof(Pattern1[0]) - 1; i >= 0; i--) {
+	    int len = Pattern1[i].len;
+	    if (strncmp(ExprPtr, Pattern1[i].pattern, Pattern1[i].len) == 0) {
 		Word = strndup(ExprPtr, len);
 		Token = T_OPERATOR;
-		Operator = Pattern[i].op;
+		Operator = Pattern1[i].op;
 		ExprPtr += len;
 		break;
 	    }
@@ -912,7 +860,8 @@
 
     Root = Level08();
 
-    while (Token == T_OPERATOR && (Operator == O_GT || Operator == O_GE || Operator == O_LT || Operator == O_LE)) {
+    while (Token == T_OPERATOR && (Operator == O_NGT || Operator == O_NGE || Operator == O_NLT || Operator == O_NLE ||
+				   Operator == O_SGT || Operator == O_SGE || Operator == O_SLT || Operator == O_SLE)) {
 	Root = NewNode(Root);
 	Parse();
 	LinkNode(Root, Level08());
@@ -929,7 +878,7 @@
 
     Root = Level07();
 
-    while (Token == T_OPERATOR && (Operator == O_EQ || Operator == O_NE)) {
+    while (Token == T_OPERATOR && (Operator == O_NEQ || Operator == O_NNE || Operator == O_SEQ || Operator == O_SNE)) {
 	Root = NewNode(Root);
 	Parse();
 	LinkNode(Root, Level07());
@@ -1052,10 +1001,6 @@
     char *s1, *s2;
     RESULT *param[10];
 
-    for (i = 0; i < Root->Children; i++) {
-	EvalTree(Root->Child[i]);
-    }
-
     switch (Root->Token) {
 
     case T_NUMBER:
@@ -1064,17 +1009,19 @@
 	return 0;
 
     case T_VARIABLE:
-	DelResult(Root->Result);
-	Root->Result = DupResult(Root->Variable->value);
+	CopyResult(&Root->Result, Root->Variable->value);
 	return 0;
 
     case T_FUNCTION:
 	DelResult(Root->Result);
 	/* prepare parameter list */
 	argc = Root->Children;
-	if (argc > 10)
+	if (argc > 10) {
+	    error("evaluator: more than 10 children (operands) not supported!");
 	    argc = 10;
+	}
 	for (i = 0; i < argc; i++) {
+	    EvalTree(Root->Child[i]);
 	    param[i] = Root->Child[i]->Result;
 	}
 	if (Root->Function->argc < 0) {
@@ -1082,7 +1029,8 @@
 	    /* pass number of arguments as first parameter */
 	    Root->Function->func(Root->Result, argc, &param);
 	} else {
-	    Root->Function->func(Root->Result, param[0], param[1], param[2], param[3], param[4], param[5], param[6], param[7], param[8], param[9]);
+	    Root->Function->func(Root->Result, param[0], param[1], param[2], param[3], param[4], param[5], param[6],
+				 param[7], param[8], param[9]);
 	}
 	return 0;
 
@@ -1090,22 +1038,26 @@
 	switch (Root->Operator) {
 
 	case O_LST:		/* expression list: result is last expression */
-	    i = Root->Children - 1;
+	    for (i = 0; i < Root->Children; i++) {
+		EvalTree(Root->Child[i]);
+	    }
 	    type = Root->Child[i]->Result->type;
 	    number = Root->Child[i]->Result->number;
 	    string = Root->Child[i]->Result->string;
 	    break;
 
 	case O_SET:		/* variable assignment */
-	    DelResult(Root->Variable->value);
-	    Root->Variable->value = DupResult(Root->Child[0]->Result);
+	    EvalTree(Root->Child[0]);
+	    CopyResult(&Root->Variable->value, Root->Child[0]->Result);
 	    type = Root->Child[0]->Result->type;
 	    number = Root->Child[0]->Result->number;
 	    string = Root->Child[0]->Result->string;
 	    break;
 
 	case O_CND:		/* conditional expression */
+	    EvalTree(Root->Child[0]);
 	    i = 1 + (R2N(Root->Child[0]->Result) == 0.0);
+	    EvalTree(Root->Child[i]);
 	    type = Root->Child[i]->Result->type;
 	    number = Root->Child[i]->Result->number;
 	    string = Root->Child[i]->Result->string;
@@ -1113,61 +1065,134 @@
 
 	case O_OR:		/* logical OR */
 	    type = R_NUMBER;
-	    number = ((R2N(Root->Child[0]->Result) != 0.0) || (R2N(Root->Child[1]->Result) != 0.0));
+	    EvalTree(Root->Child[0]);
+	    if (R2N(Root->Child[0]->Result) == 0.0) {
+		EvalTree(Root->Child[1]);
+		number = (R2N(Root->Child[1]->Result) != 0.0);
+	    } else {
+		number = 1.0;
+	    }
 	    break;
 
 	case O_AND:		/* logical AND */
 	    type = R_NUMBER;
-	    number = ((R2N(Root->Child[0]->Result) != 0.0) && (R2N(Root->Child[1]->Result) != 0.0));
+	    EvalTree(Root->Child[0]);
+	    if (R2N(Root->Child[0]->Result) != 0.0) {
+		EvalTree(Root->Child[1]);
+		number = (R2N(Root->Child[1]->Result) != 0.0);
+	    } else {
+		number = 0.0;
+	    }
 	    break;
 
-	case O_EQ:		/* numeric equal */
+	case O_NEQ:		/* numeric equal */
 	    type = R_NUMBER;
+	    EvalTree(Root->Child[0]);
+	    EvalTree(Root->Child[1]);
 	    number = (R2N(Root->Child[0]->Result) == R2N(Root->Child[1]->Result));
 	    break;
 
-	case O_NE:		/* numeric not equal */
+	case O_NNE:		/* numeric not equal */
 	    type = R_NUMBER;
+	    EvalTree(Root->Child[0]);
+	    EvalTree(Root->Child[1]);
 	    number = (R2N(Root->Child[0]->Result) != R2N(Root->Child[1]->Result));
 	    break;
 
-	case O_LT:		/* numeric less than */
+	case O_NLT:		/* numeric less than */
 	    type = R_NUMBER;
+	    EvalTree(Root->Child[0]);
+	    EvalTree(Root->Child[1]);
 	    number = (R2N(Root->Child[0]->Result) < R2N(Root->Child[1]->Result));
 	    break;
 
-	case O_LE:		/* numeric less equal */
+	case O_NLE:		/* numeric less equal */
 	    type = R_NUMBER;
+	    EvalTree(Root->Child[0]);
+	    EvalTree(Root->Child[1]);
 	    number = (R2N(Root->Child[0]->Result) <= R2N(Root->Child[1]->Result));
 	    break;
 
-	case O_GT:		/* numeric greater than */
+	case O_NGT:		/* numeric greater than */
 	    type = R_NUMBER;
+	    EvalTree(Root->Child[0]);
+	    EvalTree(Root->Child[1]);
 	    number = (R2N(Root->Child[0]->Result) > R2N(Root->Child[1]->Result));
 	    break;
 
-	case O_GE:		/* numeric greater equal */
+	case O_NGE:		/* numeric greater equal */
 	    type = R_NUMBER;
+	    EvalTree(Root->Child[0]);
+	    EvalTree(Root->Child[1]);
 	    number = (R2N(Root->Child[0]->Result) >= R2N(Root->Child[1]->Result));
 	    break;
 
+	case O_SEQ:		/* string equal */
+	    type = R_NUMBER;
+	    EvalTree(Root->Child[0]);
+	    EvalTree(Root->Child[1]);
+	    number = (strcmp(R2S(Root->Child[0]->Result), R2S(Root->Child[1]->Result)) == 0);
+	    break;
+
+	case O_SNE:		/* string not equal */
+	    type = R_NUMBER;
+	    EvalTree(Root->Child[0]);
+	    EvalTree(Root->Child[1]);
+	    number = (strcmp(R2S(Root->Child[0]->Result), R2S(Root->Child[1]->Result)) != 0);
+	    break;
+
+	case O_SLT:		/* string less than */
+	    type = R_NUMBER;
+	    EvalTree(Root->Child[0]);
+	    EvalTree(Root->Child[1]);
+	    number = (strcmp(R2S(Root->Child[0]->Result), R2S(Root->Child[1]->Result)) < 0);
+	    break;
+
+	case O_SLE:		/* string less equal */
+	    type = R_NUMBER;
+	    EvalTree(Root->Child[0]);
+	    EvalTree(Root->Child[1]);
+	    number = (strcmp(R2S(Root->Child[0]->Result), R2S(Root->Child[1]->Result)) <= 0);
+	    break;
+
+	case O_SGT:		/* string greater than */
+	    type = R_NUMBER;
+	    EvalTree(Root->Child[0]);
+	    EvalTree(Root->Child[1]);
+	    number = (strcmp(R2S(Root->Child[0]->Result), R2S(Root->Child[1]->Result)) > 0);
+	    break;
+
+	case O_SGE:		/* string greater equal */
+	    type = R_NUMBER;
+	    EvalTree(Root->Child[0]);
+	    EvalTree(Root->Child[1]);
+	    number = (strcmp(R2S(Root->Child[0]->Result), R2S(Root->Child[1]->Result)) >= 0);
+	    break;
+
 	case O_ADD:		/* addition */
 	    type = R_NUMBER;
+	    EvalTree(Root->Child[0]);
+	    EvalTree(Root->Child[1]);
 	    number = R2N(Root->Child[0]->Result) + R2N(Root->Child[1]->Result);
 	    break;
 
 	case O_SUB:		/* subtraction */
 	    type = R_NUMBER;
+	    EvalTree(Root->Child[0]);
+	    EvalTree(Root->Child[1]);
 	    number = R2N(Root->Child[0]->Result) - R2N(Root->Child[1]->Result);
 	    break;
 
 	case O_SGN:		/* sign */
 	    type = R_NUMBER;
+	    EvalTree(Root->Child[0]);
 	    number = -R2N(Root->Child[0]->Result);
 	    break;
 
 	case O_CAT:		/* string concatenation */
 	    type = R_STRING;
+	    EvalTree(Root->Child[0]);
+	    EvalTree(Root->Child[1]);
 	    s1 = R2S(Root->Child[0]->Result);
 	    s2 = R2S(Root->Child[1]->Result);
 	    string = malloc(strlen(s1) + strlen(s2) + 1);
@@ -1178,11 +1203,15 @@
 
 	case O_MUL:		/* multiplication */
 	    type = R_NUMBER;
+	    EvalTree(Root->Child[0]);
+	    EvalTree(Root->Child[1]);
 	    number = R2N(Root->Child[0]->Result) * R2N(Root->Child[1]->Result);
 	    break;
 
 	case O_DIV:		/* division */
 	    type = R_NUMBER;
+	    EvalTree(Root->Child[0]);
+	    EvalTree(Root->Child[1]);
 	    dummy = R2N(Root->Child[1]->Result);
 	    if (dummy == 0) {
 		error("Evaluator: warning: division by zero");
@@ -1194,6 +1223,8 @@
 
 	case O_MOD:		/* modulo */
 	    type = R_NUMBER;
+	    EvalTree(Root->Child[0]);
+	    EvalTree(Root->Child[1]);
 	    dummy = R2N(Root->Child[1]->Result);
 	    if (dummy == 0) {
 		error("Evaluator: warning: division by zero");
@@ -1205,11 +1236,14 @@
 
 	case O_POW:		/* x^y */
 	    type = R_NUMBER;
+	    EvalTree(Root->Child[0]);
+	    EvalTree(Root->Child[1]);
 	    number = pow(R2N(Root->Child[0]->Result), R2N(Root->Child[1]->Result));
 	    break;
 
 	case O_NOT:		/* logical NOT */
 	    type = R_NUMBER;
+	    EvalTree(Root->Child[0]);
 	    number = (R2N(Root->Child[0]->Result) == 0.0);
 	    break;
 
@@ -1294,13 +1328,13 @@
     ret = EvalTree(Tree);
 
     result->type = Tree->Result->type;
+    result->size = Tree->Result->size;
     result->number = Tree->Result->number;
-    result->length = Tree->Result->length;
-    if (result->length >= 0) {
-	result->string = malloc(result->length);
-	if (Tree->Result->string != NULL)
+    if (result->size > 0) {
+	result->string = malloc(result->size);
+	if (Tree->Result->string != NULL) {
 	    strcpy(result->string, Tree->Result->string);
-	else
+	} else
 	    result->string[0] = '\0';
     } else {
 	result->string = NULL;
diff -urN lcd4linux-0.10.0/evaluator.h lcd4linux-0.11.0-SVN/evaluator.h
--- lcd4linux-0.10.0/evaluator.h	2005-05-08 06:32:44.000000000 +0200
+++ lcd4linux-0.11.0-SVN/evaluator.h	2008-12-31 08:05:54.000000000 +0100
@@ -1,8 +1,9 @@
-/* $Id: evaluator.h,v 1.11 2005/05/08 04:32:44 reinelt Exp $
+/* $Id: evaluator.h 840 2007-09-09 12:17:42Z michael $
+ * $URL: https://ssl.bulix.org/svn/lcd4linux/trunk/evaluator.h $
  *
  * expression evaluation
  *
- * Copyright (C) 2003 Michael Reinelt <reinelt@eunet.at>
+ * Copyright (C) 2003 Michael Reinelt <michael@reinelt.co.at>
  * Copyright (C) 2004 The LCD4Linux Team <lcd4linux-devel@users.sourceforge.net>
  *
  * This file is part of LCD4Linux.
@@ -21,62 +22,6 @@
  * along with this program; if not, write to the Free Software
  * Foundation, Inc., 675 Mass Ave, Cambridge, MA 02139, USA.
  *
- *
- * $Log: evaluator.h,v $
- * Revision 1.11  2005/05/08 04:32:44  reinelt
- * CodingStyle added and applied
- *
- * Revision 1.10  2005/01/18 06:30:23  reinelt
- * added (C) to all copyright statements
- *
- * Revision 1.9  2004/06/26 12:04:59  reinelt
- *
- * uh-oh... the last CVS log message messed up things a lot...
- *
- * Revision 1.8  2004/06/26 09:27:21  reinelt
- *
- * added '-W' to CFLAGS
- * changed all C++ comments to C ones
- * cleaned up a lot of signed/unsigned mistakes
- *
- * Revision 1.7  2004/06/20 10:09:56  reinelt
- *
- * 'const'ified the whole source
- *
- * Revision 1.6  2004/03/11 06:39:59  reinelt
- * big patch from Martin:
- * - reuse filehandles
- * - memory leaks fixed
- * - earlier busy-flag checking with HD44780
- * - reuse memory for strings in RESULT and hash
- * - netdev_fast to wavid time-consuming regex
- *
- * Revision 1.5  2004/03/06 20:31:16  reinelt
- * Complete rewrite of the evaluator to get rid of the code
- * from mark Morley (because of license issues).
- * The new Evaluator does a pre-compile of expressions, and
- * stores them in trees. Therefore it should be reasonable faster...
- *
- * Revision 1.4  2004/03/03 03:47:04  reinelt
- * big patch from Martin Hejl:
- * - use qprintf() where appropriate
- * - save CPU cycles on gettimeofday()
- * - add quit() functions to free allocated memory
- * - fixed lots of memory leaks
- *
- * Revision 1.3  2004/01/12 03:51:01  reinelt
- * evaluating the 'Variables' section in the config file
- *
- * Revision 1.2  2003/10/11 06:01:53  reinelt
- *
- * renamed expression.{c,h} to client.{c,h}
- * added config file client
- * new functions 'AddNumericVariable()' and 'AddStringVariable()'
- * new parameter '-i' for interactive mode
- *
- * Revision 1.1  2003/10/06 04:34:06  reinelt
- * expression evaluator added
- *
  */
 
 
@@ -90,12 +35,11 @@
 
 typedef struct {
     int type;
+    int size;
     double number;
-    int length;
     char *string;
 } RESULT;
 
-
 int SetVariable(const char *name, RESULT * value);
 int SetVariableNumeric(const char *name, const double value);
 int SetVariableString(const char *name, const char *value);
@@ -107,6 +51,7 @@
 
 void DelResult(RESULT * result);
 RESULT *SetResult(RESULT ** result, const int type, const void *value);
+RESULT *CopyResult(RESULT ** result, RESULT * value);
 
 double R2N(RESULT * result);
 char *R2S(RESULT * result);
diff -urN lcd4linux-0.10.0/FAQ lcd4linux-0.11.0-SVN/FAQ
--- lcd4linux-0.10.0/FAQ	2000-03-22 08:33:50.000000000 +0100
+++ lcd4linux-0.11.0-SVN/FAQ	1970-01-01 01:00:00.000000000 +0100
@@ -1,10 +0,0 @@
-#
-# $Id: FAQ,v 1.1 2000/03/22 07:33:50 reinelt Exp $
-#
-
-lcd4linux Frequently Asked Questions
-
-Q: Where can I buy LCD's from Matrox Orbital in Germany or Austria?
-
-A: Germany: Elektronikladen (http://www.elektronikladen.de/seriallcd.html)
-   Austria: MEGATON (http://www.elektronikladen.de/ela-oesterreich.html)
\ Manca newline alla fine del file
diff -urN lcd4linux-0.10.0/font_6x8_bold.h lcd4linux-0.11.0-SVN/font_6x8_bold.h
--- lcd4linux-0.10.0/font_6x8_bold.h	1970-01-01 01:00:00.000000000 +0100
+++ lcd4linux-0.11.0-SVN/font_6x8_bold.h	2008-12-31 08:06:27.000000000 +0100
@@ -0,0 +1,902 @@
+/* $Id: font_6x8_bold.h 771 2007-02-25 12:27:26Z michael $
+ * $URL: https://ssl.bulix.org/svn/lcd4linux/trunk/font_6x8_bold.h $
+ *
+ * 6x8 bold font
+ *
+ * Copyright (C) 2006 Till Harbaum <till@harbaum.org>
+ * Copyright (C) 2006 The LCD4Linux Team <lcd4linux-devel@users.sourceforge.net>
+ *
+ * This file is part of LCD4Linux.
+ *
+ * LCD4Linux is free software; you can redistribute it and/or modify
+ * it under the terms of the GNU General Public License as published by
+ * the Free Software Foundation; either version 2, or (at your option)
+ * any later version.
+ *
+ * LCD4Linux is distributed in the hope that it will be useful,
+ * but WITHOUT ANY WARRANTY; without even the implied warranty of
+ * MERCHANTABILITY or FITNESS FOR A PARTICULAR PURPOSE.  See the
+ * GNU General Public License for more details.
+ *
+ * You should have received a copy of the GNU General Public License
+ * along with this program; if not, write to the Free Software
+ * Foundation, Inc., 675 Mass Ave, Cambridge, MA 02139, USA.
+ *
+ */
+
+#define ______ 0x00
+#define _____O 0x01
+#define ____O_ 0x02
+#define ____OO 0x03
+#define ___O__ 0x04
+#define ___O_O 0x05
+#define ___OO_ 0x06
+#define ___OOO 0x07
+#define __O___ 0x08
+#define __O__O 0x09
+#define __O_O_ 0x0a
+#define __O_OO 0x0b
+#define __OO__ 0x0c
+#define __OO_O 0x0d
+#define __OOO_ 0x0e
+#define __OOOO 0x0f
+#define _O____ 0x10
+#define _O___O 0x11
+#define _O__O_ 0x12
+#define _O__OO 0x13
+#define _O_O__ 0x14
+#define _O_O_O 0x15
+#define _O_OO_ 0x16
+#define _O_OOO 0x17
+#define _OO___ 0x18
+#define _OO__O 0x19
+#define _OO_O_ 0x1a
+#define _OO_OO 0x1b
+#define _OOO__ 0x1c
+#define _OOO_O 0x1d
+#define _OOOO_ 0x1e
+#define _OOOOO 0x1f
+#define O_____ 0x20
+#define O____O 0x21
+#define O___O_ 0x22
+#define O___OO 0x23
+#define O__O__ 0x24
+#define O__O_O 0x25
+#define O__OO_ 0x26
+#define O__OOO 0x27
+#define O_O___ 0x28
+#define O_O__O 0x29
+#define O_O_O_ 0x2a
+#define O_O_OO 0x2b
+#define O_OO__ 0x2c
+#define O_OO_O 0x2d
+#define O_OOO_ 0x2e
+#define O_OOOO 0x2f
+#define OO____ 0x30
+#define OO___O 0x31
+#define OO__O_ 0x32
+#define OO__OO 0x33
+#define OO_O__ 0x34
+#define OO_O_O 0x35
+#define OO_OO_ 0x36
+#define OO_OOO 0x37
+#define OOO___ 0x38
+#define OOO__O 0x39
+#define OOO_O_ 0x3a
+#define OOO_OO 0x3b
+#define OOOO__ 0x3c
+#define OOOO_O 0x3d
+#define OOOOO_ 0x3e
+#define OOOOOO 0x3f
+
+unsigned char Font_6x8_bold[256][8] = {
+    [0x20] = {______,
+	      ______,
+	      ______,
+	      ______,
+	      ______,
+	      ______,
+	      ______,
+	      ______},
+    [0x21] = {__OO__,
+	      __OO__,
+	      __OO__,
+	      __OO__,
+	      ______,
+	      ______,
+	      __OO__,
+	      ______},
+    [0x22] = {_OO_OO,
+	      _OO_OO,
+	      _OO_OO,
+	      ______,
+	      ______,
+	      ______,
+	      ______,
+	      ______},
+    [0x23] = {__O_O_,
+	      __O_O_,
+	      _OOOOO,
+	      __O_O_,
+	      _OOOOO,
+	      __O_O_,
+	      __O_O_,
+	      ______},
+    [0x24] = {___O__,
+	      __OOOO,
+	      _O_O__,
+	      __OOO_,
+	      ___O_O,
+	      _OOOO_,
+	      ___O__,
+	      ______},
+    [0x25] = {_OO___,
+	      _OO_OO,
+	      ___OO_,
+	      __OO__,
+	      _OO___,
+	      OO__OO,
+	      ____OO,
+	      ______},
+    [0x26] = {__OO__,
+	      _OO_OO,
+	      _OO_OO,
+	      __OO__,
+	      _OOO_O,
+	      _OO_OO,
+	      __OO_O,
+	      ______},
+    [0x27] = {__OO__,
+	      __OO__,
+	      _OO___,
+	      ______,
+	      ______,
+	      ______,
+	      ______,
+	      ______},
+    [0x28] = {___OO_,
+	      __OO__,
+	      _OO___,
+	      _OO___,
+	      _OO___,
+	      __OO__,
+	      ___OO_,
+	      ______},
+    [0x29] = {_OO___,
+	      __OO__,
+	      ___OO_,
+	      ___OO_,
+	      ___OO_,
+	      __OO__,
+	      _OO___,
+	      ______},
+    [0x2a] = {______,
+	      ___O__,
+	      _O_O_O,
+	      __OOO_,
+	      _O_O_O,
+	      ___O__,
+	      ______,
+	      ______},
+    [0x2b] = {______,
+	      __OO__,
+	      __OO__,
+	      _OOOO_,
+	      __OO__,
+	      __OO__,
+	      ______,
+	      ______},
+    [0x2c] = {______,
+	      ______,
+	      ______,
+	      ______,
+	      ___OO_,
+	      ___OO_,
+	      __OO__,
+	      ______},
+    [0x2d] = {______,
+	      ______,
+	      ______,
+	      _OOOOO,
+	      ______,
+	      ______,
+	      ______,
+	      ______},
+    [0x2e] = {______,
+	      ______,
+	      ______,
+	      ______,
+	      ______,
+	      __OO__,
+	      __OO__,
+	      ______},
+    [0x2f] = {______,
+	      ____OO,
+	      ___OO_,
+	      __OO__,
+	      _OO___,
+	      OO____,
+	      ______,
+	      ______},
+    [0x30] = {__OOO_,
+	      _OO_OO,
+	      _OO_OO,
+	      _OO_OO,
+	      _OO_OO,
+	      _OO_OO,
+	      __OOO_,
+	      ______},
+    [0x31] = {___OO_,
+	      __OOO_,
+	      ___OO_,
+	      ___OO_,
+	      ___OO_,
+	      ___OO_,
+	      __OOOO,
+	      ______},
+    [0x32] = {__OOO_,
+	      _OO_OO,
+	      ____OO,
+	      ___OO_,
+	      __OO__,
+	      _OO___,
+	      _OOOOO,
+	      ______},
+    [0x33] = {_OOOOO,
+	      ____OO,
+	      ___OO_,
+	      ____OO,
+	      ____OO,
+	      _OO_OO,
+	      __OOO_,
+	      ______},
+    [0x34] = {____OO,
+	      ___OO_,
+	      __OO__,
+	      _OO_OO,
+	      _OOOOO,
+	      ____OO,
+	      ____OO,
+	      ______},
+    [0x35] = {_OOOOO,
+	      _OO___,
+	      _OO___,
+	      _OOOO_,
+	      ____OO,
+	      _OO_OO,
+	      __OOO_,
+	      ______},
+    [0x36] = {___OO_,
+	      __OO__,
+	      _OO___,
+	      _OOOO_,
+	      _OO_OO,
+	      _OO_OO,
+	      __OOO_,
+	      ______},
+    [0x37] = {_OOOOO,
+	      ____OO,
+	      ___OO_,
+	      __OO__,
+	      __OO__,
+	      __OO__,
+	      __OO__,
+	      ______},
+    [0x38] = {__OOO_,
+	      _OO_OO,
+	      _OO_OO,
+	      __OOO_,
+	      _OO_OO,
+	      _OO_OO,
+	      __OOO_,
+	      ______},
+    [0x39] = {__OOO_,
+	      _OO_OO,
+	      _OO_OO,
+	      __OOOO,
+	      ____OO,
+	      ___OO_,
+	      _OOO__,
+	      ______},
+    [0x3a] = {______,
+	      __OO__,
+	      __OO__,
+	      ______,
+	      __OO__,
+	      __OO__,
+	      ______,
+	      ______},
+    [0x3b] = {______,
+	      __OO__,
+	      __OO__,
+	      ______,
+	      __OO__,
+	      __OO__,
+	      _OO___,
+	      ______},
+    [0x3c] = {____OO,
+	      ___OO_,
+	      __OO__,
+	      _OO___,
+	      __OO__,
+	      ___OO_,
+	      ____OO,
+	      ______},
+    [0x3d] = {______,
+	      ______,
+	      _OOOOO,
+	      ______,
+	      _OOOOO,
+	      ______,
+	      ______,
+	      ______},
+    [0x3e] = {_OO___,
+	      __OO__,
+	      ___OO_,
+	      ____OO,
+	      ___OO_,
+	      __OO__,
+	      _OO___,
+	      ______},
+    [0x3f] = {__OOO_,
+	      _OO_OO,
+	      ____OO,
+	      ___OO_,
+	      __OO__,
+	      ______,
+	      __OO__,
+	      ______},
+    [0x40] = {__OOO_,
+	      _OO_OO,
+	      ____OO,
+	      __O_OO,
+	      _OO_OO,
+	      _OO_OO,
+	      __OOO_,
+	      ______},
+    [0x41] = {__OOO_,
+	      _OO_OO,
+	      _OO_OO,
+	      _OO_OO,
+	      _OOOOO,
+	      _OO_OO,
+	      _OO_OO,
+	      ______},
+    [0x42] = {_OOOO_,
+	      _OO_OO,
+	      _OO_OO,
+	      _OOOO_,
+	      _OO_OO,
+	      _OO_OO,
+	      _OOOO_,
+	      ______},
+    [0x43] = {__OOO_,
+	      _OO_OO,
+	      _OO___,
+	      _OO___,
+	      _OO___,
+	      _OO_OO,
+	      __OOO_,
+	      ______},
+    [0x44] = {_OOO__,
+	      _OOOO_,
+	      _OO_OO,
+	      _OO_OO,
+	      _OO_OO,
+	      _OOOO_,
+	      _OOO__,
+	      ______},
+    [0x45] = {_OOOOO,
+	      _OO___,
+	      _OO___,
+	      _OOOO_,
+	      _OO___,
+	      _OO___,
+	      _OOOOO,
+	      ______},
+    [0x46] = {_OOOOO,
+	      _OO___,
+	      _OO___,
+	      _OOOO_,
+	      _OO___,
+	      _OO___,
+	      _OO___,
+	      ______},
+    [0x47] = {__OOO_,
+	      _OO_OO,
+	      _OO___,
+	      _OO_OO,
+	      _OO_OO,
+	      _OO_OO,
+	      __OOOO,
+	      ______},
+    [0x48] = {_OO_OO,
+	      _OO_OO,
+	      _OO_OO,
+	      _OOOOO,
+	      _OO_OO,
+	      _OO_OO,
+	      _OO_OO,
+	      ______},
+    [0x49] = {_OOOO_,
+	      __OO__,
+	      __OO__,
+	      __OO__,
+	      __OO__,
+	      __OO__,
+	      _OOOO_,
+	      ______},
+    [0x4a] = {___OOO,
+	      ____OO,
+	      ____OO,
+	      ____OO,
+	      ____OO,
+	      _OO_OO,
+	      __OOO_,
+	      ______},
+    [0x4b] = {_OO_OO,
+	      _OO_OO,
+	      _OOOO_,
+	      _OOO__,
+	      _OOOO_,
+	      _OO_OO,
+	      _OO_OO,
+	      ______},
+    [0x4c] = {_OO___,
+	      _OO___,
+	      _OO___,
+	      _OO___,
+	      _OO___,
+	      _OO___,
+	      _OOOOO,
+	      ______},
+    [0x4d] = {_O___O,
+	      _OO_OO,
+	      _OOOOO,
+	      _OOOOO,
+	      _OO_OO,
+	      _OO_OO,
+	      _OO_OO,
+	      ______},
+    [0x4e] = {_O__OO,
+	      _OO_OO,
+	      _OO_OO,
+	      _OOOOO,
+	      _OO_OO,
+	      _OO_OO,
+	      _OO__O,
+	      ______},
+    [0x4f] = {__OOO_,
+	      _OO_OO,
+	      _OO_OO,
+	      _OO_OO,
+	      _OO_OO,
+	      _OO_OO,
+	      __OOO_,
+	      ______},
+    [0x50] = {_OOOO_,
+	      _OO_OO,
+	      _OO_OO,
+	      _OOOO_,
+	      _OO___,
+	      _OO___,
+	      _OO___,
+	      ______},
+    [0x51] = {__OOO_,
+	      _OO_OO,
+	      _OO_OO,
+	      _OO_OO,
+	      _OO_O_,
+	      _OO_OO,
+	      __OO_O,
+	      ______},
+    [0x52] = {_OOOO_,
+	      _OO_OO,
+	      _OO_OO,
+	      _OOOO_,
+	      _OOOO_,
+	      _OO_OO,
+	      _OO_OO,
+	      ______},
+    [0x53] = {__OOOO,
+	      _OO___,
+	      _OO___,
+	      __OOO_,
+	      ____OO,
+	      ____OO,
+	      _OOOO_,
+	      ______},
+    [0x54] = {OOOOOO,
+	      __OO__,
+	      __OO__,
+	      __OO__,
+	      __OO__,
+	      __OO__,
+	      __OO__,
+	      ______},
+    [0x55] = {_OO_OO,
+	      _OO_OO,
+	      _OO_OO,
+	      _OO_OO,
+	      _OO_OO,
+	      _OO_OO,
+	      __OOO_,
+	      ______},
+    [0x56] = {_OO_OO,
+	      _OO_OO,
+	      _OO_OO,
+	      _OO_OO,
+	      _OO_OO,
+	      __OOO_,
+	      ___O__,
+	      ______},
+    [0x57] = {_OO_OO,
+	      _OO_OO,
+	      _OO_OO,
+	      _OOOOO,
+	      _OOOOO,
+	      _OO_OO,
+	      _O___O,
+	      ______},
+    [0x58] = {_OO_OO,
+	      _OO_OO,
+	      _OO_OO,
+	      __OOO_,
+	      _OO_OO,
+	      _OO_OO,
+	      _OO_OO,
+	      ______},
+    [0x59] = {_OO_OO,
+	      _OO_OO,
+	      _OO_OO,
+	      __O_OO,
+	      ___OOO,
+	      ___OO_,
+	      _OOO__,
+	      ______},
+    [0x5a] = {_OOOOO,
+	      ____OO,
+	      ___OO_,
+	      __OOO_,
+	      __OO__,
+	      _OO___,
+	      _OOOOO,
+	      ______},
+    [0x5b] = {_OOOO_,
+	      _OO___,
+	      _OO___,
+	      _OO___,
+	      _OO___,
+	      _OO___,
+	      _OOOO_,
+	      ______},
+    [0x5c] = {_O___O,
+	      __O_O_,
+	      _OOOOO,
+	      ___O__,
+	      _OOOOO,
+	      ___O__,
+	      ___O__,
+	      ______},
+    [0x5d] = {__OOOO,
+	      ____OO,
+	      ____OO,
+	      ____OO,
+	      ____OO,
+	      ____OO,
+	      __OOOO,
+	      ______},
+    [0x5e] = {___O__,
+	      __OOO_,
+	      _OO_OO,
+	      ______,
+	      ______,
+	      ______,
+	      ______,
+	      ______},
+    [0x5f] = {______,
+	      ______,
+	      ______,
+	      ______,
+	      ______,
+	      ______,
+	      _OOOOO,
+	      ______},
+    [0x60] = {_OO___,
+	      __OO__,
+	      ___OO_,
+	      ______,
+	      ______,
+	      ______,
+	      ______,
+	      ______},
+    [0x61] = {______,
+	      ______,
+	      __OOO_,
+	      ____OO,
+	      __OOOO,
+	      _OO_OO,
+	      __OOOO,
+	      ______},
+    [0x62] = {_OO___,
+	      _OO___,
+	      _OOOO_,
+	      _OO_OO,
+	      _OO_OO,
+	      _OO_OO,
+	      _OOOO_,
+	      ______},
+    [0x63] = {______,
+	      ______,
+	      __OOO_,
+	      _OO_OO,
+	      _OO___,
+	      _OO_OO,
+	      __OOO_,
+	      ______},
+    [0x64] = {____OO,
+	      ____OO,
+	      __OOOO,
+	      _OO_OO,
+	      _OO_OO,
+	      _OO_OO,
+	      __OOOO,
+	      ______},
+    [0x65] = {______,
+	      ______,
+	      __OOO_,
+	      _OO_OO,
+	      _OOOOO,
+	      _OO___,
+	      __OOO_,
+	      ______},
+    [0x66] = {___OOO,
+	      __OO__,
+	      __OO__,
+	      _OOOO_,
+	      __OO__,
+	      __OO__,
+	      __OO__,
+	      ______},
+    [0x67] = {______,
+	      ______,
+	      __OOOO,
+	      _OO_OO,
+	      _OO_OO,
+	      __OOOO,
+	      ____OO,
+	      __OOO_},
+    [0x68] = {_OO___,
+	      _OO___,
+	      _OOOO_,
+	      _OO_OO,
+	      _OO_OO,
+	      _OO_OO,
+	      _OO_OO,
+	      ______},
+    [0x69] = {__OO__,
+	      ______,
+	      _OOO__,
+	      __OO__,
+	      __OO__,
+	      __OO__,
+	      _OOOO_,
+	      ______},
+    [0x6a] = {____OO,
+	      ______,
+	      ___OOO,
+	      ____OO,
+	      ____OO,
+	      _OO_OO,
+	      __OOO_,
+	      ______},
+    [0x6b] = {_OO___,
+	      _OO___,
+	      _OO_OO,
+	      _OO_OO,
+	      _OOOO_,
+	      _OO_OO,
+	      _OO_OO,
+	      ______},
+    [0x6c] = {_OOO__,
+	      __OO__,
+	      __OO__,
+	      __OO__,
+	      __OO__,
+	      __OO__,
+	      _OOOO_,
+	      ______},
+    [0x6d] = {______,
+	      ______,
+	      _OO_O_,
+	      _OOOOO,
+	      _OOOOO,
+	      _OO_OO,
+	      _OO_OO,
+	      ______},
+    [0x6e] = {______,
+	      ______,
+	      _OOOO_,
+	      _OO_OO,
+	      _OO_OO,
+	      _OO_OO,
+	      _OO_OO,
+	      ______},
+    [0x6f] = {______,
+	      ______,
+	      __OOO_,
+	      _OO_OO,
+	      _OO_OO,
+	      _OO_OO,
+	      __OOO_,
+	      ______},
+    [0x70] = {______,
+	      ______,
+	      _OOOO_,
+	      _OO_OO,
+	      _OO_OO,
+	      _OOOO_,
+	      _OO___,
+	      _OO___},
+    [0x71] = {______,
+	      ______,
+	      __OOOO,
+	      _OO_OO,
+	      _OO_OO,
+	      __OOOO,
+	      ____OO,
+	      ____OO},
+    [0x72] = {______,
+	      ______,
+	      _OO_OO,
+	      _OOOO_,
+	      _OO___,
+	      _OO___,
+	      _OO___,
+	      ______},
+    [0x73] = {______,
+	      ______,
+	      __OOOO,
+	      _OO___,
+	      __OOO_,
+	      ____OO,
+	      _OOOO_,
+	      ______},
+    [0x74] = {__OO__,
+	      __OO__,
+	      _OOOO_,
+	      __OO__,
+	      __OO__,
+	      __OO__,
+	      ___OO_,
+	      ______},
+    [0x75] = {______,
+	      ______,
+	      _OO_OO,
+	      _OO_OO,
+	      _OO_OO,
+	      _OO_OO,
+	      __OOOO,
+	      ______},
+    [0x76] = {______,
+	      ______,
+	      _OO_OO,
+	      _OO_OO,
+	      _OO_OO,
+	      __OOO_,
+	      ___O__,
+	      ______},
+    [0x77] = {______,
+	      ______,
+	      _OO_OO,
+	      _OO_OO,
+	      _OOOOO,
+	      _OO_OO,
+	      _O___O,
+	      ______},
+    [0x78] = {______,
+	      ______,
+	      _OO_OO,
+	      _OO_OO,
+	      __OOO_,
+	      _OO_OO,
+	      _OO_OO,
+	      ______},
+    [0x79] = {______,
+	      ______,
+	      _OO_OO,
+	      _OO_OO,
+	      __OOOO,
+	      ____OO,
+	      __OOO_,
+	      ______},
+    [0x7a] = {______,
+	      ______,
+	      _OOOOO,
+	      ___OO_,
+	      __OO__,
+	      _OO___,
+	      _OOOOO,
+	      ______},
+    [0x7b] = {___OO_,
+	      __OO__,
+	      __OO__,
+	      _OO___,
+	      __OO__,
+	      __OO__,
+	      ___OO_,
+	      ______},
+    [0x7c] = {__OO__,
+	      __OO__,
+	      __OO__,
+	      __OO__,
+	      __OO__,
+	      __OO__,
+	      __OO__,
+	      ______},
+    [0x7d] = {__OO__,
+	      ___OO_,
+	      ___OO_,
+	      ____OO,
+	      ___OO_,
+	      ___OO_,
+	      __OO__,
+	      ______},
+    [0x7e] = {______,
+	      __OO__,
+	      ___OO_,
+	      _OOOOO,
+	      ___OO_,
+	      __OO__,
+	      ______,
+	      ______},
+
+    [0x7f] = {______,
+	      ___OO_,
+	      __OO__,
+	      _OOOOO,
+	      __OO__,
+	      ___OO_,
+	      ______,
+	      ______},
+    [0xb0] = {_OOOOO,
+	      _OO_OO,
+	      _OOOOO,
+	      ______,
+	      ______,
+	      ______,
+	      ______,
+	      ______},
+    [0xe1] = {_OO_OO,
+	      ______,
+	      __OOO_,
+	      ____OO,
+	      __OOOO,
+	      _OO_OO,
+	      __OOOO,
+	      ______},
+    [0xe2] = {__OOO_,
+	      _OO_OO,
+	      _OOOO_,
+	      _OO_OO,
+	      _OO_OO,
+	      _OOOO_,
+	      _OO___,
+	      ______},
+    [0xef] = {_OO_OO,
+	      ______,
+	      __OOO_,
+	      _OO_OO,
+	      _OO_OO,
+	      _OO_OO,
+	      __OOO_,
+	      ______},
+    [0xf5] = {_OO_OO,
+	      ______,
+	      _OO_OO,
+	      _OO_OO,
+	      _OO_OO,
+	      _OO_OO,
+	      __OOOO,
+	      ______},
+};
diff -urN lcd4linux-0.10.0/font_6x8.h lcd4linux-0.11.0-SVN/font_6x8.h
--- lcd4linux-0.10.0/font_6x8.h	2005-05-08 06:32:44.000000000 +0200
+++ lcd4linux-0.11.0-SVN/font_6x8.h	2008-12-31 08:05:54.000000000 +0100
@@ -1,8 +1,9 @@
-/* $Id: font_6x8.h,v 1.3 2005/05/08 04:32:44 reinelt Exp $
+/* $Id: font_6x8.h 840 2007-09-09 12:17:42Z michael $
+ * $URL: https://ssl.bulix.org/svn/lcd4linux/trunk/font_6x8.h $
  *
  * 6x8 font
  *
- * Copyright (C) 1999, 2000, 2004 Michael Reinelt <reinelt@eunet.at>
+ * Copyright (C) 1999, 2000, 2004 Michael Reinelt <michael@reinelt.co.at>
  * Copyright (C) 2004 The LCD4Linux Team <lcd4linux-devel@users.sourceforge.net>
  *
  * This file is part of LCD4Linux.
@@ -21,20 +22,6 @@
  * along with this program; if not, write to the Free Software
  * Foundation, Inc., 675 Mass Ave, Cambridge, MA 02139, USA.
  *
- *
- * $Log: font_6x8.h,v $
- * Revision 1.3  2005/05/08 04:32:44  reinelt
- * CodingStyle added and applied
- *
- * Revision 1.2  2005/01/18 06:30:23  reinelt
- * added (C) to all copyright statements
- *
- * Revision 1.1  2004/02/15 21:43:43  reinelt
- * T6963 driver nearly finished
- * framework for graphic displays done
- * i2c_sensors patch from Xavier
- * some more old generation files removed
- *
  */
 
 #define ______ 0x00
@@ -71,781 +58,813 @@
 #define _OOOOO 0x1f
 
 unsigned char Font_6x8[256][8] = {
-    [0x20] {______,
-	    ______,
-	    ______,
-	    ______,
-	    ______,
-	    ______,
-	    ______,
-	    ______},
-    [0x21] {___O__,
-	    ___O__,
-	    ___O__,
-	    ___O__,
-	    ______,
-	    ______,
-	    ___O__,
-	    ______},
-    [0x22] {__O_O_,
-	    __O_O_,
-	    __O_O_,
-	    ______,
-	    ______,
-	    ______,
-	    ______,
-	    ______},
-    [0x23] {__O_O_,
-	    __O_O_,
-	    _OOOOO,
-	    __O_O_,
-	    _OOOOO,
-	    __O_O_,
-	    __O_O_,
-	    ______},
-    [0x24] {___O__,
-	    __OOOO,
-	    _O_O__,
-	    __OOO_,
-	    ___O_O,
-	    _OOOO_,
-	    ___O__,
-	    ______},
-    [0x25] {_OO___,
-	    _OO__O,
-	    ____O_,
-	    ___O__,
-	    __O___,
-	    _O__OO,
-	    ____OO,
-	    ______},
-    [0x26] {__OO__,
-	    _O__O_,
-	    _O_O__,
-	    __O___,
-	    _O_O_O,
-	    _O__O_,
-	    __OO_O,
-	    ______},
-    [0x27] {__OO__,
-	    ___O__,
-	    __O___,
-	    ______,
-	    ______,
-	    ______,
-	    ______,
-	    ______},
-    [0x28] {____O_,
-	    ___O__,
-	    __O___,
-	    __O___,
-	    __O___,
-	    ___O__,
-	    ____O_,
-	    ______},
-    [0x29] {__O___,
-	    ___O__,
-	    ____O_,
-	    ____O_,
-	    ____O_,
-	    ___O__,
-	    __O___,
-	    ______},
-    [0x2a] {______,
-	    ___O__,
-	    _O_O_O,
-	    __OOO_,
-	    _O_O_O,
-	    ___O__,
-	    ______,
-	    ______},
-    [0x2b] {______,
-	    ___O__,
-	    ___O__,
-	    _OOOOO,
-	    ___O__,
-	    ___O__,
-	    ______,
-	    ______},
-    [0x2c] {______,
-	    ______,
-	    ______,
-	    ______,
-	    __OO__,
-	    ___O__,
-	    __O___,
-	    ______},
-    [0x2d] {______,
-	    ______,
-	    ______,
-	    _OOOOO,
-	    ______,
-	    ______,
-	    ______,
-	    ______},
-    [0x2e] {______,
-	    ______,
-	    ______,
-	    ______,
-	    ______,
-	    __OO__,
-	    __OO__,
-	    ______},
-    [0x2f] {______,
-	    _____O,
-	    ____O_,
-	    ___O__,
-	    __O___,
-	    _O____,
-	    ______,
-	    ______},
-    [0x30] {__OOO_,
-	    _O___O,
-	    _O__OO,
-	    _O_O_O,
-	    _OO__O,
-	    _O___O,
-	    __OOO_,
-	    ______},
-    [0x31] {___O__,
-	    __OO__,
-	    ___O__,
-	    ___O__,
-	    ___O__,
-	    ___O__,
-	    __OOO_,
-	    ______},
-    [0x32] {__OOO_,
-	    _O___O,
-	    _____O,
-	    ____O_,
-	    ___O__,
-	    __O___,
-	    _OOOOO,
-	    ______},
-    [0x33] {_OOOOO,
-	    ____O_,
-	    ___O__,
-	    ____O_,
-	    _____O,
-	    _O___O,
-	    __OOO_,
-	    ______},
-    [0x34] {____O_,
-	    ___OO_,
-	    __O_O_,
-	    _O__O_,
-	    _OOOOO,
-	    ____O_,
-	    ____O_,
-	    ______},
-    [0x35] {_OOOOO,
-	    _O____,
-	    _O____,
-	    _OOOO_,
-	    _____O,
-	    _O___O,
-	    __OOO_,
-	    ______},
-    [0x36] {___OO_,
-	    __O___,
-	    _O____,
-	    _OOOO_,
-	    _O___O,
-	    _O___O,
-	    __OOO_,
-	    ______},
-    [0x37] {_OOOOO,
-	    _____O,
-	    ____O_,
-	    ___O__,
-	    __O___,
-	    __O___,
-	    __O___,
-	    ______},
-    [0x38] {__OOO_,
-	    _O___O,
-	    _O___O,
-	    __OOO_,
-	    _O___O,
-	    _O___O,
-	    __OOO_,
-	    ______},
-    [0x39] {__OOO_,
-	    _O___O,
-	    _O___O,
-	    __OOOO,
-	    _____O,
-	    ____O_,
-	    __OO__,
-	    ______},
-    [0x3a] {______,
-	    __OO__,
-	    __OO__,
-	    ______,
-	    __OO__,
-	    __OO__,
-	    ______,
-	    ______},
-    [0x3b] {______,
-	    __OO__,
-	    __OO__,
-	    ______,
-	    __OO__,
-	    ___O__,
-	    __O___,
-	    ______},
-    [0x3c] {____O_,
-	    ___O__,
-	    __O___,
-	    _O____,
-	    __O___,
-	    ___O__,
-	    ____O_,
-	    ______},
-    [0x3d] {______,
-	    ______,
-	    _OOOOO,
-	    ______,
-	    _OOOOO,
-	    ______,
-	    ______,
-	    ______},
-    [0x3e] {_O____,
-	    __O___,
-	    ___O__,
-	    ____O_,
-	    ___O__,
-	    __O___,
-	    _O____,
-	    ______},
-    [0x3f] {__OOO_,
-	    _O___O,
-	    _____O,
-	    ____O_,
-	    ___O__,
-	    ______,
-	    ___O__,
-	    ______},
-    [0x40] {__OOO_,
-	    _O___O,
-	    _____O,
-	    __OO_O,
-	    _O_O_O,
-	    _O_O_O,
-	    __OOO_,
-	    ______},
-    [0x41] {__OOO_,
-	    _O___O,
-	    _O___O,
-	    _O___O,
-	    _OOOOO,
-	    _O___O,
-	    _O___O,
-	    ______},
-    [0x42] {_OOOO_,
-	    _O___O,
-	    _O___O,
-	    _OOOO_,
-	    _O___O,
-	    _O___O,
-	    _OOOO_,
-	    ______},
-    [0x43] {__OOO_,
-	    _O___O,
-	    _O____,
-	    _O____,
-	    _O____,
-	    _O___O,
-	    __OOO_,
-	    ______},
-    [0x44] {_OOO__,
-	    _O__O_,
-	    _O___O,
-	    _O___O,
-	    _O___O,
-	    _O__O_,
-	    _OOO__,
-	    ______},
-    [0x45] {_OOOOO,
-	    _O____,
-	    _O____,
-	    _OOOO_,
-	    _O____,
-	    _O____,
-	    _OOOOO,
-	    ______},
-    [0x46] {_OOOOO,
-	    _O____,
-	    _O____,
-	    _OOOO_,
-	    _O____,
-	    _O____,
-	    _O____,
-	    ______},
-    [0x47] {__OOO_,
-	    _O___O,
-	    _O____,
-	    _O_OOO,
-	    _O___O,
-	    _O___O,
-	    __OOOO,
-	    ______},
-    [0x48] {_O___O,
-	    _O___O,
-	    _O___O,
-	    _OOOOO,
-	    _O___O,
-	    _O___O,
-	    _O___O,
-	    ______},
-    [0x49] {__OOO_,
-	    ___O__,
-	    ___O__,
-	    ___O__,
-	    ___O__,
-	    ___O__,
-	    __OOO_,
-	    ______},
-    [0x4a] {___OOO,
-	    ____O_,
-	    ____O_,
-	    ____O_,
-	    ____O_,
-	    _O__O_,
-	    __OO__,
-	    ______},
-    [0x4b] {_O___O,
-	    _O__O_,
-	    _O_O__,
-	    _OO___,
-	    _O_O__,
-	    _O__O_,
-	    _O___O,
-	    ______},
-    [0x4c] {_O____,
-	    _O____,
-	    _O____,
-	    _O____,
-	    _O____,
-	    _O____,
-	    _OOOOO,
-	    ______},
-    [0x4d] {_O___O,
-	    _OO_OO,
-	    _O_O_O,
-	    _O_O_O,
-	    _O___O,
-	    _O___O,
-	    _O___O,
-	    ______},
-    [0x4e] {_O___O,
-	    _O___O,
-	    _OO__O,
-	    _O_O_O,
-	    _O__OO,
-	    _O___O,
-	    _O___O,
-	    ______},
-    [0x4f] {__OOO_,
-	    _O___O,
-	    _O___O,
-	    _O___O,
-	    _O___O,
-	    _O___O,
-	    __OOO_,
-	    ______},
-    [0x50] {_OOOO_,
-	    _O___O,
-	    _O___O,
-	    _OOOO_,
-	    _O____,
-	    _O____,
-	    _O____,
-	    ______},
-    [0x51] {__OOO_,
-	    _O___O,
-	    _O___O,
-	    _O___O,
-	    _O_O_O,
-	    _O__O_,
-	    __OO_O,
-	    ______},
-    [0x52] {_OOOO_,
-	    _O___O,
-	    _O___O,
-	    _OOOO_,
-	    _O_O__,
-	    _O__O_,
-	    _O___O,
-	    ______},
-    [0x53] {__OOOO,
-	    _O____,
-	    _O____,
-	    __OOO_,
-	    _____O,
-	    _____O,
-	    _OOOO_,
-	    ______},
-    [0x54] {_OOOOO,
-	    ___O__,
-	    ___O__,
-	    ___O__,
-	    ___O__,
-	    ___O__,
-	    ___O__,
-	    ______},
-    [0x55] {_O___O,
-	    _O___O,
-	    _O___O,
-	    _O___O,
-	    _O___O,
-	    _O___O,
-	    __OOO_,
-	    ______},
-    [0x56] {_O___O,
-	    _O___O,
-	    _O___O,
-	    _O___O,
-	    _O___O,
-	    __O_O_,
-	    ___O__,
-	    ______},
-    [0x57] {_O___O,
-	    _O___O,
-	    _O___O,
-	    _O_O_O,
-	    _O_O_O,
-	    _O_O_O,
-	    __O_O_,
-	    ______},
-    [0x58] {_O___O,
-	    _O___O,
-	    __O_O_,
-	    ___O__,
-	    __O_O_,
-	    _O___O,
-	    _O___O,
-	    ______},
-    [0x59] {_O___O,
-	    _O___O,
-	    _O___O,
-	    __O_O_,
-	    ___O__,
-	    ___O__,
-	    ___O__,
-	    ______},
-    [0x5a] {_OOOOO,
-	    _____O,
-	    ____O_,
-	    ___O__,
-	    __O___,
-	    _O____,
-	    _OOOOO,
-	    ______},
-    [0x5b] {__OOO_,
-	    __O___,
-	    __O___,
-	    __O___,
-	    __O___,
-	    __O___,
-	    __OOO_,
-	    ______},
-    [0x5c] {_O___O,
-	    __O_O_,
-	    _OOOOO,
-	    ___O__,
-	    _OOOOO,
-	    ___O__,
-	    ___O__,
-	    ______},
-    [0x5d] {__OOO_,
-	    ____O_,
-	    ____O_,
-	    ____O_,
-	    ____O_,
-	    ____O_,
-	    __OOO_,
-	    ______},
-    [0x5e] {___O__,
-	    __O_O_,
-	    _O___O,
-	    ______,
-	    ______,
-	    ______,
-	    ______,
-	    ______},
-    [0x5f] {______,
-	    ______,
-	    ______,
-	    ______,
-	    ______,
-	    ______,
-	    _OOOOO,
-	    ______},
-    [0x60] {__O___,
-	    ___O__,
-	    ____O_,
-	    ______,
-	    ______,
-	    ______,
-	    ______,
-	    ______},
-    [0x61] {______,
-	    ______,
-	    __OOO_,
-	    _____O,
-	    __OOOO,
-	    _O___O,
-	    __OOOO,
-	    ______},
-    [0x62] {_O____,
-	    _O____,
-	    _O____,
-	    _O_OO_,
-	    _OO__O,
-	    _O___O,
-	    _OOOO_,
-	    ______},
-    [0x63] {______,
-	    ______,
-	    __OOO_,
-	    _O____,
-	    _O____,
-	    _O___O,
-	    __OOO_,
-	    ______},
-    [0x64] {_____O,
-	    _____O,
-	    _____O,
-	    __OO_O,
-	    _O__OO,
-	    _O___O,
-	    __OOOO,
-	    ______},
-    [0x65] {______,
-	    ______,
-	    __OOO_,
-	    _O___O,
-	    _OOOOO,
-	    _O____,
-	    __OOO_,
-	    ______},
-    [0x66] {___OO_,
-	    __O__O,
-	    __O___,
-	    _OOO__,
-	    __O___,
-	    __O___,
-	    __O___,
-	    ______},
-    [0x67] {______,
-	    __OOOO,
-	    _O___O,
-	    _O___O,
-	    __OOOO,
-	    _____O,
-	    __OOO_,
-	    ______},
-    [0x68] {_O____,
-	    _O____,
-	    _O_OO_,
-	    _OO__O,
-	    _O___O,
-	    _O___O,
-	    _O___O,
-	    ______},
-    [0x69] {___O__,
-	    ______,
-	    __OO__,
-	    ___O__,
-	    ___O__,
-	    ___O__,
-	    __OOO_,
-	    ______},
-    [0x6a] {____O_,
-	    ______,
-	    ___OO_,
-	    ____O_,
-	    ____O_,
-	    _O__O_,
-	    __OO__,
-	    ______},
-    [0x6b] {__O___,
-	    __O___,
-	    __O__O,
-	    __O_O_,
-	    __OO__,
-	    __O_O_,
-	    __O__O,
-	    ______},
-    [0x6c] {__OO__,
-	    ___O__,
-	    ___O__,
-	    ___O__,
-	    ___O__,
-	    ___O__,
-	    __OOO_,
-	    ______},
-    [0x6d] {______,
-	    ______,
-	    _OO_O_,
-	    _O_O_O,
-	    _O_O_O,
-	    _O___O,
-	    _O___O,
-	    ______},
-    [0x6e] {______,
-	    ______,
-	    _OOOO_,
-	    _O___O,
-	    _O___O,
-	    _O___O,
-	    _O___O,
-	    ______},
-    [0x6f] {______,
-	    ______,
-	    __OOO_,
-	    _O___O,
-	    _O___O,
-	    _O___O,
-	    __OOO_,
-	    ______},
-    [0x70] {______,
-	    ______,
-	    _OOOO_,
-	    _O___O,
-	    _OOOO_,
-	    _O____,
-	    _O____,
-	    ______},
-    [0x71] {______,
-	    ______,
-	    __OO_O,
-	    _O__OO,
-	    __OOOO,
-	    _____O,
-	    _____O,
-	    ______},
-    [0x72] {______,
-	    ______,
-	    _O_OO_,
-	    _OO__O,
-	    _O____,
-	    _O____,
-	    _O____,
-	    ______},
-    [0x73] {______,
-	    ______,
-	    __OOO_,
-	    _O____,
-	    __OOO_,
-	    _____O,
-	    _OOOO_,
-	    ______},
-    [0x74] {__O___,
-	    _OOO__,
-	    __O___,
-	    __O___,
-	    __O___,
-	    __O__O,
-	    ___OO_,
-	    ______},
-    [0x75] {______,
-	    ______,
-	    _O___O,
-	    _O___O,
-	    _O___O,
-	    _O__OO,
-	    __OO_O,
-	    ______},
-    [0x76] {______,
-	    ______,
-	    _O___O,
-	    _O___O,
-	    _O___O,
-	    __O_O_,
-	    ___O__,
-	    ______},
-    [0x77] {______,
-	    ______,
-	    _O___O,
-	    _O___O,
-	    _O___O,
-	    _O_O_O,
-	    __O_O_,
-	    ______},
-    [0x78] {______,
-	    ______,
-	    _O___O,
-	    __O_O_,
-	    ___O__,
-	    __O_O_,
-	    _O___O,
-	    ______},
-    [0x79] {______,
-	    ______,
-	    _O___O,
-	    _O___O,
-	    __OOOO,
-	    _____O,
-	    __OOO_,
-	    ______},
-    [0x7a] {______,
-	    ______,
-	    _OOOOO,
-	    ____O_,
-	    ___O__,
-	    __O___,
-	    _OOOOO,
-	    ______},
-    [0x7b] {____O_,
-	    ___O__,
-	    ___O__,
-	    __O___,
-	    ___O__,
-	    ___O__,
-	    ____O_,
-	    ______},
-    [0x7c] {___O__,
-	    ___O__,
-	    ___O__,
-	    ___O__,
-	    ___O__,
-	    ___O__,
-	    ___O__,
-	    ______},
-    [0x7d] {__O___,
-	    ___O__,
-	    ___O__,
-	    ____O_,
-	    ___O__,
-	    ___O__,
-	    __O___,
-	    ______},
-    [0x7e] {______,
-	    ___O__,
-	    ____O_,
-	    _OOOOO,
-	    ____O_,
-	    ___O__,
-	    ______,
-	    ______},
+    [0x20] = {______,
+	      ______,
+	      ______,
+	      ______,
+	      ______,
+	      ______,
+	      ______,
+	      ______},
+    [0x21] = {___O__,
+	      ___O__,
+	      ___O__,
+	      ___O__,
+	      ______,
+	      ______,
+	      ___O__,
+	      ______},
+    [0x22] = {__O_O_,
+	      __O_O_,
+	      __O_O_,
+	      ______,
+	      ______,
+	      ______,
+	      ______,
+	      ______},
+    [0x23] = {__O_O_,
+	      __O_O_,
+	      _OOOOO,
+	      __O_O_,
+	      _OOOOO,
+	      __O_O_,
+	      __O_O_,
+	      ______},
+    [0x24] = {___O__,
+	      __OOOO,
+	      _O_O__,
+	      __OOO_,
+	      ___O_O,
+	      _OOOO_,
+	      ___O__,
+	      ______},
+    [0x25] = {_OO___,
+	      _OO__O,
+	      ____O_,
+	      ___O__,
+	      __O___,
+	      _O__OO,
+	      ____OO,
+	      ______},
+    [0x26] = {__OO__,
+	      _O__O_,
+	      _O_O__,
+	      __O___,
+	      _O_O_O,
+	      _O__O_,
+	      __OO_O,
+	      ______},
+    [0x27] = {__OO__,
+	      ___O__,
+	      __O___,
+	      ______,
+	      ______,
+	      ______,
+	      ______,
+	      ______},
+    [0x28] = {____O_,
+	      ___O__,
+	      __O___,
+	      __O___,
+	      __O___,
+	      ___O__,
+	      ____O_,
+	      ______},
+    [0x29] = {__O___,
+	      ___O__,
+	      ____O_,
+	      ____O_,
+	      ____O_,
+	      ___O__,
+	      __O___,
+	      ______},
+    [0x2a] = {______,
+	      ___O__,
+	      _O_O_O,
+	      __OOO_,
+	      _O_O_O,
+	      ___O__,
+	      ______,
+	      ______},
+    [0x2b] = {______,
+	      ___O__,
+	      ___O__,
+	      _OOOOO,
+	      ___O__,
+	      ___O__,
+	      ______,
+	      ______},
+    [0x2c] = {______,
+	      ______,
+	      ______,
+	      ______,
+	      __OO__,
+	      ___O__,
+	      __O___,
+	      ______},
+    [0x2d] = {______,
+	      ______,
+	      ______,
+	      _OOOOO,
+	      ______,
+	      ______,
+	      ______,
+	      ______},
+    [0x2e] = {______,
+	      ______,
+	      ______,
+	      ______,
+	      ______,
+	      __OO__,
+	      __OO__,
+	      ______},
+    [0x2f] = {______,
+	      _____O,
+	      ____O_,
+	      ___O__,
+	      __O___,
+	      _O____,
+	      ______,
+	      ______},
+    [0x30] = {__OOO_,
+	      _O___O,
+	      _O__OO,
+	      _O_O_O,
+	      _OO__O,
+	      _O___O,
+	      __OOO_,
+	      ______},
+    [0x31] = {___O__,
+	      __OO__,
+	      ___O__,
+	      ___O__,
+	      ___O__,
+	      ___O__,
+	      __OOO_,
+	      ______},
+    [0x32] = {__OOO_,
+	      _O___O,
+	      _____O,
+	      ____O_,
+	      ___O__,
+	      __O___,
+	      _OOOOO,
+	      ______},
+    [0x33] = {_OOOOO,
+	      ____O_,
+	      ___O__,
+	      ____O_,
+	      _____O,
+	      _O___O,
+	      __OOO_,
+	      ______},
+    [0x34] = {____O_,
+	      ___OO_,
+	      __O_O_,
+	      _O__O_,
+	      _OOOOO,
+	      ____O_,
+	      ____O_,
+	      ______},
+    [0x35] = {_OOOOO,
+	      _O____,
+	      _O____,
+	      _OOOO_,
+	      _____O,
+	      _O___O,
+	      __OOO_,
+	      ______},
+    [0x36] = {___OO_,
+	      __O___,
+	      _O____,
+	      _OOOO_,
+	      _O___O,
+	      _O___O,
+	      __OOO_,
+	      ______},
+    [0x37] = {_OOOOO,
+	      _____O,
+	      ____O_,
+	      ___O__,
+	      __O___,
+	      __O___,
+	      __O___,
+	      ______},
+    [0x38] = {__OOO_,
+	      _O___O,
+	      _O___O,
+	      __OOO_,
+	      _O___O,
+	      _O___O,
+	      __OOO_,
+	      ______},
+    [0x39] = {__OOO_,
+	      _O___O,
+	      _O___O,
+	      __OOOO,
+	      _____O,
+	      ____O_,
+	      __OO__,
+	      ______},
+    [0x3a] = {______,
+	      __OO__,
+	      __OO__,
+	      ______,
+	      __OO__,
+	      __OO__,
+	      ______,
+	      ______},
+    [0x3b] = {______,
+	      __OO__,
+	      __OO__,
+	      ______,
+	      __OO__,
+	      ___O__,
+	      __O___,
+	      ______},
+    [0x3c] = {____O_,
+	      ___O__,
+	      __O___,
+	      _O____,
+	      __O___,
+	      ___O__,
+	      ____O_,
+	      ______},
+    [0x3d] = {______,
+	      ______,
+	      _OOOOO,
+	      ______,
+	      _OOOOO,
+	      ______,
+	      ______,
+	      ______},
+    [0x3e] = {_O____,
+	      __O___,
+	      ___O__,
+	      ____O_,
+	      ___O__,
+	      __O___,
+	      _O____,
+	      ______},
+    [0x3f] = {__OOO_,
+	      _O___O,
+	      _____O,
+	      ____O_,
+	      ___O__,
+	      ______,
+	      ___O__,
+	      ______},
+    [0x40] = {__OOO_,
+	      _O___O,
+	      _____O,
+	      __OO_O,
+	      _O_O_O,
+	      _O_O_O,
+	      __OOO_,
+	      ______},
+    [0x41] = {__OOO_,
+	      _O___O,
+	      _O___O,
+	      _O___O,
+	      _OOOOO,
+	      _O___O,
+	      _O___O,
+	      ______},
+    [0x42] = {_OOOO_,
+	      _O___O,
+	      _O___O,
+	      _OOOO_,
+	      _O___O,
+	      _O___O,
+	      _OOOO_,
+	      ______},
+    [0x43] = {__OOO_,
+	      _O___O,
+	      _O____,
+	      _O____,
+	      _O____,
+	      _O___O,
+	      __OOO_,
+	      ______},
+    [0x44] = {_OOO__,
+	      _O__O_,
+	      _O___O,
+	      _O___O,
+	      _O___O,
+	      _O__O_,
+	      _OOO__,
+	      ______},
+    [0x45] = {_OOOOO,
+	      _O____,
+	      _O____,
+	      _OOOO_,
+	      _O____,
+	      _O____,
+	      _OOOOO,
+	      ______},
+    [0x46] = {_OOOOO,
+	      _O____,
+	      _O____,
+	      _OOOO_,
+	      _O____,
+	      _O____,
+	      _O____,
+	      ______},
+    [0x47] = {__OOO_,
+	      _O___O,
+	      _O____,
+	      _O_OOO,
+	      _O___O,
+	      _O___O,
+	      __OOOO,
+	      ______},
+    [0x48] = {_O___O,
+	      _O___O,
+	      _O___O,
+	      _OOOOO,
+	      _O___O,
+	      _O___O,
+	      _O___O,
+	      ______},
+    [0x49] = {__OOO_,
+	      ___O__,
+	      ___O__,
+	      ___O__,
+	      ___O__,
+	      ___O__,
+	      __OOO_,
+	      ______},
+    [0x4a] = {___OOO,
+	      ____O_,
+	      ____O_,
+	      ____O_,
+	      ____O_,
+	      _O__O_,
+	      __OO__,
+	      ______},
+    [0x4b] = {_O___O,
+	      _O__O_,
+	      _O_O__,
+	      _OO___,
+	      _O_O__,
+	      _O__O_,
+	      _O___O,
+	      ______},
+    [0x4c] = {_O____,
+	      _O____,
+	      _O____,
+	      _O____,
+	      _O____,
+	      _O____,
+	      _OOOOO,
+	      ______},
+    [0x4d] = {_O___O,
+	      _OO_OO,
+	      _O_O_O,
+	      _O_O_O,
+	      _O___O,
+	      _O___O,
+	      _O___O,
+	      ______},
+    [0x4e] = {_O___O,
+	      _O___O,
+	      _OO__O,
+	      _O_O_O,
+	      _O__OO,
+	      _O___O,
+	      _O___O,
+	      ______},
+    [0x4f] = {__OOO_,
+	      _O___O,
+	      _O___O,
+	      _O___O,
+	      _O___O,
+	      _O___O,
+	      __OOO_,
+	      ______},
+    [0x50] = {_OOOO_,
+	      _O___O,
+	      _O___O,
+	      _OOOO_,
+	      _O____,
+	      _O____,
+	      _O____,
+	      ______},
+    [0x51] = {__OOO_,
+	      _O___O,
+	      _O___O,
+	      _O___O,
+	      _O_O_O,
+	      _O__O_,
+	      __OO_O,
+	      ______},
+    [0x52] = {_OOOO_,
+	      _O___O,
+	      _O___O,
+	      _OOOO_,
+	      _O_O__,
+	      _O__O_,
+	      _O___O,
+	      ______},
+    [0x53] = {__OOOO,
+	      _O____,
+	      _O____,
+	      __OOO_,
+	      _____O,
+	      _____O,
+	      _OOOO_,
+	      ______},
+    [0x54] = {_OOOOO,
+	      ___O__,
+	      ___O__,
+	      ___O__,
+	      ___O__,
+	      ___O__,
+	      ___O__,
+	      ______},
+    [0x55] = {_O___O,
+	      _O___O,
+	      _O___O,
+	      _O___O,
+	      _O___O,
+	      _O___O,
+	      __OOO_,
+	      ______},
+    [0x56] = {_O___O,
+	      _O___O,
+	      _O___O,
+	      _O___O,
+	      _O___O,
+	      __O_O_,
+	      ___O__,
+	      ______},
+    [0x57] = {_O___O,
+	      _O___O,
+	      _O___O,
+	      _O_O_O,
+	      _O_O_O,
+	      _O_O_O,
+	      __O_O_,
+	      ______},
+    [0x58] = {_O___O,
+	      _O___O,
+	      __O_O_,
+	      ___O__,
+	      __O_O_,
+	      _O___O,
+	      _O___O,
+	      ______},
+    [0x59] = {_O___O,
+	      _O___O,
+	      _O___O,
+	      __O_O_,
+	      ___O__,
+	      ___O__,
+	      ___O__,
+	      ______},
+    [0x5a] = {_OOOOO,
+	      _____O,
+	      ____O_,
+	      ___O__,
+	      __O___,
+	      _O____,
+	      _OOOOO,
+	      ______},
+    [0x5b] = {__OOO_,
+	      __O___,
+	      __O___,
+	      __O___,
+	      __O___,
+	      __O___,
+	      __OOO_,
+	      ______},
+    [0x5c] = {_O___O,
+	      __O_O_,
+	      _OOOOO,
+	      ___O__,
+	      _OOOOO,
+	      ___O__,
+	      ___O__,
+	      ______},
+    [0x5d] = {__OOO_,
+	      ____O_,
+	      ____O_,
+	      ____O_,
+	      ____O_,
+	      ____O_,
+	      __OOO_,
+	      ______},
+    [0x5e] = {___O__,
+	      __O_O_,
+	      _O___O,
+	      ______,
+	      ______,
+	      ______,
+	      ______,
+	      ______},
+    [0x5f] = {______,
+	      ______,
+	      ______,
+	      ______,
+	      ______,
+	      ______,
+	      _OOOOO,
+	      ______},
+    [0x60] = {__O___,
+	      ___O__,
+	      ____O_,
+	      ______,
+	      ______,
+	      ______,
+	      ______,
+	      ______},
+    [0x61] = {______,
+	      ______,
+	      __OOO_,
+	      _____O,
+	      __OOOO,
+	      _O___O,
+	      __OOOO,
+	      ______},
+    [0x62] = {_O____,
+	      _O____,
+	      _O_OO_,
+	      _OO__O,
+	      _O___O,
+	      _O___O,
+	      _OOOO_,
+	      ______},
+    [0x63] = {______,
+	      ______,
+	      __OOO_,
+	      _O____,
+	      _O____,
+	      _O___O,
+	      __OOO_,
+	      ______},
+    [0x64] = {_____O,
+	      _____O,
+	      __OO_O,
+	      _O__OO,
+	      _O___O,
+	      _O___O,
+	      __OOOO,
+	      ______},
+    [0x65] = {______,
+	      ______,
+	      __OOO_,
+	      _O___O,
+	      _OOOOO,
+	      _O____,
+	      __OOO_,
+	      ______},
+    [0x66] = {___OO_,
+	      __O__O,
+	      __O___,
+	      _OOO__,
+	      __O___,
+	      __O___,
+	      __O___,
+	      ______},
+    [0x67] = {______,
+	      ______,
+	      __OOOO,
+	      _O___O,
+	      _O___O,
+	      __OOOO,
+	      _____O,
+	      __OOO_},
+    [0x68] = {_O____,
+	      _O____,
+	      _O_OO_,
+	      _OO__O,
+	      _O___O,
+	      _O___O,
+	      _O___O,
+	      ______},
+    [0x69] = {___O__,
+	      ______,
+	      __OO__,
+	      ___O__,
+	      ___O__,
+	      ___O__,
+	      __OOO_,
+	      ______},
+    [0x6a] = {____O_,
+	      ______,
+	      ___OO_,
+	      ____O_,
+	      ____O_,
+	      _O__O_,
+	      __OO__,
+	      ______},
+    [0x6b] = {__O___,
+	      __O___,
+	      __O__O,
+	      __O_O_,
+	      __OO__,
+	      __O_O_,
+	      __O__O,
+	      ______},
+    [0x6c] = {__OO__,
+	      ___O__,
+	      ___O__,
+	      ___O__,
+	      ___O__,
+	      ___O__,
+	      __OOO_,
+	      ______},
+    [0x6d] = {______,
+	      ______,
+	      _OO_O_,
+	      _O_O_O,
+	      _O_O_O,
+	      _O___O,
+	      _O___O,
+	      ______},
+    [0x6e] = {______,
+	      ______,
+	      _OOOO_,
+	      _O___O,
+	      _O___O,
+	      _O___O,
+	      _O___O,
+	      ______},
+    [0x6f] = {______,
+	      ______,
+	      __OOO_,
+	      _O___O,
+	      _O___O,
+	      _O___O,
+	      __OOO_,
+	      ______},
+    [0x70] = {______,
+	      ______,
+	      _OOOO_,
+	      _O___O,
+	      _O___O,
+	      _OOOO_,
+	      _O____,
+	      _O____},
+    [0x71] = {______,
+	      ______,
+	      __OO_O,
+	      _O__OO,
+	      _O___O,
+	      __OOOO,
+	      _____O,
+	      _____O},
+    [0x72] = {______,
+	      ______,
+	      _O_OO_,
+	      _OO__O,
+	      _O____,
+	      _O____,
+	      _O____,
+	      ______},
+    [0x73] = {______,
+	      ______,
+	      __OOO_,
+	      _O____,
+	      __OOO_,
+	      _____O,
+	      _OOOO_,
+	      ______},
+    [0x74] = {__O___,
+	      __O___,
+	      _OOO__,
+	      __O___,
+	      __O___,
+	      __O__O,
+	      ___OO_,
+	      ______},
+    [0x75] = {______,
+	      ______,
+	      _O___O,
+	      _O___O,
+	      _O___O,
+	      _O__OO,
+	      __OO_O,
+	      ______},
+    [0x76] = {______,
+	      ______,
+	      _O___O,
+	      _O___O,
+	      _O___O,
+	      __O_O_,
+	      ___O__,
+	      ______},
+    [0x77] = {______,
+	      ______,
+	      _O___O,
+	      _O___O,
+	      _O___O,
+	      _O_O_O,
+	      __O_O_,
+	      ______},
+    [0x78] = {______,
+	      ______,
+	      _O___O,
+	      __O_O_,
+	      ___O__,
+	      __O_O_,
+	      _O___O,
+	      ______},
+    [0x79] = {______,
+	      ______,
+	      _O___O,
+	      _O___O,
+	      __OOOO,
+	      _____O,
+	      __OOO_,
+	      ______},
+    [0x7a] = {______,
+	      ______,
+	      _OOOOO,
+	      ____O_,
+	      ___O__,
+	      __O___,
+	      _OOOOO,
+	      ______},
+    [0x7b] = {____O_,
+	      ___O__,
+	      ___O__,
+	      __O___,
+	      ___O__,
+	      ___O__,
+	      ____O_,
+	      ______},
+    [0x7c] = {___O__,
+	      ___O__,
+	      ___O__,
+	      ___O__,
+	      ___O__,
+	      ___O__,
+	      ___O__,
+	      ______},
+    [0x7d] = {__O___,
+	      ___O__,
+	      ___O__,
+	      ____O_,
+	      ___O__,
+	      ___O__,
+	      __O___,
+	      ______},
+    [0x7e] = {______,
+	      ___O__,
+	      ____O_,
+	      _OOOOO,
+	      ____O_,
+	      ___O__,
+	      ______,
+	      ______},
 
-    [0x7f] {______,
-	    ___O__,
-	    __O___,
-	    _OOOOO,
-	    __O___,
-	    ___O__,
-	    ______,
-	    ______},
-    [0xb0] {__OOO_,
-	    __O_O_,
-	    __OOO_,
-	    ______,
-	    ______,
-	    ______,
-	    ______,
-	    ______},
+    [0x7f] = {______,
+	      ___O__,
+	      __O___,
+	      _OOOOO,
+	      __O___,
+	      ___O__,
+	      ______,
+	      ______},
+    [0xb0] = {__OOO_,
+	      __O_O_,
+	      __OOO_,
+	      ______,
+	      ______,
+	      ______,
+	      ______,
+	      ______},
+    [0xe1] = {__O_O_,
+	      ______,
+	      __OOO_,
+	      _____O,
+	      __OOOO,
+	      _O___O,
+	      __OOOO,
+	      ______},
+    [0xe2] = {__OOO_,
+	      _O___O,
+	      _OOOO_,
+	      _O___O,
+	      _O___O,
+	      _O_OO_,
+	      _O____,
+	      ______},
+    [0xef] = {__O_O_,
+	      ______,
+	      __OOO_,
+	      _O___O,
+	      _O___O,
+	      _O___O,
+	      __OOO_,
+	      ______},
+    [0xf5] = {__O_O_,
+	      ______,
+	      _O___O,
+	      _O___O,
+	      _O___O,
+	      _O__OO,
+	      __OO_O,
+	      ______},
 };
diff -urN lcd4linux-0.10.0/hash.c lcd4linux-0.11.0-SVN/hash.c
--- lcd4linux-0.10.0/hash.c	2005-05-08 06:32:44.000000000 +0200
+++ lcd4linux-0.11.0-SVN/hash.c	2008-12-31 08:05:54.000000000 +0100
@@ -1,8 +1,9 @@
-/* $Id: hash.c,v 1.26 2005/05/08 04:32:44 reinelt Exp $
+/* $Id: hash.c 840 2007-09-09 12:17:42Z michael $
+ * $URL: https://ssl.bulix.org/svn/lcd4linux/trunk/hash.c $
  *
  * hashes (associative arrays)
  *
- * Copyright (C) 2003 Michael Reinelt <reinelt@eunet.at>
+ * Copyright (C) 2003 Michael Reinelt <michael@reinelt.co.at>
  * Copyright (C) 2004 The LCD4Linux Team <lcd4linux-devel@users.sourceforge.net>
  *
  * This file is part of LCD4Linux.
@@ -21,118 +22,6 @@
  * along with this program; if not, write to the Free Software
  * Foundation, Inc., 675 Mass Ave, Cambridge, MA 02139, USA.
  *
- *
- * $Log: hash.c,v $
- * Revision 1.26  2005/05/08 04:32:44  reinelt
- * CodingStyle added and applied
- *
- * Revision 1.25  2005/01/18 06:30:23  reinelt
- * added (C) to all copyright statements
- *
- * Revision 1.24  2004/06/26 12:04:59  reinelt
- *
- * uh-oh... the last CVS log message messed up things a lot...
- *
- * Revision 1.23  2004/06/26 09:27:21  reinelt
- *
- * added '-W' to CFLAGS
- * changed all C++ comments to C ones
- * cleaned up a lot of signed/unsigned mistakes
- *
- * Revision 1.22  2004/06/20 10:09:56  reinelt
- *
- * 'const'ified the whole source
- *
- * Revision 1.21  2004/06/17 06:23:43  reinelt
- *
- * hash handling rewritten to solve performance issues
- *
- * Revision 1.20  2004/06/13 01:12:52  reinelt
- *
- * debug widgets changed (thanks to Andy Baxter)
- *
- * Revision 1.19  2004/06/01 06:45:30  reinelt
- *
- * some Fixme's processed
- * documented some code
- *
- * Revision 1.18  2004/05/31 16:39:06  reinelt
- *
- * added NULL display driver (for debugging/profiling purposes)
- * added backlight/contrast initialisation for matrixOrbital
- * added Backlight initialisation for Cwlinux
- *
- * Revision 1.17  2004/03/11 06:39:59  reinelt
- * big patch from Martin:
- * - reuse filehandles
- * - memory leaks fixed
- * - earlier busy-flag checking with HD44780
- * - reuse memory for strings in RESULT and hash
- * - netdev_fast to wavid time-consuming regex
- *
- * Revision 1.16  2004/03/03 08:40:07  hejl
- * Fixed memory leak in hash_get_regex
- *
- * Revision 1.15  2004/03/03 04:44:16  reinelt
- * changes (cosmetics?) to the big patch from Martin
- * hash patch un-applied
- *
- * Revision 1.14  2004/03/03 03:47:04  reinelt
- * big patch from Martin Hejl:
- * - use qprintf() where appropriate
- * - save CPU cycles on gettimeofday()
- * - add quit() functions to free allocated memory
- * - fixed lots of memory leaks
- *
- * Revision 1.13  2004/02/27 06:07:55  reinelt
- * hash improvements from Martin
- *
- * Revision 1.12  2004/01/30 20:57:56  reinelt
- * HD44780 patch from Martin Hejl
- * dmalloc integrated
- *
- * Revision 1.11  2004/01/29 04:40:02  reinelt
- * every .c file includes "config.h" now
- *
- * Revision 1.10  2004/01/27 04:48:57  reinelt
- * bug with hash_age() fixed (thanks to Markus Keil for pointing this out)
- *
- * Revision 1.9  2004/01/22 07:57:45  reinelt
- * several bugs fixed where segfaulting on layout>display
- * Crystalfontz driver optimized, 632 display already works
- *
- * Revision 1.8  2004/01/21 14:29:03  reinelt
- * new helper 'hash_get_regex' which delivers the sum over regex matched items
- * new function 'disk()' which uses this regex matching
- *
- * Revision 1.7  2004/01/21 10:48:17  reinelt
- * hash_age function added
- *
- * Revision 1.6  2004/01/20 05:36:59  reinelt
- * moved text-display-specific stuff to drv_generic_text
- * moved all the bar stuff from drv_generic_bar to generic_text
- *
- * Revision 1.5  2004/01/18 09:01:45  reinelt
- * /proc/stat parsing finished
- *
- * Revision 1.4  2004/01/18 06:54:08  reinelt
- * bug in expr.c fixed (thanks to Xavier)
- * some progress with /proc/stat parsing
- *
- * Revision 1.3  2004/01/16 07:26:25  reinelt
- * moved various /proc parsing to own functions
- * made some progress with /proc/stat parsing
- *
- * Revision 1.2  2004/01/16 05:04:53  reinelt
- * started plugin proc_stat which should parse /proc/stat
- * which again is a paint in the a**
- * thinking over implementation methods of delta functions
- * (CPU load, ...)
- *
- * Revision 1.1  2004/01/13 10:03:01  reinelt
- * new util 'hash' for associative arrays
- * new plugin 'cpuinfo'
- *
  */
 
 /* 
diff -urN lcd4linux-0.10.0/hash.h lcd4linux-0.11.0-SVN/hash.h
--- lcd4linux-0.10.0/hash.h	2005-05-08 06:32:44.000000000 +0200
+++ lcd4linux-0.11.0-SVN/hash.h	2008-12-31 08:05:54.000000000 +0100
@@ -1,8 +1,9 @@
-/* $Id: hash.h,v 1.19 2005/05/08 04:32:44 reinelt Exp $
+/* $Id: hash.h 840 2007-09-09 12:17:42Z michael $
+ * $URL: https://ssl.bulix.org/svn/lcd4linux/trunk/hash.h $
  *
  * hashes (associative arrays)
  *
- * Copyright (C) 2003 Michael Reinelt <reinelt@eunet.at>
+ * Copyright (C) 2003 Michael Reinelt <michael@reinelt.co.at>
  * Copyright (C) 2004 The LCD4Linux Team <lcd4linux-devel@users.sourceforge.net>
  *
  * This file is part of LCD4Linux.
@@ -21,91 +22,6 @@
  * along with this program; if not, write to the Free Software
  * Foundation, Inc., 675 Mass Ave, Cambridge, MA 02139, USA.
  *
- *
- * $Log: hash.h,v $
- * Revision 1.19  2005/05/08 04:32:44  reinelt
- * CodingStyle added and applied
- *
- * Revision 1.18  2005/01/18 06:30:23  reinelt
- * added (C) to all copyright statements
- *
- * Revision 1.17  2004/06/26 12:04:59  reinelt
- *
- * uh-oh... the last CVS log message messed up things a lot...
- *
- * Revision 1.16  2004/06/26 09:27:21  reinelt
- *
- * added '-W' to CFLAGS
- * changed all C++ comments to C ones
- * cleaned up a lot of signed/unsigned mistakes
- *
- * Revision 1.15  2004/06/20 10:09:56  reinelt
- *
- * 'const'ified the whole source
- *
- * Revision 1.14  2004/06/17 06:23:43  reinelt
- *
- * hash handling rewritten to solve performance issues
- *
- * Revision 1.13  2004/06/13 01:12:52  reinelt
- *
- * debug widgets changed (thanks to Andy Baxter)
- *
- * Revision 1.12  2004/06/01 06:45:30  reinelt
- *
- * some Fixme's processed
- * documented some code
- *
- * Revision 1.11  2004/03/11 06:39:59  reinelt
- * big patch from Martin:
- * - reuse filehandles
- * - memory leaks fixed
- * - earlier busy-flag checking with HD44780
- * - reuse memory for strings in RESULT and hash
- * - netdev_fast to wavid time-consuming regex
- *
- * Revision 1.10  2004/03/03 04:44:16  reinelt
- * changes (cosmetics?) to the big patch from Martin
- * hash patch un-applied
- *
- * Revision 1.9  2004/03/03 03:47:04  reinelt
- * big patch from Martin Hejl:
- * - use qprintf() where appropriate
- * - save CPU cycles on gettimeofday()
- * - add quit() functions to free allocated memory
- * - fixed lots of memory leaks
- *
- * Revision 1.8  2004/02/27 06:07:55  reinelt
- * hash improvements from Martin
- *
- * Revision 1.7  2004/01/21 14:29:03  reinelt
- * new helper 'hash_get_regex' which delivers the sum over regex matched items
- * new function 'disk()' which uses this regex matching
- *
- * Revision 1.6  2004/01/21 10:48:17  reinelt
- * hash_age function added
- *
- * Revision 1.5  2004/01/18 09:01:45  reinelt
- * /proc/stat parsing finished
- *
- * Revision 1.4  2004/01/16 11:12:26  reinelt
- * some bugs in plugin_xmms fixed, parsing moved to own function
- * plugin_proc_stat nearly finished
- *
- * Revision 1.3  2004/01/16 07:26:25  reinelt
- * moved various /proc parsing to own functions
- * made some progress with /proc/stat parsing
- *
- * Revision 1.2  2004/01/16 05:04:53  reinelt
- * started plugin proc_stat which should parse /proc/stat
- * which again is a paint in the a**
- * thinking over implementation methods of delta functions
- * (CPU load, ...)
- *
- * Revision 1.1  2004/01/13 10:03:01  reinelt
- * new util 'hash' for associative arrays
- * new plugin 'cpuinfo'
- *
  */
 
 #ifndef _HASH_H_
diff -urN lcd4linux-0.10.0/INSTALL lcd4linux-0.11.0-SVN/INSTALL
--- lcd4linux-0.10.0/INSTALL	2003-02-27 08:23:50.000000000 +0100
+++ lcd4linux-0.11.0-SVN/INSTALL	2008-12-31 08:05:54.000000000 +0100
@@ -1,38 +1,54 @@
+Installation Instructions
+*************************
+
+Copyright (C) 1994, 1995, 1996, 1999, 2000, 2001, 2002, 2004, 2005,
+2006, 2007 Free Software Foundation, Inc.
+
+This file is free documentation; the Free Software Foundation gives
+unlimited permission to copy, distribute and modify it.
+
 Basic Installation
 ==================
 
-   These are generic installation instructions.
+Briefly, the shell commands `./configure; make; make install' should
+configure, build, and install this package.  The following
+more-detailed instructions are generic; see the `README' file for
+instructions specific to this package.
 
    The `configure' shell script attempts to guess correct values for
 various system-dependent variables used during compilation.  It uses
 those values to create a `Makefile' in each directory of the package.
 It may also create one or more `.h' files containing system-dependent
 definitions.  Finally, it creates a shell script `config.status' that
-you can run in the future to recreate the current configuration, a file
-`config.cache' that saves the results of its tests to speed up
-reconfiguring, and a file `config.log' containing compiler output
-(useful mainly for debugging `configure').
+you can run in the future to recreate the current configuration, and a
+file `config.log' containing compiler output (useful mainly for
+debugging `configure').
+
+   It can also use an optional file (typically called `config.cache'
+and enabled with `--cache-file=config.cache' or simply `-C') that saves
+the results of its tests to speed up reconfiguring.  Caching is
+disabled by default to prevent problems with accidental use of stale
+cache files.
 
    If you need to do unusual things to compile the package, please try
 to figure out how `configure' could check whether to do them, and mail
 diffs or instructions to the address given in the `README' so they can
-be considered for the next release.  If at some point `config.cache'
-contains results you don't want to keep, you may remove or edit it.
-
-   The file `configure.in' is used to create `configure' by a program
-called `autoconf'.  You only need `configure.in' if you want to change
-it or regenerate `configure' using a newer version of `autoconf'.
+be considered for the next release.  If you are using the cache, and at
+some point `config.cache' contains results you don't want to keep, you
+may remove or edit it.
+
+   The file `configure.ac' (or `configure.in') is used to create
+`configure' by a program called `autoconf'.  You need `configure.ac' if
+you want to change it or regenerate `configure' using a newer version
+of `autoconf'.
 
 The simplest way to compile this package is:
 
   1. `cd' to the directory containing the package's source code and type
-     `./configure' to configure the package for your system.  If you're
-     using `csh' on an old version of System V, you might need to type
-     `sh ./configure' instead to prevent `csh' from trying to execute
-     `configure' itself.
+     `./configure' to configure the package for your system.
 
-     Running `configure' takes awhile.  While running, it prints some
-     messages telling which features it is checking for.
+     Running `configure' might take a while.  While running, it prints
+     some messages telling which features it is checking for.
 
   2. Type `make' to compile the package.
 
@@ -51,52 +67,55 @@
      all sorts of other programs in order to regenerate files that came
      with the distribution.
 
+  6. Often, you can also type `make uninstall' to remove the installed
+     files again.
+
 Compilers and Options
 =====================
 
-   Some systems require unusual options for compilation or linking that
-the `configure' script does not know about.  You can give `configure'
-initial values for variables by setting them in the environment.  Using
-a Bourne-compatible shell, you can do that on the command line like
-this:
-     CC=c89 CFLAGS=-O2 LIBS=-lposix ./configure
+Some systems require unusual options for compilation or linking that the
+`configure' script does not know about.  Run `./configure --help' for
+details on some of the pertinent environment variables.
+
+   You can give `configure' initial values for configuration parameters
+by setting variables in the command line or in the environment.  Here
+is an example:
+
+     ./configure CC=c99 CFLAGS=-g LIBS=-lposix
 
-Or on systems that have the `env' program, you can do it like this:
-     env CPPFLAGS=-I/usr/local/include LDFLAGS=-s ./configure
+   *Note Defining Variables::, for more details.
 
 Compiling For Multiple Architectures
 ====================================
 
-   You can compile the package for more than one kind of computer at the
+You can compile the package for more than one kind of computer at the
 same time, by placing the object files for each architecture in their
-own directory.  To do this, you must use a version of `make' that
-supports the `VPATH' variable, such as GNU `make'.  `cd' to the
+own directory.  To do this, you can use GNU `make'.  `cd' to the
 directory where you want the object files and executables to go and run
 the `configure' script.  `configure' automatically checks for the
 source code in the directory that `configure' is in and in `..'.
 
-   If you have to use a `make' that does not supports the `VPATH'
-variable, you have to compile the package for one architecture at a time
-in the source code directory.  After you have installed the package for
-one architecture, use `make distclean' before reconfiguring for another
-architecture.
+   With a non-GNU `make', it is safer to compile the package for one
+architecture at a time in the source code directory.  After you have
+installed the package for one architecture, use `make distclean' before
+reconfiguring for another architecture.
 
 Installation Names
 ==================
 
-   By default, `make install' will install the package's files in
-`/usr/local/bin', `/usr/local/man', etc.  You can specify an
-installation prefix other than `/usr/local' by giving `configure' the
-option `--prefix=PATH'.
+By default, `make install' installs the package's commands under
+`/usr/local/bin', include files under `/usr/local/include', etc.  You
+can specify an installation prefix other than `/usr/local' by giving
+`configure' the option `--prefix=PREFIX'.
 
    You can specify separate installation prefixes for
 architecture-specific files and architecture-independent files.  If you
-give `configure' the option `--exec-prefix=PATH', the package will use
-PATH as the prefix for installing programs and libraries.
-Documentation and other data files will still use the regular prefix.
+pass the option `--exec-prefix=PREFIX' to `configure', the package uses
+PREFIX as the prefix for installing programs and libraries.
+Documentation and other data files still use the regular prefix.
 
    In addition, if you use an unusual directory layout you can give
-options like `--bindir=PATH' to specify different values for particular
+options like `--bindir=DIR' to specify different values for particular
 kinds of files.  Run `configure --help' for a list of the directories
 you can set and what kinds of files go in them.
 
@@ -107,7 +126,7 @@
 Optional Features
 =================
 
-   Some packages pay attention to `--enable-FEATURE' options to
+Some packages pay attention to `--enable-FEATURE' options to
 `configure', where FEATURE indicates an optional part of the package.
 They may also pay attention to `--with-PACKAGE' options, where PACKAGE
 is something like `gnu-as' or `x' (for the X Window System).  The
@@ -122,48 +141,86 @@
 Specifying the System Type
 ==========================
 
-   There may be some features `configure' can not figure out
-automatically, but needs to determine by the type of host the package
-will run on.  Usually `configure' can figure that out, but if it prints
-a message saying it can not guess the host type, give it the
-`--host=TYPE' option.  TYPE can either be a short name for the system
-type, such as `sun4', or a canonical name with three fields:
+There may be some features `configure' cannot figure out automatically,
+but needs to determine by the type of machine the package will run on.
+Usually, assuming the package is built to be run on the _same_
+architectures, `configure' can figure that out, but if it prints a
+message saying it cannot guess the machine type, give it the
+`--build=TYPE' option.  TYPE can either be a short name for the system
+type, such as `sun4', or a canonical name which has the form:
+
      CPU-COMPANY-SYSTEM
 
-See the file `config.sub' for the possible values of each field.  If
+where SYSTEM can have one of these forms:
+
+     OS KERNEL-OS
+
+   See the file `config.sub' for the possible values of each field.  If
 `config.sub' isn't included in this package, then this package doesn't
-need to know the host type.
+need to know the machine type.
 
-   If you are building compiler tools for cross-compiling, you can also
-use the `--target=TYPE' option to select the type of system they will
-produce code for and the `--build=TYPE' option to select the type of
-system on which you are compiling the package.
+   If you are _building_ compiler tools for cross-compiling, you should
+use the option `--target=TYPE' to select the type of system they will
+produce code for.
+
+   If you want to _use_ a cross compiler, that generates code for a
+platform different from the build platform, you should specify the
+"host" platform (i.e., that on which the generated programs will
+eventually be run) with `--host=TYPE'.
 
 Sharing Defaults
 ================
 
-   If you want to set default values for `configure' scripts to share,
-you can create a site shell script called `config.site' that gives
-default values for variables like `CC', `cache_file', and `prefix'.
+If you want to set default values for `configure' scripts to share, you
+can create a site shell script called `config.site' that gives default
+values for variables like `CC', `cache_file', and `prefix'.
 `configure' looks for `PREFIX/share/config.site' if it exists, then
 `PREFIX/etc/config.site' if it exists.  Or, you can set the
 `CONFIG_SITE' environment variable to the location of the site script.
 A warning: not all `configure' scripts look for a site script.
 
-Operation Controls
+Defining Variables
 ==================
 
-   `configure' recognizes the following options to control how it
-operates.
+Variables not defined in a site shell script can be set in the
+environment passed to `configure'.  However, some packages may run
+configure again during the build, and the customized values of these
+variables may be lost.  In order to avoid this problem, you should set
+them in the `configure' command line, using `VAR=value'.  For example:
 
-`--cache-file=FILE'
-     Use and save the results of the tests in FILE instead of
-     `./config.cache'.  Set FILE to `/dev/null' to disable caching, for
-     debugging `configure'.
+     ./configure CC=/usr/local2/bin/gcc
+
+causes the specified `gcc' to be used as the C compiler (unless it is
+overridden in the site shell script).
+
+Unfortunately, this technique does not work for `CONFIG_SHELL' due to
+an Autoconf bug.  Until the bug is fixed you can use this workaround:
+
+     CONFIG_SHELL=/bin/bash /bin/bash ./configure CONFIG_SHELL=/bin/bash
+
+`configure' Invocation
+======================
+
+`configure' recognizes the following options to control how it operates.
 
 `--help'
+`-h'
      Print a summary of the options to `configure', and exit.
 
+`--version'
+`-V'
+     Print the version of Autoconf used to generate the `configure'
+     script, and exit.
+
+`--cache-file=FILE'
+     Enable the cache: use and save the results of the tests in FILE,
+     traditionally `config.cache'.  FILE defaults to `/dev/null' to
+     disable caching.
+
+`--config-cache'
+`-C'
+     Alias for `--cache-file=config.cache'.
+
 `--quiet'
 `--silent'
 `-q'
@@ -175,8 +232,6 @@
      Look for the package's source code in directory DIR.  Usually
      `configure' can determine that directory automatically.
 
-`--version'
-     Print the version of Autoconf used to generate the `configure'
-     script, and exit.
+`configure' also accepts some other, not widely useful, options.  Run
+`configure --help' for more details.
 
-`configure' also accepts some other, not widely useful, options.
diff -urN lcd4linux-0.10.0/install-sh lcd4linux-0.11.0-SVN/install-sh
--- lcd4linux-0.10.0/install-sh	2003-02-27 08:24:05.000000000 +0100
+++ lcd4linux-0.11.0-SVN/install-sh	2008-12-31 08:05:54.000000000 +0100
@@ -1,251 +1,519 @@
 #!/bin/sh
-#
 # install - install a program, script, or datafile
-# This comes from X11R5 (mit/util/scripts/install.sh).
+
+scriptversion=2006-12-25.00
+
+# This originates from X11R5 (mit/util/scripts/install.sh), which was
+# later released in X11R6 (xc/config/util/install.sh) with the
+# following copyright and license.
+#
+# Copyright (C) 1994 X Consortium
+#
+# Permission is hereby granted, free of charge, to any person obtaining a copy
+# of this software and associated documentation files (the "Software"), to
+# deal in the Software without restriction, including without limitation the
+# rights to use, copy, modify, merge, publish, distribute, sublicense, and/or
+# sell copies of the Software, and to permit persons to whom the Software is
+# furnished to do so, subject to the following conditions:
+#
+# The above copyright notice and this permission notice shall be included in
+# all copies or substantial portions of the Software.
+#
+# THE SOFTWARE IS PROVIDED "AS IS", WITHOUT WARRANTY OF ANY KIND, EXPRESS OR
+# IMPLIED, INCLUDING BUT NOT LIMITED TO THE WARRANTIES OF MERCHANTABILITY,
+# FITNESS FOR A PARTICULAR PURPOSE AND NONINFRINGEMENT.  IN NO EVENT SHALL THE
+# X CONSORTIUM BE LIABLE FOR ANY CLAIM, DAMAGES OR OTHER LIABILITY, WHETHER IN
+# AN ACTION OF CONTRACT, TORT OR OTHERWISE, ARISING FROM, OUT OF OR IN CONNEC-
+# TION WITH THE SOFTWARE OR THE USE OR OTHER DEALINGS IN THE SOFTWARE.
+#
+# Except as contained in this notice, the name of the X Consortium shall not
+# be used in advertising or otherwise to promote the sale, use or other deal-
+# ings in this Software without prior written authorization from the X Consor-
+# tium.
 #
-# Copyright 1991 by the Massachusetts Institute of Technology
 #
-# Permission to use, copy, modify, distribute, and sell this software and its
-# documentation for any purpose is hereby granted without fee, provided that
-# the above copyright notice appear in all copies and that both that
-# copyright notice and this permission notice appear in supporting
-# documentation, and that the name of M.I.T. not be used in advertising or
-# publicity pertaining to distribution of the software without specific,
-# written prior permission.  M.I.T. makes no representations about the
-# suitability of this software for any purpose.  It is provided "as is"
-# without express or implied warranty.
+# FSF changes to this file are in the public domain.
 #
 # Calling this script install-sh is preferred over install.sh, to prevent
 # `make' implicit rules from creating a file called install from it
 # when there is no Makefile.
 #
 # This script is compatible with the BSD install script, but was written
-# from scratch.  It can only install one file at a time, a restriction
-# shared with many OS's install programs.
+# from scratch.
 
+nl='
+'
+IFS=" ""	$nl"
 
 # set DOITPROG to echo to test this script
 
 # Don't use :- since 4.3BSD and earlier shells don't like it.
-doit="${DOITPROG-}"
+doit=${DOITPROG-}
+if test -z "$doit"; then
+  doit_exec=exec
+else
+  doit_exec=$doit
+fi
+
+# Put in absolute file names if you don't have them in your path;
+# or use environment vars.
 
+chgrpprog=${CHGRPPROG-chgrp}
+chmodprog=${CHMODPROG-chmod}
+chownprog=${CHOWNPROG-chown}
+cmpprog=${CMPPROG-cmp}
+cpprog=${CPPROG-cp}
+mkdirprog=${MKDIRPROG-mkdir}
+mvprog=${MVPROG-mv}
+rmprog=${RMPROG-rm}
+stripprog=${STRIPPROG-strip}
+
+posix_glob='?'
+initialize_posix_glob='
+  test "$posix_glob" != "?" || {
+    if (set -f) 2>/dev/null; then
+      posix_glob=
+    else
+      posix_glob=:
+    fi
+  }
+'
+
+posix_mkdir=
 
-# put in absolute paths if you don't have them in your path; or use env. vars.
+# Desired mode of installed file.
+mode=0755
 
-mvprog="${MVPROG-mv}"
-cpprog="${CPPROG-cp}"
-chmodprog="${CHMODPROG-chmod}"
-chownprog="${CHOWNPROG-chown}"
-chgrpprog="${CHGRPPROG-chgrp}"
-stripprog="${STRIPPROG-strip}"
-rmprog="${RMPROG-rm}"
-mkdirprog="${MKDIRPROG-mkdir}"
-
-transformbasename=""
-transform_arg=""
-instcmd="$mvprog"
-chmodcmd="$chmodprog 0755"
-chowncmd=""
-chgrpcmd=""
-stripcmd=""
+chgrpcmd=
+chmodcmd=$chmodprog
+chowncmd=
+mvcmd=$mvprog
 rmcmd="$rmprog -f"
-mvcmd="$mvprog"
-src=""
-dst=""
-dir_arg=""
-
-while [ x"$1" != x ]; do
-    case $1 in
-	-c) instcmd="$cpprog"
-	    shift
-	    continue;;
-
-	-d) dir_arg=true
-	    shift
-	    continue;;
-
-	-m) chmodcmd="$chmodprog $2"
-	    shift
-	    shift
-	    continue;;
-
-	-o) chowncmd="$chownprog $2"
-	    shift
-	    shift
-	    continue;;
-
-	-g) chgrpcmd="$chgrpprog $2"
-	    shift
-	    shift
-	    continue;;
-
-	-s) stripcmd="$stripprog"
-	    shift
-	    continue;;
-
-	-t=*) transformarg=`echo $1 | sed 's/-t=//'`
-	    shift
-	    continue;;
-
-	-b=*) transformbasename=`echo $1 | sed 's/-b=//'`
-	    shift
-	    continue;;
+stripcmd=
 
-	*)  if [ x"$src" = x ]
-	    then
-		src=$1
-	    else
-		# this colon is to work around a 386BSD /bin/sh bug
-		:
-		dst=$1
-	    fi
-	    shift
-	    continue;;
-    esac
-done
+src=
+dst=
+dir_arg=
+dst_arg=
 
-if [ x"$src" = x ]
-then
-	echo "install:	no input file specified"
-	exit 1
-else
-	true
-fi
+copy_on_change=false
+no_target_directory=
 
-if [ x"$dir_arg" != x ]; then
-	dst=$src
-	src=""
-	
-	if [ -d $dst ]; then
-		instcmd=:
-		chmodcmd=""
-	else
-		instcmd=mkdir
-	fi
-else
+usage="\
+Usage: $0 [OPTION]... [-T] SRCFILE DSTFILE
+   or: $0 [OPTION]... SRCFILES... DIRECTORY
+   or: $0 [OPTION]... -t DIRECTORY SRCFILES...
+   or: $0 [OPTION]... -d DIRECTORIES...
 
-# Waiting for this to be detected by the "$instcmd $src $dsttmp" command
-# might cause directories to be created, which would be especially bad 
-# if $src (and thus $dsttmp) contains '*'.
-
-	if [ -f $src -o -d $src ]
-	then
-		true
-	else
-		echo "install:  $src does not exist"
-		exit 1
-	fi
-	
-	if [ x"$dst" = x ]
-	then
-		echo "install:	no destination specified"
-		exit 1
-	else
-		true
-	fi
+In the 1st form, copy SRCFILE to DSTFILE.
+In the 2nd and 3rd, copy all SRCFILES to DIRECTORY.
+In the 4th, create DIRECTORIES.
 
-# If destination is a directory, append the input filename; if your system
-# does not like double slashes in filenames, you may need to add some logic
+Options:
+     --help     display this help and exit.
+     --version  display version info and exit.
 
-	if [ -d $dst ]
-	then
-		dst="$dst"/`basename $src`
-	else
-		true
-	fi
-fi
+  -c            (ignored)
+  -C            install only if different (preserve the last data modification time)
+  -d            create directories instead of installing files.
+  -g GROUP      $chgrpprog installed files to GROUP.
+  -m MODE       $chmodprog installed files to MODE.
+  -o USER       $chownprog installed files to USER.
+  -s            $stripprog installed files.
+  -t DIRECTORY  install into DIRECTORY.
+  -T            report an error if DSTFILE is a directory.
 
-## this sed command emulates the dirname command
-dstdir=`echo $dst | sed -e 's,[^/]*$,,;s,/$,,;s,^$,.,'`
+Environment variables override the default commands:
+  CHGRPPROG CHMODPROG CHOWNPROG CMPPROG CPPROG MKDIRPROG MVPROG
+  RMPROG STRIPPROG
+"
 
-# Make sure that the destination directory exists.
-#  this part is taken from Noah Friedman's mkinstalldirs script
+while test $# -ne 0; do
+  case $1 in
+    -c) ;;
 
-# Skip lots of stat calls in the usual case.
-if [ ! -d "$dstdir" ]; then
-defaultIFS=' 	
-'
-IFS="${IFS-${defaultIFS}}"
+    -C) copy_on_change=true;;
 
-oIFS="${IFS}"
-# Some sh's can't handle IFS=/ for some reason.
-IFS='%'
-set - `echo ${dstdir} | sed -e 's@/@%@g' -e 's@^%@/@'`
-IFS="${oIFS}"
-
-pathcomp=''
-
-while [ $# -ne 0 ] ; do
-	pathcomp="${pathcomp}${1}"
-	shift
-
-	if [ ! -d "${pathcomp}" ] ;
-        then
-		$mkdirprog "${pathcomp}"
-	else
-		true
-	fi
+    -d) dir_arg=true;;
 
-	pathcomp="${pathcomp}/"
-done
-fi
+    -g) chgrpcmd="$chgrpprog $2"
+	shift;;
 
-if [ x"$dir_arg" != x ]
-then
-	$doit $instcmd $dst &&
-
-	if [ x"$chowncmd" != x ]; then $doit $chowncmd $dst; else true ; fi &&
-	if [ x"$chgrpcmd" != x ]; then $doit $chgrpcmd $dst; else true ; fi &&
-	if [ x"$stripcmd" != x ]; then $doit $stripcmd $dst; else true ; fi &&
-	if [ x"$chmodcmd" != x ]; then $doit $chmodcmd $dst; else true ; fi
-else
+    --help) echo "$usage"; exit $?;;
 
-# If we're going to rename the final executable, determine the name now.
+    -m) mode=$2
+	case $mode in
+	  *' '* | *'	'* | *'
+'*	  | *'*'* | *'?'* | *'['*)
+	    echo "$0: invalid mode: $mode" >&2
+	    exit 1;;
+	esac
+	shift;;
 
-	if [ x"$transformarg" = x ] 
-	then
-		dstfile=`basename $dst`
-	else
-		dstfile=`basename $dst $transformbasename | 
-			sed $transformarg`$transformbasename
-	fi
+    -o) chowncmd="$chownprog $2"
+	shift;;
 
-# don't allow the sed command to completely eliminate the filename
+    -s) stripcmd=$stripprog;;
 
-	if [ x"$dstfile" = x ] 
-	then
-		dstfile=`basename $dst`
-	else
-		true
-	fi
+    -t) dst_arg=$2
+	shift;;
+
+    -T) no_target_directory=true;;
+
+    --version) echo "$0 $scriptversion"; exit $?;;
+
+    --)	shift
+	break;;
+
+    -*)	echo "$0: invalid option: $1" >&2
+	exit 1;;
 
-# Make a temp file name in the proper directory.
+    *)  break;;
+  esac
+  shift
+done
 
-	dsttmp=$dstdir/#inst.$$#
+if test $# -ne 0 && test -z "$dir_arg$dst_arg"; then
+  # When -d is used, all remaining arguments are directories to create.
+  # When -t is used, the destination is already specified.
+  # Otherwise, the last argument is the destination.  Remove it from $@.
+  for arg
+  do
+    if test -n "$dst_arg"; then
+      # $@ is not empty: it contains at least $arg.
+      set fnord "$@" "$dst_arg"
+      shift # fnord
+    fi
+    shift # arg
+    dst_arg=$arg
+  done
+fi
 
-# Move or copy the file name to the temp name
+if test $# -eq 0; then
+  if test -z "$dir_arg"; then
+    echo "$0: no input file specified." >&2
+    exit 1
+  fi
+  # It's OK to call `install-sh -d' without argument.
+  # This can happen when creating conditional directories.
+  exit 0
+fi
 
-	$doit $instcmd $src $dsttmp &&
+if test -z "$dir_arg"; then
+  trap '(exit $?); exit' 1 2 13 15
 
-	trap "rm -f ${dsttmp}" 0 &&
+  # Set umask so as not to create temps with too-generous modes.
+  # However, 'strip' requires both read and write access to temps.
+  case $mode in
+    # Optimize common cases.
+    *644) cp_umask=133;;
+    *755) cp_umask=22;;
+
+    *[0-7])
+      if test -z "$stripcmd"; then
+	u_plus_rw=
+      else
+	u_plus_rw='% 200'
+      fi
+      cp_umask=`expr '(' 777 - $mode % 1000 ')' $u_plus_rw`;;
+    *)
+      if test -z "$stripcmd"; then
+	u_plus_rw=
+      else
+	u_plus_rw=,u+rw
+      fi
+      cp_umask=$mode$u_plus_rw;;
+  esac
+fi
 
-# and set any options; do chmod last to preserve setuid bits
+for src
+do
+  # Protect names starting with `-'.
+  case $src in
+    -*) src=./$src;;
+  esac
+
+  if test -n "$dir_arg"; then
+    dst=$src
+    dstdir=$dst
+    test -d "$dstdir"
+    dstdir_status=$?
+  else
+
+    # Waiting for this to be detected by the "$cpprog $src $dsttmp" command
+    # might cause directories to be created, which would be especially bad
+    # if $src (and thus $dsttmp) contains '*'.
+    if test ! -f "$src" && test ! -d "$src"; then
+      echo "$0: $src does not exist." >&2
+      exit 1
+    fi
+
+    if test -z "$dst_arg"; then
+      echo "$0: no destination specified." >&2
+      exit 1
+    fi
+
+    dst=$dst_arg
+    # Protect names starting with `-'.
+    case $dst in
+      -*) dst=./$dst;;
+    esac
 
-# If any of these fail, we abort the whole thing.  If we want to
-# ignore errors from any of these, just make sure not to ignore
-# errors from the above "$doit $instcmd $src $dsttmp" command.
+    # If destination is a directory, append the input filename; won't work
+    # if double slashes aren't ignored.
+    if test -d "$dst"; then
+      if test -n "$no_target_directory"; then
+	echo "$0: $dst_arg: Is a directory" >&2
+	exit 1
+      fi
+      dstdir=$dst
+      dst=$dstdir/`basename "$src"`
+      dstdir_status=0
+    else
+      # Prefer dirname, but fall back on a substitute if dirname fails.
+      dstdir=`
+	(dirname "$dst") 2>/dev/null ||
+	expr X"$dst" : 'X\(.*[^/]\)//*[^/][^/]*/*$' \| \
+	     X"$dst" : 'X\(//\)[^/]' \| \
+	     X"$dst" : 'X\(//\)$' \| \
+	     X"$dst" : 'X\(/\)' \| . 2>/dev/null ||
+	echo X"$dst" |
+	    sed '/^X\(.*[^/]\)\/\/*[^/][^/]*\/*$/{
+		   s//\1/
+		   q
+		 }
+		 /^X\(\/\/\)[^/].*/{
+		   s//\1/
+		   q
+		 }
+		 /^X\(\/\/\)$/{
+		   s//\1/
+		   q
+		 }
+		 /^X\(\/\).*/{
+		   s//\1/
+		   q
+		 }
+		 s/.*/./; q'
+      `
+
+      test -d "$dstdir"
+      dstdir_status=$?
+    fi
+  fi
+
+  obsolete_mkdir_used=false
+
+  if test $dstdir_status != 0; then
+    case $posix_mkdir in
+      '')
+	# Create intermediate dirs using mode 755 as modified by the umask.
+	# This is like FreeBSD 'install' as of 1997-10-28.
+	umask=`umask`
+	case $stripcmd.$umask in
+	  # Optimize common cases.
+	  *[2367][2367]) mkdir_umask=$umask;;
+	  .*0[02][02] | .[02][02] | .[02]) mkdir_umask=22;;
+
+	  *[0-7])
+	    mkdir_umask=`expr $umask + 22 \
+	      - $umask % 100 % 40 + $umask % 20 \
+	      - $umask % 10 % 4 + $umask % 2
+	    `;;
+	  *) mkdir_umask=$umask,go-w;;
+	esac
+
+	# With -d, create the new directory with the user-specified mode.
+	# Otherwise, rely on $mkdir_umask.
+	if test -n "$dir_arg"; then
+	  mkdir_mode=-m$mode
+	else
+	  mkdir_mode=
+	fi
 
-	if [ x"$chowncmd" != x ]; then $doit $chowncmd $dsttmp; else true;fi &&
-	if [ x"$chgrpcmd" != x ]; then $doit $chgrpcmd $dsttmp; else true;fi &&
-	if [ x"$stripcmd" != x ]; then $doit $stripcmd $dsttmp; else true;fi &&
-	if [ x"$chmodcmd" != x ]; then $doit $chmodcmd $dsttmp; else true;fi &&
+	posix_mkdir=false
+	case $umask in
+	  *[123567][0-7][0-7])
+	    # POSIX mkdir -p sets u+wx bits regardless of umask, which
+	    # is incompatible with FreeBSD 'install' when (umask & 300) != 0.
+	    ;;
+	  *)
+	    tmpdir=${TMPDIR-/tmp}/ins$RANDOM-$$
+	    trap 'ret=$?; rmdir "$tmpdir/d" "$tmpdir" 2>/dev/null; exit $ret' 0
 
-# Now rename the file to the real destination.
+	    if (umask $mkdir_umask &&
+		exec $mkdirprog $mkdir_mode -p -- "$tmpdir/d") >/dev/null 2>&1
+	    then
+	      if test -z "$dir_arg" || {
+		   # Check for POSIX incompatibilities with -m.
+		   # HP-UX 11.23 and IRIX 6.5 mkdir -m -p sets group- or
+		   # other-writeable bit of parent directory when it shouldn't.
+		   # FreeBSD 6.1 mkdir -m -p sets mode of existing directory.
+		   ls_ld_tmpdir=`ls -ld "$tmpdir"`
+		   case $ls_ld_tmpdir in
+		     d????-?r-*) different_mode=700;;
+		     d????-?--*) different_mode=755;;
+		     *) false;;
+		   esac &&
+		   $mkdirprog -m$different_mode -p -- "$tmpdir" && {
+		     ls_ld_tmpdir_1=`ls -ld "$tmpdir"`
+		     test "$ls_ld_tmpdir" = "$ls_ld_tmpdir_1"
+		   }
+		 }
+	      then posix_mkdir=:
+	      fi
+	      rmdir "$tmpdir/d" "$tmpdir"
+	    else
+	      # Remove any dirs left behind by ancient mkdir implementations.
+	      rmdir ./$mkdir_mode ./-p ./-- 2>/dev/null
+	    fi
+	    trap '' 0;;
+	esac;;
+    esac
 
-	$doit $rmcmd -f $dstdir/$dstfile &&
-	$doit $mvcmd $dsttmp $dstdir/$dstfile 
+    if
+      $posix_mkdir && (
+	umask $mkdir_umask &&
+	$doit_exec $mkdirprog $mkdir_mode -p -- "$dstdir"
+      )
+    then :
+    else
+
+      # The umask is ridiculous, or mkdir does not conform to POSIX,
+      # or it failed possibly due to a race condition.  Create the
+      # directory the slow way, step by step, checking for races as we go.
+
+      case $dstdir in
+	/*) prefix='/';;
+	-*) prefix='./';;
+	*)  prefix='';;
+      esac
+
+      eval "$initialize_posix_glob"
+
+      oIFS=$IFS
+      IFS=/
+      $posix_glob set -f
+      set fnord $dstdir
+      shift
+      $posix_glob set +f
+      IFS=$oIFS
+
+      prefixes=
+
+      for d
+      do
+	test -z "$d" && continue
+
+	prefix=$prefix$d
+	if test -d "$prefix"; then
+	  prefixes=
+	else
+	  if $posix_mkdir; then
+	    (umask=$mkdir_umask &&
+	     $doit_exec $mkdirprog $mkdir_mode -p -- "$dstdir") && break
+	    # Don't fail if two instances are running concurrently.
+	    test -d "$prefix" || exit 1
+	  else
+	    case $prefix in
+	      *\'*) qprefix=`echo "$prefix" | sed "s/'/'\\\\\\\\''/g"`;;
+	      *) qprefix=$prefix;;
+	    esac
+	    prefixes="$prefixes '$qprefix'"
+	  fi
+	fi
+	prefix=$prefix/
+      done
 
-fi &&
+      if test -n "$prefixes"; then
+	# Don't fail if two instances are running concurrently.
+	(umask $mkdir_umask &&
+	 eval "\$doit_exec \$mkdirprog $prefixes") ||
+	  test -d "$dstdir" || exit 1
+	obsolete_mkdir_used=true
+      fi
+    fi
+  fi
+
+  if test -n "$dir_arg"; then
+    { test -z "$chowncmd" || $doit $chowncmd "$dst"; } &&
+    { test -z "$chgrpcmd" || $doit $chgrpcmd "$dst"; } &&
+    { test "$obsolete_mkdir_used$chowncmd$chgrpcmd" = false ||
+      test -z "$chmodcmd" || $doit $chmodcmd $mode "$dst"; } || exit 1
+  else
+
+    # Make a couple of temp file names in the proper directory.
+    dsttmp=$dstdir/_inst.$$_
+    rmtmp=$dstdir/_rm.$$_
+
+    # Trap to clean up those temp files at exit.
+    trap 'ret=$?; rm -f "$dsttmp" "$rmtmp" && exit $ret' 0
+
+    # Copy the file name to the temp name.
+    (umask $cp_umask && $doit_exec $cpprog "$src" "$dsttmp") &&
+
+    # and set any options; do chmod last to preserve setuid bits.
+    #
+    # If any of these fail, we abort the whole thing.  If we want to
+    # ignore errors from any of these, just make sure not to ignore
+    # errors from the above "$doit $cpprog $src $dsttmp" command.
+    #
+    { test -z "$chowncmd" || $doit $chowncmd "$dsttmp"; } &&
+    { test -z "$chgrpcmd" || $doit $chgrpcmd "$dsttmp"; } &&
+    { test -z "$stripcmd" || $doit $stripcmd "$dsttmp"; } &&
+    { test -z "$chmodcmd" || $doit $chmodcmd $mode "$dsttmp"; } &&
+
+    # If -C, don't bother to copy if it wouldn't change the file.
+    if $copy_on_change &&
+       old=`LC_ALL=C ls -dlL "$dst"	2>/dev/null` &&
+       new=`LC_ALL=C ls -dlL "$dsttmp"	2>/dev/null` &&
+
+       eval "$initialize_posix_glob" &&
+       $posix_glob set -f &&
+       set X $old && old=:$2:$4:$5:$6 &&
+       set X $new && new=:$2:$4:$5:$6 &&
+       $posix_glob set +f &&
+
+       test "$old" = "$new" &&
+       $cmpprog "$dst" "$dsttmp" >/dev/null 2>&1
+    then
+      rm -f "$dsttmp"
+    else
+      # Rename the file to the real destination.
+      $doit $mvcmd -f "$dsttmp" "$dst" 2>/dev/null ||
+
+      # The rename failed, perhaps because mv can't rename something else
+      # to itself, or perhaps because mv is so ancient that it does not
+      # support -f.
+      {
+	# Now remove or move aside any old file at destination location.
+	# We try this two ways since rm can't unlink itself on some
+	# systems and the destination file might be busy for other
+	# reasons.  In this case, the final cleanup might fail but the new
+	# file should still install successfully.
+	{
+	  test ! -f "$dst" ||
+	  $doit $rmcmd -f "$dst" 2>/dev/null ||
+	  { $doit $mvcmd -f "$dst" "$rmtmp" 2>/dev/null &&
+	    { $doit $rmcmd -f "$rmtmp" 2>/dev/null; :; }
+	  } ||
+	  { echo "$0: cannot unlink or rename $dst" >&2
+	    (exit 1); exit 1
+	  }
+	} &&
+
+	# Now rename the file to the real destination.
+	$doit $mvcmd "$dsttmp" "$dst"
+      }
+    fi || exit 1
 
+    trap '' 0
+  fi
+done
 
-exit 0
+# Local variables:
+# eval: (add-hook 'write-file-hooks 'time-stamp)
+# time-stamp-start: "scriptversion="
+# time-stamp-format: "%:y-%02m-%02d.%02H"
+# time-stamp-end: "$"
+# End:
diff -urN lcd4linux-0.10.0/layout.c lcd4linux-0.11.0-SVN/layout.c
--- lcd4linux-0.10.0/layout.c	2005-05-08 06:32:44.000000000 +0200
+++ lcd4linux-0.11.0-SVN/layout.c	2008-12-31 08:05:54.000000000 +0100
@@ -1,8 +1,9 @@
-/* $Id: layout.c,v 1.16 2005/05/08 04:32:44 reinelt Exp $
+/* $Id: layout.c 840 2007-09-09 12:17:42Z michael $
+ * $URL: https://ssl.bulix.org/svn/lcd4linux/trunk/layout.c $
  *
  * new layouter framework
  *
- * Copyright (C) 2003 Michael Reinelt <reinelt@eunet.at>
+ * Copyright (C) 2003 Michael Reinelt <michael@reinelt.co.at>
  * Copyright (C) 2004 The LCD4Linux Team <lcd4linux-devel@users.sourceforge.net>
  *
  * This file is part of LCD4Linux.
@@ -21,74 +22,6 @@
  * along with this program; if not, write to the Free Software
  * Foundation, Inc., 675 Mass Ave, Cambridge, MA 02139, USA.
  *
- *
- * $Log: layout.c,v $
- * Revision 1.16  2005/05/08 04:32:44  reinelt
- * CodingStyle added and applied
- *
- * Revision 1.15  2005/01/18 06:30:23  reinelt
- * added (C) to all copyright statements
- *
- * Revision 1.14  2004/06/26 12:04:59  reinelt
- *
- * uh-oh... the last CVS log message messed up things a lot...
- *
- * Revision 1.13  2004/06/26 09:27:21  reinelt
- *
- * added '-W' to CFLAGS
- * changed all C++ comments to C ones
- * cleaned up a lot of signed/unsigned mistakes
- *
- * Revision 1.12  2004/06/20 10:09:56  reinelt
- *
- * 'const'ified the whole source
- *
- * Revision 1.11  2004/06/02 09:41:19  reinelt
- *
- * prepared support for startup splash screen
- *
- * Revision 1.10  2004/03/03 03:47:04  reinelt
- * big patch from Martin Hejl:
- * - use qprintf() where appropriate
- * - save CPU cycles on gettimeofday()
- * - add quit() functions to free allocated memory
- * - fixed lots of memory leaks
- *
- * Revision 1.9  2004/02/01 19:37:40  reinelt
- * got rid of every strtok() incarnation.
- *
- * Revision 1.8  2004/02/01 18:08:50  reinelt
- * removed strtok() from layout processing (took me hours to find this bug)
- * further strtok() removind should be done!
- *
- * Revision 1.7  2004/01/30 20:57:56  reinelt
- * HD44780 patch from Martin Hejl
- * dmalloc integrated
- *
- * Revision 1.6  2004/01/14 11:33:00  reinelt
- * new plugin 'uname' which does what it's called
- * text widget nearly finished
- * first results displayed on MatrixOrbital
- *
- * Revision 1.5  2004/01/13 08:18:19  reinelt
- * timer queues added
- * liblcd4linux deactivated turing transformation to new layout
- *
- * Revision 1.4  2004/01/12 03:51:01  reinelt
- * evaluating the 'Variables' section in the config file
- *
- * Revision 1.3  2004/01/11 18:26:02  reinelt
- * further widget and layout processing
- *
- * Revision 1.2  2004/01/11 09:26:15  reinelt
- * layout starts to exist...
- *
- * Revision 1.1  2004/01/10 20:22:33  reinelt
- * added new function 'cfg_list()' (not finished yet)
- * added layout.c (will replace processor.c someday)
- * added widget_text.c (will be the first and most important widget)
- * modified lcd4linux.c so that old-style configs should work, too
- *
  */
 
 /* 
@@ -116,20 +49,12 @@
 #endif
 
 
-int layout_addItem(const char *name, const int row, const int col)
-{
-    /* allocate widget */
-    widget_add(name, row - 1, col - 1);
-    return 0;
-}
-
-
 int layout_init(const char *layout)
 {
     char *section;
     char *list, *l;
     char *widget;
-    int row, col;
+    int lay, row, col, num;
 
     info("initializing layout '%s'", layout);
 
@@ -148,21 +73,85 @@
 
     l = list;
     while (l != NULL) {
+
 	char *p;
 	int i, n;
+
 	/* list is delimited by | */
 	while (*l == '|')
 	    l++;
 	if ((p = strchr(l, '|')) != NULL)
 	    *p = '\0';
+
+	/* layer/x/y widgets */
+	i = sscanf(l, "layer:%d.x%d.y%d%n", &lay, &row, &col, &n);
+	if (i == 3 && l[n] == '\0') {
+	    if (lay < 0 || lay >= LAYERS) {
+		error("%s: layer %d out of bounds (0..%d)", section, lay, LAYERS - 1);
+	    } else {
+		widget = cfg_get(section, l, NULL);
+		if (widget != NULL && *widget != '\0') {
+		    widget_add(widget, WIDGET_TYPE_XY, lay, row - 1, col - 1);
+		}
+		free(widget);
+	    }
+	}
+
+	/* layer/row/col widgets */
+	i = sscanf(l, "layer:%d.row%d.col%d%n", &lay, &row, &col, &n);
+	if (i == 3 && l[n] == '\0') {
+	    if (lay < 0 || lay >= LAYERS) {
+		error("%s: layer %d out of bounds (0..%d)", section, lay, LAYERS - 1);
+	    } else {
+		widget = cfg_get(section, l, NULL);
+		if (widget != NULL && *widget != '\0') {
+		    widget_add(widget, WIDGET_TYPE_RC, lay, row - 1, col - 1);
+		}
+		free(widget);
+	    }
+	}
+
+	/* row/col widgets w/o layer */
 	i = sscanf(l, "row%d.col%d%n", &row, &col, &n);
 	if (i == 2 && l[n] == '\0') {
 	    widget = cfg_get(section, l, NULL);
 	    if (widget != NULL && *widget != '\0') {
-		layout_addItem(widget, row, col);
+		/* default is layer 1 if outside layer section */
+		widget_add(widget, WIDGET_TYPE_RC, 1, row - 1, col - 1);
+	    }
+	    free(widget);
+	}
+
+	/* GPO widgets */
+	i = sscanf(l, "gpo%d%n", &num, &n);
+	if (i == 1 && l[n] == '\0') {
+	    widget = cfg_get(section, l, NULL);
+	    if (widget != NULL && *widget != '\0') {
+		widget_add(widget, WIDGET_TYPE_GPO, 0, num - 1, 0);
 	    }
 	    free(widget);
 	}
+
+	/* timer widgets */
+	i = sscanf(l, "timer%d%n", &num, &n);
+	if (i == 1 && l[n] == '\0') {
+	    widget = cfg_get(section, l, NULL);
+	    if (widget != NULL && *widget != '\0') {
+		widget_add(widget, WIDGET_TYPE_TIMER, 0, num - 1, 0);
+	    }
+	    free(widget);
+	}
+
+	/* keypad widget */
+	i = sscanf(l, "keypad%d%n", &num, &n);
+	if (i == 1 && l[n] == '\0') {
+	    widget = cfg_get(section, l, NULL);
+	    if (widget != NULL && *widget != '\0') {
+		widget_add(widget, WIDGET_TYPE_KEYPAD, 0, num - 1, 0);
+	    }
+	    free(widget);
+	}
+
 	/* next field */
 	l = p ? p + 1 : NULL;
     }
diff -urN lcd4linux-0.10.0/layout.h lcd4linux-0.11.0-SVN/layout.h
--- lcd4linux-0.10.0/layout.h	2005-05-08 06:26:50.000000000 +0200
+++ lcd4linux-0.11.0-SVN/layout.h	2008-12-31 08:05:54.000000000 +0100
@@ -1,8 +1,9 @@
-/* $Id: layout.h,v 1.3 2005/01/18 06:30:23 reinelt Exp $
+/* $Id: layout.h 840 2007-09-09 12:17:42Z michael $
+ * $URL: https://ssl.bulix.org/svn/lcd4linux/trunk/layout.h $
  *
  * new layouter framework
  *
- * Copyright (C) 2003 Michael Reinelt <reinelt@eunet.at>
+ * Copyright (C) 2003 Michael Reinelt <michael@reinelt.co.at>
  * Copyright (C) 2004 The LCD4Linux Team <lcd4linux-devel@users.sourceforge.net>
  *
  * This file is part of LCD4Linux.
@@ -21,26 +22,14 @@
  * along with this program; if not, write to the Free Software
  * Foundation, Inc., 675 Mass Ave, Cambridge, MA 02139, USA.
  *
- *
- * $Log: layout.h,v $
- * Revision 1.3  2005/01/18 06:30:23  reinelt
- * added (C) to all copyright statements
- *
- * Revision 1.2  2004/06/20 10:09:56  reinelt
- *
- * 'const'ified the whole source
- *
- * Revision 1.1  2004/01/10 20:22:33  reinelt
- * added new function 'cfg_list()' (not finished yet)
- * added layout.c (will replace processor.c someday)
- * added widget_text.c (will be the first and most important widget)
- * modified lcd4linux.c so that old-style configs should work, too
- *
  */
 
 #ifndef _LAYOUT_H_
 #define _LAYOUT_H_
 
+/* number of layers */
+#define LAYERS 3
+
 int layout_init(const char *section);
 
 #endif
diff -urN lcd4linux-0.10.0/lcd4linux.c lcd4linux-0.11.0-SVN/lcd4linux.c
--- lcd4linux-0.10.0/lcd4linux.c	2005-05-08 06:32:44.000000000 +0200
+++ lcd4linux-0.11.0-SVN/lcd4linux.c	2009-01-13 05:54:45.000000000 +0100
@@ -1,9 +1,11 @@
-/* $Id: lcd4linux.c,v 1.78 2005/05/08 04:32:44 reinelt Exp $
+/* $Id: lcd4linux.c 958 2009-01-13 04:21:29Z michael $
+ * $URL: https://ssl.bulix.org/svn/lcd4linux/trunk/lcd4linux.c $
+ * $URL: https://ssl.bulix.org/svn/lcd4linux/trunk/lcd4linux.c $
  *
  * LCD4Linux
  *
- * Copyright (C) 1999, 2000, 2001, 2002, 2003 Michael Reinelt <reinelt@eunet.at>
- * Copyright (C) 2004 The LCD4Linux Team <lcd4linux-devel@users.sourceforge.net>
+ * Copyright (C) 1999, 2000, 2001, 2002, 2003 Michael Reinelt <michael@reinelt.co.at>
+ * Copyright (C) 2004, 2005, 2006, 2007, 2008, 2009 The LCD4Linux Team <lcd4linux-devel@users.sourceforge.net>
  *
  * This file is part of LCD4Linux.
  *
@@ -21,348 +23,6 @@
  * along with this program; if not, write to the Free Software
  * Foundation, Inc., 675 Mass Ave, Cambridge, MA 02139, USA.
  *
- *
- * $Log: lcd4linux.c,v $
- * Revision 1.78  2005/05/08 04:32:44  reinelt
- * CodingStyle added and applied
- *
- * Revision 1.77  2005/03/30 04:57:50  reinelt
- * Evaluator speedup: use bsearch for finding functions and variables
- *
- * Revision 1.76  2005/01/18 06:30:23  reinelt
- * added (C) to all copyright statements
- *
- * Revision 1.75  2004/09/24 21:41:00  reinelt
- * new driver for the BWCT USB LCD interface board.
- *
- * Revision 1.74  2004/06/26 12:04:59  reinelt
- *
- * uh-oh... the last CVS log message messed up things a lot...
- *
- * Revision 1.73  2004/06/26 09:27:21  reinelt
- *
- * added '-W' to CFLAGS
- * changed all C++ comments to C ones * cleaned up a lot of signed/unsigned mistakes
- *
- * Revision 1.72  2004/06/06 06:51:59  reinelt
- *
- * do not display end splash screen if quiet=1
- *
- * Revision 1.71  2004/06/02 09:41:19  reinelt
- *
- * prepared support for startup splash screen
- *
- * Revision 1.70  2004/06/02 05:14:16  reinelt
- *
- * fixed models listing for Beckmann+Egle driver
- * some cosmetic changes
- *
- * Revision 1.69  2004/03/14 07:11:42  reinelt
- * parameter count fixed for plugin_dvb()
- * plugin_APM (battery status) ported
- *
- * Revision 1.68  2004/03/11 06:39:59  reinelt
- * big patch from Martin:
- * - reuse filehandles
- * - memory leaks fixed
- * - earlier busy-flag checking with HD44780
- * - reuse memory for strings in RESULT and hash
- * - netdev_fast to wavid time-consuming regex
- *
- * Revision 1.67  2004/03/06 20:31:16  reinelt
- * Complete rewrite of the evaluator to get rid of the code
- * from mark Morley (because of license issues).
- * The new Evaluator does a pre-compile of expressions, and
- * stores them in trees. Therefore it should be reasonable faster...
- *
- * Revision 1.66  2004/03/03 04:44:16  reinelt
- * changes (cosmetics?) to the big patch from Martin
- * hash patch un-applied
- *
- * Revision 1.65  2004/03/03 03:47:04  reinelt
- * big patch from Martin Hejl:
- * - use qprintf() where appropriate
- * - save CPU cycles on gettimeofday()
- * - add quit() functions to free allocated memory
- * - fixed lots of memory leaks
- *
- * Revision 1.64  2004/02/27 07:06:25  reinelt
- * new function 'qprintf()' (simple but quick snprintf() replacement)
- *
- * Revision 1.63  2004/02/10 07:42:35  reinelt
- * cut off all old-style files which are no longer used with NextGeneration
- *
- * Revision 1.62  2004/01/30 20:57:56  reinelt
- * HD44780 patch from Martin Hejl
- * dmalloc integrated
- *
- * Revision 1.61  2004/01/14 11:33:00  reinelt
- * new plugin 'uname' which does what it's called
- * text widget nearly finished
- * first results displayed on MatrixOrbital
- *
- * Revision 1.60  2004/01/13 08:18:19  reinelt
- * timer queues added
- * liblcd4linux deactivated turing transformation to new layout
- *
- * Revision 1.59  2004/01/12 03:51:01  reinelt
- * evaluating the 'Variables' section in the config file
- *
- * Revision 1.58  2004/01/10 20:22:33  reinelt
- * added new function 'cfg_list()' (not finished yet)
- * added layout.c (will replace processor.c someday)
- * added widget_text.c (will be the first and most important widget)
- * modified lcd4linux.c so that old-style configs should work, too
- *
- * Revision 1.57  2004/01/10 17:45:26  reinelt
- * changed initialization order so cfg() gets initialized before plugins.
- * This way a plugin's init() can use cfg_get().
- * Thanks to Xavier for reporting this one!
- *
- * Revision 1.56  2004/01/09 17:03:07  reinelt
- * initiated transfer to new driver architecture
- * new file 'drv.c' will someday replace 'display.c'
- * new file 'drv_MatrixOrbital.c' will replace 'MatrixOrbital.c'
- * due to this 'soft' transfer lcd4linux should stay usable during the switch
- * (at least I hope so)
- *
- * Revision 1.55  2004/01/09 04:16:06  reinelt
- * added 'section' argument to cfg_get(), but NULLed it on all calls by now.
- *
- * Revision 1.54  2004/01/08 05:28:12  reinelt
- * Luk Claes added to AUTHORS
- * cfg: group handling ('{}') added
- *
- * Revision 1.53  2003/12/19 05:35:14  reinelt
- * renamed 'client' to 'plugin'
- *
- * Revision 1.52  2003/12/01 07:08:50  reinelt
- *
- * Patches from Xavier:
- *  - WiFi: make interface configurable
- *  - "quiet" as an option from the config file
- *  - ignore missing "MemShared" on Linux 2.6
- *
- * Revision 1.51  2003/11/16 09:45:49  reinelt
- * Crystalfontz changes, small glitch in getopt() fixed
- *
- * Revision 1.50  2003/10/22 04:19:16  reinelt
- * Makefile.in for imon.c/.h, some MatrixOrbital clients
- *
- * Revision 1.49  2003/10/11 06:01:53  reinelt
- *
- * renamed expression.{c,h} to client.{c,h}
- * added config file client
- * new functions 'AddNumericVariable()' and 'AddStringVariable()'
- * new parameter '-i' for interactive mode
- *
- * Revision 1.48  2003/10/05 17:58:50  reinelt
- * libtool junk; copyright messages cleaned up
- *
- * Revision 1.47  2003/09/10 08:37:09  reinelt
- * icons: reorganized tick_* again...
- *
- * Revision 1.46  2003/09/09 06:54:43  reinelt
- * new function 'cfg_number()'
- *
- * Revision 1.45  2003/09/09 05:30:34  reinelt
- * even more icons stuff
- *
- * Revision 1.44  2003/08/24 05:17:58  reinelt
- * liblcd4linux patch from Patrick Schemitz
- *
- * Revision 1.43  2003/08/17 16:37:39  reinelt
- * more icon framework
- *
- * Revision 1.42  2003/08/14 03:47:40  reinelt
- * remove PID file if driver initialisation fails
- *
- * Revision 1.41  2003/08/08 08:05:23  reinelt
- * added PID file handling
- *
- * Revision 1.40  2003/08/08 06:58:06  reinelt
- * improved forking
- *
- * Revision 1.39  2003/07/24 04:48:09  reinelt
- * 'soft clear' needed for virtual rows
- *
- * Revision 1.38  2003/06/13 05:11:11  reinelt
- * error message cosmetics
- *
- * Revision 1.37  2003/04/07 06:03:01  reinelt
- * further parallel port abstraction
- *
- * Revision 1.36  2003/02/22 07:53:10  reinelt
- * cfg_get(key,defval)
- *
- * Revision 1.35  2003/02/13 10:40:17  reinelt
- *
- * changed "copyright" to "2003"
- * added slightly different protocol for MatrixOrbital "LK202" displays
- *
- * Revision 1.34  2002/04/29 11:00:28  reinelt
- *
- * added Toshiba T6963 driver
- * added ndelay() with nanosecond resolution
- *
- * Revision 1.33  2001/04/27 05:04:57  reinelt
- *
- * replaced OPEN_MAX with sysconf()
- * replaced mktemp() with mkstemp()
- * unlock serial port if open() fails
- *
- * Revision 1.32  2001/03/13 07:41:22  reinelt
- *
- * added NEWS file
- *
- * Revision 1.31  2001/03/12 12:39:36  reinelt
- *
- * reworked autoconf a lot: drivers may be excluded, #define's went to config.h
- *
- * Revision 1.30  2001/03/08 15:25:38  ltoetsch
- * improved exec
- *
- * Revision 1.29  2001/02/14 07:40:16  reinelt
- *
- * first (incomplete) GPO implementation
- *
- * Revision 1.28  2000/10/25 08:10:48  reinelt
- *
- * added restart funnctionality
- * (lots of this code was stolen from sendmail.c)
- *
- * Revision 1.27  2000/08/10 18:42:20  reinelt
- *
- * fixed some bugs with the new syslog code
- *
- * Revision 1.26  2000/08/10 09:44:09  reinelt
- *
- * new debugging scheme: error(), info(), debug()
- * uses syslog if in daemon mode
- *
- * Revision 1.25  2000/08/09 14:14:11  reinelt
- *
- * new switch -F (do not fork)
- * added automatic forking if -F not specified
- *
- * Revision 1.24  2000/08/09 09:50:29  reinelt
- *
- * opened 0.98 development
- * removed driver-specific signal-handlers
- * added 'quit'-function to driver structure
- * added global signal-handler
- *
- * Revision 1.23  2000/04/17 05:14:27  reinelt
- *
- * added README.44780
- *
- * Revision 1.22  2000/04/15 16:56:52  reinelt
- *
- * moved delay loops to udelay.c
- * renamed -d (debugging) switch to -v (verbose)
- * new switch -d to calibrate delay loop
- * 'Delay' entry for HD44780 back again
- * delay loops will not calibrate automatically, because this will fail with hich CPU load
- *
- * Revision 1.21  2000/04/15 11:56:35  reinelt
- *
- * more debug messages
- *
- * Revision 1.20  2000/04/15 11:13:54  reinelt
- *
- * added '-d' (debugging) switch
- * added several debugging messages
- * removed config entry 'Delay' for HD44780 driver
- * delay loop for HD44780 will be calibrated automatically
- *
- * Revision 1.19  2000/04/10 04:40:53  reinelt
- *
- * minor changes and cleanups
- *
- * Revision 1.18  2000/04/07 05:42:20  reinelt
- *
- * UUCP style lockfiles for the serial port
- *
- * Revision 1.17  2000/04/03 17:31:52  reinelt
- *
- * suppress welcome message if display is smaller than 20x2
- * change lcd4linux.ppm to 32 pixel high so KDE won't stretch the icon
- *
- * Revision 1.16  2000/04/03 04:46:38  reinelt
- *
- * added '-c key=val' option
- *
- * Revision 1.15  2000/04/01 22:40:42  herp
- * geometric correction (too many pixelgaps)
- * lcd4linux main should return int, not void
- *
- * Revision 1.14  2000/03/26 18:46:28  reinelt
- *
- * bug in pixmap.c that leaded to empty bars fixed
- * name conflicts with X11 resolved
- *
- * Revision 1.13  2000/03/26 12:55:03  reinelt
- *
- * enhancements to the PPM driver
- *
- * Revision 1.12  2000/03/25 05:50:43  reinelt
- *
- * memory leak in Raster_flush closed
- * driver family logic changed
- *
- * Revision 1.11  2000/03/24 11:36:56  reinelt
- *
- * new syntax for raster configuration
- * changed XRES and YRES to be configurable
- * PPM driver works nice
- *
- * Revision 1.10  2000/03/23 07:24:48  reinelt
- *
- * PPM driver up and running (but slow!)
- *
- * Revision 1.9  2000/03/22 15:36:21  reinelt
- *
- * added '-l' switch (list drivers)
- * generic pixmap driver added
- * X11 Framework done
- *
- * Revision 1.8  2000/03/22 07:33:50  reinelt
- *
- * FAQ added
- * new modules 'processor.c' contains all data processing
- *
- * Revision 1.7  2000/03/19 08:41:28  reinelt
- *
- * documentation available! README, README.MatrixOrbital, README.Drivers
- * added Skeleton.c as a starting point for new drivers
- *
- * Revision 1.6  2000/03/18 10:31:06  reinelt
- *
- * added sensor handling (for temperature etc.)
- * made data collecting happen only if data is used
- * (reading /proc/meminfo takes a lot of CPU!)
- * released lcd4linux-0.92
- *
- * Revision 1.5  2000/03/18 08:07:04  reinelt
- *
- * vertical bars implemented
- * bar compaction improved
- * memory information implemented
- *
- * Revision 1.4  2000/03/17 09:21:42  reinelt
- *
- * various memory statistics added
- *
- * Revision 1.3  2000/03/13 15:58:24  reinelt
- *
- * release 0.9
- * moved row parsing to parser.c
- * all basic work finished
- *
- * Revision 1.2  2000/03/10 17:36:02  reinelt
- *
- * first unstable but running release
- *
  */
 
 #include "config.h"
@@ -375,7 +35,10 @@
 #include <errno.h>
 #include <signal.h>
 #include <time.h>
+#include <sys/types.h>		/* umask() */
+#include <sys/stat.h>		/* umask() */
 
+#include "svn_version.h"
 #include "cfg.h"
 #include "debug.h"
 #include "qprintf.h"
@@ -385,7 +48,10 @@
 #include "timer.h"
 #include "layout.h"
 #include "plugin.h"
+#include "thread.h"
 
+#include "widget.h"
+#include "widget_timer.h"
 
 #ifdef WITH_DMALLOC
 #include <dmalloc.h>
@@ -393,8 +59,9 @@
 
 #define PIDFILE "/var/run/lcd4linux.pid"
 
-static char *release = "LCD4Linux " VERSION;
-static char *copyright = "Copyright (C) 2005 The LCD4Linux Team <lcd4linux-devel@users.sourceforge.net>";
+static char *release = "LCD4Linux " VERSION "-" SVN_VERSION;
+static char *copyright =
+    "Copyright (C) 2005, 2006, 2007, 2008, 2009 The LCD4Linux Team <lcd4linux-devel@users.sourceforge.net>";
 static char **my_argv;
 extern char *output;
 
@@ -405,10 +72,26 @@
 {
     printf("%s\n", release);
     printf("%s\n", copyright);
-    printf("usage: lcd4linux [-h]\n");
-    printf("       lcd4linux [-l]\n");
-    printf("       lcd4linux [-c key=value] [-i] [-f config-file] [-v]\n");
-    printf("       lcd4linux [-c key=value] [-F] [-f config-file] [-o output-file] [-q] [-v]\n");
+    printf("\n");
+    printf("usage:\n");
+    printf(" lcd4linux [-h]\n");
+    printf(" lcd4linux [-l]\n");
+    printf(" lcd4linux [-c key=value] [-i] [-f config-file] [-v] [-p pid-file]\n");
+    printf(" lcd4linux [-c key=value] [-F] [-f config-file] [-o output-file] [-q] [-v]\n");
+    printf("\n");
+    printf("options:\n");
+    printf("  -h               help\n");
+    printf("  -l               list available display drivers\n");
+    printf("  -c <key>=<value> overwrite entries from the config-file\n");
+    printf("  -i               enter interactive mode (after display initialisation)\n");
+    printf("  -ii              enter interactive mode (before display initialisation)\n");
+    printf("  -f <config-file> use configuration from <config-file> instead of /etc/lcd4linux.conf\n");
+    printf("  -v               generate info messages\n");
+    printf("  -vv              generate debugging messages\n");
+    printf("  -p <pid-file>    specify a different pid-file location (default is /var/run/lcd4linux.pid)\n");
+    printf("  -F               do not fork and detach (run in foreground)\n");
+    printf("  -o <output-file> write picture to file (raster driver only)\n");
+    printf("  -q               suppress startup and exit splash screen\n");
 }
 
 static void interactive_mode(void)
@@ -418,7 +101,7 @@
     RESULT result = { 0, 0, 0, NULL };
 
     printf("\neval> ");
-    for (fgets(line, 1024, stdin); !feof(stdin); fgets(line, 1024, stdin)) {
+    for (fgets(line, sizeof(line), stdin); !feof(stdin); fgets(line, sizeof(line), stdin)) {
 	if (line[strlen(line) - 1] == '\n')
 	    line[strlen(line) - 1] = '\0';
 	if (strlen(line) > 0) {
@@ -450,9 +133,74 @@
 }
 
 
+static void daemonize(void)
+{
+
+    /* thanks to Petri Damsten, we now follow the guidelines from the UNIX Programming FAQ */
+    /* 1.7 How do I get my program to act like a daemon? */
+    /* http://www.erlenstar.demon.co.uk/unix/faq_2.html#SEC16 */
+    /* especially the double-fork solved the 'lcd4linux dying when called from init' problem */
+
+    pid_t i;
+    int fd;
+
+
+    /* Step 1: fork() so that the parent can exit */
+    i = fork();
+    if (i < 0) {
+	error("fork(#1) failed: %s", strerror(errno));
+	exit(1);
+    }
+    if (i != 0)
+	exit(0);
+
+    /* Step 2: setsid() to become a process group and session group leader */
+    setsid();
+
+    /* Step 3: fork() again so the parent (the session group leader) can exit */
+    i = fork();
+    if (i < 0) {
+	error("fork(#2) failed: %s", strerror(errno));
+	exit(1);
+    }
+    if (i != 0)
+	exit(0);
+
+    /* Step 4: chdir("/") to ensure that our process doesn't keep any directory in use */
+    if (chdir("/") != 0) {
+	error("chdir(\"/\") failed: %s", strerror(errno));
+	exit(1);
+    }
+
+    /* Step 5: umask(0) so that we have complete control over the permissions of anything we write */
+    umask(0);
+
+    /* Step 6: Establish new open descriptors for stdin, stdout and stderr */
+    /* detach stdin */
+    if (freopen("/dev/null", "r", stdin) == NULL) {
+	error("freopen (/dev/null) failed: %s", strerror(errno));
+	exit(1);
+    }
+
+    /* detach stdout and stderr */
+    fd = open("/dev/null", O_WRONLY, 0666);
+    if (fd == -1) {
+	error("open (/dev/null) failed: %s", strerror(errno));
+	exit(1);
+    }
+    fflush(stdout);
+    dup2(fd, STDOUT_FILENO);
+    fflush(stderr);
+    dup2(fd, STDERR_FILENO);
+    close(fd);
+
+}
+
+
 int main(int argc, char *argv[])
 {
     char *cfg = "/etc/lcd4linux.conf";
+    char *pidfile = PIDFILE;
     char *display, *driver, *layout;
     char section[32];
     int c;
@@ -467,10 +215,14 @@
     }
     my_argv[c] = NULL;
 
+    /* save original arguments pointer for threads */
+    thread_argv = argv;
+    thread_argc = argc;
+
     running_foreground = 0;
     running_background = 0;
 
-    while ((c = getopt(argc, argv, "c:Ff:hilo:qv")) != EOF) {
+    while ((c = getopt(argc, argv, "c:Ff:hilo:qvp:")) != EOF) {
 
 	switch (c) {
 	case 'c':
@@ -494,7 +246,11 @@
 	case 'l':
 	    printf("%s\n", release);
 	    printf("%s\n", copyright);
+	    printf("\n");
 	    drv_list();
+	    printf("\n");
+	    plugin_list();
+	    printf("\n");
 	    exit(0);
 	case 'o':
 	    output = optarg;
@@ -505,6 +261,9 @@
 	case 'v':
 	    verbose_level++;
 	    break;
+	case 'p':
+	    pidfile = optarg;
+	    break;
 	default:
 	    exit(2);
 	}
@@ -520,7 +279,7 @@
 	running_foreground = 1;
     }
 
-    info("Version " VERSION " starting");
+    info("Version " VERSION "-" SVN_VERSION " starting");
     if (!running_foreground && (my_argv[0] == NULL || my_argv[0][0] != '/')) {
 	info("invoked without full path; restart may not work!");
     }
@@ -546,50 +305,17 @@
     }
 
     if (!running_foreground) {
-	pid_t i;
-	int fd;
+
 	debug("going background...");
-	i = fork();
-	if (i < 0) {
-	    error("fork() failed: %s", strerror(errno));
-	    exit(1);
-	}
-	if (i != 0)
-	    exit(0);
+
+	daemonize();
 
 	/* ignore nasty signals */
 	signal(SIGINT, SIG_IGN);
 	signal(SIGQUIT, SIG_IGN);
 
-	/* chdir("/") */
-	if (chdir("/") != 0) {
-	    error("chdir(\"/\") failed: %s", strerror(errno));
-	    exit(1);
-	}
-
-	/* we want full control over permissions */
-	umask(0);
-
-	/* detach stdin */
-	if (freopen("/dev/null", "r", stdin) == NULL) {
-	    error("freopen (/dev/null) failed: %s", strerror(errno));
-	    exit(1);
-	}
-
-	/* detach stdout and stderr */
-	fd = open("/dev/null", O_WRONLY, 0666);
-	if (fd == -1) {
-	    error("open (/dev/null) failed: %s", strerror(errno));
-	    exit(1);
-	}
-	fflush(stdout);
-	fflush(stderr);
-	dup2(fd, STDOUT_FILENO);
-	dup2(fd, STDERR_FILENO);
-	close(fd);
-
 	/* create PID file */
-	if ((pid = pid_init(PIDFILE)) != 0) {
+	if ((pid = pid_init(pidfile)) != 0) {
 	    error("lcd4linux already running as process %d", pid);
 	    exit(1);
 	}
@@ -601,7 +327,7 @@
     /* go into interactive mode before display initialization */
     if (interactive >= 2) {
 	interactive_mode();
-	pid_exit(PIDFILE);
+	pid_exit(pidfile);
 	cfg_exit();
 	exit(0);
     }
@@ -613,16 +339,19 @@
 
     debug("initializing driver %s", driver);
     if (drv_init(section, driver, quiet) == -1) {
-	pid_exit(PIDFILE);
+	pid_exit(pidfile);
 	exit(1);
     }
     free(driver);
 
+    /* register timer widget */
+    widget_timer_register();
+
     /* go into interactive mode (display has been initialized) */
     if (interactive >= 1) {
 	interactive_mode();
 	drv_quit(quiet);
-	pid_exit(PIDFILE);
+	pid_exit(pidfile);
 	cfg_exit();
 	exit(0);
     }
@@ -639,6 +368,7 @@
 
     debug("starting main loop");
 
+
     /* now install our own signal handler */
     signal(SIGHUP, handler);
     signal(SIGINT, handler);
@@ -655,7 +385,7 @@
     debug("leaving main loop");
 
     drv_quit(quiet);
-    pid_exit(PIDFILE);
+    pid_exit(pidfile);
     cfg_exit();
     plugin_exit();
     timer_exit();
diff -urN lcd4linux-0.10.0/lcd4linux.conf.sample lcd4linux-0.11.0-SVN/lcd4linux.conf.sample
--- lcd4linux-0.10.0/lcd4linux.conf.sample	2005-06-09 19:26:13.000000000 +0200
+++ lcd4linux-0.11.0-SVN/lcd4linux.conf.sample	2009-01-13 14:15:28.000000000 +0100
@@ -1,3 +1,23 @@
+#  $Id: lcd4linux.conf.sample 960 2009-01-13 13:15:28Z michael $
+#  $URL: https://ssl.bulix.org/svn/lcd4linux/trunk/lcd4linux.conf.sample $
+
+
+Variables {
+   tick 500
+   tack 100
+   minute 60000
+}
+
+Display G15 {
+    Driver 'G-15'
+    Font   '6x8'
+    Contrast 10
+    Inverted 0
+    UInput '/dev/input/uinput'
+    SingleKeyPress 1
+}
+
+
 Display SerDispLib {
     Driver 'serdisplib'
     Port 'PAR:/dev/parports/0'
@@ -21,6 +41,37 @@
     UseBusy 0
 }
 
+Display IRLCD {
+    Driver 'IRLCD'
+    Size '16x2'
+    Backlight 0
+    Icons 1
+}
+
+Display LCD2USB {
+    Driver 'LCD2USB'
+    Size '20x2'
+    Backlight 1
+    Icons 1
+}
+
+
+Display LCD2041 {
+    Driver 'MatrixOrbital'
+    Model 'LCD2041'
+    Port '/dev/tts/0'
+    Speed 19200
+    Contrast 160
+}
+
+Display LK202 {
+    Driver 'MatrixOrbital'
+    Model 'LK202-24-USB'
+    Port '/dev/tts/USB0'
+    Speed 19200
+    Contrast 256/2
+}
+
 Display LK204 {
     Driver 'MatrixOrbital'
     Model 'LK204-24-USB'
@@ -55,7 +106,7 @@
     Port '/dev/tts/USB0'
     Speed 115200
     Contrast 95
-    Backlight 255
+    Backlight 50
     Icons 1
 }
 
@@ -68,7 +119,7 @@
 }
 
 Display CF633 {
-    Icons 4
+    Icons 1
     Driver 'Crystalfontz'
     Model '633'
     Port '/dev/tts/0'
@@ -77,6 +128,16 @@
     Backlight 50
 }
 
+Display CF635 {
+    Icons 1
+    Driver 'Crystalfontz'
+    Model '635'
+    Port '/dev/ttyUSB0'
+    Speed 115200
+    Contrast 100
+    Backlight 128
+}
+
 Display Curses {
     Driver 'Curses'
     Size '20x6'
@@ -89,12 +150,14 @@
     Port '/dev/parports/0'	
     Size '8x2'
     asc255bug 0
+    GPOs 8
     Wire {
 	RW      'GND'
 	RS      'AUTOFD'
 	ENABLE  'STROBE'
 	ENABLE2 'GND'
 	GPO     'INIT'
+	POWER   'GND'
     }
 }
 
@@ -103,14 +166,73 @@
     Driver 'HD44780'
     Model 'generic'
     UseBusy 1
-    Port '/dev/parport0'	
+    Port '/dev/parports/0'	
     Size '20x4'
+    asc255bug 1
     Wire {
 	RW      'AUTOFD'
 	RS      'INIT'
 	ENABLE  'STROBE'
 	ENABLE2 'GND'
 	GPO     'GND'
+	POWER   'GND'
+    }
+    Timing {
+	# fuzz timings by value (100 = no change)
+	fuzz 100
+	# low-level communication [ns]
+	CY 1000  # Enable cycle time
+	PW  450  # Enable pulse width
+	AS  140  # Address setup time
+	AH   20  # Address hold time
+	# HD44780 execution timings [us]
+	INIT1 4100  # first init sequence: 4.1 msec
+	INIT2  100  # second init sequence: 100 usec
+	EXEC    80  # normal execution time
+	WRCG   120  # CG RAM Write
+	CLEAR 2250  # Clear Display
+	HOME  2250  # Return Cursor Home
+	ONOFF 2250  # Display On/Off Control
+	# GPO timing [ns]
+	GPO_ST  20  # 74HCT573 set-up time
+	GPO_PW 230  # 74HCT573 enable pulse width
+	# Power supply timing [ms]
+	POWER  500  # power-on delay
+    }
+}
+
+# HD44780 display 4-Bit mode
+Display HD44780-4bit {
+    Driver 'HD44780'
+    Model 'generic'
+    Port '/dev/parports/0'	
+    Size '16x1'
+    Bits 4
+    UseBusy 0
+    asc255bug 0
+    Wire {
+        RW     'GND'
+        RS     'DB4'
+        ENABLE 'DB6'
+        GPO    'GND'
+    }
+}
+
+# Dual-HD44780 display from Pollin
+Display WDC2704M {
+    Driver 'HD44780'
+    Model 'generic'
+    Controllers 2
+    UseBusy 1
+    Port '/dev/parports/0'	
+    Size '27x4'
+    Wire {
+	RW      'AUTOFD'
+	RS      'INIT'
+	ENABLE  'STROBE'
+	ENABLE2 'SLCTIN'
+	GPO     'GND'
+	POWER   'GND'
     }
 }
 
@@ -119,7 +241,7 @@
     Driver 'HD44780'
     Model 'HD66712'
     UseBusy 1
-    Port '/dev/parport0'	
+    Port '/dev/parports/0'	
     Size '20x4'
     Wire {
 	RW      'AUTOFD'
@@ -127,12 +249,28 @@
 	ENABLE  'STROBE'
 	ENABLE2 'GND'
 	GPO     'GND'
+	POWER   'GND'
     }
 }
 
+Display picoLCD {
+    Driver 'picoLCD'
+    Size     '20x2'
+    Contrast  0
+    Backlight 1
+    Icons     1
+}
+
+Display picoLCDGraphic {
+    Driver 'picoLCDGraphic'
+    Size     '256x64'
+    Contrast  0
+    Backlight 100
+}
+
 Display SC1602D {
     Driver 'HD44780'
-    Port '/dev/parport0'	
+    Port '/dev/parports/0'	
     Bits '8'
     Size '16x2'
     asc255bug 0
@@ -142,6 +280,7 @@
 	RS     'AUTOFD'
 	ENABLE 'STROBE'
 	GPO    'INIT'
+	POWER  'GND'
     }
 }
 
@@ -150,7 +289,7 @@
     Driver 'HD44780'
     Model 'LCM-162'
 #   Bus 'parport'
-    Port '/dev/parport0'	
+    Port '/dev/parports/0'	
     Size '16x2'
     UseBusy 1
     asc255bug 0
@@ -193,6 +332,25 @@
     Size '20x2'
 }
 
+Display PHAnderson {
+    Driver 'PHAnderson'
+    Port '/dev/tts/0'
+    Speed 19200
+    Size '24x2'
+    Blackligth 100
+    Bootscreen '123456789012345678901234ABCDEFGHIJKLMNOPQRSTUVWX'                                         
+}
+
+Display BA63 {
+    Driver   'WincorNixdorf'
+    Model    'BA63'
+    Port     '/dev/tts/0'
+#   Port     '/dev/tts/USB0'
+    Speed     9600
+    BarChar   219
+    SelfTest  0
+}
+
 Display M50530-24x8 {
     Driver 'M50530'
     Port '/dev/parports/0'	
@@ -200,10 +358,13 @@
     Size '24x8'
     Font '5x7'
     Duty 2
+    Wire.RW   'INIT'
     Wire.EX   'STROBE'
     Wire.IOC1 'SLCTIN'
     Wire.IOC2 'AUTOFD'
-    Wire.GPO  'INIT'
+    Wire.GPO  'GND'
+    UseBusy    1
+    Timing.fuzz 100
 }
 
 
@@ -218,6 +379,13 @@
 }
 
 
+Display ULA200 {
+    Driver 'ULA200'
+    Size '20x4'
+    Icons 0
+    Backlight 1
+}
+
 Display USBLCD {
     Driver 'USBLCD'
 #   Port '/dev/lcd0'
@@ -230,8 +398,8 @@
 
 Display BWCT {
     Driver 'BWCT'
-    Size '16x2'
-    Contrast 30
+    Size '20x4'
+    Contrast 220
     asc255bug 1
     Icons 1
 }
@@ -241,23 +409,79 @@
     Driver 'T6963'
     Port '/dev/parports/0'
     Size '240x64'
+    DualScan 0
+    Cell 6
     Wire.CE 'STROBE'
     Wire.CD 'SLCTIN'
     Wire.RD 'AUTOFD'
     Wire.WR 'INIT'
+    Timing.fuzz 120
+    Font '6x8'
 }
 
+Display T6963-240x128 {
+    Driver 'T6963'
+    Port '/dev/parports/0'
+    Size '240x128'
+    DualScan 0
+    Cell 6
+    Wire.CE 'STROBE'
+    Wire.CD 'SLCTIN'
+    Wire.RD 'AUTOFD'
+    Wire.WR 'INIT'
+    Timing.fuzz 120
+    Font '6x8'
+}
+
+Display T6963-240x128D {
+    Driver 'T6963'
+    Port '/dev/parports/0'
+    Size '240x128'
+    DualScan 1
+    Cell 6
+    Wire.CE 'STROBE'
+    Wire.CD 'SLCTIN'
+    Wire.RD 'AUTOFD'
+    Wire.WR 'INIT'
+    Timing.fuzz 120
+    Font '6x8'
+}
+
+
+Display LPH7508 {
+    Driver 'LPH7508'
+    Port   '/dev/parports/0'
+    Font   '6x8'
+    Contrast 15
+    Inverted 0
+}
+
+Display LPH7508-serdisplib {
+    Driver 'serdisplib'
+    Port 'PAR:/dev/parports/0'
+    Model 'LPH7508'
+}
+
+Display ctinclud {
+   Driver  'serdisplib'
+   Port    'USB:7c0/1501'
+   Model   'CTINCLUD'
+   Options ''
+   Inverted 0
+}
 
 Display XWindow {
     Driver 'X11'
     Size   '120x32'
-    Font   '6x8'
+    Font   '5x8'
     Pixel  '4+1'
     Gap    '-1x-1'
     Border 20
-    Foreground '#000000'
-    Background '#80d000'
-    Halfground '#70c000'
+    Buttons 2
+    Foreground  '000000cc'
+    Background  '00000022'
+    Basecolor   '80d000'
+    Bordercolor '90e000'
 }
 
 Display Image {
@@ -269,11 +493,21 @@
     Pixel  '4+1'
     Gap    '-1x-1'
     Border 20
-    Foreground '#000000'
-    Background '#80d000'
-    Halfground '#70c000'
+#   Foreground '#000000'
+#   Background '#80d000'
+#   Halfground '#70c000'
+    Foreground '000000cc'
+    Background '00000022'
+    Basecolor  '80d000'
 }
 
+#Plugin KVV {
+#    StationID '12_701'
+#    Refresh 30
+#    Proxy 'igate'
+#    Port 8080;
+#}
+
 Plugin Seti {
     Directory '/root/setiathome-3.08.i686-pc-linux-gnu'
 }
@@ -300,7 +534,8 @@
     expression '*** '.uname('sysname').' '.uname('release').' ***'
     width 20
     align 'M'
-    speed 100	
+    style 'bold'
+    speed 50	
     update tick
 }
 
@@ -310,6 +545,18 @@
     prefix 'CPU '
     width  9
     align  'L'
+    style test::onoff(7)>0?'bold':'norm'
+    update tick
+}
+
+
+Widget CPUinfo {
+    class  'Text'
+    expression  cpuinfo('model name')
+    prefix ''
+    width  20
+    align  'M'
+    speed 100	
     update tick
 }
 
@@ -329,7 +576,7 @@
     expression proc_stat::cpu('busy', 500)
     prefix 'Busy'	
     postfix '%'	
-    width 8	
+    width 9	
     precision 1
     align 'R'	
     update tick	
@@ -645,13 +892,117 @@
     }
 }
 
+Widget Timer {
+    class 'Icon'
+    speed 50
+    Bitmap {
+	Row1 '.....|.....|.....|.....|.....|.....|.....|.....|.....|.....|.....|.....|.....|.....|.....|.....|.....|.....|.....|.....|.....|.....|.....|.....|'
+	Row2 '.***.|.*+*.|.*++.|.*++.|.*++.|.*++.|.*++.|.*++.|.*++.|.*++.|.*++.|.*++.|.+++.|.+*+.|.+**.|.+**.|.+**.|.+**.|.+**.|.+**.|.+**.|.+**.|.+**.|.+**.|'
+	Row3 '*****|**+**|**++*|**+++|**++.|**++.|**+++|**+++|**+++|**+++|**+++|+++++|+++++|++*++|++**+|++***|++**.|++**.|++***|++***|++***|++***|++***|*****|'
+	Row4 '*****|**+**|**+**|**+**|**+++|**+++|**+++|**+++|**+++|**+++|+++++|+++++|+++++|++*++|++*++|++*++|++***|++***|++***|++***|++***|++***|*****|*****|'
+	Row5 '*****|*****|*****|*****|*****|***++|***++|**+++|*++++|+++++|+++++|+++++|+++++|+++++|+++++|+++++|+++++|+++**|+++**|++***|+****|*****|*****|*****|'
+	Row6 '.***.|.***.|.***.|.***.|.***.|.***.|.**+.|.*++.|.+++.|.+++.|.+++.|.+++.|.+++.|.+++.|.+++.|.+++.|.+++.|.+++.|.++*.|.+**.|.***.|.***.|.***.|.***.|'
+	Row7 '.....|.....|.....|.....|.....|.....|.....|.....|.....|.....|.....|.....|.....|.....|.....|.....|.....|.....|.....|.....|.....|.....|.....|.....|'
+	Row8 '.....|.....|.....|.....|.....|.....|.....|.....|.....|.....|.....|.....|.....|.....|.....|.....|.....|.....|.....|.....|.....|.....|.....|.....|'
+
+
+    }
+}
+
 Widget Test {
     class 'Text'
     expression '1234567890123456789012345678901234567890'
-    #expression '|'
     width 40
+    foreground 'ff0000ff'
+}
+
+Widget Test1 {
+    class 'Text'
+    expression 'ABCDEFGHIJKLMNOPQRSTUVWXYZ1234567890'
+    width 40
+    align 'M'
+    speed 100
+}
+
+Widget Test2 {
+    class 'Text'
+    expression '1234567890abcdefghijklmnopqrstuvwxyz'
+    width 40
+    align 'M'
+    speed 150
 }
 
+Widget GPO_Val1 {
+    class 'Text'
+    expression LCD::GPO(1)
+    prefix 'GPO#1'
+    width 10
+    precision 0
+    align 'R'
+    update tick
+}
+
+Widget GPI_Val1 {
+    class 'Text'
+    expression LCD::GPI(1)
+    prefix 'GPI#1'
+    width 10
+    precision 0
+    align 'R'
+    update tick
+}
+
+Widget GPO_Val4 {
+    class 'Text'
+    expression LCD::GPO(4)
+    prefix 'GPO#4'
+    width 10
+    precision 0
+    align 'R'
+    update tick
+}
+
+Widget GPO_Test1 {
+    class 'GPO'
+    expression 255*test::onoff(1)
+    update 300
+}
+
+Widget GPO_Test255 {
+    class 'GPO'
+    expression test::bar(0,255, 0, 1)
+    update 100
+}
+
+Widget ImageTest {
+    class 'Image'
+    file 'tux.png'
+    update 1000
+    visible 1
+    inverted 0
+}
+
+Widget KVV {
+    class 'Text'
+    expression kvv::line(0).' '.kvv::station(0)
+    width 11
+
+    align 'L'
+    update tick
+    Foreground 'ffff00'
+    style 'bold'
+}
+
+Widget KVV_TIME {
+    class 'Text'
+    expression kvv::time_str(0)
+    width 2
+
+    align 'R'
+    update tick
+    foreground kvv::time(0) < 2 ? 'FF0000' : ( kvv::time(0) < 5 ? 'FFFF00' : '00FF00' )
+    style 'bold'
+}
 
 Layout Default {
     Row1 {
@@ -663,7 +1014,34 @@
     }
     Row3 {
 	Col1  'Busy'
-#	Col10 'Rain'
+	Col10 'Rain'
+	Col11 'BusyBar'
+    }
+    Row4 {
+	Col1 'Load'
+	Col11 'LoadBar'
+    }
+    Row5 {
+	Col1  'Disk'
+	Col11 'DiskBar'
+    }
+    Row6 {
+	Col1  'Eth0'
+	Col11 'Eth0Bar'
+    }
+}
+
+Layout TestLayer {
+    Row1 {
+	Col1  'OS'
+    }
+    Row2 {
+	Col1  'CPU'
+	Col10 'RAM'
+    }
+    Row3 {
+	Col1  'Busy'
+	Col10 'Rain'
 	Col11 'BusyBar'
     }
     Row4 {
@@ -678,6 +1056,15 @@
 	Col1  'Eth0'
 	Col11 'Eth0Bar'
     }
+    Layer 2 {
+	X1.Y1 'ImageTest'
+    }
+}
+
+Layout TestImage {
+    Layer 2 {
+	X1.Y1 'ImageTest'
+    }
 }
 
 Layout L24x8 {
@@ -698,6 +1085,13 @@
     }
 }
 
+Layout L16x1 {
+    Row1 {
+	Col1  'Busy'
+	Col11 'BusyBar'
+    }
+}
+
 Layout L16x2 {
     Row1 {
 	Col1  'Busy'
@@ -712,35 +1106,86 @@
 
 Layout L20x2 {
     Row1 {
+        Col1  'CPUinfo'
+    }
+    Row2 {
 	Col1  'Busy'
 	Col11 'BusyBar'
     }
+}
+
+Layout L40x2 {
+    Row1 {
+	Col1  'OS'
+	Col21  'Busy'
+	Col31 'BusyBar'
+    }
     Row2 {
-	Col1 'Load'
-	Col11 'LoadBar'
+	Col1  'CPU'
+	Col10 'RAM'
+	Col21 'Load'
+	Col31 'LoadBar'
     }
 }
 
 Layout Test {
-    Row01.Col1 'Test'
-    Row02.Col1 'Test'
-    Row03.Col1 'Test'
-    Row04.Col1 'Test'
-    Row05.Col1 'Test'
-    Row06.Col1 'Test'
-    Row07.Col1 'Test'
-    Row08.Col1 'Test'
-#    Row09.Col1 'Test'
-#    Row10.Col1 'Test'
-#    Row11.Col1 'Test'
-#    Row12.Col1 'Test'
-#    Row13.Col1 'Test'
-#    Row14.Col1 'Test'
-#    Row15.Col1 'Test'
-#    Row16.Col1 'Test'
+    Row01.Col1 'Test1'
+    Row02.Col1 'Test1'
+    Row03.Col1 'Test1'
+    Row04.Col1 'Test1'
+    Row05.Col1 'Test1'
+    Row06.Col1 'Test1'
+    Row07.Col1 'Test1'
+    Row08.Col1 'Test1'
+    Row09.Col1 'Test1'
+    Row10.Col1 'Test1'
+    Row11.Col1 'Test1'
+    Row12.Col1 'Test1'
+    Row13.Col1 'Test1'
+    Row14.Col1 'Test1'
+    Row15.Col1 'Test1'
+    Row16.Col1 'Test1'
+    Row17.Col1 'Test1'
+    Row18.Col1 'Test1'
+    Row19.Col1 'Test1'
+    Row20.Col1 'Test1'
+    Row21.Col1 'Test1'
+    Row22.Col1 'Test1'
+    Row23.Col1 'Test1'
+    Row24.Col1 'Test1'
+}
+
+Layout Test2 {
+    Row01.Col1 'Test1'
+    #Row02.Col1 'Rain'
+    Row02.Col1 'Test2'
+    Row03.Col1 'Test1'
+    Row04.Col1 'Test2'
+    Row05.Col1 'Test1'
+    Row06.Col1 'Test2'
+    Row07.Col1 'Test1'
+    Row08.Col1 'Test2'
+}
+
+Layout TestGPO {
+    Row1.Col1  'GPO_Val1'
+    Row1.Col10 'GPI_Val1'
+    Row2.Col1  'GPO_Val4'
+    GPO1       'GPO_Test255'
+    GPO4       'GPO_Test1'
+}
+
+Layout TestIcons {
+    Row1.Col1 'Timer'
+    Row1.Col2 'Rain'
+    Row1.Col3 'Squirrel'
+    Row1.Col4 'Wave'
+    Row1.Col5 'Blob'
+    Row1.Col6 'Heart'
+    Row1.Col7 'Karo'
+    Row1.Col8 'EKG'
 }
 
-
 Layout testMySQL {
 	Row1 {
 		Col1 'MySQLtest1'
@@ -750,38 +1195,60 @@
 	}
 }
 
+Layout Debug {
+    #Row09.Col1 'Test'
+    Row09.Col1 'Heartbeat'
+}
+
+
 
 #Display 'SerDispLib'
 #Display 'LCD-Linux'
+#Display 'LCD2041'
+#Display 'LK202'
 #Display 'LK204'
 #Display 'MI240'
 #Display 'CW12232'
 #Display 'HD44780-generic'
+#Display 'HD44780-WinAmp'
+#Display 'HD44780-4bit'
+#Display 'WDC2704M'
 #Display 'SC1602D'
 #Display 'LCM-162'
 #Display 'CF631'
 #Display 'CF632'
 #Display 'CF633'
 #Display 'Curses'
-Display 'M50530-24x8'
+#Display 'M50530-24x8'
 #Display 'LCDTerm'
+#Display 'SimpleLCD'
+#Display 'BA63'
 #Display 'CT20x4'
 #Display 'T6963-240x64'
+#Display 'T6963-240x128'
+#Display 'T6963-240x128D'
 #Display 'XWindow'
+#Display 'IRLCD'
 #Display 'USBLCD'
 #Display 'BWCT'
 #Display 'Image'
 #Display 'Trefon'
-
-#Layout  'Default'
-Layout 'L8x2'
+#Display 'LCD2USB'
+#Display 'LPH7508-serdisplib'
+#Display 'LPH7508'
+#Display 'ctinclud'
+Display 'picoLCD'
+
+#Layout 'Default'
+#Layout 'TestLayer'
+#Layout 'TestImage'
+#Layout 'L8x2'
+#Layout 'L16x1'
 #Layout 'L16x2'
-#Layout 'L20x2'
+Layout 'L20x2'
+#Layout 'L40x2'
 #Layout 'Test'
-
-
-Variables {
-   tick 500
-   tack 100
-   minute 60000
-}
+#Layout 'Test2'
+#Layout 'TestGPO'
+#Layout 'Debug'
+#Layout 'TestIcons'
diff -urN lcd4linux-0.10.0/lcd4linux_i2c.h lcd4linux-0.11.0-SVN/lcd4linux_i2c.h
--- lcd4linux-0.10.0/lcd4linux_i2c.h	2005-06-01 14:09:13.000000000 +0200
+++ lcd4linux-0.11.0-SVN/lcd4linux_i2c.h	2008-12-31 08:05:54.000000000 +0100
@@ -1,4 +1,5 @@
-/* $Id: lcd4linux_i2c.h,v 1.2 2005/06/01 12:09:13 reinelt Exp $
+/* $Id: lcd4linux_i2c.h 728 2007-01-14 11:14:38Z michael $
+ * $URL: https://ssl.bulix.org/svn/lcd4linux/trunk/lcd4linux_i2c.h $
  *
  * user space i2c sturctures and defines, taken from the official kernel i2c 
  * includes to solve the problem when compiling user space application
@@ -30,19 +31,6 @@
  * along with this program; if not, write to the Free Software
  * Foundation, Inc., 675 Mass Ave, Cambridge, MA 02139, USA.
  *
- *
- * $Log: lcd4linux_i2c.h,v $
- * Revision 1.2  2005/06/01 12:09:13  reinelt
- * removed ^M from lcd4linux_i2c.h; indent.sh run
- *
- * Revision 1.1  2005/05/31 20:42:55  lfcorreia
- * new file: lcd4linux_i2c.h
- * avoid the problems detecting the proper I2C kernel include files
- *
- * rearrange all the other autoconf stuff to remove I2C detection
- *
- * new method by Paul Kamphuis to write to the I2C device
- *
  */
 
 #ifndef _LCD4LINUX_I2C_H
@@ -78,7 +66,7 @@
 
 /* Transfer num messages.
  */
-extern int i2c_transfer(struct i2c_adapter *adap, struct i2c_msg msg[], int num);
+extern int i2c_transfer(struct i2c_adapter *adap, struct i2c_msg *msg, int num);
 
 /*
  * Some adapter types (i.e. PCF 8584 based ones) may support slave behaviuor. 
@@ -214,7 +202,8 @@
  * It will only call found_proc if some client is connected at the
  * specific address (unless a 'force' matched);
  */
-extern int i2c_probe(struct i2c_adapter *adapter, struct i2c_client_address_data *address_data, int (*found_proc) (struct i2c_adapter *, int, int));
+extern int i2c_probe(struct i2c_adapter *adapter, struct i2c_client_address_data *address_data,
+		     int (*found_proc) (struct i2c_adapter *, int, int));
 
 /* An ioctl like call to set div. parameters of the adapter.
  */
diff -urN lcd4linux-0.10.0/lcd4linux.lsm lcd4linux-0.11.0-SVN/lcd4linux.lsm
--- lcd4linux-0.10.0/lcd4linux.lsm	2000-03-30 18:46:57.000000000 +0200
+++ lcd4linux-0.11.0-SVN/lcd4linux.lsm	2008-12-31 08:05:54.000000000 +0100
@@ -5,8 +5,8 @@
 Description:    system and ISDN information is shown on
                 an external display or in a X11 window.
 Keywords:       LCD 
-Author:         reinelt@eunet.at (Michael Reinelt)
-Maintained-by:  reinelt@eunet.at (Michael Reinelt)
+Author:         michael@reinelt.co.at (Michael Reinelt)
+Maintained-by:  michael@reinelt.co.at (Michael Reinelt)
 Primary-site:   download.sourceforge.net /pub/sourceforge/lcd4linux
                 54k lcd4linux-0.95.tar.gz
 Alternate-site: http://lcd4linux.sourceforge.net
diff -urN lcd4linux-0.10.0/lcd4linux.xpm lcd4linux-0.11.0-SVN/lcd4linux.xpm
--- lcd4linux-0.10.0/lcd4linux.xpm	2005-01-18 07:10:08.000000000 +0100
+++ lcd4linux-0.11.0-SVN/lcd4linux.xpm	2008-12-31 08:05:54.000000000 +0100
@@ -1,7 +1,7 @@
 /* XPM */
 
 /*
- * Copyright 1999 Michael Reinelt <reinelt@eunet.at>
+ * Copyright 1999 Michael Reinelt <michael@reinelt.co.at>
  * Copyright 2004 The LCD4Linux Team <lcd4linux-devel@users.sourceforge.net>
  *
  * This file is part of LCD4Linux.
diff -urN lcd4linux-0.10.0/Makefile.am lcd4linux-0.11.0-SVN/Makefile.am
--- lcd4linux-0.10.0/Makefile.am	2005-06-10 06:59:31.000000000 +0200
+++ lcd4linux-0.11.0-SVN/Makefile.am	2009-01-11 18:26:41.000000000 +0100
@@ -1,3 +1,6 @@
+# $Id: Makefile.am 936 2009-01-01 08:27:44Z michael $
+# $URL: https://ssl.bulix.org/svn/lcd4linux/trunk/Makefile.am $
+
 # Process this file with automake to produce Makefile.in
 
 AUTOMAKE_OPTIONS = gnu
@@ -7,115 +10,168 @@
 
 bin_PROGRAMS = lcd4linux
 
-AM_CFLAGS = -D_GNU_SOURCE -Wall -W
+# Fixme: -W should be renamed to -Wextra someday...
+AM_CFLAGS = -D_GNU_SOURCE -Wall -W -fno-strict-aliasing
+
+# use this for lots of warnings
+#AM_CFLAGS = -D_GNU_SOURCE -std=c99 -m64 -Wall -W -pedantic -Wno-variadic-macros -fno-strict-aliasing
 
-lcd4linux_LDFLAGS = 
+lcd4linux_LDFLAGS =
 lcd4linux_LDADD   = @DRIVERS@ @PLUGINS@ @DRVLIBS@ @PLUGINLIBS@
 lcd4linux_DEPENDENCIES = @DRIVERS@ @PLUGINS@
 
-lcd4linux_SOURCES =         \
-lcd4linux.c                 \
-cfg.c         cfg.h         \
-debug.c       debug.h       \
-drv.c         drv.h         \
-evaluator.c   evaluator.h   \
-hash.c        hash.h        \
-layout.c      layout.h      \
-pid.c         pid.h         \
-timer.c       timer.h       \
-thread.c      thread.h      \
-udelay.c      udelay.h      \
-qprintf.c     qprintf.h     \
-                            \
-widget.c      widget.h      \
-widget_text.c widget_text.h \
-widget_bar.c  widget_bar.h  \
-widget_icon.c widget_icon.h \
-                            \
-plugin.c      plugin.h      \
-plugin_cfg.c                \
-plugin_math.c               \
-plugin_string.c             \
-plugin_test.c               \
+lcd4linux_SOURCES =           \
+lcd4linux.c   svn_version.h   \
+cfg.c         cfg.h           \
+debug.c       debug.h         \
+drv.c         drv.h           \
+drv_generic.c drv_generic.h   \
+evaluator.c   evaluator.h     \
+property.c    property.h      \
+hash.c        hash.h          \
+layout.c      layout.h        \
+pid.c         pid.h           \
+timer.c       timer.h         \
+thread.c      thread.h        \
+udelay.c      udelay.h        \
+qprintf.c     qprintf.h       \
+rgb.c         rgb.h           \
+                              \
+widget.c      widget.h        \
+widget_text.c widget_text.h   \
+widget_bar.c  widget_bar.h    \
+widget_icon.c widget_icon.h   \
+widget_keypad.c widget_keypad.h \
+widget_timer.c widget_timer.h \
+widget_gpo.c  widget_gpo.h    \
+                              \
+plugin.c      plugin.h        \
+plugin_cfg.c                  \
+plugin_math.c                 \
+plugin_string.c               \
+plugin_test.c                 \
 plugin_time.c
 
-EXTRA_lcd4linux_SOURCES=    \
-drv_generic_text.c          \
-drv_generic_text.h          \
-drv_generic_graphic.c       \
-drv_generic_graphic.h       \
-drv_generic_serial.c        \
-drv_generic_serial.h        \
-drv_generic_parport.c       \
-drv_generic_parport.h       \
-drv_generic_i2c.c           \
-drv_generic_i2c.h           \
-drv_BeckmannEgle.c          \
-drv_BWCT.c                  \
-drv_Crystalfontz.c          \
-drv_Curses.c                \
-drv_Cwlinux.c               \
-drv_HD44780.c               \
-drv_Image.c                 \
-drv_LCDLinux.c              \
-drv_LCDLinux.h              \
-drv_LCDTerm.c               \
-drv_M50530.c                \
-drv_MatrixOrbital.c         \
-drv_MilfordInstruments.c    \
-drv_Noritake.c              \
-drv_NULL.c                  \
-drv_RouterBoard.c           \
-drv_serdisplib.c            \
-drv_SimpleLCD.c             \
-drv_T6963.c                 \
-drv_Trefon.c                \
-drv_USBLCD.c                \
-drv_X11.c                   \
-                            \
-font_6x8.h                  \
-                            \
-lcd4linux_i2c.h             \
-                            \
-plugin_apm.c                \
-plugin_cpuinfo.c            \
-plugin_diskstats.c          \
-plugin_dvb.c                \
-plugin_exec.c               \
-plugin_i2c_sensors.c        \
-plugin_imon.c               \
-plugin_isdn.c               \
-plugin_loadavg.c            \
-plugin_meminfo.c            \
-plugin_mysql.c              \
-plugin_netdev.c             \
-plugin_pop3.c               \
-plugin_ppp.c                \
-plugin_proc_stat.c          \
-plugin_python.c             \
-plugin_seti.c               \
-plugin_statfs.c             \
-plugin_uname.c              \
-plugin_uptime.c             \
-plugin_wireless.c           \
+EXTRA_lcd4linux_SOURCES=      \
+drv_generic_text.c            \
+drv_generic_text.h            \
+drv_generic_graphic.c         \
+drv_generic_graphic.h         \
+drv_generic_gpio.c            \
+drv_generic_gpio.h            \
+drv_generic_serial.c          \
+drv_generic_serial.h          \
+drv_generic_parport.c         \
+drv_generic_parport.h         \
+drv_generic_i2c.c             \
+drv_generic_i2c.h             \
+drv_generic_keypad.c          \
+drv_generic_keypad.h          \
+drv_BeckmannEgle.c            \
+drv_BWCT.c                    \
+drv_Crystalfontz.c            \
+drv_Curses.c                  \
+drv_Cwlinux.c                 \
+drv_D4D.c                     \
+drv_EA232graphic.c            \
+drv_G15.c                     \
+drv_HD44780.c                 \
+drv_Image.c                   \
+drv_IRLCD.c                   \
+drv_LCD2USB.c                 \
+drv_LCDLinux.c                \
+drv_LCDTerm.c                 \
+drv_LEDMatrix.c               \
+drv_LPH7508.c                 \
+drv_LUIse.c                   \
+drv_M50530.c                  \
+drv_MatrixOrbital.c           \
+drv_MilfordInstruments.c      \
+drv_Noritake.c                \
+drv_NULL.c                    \
+drv_Pertelian.c               \
+drv_PHAnderson.c              \
+drv_picoLCD.c                 \
+drv_picoLCDGraphic.c          \
+drv_RouterBoard.c             \
+drv_Sample.c                  \
+drv_st2205.c                  \
+drv_serdisplib.c              \
+drv_SimpleLCD.c               \
+drv_T6963.c                   \
+drv_Trefon.c                  \
+drv_ula200.c                  \
+drv_USBHUB.c                  \
+drv_USBLCD.c                  \
+drv_WincorNixdorf.c           \
+drv_X11.c                     \
+                              \
+font_6x8.h                    \
+font_6x8_bold.h               \
+widget_image.c widget_image.h \
+                              \
+lcd4linux_i2c.h               \
+                              \
+plugin_apm.c                  \
+plugin_asterisk.c             \
+plugin_button_exec.c          \
+plugin_cpuinfo.c              \
+plugin_diskstats.c            \
+plugin_dvb.c                  \
+plugin_exec.c                 \
+plugin_fifo.c                 \
+plugin_file.c                 \
+plugin_gps.c                  \
+plugin_hddtemp.c              \
+plugin_i2c_sensors.c          \
+plugin_iconv.c                \
+plugin_imon.c                 \
+plugin_isdn.c                 \
+plugin_kvv.c                  \
+plugin_loadavg.c              \
+plugin_meminfo.c              \
+plugin_mpd.c		      \
+plugin_mysql.c                \
+plugin_netdev.c               \
+plugin_netinfo.c              \
+plugin_pop3.c                 \
+plugin_ppp.c                  \
+plugin_proc_stat.c            \
+plugin_python.c               \
+plugin_sample.c               \
+plugin_seti.c                 \
+plugin_statfs.c               \
+plugin_uname.c                \
+plugin_uptime.c               \
+plugin_w1retap.c	      \
+plugin_wireless.c             \
 plugin_xmms.c
 
 
-EXTRA_DIST =                \
-lcd4linux.conf.sample       \
-lcd4kde.conf                \
-lcd4linux.kdelnk            \
-lcd4linux.xpm               \
-lcd4linux.lsm               \
-curses.m4                   \
-AUTHORS                     \
-CREDITS                     \
-FAQ                         \
-NEWS                        \
-TODO                        \
-README                      \
-README.Drivers              \
-README.Plugins              \
-README.KDE                  \
+EXTRA_DIST =                  \
+svn_version.sh                \
+lcd4linux.conf.sample         \
+lcd4kde.conf                  \
+lcd4linux.kdelnk              \
+lcd4linux.xpm                 \
+lcd4linux.lsm                 \
+ac_python_devel.m4            \
+curses.m4                     \
+drivers.m4                    \
+plugins.m4                    \
+AUTHORS                       \
+CREDITS                       \
+NEWS                          \
+TODO                          \
+README                        \
 plugin_sample.c
 
+
+
+# create subversion version
+
+.PHONY: svn_version
+
+svn_version:
+	svn_version.sh
+
diff -urN lcd4linux-0.10.0/Makefile.in lcd4linux-0.11.0-SVN/Makefile.in
--- lcd4linux-0.10.0/Makefile.in	2005-06-11 06:14:50.000000000 +0200
+++ lcd4linux-0.11.0-SVN/Makefile.in	2009-01-15 06:43:05.000000000 +0100
@@ -1,6 +1,8 @@
-# Makefile.in generated automatically by automake 1.4-p6 from Makefile.am
+# Makefile.in generated by automake 1.10.1 from Makefile.am.
+# @configure_input@
 
-# Copyright (C) 1994, 1995-8, 1999, 2001 Free Software Foundation, Inc.
+# Copyright (C) 1994, 1995, 1996, 1997, 1998, 1999, 2000, 2001, 2002,
+# 2003, 2004, 2005, 2006, 2007, 2008  Free Software Foundation, Inc.
 # This Makefile.in is free software; the Free Software Foundation
 # gives unlimited permission to copy and/or distribute it,
 # with or without modifications, as long as this notice is preserved.
@@ -10,526 +12,863 @@
 # even the implied warranty of MERCHANTABILITY or FITNESS FOR A
 # PARTICULAR PURPOSE.
 
-# Process this file with automake to produce Makefile.in
+@SET_MAKE@
 
+# $Id: Makefile.am 936 2009-01-01 08:27:44Z michael $
+# $URL: https://ssl.bulix.org/svn/lcd4linux/trunk/Makefile.am $
 
-SHELL = @SHELL@
+# Process this file with automake to produce Makefile.in
 
-srcdir = @srcdir@
-top_srcdir = @top_srcdir@
 VPATH = @srcdir@
-prefix = @prefix@
-exec_prefix = @exec_prefix@
-
-bindir = @bindir@
-sbindir = @sbindir@
-libexecdir = @libexecdir@
-datadir = @datadir@
-sysconfdir = @sysconfdir@
-sharedstatedir = @sharedstatedir@
-localstatedir = @localstatedir@
-libdir = @libdir@
-infodir = @infodir@
-mandir = @mandir@
-includedir = @includedir@
-oldincludedir = /usr/include
-
-DESTDIR =
-
 pkgdatadir = $(datadir)/@PACKAGE@
 pkglibdir = $(libdir)/@PACKAGE@
 pkgincludedir = $(includedir)/@PACKAGE@
-
-top_builddir = .
-
-ACLOCAL = @ACLOCAL@
-AUTOCONF = @AUTOCONF@
-AUTOMAKE = @AUTOMAKE@
-AUTOHEADER = @AUTOHEADER@
-
-INSTALL = @INSTALL@
-INSTALL_PROGRAM = @INSTALL_PROGRAM@ $(AM_INSTALL_PROGRAM_FLAGS)
-INSTALL_DATA = @INSTALL_DATA@
-INSTALL_SCRIPT = @INSTALL_SCRIPT@
-transform = @program_transform_name@
-
+am__cd = CDPATH="$${ZSH_VERSION+.}$(PATH_SEPARATOR)" && cd
+install_sh_DATA = $(install_sh) -c -m 644
+install_sh_PROGRAM = $(install_sh) -c
+install_sh_SCRIPT = $(install_sh) -c
+INSTALL_HEADER = $(INSTALL_DATA)
+transform = $(program_transform_name)
 NORMAL_INSTALL = :
 PRE_INSTALL = :
 POST_INSTALL = :
 NORMAL_UNINSTALL = :
 PRE_UNINSTALL = :
 POST_UNINSTALL = :
-host_alias = @host_alias@
+build_triplet = @build@
 host_triplet = @host@
+bin_PROGRAMS = lcd4linux$(EXEEXT)
+subdir = .
+DIST_COMMON = README $(am__configure_deps) $(srcdir)/Makefile.am \
+	$(srcdir)/Makefile.in $(srcdir)/config.h.in \
+	$(top_srcdir)/configure AUTHORS COPYING ChangeLog INSTALL NEWS \
+	TODO config.guess config.rpath config.sub depcomp install-sh \
+	missing mkinstalldirs
+ACLOCAL_M4 = $(top_srcdir)/aclocal.m4
+am__aclocal_m4_deps = $(top_srcdir)/curses.m4 \
+	$(top_srcdir)/ac_python_devel.m4 $(top_srcdir)/drivers.m4 \
+	$(top_srcdir)/plugins.m4 $(top_srcdir)/configure.in
+am__configure_deps = $(am__aclocal_m4_deps) $(CONFIGURE_DEPENDENCIES) \
+	$(ACLOCAL_M4)
+am__CONFIG_DISTCLEAN_FILES = config.status config.cache config.log \
+ configure.lineno config.status.lineno
+mkinstalldirs = $(SHELL) $(top_srcdir)/mkinstalldirs
+CONFIG_HEADER = config.h
+CONFIG_CLEAN_FILES =
+am__installdirs = "$(DESTDIR)$(bindir)"
+binPROGRAMS_INSTALL = $(INSTALL_PROGRAM)
+PROGRAMS = $(bin_PROGRAMS)
+am_lcd4linux_OBJECTS = lcd4linux.$(OBJEXT) cfg.$(OBJEXT) \
+	debug.$(OBJEXT) drv.$(OBJEXT) drv_generic.$(OBJEXT) \
+	evaluator.$(OBJEXT) property.$(OBJEXT) hash.$(OBJEXT) \
+	layout.$(OBJEXT) pid.$(OBJEXT) timer.$(OBJEXT) \
+	thread.$(OBJEXT) udelay.$(OBJEXT) qprintf.$(OBJEXT) \
+	rgb.$(OBJEXT) widget.$(OBJEXT) widget_text.$(OBJEXT) \
+	widget_bar.$(OBJEXT) widget_icon.$(OBJEXT) \
+	widget_keypad.$(OBJEXT) widget_timer.$(OBJEXT) \
+	widget_gpo.$(OBJEXT) plugin.$(OBJEXT) plugin_cfg.$(OBJEXT) \
+	plugin_math.$(OBJEXT) plugin_string.$(OBJEXT) \
+	plugin_test.$(OBJEXT) plugin_time.$(OBJEXT)
+lcd4linux_OBJECTS = $(am_lcd4linux_OBJECTS)
+lcd4linux_LINK = $(CCLD) $(AM_CFLAGS) $(CFLAGS) $(lcd4linux_LDFLAGS) \
+	$(LDFLAGS) -o $@
+DEFAULT_INCLUDES = -I.@am__isrc@
+depcomp = $(SHELL) $(top_srcdir)/depcomp
+am__depfiles_maybe = depfiles
+COMPILE = $(CC) $(DEFS) $(DEFAULT_INCLUDES) $(INCLUDES) $(AM_CPPFLAGS) \
+	$(CPPFLAGS) $(AM_CFLAGS) $(CFLAGS)
+CCLD = $(CC)
+LINK = $(CCLD) $(AM_CFLAGS) $(CFLAGS) $(AM_LDFLAGS) $(LDFLAGS) -o $@
+SOURCES = $(lcd4linux_SOURCES) $(EXTRA_lcd4linux_SOURCES)
+DIST_SOURCES = $(lcd4linux_SOURCES) $(EXTRA_lcd4linux_SOURCES)
+ETAGS = etags
+CTAGS = ctags
+DISTFILES = $(DIST_COMMON) $(DIST_SOURCES) $(TEXINFOS) $(EXTRA_DIST)
+distdir = $(PACKAGE)-$(VERSION)
+top_distdir = $(distdir)
+am__remove_distdir = \
+  { test ! -d $(distdir) \
+    || { find $(distdir) -type d ! -perm -200 -exec chmod u+w {} ';' \
+         && rm -fr $(distdir); }; }
+DIST_ARCHIVES = $(distdir).tar.gz
+GZIP_ENV = --best
+distuninstallcheck_listfiles = find . -type f -print
+distcleancheck_listfiles = find . -type f -print
+ACLOCAL = @ACLOCAL@
+AMTAR = @AMTAR@
+AUTOCONF = @AUTOCONF@
+AUTOHEADER = @AUTOHEADER@
+AUTOMAKE = @AUTOMAKE@
+AWK = @AWK@
 CC = @CC@
+CCDEPMODE = @CCDEPMODE@
+CFLAGS = @CFLAGS@
 CPP = @CPP@
+CPPFLAGS = @CPPFLAGS@
 CURSES_INCLUDEDIR = @CURSES_INCLUDEDIR@
 CURSES_LIBS = @CURSES_LIBS@
+CYGPATH_W = @CYGPATH_W@
+DEFS = @DEFS@
+DEPDIR = @DEPDIR@
+DRIVERS = @DRIVERS@
 DRVLIBS = @DRVLIBS@
-HAVE_LIB = @HAVE_LIB@
-LIB = @LIB@
+ECHO_C = @ECHO_C@
+ECHO_N = @ECHO_N@
+ECHO_T = @ECHO_T@
+EGREP = @EGREP@
+EXEEXT = @EXEEXT@
+GREP = @GREP@
+INSTALL = @INSTALL@
+INSTALL_DATA = @INSTALL_DATA@
+INSTALL_PROGRAM = @INSTALL_PROGRAM@
+INSTALL_SCRIPT = @INSTALL_SCRIPT@
+INSTALL_STRIP_PROGRAM = @INSTALL_STRIP_PROGRAM@
+LDFLAGS = @LDFLAGS@
+LIBICONV = @LIBICONV@
+LIBOBJS = @LIBOBJS@
+LIBS = @LIBS@
 LN_S = @LN_S@
-LTLIB = @LTLIB@
+LTLIBICONV = @LTLIBICONV@
+LTLIBOBJS = @LTLIBOBJS@
 MAKEINFO = @MAKEINFO@
+MKDIR_P = @MKDIR_P@
+OBJEXT = @OBJEXT@
 PACKAGE = @PACKAGE@
+PACKAGE_BUGREPORT = @PACKAGE_BUGREPORT@
+PACKAGE_NAME = @PACKAGE_NAME@
+PACKAGE_STRING = @PACKAGE_STRING@
+PACKAGE_TARNAME = @PACKAGE_TARNAME@
+PACKAGE_VERSION = @PACKAGE_VERSION@
+PATH_SEPARATOR = @PATH_SEPARATOR@
 PLUGINLIBS = @PLUGINLIBS@
+PLUGINS = @PLUGINS@
+POW_LIB = @POW_LIB@
 PYTHON = @PYTHON@
 PYTHON_CPPFLAGS = @PYTHON_CPPFLAGS@
-PYTHON_EXEC_PREFIX = @PYTHON_EXEC_PREFIX@
+PYTHON_EXTRA_LDFLAGS = @PYTHON_EXTRA_LDFLAGS@
 PYTHON_EXTRA_LIBS = @PYTHON_EXTRA_LIBS@
 PYTHON_LDFLAGS = @PYTHON_LDFLAGS@
-PYTHON_PLATFORM = @PYTHON_PLATFORM@
-PYTHON_PREFIX = @PYTHON_PREFIX@
 PYTHON_SITE_PKG = @PYTHON_SITE_PKG@
 PYTHON_VERSION = @PYTHON_VERSION@
+SET_MAKE = @SET_MAKE@
+SHELL = @SHELL@
+STRIP = @STRIP@
 VERSION = @VERSION@
-pkgpyexecdir = @pkgpyexecdir@
-pkgpythondir = @pkgpythondir@
-pyexecdir = @pyexecdir@
-pythondir = @pythondir@
-
+XMKMF = @XMKMF@
+X_CFLAGS = @X_CFLAGS@
+X_EXTRA_LIBS = @X_EXTRA_LIBS@
+X_LIBS = @X_LIBS@
+X_PRE_LIBS = @X_PRE_LIBS@
+abs_builddir = @abs_builddir@
+abs_srcdir = @abs_srcdir@
+abs_top_builddir = @abs_top_builddir@
+abs_top_srcdir = @abs_top_srcdir@
+ac_ct_CC = @ac_ct_CC@
+am__include = @am__include@
+am__leading_dot = @am__leading_dot@
+am__quote = @am__quote@
+am__tar = @am__tar@
+am__untar = @am__untar@
+bindir = @bindir@
+build = @build@
+build_alias = @build_alias@
+build_cpu = @build_cpu@
+build_os = @build_os@
+build_vendor = @build_vendor@
+builddir = @builddir@
+datadir = @datadir@
+datarootdir = @datarootdir@
+docdir = @docdir@
+dvidir = @dvidir@
+exec_prefix = @exec_prefix@
+host = @host@
+host_alias = @host_alias@
+host_cpu = @host_cpu@
+host_os = @host_os@
+host_vendor = @host_vendor@
+htmldir = @htmldir@
+includedir = @includedir@
+infodir = @infodir@
+install_sh = @install_sh@
+libdir = @libdir@
+libexecdir = @libexecdir@
+localedir = @localedir@
+localstatedir = @localstatedir@
+mandir = @mandir@
+mkdir_p = @mkdir_p@
+oldincludedir = @oldincludedir@
+pdfdir = @pdfdir@
+prefix = @prefix@
+program_transform_name = @program_transform_name@
+psdir = @psdir@
+sbindir = @sbindir@
+sharedstatedir = @sharedstatedir@
+srcdir = @srcdir@
+sysconfdir = @sysconfdir@
+target_alias = @target_alias@
+top_builddir = @top_builddir@
+top_srcdir = @top_srcdir@
 AUTOMAKE_OPTIONS = gnu
 CLEANFILES = *~
-DRIVERS = @DRIVERS@
-PLUGINS = @PLUGINS@
 
-bin_PROGRAMS = lcd4linux
-
-AM_CFLAGS = -D_GNU_SOURCE -Wall -W
+# Fixme: -W should be renamed to -Wextra someday...
+AM_CFLAGS = -D_GNU_SOURCE -Wall -W -fno-strict-aliasing
 
+# use this for lots of warnings
+#AM_CFLAGS = -D_GNU_SOURCE -std=c99 -m64 -Wall -W -pedantic -Wno-variadic-macros -fno-strict-aliasing
 lcd4linux_LDFLAGS = 
 lcd4linux_LDADD = @DRIVERS@ @PLUGINS@ @DRVLIBS@ @PLUGINLIBS@
 lcd4linux_DEPENDENCIES = @DRIVERS@ @PLUGINS@
+lcd4linux_SOURCES = \
+lcd4linux.c   svn_version.h   \
+cfg.c         cfg.h           \
+debug.c       debug.h         \
+drv.c         drv.h           \
+drv_generic.c drv_generic.h   \
+evaluator.c   evaluator.h     \
+property.c    property.h      \
+hash.c        hash.h          \
+layout.c      layout.h        \
+pid.c         pid.h           \
+timer.c       timer.h         \
+thread.c      thread.h        \
+udelay.c      udelay.h        \
+qprintf.c     qprintf.h       \
+rgb.c         rgb.h           \
+                              \
+widget.c      widget.h        \
+widget_text.c widget_text.h   \
+widget_bar.c  widget_bar.h    \
+widget_icon.c widget_icon.h   \
+widget_keypad.c widget_keypad.h \
+widget_timer.c widget_timer.h \
+widget_gpo.c  widget_gpo.h    \
+                              \
+plugin.c      plugin.h        \
+plugin_cfg.c                  \
+plugin_math.c                 \
+plugin_string.c               \
+plugin_test.c                 \
+plugin_time.c
+
+EXTRA_lcd4linux_SOURCES = \
+drv_generic_text.c            \
+drv_generic_text.h            \
+drv_generic_graphic.c         \
+drv_generic_graphic.h         \
+drv_generic_gpio.c            \
+drv_generic_gpio.h            \
+drv_generic_serial.c          \
+drv_generic_serial.h          \
+drv_generic_parport.c         \
+drv_generic_parport.h         \
+drv_generic_i2c.c             \
+drv_generic_i2c.h             \
+drv_generic_keypad.c          \
+drv_generic_keypad.h          \
+drv_BeckmannEgle.c            \
+drv_BWCT.c                    \
+drv_Crystalfontz.c            \
+drv_Curses.c                  \
+drv_Cwlinux.c                 \
+drv_D4D.c                     \
+drv_EA232graphic.c            \
+drv_G15.c                     \
+drv_HD44780.c                 \
+drv_Image.c                   \
+drv_IRLCD.c                   \
+drv_LCD2USB.c                 \
+drv_LCDLinux.c                \
+drv_LCDTerm.c                 \
+drv_LEDMatrix.c               \
+drv_LPH7508.c                 \
+drv_LUIse.c                   \
+drv_M50530.c                  \
+drv_MatrixOrbital.c           \
+drv_MilfordInstruments.c      \
+drv_Noritake.c                \
+drv_NULL.c                    \
+drv_Pertelian.c               \
+drv_PHAnderson.c              \
+drv_picoLCD.c                 \
+drv_picoLCDGraphic.c          \
+drv_RouterBoard.c             \
+drv_Sample.c                  \
+drv_st2205.c                  \
+drv_serdisplib.c              \
+drv_SimpleLCD.c               \
+drv_T6963.c                   \
+drv_Trefon.c                  \
+drv_ula200.c                  \
+drv_USBHUB.c                  \
+drv_USBLCD.c                  \
+drv_WincorNixdorf.c           \
+drv_X11.c                     \
+                              \
+font_6x8.h                    \
+font_6x8_bold.h               \
+widget_image.c widget_image.h \
+                              \
+lcd4linux_i2c.h               \
+                              \
+plugin_apm.c                  \
+plugin_asterisk.c             \
+plugin_button_exec.c          \
+plugin_cpuinfo.c              \
+plugin_diskstats.c            \
+plugin_dvb.c                  \
+plugin_exec.c                 \
+plugin_fifo.c                 \
+plugin_file.c                 \
+plugin_gps.c                  \
+plugin_hddtemp.c              \
+plugin_i2c_sensors.c          \
+plugin_iconv.c                \
+plugin_imon.c                 \
+plugin_isdn.c                 \
+plugin_kvv.c                  \
+plugin_loadavg.c              \
+plugin_meminfo.c              \
+plugin_mpd.c		      \
+plugin_mysql.c                \
+plugin_netdev.c               \
+plugin_netinfo.c              \
+plugin_pop3.c                 \
+plugin_ppp.c                  \
+plugin_proc_stat.c            \
+plugin_python.c               \
+plugin_sample.c               \
+plugin_seti.c                 \
+plugin_statfs.c               \
+plugin_uname.c                \
+plugin_uptime.c               \
+plugin_w1retap.c	      \
+plugin_wireless.c             \
+plugin_xmms.c
+
+EXTRA_DIST = \
+svn_version.sh                \
+lcd4linux.conf.sample         \
+lcd4kde.conf                  \
+lcd4linux.kdelnk              \
+lcd4linux.xpm                 \
+lcd4linux.lsm                 \
+ac_python_devel.m4            \
+curses.m4                     \
+drivers.m4                    \
+plugins.m4                    \
+AUTHORS                       \
+CREDITS                       \
+NEWS                          \
+TODO                          \
+README                        \
+plugin_sample.c
 
-lcd4linux_SOURCES =  lcd4linux.c                 cfg.c         cfg.h         debug.c       debug.h       drv.c         drv.h         evaluator.c   evaluator.h   hash.c        hash.h        layout.c      layout.h      pid.c         pid.h         timer.c       timer.h       thread.c      thread.h      udelay.c      udelay.h      qprintf.c     qprintf.h                                 widget.c      widget.h      widget_text.c widget_text.h widget_bar.c  widget_bar.h  widget_icon.c widget_icon.h                             plugin.c      plugin.h      plugin_cfg.c                plugin_math.c               plugin_string.c             plugin_test.c               plugin_time.c
-
-
-EXTRA_lcd4linux_SOURCES =  drv_generic_text.c          drv_generic_text.h          drv_generic_graphic.c       drv_generic_graphic.h       drv_generic_serial.c        drv_generic_serial.h        drv_generic_parport.c       drv_generic_parport.h       drv_generic_i2c.c           drv_generic_i2c.h           drv_BeckmannEgle.c          drv_BWCT.c                  drv_Crystalfontz.c          drv_Curses.c                drv_Cwlinux.c               drv_HD44780.c               drv_Image.c                 drv_LCDLinux.c              drv_LCDLinux.h              drv_LCDTerm.c               drv_M50530.c                drv_MatrixOrbital.c         drv_MilfordInstruments.c    drv_Noritake.c              drv_NULL.c                  drv_RouterBoard.c           drv_serdisplib.c            drv_SimpleLCD.c             drv_T6963.c                 drv_Trefon.c                drv_USBLCD.c                drv_X11.c                                               font_6x8.h                                              lcd4linux_i2c.h                                         plugin_apm.c                plugin_cpuinfo.c            plugin_diskstats.c          plugin_dvb.c                plugin_exec.c               plugin_i2c_sensors.c        plugin_imon.c               plugin_isdn.c               plugin_loadavg.c            plugin_meminfo.c            plugin_mysql.c              plugin_netdev.c             plugin_pop3.c               plugin_ppp.c                plugin_proc_stat.c          plugin_python.c             plugin_seti.c               plugin_statfs.c             plugin_uname.c              plugin_uptime.c             plugin_wireless.c           plugin_xmms.c
-
-
-EXTRA_DIST =  lcd4linux.conf.sample       lcd4kde.conf                lcd4linux.kdelnk            lcd4linux.xpm               lcd4linux.lsm               curses.m4                   AUTHORS                     CREDITS                     FAQ                         NEWS                        TODO                        README                      README.Drivers              README.Plugins              README.KDE                  plugin_sample.c
-
-ACLOCAL_M4 = $(top_srcdir)/aclocal.m4
-mkinstalldirs = $(SHELL) $(top_srcdir)/mkinstalldirs
-CONFIG_HEADER = config.h
-CONFIG_CLEAN_FILES = 
-PROGRAMS =  $(bin_PROGRAMS)
-
-
-DEFS = @DEFS@ -I. -I$(srcdir) -I.
-CPPFLAGS = @CPPFLAGS@
-LDFLAGS = @LDFLAGS@
-LIBS = @LIBS@
-X_CFLAGS = @X_CFLAGS@
-X_LIBS = @X_LIBS@
-X_EXTRA_LIBS = @X_EXTRA_LIBS@
-X_PRE_LIBS = @X_PRE_LIBS@
-lcd4linux_OBJECTS =  lcd4linux.o cfg.o debug.o drv.o evaluator.o hash.o \
-layout.o pid.o timer.o thread.o udelay.o qprintf.o widget.o \
-widget_text.o widget_bar.o widget_icon.o plugin.o plugin_cfg.o \
-plugin_math.o plugin_string.o plugin_test.o plugin_time.o
-CFLAGS = @CFLAGS@
-COMPILE = $(CC) $(DEFS) $(INCLUDES) $(AM_CPPFLAGS) $(CPPFLAGS) $(AM_CFLAGS) $(CFLAGS)
-CCLD = $(CC)
-LINK = $(CCLD) $(AM_CFLAGS) $(CFLAGS) $(LDFLAGS) -o $@
-DIST_COMMON =  README ./stamp-h.in AUTHORS COPYING ChangeLog INSTALL \
-Makefile.am Makefile.in NEWS TODO aclocal.m4 config.guess config.h.in \
-config.sub configure configure.in install-sh missing mkinstalldirs
-
-
-DISTFILES = $(DIST_COMMON) $(SOURCES) $(HEADERS) $(TEXINFOS) $(EXTRA_DIST)
-
-TAR = tar
-GZIP_ENV = --best
-SOURCES = $(lcd4linux_SOURCES) $(EXTRA_lcd4linux_SOURCES)
-OBJECTS = $(lcd4linux_OBJECTS)
+all: config.h
+	$(MAKE) $(AM_MAKEFLAGS) all-am
 
-all: all-redirect
 .SUFFIXES:
-.SUFFIXES: .S .c .o .s
-$(srcdir)/Makefile.in: Makefile.am $(top_srcdir)/configure.in $(ACLOCAL_M4) 
-	cd $(top_srcdir) && $(AUTOMAKE) --gnu --include-deps Makefile
-
-Makefile: $(srcdir)/Makefile.in  $(top_builddir)/config.status
-	cd $(top_builddir) \
-	  && CONFIG_FILES=$@ CONFIG_HEADERS= $(SHELL) ./config.status
-
-$(ACLOCAL_M4):  configure.in 
-	cd $(srcdir) && $(ACLOCAL)
+.SUFFIXES: .c .o .obj
+am--refresh:
+	@:
+$(srcdir)/Makefile.in:  $(srcdir)/Makefile.am  $(am__configure_deps)
+	@for dep in $?; do \
+	  case '$(am__configure_deps)' in \
+	    *$$dep*) \
+	      echo ' cd $(srcdir) && $(AUTOMAKE) --gnu '; \
+	      cd $(srcdir) && $(AUTOMAKE) --gnu  \
+		&& exit 0; \
+	      exit 1;; \
+	  esac; \
+	done; \
+	echo ' cd $(top_srcdir) && $(AUTOMAKE) --gnu  Makefile'; \
+	cd $(top_srcdir) && \
+	  $(AUTOMAKE) --gnu  Makefile
+.PRECIOUS: Makefile
+Makefile: $(srcdir)/Makefile.in $(top_builddir)/config.status
+	@case '$?' in \
+	  *config.status*) \
+	    echo ' $(SHELL) ./config.status'; \
+	    $(SHELL) ./config.status;; \
+	  *) \
+	    echo ' cd $(top_builddir) && $(SHELL) ./config.status $@ $(am__depfiles_maybe)'; \
+	    cd $(top_builddir) && $(SHELL) ./config.status $@ $(am__depfiles_maybe);; \
+	esac;
 
-config.status: $(srcdir)/configure $(CONFIG_STATUS_DEPENDENCIES)
+$(top_builddir)/config.status: $(top_srcdir)/configure $(CONFIG_STATUS_DEPENDENCIES)
 	$(SHELL) ./config.status --recheck
-$(srcdir)/configure: $(srcdir)/configure.in $(ACLOCAL_M4) $(CONFIGURE_DEPENDENCIES)
+
+$(top_srcdir)/configure:  $(am__configure_deps)
 	cd $(srcdir) && $(AUTOCONF)
+$(ACLOCAL_M4):  $(am__aclocal_m4_deps)
+	cd $(srcdir) && $(ACLOCAL) $(ACLOCAL_AMFLAGS)
 
-config.h: stamp-h
-	@if test ! -f $@; then \
-		rm -f stamp-h; \
-		$(MAKE) stamp-h; \
-	else :; fi
-stamp-h: $(srcdir)/config.h.in $(top_builddir)/config.status
-	cd $(top_builddir) \
-	  && CONFIG_FILES= CONFIG_HEADERS=config.h \
-	     $(SHELL) ./config.status
-	@echo timestamp > stamp-h 2> /dev/null
-$(srcdir)/config.h.in: $(srcdir)/stamp-h.in
+config.h: stamp-h1
 	@if test ! -f $@; then \
-		rm -f $(srcdir)/stamp-h.in; \
-		$(MAKE) $(srcdir)/stamp-h.in; \
+	  rm -f stamp-h1; \
+	  $(MAKE) $(AM_MAKEFLAGS) stamp-h1; \
 	else :; fi
-$(srcdir)/stamp-h.in: $(top_srcdir)/configure.in $(ACLOCAL_M4) 
-	cd $(top_srcdir) && $(AUTOHEADER)
-	@echo timestamp > $(srcdir)/stamp-h.in 2> /dev/null
 
-mostlyclean-hdr:
-
-clean-hdr:
+stamp-h1: $(srcdir)/config.h.in $(top_builddir)/config.status
+	@rm -f stamp-h1
+	cd $(top_builddir) && $(SHELL) ./config.status config.h
+$(srcdir)/config.h.in:  $(am__configure_deps) 
+	cd $(top_srcdir) && $(AUTOHEADER)
+	rm -f stamp-h1
+	touch $@
 
 distclean-hdr:
-	-rm -f config.h
-
-maintainer-clean-hdr:
-
-mostlyclean-binPROGRAMS:
-
-clean-binPROGRAMS:
-	-test -z "$(bin_PROGRAMS)" || rm -f $(bin_PROGRAMS)
-
-distclean-binPROGRAMS:
-
-maintainer-clean-binPROGRAMS:
-
+	-rm -f config.h stamp-h1
 install-binPROGRAMS: $(bin_PROGRAMS)
 	@$(NORMAL_INSTALL)
-	$(mkinstalldirs) $(DESTDIR)$(bindir)
+	test -z "$(bindir)" || $(MKDIR_P) "$(DESTDIR)$(bindir)"
 	@list='$(bin_PROGRAMS)'; for p in $$list; do \
-	  if test -f $$p; then \
-	    echo "  $(INSTALL_PROGRAM) $$p $(DESTDIR)$(bindir)/`echo $$p|sed 's/$(EXEEXT)$$//'|sed '$(transform)'|sed 's/$$/$(EXEEXT)/'`"; \
-	     $(INSTALL_PROGRAM) $$p $(DESTDIR)$(bindir)/`echo $$p|sed 's/$(EXEEXT)$$//'|sed '$(transform)'|sed 's/$$/$(EXEEXT)/'`; \
+	  p1=`echo $$p|sed 's/$(EXEEXT)$$//'`; \
+	  if test -f $$p \
+	  ; then \
+	    f=`echo "$$p1" | sed 's,^.*/,,;$(transform);s/$$/$(EXEEXT)/'`; \
+	   echo " $(INSTALL_PROGRAM_ENV) $(binPROGRAMS_INSTALL) '$$p' '$(DESTDIR)$(bindir)/$$f'"; \
+	   $(INSTALL_PROGRAM_ENV) $(binPROGRAMS_INSTALL) "$$p" "$(DESTDIR)$(bindir)/$$f" || exit 1; \
 	  else :; fi; \
 	done
 
 uninstall-binPROGRAMS:
 	@$(NORMAL_UNINSTALL)
-	list='$(bin_PROGRAMS)'; for p in $$list; do \
-	  rm -f $(DESTDIR)$(bindir)/`echo $$p|sed 's/$(EXEEXT)$$//'|sed '$(transform)'|sed 's/$$/$(EXEEXT)/'`; \
+	@list='$(bin_PROGRAMS)'; for p in $$list; do \
+	  f=`echo "$$p" | sed 's,^.*/,,;s/$(EXEEXT)$$//;$(transform);s/$$/$(EXEEXT)/'`; \
+	  echo " rm -f '$(DESTDIR)$(bindir)/$$f'"; \
+	  rm -f "$(DESTDIR)$(bindir)/$$f"; \
 	done
 
-.c.o:
-	$(COMPILE) -c $<
-
-.s.o:
-	$(COMPILE) -c $<
-
-.S.o:
-	$(COMPILE) -c $<
+clean-binPROGRAMS:
+	-test -z "$(bin_PROGRAMS)" || rm -f $(bin_PROGRAMS)
+lcd4linux$(EXEEXT): $(lcd4linux_OBJECTS) $(lcd4linux_DEPENDENCIES) 
+	@rm -f lcd4linux$(EXEEXT)
+	$(lcd4linux_LINK) $(lcd4linux_OBJECTS) $(lcd4linux_LDADD) $(LIBS)
 
 mostlyclean-compile:
-	-rm -f *.o core *.core
-
-clean-compile:
+	-rm -f *.$(OBJEXT)
 
 distclean-compile:
 	-rm -f *.tab.c
 
-maintainer-clean-compile:
-
-lcd4linux: $(lcd4linux_OBJECTS) $(lcd4linux_DEPENDENCIES)
-	@rm -f lcd4linux
-	$(LINK) $(lcd4linux_LDFLAGS) $(lcd4linux_OBJECTS) $(lcd4linux_LDADD) $(LIBS)
+@AMDEP_TRUE@@am__include@ @am__quote@./$(DEPDIR)/cfg.Po@am__quote@
+@AMDEP_TRUE@@am__include@ @am__quote@./$(DEPDIR)/debug.Po@am__quote@
+@AMDEP_TRUE@@am__include@ @am__quote@./$(DEPDIR)/drv.Po@am__quote@
+@AMDEP_TRUE@@am__include@ @am__quote@./$(DEPDIR)/drv_BWCT.Po@am__quote@
+@AMDEP_TRUE@@am__include@ @am__quote@./$(DEPDIR)/drv_BeckmannEgle.Po@am__quote@
+@AMDEP_TRUE@@am__include@ @am__quote@./$(DEPDIR)/drv_Crystalfontz.Po@am__quote@
+@AMDEP_TRUE@@am__include@ @am__quote@./$(DEPDIR)/drv_Curses.Po@am__quote@
+@AMDEP_TRUE@@am__include@ @am__quote@./$(DEPDIR)/drv_Cwlinux.Po@am__quote@
+@AMDEP_TRUE@@am__include@ @am__quote@./$(DEPDIR)/drv_D4D.Po@am__quote@
+@AMDEP_TRUE@@am__include@ @am__quote@./$(DEPDIR)/drv_EA232graphic.Po@am__quote@
+@AMDEP_TRUE@@am__include@ @am__quote@./$(DEPDIR)/drv_G15.Po@am__quote@
+@AMDEP_TRUE@@am__include@ @am__quote@./$(DEPDIR)/drv_HD44780.Po@am__quote@
+@AMDEP_TRUE@@am__include@ @am__quote@./$(DEPDIR)/drv_IRLCD.Po@am__quote@
+@AMDEP_TRUE@@am__include@ @am__quote@./$(DEPDIR)/drv_Image.Po@am__quote@
+@AMDEP_TRUE@@am__include@ @am__quote@./$(DEPDIR)/drv_LCD2USB.Po@am__quote@
+@AMDEP_TRUE@@am__include@ @am__quote@./$(DEPDIR)/drv_LCDLinux.Po@am__quote@
+@AMDEP_TRUE@@am__include@ @am__quote@./$(DEPDIR)/drv_LCDTerm.Po@am__quote@
+@AMDEP_TRUE@@am__include@ @am__quote@./$(DEPDIR)/drv_LEDMatrix.Po@am__quote@
+@AMDEP_TRUE@@am__include@ @am__quote@./$(DEPDIR)/drv_LPH7508.Po@am__quote@
+@AMDEP_TRUE@@am__include@ @am__quote@./$(DEPDIR)/drv_LUIse.Po@am__quote@
+@AMDEP_TRUE@@am__include@ @am__quote@./$(DEPDIR)/drv_M50530.Po@am__quote@
+@AMDEP_TRUE@@am__include@ @am__quote@./$(DEPDIR)/drv_MatrixOrbital.Po@am__quote@
+@AMDEP_TRUE@@am__include@ @am__quote@./$(DEPDIR)/drv_MilfordInstruments.Po@am__quote@
+@AMDEP_TRUE@@am__include@ @am__quote@./$(DEPDIR)/drv_NULL.Po@am__quote@
+@AMDEP_TRUE@@am__include@ @am__quote@./$(DEPDIR)/drv_Noritake.Po@am__quote@
+@AMDEP_TRUE@@am__include@ @am__quote@./$(DEPDIR)/drv_PHAnderson.Po@am__quote@
+@AMDEP_TRUE@@am__include@ @am__quote@./$(DEPDIR)/drv_Pertelian.Po@am__quote@
+@AMDEP_TRUE@@am__include@ @am__quote@./$(DEPDIR)/drv_RouterBoard.Po@am__quote@
+@AMDEP_TRUE@@am__include@ @am__quote@./$(DEPDIR)/drv_Sample.Po@am__quote@
+@AMDEP_TRUE@@am__include@ @am__quote@./$(DEPDIR)/drv_SimpleLCD.Po@am__quote@
+@AMDEP_TRUE@@am__include@ @am__quote@./$(DEPDIR)/drv_T6963.Po@am__quote@
+@AMDEP_TRUE@@am__include@ @am__quote@./$(DEPDIR)/drv_Trefon.Po@am__quote@
+@AMDEP_TRUE@@am__include@ @am__quote@./$(DEPDIR)/drv_USBHUB.Po@am__quote@
+@AMDEP_TRUE@@am__include@ @am__quote@./$(DEPDIR)/drv_USBLCD.Po@am__quote@
+@AMDEP_TRUE@@am__include@ @am__quote@./$(DEPDIR)/drv_WincorNixdorf.Po@am__quote@
+@AMDEP_TRUE@@am__include@ @am__quote@./$(DEPDIR)/drv_X11.Po@am__quote@
+@AMDEP_TRUE@@am__include@ @am__quote@./$(DEPDIR)/drv_generic.Po@am__quote@
+@AMDEP_TRUE@@am__include@ @am__quote@./$(DEPDIR)/drv_generic_gpio.Po@am__quote@
+@AMDEP_TRUE@@am__include@ @am__quote@./$(DEPDIR)/drv_generic_graphic.Po@am__quote@
+@AMDEP_TRUE@@am__include@ @am__quote@./$(DEPDIR)/drv_generic_i2c.Po@am__quote@
+@AMDEP_TRUE@@am__include@ @am__quote@./$(DEPDIR)/drv_generic_keypad.Po@am__quote@
+@AMDEP_TRUE@@am__include@ @am__quote@./$(DEPDIR)/drv_generic_parport.Po@am__quote@
+@AMDEP_TRUE@@am__include@ @am__quote@./$(DEPDIR)/drv_generic_serial.Po@am__quote@
+@AMDEP_TRUE@@am__include@ @am__quote@./$(DEPDIR)/drv_generic_text.Po@am__quote@
+@AMDEP_TRUE@@am__include@ @am__quote@./$(DEPDIR)/drv_picoLCD.Po@am__quote@
+@AMDEP_TRUE@@am__include@ @am__quote@./$(DEPDIR)/drv_picoLCDGraphic.Po@am__quote@
+@AMDEP_TRUE@@am__include@ @am__quote@./$(DEPDIR)/drv_serdisplib.Po@am__quote@
+@AMDEP_TRUE@@am__include@ @am__quote@./$(DEPDIR)/drv_st2205.Po@am__quote@
+@AMDEP_TRUE@@am__include@ @am__quote@./$(DEPDIR)/drv_ula200.Po@am__quote@
+@AMDEP_TRUE@@am__include@ @am__quote@./$(DEPDIR)/evaluator.Po@am__quote@
+@AMDEP_TRUE@@am__include@ @am__quote@./$(DEPDIR)/hash.Po@am__quote@
+@AMDEP_TRUE@@am__include@ @am__quote@./$(DEPDIR)/layout.Po@am__quote@
+@AMDEP_TRUE@@am__include@ @am__quote@./$(DEPDIR)/lcd4linux.Po@am__quote@
+@AMDEP_TRUE@@am__include@ @am__quote@./$(DEPDIR)/pid.Po@am__quote@
+@AMDEP_TRUE@@am__include@ @am__quote@./$(DEPDIR)/plugin.Po@am__quote@
+@AMDEP_TRUE@@am__include@ @am__quote@./$(DEPDIR)/plugin_apm.Po@am__quote@
+@AMDEP_TRUE@@am__include@ @am__quote@./$(DEPDIR)/plugin_asterisk.Po@am__quote@
+@AMDEP_TRUE@@am__include@ @am__quote@./$(DEPDIR)/plugin_button_exec.Po@am__quote@
+@AMDEP_TRUE@@am__include@ @am__quote@./$(DEPDIR)/plugin_cfg.Po@am__quote@
+@AMDEP_TRUE@@am__include@ @am__quote@./$(DEPDIR)/plugin_cpuinfo.Po@am__quote@
+@AMDEP_TRUE@@am__include@ @am__quote@./$(DEPDIR)/plugin_diskstats.Po@am__quote@
+@AMDEP_TRUE@@am__include@ @am__quote@./$(DEPDIR)/plugin_dvb.Po@am__quote@
+@AMDEP_TRUE@@am__include@ @am__quote@./$(DEPDIR)/plugin_exec.Po@am__quote@
+@AMDEP_TRUE@@am__include@ @am__quote@./$(DEPDIR)/plugin_fifo.Po@am__quote@
+@AMDEP_TRUE@@am__include@ @am__quote@./$(DEPDIR)/plugin_file.Po@am__quote@
+@AMDEP_TRUE@@am__include@ @am__quote@./$(DEPDIR)/plugin_gps.Po@am__quote@
+@AMDEP_TRUE@@am__include@ @am__quote@./$(DEPDIR)/plugin_hddtemp.Po@am__quote@
+@AMDEP_TRUE@@am__include@ @am__quote@./$(DEPDIR)/plugin_i2c_sensors.Po@am__quote@
+@AMDEP_TRUE@@am__include@ @am__quote@./$(DEPDIR)/plugin_iconv.Po@am__quote@
+@AMDEP_TRUE@@am__include@ @am__quote@./$(DEPDIR)/plugin_imon.Po@am__quote@
+@AMDEP_TRUE@@am__include@ @am__quote@./$(DEPDIR)/plugin_isdn.Po@am__quote@
+@AMDEP_TRUE@@am__include@ @am__quote@./$(DEPDIR)/plugin_kvv.Po@am__quote@
+@AMDEP_TRUE@@am__include@ @am__quote@./$(DEPDIR)/plugin_loadavg.Po@am__quote@
+@AMDEP_TRUE@@am__include@ @am__quote@./$(DEPDIR)/plugin_math.Po@am__quote@
+@AMDEP_TRUE@@am__include@ @am__quote@./$(DEPDIR)/plugin_meminfo.Po@am__quote@
+@AMDEP_TRUE@@am__include@ @am__quote@./$(DEPDIR)/plugin_mpd.Po@am__quote@
+@AMDEP_TRUE@@am__include@ @am__quote@./$(DEPDIR)/plugin_mysql.Po@am__quote@
+@AMDEP_TRUE@@am__include@ @am__quote@./$(DEPDIR)/plugin_netdev.Po@am__quote@
+@AMDEP_TRUE@@am__include@ @am__quote@./$(DEPDIR)/plugin_netinfo.Po@am__quote@
+@AMDEP_TRUE@@am__include@ @am__quote@./$(DEPDIR)/plugin_pop3.Po@am__quote@
+@AMDEP_TRUE@@am__include@ @am__quote@./$(DEPDIR)/plugin_ppp.Po@am__quote@
+@AMDEP_TRUE@@am__include@ @am__quote@./$(DEPDIR)/plugin_proc_stat.Po@am__quote@
+@AMDEP_TRUE@@am__include@ @am__quote@./$(DEPDIR)/plugin_python.Po@am__quote@
+@AMDEP_TRUE@@am__include@ @am__quote@./$(DEPDIR)/plugin_sample.Po@am__quote@
+@AMDEP_TRUE@@am__include@ @am__quote@./$(DEPDIR)/plugin_seti.Po@am__quote@
+@AMDEP_TRUE@@am__include@ @am__quote@./$(DEPDIR)/plugin_statfs.Po@am__quote@
+@AMDEP_TRUE@@am__include@ @am__quote@./$(DEPDIR)/plugin_string.Po@am__quote@
+@AMDEP_TRUE@@am__include@ @am__quote@./$(DEPDIR)/plugin_test.Po@am__quote@
+@AMDEP_TRUE@@am__include@ @am__quote@./$(DEPDIR)/plugin_time.Po@am__quote@
+@AMDEP_TRUE@@am__include@ @am__quote@./$(DEPDIR)/plugin_uname.Po@am__quote@
+@AMDEP_TRUE@@am__include@ @am__quote@./$(DEPDIR)/plugin_uptime.Po@am__quote@
+@AMDEP_TRUE@@am__include@ @am__quote@./$(DEPDIR)/plugin_w1retap.Po@am__quote@
+@AMDEP_TRUE@@am__include@ @am__quote@./$(DEPDIR)/plugin_wireless.Po@am__quote@
+@AMDEP_TRUE@@am__include@ @am__quote@./$(DEPDIR)/plugin_xmms.Po@am__quote@
+@AMDEP_TRUE@@am__include@ @am__quote@./$(DEPDIR)/property.Po@am__quote@
+@AMDEP_TRUE@@am__include@ @am__quote@./$(DEPDIR)/qprintf.Po@am__quote@
+@AMDEP_TRUE@@am__include@ @am__quote@./$(DEPDIR)/rgb.Po@am__quote@
+@AMDEP_TRUE@@am__include@ @am__quote@./$(DEPDIR)/thread.Po@am__quote@
+@AMDEP_TRUE@@am__include@ @am__quote@./$(DEPDIR)/timer.Po@am__quote@
+@AMDEP_TRUE@@am__include@ @am__quote@./$(DEPDIR)/udelay.Po@am__quote@
+@AMDEP_TRUE@@am__include@ @am__quote@./$(DEPDIR)/widget.Po@am__quote@
+@AMDEP_TRUE@@am__include@ @am__quote@./$(DEPDIR)/widget_bar.Po@am__quote@
+@AMDEP_TRUE@@am__include@ @am__quote@./$(DEPDIR)/widget_gpo.Po@am__quote@
+@AMDEP_TRUE@@am__include@ @am__quote@./$(DEPDIR)/widget_icon.Po@am__quote@
+@AMDEP_TRUE@@am__include@ @am__quote@./$(DEPDIR)/widget_image.Po@am__quote@
+@AMDEP_TRUE@@am__include@ @am__quote@./$(DEPDIR)/widget_keypad.Po@am__quote@
+@AMDEP_TRUE@@am__include@ @am__quote@./$(DEPDIR)/widget_text.Po@am__quote@
+@AMDEP_TRUE@@am__include@ @am__quote@./$(DEPDIR)/widget_timer.Po@am__quote@
 
+.c.o:
+@am__fastdepCC_TRUE@	$(COMPILE) -MT $@ -MD -MP -MF $(DEPDIR)/$*.Tpo -c -o $@ $<
+@am__fastdepCC_TRUE@	mv -f $(DEPDIR)/$*.Tpo $(DEPDIR)/$*.Po
+@AMDEP_TRUE@@am__fastdepCC_FALSE@	source='$<' object='$@' libtool=no @AMDEPBACKSLASH@
+@AMDEP_TRUE@@am__fastdepCC_FALSE@	DEPDIR=$(DEPDIR) $(CCDEPMODE) $(depcomp) @AMDEPBACKSLASH@
+@am__fastdepCC_FALSE@	$(COMPILE) -c $<
+
+.c.obj:
+@am__fastdepCC_TRUE@	$(COMPILE) -MT $@ -MD -MP -MF $(DEPDIR)/$*.Tpo -c -o $@ `$(CYGPATH_W) '$<'`
+@am__fastdepCC_TRUE@	mv -f $(DEPDIR)/$*.Tpo $(DEPDIR)/$*.Po
+@AMDEP_TRUE@@am__fastdepCC_FALSE@	source='$<' object='$@' libtool=no @AMDEPBACKSLASH@
+@AMDEP_TRUE@@am__fastdepCC_FALSE@	DEPDIR=$(DEPDIR) $(CCDEPMODE) $(depcomp) @AMDEPBACKSLASH@
+@am__fastdepCC_FALSE@	$(COMPILE) -c `$(CYGPATH_W) '$<'`
+
+ID: $(HEADERS) $(SOURCES) $(LISP) $(TAGS_FILES)
+	list='$(SOURCES) $(HEADERS) $(LISP) $(TAGS_FILES)'; \
+	unique=`for i in $$list; do \
+	    if test -f "$$i"; then echo $$i; else echo $(srcdir)/$$i; fi; \
+	  done | \
+	  $(AWK) '{ files[$$0] = 1; nonemtpy = 1; } \
+	      END { if (nonempty) { for (i in files) print i; }; }'`; \
+	mkid -fID $$unique
 tags: TAGS
 
-ID: $(HEADERS) $(SOURCES) $(LISP)
-	list='$(SOURCES) $(HEADERS)'; \
-	unique=`for i in $$list; do echo $$i; done | \
-	  awk '    { files[$$0] = 1; } \
-	       END { for (i in files) print i; }'`; \
-	here=`pwd` && cd $(srcdir) \
-	  && mkid -f$$here/ID $$unique $(LISP)
-
-TAGS:  $(HEADERS) $(SOURCES) config.h.in $(TAGS_DEPENDENCIES) $(LISP)
+TAGS:  $(HEADERS) $(SOURCES) config.h.in $(TAGS_DEPENDENCIES) \
+		$(TAGS_FILES) $(LISP)
 	tags=; \
 	here=`pwd`; \
-	list='$(SOURCES) $(HEADERS)'; \
-	unique=`for i in $$list; do echo $$i; done | \
-	  awk '    { files[$$0] = 1; } \
-	       END { for (i in files) print i; }'`; \
-	test -z "$(ETAGS_ARGS)config.h.in$$unique$(LISP)$$tags" \
-	  || (cd $(srcdir) && etags -o $$here/TAGS $(ETAGS_ARGS) $$tags config.h.in $$unique $(LISP))
-
-mostlyclean-tags:
-
-clean-tags:
+	list='$(SOURCES) $(HEADERS) config.h.in $(LISP) $(TAGS_FILES)'; \
+	unique=`for i in $$list; do \
+	    if test -f "$$i"; then echo $$i; else echo $(srcdir)/$$i; fi; \
+	  done | \
+	  $(AWK) '{ files[$$0] = 1; nonempty = 1; } \
+	      END { if (nonempty) { for (i in files) print i; }; }'`; \
+	if test -z "$(ETAGS_ARGS)$$tags$$unique"; then :; else \
+	  test -n "$$unique" || unique=$$empty_fix; \
+	  $(ETAGS) $(ETAGSFLAGS) $(AM_ETAGSFLAGS) $(ETAGS_ARGS) \
+	    $$tags $$unique; \
+	fi
+ctags: CTAGS
+CTAGS:  $(HEADERS) $(SOURCES) config.h.in $(TAGS_DEPENDENCIES) \
+		$(TAGS_FILES) $(LISP)
+	tags=; \
+	list='$(SOURCES) $(HEADERS) config.h.in $(LISP) $(TAGS_FILES)'; \
+	unique=`for i in $$list; do \
+	    if test -f "$$i"; then echo $$i; else echo $(srcdir)/$$i; fi; \
+	  done | \
+	  $(AWK) '{ files[$$0] = 1; nonempty = 1; } \
+	      END { if (nonempty) { for (i in files) print i; }; }'`; \
+	test -z "$(CTAGS_ARGS)$$tags$$unique" \
+	  || $(CTAGS) $(CTAGSFLAGS) $(AM_CTAGSFLAGS) $(CTAGS_ARGS) \
+	     $$tags $$unique
+
+GTAGS:
+	here=`$(am__cd) $(top_builddir) && pwd` \
+	  && cd $(top_srcdir) \
+	  && gtags -i $(GTAGS_ARGS) $$here
 
 distclean-tags:
-	-rm -f TAGS ID
-
-maintainer-clean-tags:
+	-rm -f TAGS ID GTAGS GRTAGS GSYMS GPATH tags
 
-distdir = $(PACKAGE)-$(VERSION)
-top_distdir = $(distdir)
+distdir: $(DISTFILES)
+	$(am__remove_distdir)
+	test -d $(distdir) || mkdir $(distdir)
+	@srcdirstrip=`echo "$(srcdir)" | sed 's/[].[^$$\\*]/\\\\&/g'`; \
+	topsrcdirstrip=`echo "$(top_srcdir)" | sed 's/[].[^$$\\*]/\\\\&/g'`; \
+	list='$(DISTFILES)'; \
+	  dist_files=`for file in $$list; do echo $$file; done | \
+	  sed -e "s|^$$srcdirstrip/||;t" \
+	      -e "s|^$$topsrcdirstrip/|$(top_builddir)/|;t"`; \
+	case $$dist_files in \
+	  */*) $(MKDIR_P) `echo "$$dist_files" | \
+			   sed '/\//!d;s|^|$(distdir)/|;s,/[^/]*$$,,' | \
+			   sort -u` ;; \
+	esac; \
+	for file in $$dist_files; do \
+	  if test -f $$file || test -d $$file; then d=.; else d=$(srcdir); fi; \
+	  if test -d $$d/$$file; then \
+	    dir=`echo "/$$file" | sed -e 's,/[^/]*$$,,'`; \
+	    if test -d $(srcdir)/$$file && test $$d != $(srcdir); then \
+	      cp -pR $(srcdir)/$$file $(distdir)$$dir || exit 1; \
+	    fi; \
+	    cp -pR $$d/$$file $(distdir)$$dir || exit 1; \
+	  else \
+	    test -f $(distdir)/$$file \
+	    || cp -p $$d/$$file $(distdir)/$$file \
+	    || exit 1; \
+	  fi; \
+	done
+	-find $(distdir) -type d ! -perm -777 -exec chmod a+rwx {} \; -o \
+	  ! -type d ! -perm -444 -links 1 -exec chmod a+r {} \; -o \
+	  ! -type d ! -perm -400 -exec chmod a+r {} \; -o \
+	  ! -type d ! -perm -444 -exec $(install_sh) -c -m a+r {} {} \; \
+	|| chmod -R a+r $(distdir)
+dist-gzip: distdir
+	tardir=$(distdir) && $(am__tar) | GZIP=$(GZIP_ENV) gzip -c >$(distdir).tar.gz
+	$(am__remove_distdir)
+
+dist-bzip2: distdir
+	tardir=$(distdir) && $(am__tar) | bzip2 -9 -c >$(distdir).tar.bz2
+	$(am__remove_distdir)
+
+dist-lzma: distdir
+	tardir=$(distdir) && $(am__tar) | lzma -9 -c >$(distdir).tar.lzma
+	$(am__remove_distdir)
+
+dist-tarZ: distdir
+	tardir=$(distdir) && $(am__tar) | compress -c >$(distdir).tar.Z
+	$(am__remove_distdir)
+
+dist-shar: distdir
+	shar $(distdir) | GZIP=$(GZIP_ENV) gzip -c >$(distdir).shar.gz
+	$(am__remove_distdir)
+
+dist-zip: distdir
+	-rm -f $(distdir).zip
+	zip -rq $(distdir).zip $(distdir)
+	$(am__remove_distdir)
+
+dist dist-all: distdir
+	tardir=$(distdir) && $(am__tar) | GZIP=$(GZIP_ENV) gzip -c >$(distdir).tar.gz
+	$(am__remove_distdir)
 
 # This target untars the dist file and tries a VPATH configuration.  Then
 # it guarantees that the distribution is self-contained by making another
 # tarfile.
 distcheck: dist
-	-rm -rf $(distdir)
-	GZIP=$(GZIP_ENV) $(TAR) zxf $(distdir).tar.gz
-	mkdir $(distdir)/=build
-	mkdir $(distdir)/=inst
-	dc_install_base=`cd $(distdir)/=inst && pwd`; \
-	cd $(distdir)/=build \
-	  && ../configure --srcdir=.. --prefix=$$dc_install_base \
+	case '$(DIST_ARCHIVES)' in \
+	*.tar.gz*) \
+	  GZIP=$(GZIP_ENV) gunzip -c $(distdir).tar.gz | $(am__untar) ;;\
+	*.tar.bz2*) \
+	  bunzip2 -c $(distdir).tar.bz2 | $(am__untar) ;;\
+	*.tar.lzma*) \
+	  unlzma -c $(distdir).tar.lzma | $(am__untar) ;;\
+	*.tar.Z*) \
+	  uncompress -c $(distdir).tar.Z | $(am__untar) ;;\
+	*.shar.gz*) \
+	  GZIP=$(GZIP_ENV) gunzip -c $(distdir).shar.gz | unshar ;;\
+	*.zip*) \
+	  unzip $(distdir).zip ;;\
+	esac
+	chmod -R a-w $(distdir); chmod a+w $(distdir)
+	mkdir $(distdir)/_build
+	mkdir $(distdir)/_inst
+	chmod a-w $(distdir)
+	dc_install_base=`$(am__cd) $(distdir)/_inst && pwd | sed -e 's,^[^:\\/]:[\\/],/,'` \
+	  && dc_destdir="$${TMPDIR-/tmp}/am-dc-$$$$/" \
+	  && cd $(distdir)/_build \
+	  && ../configure --srcdir=.. --prefix="$$dc_install_base" \
+	    $(DISTCHECK_CONFIGURE_FLAGS) \
 	  && $(MAKE) $(AM_MAKEFLAGS) \
 	  && $(MAKE) $(AM_MAKEFLAGS) dvi \
 	  && $(MAKE) $(AM_MAKEFLAGS) check \
 	  && $(MAKE) $(AM_MAKEFLAGS) install \
 	  && $(MAKE) $(AM_MAKEFLAGS) installcheck \
-	  && $(MAKE) $(AM_MAKEFLAGS) dist
-	-rm -rf $(distdir)
-	@banner="$(distdir).tar.gz is ready for distribution"; \
-	dashes=`echo "$$banner" | sed s/./=/g`; \
-	echo "$$dashes"; \
-	echo "$$banner"; \
-	echo "$$dashes"
-dist: distdir
-	-chmod -R a+r $(distdir)
-	GZIP=$(GZIP_ENV) $(TAR) chozf $(distdir).tar.gz $(distdir)
-	-rm -rf $(distdir)
-dist-all: distdir
-	-chmod -R a+r $(distdir)
-	GZIP=$(GZIP_ENV) $(TAR) chozf $(distdir).tar.gz $(distdir)
-	-rm -rf $(distdir)
-distdir: $(DISTFILES)
-	-rm -rf $(distdir)
-	mkdir $(distdir)
-	-chmod 777 $(distdir)
-	@for file in $(DISTFILES); do \
-	  d=$(srcdir); \
-	  if test -d $$d/$$file; then \
-	    cp -pr $$d/$$file $(distdir)/$$file; \
-	  else \
-	    test -f $(distdir)/$$file \
-	    || ln $$d/$$file $(distdir)/$$file 2> /dev/null \
-	    || cp -p $$d/$$file $(distdir)/$$file || :; \
-	  fi; \
-	done
-cfg.o: cfg.c config.h debug.h evaluator.h cfg.h
-debug.o: debug.c config.h debug.h
-drv.o: drv.c config.h debug.h cfg.h drv.h
-drv_BeckmannEgle.o: drv_BeckmannEgle.c config.h debug.h cfg.h qprintf.h \
-	plugin.h evaluator.h widget.h widget_text.h widget_icon.h \
-	widget_bar.h drv.h drv_generic_text.h drv_generic_serial.h
-drv_BWCT.o: drv_BWCT.c config.h debug.h cfg.h qprintf.h plugin.h \
-	evaluator.h widget.h widget_text.h widget_icon.h widget_bar.h \
-	drv.h drv_generic_text.h
-drv_Crystalfontz.o: drv_Crystalfontz.c config.h debug.h cfg.h qprintf.h \
-	timer.h plugin.h evaluator.h widget.h widget_text.h \
-	widget_icon.h widget_bar.h drv.h drv_generic_text.h \
-	drv_generic_serial.h
-drv_Curses.o: drv_Curses.c config.h debug.h cfg.h qprintf.h plugin.h \
-	evaluator.h widget.h widget_text.h widget_bar.h drv.h \
-	drv_generic_text.h
-drv_Cwlinux.o: drv_Cwlinux.c config.h debug.h cfg.h qprintf.h plugin.h \
-	evaluator.h widget.h widget_text.h widget_icon.h widget_bar.h \
-	drv.h drv_generic_text.h drv_generic_serial.h
-drv_generic_graphic.o: drv_generic_graphic.c config.h debug.h cfg.h \
-	plugin.h evaluator.h widget.h widget_text.h widget_icon.h \
-	widget_bar.h drv.h drv_generic_graphic.h font_6x8.h
-drv_generic_i2c.o: drv_generic_i2c.c config.h lcd4linux_i2c.h debug.h \
-	qprintf.h cfg.h udelay.h drv_generic_i2c.h
-drv_generic_parport.o: drv_generic_parport.c config.h debug.h qprintf.h \
-	cfg.h udelay.h drv_generic_parport.h
-drv_generic_serial.o: drv_generic_serial.c config.h debug.h qprintf.h \
-	cfg.h drv_generic_serial.h
-drv_generic_text.o: drv_generic_text.c config.h debug.h cfg.h plugin.h \
-	evaluator.h widget.h widget_text.h widget_icon.h widget_bar.h \
-	drv.h drv_generic_text.h
-drv_HD44780.o: drv_HD44780.c config.h debug.h cfg.h udelay.h qprintf.h \
-	timer.h plugin.h evaluator.h widget.h widget_text.h \
-	widget_icon.h widget_bar.h drv.h drv_generic_text.h \
-	drv_generic_parport.h drv_generic_i2c.h
-drv_Image.o: drv_Image.c config.h debug.h cfg.h timer.h qprintf.h \
-	plugin.h evaluator.h widget.h widget_text.h widget_icon.h \
-	widget_bar.h drv.h drv_generic_graphic.h
-drv_LCDLinux.o: drv_LCDLinux.c config.h debug.h cfg.h qprintf.h plugin.h \
-	evaluator.h widget.h widget_text.h widget_icon.h widget_bar.h \
-	drv.h drv_generic_text.h drv_LCDLinux.h
-drv_LCDTerm.o: drv_LCDTerm.c config.h debug.h cfg.h qprintf.h plugin.h \
-	evaluator.h widget.h widget_text.h widget_icon.h widget_bar.h \
-	drv.h drv_generic_text.h drv_generic_serial.h
-drv_M50530.o: drv_M50530.c config.h debug.h cfg.h qprintf.h udelay.h \
-	plugin.h evaluator.h widget.h widget_text.h widget_icon.h \
-	widget_bar.h drv.h drv_generic_text.h drv_generic_parport.h
-drv_MatrixOrbital.o: drv_MatrixOrbital.c config.h debug.h cfg.h plugin.h \
-	evaluator.h widget.h widget_text.h widget_icon.h widget_bar.h \
-	drv.h drv_generic_text.h drv_generic_serial.h
-drv_MilfordInstruments.o: drv_MilfordInstruments.c config.h debug.h \
-	cfg.h plugin.h evaluator.h widget.h widget_text.h widget_icon.h \
-	widget_bar.h drv.h drv_generic_text.h drv_generic_serial.h
-drv_Noritake.o: drv_Noritake.c config.h debug.h cfg.h qprintf.h plugin.h \
-	evaluator.h widget.h widget_text.h widget_icon.h widget_bar.h \
-	drv.h udelay.h drv_generic_text.h drv_generic_parport.h
-drv_NULL.o: drv_NULL.c config.h debug.h cfg.h plugin.h evaluator.h \
-	widget.h widget_text.h widget_bar.h drv.h drv_generic_text.h
-drv_RouterBoard.o: drv_RouterBoard.c config.h debug.h cfg.h udelay.h \
-	qprintf.h plugin.h evaluator.h widget.h widget_text.h \
-	widget_icon.h widget_bar.h drv.h drv_generic_text.h
-drv_serdisplib.o: drv_serdisplib.c config.h debug.h cfg.h qprintf.h \
-	plugin.h evaluator.h widget.h widget_text.h widget_icon.h \
-	widget_bar.h drv.h drv_generic_graphic.h
-drv_SimpleLCD.o: drv_SimpleLCD.c config.h debug.h cfg.h qprintf.h \
-	plugin.h evaluator.h widget.h widget_text.h widget_icon.h \
-	widget_bar.h drv.h drv_generic_text.h drv_generic_serial.h
-drv_T6963.o: drv_T6963.c config.h debug.h cfg.h qprintf.h udelay.h \
-	plugin.h evaluator.h widget.h widget_text.h widget_icon.h \
-	widget_bar.h drv.h drv_generic_graphic.h drv_generic_parport.h
-drv_Trefon.o: drv_Trefon.c config.h debug.h cfg.h qprintf.h plugin.h \
-	evaluator.h widget.h widget_text.h widget_icon.h widget_bar.h \
-	drv.h drv_generic_text.h
-drv_USBLCD.o: drv_USBLCD.c config.h debug.h cfg.h qprintf.h udelay.h \
-	plugin.h evaluator.h widget.h widget_text.h widget_icon.h \
-	widget_bar.h drv.h drv_generic_text.h
-drv_X11.o: drv_X11.c config.h debug.h cfg.h qprintf.h timer.h plugin.h \
-	evaluator.h widget.h widget_text.h widget_icon.h widget_bar.h \
-	drv.h drv_generic_graphic.h
-evaluator.o: evaluator.c config.h debug.h evaluator.h
-hash.o: hash.c config.h debug.h hash.h
-layout.o: layout.c config.h debug.h cfg.h widget.h layout.h
-lcd4linux.o: lcd4linux.c config.h cfg.h debug.h qprintf.h pid.h udelay.h \
-	drv.h timer.h layout.h plugin.h evaluator.h
-pid.o: pid.c config.h debug.h pid.h qprintf.h
-plugin.o: plugin.c config.h debug.h plugin.h evaluator.h
-plugin_apm.o: plugin_apm.c config.h debug.h plugin.h evaluator.h hash.h
-plugin_cfg.o: plugin_cfg.c config.h debug.h evaluator.h plugin.h cfg.h
-plugin_cpuinfo.o: plugin_cpuinfo.c config.h debug.h plugin.h evaluator.h \
-	hash.h
-plugin_diskstats.o: plugin_diskstats.c config.h debug.h plugin.h \
-	evaluator.h hash.h
-plugin_dvb.o: plugin_dvb.c config.h debug.h plugin.h evaluator.h hash.h
-plugin_exec.o: plugin_exec.c config.h debug.h plugin.h evaluator.h \
-	hash.h cfg.h thread.h qprintf.h
-plugin_i2c_sensors.o: plugin_i2c_sensors.c config.h debug.h plugin.h \
-	evaluator.h cfg.h hash.h qprintf.h
-plugin_imon.o: plugin_imon.c config.h debug.h plugin.h evaluator.h \
-	qprintf.h cfg.h hash.h
-plugin_isdn.o: plugin_isdn.c config.h debug.h plugin.h evaluator.h \
-	qprintf.h hash.h
-plugin_loadavg.o: plugin_loadavg.c config.h debug.h plugin.h evaluator.h
-plugin_math.o: plugin_math.c config.h debug.h plugin.h evaluator.h
-plugin_meminfo.o: plugin_meminfo.c config.h debug.h plugin.h evaluator.h \
-	hash.h
-plugin_netdev.o: plugin_netdev.c config.h debug.h plugin.h evaluator.h \
-	qprintf.h hash.h
-plugin_pop3.o: plugin_pop3.c config.h debug.h plugin.h evaluator.h cfg.h
-plugin_ppp.o: plugin_ppp.c config.h debug.h plugin.h evaluator.h \
-	qprintf.h hash.h
-plugin_proc_stat.o: plugin_proc_stat.c config.h debug.h plugin.h \
-	evaluator.h qprintf.h hash.h
-plugin_seti.o: plugin_seti.c config.h debug.h plugin.h evaluator.h \
-	hash.h cfg.h
-plugin_statfs.o: plugin_statfs.c config.h debug.h plugin.h evaluator.h
-plugin_string.o: plugin_string.c config.h debug.h plugin.h evaluator.h
-plugin_test.o: plugin_test.c config.h debug.h plugin.h evaluator.h
-plugin_time.o: plugin_time.c config.h debug.h plugin.h evaluator.h
-plugin_uname.o: plugin_uname.c config.h debug.h plugin.h evaluator.h
-plugin_uptime.o: plugin_uptime.c config.h debug.h plugin.h evaluator.h
-plugin_wireless.o: plugin_wireless.c config.h debug.h plugin.h \
-	evaluator.h cfg.h hash.h qprintf.h
-plugin_xmms.o: plugin_xmms.c config.h hash.h debug.h plugin.h \
-	evaluator.h
-qprintf.o: qprintf.c config.h
-thread.o: thread.c config.h debug.h thread.h
-timer.o: timer.c config.h debug.h cfg.h timer.h
-udelay.o: udelay.c config.h debug.h udelay.h
-widget.o: widget.c config.h debug.h cfg.h widget.h
-widget_bar.o: widget_bar.c config.h debug.h cfg.h evaluator.h timer.h \
-	widget.h widget_bar.h
-widget_icon.o: widget_icon.c config.h debug.h cfg.h qprintf.h \
-	evaluator.h timer.h widget.h widget_icon.h
-widget_text.o: widget_text.c config.h debug.h cfg.h evaluator.h timer.h \
-	widget.h widget_text.h
-
-info-am:
-info: info-am
-dvi-am:
-dvi: dvi-am
+	  && $(MAKE) $(AM_MAKEFLAGS) uninstall \
+	  && $(MAKE) $(AM_MAKEFLAGS) distuninstallcheck_dir="$$dc_install_base" \
+	        distuninstallcheck \
+	  && chmod -R a-w "$$dc_install_base" \
+	  && ({ \
+	       (cd ../.. && umask 077 && mkdir "$$dc_destdir") \
+	       && $(MAKE) $(AM_MAKEFLAGS) DESTDIR="$$dc_destdir" install \
+	       && $(MAKE) $(AM_MAKEFLAGS) DESTDIR="$$dc_destdir" uninstall \
+	       && $(MAKE) $(AM_MAKEFLAGS) DESTDIR="$$dc_destdir" \
+	            distuninstallcheck_dir="$$dc_destdir" distuninstallcheck; \
+	      } || { rm -rf "$$dc_destdir"; exit 1; }) \
+	  && rm -rf "$$dc_destdir" \
+	  && $(MAKE) $(AM_MAKEFLAGS) dist \
+	  && rm -rf $(DIST_ARCHIVES) \
+	  && $(MAKE) $(AM_MAKEFLAGS) distcleancheck
+	$(am__remove_distdir)
+	@(echo "$(distdir) archives ready for distribution: "; \
+	  list='$(DIST_ARCHIVES)'; for i in $$list; do echo $$i; done) | \
+	  sed -e 1h -e 1s/./=/g -e 1p -e 1x -e '$$p' -e '$$x'
+distuninstallcheck:
+	@cd $(distuninstallcheck_dir) \
+	&& test `$(distuninstallcheck_listfiles) | wc -l` -le 1 \
+	   || { echo "ERROR: files left after uninstall:" ; \
+	        if test -n "$(DESTDIR)"; then \
+	          echo "  (check DESTDIR support)"; \
+	        fi ; \
+	        $(distuninstallcheck_listfiles) ; \
+	        exit 1; } >&2
+distcleancheck: distclean
+	@if test '$(srcdir)' = . ; then \
+	  echo "ERROR: distcleancheck can only run from a VPATH build" ; \
+	  exit 1 ; \
+	fi
+	@test `$(distcleancheck_listfiles) | wc -l` -eq 0 \
+	  || { echo "ERROR: files left in build directory after distclean:" ; \
+	       $(distcleancheck_listfiles) ; \
+	       exit 1; } >&2
 check-am: all-am
 check: check-am
-installcheck-am:
-installcheck: installcheck-am
-all-recursive-am: config.h
-	$(MAKE) $(AM_MAKEFLAGS) all-recursive
-
-install-exec-am: install-binPROGRAMS
+all-am: Makefile $(PROGRAMS) config.h
+installdirs:
+	for dir in "$(DESTDIR)$(bindir)"; do \
+	  test -z "$$dir" || $(MKDIR_P) "$$dir"; \
+	done
+install: install-am
 install-exec: install-exec-am
-
-install-data-am:
 install-data: install-data-am
+uninstall: uninstall-am
 
 install-am: all-am
 	@$(MAKE) $(AM_MAKEFLAGS) install-exec-am install-data-am
-install: install-am
-uninstall-am: uninstall-binPROGRAMS
-uninstall: uninstall-am
-all-am: Makefile $(PROGRAMS) config.h
-all-redirect: all-am
-install-strip:
-	$(MAKE) $(AM_MAKEFLAGS) AM_INSTALL_PROGRAM_FLAGS=-s install
-installdirs:
-	$(mkinstalldirs)  $(DESTDIR)$(bindir)
-
 
+installcheck: installcheck-am
+install-strip:
+	$(MAKE) $(AM_MAKEFLAGS) INSTALL_PROGRAM="$(INSTALL_STRIP_PROGRAM)" \
+	  install_sh_PROGRAM="$(INSTALL_STRIP_PROGRAM)" INSTALL_STRIP_FLAG=-s \
+	  `test -z '$(STRIP)' || \
+	    echo "INSTALL_PROGRAM_ENV=STRIPPROG='$(STRIP)'"` install
 mostlyclean-generic:
 
 clean-generic:
 	-test -z "$(CLEANFILES)" || rm -f $(CLEANFILES)
 
 distclean-generic:
-	-rm -f Makefile $(CONFIG_CLEAN_FILES)
-	-rm -f config.cache config.log stamp-h stamp-h[0-9]*
+	-test -z "$(CONFIG_CLEAN_FILES)" || rm -f $(CONFIG_CLEAN_FILES)
 
 maintainer-clean-generic:
-mostlyclean-am:  mostlyclean-hdr mostlyclean-binPROGRAMS \
-		mostlyclean-compile mostlyclean-tags \
-		mostlyclean-generic
+	@echo "This command is intended for maintainers to use"
+	@echo "it deletes files that may require special tools to rebuild."
+clean: clean-am
 
-mostlyclean: mostlyclean-am
+clean-am: clean-binPROGRAMS clean-generic mostlyclean-am
 
-clean-am:  clean-hdr clean-binPROGRAMS clean-compile clean-tags \
-		clean-generic mostlyclean-am
+distclean: distclean-am
+	-rm -f $(am__CONFIG_DISTCLEAN_FILES)
+	-rm -rf ./$(DEPDIR)
+	-rm -f Makefile
+distclean-am: clean-am distclean-compile distclean-generic \
+	distclean-hdr distclean-tags
 
-clean: clean-am
+dvi: dvi-am
 
-distclean-am:  distclean-hdr distclean-binPROGRAMS distclean-compile \
-		distclean-tags distclean-generic clean-am
+dvi-am:
 
-distclean: distclean-am
-	-rm -f config.status
+html: html-am
 
-maintainer-clean-am:  maintainer-clean-hdr maintainer-clean-binPROGRAMS \
-		maintainer-clean-compile maintainer-clean-tags \
-		maintainer-clean-generic distclean-am
-	@echo "This command is intended for maintainers to use;"
-	@echo "it deletes files that may require special tools to rebuild."
+info: info-am
+
+info-am:
+
+install-data-am:
+
+install-dvi: install-dvi-am
+
+install-exec-am: install-binPROGRAMS
+
+install-html: install-html-am
+
+install-info: install-info-am
+
+install-man:
+
+install-pdf: install-pdf-am
+
+install-ps: install-ps-am
+
+installcheck-am:
 
 maintainer-clean: maintainer-clean-am
-	-rm -f config.status
+	-rm -f $(am__CONFIG_DISTCLEAN_FILES)
+	-rm -rf $(top_srcdir)/autom4te.cache
+	-rm -rf ./$(DEPDIR)
+	-rm -f Makefile
+maintainer-clean-am: distclean-am maintainer-clean-generic
+
+mostlyclean: mostlyclean-am
+
+mostlyclean-am: mostlyclean-compile mostlyclean-generic
+
+pdf: pdf-am
+
+pdf-am:
+
+ps: ps-am
+
+ps-am:
+
+uninstall-am: uninstall-binPROGRAMS
+
+.MAKE: install-am install-strip
+
+.PHONY: CTAGS GTAGS all all-am am--refresh check check-am clean \
+	clean-binPROGRAMS clean-generic ctags dist dist-all dist-bzip2 \
+	dist-gzip dist-lzma dist-shar dist-tarZ dist-zip distcheck \
+	distclean distclean-compile distclean-generic distclean-hdr \
+	distclean-tags distcleancheck distdir distuninstallcheck dvi \
+	dvi-am html html-am info info-am install install-am \
+	install-binPROGRAMS install-data install-data-am install-dvi \
+	install-dvi-am install-exec install-exec-am install-html \
+	install-html-am install-info install-info-am install-man \
+	install-pdf install-pdf-am install-ps install-ps-am \
+	install-strip installcheck installcheck-am installdirs \
+	maintainer-clean maintainer-clean-generic mostlyclean \
+	mostlyclean-compile mostlyclean-generic pdf pdf-am ps ps-am \
+	tags uninstall uninstall-am uninstall-binPROGRAMS
+
 
-.PHONY: mostlyclean-hdr distclean-hdr clean-hdr maintainer-clean-hdr \
-mostlyclean-binPROGRAMS distclean-binPROGRAMS clean-binPROGRAMS \
-maintainer-clean-binPROGRAMS uninstall-binPROGRAMS install-binPROGRAMS \
-mostlyclean-compile distclean-compile clean-compile \
-maintainer-clean-compile tags mostlyclean-tags distclean-tags \
-clean-tags maintainer-clean-tags distdir info-am info dvi-am dvi check \
-check-am installcheck-am installcheck all-recursive-am install-exec-am \
-install-exec install-data-am install-data install-am install \
-uninstall-am uninstall all-redirect all-am all installdirs \
-mostlyclean-generic distclean-generic clean-generic \
-maintainer-clean-generic clean mostlyclean distclean maintainer-clean
+# create subversion version
 
+.PHONY: svn_version
 
+svn_version:
+	svn_version.sh
 # Tell versions [3.59,3.63) of GNU make to not export all variables.
 # Otherwise a system limit (for SysV at least) may be exceeded.
 .NOEXPORT:
diff -urN lcd4linux-0.10.0/missing lcd4linux-0.11.0-SVN/missing
--- lcd4linux-0.10.0/missing	2003-02-27 08:23:02.000000000 +0100
+++ lcd4linux-0.11.0-SVN/missing	2008-12-31 08:05:54.000000000 +0100
@@ -1,7 +1,11 @@
 #! /bin/sh
 # Common stub for a few missing GNU programs while installing.
-# Copyright (C) 1996, 1997, 2001, 2002 Free Software Foundation, Inc.
-# Franc,ois Pinard <pinard@iro.umontreal.ca>, 1996.
+
+scriptversion=2006-05-10.23
+
+# Copyright (C) 1996, 1997, 1999, 2000, 2002, 2003, 2004, 2005, 2006
+#   Free Software Foundation, Inc.
+# Originally by Fran,cois Pinard <pinard@iro.umontreal.ca>, 1996.
 
 # This program is free software; you can redistribute it and/or modify
 # it under the terms of the GNU General Public License as published by
@@ -15,23 +19,49 @@
 
 # You should have received a copy of the GNU General Public License
 # along with this program; if not, write to the Free Software
-# Foundation, Inc., 59 Temple Place - Suite 330, Boston, MA
-# 02111-1307, USA.
+# Foundation, Inc., 51 Franklin Street, Fifth Floor, Boston, MA
+# 02110-1301, USA.
+
+# As a special exception to the GNU General Public License, if you
+# distribute this file as part of a program that contains a
+# configuration script generated by Autoconf, you may include it under
+# the same distribution terms that you use for the rest of that program.
 
 if test $# -eq 0; then
   echo 1>&2 "Try \`$0 --help' for more information"
   exit 1
 fi
 
+run=:
+sed_output='s/.* --output[ =]\([^ ]*\).*/\1/p'
+sed_minuso='s/.* -o \([^ ]*\).*/\1/p'
+
 # In the cases where this matters, `missing' is being run in the
 # srcdir already.
-if test -f configure.in; then
+if test -f configure.ac; then
   configure_ac=configure.ac
 else
   configure_ac=configure.in
 fi
 
-case "$1" in
+msg="missing on your system"
+
+case $1 in
+--run)
+  # Try to run requested program, and just exit if it succeeds.
+  run=
+  shift
+  "$@" && exit 0
+  # Exit code 63 means version mismatch.  This often happens
+  # when the user try to use an ancient version of a tool on
+  # a file that requires a minimum version.  In this case we
+  # we should proceed has if the program had been absent, or
+  # if --run hadn't been passed.
+  if test $? = 63; then
+    run=:
+    msg="probably too old"
+  fi
+  ;;
 
   -h|--h|--he|--hel|--help)
     echo "\
@@ -43,21 +73,29 @@
 Options:
   -h, --help      display this help and exit
   -v, --version   output version information and exit
+  --run           try to run the given command, and emulate it if it fails
 
 Supported PROGRAM values:
   aclocal      touch file \`aclocal.m4'
   autoconf     touch file \`configure'
   autoheader   touch file \`config.h.in'
+  autom4te     touch the output file, or create a stub one
   automake     touch all \`Makefile.in' files
   bison        create \`y.tab.[ch]', if possible, from existing .[ch]
   flex         create \`lex.yy.c', if possible, from existing .c
+  help2man     touch the output file
   lex          create \`lex.yy.c', if possible, from existing .c
   makeinfo     touch the output file
-  yacc         create \`y.tab.[ch]', if possible, from existing .[ch]"
+  tar          try tar, gnutar, gtar, then tar without non-portable flags
+  yacc         create \`y.tab.[ch]', if possible, from existing .[ch]
+
+Send bug reports to <bug-automake@gnu.org>."
+    exit $?
     ;;
 
   -v|--v|--ve|--ver|--vers|--versi|--versio|--version)
-    echo "missing - GNU libit 0.0"
+    echo "missing $scriptversion (GNU Automake)"
+    exit $?
     ;;
 
   -*)
@@ -66,10 +104,45 @@
     exit 1
     ;;
 
+esac
+
+# Now exit if we have it, but it failed.  Also exit now if we
+# don't have it and --version was passed (most likely to detect
+# the program).
+case $1 in
+  lex|yacc)
+    # Not GNU programs, they don't have --version.
+    ;;
+
+  tar)
+    if test -n "$run"; then
+       echo 1>&2 "ERROR: \`tar' requires --run"
+       exit 1
+    elif test "x$2" = "x--version" || test "x$2" = "x--help"; then
+       exit 1
+    fi
+    ;;
+
+  *)
+    if test -z "$run" && ($1 --version) > /dev/null 2>&1; then
+       # We have it, but it failed.
+       exit 1
+    elif test "x$2" = "x--version" || test "x$2" = "x--help"; then
+       # Could not run --version or --help.  This is probably someone
+       # running `$TOOL --version' or `$TOOL --help' to check whether
+       # $TOOL exists and not knowing $TOOL uses missing.
+       exit 1
+    fi
+    ;;
+esac
+
+# If it does not exist, or fails to run (possibly an outdated version),
+# try to emulate it.
+case $1 in
   aclocal*)
     echo 1>&2 "\
-WARNING: \`$1' is missing on your system.  You should only need it if
-         you modified \`acinclude.m4' or \`$configure_ac'.  You might want
+WARNING: \`$1' is $msg.  You should only need it if
+         you modified \`acinclude.m4' or \`${configure_ac}'.  You might want
          to install the \`Automake' and \`Perl' packages.  Grab them from
          any GNU archive site."
     touch aclocal.m4
@@ -77,8 +150,8 @@
 
   autoconf)
     echo 1>&2 "\
-WARNING: \`$1' is missing on your system.  You should only need it if
-         you modified \`$configure_ac'.  You might want to install the
+WARNING: \`$1' is $msg.  You should only need it if
+         you modified \`${configure_ac}'.  You might want to install the
          \`Autoconf' and \`GNU m4' packages.  Grab them from any GNU
          archive site."
     touch configure
@@ -86,15 +159,15 @@
 
   autoheader)
     echo 1>&2 "\
-WARNING: \`$1' is missing on your system.  You should only need it if
-         you modified \`acconfig.h' or \`$configure_ac'.  You might want
+WARNING: \`$1' is $msg.  You should only need it if
+         you modified \`acconfig.h' or \`${configure_ac}'.  You might want
          to install the \`Autoconf' and \`GNU m4' packages.  Grab them
          from any GNU archive site."
-    files=`sed -n 's/^[ ]*A[CM]_CONFIG_HEADER(\([^)]*\)).*/\1/p' $configure_ac`
+    files=`sed -n 's/^[ ]*A[CM]_CONFIG_HEADER(\([^)]*\)).*/\1/p' ${configure_ac}`
     test -z "$files" && files="config.h"
     touch_files=
     for f in $files; do
-      case "$f" in
+      case $f in
       *:*) touch_files="$touch_files "`echo "$f" |
 				       sed -e 's/^[^:]*://' -e 's/:.*//'`;;
       *) touch_files="$touch_files $f.in";;
@@ -105,8 +178,8 @@
 
   automake*)
     echo 1>&2 "\
-WARNING: \`$1' is missing on your system.  You should only need it if
-         you modified \`Makefile.am', \`acinclude.m4' or \`$configure_ac'.
+WARNING: \`$1' is $msg.  You should only need it if
+         you modified \`Makefile.am', \`acinclude.m4' or \`${configure_ac}'.
          You might want to install the \`Automake' and \`Perl' packages.
          Grab them from any GNU archive site."
     find . -type f -name Makefile.am -print |
@@ -114,81 +187,170 @@
 	   while read f; do touch "$f"; done
     ;;
 
+  autom4te)
+    echo 1>&2 "\
+WARNING: \`$1' is needed, but is $msg.
+         You might have modified some files without having the
+         proper tools for further handling them.
+         You can get \`$1' as part of \`Autoconf' from any GNU
+         archive site."
+
+    file=`echo "$*" | sed -n "$sed_output"`
+    test -z "$file" && file=`echo "$*" | sed -n "$sed_minuso"`
+    if test -f "$file"; then
+	touch $file
+    else
+	test -z "$file" || exec >$file
+	echo "#! /bin/sh"
+	echo "# Created by GNU Automake missing as a replacement of"
+	echo "#  $ $@"
+	echo "exit 0"
+	chmod +x $file
+	exit 1
+    fi
+    ;;
+
   bison|yacc)
     echo 1>&2 "\
-WARNING: \`$1' is missing on your system.  You should only need it if
+WARNING: \`$1' $msg.  You should only need it if
          you modified a \`.y' file.  You may need the \`Bison' package
          in order for those modifications to take effect.  You can get
          \`Bison' from any GNU archive site."
     rm -f y.tab.c y.tab.h
-    if [ $# -ne 1 ]; then
+    if test $# -ne 1; then
         eval LASTARG="\${$#}"
-	case "$LASTARG" in
+	case $LASTARG in
 	*.y)
 	    SRCFILE=`echo "$LASTARG" | sed 's/y$/c/'`
-	    if [ -f "$SRCFILE" ]; then
+	    if test -f "$SRCFILE"; then
 	         cp "$SRCFILE" y.tab.c
 	    fi
 	    SRCFILE=`echo "$LASTARG" | sed 's/y$/h/'`
-	    if [ -f "$SRCFILE" ]; then
+	    if test -f "$SRCFILE"; then
 	         cp "$SRCFILE" y.tab.h
 	    fi
 	  ;;
 	esac
     fi
-    if [ ! -f y.tab.h ]; then
+    if test ! -f y.tab.h; then
 	echo >y.tab.h
     fi
-    if [ ! -f y.tab.c ]; then
+    if test ! -f y.tab.c; then
 	echo 'main() { return 0; }' >y.tab.c
     fi
     ;;
 
   lex|flex)
     echo 1>&2 "\
-WARNING: \`$1' is missing on your system.  You should only need it if
+WARNING: \`$1' is $msg.  You should only need it if
          you modified a \`.l' file.  You may need the \`Flex' package
          in order for those modifications to take effect.  You can get
          \`Flex' from any GNU archive site."
     rm -f lex.yy.c
-    if [ $# -ne 1 ]; then
+    if test $# -ne 1; then
         eval LASTARG="\${$#}"
-	case "$LASTARG" in
+	case $LASTARG in
 	*.l)
 	    SRCFILE=`echo "$LASTARG" | sed 's/l$/c/'`
-	    if [ -f "$SRCFILE" ]; then
+	    if test -f "$SRCFILE"; then
 	         cp "$SRCFILE" lex.yy.c
 	    fi
 	  ;;
 	esac
     fi
-    if [ ! -f lex.yy.c ]; then
+    if test ! -f lex.yy.c; then
 	echo 'main() { return 0; }' >lex.yy.c
     fi
     ;;
 
+  help2man)
+    echo 1>&2 "\
+WARNING: \`$1' is $msg.  You should only need it if
+	 you modified a dependency of a manual page.  You may need the
+	 \`Help2man' package in order for those modifications to take
+	 effect.  You can get \`Help2man' from any GNU archive site."
+
+    file=`echo "$*" | sed -n "$sed_output"`
+    test -z "$file" && file=`echo "$*" | sed -n "$sed_minuso"`
+    if test -f "$file"; then
+	touch $file
+    else
+	test -z "$file" || exec >$file
+	echo ".ab help2man is required to generate this page"
+	exit 1
+    fi
+    ;;
+
   makeinfo)
     echo 1>&2 "\
-WARNING: \`$1' is missing on your system.  You should only need it if
+WARNING: \`$1' is $msg.  You should only need it if
          you modified a \`.texi' or \`.texinfo' file, or any other file
          indirectly affecting the aspect of the manual.  The spurious
          call might also be the consequence of using a buggy \`make' (AIX,
          DU, IRIX).  You might want to install the \`Texinfo' package or
          the \`GNU make' package.  Grab either from any GNU archive site."
-    file=`echo "$*" | sed -n 's/.*-o \([^ ]*\).*/\1/p'`
+    # The file to touch is that specified with -o ...
+    file=`echo "$*" | sed -n "$sed_output"`
+    test -z "$file" && file=`echo "$*" | sed -n "$sed_minuso"`
     if test -z "$file"; then
-      file=`echo "$*" | sed 's/.* \([^ ]*\) *$/\1/'`
-      file=`sed -n '/^@setfilename/ { s/.* \([^ ]*\) *$/\1/; p; q; }' $file`
+      # ... or it is the one specified with @setfilename ...
+      infile=`echo "$*" | sed 's/.* \([^ ]*\) *$/\1/'`
+      file=`sed -n '
+	/^@setfilename/{
+	  s/.* \([^ ]*\) *$/\1/
+	  p
+	  q
+	}' $infile`
+      # ... or it is derived from the source name (dir/f.texi becomes f.info)
+      test -z "$file" && file=`echo "$infile" | sed 's,.*/,,;s,.[^.]*$,,'`.info
     fi
+    # If the file does not exist, the user really needs makeinfo;
+    # let's fail without touching anything.
+    test -f $file || exit 1
     touch $file
     ;;
 
+  tar)
+    shift
+
+    # We have already tried tar in the generic part.
+    # Look for gnutar/gtar before invocation to avoid ugly error
+    # messages.
+    if (gnutar --version > /dev/null 2>&1); then
+       gnutar "$@" && exit 0
+    fi
+    if (gtar --version > /dev/null 2>&1); then
+       gtar "$@" && exit 0
+    fi
+    firstarg="$1"
+    if shift; then
+	case $firstarg in
+	*o*)
+	    firstarg=`echo "$firstarg" | sed s/o//`
+	    tar "$firstarg" "$@" && exit 0
+	    ;;
+	esac
+	case $firstarg in
+	*h*)
+	    firstarg=`echo "$firstarg" | sed s/h//`
+	    tar "$firstarg" "$@" && exit 0
+	    ;;
+	esac
+    fi
+
+    echo 1>&2 "\
+WARNING: I can't seem to be able to run \`tar' with the given arguments.
+         You may want to install GNU tar or Free paxutils, or check the
+         command line arguments."
+    exit 1
+    ;;
+
   *)
     echo 1>&2 "\
-WARNING: \`$1' is needed, and you do not seem to have it handy on your
-         system.  You might have modified some files without having the
+WARNING: \`$1' is needed, and is $msg.
+         You might have modified some files without having the
          proper tools for further handling them.  Check the \`README' file,
-         it often tells you about the needed prerequirements for installing
+         it often tells you about the needed prerequisites for installing
          this package.  You may also peek at any GNU archive site, in case
          some other package would contain this missing \`$1' program."
     exit 1
@@ -196,3 +358,10 @@
 esac
 
 exit 0
+
+# Local variables:
+# eval: (add-hook 'write-file-hooks 'time-stamp)
+# time-stamp-start: "scriptversion="
+# time-stamp-format: "%:y-%02m-%02d.%02H"
+# time-stamp-end: "$"
+# End:
diff -urN lcd4linux-0.10.0/mkinstalldirs lcd4linux-0.11.0-SVN/mkinstalldirs
--- lcd4linux-0.10.0/mkinstalldirs	2003-02-27 08:43:11.000000000 +0100
+++ lcd4linux-0.11.0-SVN/mkinstalldirs	2008-12-31 08:05:54.000000000 +0100
@@ -1,40 +1,161 @@
 #! /bin/sh
 # mkinstalldirs --- make directory hierarchy
-# Author: Noah Friedman <friedman@prep.ai.mit.edu>
-# Created: 1993-05-16
-# Public domain
 
-# $Id: mkinstalldirs,v 1.2 2003/02/27 07:43:11 reinelt Exp $
+scriptversion=2006-05-11.19
 
+# Original author: Noah Friedman <friedman@prep.ai.mit.edu>
+# Created: 1993-05-16
+# Public domain.
+#
+# This file is maintained in Automake, please report
+# bugs to <bug-automake@gnu.org> or send patches to
+# <automake-patches@gnu.org>.
+
+nl='
+'
+IFS=" ""	$nl"
 errstatus=0
+dirmode=
+
+usage="\
+Usage: mkinstalldirs [-h] [--help] [--version] [-m MODE] DIR ...
+
+Create each directory DIR (with mode MODE, if specified), including all
+leading file name components.
+
+Report bugs to <bug-automake@gnu.org>."
+
+# process command line arguments
+while test $# -gt 0 ; do
+  case $1 in
+    -h | --help | --h*)         # -h for help
+      echo "$usage"
+      exit $?
+      ;;
+    -m)                         # -m PERM arg
+      shift
+      test $# -eq 0 && { echo "$usage" 1>&2; exit 1; }
+      dirmode=$1
+      shift
+      ;;
+    --version)
+      echo "$0 $scriptversion"
+      exit $?
+      ;;
+    --)                         # stop option processing
+      shift
+      break
+      ;;
+    -*)                         # unknown option
+      echo "$usage" 1>&2
+      exit 1
+      ;;
+    *)                          # first non-opt arg
+      break
+      ;;
+  esac
+done
 
 for file
 do
-   set fnord `echo ":$file" | sed -ne 's/^:\//#/;s/^://;s/\// /g;s/^#/\//;p'`
-   shift
+  if test -d "$file"; then
+    shift
+  else
+    break
+  fi
+done
+
+case $# in
+  0) exit 0 ;;
+esac
+
+# Solaris 8's mkdir -p isn't thread-safe.  If you mkdir -p a/b and
+# mkdir -p a/c at the same time, both will detect that a is missing,
+# one will create a, then the other will try to create a and die with
+# a "File exists" error.  This is a problem when calling mkinstalldirs
+# from a parallel make.  We use --version in the probe to restrict
+# ourselves to GNU mkdir, which is thread-safe.
+case $dirmode in
+  '')
+    if mkdir -p --version . >/dev/null 2>&1 && test ! -d ./--version; then
+      echo "mkdir -p -- $*"
+      exec mkdir -p -- "$@"
+    else
+      # On NextStep and OpenStep, the `mkdir' command does not
+      # recognize any option.  It will interpret all options as
+      # directories to create, and then abort because `.' already
+      # exists.
+      test -d ./-p && rmdir ./-p
+      test -d ./--version && rmdir ./--version
+    fi
+    ;;
+  *)
+    if mkdir -m "$dirmode" -p --version . >/dev/null 2>&1 &&
+       test ! -d ./--version; then
+      echo "mkdir -m $dirmode -p -- $*"
+      exec mkdir -m "$dirmode" -p -- "$@"
+    else
+      # Clean up after NextStep and OpenStep mkdir.
+      for d in ./-m ./-p ./--version "./$dirmode";
+      do
+        test -d $d && rmdir $d
+      done
+    fi
+    ;;
+esac
 
-   pathcomp=
-   for d
-   do
-     pathcomp="$pathcomp$d"
-     case "$pathcomp" in
-       -* ) pathcomp=./$pathcomp ;;
-     esac
-
-     if test ! -d "$pathcomp"; then
-        echo "mkdir $pathcomp"
-
-        mkdir "$pathcomp" || lasterr=$?
-
-        if test ! -d "$pathcomp"; then
-  	  errstatus=$lasterr
-        fi
-     fi
+for file
+do
+  case $file in
+    /*) pathcomp=/ ;;
+    *)  pathcomp= ;;
+  esac
+  oIFS=$IFS
+  IFS=/
+  set fnord $file
+  shift
+  IFS=$oIFS
+
+  for d
+  do
+    test "x$d" = x && continue
+
+    pathcomp=$pathcomp$d
+    case $pathcomp in
+      -*) pathcomp=./$pathcomp ;;
+    esac
+
+    if test ! -d "$pathcomp"; then
+      echo "mkdir $pathcomp"
+
+      mkdir "$pathcomp" || lasterr=$?
+
+      if test ! -d "$pathcomp"; then
+	errstatus=$lasterr
+      else
+	if test ! -z "$dirmode"; then
+	  echo "chmod $dirmode $pathcomp"
+	  lasterr=
+	  chmod "$dirmode" "$pathcomp" || lasterr=$?
+
+	  if test ! -z "$lasterr"; then
+	    errstatus=$lasterr
+	  fi
+	fi
+      fi
+    fi
 
-     pathcomp="$pathcomp/"
-   done
+    pathcomp=$pathcomp/
+  done
 done
 
 exit $errstatus
 
-# mkinstalldirs ends here
+# Local Variables:
+# mode: shell-script
+# sh-indentation: 2
+# eval: (add-hook 'write-file-hooks 'time-stamp)
+# time-stamp-start: "scriptversion="
+# time-stamp-format: "%:y-%02m-%02d.%02H"
+# time-stamp-end: "$"
+# End:
diff -urN lcd4linux-0.10.0/NEWS lcd4linux-0.11.0-SVN/NEWS
--- lcd4linux-0.10.0/NEWS	2001-09-05 11:38:52.000000000 +0200
+++ lcd4linux-0.11.0-SVN/NEWS	2008-12-31 08:05:54.000000000 +0100
@@ -1,53 +1,5 @@
-   ---   LCD4Linux News   ---
+# $Id: NEWS 730 2007-01-14 13:50:28Z michael $
+# $URL: https://ssl.bulix.org/svn/lcd4linux/trunk/NEWS $
 
-
-
-lcd4linux-0.98
-
-- improved signal-handling: lcd4linux can be restarted by sending a SIGHUP
-
-- lcd4linux uses syslog for messages/warnings etc.
-
-- support for GPO's (general purpose outputs, e.g. to connect a LED)
-  The MatroxOrbital Displays have one GPO, and you can connect up to eight
-  LED's to the parallel port using two IC's (see README.HD44780.GPO)
-
-- new delay loop for parallel port displays: uses either gettimeofday() or
-  rdtsc (time stamp counter on newer processors). This delay needs no longer
-  a calibration! The 'Delay'-entry in lcd4linux.conf has gone.
-
-- new raster driver for PNG creation
-
-- new curses-based text driver
-
-- security: lcd4linux.conf must have the same user/group than the executable, 
-  and must not me accesible by group and other (i.e. mode 0600). This is 
-  necessary because lcd4linux.conf can contain usernames and passwords for 
-  POP and IMAP queries.
-
-- support for plugins: new token 'x1'..'x9' for externel programs
-
-- new token 'ic' (ISDN connected/offline, mainly for a LED connected to a GPO)
-
-- APM client: new tokens 'bp', 'bs', 'bd' (battery percentage, status and 
-  duration)
-
-- mail client: new tokens 'e1'..'e9' for counting emails in local mailboxes
-
-- new configure-options '--with-drivers=<list>', so you can compile a minimal
-  executable which contains only the drivers you need.
-
-- seti@home client: new tokens 'hc' (% completed) and 'ht' (cpu time needed)
-
-- simple web-server driver (see README.Webinterface)
-
-- uses new (kernel 2.4) ppdev system to access parallel port via ioctl()
-
-- mail suport for pop3 and imap4, token 'u1' ..'u9' show unseen mail
-  (which is propably incorrect for normal mbox)
-
-- added another verbose level (-vvv) for debugging socket traffic
-
-- added nntp support for count of news/unread messages in subscribed NGs
-
-- implemented time series bar '$t'
+Sorry, there is no NEWS anymore.
+Go to http://lcd4linux.bulix.org for all the documentation.
diff -urN lcd4linux-0.10.0/pid.c lcd4linux-0.11.0-SVN/pid.c
--- lcd4linux-0.10.0/pid.c	2005-05-08 06:32:44.000000000 +0200
+++ lcd4linux-0.11.0-SVN/pid.c	2008-12-31 08:05:54.000000000 +0100
@@ -1,8 +1,9 @@
-/* $Id: pid.c,v 1.10 2005/05/08 04:32:44 reinelt Exp $
+/* $Id: pid.c 840 2007-09-09 12:17:42Z michael $
+ * $URL: https://ssl.bulix.org/svn/lcd4linux/trunk/pid.c $
  *
  * PID file handling
  *
- * Copyright (C) 1999, 2000 Michael Reinelt <reinelt@eunet.at>
+ * Copyright (C) 1999, 2000 Michael Reinelt <michael@reinelt.co.at>
  *
  * This file is part of LCD4Linux.
  *
@@ -20,47 +21,6 @@
  * along with this program; if not, write to the Free Software
  * Foundation, Inc., 675 Mass Ave, Cambridge, MA 02139, USA.
  *
- *
- * $Log: pid.c,v $
- * Revision 1.10  2005/05/08 04:32:44  reinelt
- * CodingStyle added and applied
- *
- * Revision 1.9  2005/01/18 06:30:23  reinelt
- * added (C) to all copyright statements
- *
- * Revision 1.8  2004/06/26 12:04:59  reinelt
- *
- * uh-oh... the last CVS log message messed up things a lot...
- *
- * Revision 1.7  2004/06/26 09:27:21  reinelt
- *
- * added '-W' to CFLAGS
- * changed all C++ comments to C ones
- * cleaned up a lot of signed/unsigned mistakes
- *
- * Revision 1.6  2004/03/19 06:37:47  reinelt
- * asynchronous thread handling started
- *
- * Revision 1.5  2004/03/03 04:44:16  reinelt
- * changes (cosmetics?) to the big patch from Martin
- * hash patch un-applied
- *
- * Revision 1.4  2004/03/03 03:47:04  reinelt
- * big patch from Martin Hejl:
- * - use qprintf() where appropriate
- * - save CPU cycles on gettimeofday()
- * - add quit() functions to free allocated memory
- * - fixed lots of memory leaks
- *
- * Revision 1.3  2004/01/29 04:40:02  reinelt
- * every .c file includes "config.h" now
- *
- * Revision 1.2  2003/10/05 17:58:50  reinelt
- * libtool junk; copyright messages cleaned up
- *
- * Revision 1.1  2003/08/08 08:05:23  reinelt
- * added PID file handling
- *
  */
 
 /* 
diff -urN lcd4linux-0.10.0/pid.h lcd4linux-0.11.0-SVN/pid.h
--- lcd4linux-0.10.0/pid.h	2005-05-08 06:32:44.000000000 +0200
+++ lcd4linux-0.11.0-SVN/pid.h	2008-12-31 08:05:54.000000000 +0100
@@ -1,8 +1,9 @@
-/* $Id: pid.h,v 1.4 2005/05/08 04:32:44 reinelt Exp $
+/* $Id: pid.h 840 2007-09-09 12:17:42Z michael $
+ * $URL: https://ssl.bulix.org/svn/lcd4linux/trunk/pid.h $
  *
  * PID file handling
  *
- * Copyright (C) 2003 Michael Reinelt <reinelt@eunet.at>
+ * Copyright (C) 2003 Michael Reinelt <michael@reinelt.co.at>
  * Copyright (C) 2004 The LCD4Linux Team <lcd4linux-devel@users.sourceforge.net>
  *
  * This file is part of LCD4Linux.
@@ -21,20 +22,6 @@
  * along with this program; if not, write to the Free Software
  * Foundation, Inc., 675 Mass Ave, Cambridge, MA 02139, USA.
  *
- *
- * $Log: pid.h,v $
- * Revision 1.4  2005/05/08 04:32:44  reinelt
- * CodingStyle added and applied
- *
- * Revision 1.3  2005/01/18 06:30:23  reinelt
- * added (C) to all copyright statements
- *
- * Revision 1.2  2003/10/05 17:58:50  reinelt
- * libtool junk; copyright messages cleaned up
- *
- * Revision 1.1  2003/08/08 08:05:23  reinelt
- * added PID file handling
- *
  */
 
 #ifndef _PID_H_
diff -urN lcd4linux-0.10.0/plugin_apm.c lcd4linux-0.11.0-SVN/plugin_apm.c
--- lcd4linux-0.10.0/plugin_apm.c	2005-05-08 06:32:44.000000000 +0200
+++ lcd4linux-0.11.0-SVN/plugin_apm.c	2008-12-31 08:05:54.000000000 +0100
@@ -1,8 +1,9 @@
-/* $Id: plugin_apm.c,v 1.6 2005/05/08 04:32:44 reinelt Exp $
+/* $Id: plugin_apm.c 840 2007-09-09 12:17:42Z michael $
+ * $URL: https://ssl.bulix.org/svn/lcd4linux/trunk/plugin_apm.c $
  *
  * plugin for APM (battery status)
  *
- * Copyright (C) 2003 Michael Reinelt <reinelt@eunet.at>
+ * Copyright (C) 2003 Michael Reinelt <michael@reinelt.co.at>
  * Copyright (C) 2004 The LCD4Linux Team <lcd4linux-devel@users.sourceforge.net>
  *
  * based on the old 'battery.c' which is 
@@ -24,32 +25,6 @@
  * along with this program; if not, write to the Free Software
  * Foundation, Inc., 675 Mass Ave, Cambridge, MA 02139, USA.
  *
- *
- * $Log: plugin_apm.c,v $
- * Revision 1.6  2005/05/08 04:32:44  reinelt
- * CodingStyle added and applied
- *
- * Revision 1.5  2005/01/18 06:30:23  reinelt
- * added (C) to all copyright statements
- *
- * Revision 1.4  2004/06/26 12:04:59  reinelt
- *
- * uh-oh... the last CVS log message messed up things a lot...
- *
- * Revision 1.3  2004/06/26 09:27:21  reinelt
- *
- * added '-W' to CFLAGS
- * changed all C++ comments to C ones
- * cleaned up a lot of signed/unsigned mistakes
- *
- * Revision 1.2  2004/06/17 06:23:43  reinelt
- *
- * hash handling rewritten to solve performance issues
- *
- * Revision 1.1  2004/03/14 07:11:42  reinelt
- * parameter count fixed for plugin_dvb()
- * plugin_APM (battery status) ported
- *
  */
 
 /* 
diff -urN lcd4linux-0.10.0/plugin_asterisk.c lcd4linux-0.11.0-SVN/plugin_asterisk.c
--- lcd4linux-0.10.0/plugin_asterisk.c	1970-01-01 01:00:00.000000000 +0100
+++ lcd4linux-0.11.0-SVN/plugin_asterisk.c	2009-01-06 08:16:13.000000000 +0100
@@ -0,0 +1,187 @@
+/* $Id: plugin_asterisk.c 948 2009-01-06 07:16:12Z michael $
+ * $URL: https://ssl.bulix.org/svn/lcd4linux/trunk/plugin_asterisk.c $
+ *
+ * plugin for asterisk
+ *
+ * Copyright (C) 2003 Michael Reinelt <michael@reinelt.co.at>
+ * Copyright (C) 2004, 2005, 2006, 2007 The LCD4Linux Team <lcd4linux-devel@users.sourceforge.net>
+ *
+ * This file is part of LCD4Linux.
+ *
+ * LCD4Linux is free software; you can redistribute it and/or modify
+ * it under the terms of the GNU General Public License as published by
+ * the Free Software Foundation; either version 2, or (at your option)
+ * any later version.
+ *
+ * LCD4Linux is distributed in the hope that it will be useful,
+ * but WITHOUT ANY WARRANTY; without even the implied warranty of
+ * MERCHANTABILITY or FITNESS FOR A PARTICULAR PURPOSE.  See the
+ * GNU General Public License for more details.
+ *
+ * You should have received a copy of the GNU General Public License
+ * along with this program; if not, write to the Free Software
+ * Foundation, Inc., 675 Mass Ave, Cambridge, MA 02139, USA.
+ *
+ */
+
+/* 
+ * exported functions:
+ *
+ * int plugin_init_sample (void)
+ *  adds various functions
+ *
+ */
+
+
+/* define the include files you need */
+#include "config.h"
+#include <string.h>
+#include <stdlib.h>
+#include <string.h>
+#include <ctype.h>
+#include <stdio.h>
+#include "debug.h"
+#include "plugin.h"
+
+#ifdef WITH_DMALLOC
+#include <dmalloc.h>
+#endif
+
+struct Line {
+    char Channel[25];		/* Zap Channel */
+    char EndPoint[25];
+    unsigned char active;
+};
+
+static char *rtrim(char *string, char junk)
+{
+    char *original = string + strlen(string);
+    while (*--original == junk);
+    *(original + 1) = '\0';
+
+    return string;
+}
+
+static void zapstatus(RESULT * result, RESULT * arg1)
+{
+    FILE *infile;
+    int skipline = 0;		// Skip the first in the file, it throws off the detection
+    char line[100], *SipLoc, Channel[25], Location[25], State[9], Application[25], EndPoint[8], Ret[50];
+    int i = 0, ChannelInt = 0, ZapLine = 0;
+    struct Line Lines[32];	// Setup 32 lines, ZAP 1-32 (memory is cheap)
+
+    ZapLine = R2N(arg1);
+
+    // Set all the lines status's default to inactive
+    for (i = 0; i < 32; i++) {
+	strcpy(Lines[i].Channel, "ZAP/");
+	Lines[i].Channel[4] = (char) (i + 49);
+	Lines[i].Channel[5] = '\0';
+	Lines[i].active = 0;
+    }
+
+    system("touch /tmp/asterisk.state");	// Touch the file in it's naughty place
+    system("chmod 744 /tmp/asterisk.state");
+    system("asterisk -rx \"show channels\" > /tmp/asterisk.state");	// Crappy CLI way to do it
+
+    infile = fopen("/tmp/asterisk.state", "r");
+
+    for (i = 0; i < 100; i++) {
+	line[i] = ' ';
+    }
+    line[99] = '\0';
+
+    while (fgets(line, 100, infile) != NULL) {
+	if (strstr(line, "Zap") != NULL) {
+	    for (i = 0; i < (int) strlen(line); i++) {
+		if (i < 20) {
+		    Channel[i] = line[i];
+		} else if (i < 42) {
+		    Location[i - 21] = line[i];
+		} else if (i < 50) {
+		    State[i - 42] = line[i];
+		} else {
+		    Application[i - 50] = line[i];
+		}
+	    }
+	    strncpy(Channel, Channel, 7);
+	    Channel[7] = '\0';
+	    strcpy(Location, rtrim(Location, ' '));
+	    State[4] = '\0';
+	    memcpy(EndPoint, Application + 13, 7);
+	    EndPoint[7] = '\0';
+
+	    if (strstr(Application, "Bridged Call") != NULL) {
+		// Subtract 48 from the character value to get the int
+		// value. Subtract one more because arrays start at 0.
+		ChannelInt = (int) (Channel[4]) - 49;
+		strcpy(Lines[ChannelInt].Channel, Channel);
+		strncpy(Lines[ChannelInt].EndPoint, EndPoint, 8);
+		Lines[ChannelInt].active = 1;
+	    } else {
+		SipLoc = strstr(Application, "SIP");
+		if (SipLoc != NULL) {
+		    strncpy(EndPoint, SipLoc, 7);
+		} else {
+		    EndPoint[0] = '\0';
+		}
+		ChannelInt = (int) (Channel[4]) - 49;
+		strcpy(Lines[ChannelInt].Channel, Channel);
+		Lines[ChannelInt].active = 1;
+	    }
+	} else {
+	    if (strlen(line) > 54 && skipline > 1) {
+		for (i = 55; i < 88; i++) {
+		    if (i < 80) {
+			Channel[i - 55] = line[i];
+		    } else {
+			EndPoint[i - 80] = line[i];
+		    }
+		}
+		strncpy(Channel, rtrim(Channel, ' '), 5);
+		strncpy(EndPoint, rtrim(EndPoint, ' '), 7);
+
+		ChannelInt = (int) (Channel[4]) - 49;
+		strcpy(Lines[ChannelInt].Channel, Channel);
+		strcpy(Lines[ChannelInt].EndPoint, EndPoint);
+		Lines[ChannelInt].active = 1;
+	    }
+	}
+	skipline += 1;
+    }
+    fclose(infile);
+
+    ZapLine -= 1;
+    if (ZapLine < 0 || ZapLine > 31) {
+	memset(Ret, ' ', 50);
+	Ret[0] = '\0';
+	strcat(Ret, "Invalid ZAP #");
+	SetResult(&result, R_STRING, &Ret);
+    } else if (Lines[ZapLine].active == 1) {
+	memset(Ret, ' ', 50);
+	Ret[0] = '\0';
+	strcat(Ret, Lines[ZapLine].Channel);
+	strcat(Ret, " -> ");
+	strncat(Ret, Lines[ZapLine].EndPoint, 8);
+	SetResult(&result, R_STRING, &Ret);
+    } else {
+	memset(Ret, ' ', 50);
+	Ret[0] = '\0';
+	strcat(Ret, Lines[ZapLine].Channel);
+	strcat(Ret, ": inactive");
+	SetResult(&result, R_STRING, &Ret);
+    }
+    return;
+}
+
+int plugin_init_asterisk(void)
+{
+    AddFunction("asterisk::zapstatus", 1, zapstatus);
+    return 0;
+}
+
+void plugin_exit_asterisk(void)
+{
+    /* free any allocated memory */
+    /* close filedescriptors */
+}
diff -urN lcd4linux-0.10.0/plugin_button_exec.c lcd4linux-0.11.0-SVN/plugin_button_exec.c
--- lcd4linux-0.10.0/plugin_button_exec.c	1970-01-01 01:00:00.000000000 +0100
+++ lcd4linux-0.11.0-SVN/plugin_button_exec.c	2008-12-31 08:06:27.000000000 +0100
@@ -0,0 +1,111 @@
+/* $Id: plugin_button_exec.c 901 2008-11-22 23:46:47Z michux $
+ * $URL: https://ssl.bulix.org/svn/lcd4linux/trunk/plugin_button_exec.c $
+ *
+ * plugin that forks and exec's once a key is pressed. the difference to the exec plugin is: this can also only be done once!
+ *
+ * Copyright (C) 2008, Wolfgang Henerbichler <wogri@wogri.com>
+ *
+ * This file is part of LCD4Linux.
+ *
+ * LCD4Linux is free software; you can redistribute it and/or modify
+ * it under the terms of the GNU General Public License as published by
+ * the Free Software Foundation; either version 2, or (at your option)
+ * any later version.
+ *
+ * LCD4Linux is distributed in the hope that it will be useful,
+ * but WITHOUT ANY WARRANTY; without even the implied warranty of
+ * MERCHANTABILITY or FITNESS FOR A PARTICULAR PURPOSE.  See the
+ * GNU General Public License for more details.
+ *
+ * You should have received a copy of the GNU General Public License
+ * along with this program; if not, write to the Free Software
+ * Foundation, Inc., 675 Mass Ave, Cambridge, MA 02139, USA.
+ *
+ */
+
+/* 
+ * exported functions:
+ *
+ * int plugin_init_button_exec(void)
+ *  adds various functions
+ *
+ */
+
+
+/* define the include files you need */
+#include "config.h"
+
+#include <stdlib.h>
+#include <string.h>
+#include <ctype.h>
+#include <unistd.h>
+#include <signal.h>
+#include <errno.h>
+
+/* these should always be included */
+#include "debug.h"
+#include "plugin.h"
+
+#ifdef WITH_DMALLOC
+#include <dmalloc.h>
+#endif
+
+
+
+/* sample function 'button_exec' */
+/* takes as many arguments as you want, first arguemnt is the command that will be called via exec, all the following are parameters you want to add to your command - you won't know what has happened after forking - no return codes available */
+/* Note: all local functions should be declared 'static' */
+
+static void my_button_exec(RESULT * result, int argc, RESULT * argv[])
+{
+    int pid;
+    int i;
+    int errsv;
+    char *args[argc + 1];
+    char *arg;
+    char *prog;
+
+    signal(SIGCHLD, SIG_IGN);
+    prog = R2S(argv[0]);
+    info(prog);
+    for (i = 1; i < argc; i++) {
+	arg = R2S(argv[i]);
+	args[i] = arg;
+	info(arg);
+    }
+    args[0] = prog;
+    args[i] = (char *) 0;
+    pid = fork();
+    if (pid == 0) {		/* child-process */
+	/* char *args[] = {"-r", "-t", "-l", (char *) 0 }; */
+	info("executing program");
+	execvp(prog, args);
+	errsv = errno;
+	info("executing program failed");
+	info(strerror(errsv));
+	exit(0);
+    } else if (pid == -1) {
+	info("weird error has occured. couldn't fork.");
+    } else {
+	SetResult(&result, R_STRING, "0");
+    }
+}
+
+
+/* plugin initialization */
+/* MUST NOT be declared 'static'! */
+int plugin_init_button_exec(void)
+{
+
+    /* register all our cool functions */
+    /* the second parameter is the number of arguments */
+    /* -1 stands for variable argument list */
+    AddFunction("button_exec", -1, my_button_exec);
+    return 0;
+}
+
+void plugin_exit_button_exec(void)
+{
+    /* free any allocated memory */
+    /* close filedescriptors */
+}
diff -urN lcd4linux-0.10.0/plugin.c lcd4linux-0.11.0-SVN/plugin.c
--- lcd4linux-0.10.0/plugin.c	2005-05-08 06:32:44.000000000 +0200
+++ lcd4linux-0.11.0-SVN/plugin.c	2008-12-31 08:05:54.000000000 +0100
@@ -1,8 +1,9 @@
-/* $Id: plugin.c,v 1.38 2005/05/08 04:32:44 reinelt Exp $
+/* $Id: plugin.c 919 2008-12-31 06:10:37Z michael $
+ * $URL: https://ssl.bulix.org/svn/lcd4linux/trunk/plugin.c $
  *
  * plugin handler for the Evaluator
  *
- * Copyright (C) 2003 Michael Reinelt <reinelt@eunet.at>
+ * Copyright (C) 2003 Michael Reinelt <michael@reinelt.co.at>
  * Copyright (C) 2004 The LCD4Linux Team <lcd4linux-devel@users.sourceforge.net>
  *
  * This file is part of LCD4Linux.
@@ -21,165 +22,6 @@
  * along with this program; if not, write to the Free Software
  * Foundation, Inc., 675 Mass Ave, Cambridge, MA 02139, USA.
  *
- *
- * $Log: plugin.c,v $
- * Revision 1.38  2005/05/08 04:32:44  reinelt
- * CodingStyle added and applied
- *
- * Revision 1.37  2005/05/02 10:29:20  reinelt
- * preparations for python bindings and python plugin
- *
- * Revision 1.36  2005/04/03 07:07:51  reinelt
- * added statfs plugin
- *
- * Revision 1.35  2005/01/18 06:30:23  reinelt
- * added (C) to all copyright statements
- *
- * Revision 1.34  2004/06/26 12:04:59  reinelt
- *
- * uh-oh... the last CVS log message messed up things a lot...
- *
- * Revision 1.33  2004/06/26 09:27:21  reinelt
- *
- * added '-W' to CFLAGS
- * changed all C++ comments to C ones
- * cleaned up a lot of signed/unsigned mistakes
- *
- * Revision 1.32  2004/06/07 06:56:55  reinelt
- *
- * added test plugin from Andy Baxter
- *
- * Revision 1.31  2004/05/29 00:27:23  reinelt
- *
- * added plugin_diskstats.c
- *
- * Revision 1.30  2004/05/22 18:30:02  reinelt
- *
- * added plugin 'uptime'
- *
- * Revision 1.29  2004/05/20 07:47:51  reinelt
- * added plugin_time
- *
- * Revision 1.28  2004/04/12 11:12:26  reinelt
- * added plugin_isdn, removed old ISDN client
- * fixed some real bad bugs in the evaluator
- *
- * Revision 1.27  2004/04/09 06:09:55  reinelt
- * big configure rework from Xavier
- *
- * Revision 1.25  2004/04/07 08:29:05  hejl
- * New plugin for wireless info
- *
- * Revision 1.24  2004/03/19 06:37:47  reinelt
- * asynchronous thread handling started
- *
- * Revision 1.23  2004/03/14 07:11:42  reinelt
- * parameter count fixed for plugin_dvb()
- * plugin_APM (battery status) ported
- *
- * Revision 1.22  2004/03/13 06:49:20  reinelt
- * seti@home plugin ported to NextGeneration
- *
- * Revision 1.21  2004/03/10 07:16:15  reinelt
- * MySQL plugin from Javier added
- *
- * Revision 1.20  2004/03/03 03:47:04  reinelt
- * big patch from Martin Hejl:
- * - use qprintf() where appropriate
- * - save CPU cycles on gettimeofday()
- * - add quit() functions to free allocated memory
- * - fixed lots of memory leaks
- *
- * Revision 1.19  2004/02/18 14:45:42  nicowallmeier
- * Imon/Telmon plugin ported
- *
- * Revision 1.18  2004/02/10 07:42:35  reinelt
- * cut off all old-style files which are no longer used with NextGeneration
- *
- * Revision 1.17  2004/02/10 06:54:39  reinelt
- * DVB plugin ported
- *
- * Revision 1.16  2004/01/29 04:40:02  reinelt
- * every .c file includes "config.h" now
- *
- * Revision 1.15  2004/01/27 08:13:39  reinelt
- * ported PPP token to plugin_ppp
- *
- * Revision 1.14  2004/01/25 05:30:09  reinelt
- * plugin_netdev for parsing /proc/net/dev added
- *
- * Revision 1.13  2004/01/16 05:04:53  reinelt
- * started plugin proc_stat which should parse /proc/stat
- * which again is a paint in the a**
- * thinking over implementation methods of delta functions
- * (CPU load, ...)
- *
- * Revision 1.12  2004/01/15 04:29:45  reinelt
- * moved lcd4linux.conf.sample to *.old
- * lcd4linux.conf.sample with new layout
- * new plugins 'loadavg' and 'meminfo'
- * text widget have pre- and postfix
- *
- * Revision 1.11  2004/01/14 11:33:00  reinelt
- * new plugin 'uname' which does what it's called
- * text widget nearly finished
- * first results displayed on MatrixOrbital
- *
- * Revision 1.10  2004/01/13 10:03:01  reinelt
- * new util 'hash' for associative arrays
- * new plugin 'cpuinfo'
- *
- * Revision 1.9  2004/01/11 18:26:02  reinelt
- * further widget and layout processing
- *
- * Revision 1.8  2004/01/10 20:22:33  reinelt
- * added new function 'cfg_list()' (not finished yet)
- * added layout.c (will replace processor.c someday)
- * added widget_text.c (will be the first and most important widget)
- * modified lcd4linux.c so that old-style configs should work, too
- *
- * Revision 1.7  2004/01/10 17:45:26  reinelt
- * changed initialization order so cfg() gets initialized before plugins.
- * This way a plugin's init() can use cfg_get().
- * Thanks to Xavier for reporting this one!
- *
- * Revision 1.6  2004/01/10 17:36:56  reinelt
- *
- * I2C Sensors plugin from Xavier added
- *
- * Revision 1.5  2004/01/06 17:33:45  reinelt
- *
- * Evaluator: functions with variable argument lists
- * Evaluator: plugin_sample.c and README.Plugins added
- *
- * Revision 1.4  2004/01/06 15:19:16  reinelt
- * Evaluator rearrangements...
- *
- * Revision 1.3  2003/12/19 06:27:33  reinelt
- * added XMMS plugin from Markus Keil
- *
- * Revision 1.2  2003/12/19 05:49:23  reinelt
- * extracted plugin_math and plugin_string into extra files
- *
- * Revision 1.1  2003/12/19 05:35:14  reinelt
- * renamed 'client' to 'plugin'
- *
- * Revision 1.1  2003/10/11 06:01:52  reinelt
- *
- * renamed expression.{c,h} to client.{c,h}
- * added config file client
- * new functions 'AddNumericVariable()' and 'AddStringVariable()'
- * new parameter '-i' for interactive mode
- *
- * Revision 1.3  2003/10/06 05:51:15  reinelt
- * functions: min(), max()
- *
- * Revision 1.2  2003/10/06 05:47:27  reinelt
- * operators: ==, \!=, <=, >=
- *
- * Revision 1.1  2003/10/06 04:34:06  reinelt
- * expression evaluator added
- *
  */
 
 /* 
@@ -202,6 +44,118 @@
 #include "plugin.h"
 
 
+char *Plugins[] = {
+    "cfg",
+    "math",
+    "string",
+    "test",
+    "time",
+#ifdef PLUGIN_APM
+    "apm",
+#endif
+#ifdef PLUGIN_ASTERISK
+    "asterisk",
+#endif
+#ifdef PLUGIN_BUTTON_EXEC
+    "button_exec",
+#endif
+#ifdef PLUGIN_CPUINFO
+    "cpuinfo",
+#endif
+#ifdef PLUGIN_DISKSTATS
+    "diskstats",
+#endif
+#ifdef PLUGIN_DVB
+    "dvb",
+#endif
+#ifdef PLUGIN_EXEC
+    "exec",
+#endif
+#ifdef PLUGIN_FIFO
+    "fifo",
+#endif
+#ifdef PLUGIN_FILE
+    "file",
+#endif
+#ifdef PLUGIN_GPS
+    "gps",
+#endif
+#ifdef PLUGIN_HDDTEMP
+    "hddtemp",
+#endif
+#ifdef PLUGIN_I2C_SENSORS
+    "i2c_sensors",
+#endif
+#ifdef PLUGIN_ICONV
+    "iconv",
+#endif
+#ifdef PLUGIN_IMON
+    "imon",
+#endif
+#ifdef PLUGIN_ISDN
+    "isdn",
+#endif
+#ifdef PLUGIN_KVV
+    "kvv",
+#endif
+#ifdef PLUGIN_LOADAVG
+    "loadavg",
+#endif
+#ifdef PLUGIN_MEMINFO
+    "meminfo",
+#endif
+#ifdef PLUGIN_MPD
+    "mpd",
+#endif
+#ifdef PLUGIN_MYSQL
+    "mysql",
+#endif
+#ifdef PLUGIN_NETDEV
+    "netdev",
+#endif
+#ifdef PLUGIN_NETINFO
+    "netinfo",
+#endif
+#ifdef PLUGIN_POP3
+    "pop3",
+#endif
+#ifdef PLUGIN_PPP
+    "ppp",
+#endif
+#ifdef PLUGIN_PROC_STAT
+    "proc_stat",
+#endif
+#ifdef PLUGIN_PYTHON
+    "python",
+#endif
+#ifdef PLUGIN_SAMPLE
+    "sample",
+#endif
+#ifdef PLUGIN_SETI
+    "seti",
+#endif
+#ifdef PLUGIN_STATFS
+    "statfs",
+#endif
+#ifdef PLUGIN_UNAME
+    "uname",
+#endif
+#ifdef PLUGIN_UPTIME
+    "uptime",
+#endif
+#ifdef PLUGIN_W1RETAP
+    "w1retap",
+#endif
+#ifdef PLUGIN_WIRELESS
+    "wireless",
+#endif
+#ifdef PLUGIN_XMMS
+    "xmms",
+#endif
+    NULL,
+};
+
+
 /* Prototypes */
 int plugin_init_cfg(void);
 void plugin_exit_cfg(void);
@@ -216,6 +170,10 @@
 
 int plugin_init_apm(void);
 void plugin_exit_apm(void);
+int plugin_init_asterisk(void);
+void plugin_exit_asterisk(void);
+int plugin_init_button_exec(void);
+void plugin_exit_button_exec(void);
 int plugin_init_cpuinfo(void);
 void plugin_exit_cpuinfo(void);
 int plugin_init_diskstats(void);
@@ -224,20 +182,36 @@
 void plugin_exit_dvb(void);
 int plugin_init_exec(void);
 void plugin_exit_exec(void);
+int plugin_init_fifo(void);
+void plugin_exit_fifo(void);
+int plugin_init_file(void);
+void plugin_exit_file(void);
+int plugin_init_gps(void);
+void plugin_exit_gps(void);
+int plugin_init_hddtemp(void);
+void plugin_exit_hddtemp(void);
 int plugin_init_i2c_sensors(void);
 void plugin_exit_i2c_sensors(void);
 int plugin_init_imon(void);
 void plugin_exit_imon(void);
+int plugin_init_iconv(void);
+void plugin_exit_iconv(void);
 int plugin_init_isdn(void);
 void plugin_exit_isdn(void);
+int plugin_init_kvv(void);
+void plugin_exit_kvv(void);
 int plugin_init_loadavg(void);
 void plugin_exit_loadavg(void);
 int plugin_init_meminfo(void);
 void plugin_exit_meminfo(void);
+int plugin_init_mpd(void);
+void plugin_exit_mpd(void);
 int plugin_init_mysql(void);
 void plugin_exit_mysql(void);
 int plugin_init_netdev(void);
 void plugin_exit_netdev(void);
+int plugin_init_netinfo(void);
+void plugin_exit_netinfo(void);
 int plugin_init_pop3(void);
 void plugin_exit_pop3(void);
 int plugin_init_ppp(void);
@@ -246,6 +220,8 @@
 void plugin_exit_proc_stat(void);
 int plugin_init_python(void);
 void plugin_exit_python(void);
+int plugin_init_sample(void);
+void plugin_exit_sample(void);
 int plugin_init_seti(void);
 void plugin_exit_seti(void);
 int plugin_init_statfs(void);
@@ -254,12 +230,30 @@
 void plugin_exit_uname(void);
 int plugin_init_uptime(void);
 void plugin_exit_uptime(void);
+int plugin_init_w1retap(void);
+void plugin_exit_w1retap(void);
 int plugin_init_wireless(void);
 void plugin_exit_wireless(void);
 int plugin_init_xmms(void);
 void plugin_exit_xmms(void);
 
 
+int plugin_list(void)
+{
+    int i;
+
+    printf("available plugins:\n  ");
+
+    for (i = 0; Plugins[i]; i++) {
+	printf("%s", Plugins[i]);
+	if (Plugins[i + 1])
+	    printf(", ");
+    }
+    printf("\n");
+    return 0;
+}
+
+
 int plugin_init(void)
 {
     plugin_init_cfg();
@@ -271,6 +265,12 @@
 #ifdef PLUGIN_APM
     plugin_init_apm();
 #endif
+#ifdef PLUGIN_ASTERISK
+    plugin_init_asterisk();
+#endif
+#ifdef PLUGIN_BUTTON_EXEC
+    plugin_init_button_exec();
+#endif
 #ifdef PLUGIN_CPUINFO
     plugin_init_cpuinfo();
 #endif
@@ -283,27 +283,51 @@
 #ifdef PLUGIN_EXEC
     plugin_init_exec();
 #endif
+#ifdef PLUGIN_FIFO
+    plugin_init_fifo();
+#endif
+#ifdef PLUGIN_FILE
+    plugin_init_file();
+#endif
+#ifdef PLUGIN_GPS
+    plugin_init_gps();
+#endif
+#ifdef PLUGIN_HDDTEMP
+    plugin_init_hddtemp();
+#endif
 #ifdef PLUGIN_I2C_SENSORS
     plugin_init_i2c_sensors();
 #endif
+#ifdef PLUGIN_ICONV
+    plugin_init_iconv();
+#endif
 #ifdef PLUGIN_IMON
     plugin_init_imon();
 #endif
 #ifdef PLUGIN_ISDN
     plugin_init_isdn();
 #endif
+#ifdef PLUGIN_KVV
+    plugin_init_kvv();
+#endif
 #ifdef PLUGIN_LOADAVG
     plugin_init_loadavg();
 #endif
 #ifdef PLUGIN_MEMINFO
     plugin_init_meminfo();
 #endif
+#ifdef PLUGIN_MPD
+    plugin_init_mpd();
+#endif
 #ifdef PLUGIN_MYSQL
     plugin_init_mysql();
 #endif
 #ifdef PLUGIN_NETDEV
     plugin_init_netdev();
 #endif
+#ifdef PLUGIN_NETINFO
+    plugin_init_netinfo();
+#endif
 #ifdef PLUGIN_POP3
     plugin_init_pop3();
 #endif
@@ -316,6 +340,9 @@
 #ifdef PLUGIN_PYTHON
     plugin_init_python();
 #endif
+#ifdef PLUGIN_SAMPLE
+    plugin_init_sample();
+#endif
 #ifdef PLUGIN_SETI
     plugin_init_seti();
 #endif
@@ -328,6 +355,9 @@
 #ifdef PLUGIN_UPTIME
     plugin_init_uptime();
 #endif
+#ifdef PLUGIN_W1RETAP
+    plugin_init_w1retap();
+#endif
 #ifdef PLUGIN_WIRELESS
     plugin_init_wireless();
 #endif
@@ -344,6 +374,12 @@
 #ifdef PLUGIN_APM
     plugin_exit_apm();
 #endif
+#ifdef PLUGIN_ASTERISK
+    plugin_exit_asterisk();
+#endif
+#ifdef PLUGIN_BUTTON_EXEC
+    plugin_exit_button_exec();
+#endif
 #ifdef PLUGIN_CPUINFO
     plugin_exit_cpuinfo();
 #endif
@@ -356,27 +392,48 @@
 #ifdef PLUGIN_EXEC
     plugin_exit_exec();
 #endif
+#ifdef PLUGIN_FIFO
+    plugin_exit_fifo();
+#endif
+#ifdef PLUGIN_FILE
+    plugin_exit_file();
+#endif
+#ifdef PLUGIN_GPS
+    plugin_exit_gps();
+#endif
 #ifdef PLUGIN_I2C_SENSORS
     plugin_exit_i2c_sensors();
 #endif
+#ifdef PLUGIN_ICONV
+    plugin_exit_iconv();
+#endif
 #ifdef PLUGIN_IMON
     plugin_exit_imon();
 #endif
 #ifdef PLUGIN_ISDN
     plugin_exit_isdn();
 #endif
+#ifdef PLUGIN_KVV
+    plugin_exit_kvv();
+#endif
 #ifdef PLUGIN_LOADAVG
     plugin_exit_loadavg();
 #endif
 #ifdef PLUGIN_MEMINFO
     plugin_exit_meminfo();
 #endif
+#ifdef PLUGIN_MPD
+    plugin_exit_mpd();
+#endif
 #ifdef PLUGIN_MYSQL
     plugin_exit_mysql();
 #endif
 #ifdef PLUGIN_NETDEV
     plugin_exit_netdev();
 #endif
+#ifdef PLUGIN_NETINFO
+    plugin_exit_netinfo();
+#endif
 #ifdef PLUGIN_POP3
     plugin_exit_pop3();
 #endif
@@ -389,6 +446,9 @@
 #ifdef PLUGIN_PYTHON
     plugin_exit_python();
 #endif
+#ifdef PLUGIN_SAMPLE
+    plugin_exit_sample();
+#endif
 #ifdef PLUGIN_SETI
     plugin_exit_seti();
 #endif
@@ -401,6 +461,9 @@
 #ifdef PLUGIN_UPTIME
     plugin_exit_uptime();
 #endif
+#ifdef PLUGIN_W1RETAP
+    plugin_exit_w1retap();
+#endif
 #ifdef PLUGIN_WIRELESS
     plugin_exit_wireless();
 #endif
diff -urN lcd4linux-0.10.0/plugin_cfg.c lcd4linux-0.11.0-SVN/plugin_cfg.c
--- lcd4linux-0.10.0/plugin_cfg.c	2005-05-08 06:32:44.000000000 +0200
+++ lcd4linux-0.11.0-SVN/plugin_cfg.c	2008-12-31 08:05:54.000000000 +0100
@@ -1,8 +1,9 @@
-/* $Id: plugin_cfg.c,v 1.14 2005/05/08 04:32:44 reinelt Exp $
+/* $Id: plugin_cfg.c 840 2007-09-09 12:17:42Z michael $
+ * $URL: https://ssl.bulix.org/svn/lcd4linux/trunk/plugin_cfg.c $
  *
  * plugin for config file access
  *
- * Copyright (C) 2003, 2004 Michael Reinelt <reinelt@eunet.at>
+ * Copyright (C) 2003, 2004 Michael Reinelt <michael@reinelt.co.at>
  * Copyright (C) 2004 The LCD4Linux Team <lcd4linux-devel@users.sourceforge.net>
  *
  * This file is part of LCD4Linux.
@@ -21,71 +22,6 @@
  * along with this program; if not, write to the Free Software
  * Foundation, Inc., 675 Mass Ave, Cambridge, MA 02139, USA.
  *
- *
- * $Log: plugin_cfg.c,v $
- * Revision 1.14  2005/05/08 04:32:44  reinelt
- * CodingStyle added and applied
- *
- * Revision 1.13  2005/03/30 04:57:50  reinelt
- * Evaluator speedup: use bsearch for finding functions and variables
- *
- * Revision 1.12  2005/01/18 06:30:23  reinelt
- * added (C) to all copyright statements
- *
- * Revision 1.11  2004/06/26 12:04:59  reinelt
- *
- * uh-oh... the last CVS log message messed up things a lot...
- *
- * Revision 1.10  2004/06/26 09:27:21  reinelt
- *
- * added '-W' to CFLAGS
- * changed all C++ comments to C ones
- * cleaned up a lot of signed/unsigned mistakes
- *
- * Revision 1.9  2004/06/20 10:09:56  reinelt
- *
- * 'const'ified the whole source
- *
- * Revision 1.8  2004/03/11 06:39:59  reinelt
- * big patch from Martin:
- * - reuse filehandles
- * - memory leaks fixed
- * - earlier busy-flag checking with HD44780
- * - reuse memory for strings in RESULT and hash
- * - netdev_fast to wavid time-consuming regex
- *
- * Revision 1.7  2004/03/06 20:31:16  reinelt
- * Complete rewrite of the evaluator to get rid of the code
- * from mark Morley (because of license issues).
- * The new Evaluator does a pre-compile of expressions, and
- * stores them in trees. Therefore it should be reasonable faster...
- *
- * Revision 1.6  2004/03/03 03:47:04  reinelt
- * big patch from Martin Hejl:
- * - use qprintf() where appropriate
- * - save CPU cycles on gettimeofday()
- * - add quit() functions to free allocated memory
- * - fixed lots of memory leaks
- *
- * Revision 1.5  2004/02/01 19:37:40  reinelt
- * got rid of every strtok() incarnation.
- *
- * Revision 1.4  2004/01/30 20:57:56  reinelt
- * HD44780 patch from Martin Hejl
- * dmalloc integrated
- *
- * Revision 1.3  2004/01/29 04:40:02  reinelt
- * every .c file includes "config.h" now
- *
- * Revision 1.2  2004/01/14 11:33:00  reinelt
- * new plugin 'uname' which does what it's called
- * text widget nearly finished
- * first results displayed on MatrixOrbital
- *
- * Revision 1.1  2004/01/13 10:03:01  reinelt
- * new util 'hash' for associative arrays
- * new plugin 'cpuinfo'
- *
  */
 
 /* 
diff -urN lcd4linux-0.10.0/plugin_cpuinfo.c lcd4linux-0.11.0-SVN/plugin_cpuinfo.c
--- lcd4linux-0.10.0/plugin_cpuinfo.c	2005-05-08 06:32:44.000000000 +0200
+++ lcd4linux-0.11.0-SVN/plugin_cpuinfo.c	2008-12-31 08:05:54.000000000 +0100
@@ -1,8 +1,9 @@
-/* $Id: plugin_cpuinfo.c,v 1.14 2005/05/08 04:32:44 reinelt Exp $
+/* $Id: plugin_cpuinfo.c 840 2007-09-09 12:17:42Z michael $
+ * $URL: https://ssl.bulix.org/svn/lcd4linux/trunk/plugin_cpuinfo.c $
  *
  * plugin for /proc/cpuinfo parsing
  *
- * Copyright (C) 2003 Michael Reinelt <reinelt@eunet.at>
+ * Copyright (C) 2003 Michael Reinelt <michael@reinelt.co.at>
  * Copyright (C) 2004 The LCD4Linux Team <lcd4linux-devel@users.sourceforge.net>
  *
  * This file is part of LCD4Linux.
@@ -21,72 +22,6 @@
  * along with this program; if not, write to the Free Software
  * Foundation, Inc., 675 Mass Ave, Cambridge, MA 02139, USA.
  *
- *
- * $Log: plugin_cpuinfo.c,v $
- * Revision 1.14  2005/05/08 04:32:44  reinelt
- * CodingStyle added and applied
- *
- * Revision 1.13  2005/01/18 06:30:23  reinelt
- * added (C) to all copyright statements
- *
- * Revision 1.12  2004/06/26 12:05:00  reinelt
- *
- * uh-oh... the last CVS log message messed up things a lot...
- *
- * Revision 1.11  2004/06/26 09:27:21  reinelt
- *
- * added '-W' to CFLAGS
- * changed all C++ comments to C ones
- * cleaned up a lot of signed/unsigned mistakes
- *
- * Revision 1.10  2004/06/17 06:23:43  reinelt
- *
- * hash handling rewritten to solve performance issues
- *
- * Revision 1.9  2004/03/11 06:39:59  reinelt
- * big patch from Martin:
- * - reuse filehandles
- * - memory leaks fixed
- * - earlier busy-flag checking with HD44780
- * - reuse memory for strings in RESULT and hash
- * - netdev_fast to wavid time-consuming regex
- *
- * Revision 1.8  2004/03/03 03:47:04  reinelt
- * big patch from Martin Hejl:
- * - use qprintf() where appropriate
- * - save CPU cycles on gettimeofday()
- * - add quit() functions to free allocated memory
- * - fixed lots of memory leaks
- *
- * Revision 1.7  2004/01/29 04:40:02  reinelt
- * every .c file includes "config.h" now
- *
- * Revision 1.6  2004/01/21 10:48:17  reinelt
- * hash_age function added
- *
- * Revision 1.5  2004/01/16 11:12:26  reinelt
- * some bugs in plugin_xmms fixed, parsing moved to own function
- * plugin_proc_stat nearly finished
- *
- * Revision 1.4  2004/01/16 07:26:25  reinelt
- * moved various /proc parsing to own functions
- * made some progress with /proc/stat parsing
- *
- * Revision 1.3  2004/01/15 04:29:45  reinelt
- * moved lcd4linux.conf.sample to *.old
- * lcd4linux.conf.sample with new layout
- * new plugins 'loadavg' and 'meminfo'
- * text widget have pre- and postfix
- *
- * Revision 1.2  2004/01/14 11:33:00  reinelt
- * new plugin 'uname' which does what it's called
- * text widget nearly finished
- * first results displayed on MatrixOrbital
- *
- * Revision 1.1  2004/01/13 10:03:01  reinelt
- * new util 'hash' for associative arrays
- * new plugin 'cpuinfo'
- *
  */
 
 /* 
diff -urN lcd4linux-0.10.0/plugin_diskstats.c lcd4linux-0.11.0-SVN/plugin_diskstats.c
--- lcd4linux-0.10.0/plugin_diskstats.c	2005-05-08 06:32:44.000000000 +0200
+++ lcd4linux-0.11.0-SVN/plugin_diskstats.c	2008-12-31 08:05:54.000000000 +0100
@@ -1,8 +1,9 @@
-/* $Id: plugin_diskstats.c,v 1.8 2005/05/08 04:32:44 reinelt Exp $
+/* $Id: plugin_diskstats.c 840 2007-09-09 12:17:42Z michael $
+ * $URL: https://ssl.bulix.org/svn/lcd4linux/trunk/plugin_diskstats.c $
  *
  * plugin for /proc/diskstats parsing
  *
- * Copyright (C) 2003 Michael Reinelt <reinelt@eunet.at>
+ * Copyright (C) 2003 Michael Reinelt <michael@reinelt.co.at>
  * Copyright (C) 2004 The LCD4Linux Team <lcd4linux-devel@users.sourceforge.net>
  *
  * This file is part of LCD4Linux.
@@ -21,39 +22,6 @@
  * along with this program; if not, write to the Free Software
  * Foundation, Inc., 675 Mass Ave, Cambridge, MA 02139, USA.
  *
- *
- * $Log: plugin_diskstats.c,v $
- * Revision 1.8  2005/05/08 04:32:44  reinelt
- * CodingStyle added and applied
- *
- * Revision 1.7  2005/01/18 06:30:23  reinelt
- * added (C) to all copyright statements
- *
- * Revision 1.6  2004/06/26 12:05:00  reinelt
- *
- * uh-oh... the last CVS log message messed up things a lot...
- *
- * Revision 1.5  2004/06/26 09:27:21  reinelt
- *
- * added '-W' to CFLAGS
- * changed all C++ comments to C ones
- * cleaned up a lot of signed/unsigned mistakes
- *
- * Revision 1.4  2004/06/17 10:58:58  reinelt
- *
- * changed plugin_netdev to use the new fast hash model
- *
- * Revision 1.3  2004/06/17 06:23:43  reinelt
- *
- * hash handling rewritten to solve performance issues
- *
- * Revision 1.2  2004/05/29 01:07:56  reinelt
- * bug in plugin_diskstats fixed
- *
- * Revision 1.1  2004/05/29 00:27:23  reinelt
- *
- * added plugin_diskstats.c
- *
  */
 
 /* 
diff -urN lcd4linux-0.10.0/plugin_dvb.c lcd4linux-0.11.0-SVN/plugin_dvb.c
--- lcd4linux-0.10.0/plugin_dvb.c	2005-05-08 06:32:44.000000000 +0200
+++ lcd4linux-0.11.0-SVN/plugin_dvb.c	2009-01-04 15:14:31.000000000 +0100
@@ -1,8 +1,9 @@
-/* $Id: plugin_dvb.c,v 1.9 2005/05/08 04:32:44 reinelt Exp $
+/* $Id: plugin_dvb.c 939 2009-01-04 14:14:31Z michael $
+ * $URL: https://ssl.bulix.org/svn/lcd4linux/trunk/plugin_dvb.c $
  *
  * plugin for DVB status
  *
- * Copyright (C) 2003 Michael Reinelt <reinelt@eunet.at>
+ * Copyright (C) 2003 Michael Reinelt <michael@reinelt.co.at>
  * Copyright (C) 2004 The LCD4Linux Team <lcd4linux-devel@users.sourceforge.net>
  *
  * This file is part of LCD4Linux.
@@ -21,45 +22,6 @@
  * along with this program; if not, write to the Free Software
  * Foundation, Inc., 675 Mass Ave, Cambridge, MA 02139, USA.
  *
- *
- * $Log: plugin_dvb.c,v $
- * Revision 1.9  2005/05/08 04:32:44  reinelt
- * CodingStyle added and applied
- *
- * Revision 1.8  2005/01/18 06:30:23  reinelt
- * added (C) to all copyright statements
- *
- * Revision 1.7  2004/06/26 12:05:00  reinelt
- *
- * uh-oh... the last CVS log message messed up things a lot...
- *
- * Revision 1.6  2004/06/26 09:27:21  reinelt
- *
- * added '-W' to CFLAGS
- * changed all C++ comments to C ones
- * cleaned up a lot of signed/unsigned mistakes
- *
- * Revision 1.5  2004/06/17 06:23:43  reinelt
- *
- * hash handling rewritten to solve performance issues
- *
- * Revision 1.4  2004/03/14 07:11:42  reinelt
- * parameter count fixed for plugin_dvb()
- * plugin_APM (battery status) ported
- *
- * Revision 1.3  2004/03/03 03:47:04  reinelt
- * big patch from Martin Hejl:
- * - use qprintf() where appropriate
- * - save CPU cycles on gettimeofday()
- * - add quit() functions to free allocated memory
- * - fixed lots of memory leaks
- *
- * Revision 1.2  2004/02/16 13:03:37  reinelt
- * compile problem with missing frontend.h fixed
- *
- * Revision 1.1  2004/02/10 06:54:39  reinelt
- * DVB plugin ported
- *
  */
 
 /* 
@@ -102,6 +64,8 @@
 
 static int get_dvb_stats(void)
 {
+    static int ioc_disable = 0;
+
     int age;
     int fd;
     unsigned short snr, sig;
@@ -120,24 +84,40 @@
 	return -1;
     }
 
-    if (ioctl(fd, FE_READ_SIGNAL_STRENGTH, &sig) != 0) {
+    sig = 0;
+    if ((ioc_disable & 0x01) == 0 && ioctl(fd, FE_READ_SIGNAL_STRENGTH, &sig) != 0) {
 	error("ioctl(FE_READ_SIGNAL_STRENGTH) failed: %s", strerror(errno));
-	sig = 0;
+	if (errno == ENOSYS) {
+	    ioc_disable |= 0x01;
+	    error("ioctl(FE_READ_SIGNAL_STRENGTH) disabled.");
+	}
     }
 
-    if (ioctl(fd, FE_READ_SNR, &snr) != 0) {
+    snr = 0;
+    if ((ioc_disable & 0x02) == 0 && ioctl(fd, FE_READ_SNR, &snr) != 0) {
 	error("ioctl(FE_READ_SNR) failed: %s", strerror(errno));
-	snr = 0;
+	if (errno == ENOSYS) {
+	    ioc_disable |= 0x02;
+	    error("ioctl(FE_READ_SNR) disabled.");
+	}
     }
 
-    if (ioctl(fd, FE_READ_BER, &ber) != 0) {
+    ber = 0;
+    if ((ioc_disable & 0x04) == 0 && ioctl(fd, FE_READ_BER, &ber) != 0) {
 	error("ioctl(FE_READ_BER) failed: %s", strerror(errno));
-	ber = 0;
+	if (errno == ENOSYS) {
+	    ioc_disable |= 0x04;
+	    error("ioctl(FE_READ_BER) disabled.");
+	}
     }
 
-    if (ioctl(fd, FE_READ_UNCORRECTED_BLOCKS, &ucb) != 0) {
+    ucb = 0;
+    if ((ioc_disable & 0x08) == 0 && ioctl(fd, FE_READ_UNCORRECTED_BLOCKS, &ucb) != 0) {
 	error("ioctl(FE_READ_UNCORRECTED_BLOCKS) failed: %s", strerror(errno));
-	ucb = 0;
+	if (errno == ENOSYS) {
+	    ioc_disable |= 0x08;
+	    error("ioctl(FE_READ_UNCORRECTED_BLOCKS) disabled.");
+	}
     }
 
     close(fd);
diff -urN lcd4linux-0.10.0/plugin_exec.c lcd4linux-0.11.0-SVN/plugin_exec.c
--- lcd4linux-0.10.0/plugin_exec.c	2005-05-08 06:32:44.000000000 +0200
+++ lcd4linux-0.11.0-SVN/plugin_exec.c	2008-12-31 08:05:54.000000000 +0100
@@ -1,8 +1,9 @@
-/* $Id: plugin_exec.c,v 1.9 2005/05/08 04:32:44 reinelt Exp $
+/* $Id: plugin_exec.c 840 2007-09-09 12:17:42Z michael $
+ * $URL: https://ssl.bulix.org/svn/lcd4linux/trunk/plugin_exec.c $
  *
  * plugin for external processes
  *
- * Copyright (C) 2004 Michael Reinelt <reinelt@eunet.at>
+ * Copyright (C) 2004 Michael Reinelt <michael@reinelt.co.at>
  * Copyright (C) 2004 The LCD4Linux Team <lcd4linux-devel@users.sourceforge.net>
  *
  * based on the old 'exec' client which is
@@ -25,43 +26,6 @@
  * along with this program; if not, write to the Free Software
  * Foundation, Inc., 675 Mass Ave, Cambridge, MA 02139, USA.
  *
- *
- * $Log: plugin_exec.c,v $
- * Revision 1.9  2005/05/08 04:32:44  reinelt
- * CodingStyle added and applied
- *
- * Revision 1.8  2005/01/18 06:30:23  reinelt
- * added (C) to all copyright statements
- *
- * Revision 1.7  2004/09/24 21:41:00  reinelt
- * new driver for the BWCT USB LCD interface board.
- *
- * Revision 1.6  2004/06/26 12:05:00  reinelt
- *
- * uh-oh... the last CVS log message messed up things a lot...
- *
- * Revision 1.5  2004/06/26 09:27:21  reinelt
- *
- * added '-W' to CFLAGS
- * changed all C++ comments to C ones
- * cleaned up a lot of signed/unsigned mistakes
- *
- * Revision 1.4  2004/06/20 10:09:56  reinelt
- *
- * 'const'ified the whole source
- *
- * Revision 1.3  2004/06/17 06:23:43  reinelt
- *
- * hash handling rewritten to solve performance issues
- *
- * Revision 1.2  2004/04/08 10:48:25  reinelt
- * finished plugin_exec
- * modified thread handling
- * added '%x' format to qprintf (hexadecimal)
- *
- * Revision 1.1  2004/03/20 11:49:40  reinelt
- * forgot to add plugin_exec.c ...
- *
  */
 
 /* 
@@ -174,6 +138,8 @@
 
 static void destroy_exec_thread(const int n)
 {
+    thread_destroy(Thread[n].pid);
+
     if (Thread[n].mutex != 0)
 	mutex_destroy(Thread[n].mutex);
     if (Thread[n].cmd)
diff -urN lcd4linux-0.10.0/plugin_fifo.c lcd4linux-0.11.0-SVN/plugin_fifo.c
--- lcd4linux-0.10.0/plugin_fifo.c	1970-01-01 01:00:00.000000000 +0100
+++ lcd4linux-0.11.0-SVN/plugin_fifo.c	2009-01-13 04:56:18.000000000 +0100
@@ -0,0 +1,222 @@
+/* $Id: plugin_fifo.c 954 2009-01-12 20:16:39Z michux $
+ * $URL: https://ssl.bulix.org/svn/lcd4linux/trunk/plugin_fifo.c $
+ *
+ * plugin template
+ *
+ * Copyright (C) 2008 Michael Vogt <michu@neophob.com>
+ * Copyright (C) 2004, 2005, 2006, 2007, 2008 The LCD4Linux Team <lcd4linux-devel@users.sourceforge.net>
+ *
+ * This file is part of LCD4Linux.
+ *
+ * LCD4Linux is free software; you can redistribute it and/or modify
+ * it under the terms of the GNU General Public License as published by
+ * the Free Software Foundation; either version 2, or (at your option)
+ * any later version.
+ *
+ * LCD4Linux is distributed in the hope that it will be useful,
+ * but WITHOUT ANY WARRANTY; without even the implied warranty of
+ * MERCHANTABILITY or FITNESS FOR A PARTICULAR PURPOSE.  See the
+ * GNU General Public License for more details.
+ *
+ * You should have received a copy of the GNU General Public License
+ * along with this program; if not, write to the Free Software
+ * Foundation, Inc., 675 Mass Ave, Cambridge, MA 02139, USA.
+ *
+ */
+
+/* 
+ * Quick fifo hack for lcd4linux
+ * 
+ * most code is ripped ...
+ *
+ */
+
+/* define the include files you need */
+#include "config.h"
+
+#include <stdlib.h>
+#include <string.h>
+#include <ctype.h>
+#include <errno.h>
+#include <unistd.h>
+#include <fcntl.h>
+#include <sys/stat.h>
+#include <signal.h>
+
+/* these should always be included */
+#include "debug.h"
+#include "plugin.h"
+#include "cfg.h"
+
+#ifdef WITH_DMALLOC
+#include <dmalloc.h>
+#endif
+
+#define FIFO_BUFFER_SIZE 80
+
+typedef struct _FifoData {
+    char *path;
+    int input;
+    int created;
+} FifoData;
+
+static char Section[] = "Plugin:FIFO";
+static FifoData fd;
+static char msg[FIFO_BUFFER_SIZE];
+static char fifopath[1024];
+
+
+static void configure_fifo(void)
+{
+    char *s;
+    memset(fifopath, 0, 1024);
+    s = cfg_get(Section, "fifopath", "/tmp/lcd4linux.fifo");
+    if (*s == '\0') {
+	info("[FIFO] empty '%s.fifopath' entry from %s, assuming '/tmp/lcd4linux.fifo'", Section, cfg_source());
+	strcpy(fifopath, "/tmp/lcd4linux.fifo");
+    } else {
+	strcpy(fifopath, s);
+	info("[FIFO] read '%s.fifopath', value is '%s'", Section, fifopath);
+    }
+    free(s);
+}
+
+
+static void removeFifo(void)
+{
+    debug("Removing FIFO \"%s\"\n", fd.path);
+    if (unlink(fd.path) < 0) {
+	error("Could not remove FIFO \"%s\": %s\n", fd.path, strerror(errno));
+	return;
+    }
+    fd.created = 0;
+}
+
+
+static void closeFifo(void)
+{
+    struct stat st;
+    if (fd.input >= 0) {
+	close(fd.input);
+	fd.input = -1;
+    }
+    if (fd.created && (stat(fd.path, &st) == 0))
+	removeFifo();
+}
+
+static int makeFifo(void)
+{
+    if (mkfifo(fd.path, 0666) < 0) {
+	error("Couldn't create FIFO \"%s\": %s\n", fd.path, strerror(errno));
+	return -1;
+    }
+    fd.created = 1;
+    return 0;
+}
+
+
+static int checkFifo(void)
+{
+    struct stat st;
+    if (stat(fd.path, &st) < 0) {
+	if (errno == ENOENT) {
+
+	    /* Path doesn't exist */
+	    return makeFifo();
+	}
+	error("Failed to stat FIFO \"%s\": %s\n", fd.path, strerror(errno));
+	return -1;
+    }
+    if (!S_ISFIFO(st.st_mode)) {
+	error("\"%s\" already exists, but is not a FIFO\n", fd.path);
+	return -1;
+    }
+    return 0;
+}
+
+
+static int openFifo(void)
+{
+    if (checkFifo() < 0)
+	return -1;
+    fd.input = open(fd.path, O_RDONLY | O_NONBLOCK);
+    if (fd.input < 0) {
+	error("Could not open FIFO \"%s\" for reading: %s\n", fd.path, strerror(errno));
+	closeFifo();
+	return -1;
+    }
+    return 0;
+}
+
+
+static void startFifo(void)
+{
+    static int started = 0;
+
+    if (started)
+	return;
+
+    started = 1;
+
+    configure_fifo();
+    fd.path = fifopath;
+    fd.input = -1;
+    fd.created = 0;
+    openFifo();
+
+    /* ignore broken pipe */
+    signal(SIGPIPE, SIG_IGN);
+
+    memset(msg, 0, FIFO_BUFFER_SIZE);
+
+}
+
+
+static void fiforead(RESULT * result)
+{
+    char buf[FIFO_BUFFER_SIZE];
+    unsigned int i;
+    int bytes = 1;
+
+    startFifo();
+
+    memset(buf, 0, FIFO_BUFFER_SIZE);
+    strcat(buf, "ERROR");
+
+    if (checkFifo() == 0) {
+	memset(buf, 0, FIFO_BUFFER_SIZE);
+
+	while (bytes > 0 && errno != EINTR) {
+	    bytes = read(fd.input, buf, FIFO_BUFFER_SIZE);
+	}
+
+	if (bytes < 0 || (errno > 0 && errno != EAGAIN)) {
+	    error("[FIFO] Error %i: %s", errno, strerror(errno));
+	} else {
+	    if (strlen(buf) > 0) {
+		strcpy(msg, buf);
+	    }
+	    for (i = 0; i < strlen(buf); i++) {
+		if (msg[i] < 0x20)
+		    msg[i] = ' ';
+	    }
+	}
+    }
+    /* store result */
+    SetResult(&result, R_STRING, msg);
+}
+
+
+/* plugin initialization */
+int plugin_init_fifo(void)
+{
+    AddFunction("fifo::read", 0, fiforead);
+    return 0;
+}
+
+
+void plugin_exit_fifo(void)
+{
+    /* close filedescriptors */
+    closeFifo();
+}
diff -urN lcd4linux-0.10.0/plugin_file.c lcd4linux-0.11.0-SVN/plugin_file.c
--- lcd4linux-0.10.0/plugin_file.c	1970-01-01 01:00:00.000000000 +0100
+++ lcd4linux-0.11.0-SVN/plugin_file.c	2008-12-31 08:06:27.000000000 +0100
@@ -0,0 +1,106 @@
+/* $Id: plugin_file.c 782 2007-03-21 05:01:11Z michael $
+ * $URL: https://ssl.bulix.org/svn/lcd4linux/trunk/plugin_file.c $
+ *
+ * plugin to perform simple file operations
+ *
+ * Copyright (C) 2006 Chris Maj <cmaj@freedomcorpse.com>
+ * Copyright (C) 2006 The LCD4Linux Team <lcd4linux-devel@users.sourceforge.net>
+ *
+ * This file is part of LCD4Linux.
+ *
+ * LCD4Linux is free software; you can redistribute it and/or modify
+ * it under the terms of the GNU General Public License as published by
+ * the Free Software Foundation; either version 2, or (at your option)
+ * any later version.
+ *
+ * LCD4Linux is distributed in the hope that it will be useful,
+ * but WITHOUT ANY WARRANTY; without even the implied warranty of
+ * MERCHANTABILITY or FITNESS FOR A PARTICULAR PURPOSE.  See the
+ * GNU General Public License for more details.
+ *
+ * You should have received a copy of the GNU General Public License
+ * along with this program; if not, write to the Free Software
+ * Foundation, Inc., 675 Mass Ave, Cambridge, MA 02139, USA.
+ *
+ */
+
+/* 
+ * exported functions:
+ *
+ * int plugin_init_file (void)
+ *  adds various functions
+ *
+ */
+
+
+/* define the include files you need */
+#include "config.h"
+
+#include <stdio.h>
+#include <string.h>
+
+/* these should always be included */
+#include "debug.h"
+#include "plugin.h"
+
+#ifdef WITH_DMALLOC
+#include <dmalloc.h>
+#endif
+
+
+/* function 'readline' */
+/* takes two arguments, file name and line number */
+/* returns text of that line */
+
+static void my_readline(RESULT * result, RESULT * arg1, RESULT * arg2)
+{
+    char value[80], val2[80];
+    FILE *fp;
+    int reqline, i, size;
+
+    reqline = R2N(arg2);
+    fp = fopen(R2S(arg1), "r");
+    if (!fp) {
+	error("readline couldn't open file '%s'", R2S(arg1));
+	value[0] = '\0';
+    } else {
+	i = 0;
+	while (!feof(fp) && i++ < reqline) {
+	    fgets(val2, sizeof(val2), fp);
+	    size = strcspn(val2, "\r\n");
+	    strncpy(value, val2, size);
+	    value[size] = '\0';
+	    /* more than 80 chars, chew up rest of line */
+	    while (!feof(fp) && strchr(val2, '\n') == NULL) {
+		fgets(val2, sizeof(val2), fp);
+	    }
+	}
+	fclose(fp);
+	if (i <= reqline) {
+	    error("readline requested line %d but file only had %d lines", reqline, i - 1);
+	    value[0] = '\0';
+	}
+    }
+
+    /* store result */
+    SetResult(&result, R_STRING, &value);
+}
+
+/* plugin initialization */
+/* MUST NOT be declared 'static'! */
+int plugin_init_file(void)
+{
+
+    /* register all our cool functions */
+    /* the second parameter is the number of arguments */
+    /* -1 stands for variable argument list */
+    AddFunction("file::readline", 2, my_readline);
+
+    return 0;
+}
+
+void plugin_exit_file(void)
+{
+    /* free any allocated memory */
+    /* close filedescriptors */
+}
diff -urN lcd4linux-0.10.0/plugin_gps.c lcd4linux-0.11.0-SVN/plugin_gps.c
--- lcd4linux-0.10.0/plugin_gps.c	1970-01-01 01:00:00.000000000 +0100
+++ lcd4linux-0.11.0-SVN/plugin_gps.c	2008-12-31 08:05:54.000000000 +0100
@@ -0,0 +1,725 @@
+/* $Id: plugin_gps.c 860 2008-03-03 17:03:00Z michux $
+ * $URL: https://ssl.bulix.org/svn/lcd4linux/trunk/plugin_gps.c $
+ *
+ * gps plugin (nmea), code by michu / www.neophob.com, based on nmeap, http://sourceforge.net/projects/nmeap/
+ *
+ * Copyright (C) 2007 Michu - http://www.neophob.com
+ * Copyright (C) 2004, 2005, 2006, 2007 The LCD4Linux Team <lcd4linux-devel@users.sourceforge.net>
+ *
+ * This file is part of LCD4Linux.
+ *
+ * LCD4Linux is free software; you can redistribute it and/or modify
+ * it under the terms of the GNU General Public License as published by
+ * the Free Software Foundation; either version 2, or (at your option)
+ * any later version.
+ *
+ * LCD4Linux is distributed in the hope that it will be useful,
+ * but WITHOUT ANY WARRANTY; without even the implied warranty of
+ * MERCHANTABILITY or FITNESS FOR A PARTICULAR PURPOSE.  See the
+ * GNU General Public License for more details.
+ *
+ * You should have received a copy of the GNU General Public License
+ * along with this program; if not, write to the Free Software
+ * Foundation, Inc., 675 Mass Ave, Cambridge, MA 02139, USA.
+ *
+ */
+
+/* 
+ * GPS Plugin for lcd4linux, by michael vogt / http://www.neophob.com
+ * contact: michu@neophob.com
+ *
+ * based on nmeap by daveh, http://www.dmh2000.com/ or http://sourceforge.net/projects/nmeap/
+ * you need a compiled libnmeap to compile this plugin.
+ *
+ * History:
+ * 	v0.1 -initial release
+ *	v0.2 -fix include files, include <termios.h> and <asm/fcntl.h> (embedded devices)
+ *           -fixed emulation mode (read only x bytes instead of the whole emulated nmea data)
+ *  	     -improved error handling (if there are no parameters defined, lcd4linx will display "GPS ARG ERR")
+ *	     -display raw nmea string from the gps receiver
+ *	     -added support for gps device with 9600 baud (env. variable)
+ *	     -added the option that the widget graps data from the buffer and not from the gps device (usefull for multible widgets)
+ *      v0.3 -improved nmea parsing
+ *           -improved gps-emulator
+ *           -time is now updated with rmc and gga sentence
+ *
+ * TODO:
+ *	-update direction only when speed > 5 kmh
+ *	-add more data fields
+ *	-dump nmea string to external file
+ *
+ * Exported functions:
+ * int plugin_init_gps (void) - default plugin initialisation
+ * void parse(SHOW-OPTIONS, DISPLAY-OPTIONS)
+ * 	display option define, what the plugin should display
+ *
+ *	OPTION:						EXAMPLE:
+ *	-------						--------
+ *
+ * PARAMETER 1:
+ * 	#define SHOW_ALTITUDE 		0x000000001	alt:500
+ * 	#define SHOW_SPEED 		0x000000010	spd:30
+ * 	#define SHOW_COURSE 		0x000000100	dir:NO
+ * 	#define SHOW_SATELLITES 	0x000001000	sat:4
+ * 	#define SHOW_QUALITY 		0x000010000	qua:1
+ * 	#define SHOW_STATUS 		0x000100000	sta:V
+ *	#define SHOW_TIME_UTC   	0x001000000	utc:113459
+ *	#define SHOW_DATE 		0x010000000	dat:190204 (19.02.2004)
+ *
+ * PARAMETER 2: 
+ *	#define OPTION_NO_PREFIX 	0x000000001	disable prefix (example, instead of "alt:500" it displays "500"
+ *	#define OPTION_SPEED_IN_KNOTS 	0x000000010	when use the SHOW_SPEED option, display speed in knots instead in km/h
+ *	#define OPTION_RAW_NMEA 	0x000000100	outputs the parsed nmea string, only valid when EMULATE is not defined!
+ *	#define OPTION_GET_BUFFERDATA	0x000001000	when you define more than 1 gps widget
+ *							each widget will get updates and cause some ugly side effects, specially when you display the time
+ *							by enabling this option, the widget will not read any nmea data from the serial port.
+ *							KEEP IN MIND that there must be ONE widget which get buffered data (means read data from the port)
+ *
+ *      #define SHOW_NMEA_STATUS        0x010000000	OK:0033/Error:0002/Incomplete:0002
+ *
+ *
+ *	Examples:  
+ *		- gps::parse('0x011','0') will display the altitude and speed -> alt:500 spd:43
+ *		- gps::parse('0x01100','0') will display the course and the numbers of satellites -> dir:NO sat:3
+ *		- gps::parse('0x01','0x01') will display the speed without prefix -> 50
+ *		- gps::parse('0x01','0x01') will display the speed in knots without prefix -> 27
+ *
+ * ENV VARIABLES
+ *	To finetune plugin_gps you may define some env variables:
+ *		GPS_PORT	gps device, default value is /dev/usb/tts/1
+ *		GPS_9600	serial port speed, default is 4800 baud, if you define this var speed will be 9600 (export GPS_9600=dummy)
+ */
+
+
+/* define the include files you need */
+#include "config.h"
+
+#include <stdio.h>
+#include <stdlib.h>
+#include <string.h>
+#include <ctype.h>
+#include <unistd.h>
+#include <termios.h>		//used for serial port flags
+#include <asm/fcntl.h>
+
+
+/* these should always be included */
+#include "debug.h"
+#include "plugin.h"
+
+#ifdef WITH_DMALLOC
+#include <dmalloc.h>
+#endif
+
+#include "nmeap.h"
+
+//#define EMULATE                       //remove comment to enable gps data emulation...
+#define EMU_BUFFER_READ_SIZE 128	//how many bytes are read each loop aka emulation speed
+#define BUFFER_SIZE 256
+
+#define SHOW_ALTITUDE 		0x000000001
+#define SHOW_SPEED 		0x000000010
+#define SHOW_COURSE 		0x000000100
+#define SHOW_SATELLITES 	0x000001000
+#define SHOW_QUALITY 		0x000010000
+#define SHOW_STATUS 		0x000100000
+#define SHOW_TIME_UTC 		0x001000000
+#define SHOW_DATE 		0x010000000
+
+#define OPTION_NO_PREFIX 	0x000000001
+#define OPTION_SPEED_IN_KNOTS 	0x000000010
+#define OPTION_RAW_NMEA 	0x000000100	//outputs the parsed nmea string, only valid when EMULATE is not defined!
+#define OPTION_GET_BUFFERDATA	0x000001000	//when you define more than 1 gps widget
+						//each widget will get updates and cause some ugly side effects, specially when you display the time
+						//by enabling this option, the widget will not read any nmea data from the serial port.
+						//KEEP IN MIND that there must be ONE widget which does not get buffered data (means read data from the port)
+#define OPTION_DEBUG		0x000010000
+#define SHOW_NMEA_STATUS	0x010000000
+
+static float course = 0.f;	//degrees
+static float altitude = 0.f;
+static float speed = 0.f;	//Speed over ground in KNOTS!!
+static int satellites = 0;	//Number of satellites in use (00-12)
+static int quality = 0;		//GPS quality indicator (0 - fix not valid, 1 - GPS fix, 2 - DGPS fix) 
+static char gpsStatus = 'V';	//A=active or V=Void 
+static unsigned long gpsTime = 0;	//UTC of position fix in hhmmss format 
+static unsigned long gpsDate = 0;	//Date in ddmmyy format
+
+static int msgCounter = 0;	//parsed nmea-sentence
+static int errCounter = 0;	//parsed error nmea-sentence
+static int incomplCounter = 0;	//incomplete parsed nmea-sentence
+/* ---------------------------------------------------------------------------------------*/
+/* STEP 1 : allocate the data structures. be careful if you put them on the stack because */
+/*          they need to be live for the duration of the parser                           */
+/* ---------------------------------------------------------------------------------------*/
+static nmeap_context_t nmea;	/* parser context */
+static nmeap_gga_t gga;		/* this is where the data from GGA messages will show up */
+static nmeap_rmc_t rmc;		/* this is where the data from RMC messages will show up */
+static int user_data;		/* user can pass in anything. typically it will be a pointer to some user data */
+
+static int fd_g;		/* port handler */
+static unsigned int emu_read_ofs = 0;
+static int debug = 0;		//debug flag
+
+static char Name[] = "plugin_gps.c";
+
+static int fndStr = 0;		//how many bytes were saved from the last read
+static char backBuffer[BUFFER_SIZE];	//the buffer to save incomplete nmea strings
+
+
+#ifdef EMULATE
+char test_vector[] = {
+/*    "$GPGGA,123519,3929.946667,N,11946.086667,E,1,08,0.9,545.4,M,46.9,M,,*4A\r\n"	// good
+	"$xyz,1234,asdfadfasdfasdfljsadfkjasdfk\r\n"	// junk 
+	"$GPRMC,225446,A,4916.45,N,12311.12,W,000.5,054.7,191194,020.3,E*68\r\n"	// good 
+	"$GPRMC,225446,A,4916.45,N,12311.12,W,000.5,054.7,191194,020.3,E*48\r\n"	// checksum error 
+	"$GPRMC,165110.000,A,5601.0318,N,01211.3503,E,0.09,28.11,190706,,*35\r\n"	//some more data
+    "$GPGGA,165111.000,5601.0318,N,01211.3503,E,1,07,1.2,22.3,M,41.6,M,,0000*65\r\n"
+	"$GPRMC,165111.000,A,5601.0318,N,01211.3503,E,0.08,43.53,190706,,*3E\r\n"
+	"$GPGGA,165112.000,5601.0318,N,01211.3503,E,1,07,1.2,22.3,M,41.6,M,,0000*66\r\n"
+	"$GPRMC,165112.000,A,5601.0318,N,01211.3503,E,0.08,37.38,190706,,*33\r\n"
+	"$GPGGA,165113.000,5601.0318,N,01211.3503,E,1,07,1.2,22.4,M,41.6,M,,0000*60\r\n"
+	"$GPRMC,165113.000,A,5601.0318,N,01211.3503,E,0.11,21.03,190706,,*35\r\n"
+	"$GPGGA,165114.000,5601.0318,N,01211.3504,E,1,07,1.2,22.6,M,41.6,M,,0000*62\r\n"
+	"$GPRMC,165114.000,A,5601.0318,N,01211.3504,E,0.08,45.67,190706,,*3D\r\n"
+	"$GPGGA,165115.000,5601.0318,N,01211.3504,E,1,07,1.2,22.7,M,41.6,M,,0000*62\r\n"
+	"$GPRMC,165115.000,A,5601.0318,N,01211.3504,E,0.10,59.41,190706,,*3C\r\n"
+	"$GPGGA,165116.000,5601.0318,N,01211.3504,E,1,07,1.2,22.8,M,41.6,M,,0000*6E\r\n"
+	"$GPRMC,165116.000,A,5601.0318,N,01211.3504,E,0.06,50.22,190706,,*34\r\n"
+	"$GPGGA,165117.000,5601.0318,N,01211.3505,E,1,07,1.2,22.9,M,41.6,M,,0000*6F\r\n"
+	"$GPRMC,165117.000,A,5601.0318,N,01211.3505,E,0.08,45.32,190706,,*3F\r\n"
+	"$GPGGA,165118.000,5601.0318,N,01211.3505,E,1,07,1.2,23.0,M,41.6,M,,0000*68\r\n"
+	"$GPRMC,165118.000,A,5601.0318,N,01211.3505,E,0.10,37.49,190706,,*30\r\n"*/
+    "$GPGGA,165119.000,5601.0318,N,01211.3504,E,1,06,1.2,23.0,M,41.6,M,,0000*69\r\n"
+	"$GPRMC,165119.000,A,5601.0318,N,01211.3504,E,0.08,27.23,190706,,*34\r\n"
+	"$GPGGA,165120.000,5601.0318,N,01211.3504,E,1,07,1.2,23.0,M,41.6,M,,0000*62\r\n"
+	"$GPRMC,165120.000,A,5601.0318,N,01211.3504,E,0.08,41.52,190706,,*38\r\n"
+	"$GPGGA,165121.000,5601.0319,N,01211.3505,E,1,07,1.2,23.1,M,41.6,M,,0000*62\r\n"
+	"$GPRMC,165121.000,A,5601.0319,N,01211.3505,E,0.09,57.19,190706,,*30\r\n"
+	"$GPGGA,165122.000,5601.0319,N,01211.3505,E,1,07,1.2,23.2,M,41.6,M,,0000*62\r\n"
+	"$GPRMC,165122.000,A,5601.0319,N,01211.3505,E,0.10,30.60,190706,,*34\r\n"
+	"$GPGGA,165123.000,5601.0319,N,01211.3505,E,1,07,1.2,23.3,M,41.6,M,,0000*62\r\n"
+	"$GPRMC,165123.000,A,5601.0319,N,01211.3505,E,0.07,45.49,190706,,*3A\r\n"
+	"$GPGGA,165124.000,5601.0319,N,01211.3505,E,1,07,1.2,23.4,M,41.6,M,,0000*62\r\n"
+	"$GPRMC,165124.000,A,5601.0319,N,01211.3505,E,0.09,34.85,190706,,*35\r\n"
+	"$GPGGA,165125.000,5601.0319,N,01211.3506,E,1,07,1.2,23.4,M,41.6,M,,0000*60\r\n"
+	"$GPRMC,165125.000,A,5601.0319,N,01211.3506,E,0.06,43.06,190706,,*33\r\n"
+	"$GPGGA,165126.000,5601.0319,N,01211.3506,E,1,07,1.2,23.4,M,41.6,M,,0000*63\r\n"
+	"$GPRMC,165126.000,A,5601.0319,N,01211.3506,E,0.10,37.63,190706,,*37\r\n"
+	"$GPGGA,165127.000,5601.0319,N,01211.3505,E,1,07,1.2,23.4,M,41.6,M,,0000*61\r\n"
+	"$GPRMC,165127.000,A,5601.0319,N,01211.3505,E,0.07,42.23,190706,,*35\r\n"
+	"$GPGGA,165128.000,5601.0319,N,01211.3505,E,1,07,1.2,23.4,M,41.6,M,,0000*6E\r\n"
+	"$GPRMC,165128.000,A,5601.0319,N,01211.3505,E,0.09,27.98,190706,,*37\r\n"
+	"$GPGGA,165129.000,5601.0319,N,01211.3505,E,1,07,1.2,23.3,M,41.6,M,,0000*68\r\n"
+	"$GPRMC,165129.000,A,5601.0319,N,01211.3505,E,0.08,51.89,190706,,*36\r\n"
+	"$GPGGA,165130.000,5601.0319,N,01211.3505,E,1,07,1.2,23.2,M,41.6,M,,0000*61\r\n"
+	"$GPRMC,094055.000,A,5409.998645,N,00859.370546,E,0.044,0.00,301206,,,A*55\r\n"
+	"$GPGGA,094056.000,5409.998657,N,00859.370528,E,1,12,0.82,-5.168,M,45.414,M,,*47\r\n"
+	"$GPRMC,094056.000,A,5409.998657,N,00859.370528,E,0.263,0.00,301206,,,A*5A\r\n"
+	"$GPGGA,094057.000,5409.998726,N,00859.370512,E,1,12,0.82,-5.171,M,45.414,M,,*40\r\n"
+	"$GPRMC,094057.000,A,5409.998726,N,00859.370512,E,0.311,0.00,301206,,,A*51\r\n"
+	"$GPGGA,094058.000,5409.998812,N,00859.370518,E,1,12,0.82,-5.172,M,45.414,M,,*4E\r\n"
+	"$GPRMC,094058.000,A,5409.998812,N,00859.370518,E,0.423,0.00,301206,,,A*5A\r\n"
+	"$GPGGA,094059.000,5409.998934,N,00859.370505,E,1,12,0.82,-5.177,M,45.414,M,,*43\r\n"
+	"$GPRMC,094059.000,A,5409.998934,N,00859.370505,E,0.576,0.00,301206,,,A*53\r\n"
+	"$GPGGA,094100.000,5409.999097,N,00859.370542,E,1,12,0.82,-5.177,M,45.414,M,,*4C\r\n"
+	"$GPRMC,094100.000,A,5409.999097,N,00859.370542,E,0.705,0.00,301206,,,A\r\n"
+	"$GPGGA,004037.851,0000.0000,N,00000.0000,E,0,00,50.0,0.0,M,0.0,M,0.0,0000*7A\r\n"
+	"$GPGGA,175218.255,4657.3391,N,00726.2666,E,1,04,9.0,568.6,M,48.0,M,0.0,0000*7B\r\n"
+	"$GPGSA,A,3,26,29,17,12,,,,,,,,,9.5,9.08\r\n"
+	"$GPRMC,175218.255,A,4657.3391,N,00726.2666,E,0.$GPGGA,175219.255,4657.3391,N,00726.2666,E,1,04,9.0,568.5,M,48.0,M,0.0,0000*79\r\n"
+	"$GPGSA,A,3,26,29,17,12,,,,,,,,,9.5,9.0,2.7*38\r\n"
+	"$7,,*06\r\n"
+	"$GPGGA,175220.255,4657.3392,N,00726.2667,E,1,04,9.0,568.4,M,48.0,M,0.0,0000*70\r\n"
+	"$GPGSA,A,3,26,29,17,12,,,,$GPGGA,175221.255,4657.3392,N,00726.2667,E,1,04,9.0,568.3,M,48.0,M,0.0,0000*76\r\n"
+	"$GPGSA,A,3,26,29,17,12,,,,,,,,,9.5,9.0,2.7*38\r\n"
+	"$GPRMC,175221.255,A,4657.3392,N,00726.2667,E,0.14,150.24,230507,,*0A\r\n"
+	"$GPGGA,175222.255,4657.3393,N,00726.2668,E,1,04,9.0,568,29,17,12,,,,,,,,,9.5,9.0,2.7*38\r\n"
+	"$GPGSV,2,1,08,26,71,153,45,29,60,14$GPGGA,175223.255,4657.3393,N,00726.2669,E,1,04,9.0,568.2,M,48.0,M,7.3393,N,00726.2669,E,0.11,141.32,230507,,*05\r\n"
+	"$GPGGA,175224.255,4657.3394,N,00726.2670,E,1,04,9.0,568.0,M,48.0,M,0.0,0000*70\r\n"
+	"$GPGSA,$GPGGA,175225.255,4657.3395,N,00726.2670,E,1,04,9.0,567.8,M,48.0,M,0.0,0000*77\r\n"
+	"$GPGSA,A,3,26,29,17,12,,,,,,,,,9.5,9.0,2.7*38\r\n"
+	"$GPRMC,175225.255,A,4657.3395,N,00726.2670,E,0.10,146.99,230507,,*0A\r\n"
+	"$GPGGA,175226.255,465567.5,M,48.0,M,0.0,0000*7B\r\n"
+	"$GPGSA,A,3,26,29,17,12$GPGGA,175227.255,4657.3397,N,00726.2671,E,1,04,9.0,567.1,M,48.0,M,0.0,0000*7F\r\n"
+	"$.7*38\r\n"
+	"$GPGSV,2,1,08,26,71,153,46,29,60,149,46,09,55,286,00,28,32,051$GPGGA,175228.254,4657.3399,N,00726.2672,E,1,04,9.0,566.8,M,48.0,M,0.0,0000*74\r\n"
+	"$GPGSA,A,3,26,29,17,12,,,,,,,,,9.72,E,0.12,146.43,230507,,*0D\r\n"
+	"$GPGGA,175229.254,4657.3400,N,00726.2673,E,1,04,9.0,566.4,M,48.0,M,0.0,0000*7F\r\n"
+	"$GPGSA,A,3,26,29,17,1$GPGGA,175230.254,4657.3401,N,00726.2675,E,1,04,9.0,566.0,M,48.0,M,0.0,0000*74\r\n"
+	"$GPGSA,A,3,26,29,17,12$GPGGA,175231.254,4657.3402,N,00726.2676,E,1,04,9.0,565.7,M,48.0,M,0.0,0000*71\r\n"
+	"$GPGSA,A,3,26,29,17,12,,,,,,,,,9.5,9.0,2.7*38\r\n"
+	"$GPRMC,175231.2$GPGGA,175232.254,4657.3404,N,00726.2677,E,1,04,9.,153,45,29,60,149,46,09,55,286,00,28,32,051,00*7F\r\n"
+	"$GPGSV,2,2,08,17,32,102,38,18,28,298,00,12,12,21$GPGGA,175233.254,4657.3405,N,00726.2678,E,1,04,9.0,565.1,M,48.0,M,0.0,0000*7C\r\n"
+	"$GPGSA,A,3,26,29,17,12,,,,,,,,,9.5,9.0,2.6*39\r\n"
+	"$,*09\r\n"
+	"$GPGGA,175234.254,4657.3406,N,00726.2679,E,1,04,9.0,564.9,M,48.0,M,0.0,0000*70\r\n"
+	"$GPGSA,A,3,26,29,17,12,,,,,,,,,9.5,9.0,2.6*39\r\n"
+	"$GPRMC,175234.254,A,4657.3$GPGGA,175235.254,4657.3408,N,00726.2680,E,1,04,9.00,M,0.0,0000*76\r\n"
+	"$GPGSA,A,3,26,$GPGGA,175236.254,439\r\n"
+	"$GPRMC,175236.254,A,4657.3409,N,00726.2681,E,0.14,142.56,230507,,*06\r\n"
+	"$GPGGA,175237.254,4657.3410,N,00726.2682,E,1,04,9.0,564.5,M,48.0,M,0.0,0000*7C\r\n"
+	"$GPGSA,A,3,26,29,17,12,,,,00,28,32,051,00*7F\r\n"
+	"$GPGSV,2,2,08,17,32,102,39,18,28,298,00,12,12,218,35,22,09,3$GPGGA,175238.254,4657.3411,N,00726.2682,E,1,04$GPGGA,175239.254,4657.3412,N,00726.2683,E,1,04,9.0,564.7,M,48.0,M,0.0,0000*73\r\n"
+	"$GPGSA,A,3,26,29,17,12,,,,,,,,,9.5,9.0,2.6*39\r\n"
+	"$GPRMC,175239.254,A,4657.3412,N$GPGGA,175240.254,4657.3412,N,00726.2684,E,1,04,9.0,564.8,M,48.0,M,0.0,0000*75\r\n"
+	"$GPGSA,A,3,26,29,17,12,,,,,,,,,9.5,9.0,2.6*39\r\n"
+	"$GPRMC,$GPGGA,175241.254,4657.3413,N,00726.2684,E,1,04,9.0,565.1,M,48.0,M,0.0,0000*7D\r\n"
+	",,,,,,,,9.5,9.0,2.6*39\r\n"
+	"$GPRMC,175241.254,A,4657.3413,N,00726.2684,E,0.$GPGGA,175242.254,4657.3413,N,00726.2684,E,1,04,9.0,565.3,M,48.0,M,0.0,0000*7C\r\n"
+	"$GPGSA,A,3,26,29,179,60,149,46,09,55,286,00,28,32,051,00*7C\r\n"
+	"$GPGS$GPGGA,175243.254,4657.3414,N,00726.2685,E,1,04,9.0,565.7,M,48.0,M,0.0,0000*7F\r\n"
+	"$GPGSA,A,3$GPGGA,175244.253,4657.3414,N,00726.2685,E,1,04,9.0,566.0,M,48.0,M,0.0,0000*7B\r\n"
+	"$GPGSA,A,3,26,29,17,12,,,,,,,,,9.5,9.0,2.6*39\r\n"
+	"$GPGGA,175245.253,4657.3415,N,00726.2685,E,1,04,9.0,566.3,M,48.0,M,0.0,0000*78\r\n"
+	"$GPGSA,A,3,26,29,17,12,,,,,,,,,9.5,9.0,2.6*39\r\n"
+	"$GPRMC,175245.253,A,4657.3415,N,00726.2685,E,0.2$GPGGA,175246.253,4657.3415,N,00726.2686,E,1,04,9.0,566.5,M,48.0,M,0.0,0000*7E\r\n"
+	",175246.253,A,4657.3415,N,00726.2686,E,0.13,145$GPGGA,175247.253,4657.3416,N,00726.2686,E,1,04,9.0,566.8,M,48.0,M,0.0,0000*71\r\n"
+	"$GPGSA,A,3,26,17,32,101,39*7D\r\n"
+	"$GPGSV,2,2,08,28,32,051,00,18,$GPGGA,175248.253,4657.3417,N,00726.2686,E,1,04,9.0,567.0,M,48.0,M,0.0,0000*76\r\n"
+	"$GPGSA,A,3,26,29$GPGGA,175249.253,4657.3417,N,00726.2686,E,1,04.3,M,48.0,M,0.0,0000*7$GPGGA,175250.253,4657.3418,N,00726.2686,E,1,04,9.0,567.4,M,48.0,M,0.0,0000*74\r\n"
+	".5,9.0,2.6*39\r\n"
+	"$GPRMC,175250.253,A,4657.3$GPGGA,175251.253,4657.3418,N,00726.2687,E,1,04,9.0,567.5,M,48.0,M,0.0,0000*75\r\n"
+	"$GPGSA,A,3,26,29,17,12,,,,,,,,,9.5,9.0,2.6*39\r\n"
+	".2687,E,0.14,146.26,230507,,*05\r\n"
+	"$GPGGA,175252.253,4657.,00,18,28,298,00,12,12,218,36,22,09,326,00*7E\r\n"
+	"$GPRMC,175252.253,A,4657.3419,N,04,9.0,567.9,M,48.0,M,0.0,0000*7A\r\n"
+	"$GPGSA,A,3,26,29,17,12,,,,,,,,,9.5,9.0,2.6*39\r\n"
+	"$GPRMC,175253.253,A,4657.$GPGGA,175254.253,4657.3420,N,00726.2687,E,1,0417,12,,,,,,,,,9.5,9.0,2.6*39\r\n"
+	"$GPRMC,175254.253,A,4657.3420,N,00726.26$GPGGA,175255.253,4657.3421,N,00726.2688,E,1,04,9.0,568.4,M,48.0,M,0.0,0000*7A\r\n"
+	"$GPGSA,A,,E,0.16,151.85,230507,,*09\r\n"
+};
+#endif
+
+
+/*************************************************************************/
+
+/*
+ * open the specified serial port for read/write
+ * @return port file descriptor or -1
+ */
+
+#ifndef EMULATE
+static int openPort(const char *tty, int baud)
+{
+    int status;
+    int fd;
+    struct termios newtio;
+
+    /* open the tty */
+    fd = open(tty, O_RDWR | O_NOCTTY);
+    if (fd < 0) {
+	error("openPort: error open");
+	return fd;
+    }
+
+    /* flush serial port */
+    status = tcflush(fd, TCIFLUSH);
+    if (status < 0) {
+	error("openPort: error tcflush");
+	close(fd);
+	return -1;
+    }
+
+    /* get current terminal state */
+    tcgetattr(fd, &newtio);
+
+    /* set to raw terminal type */
+    newtio.c_cflag = baud | CS8 | CLOCAL | CREAD;
+    newtio.c_iflag = IGNBRK | IGNPAR;
+    newtio.c_oflag = 0;
+
+    /* control parameters */
+    newtio.c_cc[VMIN] = 1;	/* block for at least one charater */
+
+    /* set its new attrigutes */
+    status = tcsetattr(fd, TCSANOW, &newtio);
+    if (status < 0) {
+	//error("tcsetattr() failed: %s", strerror(errno));
+	error("tcsetattr() failed: __ERRNO removed due lazy coder");
+	close(fd);
+	fd = -1;
+	return fd;
+    }
+    return fd;
+}
+#endif
+
+/** called when a gpgga message is received and parsed */
+static void gpgga_callout( __attribute__ ((unused)) nmeap_context_t * context, void *data, __attribute__ ((unused))
+			  void *user_data)
+{
+    nmeap_gga_t *gga = (nmeap_gga_t *) data;
+
+    altitude = gga->altitude;
+    satellites = gga->satellites;
+    quality = gga->quality;
+    gpsTime = gga->time;
+
+    if (debug == 1)
+	debug("gps:debug: get gga callout\n");
+
+}
+
+
+//search a buffer for a string (forwards)
+int strLastOcc(char *theBuffer, char searchChar, int size)
+{
+    int i, ret;
+
+    ret = -1;
+    for (i = size; i >= 0; i--) {
+	if (theBuffer[i] == searchChar) {
+	    ret = i;
+	    break;
+	}
+    }
+    return ret;
+}
+
+//search a buffer for a string (backwards)  
+int strFirstOcc(char *theBuffer, char searchChar, int size)
+{
+    int i, ret;
+    ret = -1;
+    for (i = 0; i < size; i++) {
+	if (theBuffer[i] == searchChar) {
+	    ret = i;
+	    break;
+	}
+    }
+    return ret;
+}
+
+
+
+/** called when a gprmc message is received and parsed */
+static void gprmc_callout( __attribute__ ((unused)) nmeap_context_t * context, void *data, __attribute__ ((unused))
+			  void *user_data)
+{
+    nmeap_rmc_t *rmc = (nmeap_rmc_t *) data;
+
+    speed = rmc->speed;
+    gpsStatus = rmc->warn;
+    gpsTime = rmc->time;
+    gpsDate = rmc->date;
+
+    if (debug == 1)
+	debug("gps:debug: get rmc callout\n");
+
+}
+
+
+static int prepare_gps_parser()
+{
+    int status;
+    char *port = "/dev/usb/tts/1";
+    char *test;
+    int speed = 0;		// 0 = default 4800 baud, 1 is 9600 baud
+
+    if ((test = getenv("GPS_PORT"))) {	/* define your port via env variable */
+	port = test;
+    }
+
+    if ((test = getenv("GPS_9600"))) {	/* define your port via env variable */
+	speed = 1;
+    }
+
+    /* --------------------------------------- */
+    /* open the serial port device             */
+    /* using default 4800 baud for most GPS    */
+    /* --------------------------------------- */
+#ifndef EMULATE
+    if (speed == 0)
+	fd_g = openPort(port, B4800);
+    else
+	fd_g = openPort(port, B9600);
+
+    if (fd_g < 0) {
+	/* open failed */
+	error("GPS PLUGIN, Error: openPort %d", fd_g);
+	return fd_g;
+    }
+#endif
+
+    /* --------------------------------------- */
+    /*STEP 2 : initialize the nmea context    */
+    /* --------------------------------------- */
+    status = nmeap_init(&nmea, (void *) &user_data);
+    if (status != 0) {
+	error("GPS PLUGIN, Error: nmeap_init %d", status);
+	exit(1);
+    }
+
+    /* --------------------------------------- */
+    /*STEP 3 : add standard GPGGA parser      */
+    /* -------------------------------------- */
+    status = nmeap_addParser(&nmea, "GPGGA", nmeap_gpgga, gpgga_callout, &gga);
+    if (status != 0) {
+	error("GPS PLUGIN, Error: nmeap_add GPGGA parser, error:%d", status);
+	return -1;
+    }
+
+    /* --------------------------------------- */
+    /*STEP 4 : add standard GPRMC parser      */
+    /* -------------------------------------- */
+    /* status = nmeap_addParser(&nmea,"GPRMC",nmeap_gprmc,gprmc_callout,&rmc); */
+    status = nmeap_addParser(&nmea, "GPRMC", nmeap_gprmc, gprmc_callout, &rmc);
+    if (status != 0) {
+	error("GPS PLUGIN, Error: nmeap_add GPRMC parser, error:%d", status);
+	return -1;
+    }
+
+    return fd_g;
+}
+
+
+
+static void parse(RESULT * result, RESULT * theOptions, RESULT * displayOptions)
+{
+    int rem;
+    int offset;
+    int status;
+    int len;
+
+    long options;
+    long dispOptions;
+
+    char buffer[BUFFER_SIZE];
+    char bufferTmp[BUFFER_SIZE];
+
+    int validStart, validEnd;
+
+    options = R2N(theOptions);
+    dispOptions = R2N(displayOptions);
+    //error("options: %x\n",options);
+
+    if (dispOptions & OPTION_DEBUG)
+	debug = 1;
+
+    if ((dispOptions & OPTION_GET_BUFFERDATA) == 0) {
+
+	/* ---------------------------------------- */
+	/* STEP 6 : get a buffer of input          */
+	/* --------------------------------------- */
+
+	memset(buffer, 0, BUFFER_SIZE);
+	if (fndStr > BUFFER_SIZE)
+	    fndStr = 0;
+	//copy unfinished nmea strings back
+	if (fndStr > 0) {
+	    memcpy(buffer, backBuffer, fndStr);
+	}
+#ifdef EMULATE
+	memcpy(&buffer[fndStr], &test_vector[emu_read_ofs], BUFFER_SIZE - fndStr);
+
+	len = rem = EMU_BUFFER_READ_SIZE;
+	emu_read_ofs += EMU_BUFFER_READ_SIZE;
+	if (emu_read_ofs > (sizeof(test_vector) - BUFFER_SIZE)) {
+	    emu_read_ofs = 0;
+	    memset(buffer, 0, BUFFER_SIZE);
+	}
+#else
+
+	len = rem = read(fd_g, buffer, BUFFER_SIZE - fndStr);
+	if (len <= 0) {
+	    error("GPS Plugin, Error read from port, try using the GPS_PORT env variable (export GPS_PORT=/dev/mydev)");
+	    //break;
+	}
+	if (debug == 1)
+	    debug("gps:debug: read %d bytes\n", len);
+
+#endif
+	if (dispOptions & OPTION_RAW_NMEA)
+	    printf("\n__[%s]", buffer + '\0');
+
+	/* ---------------------------------------------- */
+	/* STEP 7 : process input until buffer is used up */
+	/* ---------------------------------------------- */
+	validStart = strFirstOcc(buffer, '$', len);
+	validEnd = strLastOcc(buffer, '\n', len);
+
+	if (validStart >= 0 && validEnd > 0 && validStart < validEnd) {
+	    //valid string found
+	    memcpy(bufferTmp, buffer, sizeof(buffer));	//save buffer
+	    memset(backBuffer, 0, sizeof(backBuffer));	//clear backup buffer
+	    memcpy(backBuffer, buffer + validEnd, len - validEnd);	// save incomplete nmea string
+	    memset(buffer, 0, sizeof(buffer));	//clean buffer
+	    memcpy(buffer, bufferTmp + validStart, validEnd - validStart + 1);	//copy valid name string
+	    fndStr = len - validEnd + validStart;	//save the size of the buffer
+	} else {
+	    //no valid nmea string found
+	    fndStr = 0;
+	    memset(buffer, 0, sizeof(buffer));
+	    memset(backBuffer, 0, sizeof(backBuffer));
+	}
+
+	offset = 0;
+	if (debug == 1)
+	    debug("backBuffer: %s\n", backBuffer);
+
+	//the nmeap_parseBuffer function needs whole nmea strings, combined string will NOT work!
+	validStart = strFirstOcc(buffer, '$', len);
+	validEnd = strFirstOcc(buffer, '\n', len);
+	while (validStart >= 0 && validEnd > 0 && validStart < validEnd) {
+	    memset(bufferTmp, 0, sizeof(bufferTmp));	//empty temp buffer
+	    memcpy(bufferTmp, buffer + offset + validStart, validEnd - validStart + 1);	//fill temp buffer
+
+	    if (debug == 1)
+		debug("submit: %s\n", bufferTmp);
+
+	    rem = len - offset;
+	    status = nmeap_parseBuffer(&nmea, (const char *) &bufferTmp, &rem);	//parse it
+	    if (status == -1) {
+		errCounter++;
+		error("parser error occured! (cnt: %i)\n", errCounter);
+	    } else if (status == 0) {
+		incomplCounter++;
+	    } else if (status > 0)
+		msgCounter++;
+
+	    offset += validEnd - validStart + 1;	//update offset
+	    validStart = strFirstOcc(buffer + offset, '$', len - offset);	//find next sentence
+	    validEnd = strFirstOcc(buffer + offset, '\n', len - offset);
+	}
+
+
+/*	while (rem > 0) {
+	    status = nmeap_parseBuffer(&nmea, &buffer[offset], &rem);
+	    debug("\nGPS::debug: remaining: %d bytes\n",rem);
+	    offset += (len - rem);
+	}*/
+    }				// end of OPTION get bufferdata
+
+
+    /* --------------------------------------- */
+    /* DISPLAY stuff comes here...             */
+    /* --------------------------------------- */
+    char *value = " ";
+    char outputStr[80];
+    memset(outputStr, 0, 80);
+
+    if (options & SHOW_ALTITUDE) {
+	if (dispOptions & OPTION_NO_PREFIX)
+	    sprintf(outputStr, "%s%.0f ", outputStr, altitude);
+	else
+	    sprintf(outputStr, "%salt:%.0f ", outputStr, altitude);
+    }
+    if (options & SHOW_SPEED) {
+	float knotsConvert = 1.852f;	//default speed display=km/h
+	if (dispOptions & OPTION_SPEED_IN_KNOTS)
+	    knotsConvert = 1.0f;	//use knots
+
+	if (dispOptions & OPTION_NO_PREFIX)
+	    sprintf(outputStr, "%s%.0f ", outputStr, speed * knotsConvert);
+	else
+	    sprintf(outputStr, "%sspd:%.0f ", outputStr, speed * knotsConvert);
+    }
+    if (options & SHOW_COURSE) {
+	char courses[8][3] = { "N ", "NO", "O ", "SO", "S ", "SW", "W ", "NW" };
+	float degrees[8] = { 22.5f, 67.5f, 112.5f, 157.5f, 202.5f, 247.5f, 292.5f, 337.5f };
+	int selectedDegree = 0;
+	int n;
+
+	for (n = 0; n < 8; n++) {
+	    if (course < degrees[n]) {
+		selectedDegree = n;
+		break;
+	    }
+	}
+	if (dispOptions & OPTION_NO_PREFIX)
+	    sprintf(outputStr, "%s%s ", outputStr, courses[selectedDegree]);
+	else
+	    sprintf(outputStr, "%sdir:%s ", outputStr, courses[selectedDegree]);
+    }
+    if (options & SHOW_SATELLITES) {
+	if (dispOptions & OPTION_NO_PREFIX)
+	    sprintf(outputStr, "%s%d ", outputStr, satellites);
+	else
+	    sprintf(outputStr, "%ssat:%d ", outputStr, satellites);
+    }
+    if (options & SHOW_QUALITY) {
+	if (dispOptions & OPTION_NO_PREFIX)
+	    sprintf(outputStr, "%s%d ", outputStr, quality);
+	else
+	    sprintf(outputStr, "%squa:%d ", outputStr, quality);
+    }
+    if (options & SHOW_STATUS) {
+	if (dispOptions & OPTION_NO_PREFIX)
+	    sprintf(outputStr, "%s%c ", outputStr, gpsStatus);
+	else
+	    sprintf(outputStr, "%ssta:%c ", outputStr, gpsStatus);
+    }
+    if (options & SHOW_TIME_UTC) {
+	char digitizer[9];	//01:34:67
+	sprintf(digitizer, "%.6ld", gpsTime);	//<012345>
+	digitizer[7] = digitizer[5];
+	digitizer[6] = digitizer[4];
+	digitizer[4] = digitizer[3];
+	digitizer[3] = digitizer[2];
+	digitizer[2] = ':';
+	digitizer[5] = ':';
+	digitizer[8] = '\0';
+	if (dispOptions & OPTION_NO_PREFIX)
+	    sprintf(outputStr, "%s%s ", outputStr, digitizer);
+	else
+	    sprintf(outputStr, "%sutc:%s ", outputStr, digitizer);
+    }
+    if (options & SHOW_DATE) {
+	char digitizer[9];	//01:34:67
+	sprintf(digitizer, "%.6ld", gpsDate);	//<012345>
+	digitizer[7] = digitizer[5];
+	digitizer[6] = digitizer[4];
+	digitizer[4] = digitizer[3];
+	digitizer[3] = digitizer[2];
+	digitizer[2] = '/';
+	digitizer[5] = '/';
+	digitizer[8] = '\0';
+	if (dispOptions & OPTION_NO_PREFIX)
+	    sprintf(outputStr, "%s%s ", outputStr, digitizer);
+	else
+	    sprintf(outputStr, "%sdat:%s ", outputStr, digitizer);
+    }
+
+
+    if (dispOptions & SHOW_NMEA_STATUS) {
+	if (dispOptions & OPTION_NO_PREFIX)
+	    sprintf(outputStr, "%s%04d/%04d/%04d ", outputStr, msgCounter, errCounter, incomplCounter);
+	else
+	    sprintf(outputStr, "%sOK:%03d/Er:%03d/In:%03d ", outputStr, msgCounter, errCounter, incomplCounter);
+    }
+
+    if (options == 0 && dispOptions == 0) {	//error, no parameter defined!
+	error("gps::parse() ERROR, no parameter specified!");
+	value = strdup("GPS ARG ERR");
+    } else {
+	value = strdup(outputStr);
+    }
+
+    SetResult(&result, R_STRING, value);
+    free(value);
+}
+
+
+/* plugin initialization */
+/* MUST NOT be declared 'static'! */
+int plugin_init_gps(void)
+{
+    info("%s: v%s", Name, "0.2");
+    prepare_gps_parser();
+
+    /* register all our cool functions */
+    /* the second parameter is the number of arguments */
+    /* -1 stands for variable argument list */
+    AddFunction("gps::parse", 2, parse);
+
+    return 0;
+}
+
+void plugin_exit_gps(void)
+{
+    info("%s: shutting down plugin.", Name);
+#ifndef EMULATE
+    close(fd_g);
+#endif
+}
diff -urN lcd4linux-0.10.0/plugin.h lcd4linux-0.11.0-SVN/plugin.h
--- lcd4linux-0.10.0/plugin.h	2005-05-08 06:32:44.000000000 +0200
+++ lcd4linux-0.11.0-SVN/plugin.h	2008-12-31 08:05:54.000000000 +0100
@@ -1,8 +1,9 @@
-/* $Id: plugin.h,v 1.4 2005/05/08 04:32:44 reinelt Exp $
+/* $Id: plugin.h 919 2008-12-31 06:10:37Z michael $
+ * $URL: https://ssl.bulix.org/svn/lcd4linux/trunk/plugin.h $
  *
  * plugin handler for the Evaluator
  *
- * Copyright (C) 2003 Michael Reinelt <reinelt@eunet.at>
+ * Copyright (C) 2003 Michael Reinelt <michael@reinelt.co.at>
  * Copyright (C) 2004 The LCD4Linux Team <lcd4linux-devel@users.sourceforge.net>
  *
  * This file is part of LCD4Linux.
@@ -21,34 +22,6 @@
  * along with this program; if not, write to the Free Software
  * Foundation, Inc., 675 Mass Ave, Cambridge, MA 02139, USA.
  *
- *
- * $Log: plugin.h,v $
- * Revision 1.4  2005/05/08 04:32:44  reinelt
- * CodingStyle added and applied
- *
- * Revision 1.3  2005/01/18 06:30:23  reinelt
- * added (C) to all copyright statements
- *
- * Revision 1.2  2004/03/03 03:47:04  reinelt
- * big patch from Martin Hejl:
- * - use qprintf() where appropriate
- * - save CPU cycles on gettimeofday()
- * - add quit() functions to free allocated memory
- * - fixed lots of memory leaks
- *
- * Revision 1.1  2003/12/19 05:35:14  reinelt
- * renamed 'client' to 'plugin'
- *
- * Revision 1.1  2003/10/11 06:01:52  reinelt
- *
- * renamed expression.{c,h} to client.{c,h}
- * added config file client
- * new functions 'AddNumericVariable()' and 'AddStringVariable()'
- * new parameter '-i' for interactive mode
- *
- * Revision 1.1  2003/10/06 04:34:06  reinelt
- * expression evaluator added
- *
  */
 
 
@@ -57,6 +30,7 @@
 #ifndef _PLUGIN_H_
 #define _PLUGIN_H_
 
+int plugin_list(void);
 int plugin_init(void);
 void plugin_exit(void);
 #endif
diff -urN lcd4linux-0.10.0/plugin_hddtemp.c lcd4linux-0.11.0-SVN/plugin_hddtemp.c
--- lcd4linux-0.10.0/plugin_hddtemp.c	1970-01-01 01:00:00.000000000 +0100
+++ lcd4linux-0.11.0-SVN/plugin_hddtemp.c	2009-01-08 15:59:25.000000000 +0100
@@ -0,0 +1,282 @@
+/* $Id: plugin_hddtemp.c 950 2009-01-08 14:59:24Z michael $
+ * $URL: https://ssl.bulix.org/svn/lcd4linux/trunk/plugin_hddtemp.c $
+ *
+ * plugin hddtemp
+ *
+ * Copyright (C) 2007 Scott Bronson <brons_lcd4linux@rinspin.com>
+ * Copyright (C) 2004, 2005, 2006, 2007, 2008 The LCD4Linux Team <lcd4linux-devel@users.sourceforge.net>
+ *
+ * This file is part of LCD4Linux.
+ *
+ * LCD4Linux is free software; you can redistribute it and/or modify
+ * it under the terms of the GNU General Public License as published by
+ * the Free Software Foundation; either version 2, or (at your option)
+ * any later version.
+ *
+ * LCD4Linux is distributed in the hope that it will be useful,
+ * but WITHOUT ANY WARRANTY; without even the implied warranty of
+ * MERCHANTABILITY or FITNESS FOR A PARTICULAR PURPOSE.  See the
+ * GNU General Public License for more details.
+ *
+ * You should have received a copy of the GNU General Public License
+ * along with this program; if not, write to the Free Software
+ * Foundation, Inc., 675 Mass Ave, Cambridge, MA 02139, USA.
+ *
+ */
+
+/* Example:
+ * (I tried to put this info on the wiki but Akismet claimed it was spam)
+
+	Widget SmallHDDTemp {
+		class 'Text'
+		expression hddtemp('/dev/hda')
+		width 4
+		precision 1
+		align 'R'
+		update tick
+	}
+
+	hddtemp home page: http://www.guzu.net/linux/hddtemp.php
+
+	Quick Examples:
+	 * hddtemp() -- return temperature of first drive (order is defined by the hddtemp daemon).
+	 * hddtemp('/dev/hda') -- return temperature of /dev/hda on localhost.
+	 * hddtemp('ST3400832A') -- return temperature of the drive with the given ID.
+	 * hddtemp('burly', '') -- return temperature of the first drive on host burly.
+	 * hddtemp('burly', 17634, '/dev/hda') -- return temperature of /dev/hda on burly connecting to the hddtemp daemon listening on port 17634.
+
+You can find out what drives are being monitored by running
+		telnet HOST PORT
+
+i.e.
+
+	$ telnet localhost 7634
+	Trying 127.0.0.1...
+	Connected to localhost.
+	Escape character is '^]'.
+	|/dev/hda|ST3400832A|53|C|Connection closed by foreign host.
+
+This tells me that /dev/hda is a Seagate ST3400832A running at an awfully
+toasty 53 degC.
+
+ */
+
+
+/* 
+ * exported functions:
+ *
+ * int plugin_init_hddtemp (void)
+ *  adds various functions
+ * void plugin_exit_hddtemp (void)
+ *
+ */
+
+#include "config.h"
+
+#include <stdio.h>
+#include <stdlib.h>
+#include <unistd.h>
+#include <string.h>
+#include <errno.h>
+
+/* network specific includes */
+#include <sys/types.h>
+#include <sys/socket.h>
+#include <netinet/in.h>
+#include <netdb.h>
+#include <arpa/inet.h>
+
+/* these should always be included */
+#include "debug.h"
+#include "plugin.h"
+
+
+
+static int socket_open(const char *name, int port)
+{
+    struct sockaddr_in server;
+    struct hostent *host_info;
+    unsigned long addr;
+    int sock;
+
+    sock = socket(PF_INET, SOCK_STREAM, 0);
+    if (sock < 0) {
+	error("[hddtemp] failed to create socket: %s", strerror(errno));
+	return -1;
+    }
+
+    memset(&server, 0, sizeof(server));
+    if ((addr = inet_addr(name)) != INADDR_NONE) {
+	memcpy((char *) &server.sin_addr, &addr, sizeof(addr));
+    } else {
+	host_info = gethostbyname(name);
+	if (NULL == host_info) {
+	    error("[hddtemp] Unknown server: %s", name);
+	    return -1;
+	}
+	memcpy((char *) &server.sin_addr, host_info->h_addr, host_info->h_length);
+    }
+
+    server.sin_family = AF_INET;
+    server.sin_port = htons(port);
+
+    if (connect(sock, (struct sockaddr *) &server, sizeof(server)) < 0) {
+	error("[hddtemp] can't connect to server %s: %s", name, strerror(errno));
+	return -1;
+    }
+
+    return sock;
+}
+
+
+static size_t hddtemp_read(int socket, char *buffer, size_t size)
+{
+    size_t count = 0;
+    ssize_t len;
+
+    while (count < size) {
+	len = read(socket, buffer + count, size - count);
+	if (len > 0) {
+	    count += len;
+	} else if (len < 0) {
+	    error("[hddtemp] couldn't read from socket: %s", strerror(errno));
+	    return -1;
+	} else {
+	    break;		/* remote socket has closed */
+	}
+    }
+
+    // null-terminate the string
+    if (count < size) {
+	buffer[count] = '\0';
+    } else {
+	buffer[size - 1] = '\0';
+    }
+
+    return count;
+}
+
+
+static int hddtemp_connect(const char *host, int port, char *buffer, size_t size)
+{
+    int socket, ret;
+
+    socket = socket_open(host, port);
+    if (socket < 0) {
+	error("[hddtemp] Error accessing %s:%d: %s", host, port, strerror(errno));
+	return -1;
+    }
+
+    ret = hddtemp_read(socket, buffer, size);
+    close(socket);
+
+    return ret;
+}
+
+
+/* split a value into columns and return the nth column */
+/* WARNING: does return a pointer to a static string!! */
+static char *split(const char *value, const int column)
+{
+    static char buffer[256];
+    const char *p, *q, *v;
+    size_t l;
+    int c;
+
+    c = 0;
+    p = value;
+    q = NULL;
+    for (v = value; v && *v; v++) {
+	if (*v == '|') {
+	    if (c == column) {
+		q = v;
+		break;
+	    } else {
+		p = v + 1;
+	    }
+	    c++;
+	}
+    }
+
+    if (c < column)
+	return NULL;
+
+    l = q ? (size_t) (q - p) : strlen(p);
+    if (l >= sizeof(buffer))
+	l = sizeof(buffer) - 1;
+    strncpy(buffer, p, l);
+
+    buffer[l] = '\0';
+    return buffer;
+}
+
+static char *hddtemp_fetch(const char *host, int port, const char *device)
+{
+    char buffer[4096];
+    char *key;
+    int i;
+
+    /* fetch a buffer of all hddtemps */
+    if (!hddtemp_connect(host, port, buffer, sizeof(buffer))) {
+	return "err";
+    }
+
+    i = 1;
+    while (1) {
+	key = split(buffer, i);
+	if (key == NULL)
+	    break;
+	if (strcmp(device, key) == 0) {
+	    return split(buffer, i + 2);
+	}
+	i += 5;
+    }
+
+    return "n/a";
+}
+
+
+static void my_hddtemp(RESULT * result, int argc, RESULT * argv[])
+{
+    char *device = "";
+    int port = 7634;
+    char *host = "localhost";
+    char *value;
+
+    switch (argc) {
+    case 0:
+	break;
+    case 1:
+	device = R2S(argv[0]);
+	break;
+    case 2:
+	host = R2S(argv[0]);
+	device = R2S(argv[1]);
+	break;
+    case 3:
+	host = R2S(argv[0]);
+	port = (int) R2N(argv[1]);
+	device = R2S(argv[2]);
+	break;
+    default:
+	error("hddtemp(): too many parameters");
+	SetResult(&result, R_STRING, "");
+	return;
+    }
+
+    value = hddtemp_fetch(host, port, device);
+    SetResult(&result, R_STRING, value);
+}
+
+
+int plugin_init_hddtemp(void)
+{
+    AddFunction("hddtemp", -1, my_hddtemp);
+
+    return 0;
+}
+
+
+void plugin_exit_hddtemp(void)
+{
+}
diff -urN lcd4linux-0.10.0/plugin_i2c_sensors.c lcd4linux-0.11.0-SVN/plugin_i2c_sensors.c
--- lcd4linux-0.10.0/plugin_i2c_sensors.c	2005-05-08 06:32:44.000000000 +0200
+++ lcd4linux-0.11.0-SVN/plugin_i2c_sensors.c	2008-12-31 08:05:54.000000000 +0100
@@ -1,4 +1,5 @@
-/* $Id: plugin_i2c_sensors.c,v 1.24 2005/05/08 04:32:44 reinelt Exp $
+/* $Id: plugin_i2c_sensors.c 797 2007-05-02 05:10:55Z michael $
+ * $URL: https://ssl.bulix.org/svn/lcd4linux/trunk/plugin_i2c_sensors.c $
  *
  * I2C sensors plugin
  *
@@ -21,109 +22,6 @@
  * along with this program; if not, write to the Free Software
  * Foundation, Inc., 675 Mass Ave, Cambridge, MA 02139, USA.
  *
- *
- * $Log: plugin_i2c_sensors.c,v $
- * Revision 1.24  2005/05/08 04:32:44  reinelt
- * CodingStyle added and applied
- *
- * Revision 1.23  2005/04/01 05:16:04  reinelt
- * moved plugin init stuff to a seperate function called on first use
- *
- * Revision 1.22  2005/01/18 06:30:23  reinelt
- * added (C) to all copyright statements
- *
- * Revision 1.21  2004/06/26 12:05:00  reinelt
- *
- * uh-oh... the last CVS log message messed up things a lot...
- *
- * Revision 1.20  2004/06/26 09:27:21  reinelt
- *
- * added '-W' to CFLAGS
- * changed all C++ comments to C ones
- * cleaned up a lot of signed/unsigned mistakes
- *
- * Revision 1.19  2004/06/20 10:09:56  reinelt
- *
- * 'const'ified the whole source
- *
- * Revision 1.18  2004/06/17 06:23:43  reinelt
- *
- * hash handling rewritten to solve performance issues
- *
- * Revision 1.17  2004/06/05 14:56:48  reinelt
- *
- * Cwlinux splash screen fixed
- * USBLCD splash screen fixed
- * plugin_i2c qprintf("%f") replaced with snprintf()
- *
- * Revision 1.16  2004/06/01 06:45:30  reinelt
- *
- * some Fixme's processed
- * documented some code
- *
- * Revision 1.15  2004/05/31 21:05:13  reinelt
- *
- * fixed lots of bugs in the Cwlinux driver
- * do not emit EAGAIN error on the first retry
- * made plugin_i2c_sensors a bit less 'chatty'
- * moved init and exit functions to the bottom of plugin_pop3
- *
- * Revision 1.14  2004/05/09 05:41:42  reinelt
- *
- * i2c fix for kernel 2.6.5 (temp_input1 vs. temp1_input) from Xavier
- *
- * Revision 1.13  2004/03/03 03:47:04  reinelt
- * big patch from Martin Hejl:
- * - use qprintf() where appropriate
- * - save CPU cycles on gettimeofday()
- * - add quit() functions to free allocated memory
- * - fixed lots of memory leaks
- *
- * Revision 1.12  2004/02/16 08:19:44  reinelt
- * i2c_sensors patch from Xavier
- *
- * Revision 1.11  2004/02/15 21:43:43  reinelt
- * T6963 driver nearly finished
- * framework for graphic displays done
- * i2c_sensors patch from Xavier
- * some more old generation files removed
- *
- * Revision 1.10  2004/02/14 12:07:27  nicowallmeier
- * minor bugfix
- *
- * Revision 1.9  2004/02/14 11:56:17  reinelt
- * M50530 driver ported
- * changed lots of 'char' to 'unsigned char'
- *
- * Revision 1.8  2004/02/14 10:09:50  reinelt
- * I2C Sensors for 2.4 kernels (/proc instead of /sysfs)
- *
- * Revision 1.7  2004/01/30 20:57:56  reinelt
- * HD44780 patch from Martin Hejl
- * dmalloc integrated
- *
- * Revision 1.6  2004/01/30 07:12:35  reinelt
- * HD44780 busy-flag support from Martin Hejl
- * loadavg() uClibc replacement from Martin Heyl
- * round() uClibc replacement from Martin Hejl
- * warning in i2c_sensors fixed
- *
- * Revision 1.5  2004/01/29 05:55:30  reinelt
- * check for /sys mounted
- *
- * Revision 1.4  2004/01/29 04:40:02  reinelt
- * every .c file includes "config.h" now
- *
- * Revision 1.3  2004/01/27 08:13:39  reinelt
- * ported PPP token to plugin_ppp
- *
- * Revision 1.2  2004/01/27 05:06:10  reinelt
- * i2c update from Xavier
- *
- * Revision 1.1  2004/01/10 17:36:56  reinelt
- *
- * I2C Sensors plugin from Xavier added
- *
  */
 
 /* 
@@ -215,7 +113,7 @@
     fgets(buffer, sizeof(buffer), stream);
     fclose(stream);
 
-    if (!buffer) {
+    if (buffer[0] == '\0') {
 	error("i2c_sensors: %s empty ?!", file);
 	return -1;
     }
@@ -285,7 +183,7 @@
     fgets(buffer, sizeof(buffer), stream);
     fclose(stream);
 
-    if (!buffer) {
+    if (buffer[0] == '\0') {
 	error("i2c_sensors: %s empty ?!", file);
 	return -1;
     }
@@ -338,7 +236,8 @@
 
     while ((dir = readdir(fd1))) {
 	/* Skip non-directories and '.' and '..' */
-	if ((dir->d_type != DT_DIR && dir->d_type != DT_LNK) || strcmp(dir->d_name, ".") == 0 || strcmp(dir->d_name, "..") == 0) {
+	if ((dir->d_type != DT_DIR && dir->d_type != DT_LNK) || strcmp(dir->d_name, ".") == 0
+	    || strcmp(dir->d_name, "..") == 0) {
 	    continue;
 	}
 
@@ -351,7 +250,8 @@
 	done = 0;
 	while ((file = readdir(fd2))) {
 	    /* FIXME : do all sensors have a temp_input1 ? */
-	    if (!strcmp(file->d_name, "temp_input1") || !strcmp(file->d_name, "temp1_input") || !strcmp(file->d_name, "temp1")) {
+	    if (!strcmp(file->d_name, "temp_input1") || !strcmp(file->d_name, "temp1_input")
+		|| !strcmp(file->d_name, "temp1")) {
 		path = realloc(path, strlen(dname) + 1);
 		strcpy(path, dname);
 		done = 1;
@@ -396,7 +296,7 @@
 	    path_cfg = realloc(path_cfg, strlen(path_cfg) + 2);
 	    strcat(path_cfg, "/");
 	}
-	debug("using i2c sensors at %s (from %s)", path, cfg_source());
+	debug("using i2c sensors at %s (from %s)", path_cfg, cfg_source());
 	path = realloc(path, strlen(path_cfg) + 1);
 	strcpy(path, path_cfg);
     }
@@ -409,7 +309,7 @@
     } else if (strncmp(path, "/proc", 5) == 0) {
 	parse_i2c_sensors = parse_i2c_sensors_procfs;
     } else {
-	error("i2c_sensors: unknown path %s, should start with /sys or /proc");
+	error("i2c_sensors: unknown path %s, should start with /sys or /proc", path);
 	configured = -1;
 	return configured;
     }
diff -urN lcd4linux-0.10.0/plugin_iconv.c lcd4linux-0.11.0-SVN/plugin_iconv.c
--- lcd4linux-0.10.0/plugin_iconv.c	1970-01-01 01:00:00.000000000 +0100
+++ lcd4linux-0.11.0-SVN/plugin_iconv.c	2008-12-31 08:05:54.000000000 +0100
@@ -0,0 +1,142 @@
+/* $Id: plugin_iconv.c 728 2007-01-14 11:14:38Z michael $
+ * $URL: https://ssl.bulix.org/svn/lcd4linux/trunk/plugin_iconv.c $
+ *
+ * iconv charset conversion plugin
+ *
+ * Copyright (C) 2006 Ernst Bachmann <e.bachmann@xebec.de>
+ * Copyright (C) 2006 The LCD4Linux Team <lcd4linux-devel@users.sourceforge.net>
+ *
+ * This file is part of LCD4Linux.
+ *
+ * LCD4Linux is free software; you can redistribute it and/or modify
+ * it under the terms of the GNU General Public License as published by
+ * the Free Software Foundation; either version 2, or (at your option)
+ * any later version.
+ *
+ * LCD4Linux is distributed in the hope that it will be useful,
+ * but WITHOUT ANY WARRANTY; without even the implied warranty of
+ * MERCHANTABILITY or FITNESS FOR A PARTICULAR PURPOSE.  See the
+ * GNU General Public License for more details.
+ *
+ * You should have received a copy of the GNU General Public License
+ * along with this program; if not, write to the Free Software
+ * Foundation, Inc., 675 Mass Ave, Cambridge, MA 02139, USA.
+ *
+ */
+
+/* 
+ * exported functions:
+ *
+ * int plugin_init_iconv (void)
+ * int plugin_exit_iconv (void)
+ *
+ */
+
+
+#include "config.h"
+
+#include <stdlib.h>
+#include <string.h>
+#include <ctype.h>
+#include <iconv.h>
+#include <errno.h>
+
+/* these should always be included */
+#include "debug.h"
+#include "plugin.h"
+
+#ifdef WITH_DMALLOC
+#include <dmalloc.h>
+#endif
+
+
+
+/* iconv function, convert charsets */
+/* valid "to" and "from" charsets can be listed by running "iconv --list" from a shell */
+/* utf16 & utf32 encodings won't work, as they contain null bytes, confusing strlen */
+static void my_iconv(RESULT * result, RESULT * charset_from, RESULT * charset_to, RESULT * arg)
+{
+    char *source;
+    size_t source_left;
+    char *dest;
+    char *dest_pos;
+    size_t dest_left;
+    iconv_t cd;
+
+    source = R2S(arg);
+    source_left = strlen(source);
+
+    /* use twice the memory needed in best case, but save lots of reallocs in worst case */
+    /* increase to 4 if most conversions are to utf32 (quite unlikely) */
+    /* also alloc a "safety byte" so we can always zero-terminate the string. */
+
+    dest_left = 2 * source_left;
+    dest = malloc(dest_left + 1);
+    dest_pos = dest;
+
+    cd = iconv_open(R2S(charset_to), R2S(charset_from));
+    if (cd != (iconv_t) (-1)) {
+
+	do {
+
+	    /* quite spammy: debug("plugin_iconv: calling iconv with %ld,[%s]/%ld,%ld", cd, source, source_left, dest_left); */
+	    if (iconv(cd, &source, &source_left, &dest_pos, &dest_left) == (size_t) (-1)) {
+		switch (errno) {
+		case EILSEQ:
+		    /* illegal bytes in input sequence */
+		    /* try to fix by skipping a byte */
+		    info("plugin_iconv: illegal character in input string: %c", *source);
+		    source_left--;
+		    source++;
+		    break;
+		case EINVAL:
+		    /* input string ends during a multibyte sequence */
+		    /* try to fix by simply ignoring */
+		    info("plugin_iconv: illegal character at end of input");
+		    source_left = 0;
+		    break;
+		case E2BIG:
+		    /* not enough bytes in outbuf. */
+		    /* TODO: Realloc output buffer, probably doubling its size? */
+		    /* for now, just bail out. For lcd4linux 99% of all conversions will go to ascii or latin1 anyways */
+		    error
+			("plugin_iconv: out of memory in destination buffer. Seems like Ernst was too lazy, complain to him!");
+		    source_left = 0;
+		    break;
+		default:
+		    error("plugin_iconv: strange errno state (%d) occured", errno);
+		    source_left = 0;
+		}
+	    }
+	} while (source_left > 0);	/* don't check for == 0, could be negative in EILSEQ case */
+
+	/* terminate the string, we're sure to have that byte left, see above */
+	*dest_pos = 0;
+	dest_pos++;
+
+	iconv_close(cd);
+    } else {
+	error("plugin_iconv: could not open conversion descriptor. Check if your charsets are supported!");
+	/* guaranteed to fit. */
+	strcpy(dest, source);
+    }
+
+    SetResult(&result, R_STRING, dest);
+
+    free(dest);
+}
+
+
+/* plugin initialization */
+int plugin_init_iconv(void)
+{
+
+    AddFunction("iconv", 3, my_iconv);
+
+    return 0;
+}
+
+void plugin_exit_iconv(void)
+{
+    /* nothing to clean */
+}
diff -urN lcd4linux-0.10.0/plugin_imon.c lcd4linux-0.11.0-SVN/plugin_imon.c
--- lcd4linux-0.10.0/plugin_imon.c	2005-05-08 06:32:44.000000000 +0200
+++ lcd4linux-0.11.0-SVN/plugin_imon.c	2008-12-31 08:05:54.000000000 +0100
@@ -1,4 +1,5 @@
-/* $Id: plugin_imon.c,v 1.17 2005/05/08 04:32:44 reinelt Exp $
+/* $Id: plugin_imon.c 782 2007-03-21 05:01:11Z michael $
+ * $URL: https://ssl.bulix.org/svn/lcd4linux/trunk/plugin_imon.c $
  *
  * imond/telmond data processing
  *
@@ -20,69 +21,6 @@
  * along with this program; if not, write to the Free Software
  * Foundation, Inc., 675 Mass Ave, Cambridge, MA 02139, USA.
  *
- *
- * $Log: plugin_imon.c,v $
- * Revision 1.17  2005/05/08 04:32:44  reinelt
- * CodingStyle added and applied
- *
- * Revision 1.16  2005/04/04 20:11:14  nicowallmeier
- * to be compatible with gcc 2.95
- *
- * Revision 1.15  2005/04/01 05:16:04  reinelt
- * moved plugin init stuff to a seperate function called on first use
- *
- * Revision 1.14  2005/01/18 06:30:23  reinelt
- * added (C) to all copyright statements
- *
- * Revision 1.13  2004/06/26 12:05:00  reinelt
- *
- * uh-oh... the last CVS log message messed up things a lot...
- *
- * Revision 1.12  2004/06/26 09:27:21  reinelt
- *
- * added '-W' to CFLAGS
- * changed all C++ comments to C ones
- * cleaned up a lot of signed/unsigned mistakes
- *
- * Revision 1.11  2004/06/24 20:18:08  nicowallmeier
- * minor bugfix
- *
- * Revision 1.10  2004/06/20 10:09:56  reinelt
- *
- * 'const'ified the whole source
- *
- * Revision 1.9  2004/06/17 06:23:43  reinelt
- *
- * hash handling rewritten to solve performance issues
- *
- * Revision 1.8  2004/05/27 06:29:29  nicowallmeier
- * Moved variables to Plugin:imon / Plugin:telmon
- *
- * Revision 1.7  2004/05/27 03:39:47  reinelt
- *
- * changed function naming scheme to plugin::function
- *
- * Revision 1.6  2004/03/13 14:58:15  nicowallmeier
- * Added clean termination of imond-connection (now correctly)
- *
- * Revision 1.4  2004/03/03 04:44:16  reinelt
- * changes (cosmetics?) to the big patch from Martin
- * hash patch un-applied
- *
- * Revision 1.3  2004/03/03 03:47:04  reinelt
- * big patch from Martin Hejl:
- * - use qprintf() where appropriate
- * - save CPU cycles on gettimeofday()
- * - add quit() functions to free allocated memory
- * - fixed lots of memory leaks
- *
- * Revision 1.2  2004/02/22 17:35:41  reinelt
- * some fixes for generic graphic driver and T6963
- * removed ^M from plugin_imon (Nico, are you editing under Windows?)
- *
- * Revision 1.1  2004/02/18 14:45:43  nicowallmeier
- * Imon/Telmon plugin ported
- *
  */
 
 #include "config.h"
@@ -247,7 +185,7 @@
     if (!fp)
 	return;
 
-    while (fgets(line, 128, fp)) {
+    while (fgets(line, sizeof(line), fp)) {
 	if (*line == '#')
 	    continue;
 	if (!strncmp(line, number, strlen(number))) {
@@ -533,6 +471,116 @@
     SetResult(&result, R_STRING, val);
 }
 
+static int parse_imon_quantity(const char *channel)
+{
+    char buf[256], fill1[25], in[25], fill2[25], out[25];
+    char *s;
+    int age;
+
+    qprintf(buf, sizeof(buf), "quantity %s in", channel);
+
+    /* reread every half sec only */
+    age = hash_age(&IMON, buf);
+    if (age > 0 && age <= 500)
+	return 0;
+
+    init();			/* establish connection */
+
+    if (err)
+	return -1;
+
+    qprintf(buf, sizeof(buf), "quantity %s", channel);
+    s = get_value(buf);
+
+    if (sscanf(s, "%s %s %s %s", fill1, in, fill2, out) != 4)
+	return -1;
+
+    qprintf(buf, sizeof(buf), "quantity %s in", channel);
+    hash_put(&IMON, buf, in);
+    qprintf(buf, sizeof(buf), "quantity %s out", channel);
+    hash_put(&IMON, buf, out);
+
+    return 0;
+}
+
+static int parse_imon_status(const char *channel)
+{
+    char buf[256], status[25];
+    char *s;
+    int age;
+
+    qprintf(buf, sizeof(buf), "status %s", channel);
+
+    /* reread every half sec only */
+    age = hash_age(&IMON, buf);
+    if (age > 0 && age <= 500)
+	return 0;
+
+    init();			/* establish connection */
+
+    if (err)
+	return -1;
+
+    qprintf(buf, sizeof(buf), "status %s", channel);
+    s = get_value(buf);
+
+    if (sscanf(s, "%s", status) != 1)
+	return -1;
+
+    qprintf(buf, sizeof(buf), "status %s", channel);
+    if (strcasecmp(status, "Online") == 0)
+	hash_put(&IMON, buf, "1");
+    else
+	hash_put(&IMON, buf, "0");
+
+    return 0;
+}
+
+static void my_imon_quantity(RESULT * result, RESULT * arg1, RESULT * arg2)
+{
+    char *val;
+    char buf[256];
+
+    if (configure_imon() < 0) {
+	SetResult(&result, R_STRING, "");
+	return;
+    }
+
+    if (parse_imon_quantity(R2S(arg1)) < 0) {
+	SetResult(&result, R_STRING, "");
+	return;
+    }
+
+    qprintf(buf, sizeof(buf), "quantity %s %s", R2S(arg1), R2S(arg2));
+
+    val = hash_get(&IMON, buf, NULL);
+    if (val == NULL)
+	val = "";
+    SetResult(&result, R_STRING, val);
+}
+
+static void my_imon_status(RESULT * result, RESULT * arg1)
+{
+    char *val;
+    char buf[256];
+
+    if (configure_imon() < 0) {
+	SetResult(&result, R_NUMBER, "-1");
+	return;
+    }
+
+    if (parse_imon_status(R2S(arg1)) < 0) {
+	SetResult(&result, R_STRING, "-1");
+	return;
+    }
+
+    qprintf(buf, sizeof(buf), "status %s", R2S(arg1));
+
+    val = hash_get(&IMON, buf, NULL);
+    if (val == NULL)
+	val = "-1";
+    SetResult(&result, R_STRING, val);
+}
 
 static void my_imon(RESULT * result, RESULT * arg1)
 {
@@ -562,6 +610,8 @@
     AddFunction("imon", 1, my_imon);
     AddFunction("imon::version", 0, my_imon_version);
     AddFunction("imon::rates", 2, my_imon_rates);
+    AddFunction("imon::quantity", 2, my_imon_quantity);
+    AddFunction("imon::status", 1, my_imon_status);
     AddFunction("imon::telmon", 1, my_telmon);
 
     return 0;
diff -urN lcd4linux-0.10.0/plugin_isdn.c lcd4linux-0.11.0-SVN/plugin_isdn.c
--- lcd4linux-0.10.0/plugin_isdn.c	2005-05-08 06:32:44.000000000 +0200
+++ lcd4linux-0.11.0-SVN/plugin_isdn.c	2008-12-31 08:05:54.000000000 +0100
@@ -1,12 +1,13 @@
-/* $Id: plugin_isdn.c,v 1.7 2005/05/08 04:32:44 reinelt Exp $
+/* $Id: plugin_isdn.c 840 2007-09-09 12:17:42Z michael $
+ * $URL: https://ssl.bulix.org/svn/lcd4linux/trunk/plugin_isdn.c $
  *
  * plugin for ISDN subsystem
  *
- * Copyright (C) 2003 Michael Reinelt <reinelt@eunet.at>
+ * Copyright (C) 2003 Michael Reinelt <michael@reinelt.co.at>
  * Copyright (C) 2004 The LCD4Linux Team <lcd4linux-devel@users.sourceforge.net>
  *
  * Based on the old isdn client (isdn.c) which is
- * Copyright (C) 1999, 2000 Michael Reinelt <reinelt@eunet.at>
+ * Copyright (C) 1999, 2000 Michael Reinelt <michael@reinelt.co.at>
  *
  * This file is part of LCD4Linux.
  *
@@ -24,36 +25,6 @@
  * along with this program; if not, write to the Free Software
  * Foundation, Inc., 675 Mass Ave, Cambridge, MA 02139, USA.
  *
- *
- * $Log: plugin_isdn.c,v $
- * Revision 1.7  2005/05/08 04:32:44  reinelt
- * CodingStyle added and applied
- *
- * Revision 1.6  2005/01/18 06:30:23  reinelt
- * added (C) to all copyright statements
- *
- * Revision 1.5  2004/06/26 12:05:00  reinelt
- *
- * uh-oh... the last CVS log message messed up things a lot...
- *
- * Revision 1.4  2004/06/26 09:27:21  reinelt
- *
- * added '-W' to CFLAGS
- * changed all C++ comments to C ones
- * cleaned up a lot of signed/unsigned mistakes
- *
- * Revision 1.3  2004/06/20 10:09:56  reinelt
- *
- * 'const'ified the whole source
- *
- * Revision 1.2  2004/06/17 06:23:43  reinelt
- *
- * hash handling rewritten to solve performance issues
- *
- * Revision 1.1  2004/05/19 05:23:25  reinelt
- *
- * plugin_isdn.c added (sorry, I forgot...)
- *
  */
 
 /* 
diff -urN lcd4linux-0.10.0/plugin_kvv.c lcd4linux-0.11.0-SVN/plugin_kvv.c
--- lcd4linux-0.10.0/plugin_kvv.c	1970-01-01 01:00:00.000000000 +0100
+++ lcd4linux-0.11.0-SVN/plugin_kvv.c	2009-01-06 07:46:50.000000000 +0100
@@ -0,0 +1,814 @@
+/* $Id: plugin_kvv.c 944 2009-01-06 06:46:50Z michael $
+ * $URL: https://ssl.bulix.org/svn/lcd4linux/trunk/plugin_kvv.c $
+ *
+ * plugin kvv (karlsruher verkehrsverbund)
+ *
+ * Copyright (C) 2006 Till Harbaum <till@harbaum.org>
+ * Copyright (C) 2006 The LCD4Linux Team <lcd4linux-devel@users.sourceforge.net>
+ *
+ * This file is part of LCD4Linux.
+ *
+ * LCD4Linux is free software; you can redistribute it and/or modify
+ * it under the terms of the GNU General Public License as published by
+ * the Free Software Foundation; either version 2, or (at your option)
+ * any later version.
+ *
+ * LCD4Linux is distributed in the hope that it will be useful,
+ * but WITHOUT ANY WARRANTY; without even the implied warranty of
+ * MERCHANTABILITY or FITNESS FOR A PARTICULAR PURPOSE.  See the
+ * GNU General Public License for more details.
+ *
+ * You should have received a copy of the GNU General Public License
+ * along with this program; if not, write to the Free Software
+ * Foundation, Inc., 675 Mass Ave, Cambridge, MA 02139, USA.
+ *
+ */
+
+/* 
+ * exported functions:
+ *
+ * int plugin_init_kvv (void)
+ *  adds various functions
+ * void plugin_exit_kvv (void)
+ *
+ */
+
+/* define the include files you need */
+#include "config.h"
+
+#include <stdio.h>
+#include <stdlib.h>
+#include <unistd.h>
+#include <string.h>
+#include <ctype.h>
+#include <errno.h>
+#include <signal.h>
+
+/* network specific includes */
+#include <sys/types.h>
+#include <sys/socket.h>
+#include <netinet/in.h>
+#include <netdb.h>
+#include <arpa/inet.h>
+
+/* these should always be included */
+#include "debug.h"
+#include "plugin.h"
+#include "cfg.h"
+#include "thread.h"
+
+/* these can't be configured as it doesn't make sense to change them */
+#define HTTP_SERVER "www.init-ka.de"
+#define HTTP_REQUEST "/webfgi/StopInfoInplace.aspx?ID=%s"
+#define USER_AGENT   "lcd4linux - KVV plugin (http://ssl.bulix.org/projects/lcd4linux/wiki/plugin_kvv)"
+
+#define DEFAULT_STATION_ID    "89"	/* Hauptbahnhof */
+
+/* example ids: 
+ * 89     = Hauptbahnhof
+ * 12_701 = Berufsakademie
+ */
+
+/* total max values to calculate shm size */
+#define MAX_LINES           4
+#define MAX_LINE_LENGTH     8
+#define MAX_STATION_LENGTH 40
+
+typedef struct {
+    char line[MAX_LINE_LENGTH + 1];
+    char station[MAX_STATION_LENGTH + 1];
+    int time;
+} kvv_entry_t;
+
+typedef struct {
+    int entries, error;
+    kvv_entry_t entry[MAX_LINES];
+} kvv_shm_t;
+
+static char *station_id = NULL;
+static char *proxy_name = NULL;
+static int port = 80;
+static pid_t pid = -1;
+static int refresh = 60;
+static int abbreviate = 0;
+
+static int initialized = 0;
+static int mutex = 0;
+static int shmid = -1;
+static kvv_shm_t *shm = NULL;
+
+#define SECTION   "Plugin:KVV"
+
+#define TIMEOUT_SHORT 1		/* wait this long for additional data */
+#define TIMEOUT_LONG  10	/* wait this long for initial data */
+
+/* search an element in the result string */
+static int get_element(char *input, char *name, char **data)
+{
+    int skip = 0;
+    int len = 0;
+    int state = 0;		/* nothing found yet */
+
+    /* search entire string */
+    while (*input) {
+
+	if (skip == 0) {
+	    switch (state) {
+	    case 0:
+		if (*input == '<')
+		    state = 1;
+		else
+		    state = 0;
+		break;
+
+	    case 1:
+		/* ignore white spaces */
+		if (*input != ' ') {
+		    if (strncasecmp(input, name, strlen(name)) == 0) {
+			state = 2;
+			skip = strlen(name) - 1;
+		    } else
+			state = 0;
+		}
+		break;
+
+	    case 2:
+		if (*input == ' ') {
+		    *data = ++input;
+		    while (*input && (*input++ != '>'))
+			len++;
+
+		    return len;
+		} else
+		    state = 0;
+		break;
+	    }
+	} else if (skip)
+	    skip--;
+
+	input++;
+    }
+
+    return -1;
+}
+
+/* serach an attribute within an element */
+static int get_attrib(char *input, char *name, char **data)
+{
+    int skip = 0;
+    int len = 0;
+    int state = 0;		/* nothing found */
+
+    /* search in this element */
+    while (*input != '>') {
+	/* ignore white spaces */
+	if (((*input != ' ') && (*input != '\t')) && (skip == 0)) {
+	    switch (state) {
+	    case 0:
+		if (strncasecmp(input, name, strlen(name)) == 0) {
+		    state = 1;
+		    skip = strlen(name) - 1;
+		}
+		break;
+
+	    case 1:
+		if (*input == '=')
+		    state = 2;
+		else
+		    state = 0;
+		break;
+
+	    case 2:
+		if (*input == '\"') {
+		    *data = ++input;
+		    while (*input++ != '\"')
+			len++;
+
+		    return len;
+		} else
+		    state = 0;
+
+		break;
+	    }
+	} else if (skip)
+	    skip--;
+
+	input++;
+    }
+    return -1;
+}
+
+static int http_open(char *name)
+{
+    struct sockaddr_in server;
+    struct hostent *host_info;
+    unsigned long addr;
+    int sock;
+
+    /* create socket */
+    sock = socket(PF_INET, SOCK_STREAM, 0);
+    if (sock < 0) {
+	perror("failed to create socket");
+	return -1;
+    }
+
+    /* Erzeuge die Socketadresse des Servers 
+     * Sie besteht aus Typ, IP-Adresse und Portnummer */
+    memset(&server, 0, sizeof(server));
+    if ((addr = inet_addr(name)) != INADDR_NONE) {
+	memcpy((char *) &server.sin_addr, &addr, sizeof(addr));
+    } else {
+	/* Wandle den Servernamen in eine IP-Adresse um */
+	host_info = gethostbyname(name);
+	if (NULL == host_info) {
+	    error("[KVV] Unknown server: %s", name);
+	    return -1;
+	}
+	memcpy((char *) &server.sin_addr, host_info->h_addr, host_info->h_length);
+    }
+
+    server.sin_family = AF_INET;
+    server.sin_port = htons(port);
+
+    /* Baue die Verbindung zum Server auf */
+    if (connect(sock, (struct sockaddr *) &server, sizeof(server)) < 0) {
+	perror("can't connect to server");
+	return -1;
+    }
+
+    return sock;
+}
+
+static void get_text(char *input, char *end, char *dest, int dlen)
+{
+    int state = 0;		/* nothing yet, outside any element */
+    int cnt = 0;
+
+    while (*input) {
+	switch (state) {
+	case 0:
+	    if (*input == '<')
+		state = 1;
+	    else {
+		if (cnt < (dlen - 1))
+		    dest[cnt++] = *input;
+	    }
+	    break;
+
+	case 1:
+	    if (*input == '/')
+		state = 2;
+	    else if (*input == '>')
+		state = 0;
+	    break;
+
+	case 2:
+	    if (strncasecmp(input, end, strlen(end)) == 0) {
+		dest[cnt++] = 0;
+		return;
+	    }
+	    break;
+	}
+
+	input++;
+    }
+
+}
+
+static void process_station_string(char *str)
+{
+    char *p, *q;
+    int last, i;
+
+    /* some strings to replace */
+    char *repl[] = {
+	"Hauptbahnhof", "Hbf.",
+	"Bahnhof", "Bhf.",
+	"Karlsruhe", "KA",
+	"Schienenersatzverkehr", "Ersatzv.",
+	"Marktplatz", "Marktpl.",
+    };
+
+    /* decode utf8 */
+    p = q = str;
+    last = 0;
+    while (*p) {
+	if (last) {
+	    *q++ = (last << 6) | (*p & 0x3f);
+	    last = 0;
+	} else if ((*p & 0xe0) == 0xc0) {
+	    last = *p & 3;
+	} else
+	    *q++ = *p;
+
+	p++;
+    }
+    *q++ = 0;
+
+    /* erase multiple spaces and replace umlauts */
+    p = q = str;
+    last = 1;			/* no leading spaces */
+    while (*p) {
+	if ((!last) || (*p != ' ')) {
+
+	    /* translate from latin1 to hd44780 */
+	    if (*p == (char) 228)	/* lower a umlaut */
+		*q++ = (char) 0xe1;
+	    else if (*p == (char) 223)	/* sz ligature */
+		*q++ = (char) 0xe2;
+	    else if (*p == (char) 246)	/* lower o umlaut */
+		*q++ = (char) 0xef;
+	    else if (*p == (char) 252)	/* lower u umlaut */
+		*q++ = (char) 0xf5;
+	    else
+		*q++ = *p;
+	}
+
+	last = (*p == ' ');
+	p++;
+    }
+    *q++ = 0;
+
+    /* replace certain (long) words with e.g. abbreviations if enabled */
+    if (abbreviate) {
+
+	for (i = 0; i < (int) (sizeof(repl) / (2 * sizeof(char *))); i++) {
+	    if ((p = strstr(str, repl[2 * i])) != NULL) {
+
+		/* move new string */
+		memcpy(p, repl[2 * i + 1], strlen(repl[2 * i + 1]));
+		/* move rest of string down */
+		memmove(p + strlen(repl[2 * i + 1]),
+			p + strlen(repl[2 * i]), strlen(str) - (p - str) - strlen(repl[2 * i]) + 1);
+	    }
+	}
+    }
+}
+
+static void kvv_client( __attribute__ ((unused))
+		       void *dummy)
+{
+    char ibuffer[8192];
+    char obuffer[1024];
+    int count, i, sock;
+
+    char server_name[] = HTTP_SERVER;
+    char *connect_to;
+
+    /* connect to proxy if given, to server otherwise */
+    if ((proxy_name != NULL) && (strlen(proxy_name) != 0))
+	connect_to = proxy_name;
+    else
+	connect_to = server_name;
+
+    info("[KVV] Connecting to %s", connect_to);
+
+    while (1) {
+
+	sock = http_open(connect_to);
+	if (sock < 0) {
+	    error("[KVV] Error accessing server/proxy: %s", strerror(errno));
+	    return;
+	}
+	/* create and set get request */
+	if (snprintf(obuffer, sizeof(obuffer),
+		     "GET http://%s" HTTP_REQUEST " HTTP/1.1\n"
+		     "Host: %s\n" "User-Agent: " USER_AGENT "\n\n", server_name, station_id,
+		     server_name) >= (int) sizeof(obuffer)) {
+
+	    info("[KVV] Warning, request has been truncated!");
+	}
+
+	info("[KVV] Sending first (GET) request ...");
+	send(sock, obuffer, strlen(obuffer), 0);
+
+	count = 0;
+	do {
+	    fd_set rfds;
+	    struct timeval tv;
+
+	    FD_ZERO(&rfds);
+	    FD_SET(sock, &rfds);
+
+	    tv.tv_sec = count ? TIMEOUT_SHORT : TIMEOUT_LONG;
+	    tv.tv_usec = 0;
+
+	    i = select(FD_SETSIZE, &rfds, NULL, NULL, &tv);
+	    if (i < 0) {
+		perror("select");
+		exit(1);
+	    }
+
+	    if (i != 0) {
+		i = recv(sock, ibuffer + count, sizeof(ibuffer) - count - 1, 0);
+		count += i;
+	    }
+	}
+	while (i > 0);
+
+	ibuffer[count] = 0;	/* terminate string */
+	close(sock);
+
+	if (!count)
+	    info("[KVV] empty/no reply");
+
+	if (count > 0) {
+	    char *input, *cookie, *name = NULL, *value = NULL;
+	    int input_len, cookie_len, name_len, value_len;
+
+	    /* buffer to html encode value */
+	    char value_enc[512];
+	    int value_enc_len;
+
+	    /* find cookie */
+	    cookie_len = 0;
+	    cookie = strstr(ibuffer, "Set-Cookie:");
+	    if (cookie) {
+		cookie += strlen("Set-Cookie:");
+
+		while (*cookie == ' ')
+		    cookie++;
+
+		while (cookie[cookie_len] != ';')
+		    cookie_len++;
+	    }
+	    /* find input element */
+	    input_len = get_element(ibuffer, "input", &input);
+
+
+	    if (input_len > 0) {
+		char *input_end = input;
+		while (*input_end != '>')
+		    input_end++;
+		while (*input_end != '\"')
+		    input_end--;
+		*(input_end + 1) = 0;
+
+		name_len = get_attrib(input, "name", &name);
+		value_len = get_attrib(input, "value", &value);
+
+		for (value_enc_len = 0, i = 0; i < value_len; i++) {
+		    if (isalnum(value[i]))
+			value_enc[value_enc_len++] = value[i];
+		    else {
+			sprintf(value_enc + value_enc_len, "%%%02X", 0xff & value[i]);
+			value_enc_len += 3;
+		    }
+		}
+
+		if (cookie_len >= 0)
+		    cookie[cookie_len] = 0;
+		if (name_len >= 0)
+		    name[name_len] = 0;
+		if (value_len >= 0)
+		    value[value_len] = 0;
+		if (value_enc_len >= 0)
+		    value_enc[value_enc_len] = 0;
+
+		sock = http_open(connect_to);
+
+		/* send POST */
+		if (snprintf(obuffer, sizeof(obuffer),
+			     "POST http://%s" HTTP_REQUEST " HTTP/1.1\n"
+			     "Host: %s\n"
+			     "User-Agent: " USER_AGENT "\n"
+			     "Cookie: %s\n"
+			     "Content-Type: application/x-www-form-urlencoded\n"
+			     "Content-Length: %d\n"
+			     "\n%s=%s",
+			     server_name, station_id, server_name, cookie, name_len + value_enc_len + 1, name,
+			     value_enc) >= (int) sizeof(obuffer)) {
+
+		    info("[KVV] Warning, request has been truncated!");
+		}
+
+		info("[KVV] Sending second (POST) request ...");
+		send(sock, obuffer, strlen(obuffer), 0);
+
+		count = 0;
+		do {
+		    fd_set rfds;
+		    struct timeval tv;
+
+		    FD_ZERO(&rfds);
+		    FD_SET(sock, &rfds);
+
+		    tv.tv_sec = count ? TIMEOUT_SHORT : TIMEOUT_LONG;
+		    tv.tv_usec = 0;
+
+		    i = select(FD_SETSIZE, &rfds, NULL, NULL, &tv);
+		    if (i > 0) {
+			i = recv(sock, ibuffer + count, sizeof(ibuffer) - count - 1, 0);
+			count += i;
+		    }
+		}
+		while (i > 0);	/* leave on select or read error */
+
+		ibuffer[count] = 0;
+
+		/* printf("Result (%d):\n%s\n", count, ibuffer); */
+
+		/* close connection */
+		close(sock);
+
+		if (!count)
+		    info("[KVV] empty/no reply");
+
+		if (count > 0) {
+		    int last_was_stop = 0;
+		    char *td = ibuffer;
+		    char str[32];
+		    int td_len, i, overflow = 0;
+
+		    /* lock shared memory */
+		    mutex_lock(mutex);
+
+		    /* free allocated memory */
+		    shm->entries = 0;
+
+		    if (strstr(ibuffer, "Die Daten konnten nicht abgefragt werden.") != NULL) {
+			info("[KVV] Server returned error!");
+			/* printf("%s\n", ibuffer); */
+			shm->error = 1;
+		    } else
+			shm->error = 0;
+
+		    /* scan through all <td> entries and search the line nums */
+		    do {
+			if ((td_len = get_element(td, "td", &td)) > 0) {
+			    char *attr, *p;
+			    int attr_len;
+
+			    /* time does not have a class but comes immediately after stop :-( */
+			    if (last_was_stop) {
+				td += td_len + 1;
+				get_text(td, "td", str, sizeof(str));
+
+				/* time needs special treatment */
+				if (strncasecmp(str, "sofort", strlen("sofort")) == 0)
+				    i = 0;
+				else {
+				    /* skip everything that is not a number */
+				    p = str;
+				    while (!isdigit(*p))
+					p++;
+
+				    /* and convert remaining to number */
+				    i = atoi(p);
+				}
+
+				/* save time */
+				if (!overflow)
+				    shm->entry[shm->entries - 1].time = i;
+
+				last_was_stop = 0;
+			    }
+
+			    /* linenum and stopname fields have proper classes */
+			    if ((attr_len = get_attrib(td, "class", &attr)) > 0) {
+
+				if (strncasecmp(attr, "lineNum", strlen("lineNum")) == 0) {
+				    td += td_len + 1;
+				    get_text(td, "td", str, sizeof(str));
+
+				    if (shm->entries < MAX_LINES) {
+					/* allocate a new slot */
+					shm->entries++;
+					shm->entry[shm->entries - 1].time = -1;
+					memset(shm->entry[shm->entries - 1].line, 0, MAX_LINE_LENGTH + 1);
+					memset(shm->entry[shm->entries - 1].station, 0, MAX_STATION_LENGTH + 1);
+
+					/* add new lines entry */
+					strncpy(shm->entry[shm->entries - 1].line, str, MAX_LINE_LENGTH);
+				    } else
+					overflow = 1;	/* don't add further entries */
+				}
+
+				if (strncasecmp(attr, "stopname", strlen("stopname")) == 0) {
+				    td += td_len + 1;
+				    get_text(td, "td", str, sizeof(str));
+
+
+				    /* stopname may need further tuning */
+				    process_station_string(str);
+
+				    if (!overflow)
+					strncpy(shm->entry[shm->entries - 1].station, str, MAX_STATION_LENGTH);
+
+				    last_was_stop = 1;
+				}
+			    }
+			}
+		    } while (td_len >= 0);
+
+		    mutex_unlock(mutex);
+		}
+	    }
+	}
+
+	sleep(refresh);
+    }
+}
+
+static int kvv_fork(void)
+{
+    if (initialized)
+	return 0;
+
+    info("[KVV] creating client thread");
+
+    /* set this here to prevent continous retries if init fails */
+    initialized = 1;
+
+    /* create communication buffer */
+    shmid = shm_create((void **) &shm, sizeof(kvv_shm_t));
+
+    /* catch error */
+    if (shmid < 0) {
+	error("[KVV] Shared memory allocation failed!");
+	return -1;
+    }
+
+    /* attach client thread */
+    mutex = mutex_create();
+    pid = thread_create("plugin_kvv", kvv_client, NULL);
+
+    if (pid < 0) {
+	error("[KVV] Unable to fork client: %s", strerror(errno));
+	return -1;
+    }
+
+    info("[KVV] forked client with pid %d", pid);
+    return 0;
+}
+
+static void kvv_start(void)
+{
+    static int started = 0;
+    int val;
+    char *p;
+
+
+    if (started)
+	return;
+
+    started = 1;
+
+    /* parse parameter */
+    if ((p = cfg_get(SECTION, "StationID", DEFAULT_STATION_ID)) != NULL) {
+	station_id = malloc(strlen(p) + 1);
+	strcpy(station_id, p);
+    }
+    info("[KVV] Using station %s", station_id);
+
+    if ((p = cfg_get(SECTION, "Proxy", NULL)) != NULL) {
+	proxy_name = malloc(strlen(p) + 1);
+	strcpy(proxy_name, p);
+	info("[KVV] Using proxy \"%s\"", proxy_name);
+    }
+
+    if (cfg_number(SECTION, "Port", 0, 0, 65535, &val) > 0) {
+	port = val;
+	info("[KVV] Using port %d", port);
+    } else {
+	info("[KVV] Using default port %d", port);
+    }
+
+    if (cfg_number(SECTION, "Refresh", 0, 0, 65535, &val) > 0) {
+	refresh = val;
+	info("[KVV] Using %d seconds refresh interval", refresh);
+    } else {
+	info("[KVV] Using default refresh interval of %d seconds", refresh);
+    }
+
+    if (cfg_number(SECTION, "Abbreviate", 0, 0, 65535, &val) > 0) {
+	abbreviate = val;
+	info("[KVV] Abbreviation enabled: %s", abbreviate ? "on" : "off");
+    } else {
+	info("[KVV] Default abbreviation setting: %s", abbreviate ? "on" : "off");
+    }
+
+}
+
+static void kvv_line(RESULT * result, RESULT * arg1)
+{
+    int index = (int) R2N(arg1);
+
+    kvv_start();
+
+    if (kvv_fork() != 0) {
+	SetResult(&result, R_STRING, "");
+	return;
+    }
+
+    mutex_lock(mutex);
+
+    if (index < shm->entries) {
+	SetResult(&result, R_STRING, shm->entry[index].line);
+    } else
+	SetResult(&result, R_STRING, "");
+
+    mutex_unlock(mutex);
+}
+
+static void kvv_station(RESULT * result, RESULT * arg1)
+{
+    int index = (int) R2N(arg1);
+
+    kvv_start();
+
+    if (kvv_fork() != 0) {
+	SetResult(&result, R_STRING, "");
+	return;
+    }
+
+    mutex_lock(mutex);
+
+    if (shm->error && index == 0)
+	SetResult(&result, R_STRING, "Server Err");
+    else {
+	if (index < shm->entries)
+	    SetResult(&result, R_STRING, shm->entry[index].station);
+	else
+	    SetResult(&result, R_STRING, "");
+    }
+
+    mutex_unlock(mutex);
+}
+
+static void kvv_time(RESULT * result, RESULT * arg1)
+{
+    int index = (int) R2N(arg1);
+    double value = -1.0;
+
+    kvv_start();
+
+    if (kvv_fork() != 0) {
+	SetResult(&result, R_STRING, "");
+	return;
+    }
+
+    mutex_lock(mutex);
+
+    if (index < shm->entries)
+	value = shm->entry[index].time;
+
+    SetResult(&result, R_NUMBER, &value);
+
+    mutex_unlock(mutex);
+}
+
+static void kvv_time_str(RESULT * result, RESULT * arg1)
+{
+    int index = (int) R2N(arg1);
+
+    kvv_start();
+
+    if (kvv_fork() != 0) {
+	SetResult(&result, R_STRING, "");
+	return;
+    }
+
+    mutex_lock(mutex);
+
+    if (index < shm->entries) {
+	char str[8];
+	sprintf(str, "%d", shm->entry[index].time);
+	SetResult(&result, R_STRING, str);
+    } else
+	SetResult(&result, R_STRING, "");
+
+    mutex_unlock(mutex);
+}
+
+/* plugin initialization */
+int plugin_init_kvv(void)
+{
+    /* register all our cool functions */
+    AddFunction("kvv::line", 1, kvv_line);
+    AddFunction("kvv::station", 1, kvv_station);
+    AddFunction("kvv::time", 1, kvv_time);
+    AddFunction("kvv::time_str", 1, kvv_time_str);
+    return 0;
+}
+
+void plugin_exit_kvv(void)
+{
+    /* kill client thread if it's running */
+    if (initialized) {
+	/* kill client */
+	if (pid != -1)
+	    thread_destroy(pid);
+
+	/* free shared mem and its mutex */
+	if (shm) {
+	    shm_destroy(shmid, shm);
+	    mutex_destroy(mutex);
+	}
+    }
+
+    if (station_id)
+	free(station_id);
+    if (proxy_name)
+	free(proxy_name);
+}
diff -urN lcd4linux-0.10.0/plugin_loadavg.c lcd4linux-0.11.0-SVN/plugin_loadavg.c
--- lcd4linux-0.10.0/plugin_loadavg.c	2005-05-08 06:32:44.000000000 +0200
+++ lcd4linux-0.11.0-SVN/plugin_loadavg.c	2008-12-31 08:05:54.000000000 +0100
@@ -1,8 +1,9 @@
-/* $Id: plugin_loadavg.c,v 1.10 2005/05/08 04:32:44 reinelt Exp $
+/* $Id: plugin_loadavg.c 840 2007-09-09 12:17:42Z michael $
+ * $URL: https://ssl.bulix.org/svn/lcd4linux/trunk/plugin_loadavg.c $
  *
  * plugin for load average
  *
- * Copyright (C) 2003 Michael Reinelt <reinelt@eunet.at>
+ * Copyright (C) 2003 Michael Reinelt <michael@reinelt.co.at>
  * Copyright (C) 2004 The LCD4Linux Team <lcd4linux-devel@users.sourceforge.net>
  *
  * This file is part of LCD4Linux.
@@ -21,58 +22,6 @@
  * along with this program; if not, write to the Free Software
  * Foundation, Inc., 675 Mass Ave, Cambridge, MA 02139, USA.
  *
- *
- * $Log: plugin_loadavg.c,v $
- * Revision 1.10  2005/05/08 04:32:44  reinelt
- * CodingStyle added and applied
- *
- * Revision 1.9  2005/01/18 06:30:23  reinelt
- * added (C) to all copyright statements
- *
- * Revision 1.8  2004/06/26 12:05:00  reinelt
- *
- * uh-oh... the last CVS log message messed up things a lot...
- *
- * Revision 1.7  2004/06/26 09:27:21  reinelt
- *
- * added '-W' to CFLAGS
- * changed all C++ comments to C ones
- * cleaned up a lot of signed/unsigned mistakes
- *
- * Revision 1.6  2004/03/11 06:39:59  reinelt
- * big patch from Martin:
- * - reuse filehandles
- * - memory leaks fixed
- * - earlier busy-flag checking with HD44780
- * - reuse memory for strings in RESULT and hash
- * - netdev_fast to wavid time-consuming regex
- *
- * Revision 1.5  2004/03/08 18:46:21  hejl
- * Fixed bug introduced with "caching" the loadavg values
- *
- * Revision 1.4  2004/03/03 03:47:04  reinelt
- * big patch from Martin Hejl:
- * - use qprintf() where appropriate
- * - save CPU cycles on gettimeofday()
- * - add quit() functions to free allocated memory
- * - fixed lots of memory leaks
- *
- * Revision 1.3  2004/01/30 07:12:35  reinelt
- * HD44780 busy-flag support from Martin Hejl
- * loadavg() uClibc replacement from Martin Heyl
- * round() uClibc replacement from Martin Hejl
- * warning in i2c_sensors fixed
- * [
- *
- * Revision 1.2  2004/01/29 04:40:02  reinelt
- * every .c file includes "config.h" now
- *
- * Revision 1.1  2004/01/15 04:29:45  reinelt
- * moved lcd4linux.conf.sample to *.old
- * lcd4linux.conf.sample with new layout
- * new plugins 'loadavg' and 'meminfo'
- * text widget have pre- and postfix
- *
  */
 
 /* 
diff -urN lcd4linux-0.10.0/plugin_math.c lcd4linux-0.11.0-SVN/plugin_math.c
--- lcd4linux-0.10.0/plugin_math.c	2005-05-08 06:32:44.000000000 +0200
+++ lcd4linux-0.11.0-SVN/plugin_math.c	2008-12-31 08:05:54.000000000 +0100
@@ -1,8 +1,9 @@
-/* $Id: plugin_math.c,v 1.9 2005/05/08 04:32:44 reinelt Exp $
+/* $Id: plugin_math.c 840 2007-09-09 12:17:42Z michael $
+ * $URL: https://ssl.bulix.org/svn/lcd4linux/trunk/plugin_math.c $
  *
  * math plugin
  *
- * Copyright (C) 2003 Michael Reinelt <reinelt@eunet.at>
+ * Copyright (C) 2003 Michael Reinelt <michael@reinelt.co.at>
  * Copyright (C) 2004 The LCD4Linux Team <lcd4linux-devel@users.sourceforge.net>
  *
  * This file is part of LCD4Linux.
@@ -21,46 +22,6 @@
  * along with this program; if not, write to the Free Software
  * Foundation, Inc., 675 Mass Ave, Cambridge, MA 02139, USA.
  *
- *
- * $Log: plugin_math.c,v $
- * Revision 1.9  2005/05/08 04:32:44  reinelt
- * CodingStyle added and applied
- *
- * Revision 1.8  2005/04/05 04:46:06  reinelt
- * ceil/floor patch from Maxime
- *
- * Revision 1.7  2005/01/18 06:30:23  reinelt
- * added (C) to all copyright statements
- *
- * Revision 1.6  2004/06/26 12:05:00  reinelt
- *
- * uh-oh... the last CVS log message messed up things a lot...
- *
- * Revision 1.5  2004/06/26 09:27:21  reinelt
- *
- * added '-W' to CFLAGS
- * changed all C++ comments to C ones
- * cleaned up a lot of signed/unsigned mistakes
- *
- * Revision 1.4  2004/03/06 20:31:16  reinelt
- * Complete rewrite of the evaluator to get rid of the code
- * from mark Morley (because of license issues).
- * The new Evaluator does a pre-compile of expressions, and
- * stores them in trees. Therefore it should be reasonable faster...
- *
- * Revision 1.3  2004/03/03 03:47:04  reinelt
- * big patch from Martin Hejl:
- * - use qprintf() where appropriate
- * - save CPU cycles on gettimeofday()
- * - add quit() functions to free allocated memory
- * - fixed lots of memory leaks
- *
- * Revision 1.2  2004/01/29 04:40:02  reinelt
- * every .c file includes "config.h" now
- *
- * Revision 1.1  2003/12/19 05:50:34  reinelt
- * added plugin_math.c and plugin_string.c
- *
  */
 
 /* 
@@ -153,6 +114,26 @@
     SetResult(&result, R_NUMBER, &value);
 }
 
+static void my_decode(RESULT * result, int argc, RESULT * argv[])
+{
+    int index;
+
+    if (argc < 2) {
+	error("decode(): wrong number of parameters");
+	SetResult(&result, R_STRING, "");
+	return;
+    }
+
+    index = R2N(argv[0]);
+
+    if (index < 0 || index >= argc - 1) {
+	SetResult(&result, R_STRING, "");
+	return;
+    }
+
+    CopyResult(&result, argv[index + 1]);
+}
+
 
 int plugin_init_math(void)
 {
@@ -177,6 +158,9 @@
     AddFunction("floor", 1, my_floor);
     AddFunction("ceil", 1, my_ceil);
 
+    /* decode */
+    AddFunction("decode", -1, my_decode);
+
     return 0;
 }
 
diff -urN lcd4linux-0.10.0/plugin_meminfo.c lcd4linux-0.11.0-SVN/plugin_meminfo.c
--- lcd4linux-0.10.0/plugin_meminfo.c	2005-05-08 06:32:44.000000000 +0200
+++ lcd4linux-0.11.0-SVN/plugin_meminfo.c	2008-12-31 08:05:54.000000000 +0100
@@ -1,8 +1,9 @@
-/* $Id: plugin_meminfo.c,v 1.12 2005/05/08 04:32:44 reinelt Exp $
+/* $Id: plugin_meminfo.c 840 2007-09-09 12:17:42Z michael $
+ * $URL: https://ssl.bulix.org/svn/lcd4linux/trunk/plugin_meminfo.c $
  *
  * plugin for /proc/meminfo parsing
  *
- * Copyright (C) 2003 Michael Reinelt <reinelt@eunet.at>
+ * Copyright (C) 2003 Michael Reinelt <michael@reinelt.co.at>
  * Copyright (C) 2004 The LCD4Linux Team <lcd4linux-devel@users.sourceforge.net>
  *
  * This file is part of LCD4Linux.
@@ -21,62 +22,6 @@
  * along with this program; if not, write to the Free Software
  * Foundation, Inc., 675 Mass Ave, Cambridge, MA 02139, USA.
  *
- *
- * $Log: plugin_meminfo.c,v $
- * Revision 1.12  2005/05/08 04:32:44  reinelt
- * CodingStyle added and applied
- *
- * Revision 1.11  2005/01/18 06:30:23  reinelt
- * added (C) to all copyright statements
- *
- * Revision 1.10  2004/06/26 12:05:00  reinelt
- *
- * uh-oh... the last CVS log message messed up things a lot...
- *
- * Revision 1.9  2004/06/26 09:27:21  reinelt
- *
- * added '-W' to CFLAGS
- * changed all C++ comments to C ones
- * cleaned up a lot of signed/unsigned mistakes
- *
- * Revision 1.8  2004/06/17 06:23:43  reinelt
- *
- * hash handling rewritten to solve performance issues
- *
- * Revision 1.7  2004/03/11 06:39:59  reinelt
- * big patch from Martin:
- * - reuse filehandles
- * - memory leaks fixed
- * - earlier busy-flag checking with HD44780
- * - reuse memory for strings in RESULT and hash
- * - netdev_fast to wavid time-consuming regex
- *
- * Revision 1.6  2004/03/03 03:47:04  reinelt
- * big patch from Martin Hejl:
- * - use qprintf() where appropriate
- * - save CPU cycles on gettimeofday()
- * - add quit() functions to free allocated memory
- * - fixed lots of memory leaks
- *
- * Revision 1.5  2004/01/29 04:40:02  reinelt
- * every .c file includes "config.h" now
- *
- * Revision 1.4  2004/01/25 05:30:09  reinelt
- * plugin_netdev for parsing /proc/net/dev added
- *
- * Revision 1.3  2004/01/21 10:48:17  reinelt
- * hash_age function added
- *
- * Revision 1.2  2004/01/16 07:26:25  reinelt
- * moved various /proc parsing to own functions
- * made some progress with /proc/stat parsing
- *
- * Revision 1.1  2004/01/15 04:29:45  reinelt
- * moved lcd4linux.conf.sample to *.old
- * lcd4linux.conf.sample with new layout
- * new plugins 'loadavg' and 'meminfo'
- * text widget have pre- and postfix
- *
  */
 
 /* 
diff -urN lcd4linux-0.10.0/plugin_mpd.c lcd4linux-0.11.0-SVN/plugin_mpd.c
--- lcd4linux-0.10.0/plugin_mpd.c	1970-01-01 01:00:00.000000000 +0100
+++ lcd4linux-0.11.0-SVN/plugin_mpd.c	2008-12-31 08:05:54.000000000 +0100
@@ -0,0 +1,754 @@
+/* $Id: plugin_mpd.c 887 2008-08-03 03:10:49Z michael $
+ * $URL: https://ssl.bulix.org/svn/lcd4linux/trunk/plugin_mpd.c $
+ *
+ * mpd informations v0.82
+ *
+ * Copyright (C) 2006 Stefan Kuhne <sk-privat@gmx.net>
+ * Copyright (C) 2007 Robert Buchholz <rbu@gentoo.org>
+ * Copyright (C) 2008 Michael Vogt <michu@neophob.com>
+ * Copyright (C) 2006 The LCD4Linux Team <lcd4linux-devel@users.sourceforge.net>
+ *
+ * This file is part of LCD4Linux.
+ *
+ * LCD4Linux is free software; you can redistribute it and/or modify
+ * it under the terms of the GNU General Public License as published by
+ * the Free Software Foundation; either version 2, or (at your option)
+ * any later version.
+ *
+ * LCD4Linux is distributed in the hope that it will be useful,
+ * but WITHOUT ANY WARRANTY; without even the implied warranty of
+ * MERCHANTABILITY or FITNESS FOR A PARTICULAR PURPOSE.  See the
+ * GNU General Public License for more details.
+ *
+ * You should have received a copy of the GNU General Public License
+ * along with this program; if not, write to the Free Software
+ * Foundation, Inc., 675 Mass Ave, Cambridge, MA 02139, USA.
+ *
+ */
+
+/* 
+ * changelog v0.5 (20.11.2007):
+ *   changed: 	mpd::artist(), mpd::title(), mpd::album()
+ *              init code, call only if a function is used.
+ *   removed: 	"old style" functions, duplicate code
+ *   fixed: 	strdup() mem leaks
+ *   added:	getstate, function which return player status: play/pause/stop
+ *		getVolume, funtcion which returns the mpd volume
+ *		getFilename, return current filename
+ *
+ * 
+ * changelog v0.6 (05.12.2007):
+ *  changed:    -connection handling
+ *              -verbose "NO TAG" messages
+ *              -init code
+ *  added:      -added password support (MPD_PASSWORD env variable)
+ *              -mpd::getSongsInDb - how many songs are in the mpd db?
+ *              -mpd::getMpdUptime - uptime of mpd
+ *              -mpd::getMpdPlayTime - playtime of mpd
+ *              -mpd::getMpdDbPlayTime - playtime of all songs in mpd db
+ *              -basic error handler..
+ *		-mpd configuration in lcd4linux.conf
+ *		-formatTime* - use those functions to format time values
+ *  removed:    -reprand method
+ *
+ *
+ * changelog v0.7 (14.12.2007):
+ *  changed:	-connection handling improved, do not disconnect/reconnect for each query
+ *               -> uses less ressources
+ *
+ * changelog v0.8 (30.01.2008):
+ *  changed:  -libmpd is not needed anymore, use libmpdclient.c instead
+ *  fixed:    -getMpdUptime()
+ *            -getMpdPlaytime()
+ *            -type definition
+ *  added:    -mpd::getSamplerateHz
+ *            -getAudioChannels
+ *
+ * changelog v0.83 (26.07.2008):
+ *  added:    -mpd::cmd* commands
+ *
+ */
+
+/*
+
+TODO: 
+ -what happens if the db is updating? 
+
+*/
+
+#include "config.h"
+#include <stdio.h>
+#include <stdlib.h>
+#include <string.h>
+#include <ctype.h>
+#include <signal.h>
+
+#include "debug.h"
+#include "plugin.h"
+#include "cfg.h"
+/* struct timeval */
+#include <sys/time.h>
+
+/* source: http://www.musicpd.org/libmpdclient.shtml */
+#include "libmpdclient.h"
+
+#ifdef WITH_DMALLOC
+#include <dmalloc.h>
+#endif
+
+#define TIMEOUT_IN_S 10
+#define ERROR_DISPLAY 5
+
+/* current song */
+
+static int l_totalTimeSec;
+static int l_elapsedTimeSec;
+static int l_bitRate;
+static int l_repeatEnabled;
+static int l_randomEnabled;
+static int l_state;
+static int l_volume;
+static int l_numberOfSongs;
+static unsigned long l_uptime;
+static unsigned long l_playTime;
+static unsigned long l_dbPlayTime;
+static int l_playlistLength;
+/* pos in playlist */
+static int l_currentSongPos;
+static unsigned int l_sampleRate;
+static int l_channels;
+
+static mpd_Song *currentSong;
+
+/* connection information */
+static char host[255];
+static char pw[255];
+static int iport;
+static int plugin_enabled;
+static int waittime;
+struct timeval timestamp;
+
+static mpd_Connection *conn;
+static char Section[] = "Plugin:MPD";
+static int errorcnt = 0;
+
+
+static int configure_mpd(void)
+{
+    static int configured = 0;
+
+    char *s;
+
+    if (configured != 0)
+	return configured;
+
+    /* read enabled */
+    if (cfg_number(Section, "enabled", 0, 0, 1, &plugin_enabled) < 1) {
+	plugin_enabled = 0;
+    }
+
+    if (plugin_enabled != 1) {
+	info("[MPD] WARNING: Plugin is not enabled! (set 'enabled 1' to enable this plugin)");
+	configured = 1;
+	return configured;
+    }
+
+    /* read server */
+    s = cfg_get(Section, "server", "localhost");
+    if (*s == '\0') {
+	info("[MPD] empty '%s.server' entry from %s, assuming 'localhost'", Section, cfg_source());
+	strcpy(host, "localhost");
+    } else
+	strcpy(host, s);
+
+    free(s);
+
+    /* read port */
+    if (cfg_number(Section, "port", 6600, 1, 65536, &iport) < 1) {
+	info("[MPD] no '%s.port' entry from %s using MPD's default", Section, cfg_source());
+    }
+
+    /* read minUpdateTime in ms */
+    if (cfg_number(Section, "minUpdateTime", 500, 1, 10000, &waittime) < 1) {
+	info("[MPD] no '%s.minUpdateTime' entry from %s using MPD's default", Section, cfg_source());
+    }
+
+
+    /* read password */
+    s = cfg_get(Section, "password", "");
+    if (*s == '\0') {
+	info("[MPD] empty '%s.password' entry in %s, assuming none", Section, cfg_source());
+	memset(pw, 0, sizeof(pw));
+    } else {
+	strcpy(pw, s);
+	free(s);
+    }
+
+    debug("[MPD] connection detail: [%s:%d]", host, iport);
+    configured = 1;
+    return configured;
+}
+
+
+static int mpd_update()
+{
+    int ret = -1;
+    struct timeval now;
+
+    /* reread every 1000 msec only */
+    gettimeofday(&now, NULL);
+    int timedelta = (now.tv_sec - timestamp.tv_sec) * 1000 + (now.tv_usec - timestamp.tv_usec) / 1000;
+
+    if (timedelta < waittime) {
+	/* debug("[MPD] waittime not reached...\n"); */
+	return 1;
+    }
+
+    /* check if configured */
+    if (configure_mpd() < 0) {
+	return -1;
+    }
+    /* check if connected */
+    if (conn == NULL || conn->error) {
+	if (conn) {
+	    if (errorcnt < ERROR_DISPLAY)
+		debug("[MPD] Error: [%s], try to reconnect to [%s]:[%i]\n", conn->errorStr, host, iport);
+	    mpd_closeConnection(conn);
+	} else
+	    debug("[MPD] initialize connect to [%s]:[%i]\n", host, iport);
+
+	conn = mpd_newConnection(host, iport, TIMEOUT_IN_S);
+	if (conn->error) {
+	    if (errorcnt < ERROR_DISPLAY)
+		error("[MPD] connection failed, give up...");
+	    if (errorcnt == ERROR_DISPLAY)
+		error("[MPD] stop logging, until connection is fixed!");
+	    errorcnt++;
+	    gettimeofday(&timestamp, NULL);
+	    return -1;
+	}
+	errorcnt = 0;
+	debug("[MPD] connection fixed...");
+    }
+
+    mpd_Status *status = NULL;
+    mpd_Stats *stats = NULL;
+    mpd_InfoEntity *entity;
+
+    mpd_sendCommandListOkBegin(conn);
+    mpd_sendStatsCommand(conn);
+
+    if (conn->error) {
+	error("[MPD] error: %s", conn->errorStr);
+	return -1;
+    }
+
+    mpd_sendStatusCommand(conn);
+    mpd_sendCurrentSongCommand(conn);
+    mpd_sendCommandListEnd(conn);
+
+    stats = mpd_getStats(conn);
+    if (stats == NULL) {
+	error("[MPD] error mpd_getStats: %s", conn->errorStr);
+	goto cleanup;
+    }
+
+    mpd_nextListOkCommand(conn);
+    if ((status = mpd_getStatus(conn)) == NULL) {
+	error("[MPD] error mpd_nextListOkCommand: %s", conn->errorStr);
+	goto cleanup;
+    }
+
+    mpd_nextListOkCommand(conn);
+    while ((entity = mpd_getNextInfoEntity(conn))) {
+	mpd_Song *song = entity->info.song;
+
+	if (entity->type != MPD_INFO_ENTITY_TYPE_SONG) {
+	    mpd_freeInfoEntity(entity);
+	    continue;
+	}
+	if (currentSong != NULL)
+	    mpd_freeSong(currentSong);
+
+	currentSong = mpd_songDup(song);
+	mpd_freeInfoEntity(entity);
+    }
+
+    l_elapsedTimeSec = status->elapsedTime;
+    l_totalTimeSec = status->totalTime;
+    l_repeatEnabled = status->repeat;
+    l_randomEnabled = status->random;
+    l_bitRate = status->bitRate;
+    l_state = status->state;
+    l_volume = status->volume;
+    l_playlistLength = status->playlistLength;
+    l_currentSongPos = status->song + 1;
+    l_sampleRate = status->sampleRate;
+    l_channels = status->channels;
+
+    l_numberOfSongs = stats->numberOfSongs;
+    l_uptime = stats->uptime;
+    l_playTime = stats->playTime;
+    l_dbPlayTime = stats->dbPlayTime;
+
+
+    /* sanity checks */
+    if (l_volume < 0 || l_volume > 100)
+	l_volume = 0;
+
+    if (l_bitRate < 0)
+	l_bitRate = 0;
+
+    if (l_elapsedTimeSec > l_totalTimeSec || l_elapsedTimeSec < 0)
+	l_elapsedTimeSec = 0;
+    ret = 0;
+
+  cleanup:
+    if (stats != NULL)
+	mpd_freeStats(stats);
+
+    if (status != NULL)
+	mpd_freeStatus(status);
+
+    if (conn->error) {
+	error("[MPD] error: %s", conn->errorStr);
+	return -1;
+    }
+
+    mpd_finishCommand(conn);
+    if (conn->error) {
+	error("[MPD] error mpd_finishCommand: %s", conn->errorStr);
+	return -1;
+    }
+
+    gettimeofday(&timestamp, NULL);
+    return ret;
+}
+
+
+static void elapsedTimeSec(RESULT * result)
+{
+    double d;
+    mpd_update();
+    d = (double) l_elapsedTimeSec;
+    SetResult(&result, R_NUMBER, &d);
+}
+
+
+static void totalTimeSec(RESULT * result)
+{
+    double d;
+    mpd_update();
+    d = (double) l_totalTimeSec;
+    SetResult(&result, R_NUMBER, &d);
+}
+
+static void bitRate(RESULT * result)
+{
+    double d;
+    mpd_update();
+    d = (double) l_bitRate;
+    SetResult(&result, R_NUMBER, &d);
+}
+
+
+static void getRepeatInt(RESULT * result)
+{
+    double d;
+    mpd_update();
+    d = (double) l_repeatEnabled;
+    SetResult(&result, R_NUMBER, &d);
+}
+
+
+static void getRandomInt(RESULT * result)
+{
+    double d;
+    mpd_update();
+    d = (double) l_randomEnabled;
+    SetResult(&result, R_NUMBER, &d);
+}
+
+/* if no tag is availabe, use filename */
+static void getArtist(RESULT * result)
+{
+    mpd_update();
+    if (currentSong != NULL) {
+	if (currentSong->artist != NULL) {
+	    SetResult(&result, R_STRING, currentSong->artist);
+	} else {
+	    if (currentSong->file != NULL)
+		SetResult(&result, R_STRING, currentSong->file);
+	    else
+		SetResult(&result, R_STRING, "");
+	}
+    } else
+	SetResult(&result, R_STRING, "");
+
+}
+
+static void getTitle(RESULT * result)
+{
+    mpd_update();
+    if (currentSong != NULL) {
+	if (currentSong->title != NULL) {
+	    SetResult(&result, R_STRING, currentSong->title);
+	} else
+	    SetResult(&result, R_STRING, "");
+    } else
+	SetResult(&result, R_STRING, "");
+
+}
+
+static void getAlbum(RESULT * result)
+{
+    mpd_update();
+    if (currentSong != NULL) {
+	if (currentSong->album != NULL)
+	    SetResult(&result, R_STRING, currentSong->album);
+	else
+	    SetResult(&result, R_STRING, "");
+    } else
+	SetResult(&result, R_STRING, "");
+}
+
+static void getFilename(RESULT * result)
+{
+    mpd_update();
+    if (currentSong != NULL) {
+	if (currentSong->file != NULL)
+	    SetResult(&result, R_STRING, currentSong->file);
+	else
+	    SetResult(&result, R_STRING, "");
+    } else
+	SetResult(&result, R_STRING, "");
+
+}
+
+/*  
+    return player state:
+	0=unknown
+	1=play
+	2=pause
+	3=stop
+*/
+static void getStateInt(RESULT * result)
+{
+    double ret;
+
+    mpd_update();
+
+    switch (l_state) {
+    case MPD_STATUS_STATE_PLAY:
+	ret = 1;
+	break;
+    case MPD_STATUS_STATE_PAUSE:
+	ret = 2;
+	break;
+    case MPD_STATUS_STATE_STOP:
+	ret = 3;
+	break;
+    default:
+	ret = 0;
+	break;
+    }
+
+    SetResult(&result, R_NUMBER, &ret);
+}
+
+
+static void getVolume(RESULT * result)
+{
+    double d;
+    mpd_update();
+    d = (double) l_volume;
+    /* return 0..100 or < 0 when failed */
+    SetResult(&result, R_NUMBER, &d);
+}
+
+/* return the # of songs in the mpd db .. */
+static void getSongsInDb(RESULT * result)
+{
+    double d;
+    mpd_update();
+    d = (double) l_numberOfSongs;
+    SetResult(&result, R_NUMBER, &d);
+}
+
+static void getMpdUptime(RESULT * result)
+{
+    double d;
+    mpd_update();
+    d = (double) l_uptime;
+    SetResult(&result, R_NUMBER, &d);
+}
+
+static void getMpdPlayTime(RESULT * result)
+{
+    double d;
+    mpd_update();
+    d = (double) l_playTime;
+    SetResult(&result, R_NUMBER, &d);
+}
+
+static void getMpdDbPlayTime(RESULT * result)
+{
+    double d;
+    mpd_update();
+    d = (double) l_dbPlayTime;
+    SetResult(&result, R_NUMBER, &d);
+}
+
+static void getMpdPlaylistLength(RESULT * result)
+{
+    double d;
+    mpd_update();
+    d = (double) l_playlistLength;
+    SetResult(&result, R_NUMBER, &d);
+}
+
+static void getCurrentSongPos(RESULT * result)
+{
+    double d;
+    mpd_update();
+    d = (double) l_currentSongPos;
+    SetResult(&result, R_NUMBER, &d);
+}
+
+static void getAudioChannels(RESULT * result)
+{
+    double d;
+    mpd_update();
+    d = (double) l_channels;
+    SetResult(&result, R_NUMBER, &d);
+}
+
+static void getSamplerateHz(RESULT * result)
+{
+    double d;
+    mpd_update();
+    d = (double) l_sampleRate;
+    SetResult(&result, R_NUMBER, &d);
+}
+
+
+static void nextSong()
+{
+    mpd_update();
+    if (currentSong != NULL) {
+	mpd_sendNextCommand(conn);
+	mpd_finishCommand(conn);
+	if (conn->error) {
+	    error("[MPD] error mpd_finishCommand: %s", conn->errorStr);
+	}
+    }
+}
+
+static void prevSong()
+{
+    mpd_update();
+    if (currentSong != NULL) {
+	mpd_sendPrevCommand(conn);
+	mpd_finishCommand(conn);
+	if (conn->error) {
+	    error("[MPD] error mpd_finishCommand: %s", conn->errorStr);
+	}
+    }
+}
+
+static void stopSong()
+{
+    mpd_update();
+    if (currentSong != NULL) {
+	mpd_sendStopCommand(conn);
+	mpd_finishCommand(conn);
+	if (conn->error) {
+	    error("[MPD] error mpd_finishCommand: %s", conn->errorStr);
+	}
+    }
+}
+
+static void pauseSong()
+{
+    mpd_update();
+    if (currentSong != NULL) {
+	if (l_state == MPD_STATUS_STATE_PAUSE) {
+	    mpd_sendPauseCommand(conn, 0);
+	} else {
+	    mpd_sendPauseCommand(conn, 1);
+	}
+
+	mpd_finishCommand(conn);
+	if (conn->error) {
+	    error("[MPD] error mpd_finishCommand: %s", conn->errorStr);
+	}
+    }
+}
+
+static void volUp()
+{
+    mpd_update();
+    if (currentSong != NULL) {
+	l_volume += 5;
+	if (l_volume > 100)
+	    l_volume = 100;
+	mpd_sendSetvolCommand(conn, l_volume);
+	mpd_finishCommand(conn);
+	if (conn->error) {
+	    error("[MPD] error mpd_finishCommand: %s", conn->errorStr);
+	}
+    }
+}
+
+static void volDown()
+{
+    mpd_update();
+    if (currentSong != NULL) {
+	if (l_volume > 5)
+	    l_volume -= 5;
+	else
+	    l_volume = 0;
+	mpd_sendSetvolCommand(conn, l_volume);
+	mpd_finishCommand(conn);
+	if (conn->error) {
+	    error("[MPD] error mpd_finishCommand: %s", conn->errorStr);
+	}
+    }
+}
+
+static void toggleRepeat()
+{
+    mpd_update();
+    if (currentSong != NULL) {
+
+	l_repeatEnabled = !l_repeatEnabled;
+	mpd_sendRepeatCommand(conn, l_repeatEnabled);
+
+	mpd_finishCommand(conn);
+	if (conn->error) {
+	    error("[MPD] error mpd_finishCommand: %s", conn->errorStr);
+	}
+    }
+}
+
+
+static void toggleRandom()
+{
+    mpd_update();
+    if (currentSong != NULL) {
+
+	l_randomEnabled = !l_randomEnabled;
+	mpd_sendRandomCommand(conn, l_randomEnabled);
+
+	mpd_finishCommand(conn);
+	if (conn->error) {
+	    error("[MPD] error mpd_finishCommand: %s", conn->errorStr);
+	}
+    }
+}
+
+
+static void formatTimeMMSS(RESULT * result, RESULT * param)
+{
+    long sec;
+    char myTime[6] = " ";
+
+    sec = R2N(param);
+
+    if ((sec >= 0) && (sec < 6000)) {
+	const int minutes = (int) (sec / 60);
+	const int seconds = (int) (sec % 60);
+	sprintf(myTime, "%02d:%02d", minutes, seconds);
+    } else if (sec >= 6000) {
+	strcpy(myTime, "LONG");
+    } else
+	strcpy(myTime, "ERROR");
+
+    /* store result */
+    SetResult(&result, R_STRING, myTime);
+}
+
+static void formatTimeDDHHMM(RESULT * result, RESULT * param)
+{
+    long sec;
+    char myTime[16] = " ";
+
+    sec = R2N(param);
+
+    if (sec >= 0) {
+	int days = sec / 86400;
+	int hours = (sec % 86400) / 3600;
+	int minutes = (sec % 3600) / 60;
+	sprintf(myTime, "%dd%02dh%02dm", days, hours, minutes);	/* 3d 12:33h */
+    } else
+	strcpy(myTime, "ERROR");
+
+    /* store result */
+    SetResult(&result, R_STRING, myTime);
+}
+
+
+
+int plugin_init_mpd(void)
+{
+    int check;
+    debug("[MPD] v0.83, check lcd4linux configuration file...");
+
+    check = configure_mpd();
+    if (plugin_enabled != 1)
+	return 0;
+
+    if (check)
+	debug("[MPD] configured!");
+    else
+	debug("[MPD] error, NOT configured!");
+
+    /* when mpd dies, do NOT exit application, ignore it! */
+    signal(SIGPIPE, SIG_IGN);
+    gettimeofday(&timestamp, NULL);
+
+    AddFunction("mpd::artist", 0, getArtist);
+    AddFunction("mpd::title", 0, getTitle);
+    AddFunction("mpd::album", 0, getAlbum);
+    AddFunction("mpd::file", 0, getFilename);
+    AddFunction("mpd::totalTimeSec", 0, totalTimeSec);
+    AddFunction("mpd::elapsedTimeSec", 0, elapsedTimeSec);
+    AddFunction("mpd::bitRate", 0, bitRate);
+    AddFunction("mpd::getSamplerateHz", 0, getSamplerateHz);
+    AddFunction("mpd::getAudioChannels", 0, getAudioChannels);
+    AddFunction("mpd::getRepeatInt", 0, getRepeatInt);
+    AddFunction("mpd::getRandomInt", 0, getRandomInt);
+    AddFunction("mpd::getStateInt", 0, getStateInt);
+    AddFunction("mpd::getVolume", 0, getVolume);
+    AddFunction("mpd::getSongsInDb", 0, getSongsInDb);
+    AddFunction("mpd::getMpdUptime", 0, getMpdUptime);
+    AddFunction("mpd::getMpdPlayTime", 0, getMpdPlayTime);
+    AddFunction("mpd::getMpdDbPlayTime", 0, getMpdDbPlayTime);
+    AddFunction("mpd::getMpdPlaylistLength", 0, getMpdPlaylistLength);
+    AddFunction("mpd::getMpdPlaylistGetCurrentId", 0, getCurrentSongPos);
+
+    AddFunction("mpd::cmdNextSong", 0, nextSong);
+    AddFunction("mpd::cmdPrevSong", 0, prevSong);
+    AddFunction("mpd::cmdStopSong", 0, stopSong);
+    AddFunction("mpd::cmdTogglePauseSong", 0, pauseSong);
+    AddFunction("mpd::cmdVolUp", 0, volUp);
+    AddFunction("mpd::cmdVolDown", 0, volDown);
+    AddFunction("mpd::cmdToggleRandom", 0, toggleRandom);
+    AddFunction("mpd::cmdToggleRepeat", 0, toggleRepeat);
+
+    AddFunction("mpd::formatTimeMMSS", 1, formatTimeMMSS);
+    AddFunction("mpd::formatTimeDDHHMM", 1, formatTimeDDHHMM);
+
+    return 0;
+}
+
+
+void plugin_exit_mpd(void)
+{
+    if (plugin_enabled == 1) {
+	debug("[MPD] disconnect from mpd");
+	if (currentSong != NULL)
+	    mpd_freeSong(currentSong);
+	mpd_closeConnection(conn);
+    }
+}
diff -urN lcd4linux-0.10.0/plugin_mysql.c lcd4linux-0.11.0-SVN/plugin_mysql.c
--- lcd4linux-0.10.0/plugin_mysql.c	2005-06-06 11:24:07.000000000 +0200
+++ lcd4linux-0.11.0-SVN/plugin_mysql.c	2008-12-31 08:05:54.000000000 +0100
@@ -1,4 +1,5 @@
-/* $Id: plugin_mysql.c,v 1.7 2005/06/06 09:24:07 reinelt Exp $
+/* $Id: plugin_mysql.c 771 2007-02-25 12:27:26Z michael $
+ * $URL: https://ssl.bulix.org/svn/lcd4linux/trunk/plugin_mysql.c $
  *
  * plugin for execute SQL queries into a MySQL DBSM.
  *
@@ -21,29 +22,6 @@
  * along with this program; if not, write to the Free Software
  * Foundation, Inc., 675 Mass Ave, Cambridge, MA 02139, USA.
  *
- *
- * $Log: plugin_mysql.c,v $
- * Revision 1.7  2005/06/06 09:24:07  reinelt
- * two bugs in plugin_mysql.c fixed
- *
- * Revision 1.6  2005/05/08 04:32:44  reinelt
- * CodingStyle added and applied
- *
- * Revision 1.5  2005/04/01 05:16:04  reinelt
- * moved plugin init stuff to a seperate function called on first use
- *
- * Revision 1.4  2005/01/18 06:30:23  reinelt
- * added (C) to all copyright statements
- *
- * Revision 1.3  2004/03/21 22:05:53  reinelt
- * MySQL plugin fixes from Javi
- *
- * Revision 1.2  2004/03/20 23:09:01  reinelt
- * MySQL plugin fixes from Javi
- *
- * Revision 1.1  2004/03/10 07:16:15  reinelt
- * MySQL plugin from Javier added
- *
  */
 
 /* DOC:
@@ -95,7 +73,7 @@
     static int configured = 0;
 
     char server[256];
-    unsigned int port;
+    int port;
     char user[128];
     char password[256];
     char database[256];
@@ -156,8 +134,7 @@
     return configured;
 }
 
-
-static void my_MySQLquery(RESULT * result, RESULT * query)
+static void my_MySQLcount(RESULT * result, RESULT * query)
 {
     char *q;
     double value;
@@ -190,6 +167,40 @@
 }
 
 
+static void my_MySQLquery(RESULT * result, RESULT * query)
+{
+    char *q;
+    double value;
+    MYSQL_RES *res;
+    MYSQL_ROW row = NULL;
+
+    if (configure_mysql() < 0) {
+	value = -1;
+	SetResult(&result, R_NUMBER, &value);
+	return;
+    }
+
+    q = R2S(query);
+
+    /* mysql_ping(MYSQL *mysql) checks whether the connection to the server is working. */
+    /* If it has gone down, an automatic reconnection is attempted. */
+    mysql_ping(&conex);
+    if (mysql_real_query(&conex, q, (unsigned int) strlen(q))) {
+	error("[MySQL] query error: %s", mysql_error(&conex));
+	value = -1;
+    } else {
+	/* We don't use res=mysql_use_result();  because mysql_num_rows() will not */
+	/* return the correct value until all the rows in the result set have been retrieved */
+	/* with mysql_fetch_row(), so we use res=mysql_store_result(); instead */
+	res = mysql_store_result(&conex);
+	row = mysql_fetch_row(res);
+	mysql_free_result(res);
+    }
+
+    SetResult(&result, R_STRING, row[0]);
+}
+
+
 static void my_MySQLstatus(RESULT * result)
 {
     const char *value = "";
@@ -217,6 +228,7 @@
 int plugin_init_mysql(void)
 {
 #ifdef HAVE_MYSQL_MYSQL_H
+    AddFunction("MySQL::count", 1, my_MySQLcount);
     AddFunction("MySQL::query", 1, my_MySQLquery);
     AddFunction("MySQL::status", 0, my_MySQLstatus);
 #endif
diff -urN lcd4linux-0.10.0/plugin_netdev.c lcd4linux-0.11.0-SVN/plugin_netdev.c
--- lcd4linux-0.10.0/plugin_netdev.c	2005-05-08 06:32:44.000000000 +0200
+++ lcd4linux-0.11.0-SVN/plugin_netdev.c	2008-12-31 08:05:54.000000000 +0100
@@ -1,8 +1,9 @@
-/* $Id: plugin_netdev.c,v 1.14 2005/05/08 04:32:44 reinelt Exp $
+/* $Id: plugin_netdev.c 840 2007-09-09 12:17:42Z michael $
+ * $URL: https://ssl.bulix.org/svn/lcd4linux/trunk/plugin_netdev.c $
  *
  * plugin for /proc/net/dev parsing
  *
- * Copyright (C) 2003 Michael Reinelt <reinelt@eunet.at>
+ * Copyright (C) 2003 Michael Reinelt <michael@reinelt.co.at>
  * Copyright (C) 2004 The LCD4Linux Team <lcd4linux-devel@users.sourceforge.net>
  *
  * This file is part of LCD4Linux.
@@ -21,67 +22,6 @@
  * along with this program; if not, write to the Free Software
  * Foundation, Inc., 675 Mass Ave, Cambridge, MA 02139, USA.
  *
- *
- * $Log: plugin_netdev.c,v $
- * Revision 1.14  2005/05/08 04:32:44  reinelt
- * CodingStyle added and applied
- *
- * Revision 1.13  2005/01/18 06:30:23  reinelt
- * added (C) to all copyright statements
- *
- * Revision 1.12  2004/06/26 12:05:00  reinelt
- *
- * uh-oh... the last CVS log message messed up things a lot...
- *
- * Revision 1.11  2004/06/26 09:27:21  reinelt
- *
- * added '-W' to CFLAGS
- * changed all C++ comments to C ones
- * cleaned up a lot of signed/unsigned mistakes
- *
- * Revision 1.10  2004/06/17 10:58:58  reinelt
- *
- * changed plugin_netdev to use the new fast hash model
- *
- * Revision 1.9  2004/06/17 06:23:43  reinelt
- *
- * hash handling rewritten to solve performance issues
- *
- * Revision 1.8  2004/05/27 03:39:47  reinelt
- *
- * changed function naming scheme to plugin::function
- *
- * Revision 1.7  2004/03/11 06:39:59  reinelt
- * big patch from Martin:
- * - reuse filehandles
- * - memory leaks fixed
- * - earlier busy-flag checking with HD44780
- * - reuse memory for strings in RESULT and hash
- * - netdev_fast to wavid time-consuming regex
- *
- * Revision 1.6  2004/03/03 04:44:16  reinelt
- * changes (cosmetics?) to the big patch from Martin
- * hash patch un-applied
- *
- * Revision 1.5  2004/03/03 03:47:04  reinelt
- * big patch from Martin Hejl:
- * - use qprintf() where appropriate
- * - save CPU cycles on gettimeofday()
- * - add quit() functions to free allocated memory
- * - fixed lots of memory leaks
- *
- * Revision 1.4  2004/02/15 07:23:04  reinelt
- * bug in netdev parsing fixed
- *
- * Revision 1.3  2004/02/01 19:37:40  reinelt
- * got rid of every strtok() incarnation.
- *
- * Revision 1.2  2004/01/29 04:40:02  reinelt
- * every .c file includes "config.h" now
- *
- * Revision 1.1  2004/01/25 05:30:09  reinelt
- * plugin_netdev for parsing /proc/net/dev added
- *
  */
 
 /* 
diff -urN lcd4linux-0.10.0/plugin_netinfo.c lcd4linux-0.11.0-SVN/plugin_netinfo.c
--- lcd4linux-0.10.0/plugin_netinfo.c	1970-01-01 01:00:00.000000000 +0100
+++ lcd4linux-0.11.0-SVN/plugin_netinfo.c	2008-12-31 08:06:27.000000000 +0100
@@ -0,0 +1,272 @@
+/* $Id: $
+ * $URL: $
+ *
+ * plugin getting information about network devices (IPaddress, MACaddress, ...)
+ *
+ * Copyright (C) 2007 Volker Gering <v.gering@t-online.de>
+ * Copyright (C) 2004, 2005, 2006, 2007 The LCD4Linux Team <lcd4linux-devel@users.sourceforge.net>
+ *
+ * This file is part of LCD4Linux.
+ *
+ * LCD4Linux is free software; you can redistribute it and/or modify
+ * it under the terms of the GNU General Public License as published by
+ * the Free Software Foundation; either version 2, or (at your option)
+ * any later version.
+ *
+ * LCD4Linux is distributed in the hope that it will be useful,
+ * but WITHOUT ANY WARRANTY; without even the implied warranty of
+ * MERCHANTABILITY or FITNESS FOR A PARTICULAR PURPOSE.  See the
+ * GNU General Public License for more details.
+ *
+ * You should have received a copy of the GNU General Public License
+ * along with this program; if not, write to the Free Software
+ * Foundation, Inc., 675 Mass Ave, Cambridge, MA 02139, USA.
+ *
+ */
+
+/* 
+ * exported functions:
+ *
+ * int plugin_init_netinfo (void)
+ *  adds functions to get information about network devices
+ *
+ */
+
+
+#include "config.h"
+
+#include <stdlib.h>
+#include <unistd.h>
+#include <string.h>
+#include <ctype.h>
+
+#include "debug.h"
+#include "plugin.h"
+#include "qprintf.h"
+
+#include <sys/types.h>		/* socket() */
+#include <sys/socket.h>		/* socket() */
+#include <sys/ioctl.h>		/* SIOCGIFNAME */
+#include <net/if.h>		/* ifreq{} */
+#include <errno.h>		/* errno */
+#include <netinet/in.h>		/* inet_ntoa() */
+#include <arpa/inet.h>		/* inet_ntoa() */
+
+
+/* socket descriptor:
+ * -2   initial state
+ * -1   error: message not printed
+ * -3   error: message printed, deactivate plugin
+ */
+static int socknr = -2;
+
+static int open_net(void)
+{
+
+    if (socknr == -3)
+	return -1;
+    if (socknr == -2) {
+	socknr = socket(PF_INET, SOCK_DGRAM, 0);
+    }
+    if (socknr == -1) {
+	error("%s: socket(PF_INET, SOCK_DGRAM, 0) failed: %s", "plugin_netinfo", strerror(errno));
+	error("  deactivate plugin netinfo");
+	socknr = -3;
+	return -1;
+    }
+
+    return 0;
+}
+
+
+static void my_exists(RESULT * result, RESULT * arg1)
+{
+    char buf[10240];
+    struct ifconf ifcnf;
+    struct ifreq *ifreq;
+    int len;
+    double value = 0.0;		// netdev doesn't exists
+    char devname[80];
+
+    if (socknr < 0) {
+	/* no open socket */
+	SetResult(&result, R_NUMBER, &value);
+	return;
+    }
+
+    ifcnf.ifc_len = sizeof(buf);
+    ifcnf.ifc_buf = buf;
+    if (ioctl(socknr, SIOCGIFCONF, &ifcnf) < 0) {
+	/* error getting list of devices */
+	error("%s: ioctl(IFCONF) for %s failed: %s", "plugin_netinfo", R2S(arg1), strerror(errno));
+	SetResult(&result, R_NUMBER, &value);
+	return;
+    }
+    if (0 == ifcnf.ifc_len) {
+	/* no interfaces found */
+	SetResult(&result, R_NUMBER, &value);
+	return;
+    }
+
+    ifreq = (struct ifreq *) buf;
+    len = sizeof(struct ifreq);
+    strncpy(devname, R2S(arg1), sizeof(devname));
+
+    while (ifreq && *((char *) ifreq) && ((char *) ifreq) < buf + ifcnf.ifc_len) {
+	if (*((char *) ifreq) && strncmp(ifreq->ifr_name, devname, sizeof(devname)) == 0) {
+	    /* found */
+	    value = 1.0;
+	    SetResult(&result, R_NUMBER, &value);
+	    return;
+	}
+
+	(*(char **) &ifreq) += len;
+    }
+
+    /* device doesn't exists */
+    SetResult(&result, R_NUMBER, &value);
+}
+
+
+/* get MAC address (hardware address) of network device */
+static void my_hwaddr(RESULT * result, RESULT * arg1)
+{
+    static int errcount = 0;
+    struct ifreq ifreq;
+    unsigned char *hw;
+    char value[18];
+
+    if (socknr < 0) {
+	/* no open socket */
+	SetResult(&result, R_STRING, "");
+	return;
+    }
+
+    strncpy(ifreq.ifr_name, R2S(arg1), sizeof(ifreq.ifr_name));
+    if (ioctl(socknr, SIOCGIFHWADDR, &ifreq) < 0) {
+	errcount++;
+	if (1 == errcount % 1000) {
+	    error("%s: ioctl(IFHWADDR %s) failed: %s", "plugin_netinfo", ifreq.ifr_name, strerror(errno));
+	    error("  (skip next 1000 errors)");
+	}
+	SetResult(&result, R_STRING, "");
+	return;
+    }
+    hw = (unsigned char *) ifreq.ifr_hwaddr.sa_data;
+    qprintf(value, sizeof(value), "%02x:%02x:%02x:%02x:%02x:%02x",
+	    *hw, *(hw + 1), *(hw + 2), *(hw + 3), *(hw + 4), *(hw + 5));
+
+    SetResult(&result, R_STRING, value);
+}
+
+
+/* get ip address of network device */
+static void my_ipaddr(RESULT * result, RESULT * arg1)
+{
+    static int errcount = 0;
+    struct ifreq ifreq;
+    struct sockaddr_in *sin;
+    char value[16];
+
+    if (socknr < 0) {
+	/* no open socket */
+	SetResult(&result, R_STRING, "");
+	return;
+    }
+
+    strncpy(ifreq.ifr_name, R2S(arg1), sizeof(ifreq.ifr_name));
+    if (ioctl(socknr, SIOCGIFADDR, &ifreq) < 0) {
+	errcount++;
+	if (1 == errcount % 1000) {
+	    error("%s: ioctl(IFADDR %s) failed: %s", "plugin_netinfo", ifreq.ifr_name, strerror(errno));
+	    error("  (skip next 1000 errors)");
+	}
+	SetResult(&result, R_STRING, "");
+	return;
+    }
+    sin = (struct sockaddr_in *) &ifreq.ifr_addr;
+    qprintf(value, sizeof(value), "%s", inet_ntoa(sin->sin_addr));
+
+    SetResult(&result, R_STRING, value);
+}
+
+
+/* get ip netmask of network device */
+static void my_netmask(RESULT * result, RESULT * arg1)
+{
+    static int errcount = 0;
+    struct ifreq ifreq;
+    struct sockaddr_in *sin;
+    char value[16];
+
+    if (socknr < 0) {
+	/* no open socket */
+	SetResult(&result, R_STRING, "");
+	return;
+    }
+
+    strncpy(ifreq.ifr_name, R2S(arg1), sizeof(ifreq.ifr_name));
+    if (ioctl(socknr, SIOCGIFNETMASK, &ifreq) < 0) {
+	errcount++;
+	if (1 == errcount % 1000) {
+	    error("%s: ioctl(IFNETMASK %s) failed: %s", "plugin_netinfo", ifreq.ifr_name, strerror(errno));
+	    error("  (skip next 1000 errors)");
+	}
+	SetResult(&result, R_STRING, "");
+	return;
+    }
+    sin = (struct sockaddr_in *) &ifreq.ifr_netmask;
+    qprintf(value, sizeof(value), "%s", inet_ntoa(sin->sin_addr));
+
+    SetResult(&result, R_STRING, value);
+}
+
+
+/* get ip broadcast address of network device */
+static void my_bcaddr(RESULT * result, RESULT * arg1)
+{
+    static int errcount = 0;
+    struct ifreq ifreq;
+    struct sockaddr_in *sin;
+    char value[16];
+
+    if (socknr < 0) {
+	/* no open socket */
+	SetResult(&result, R_STRING, "");
+	return;
+    }
+
+    strncpy(ifreq.ifr_name, R2S(arg1), sizeof(ifreq.ifr_name));
+    if (ioctl(socknr, SIOCGIFBRDADDR, &ifreq) < 0) {
+	errcount++;
+	if (1 == errcount % 1000) {
+	    error("%s: ioctl(IFBRDADDR %s) failed: %s", "plugin_netinfo", ifreq.ifr_name, strerror(errno));
+	    error("  (skip next 1000 errors)");
+	}
+	SetResult(&result, R_STRING, "");
+	return;
+    }
+    sin = (struct sockaddr_in *) &ifreq.ifr_broadaddr;
+    qprintf(value, sizeof(value), "%s", inet_ntoa(sin->sin_addr));
+
+    SetResult(&result, R_STRING, value);
+}
+
+
+int plugin_init_netinfo(void)
+{
+    open_net();
+
+    AddFunction("netinfo::exists", 1, my_exists);
+    AddFunction("netinfo::hwaddr", 1, my_hwaddr);
+    AddFunction("netinfo::ipaddr", 1, my_ipaddr);
+    AddFunction("netinfo::netmask", 1, my_netmask);
+    AddFunction("netinfo::bcaddr", 1, my_bcaddr);
+
+    return 0;
+}
+
+void plugin_exit_netinfo(void)
+{
+    close(socknr);
+}
diff -urN lcd4linux-0.10.0/plugin_pop3.c lcd4linux-0.11.0-SVN/plugin_pop3.c
--- lcd4linux-0.10.0/plugin_pop3.c	2005-05-08 06:32:44.000000000 +0200
+++ lcd4linux-0.11.0-SVN/plugin_pop3.c	2008-12-31 08:05:54.000000000 +0100
@@ -1,4 +1,5 @@
-/* $Id: plugin_pop3.c,v 1.9 2005/05/08 04:32:44 reinelt Exp $
+/* $Id: plugin_pop3.c 728 2007-01-14 11:14:38Z michael $
+ * $URL: https://ssl.bulix.org/svn/lcd4linux/trunk/plugin_pop3.c $
  *
  * Plugin to check POP3 mail accounts
  *
@@ -25,43 +26,6 @@
  * along with this program; if not, write to the Free Software
  * Foundation, Inc., 675 Mass Ave, Cambridge, MA 02139, USA.
  *
- *
- * $Log: plugin_pop3.c,v $
- * Revision 1.9  2005/05/08 04:32:44  reinelt
- * CodingStyle added and applied
- *
- * Revision 1.8  2005/04/01 05:16:04  reinelt
- * moved plugin init stuff to a seperate function called on first use
- *
- * Revision 1.7  2005/01/18 06:30:23  reinelt
- * added (C) to all copyright statements
- *
- * Revision 1.6  2004/06/26 12:05:00  reinelt
- *
- * uh-oh... the last CVS log message messed up things a lot...
- *
- * Revision 1.5  2004/06/26 09:27:21  reinelt
- *
- * added '-W' to CFLAGS
- * changed all C++ comments to C ones
- * cleaned up a lot of signed/unsigned mistakes
- *
- * Revision 1.4  2004/05/31 21:05:13  reinelt
- *
- * fixed lots of bugs in the Cwlinux driver
- * do not emit EAGAIN error on the first retry
- * made plugin_i2c_sensors a bit less 'chatty'
- * moved init and exit functions to the bottom of plugin_pop3
- *
- * Revision 1.3  2004/05/20 07:14:46  reinelt
- * made all local functions static
- *
- * Revision 1.2  2004/04/17 13:03:34  nicowallmeier
- * minor bugfix
- *
- * Revision 1.1  2004/04/08 11:59:26  reinelt
- * added plugin_pop3 from Javi
- *
  */
 
 
@@ -305,12 +269,14 @@
 		node->username = x;
 		x = cfg_get(Section, password, "");
 		if (*x == '\0') {
-		    info("[POP3] No '%s.%s' entry from %s, disabling POP3 account #%d", Section, password, cfg_source(), i);
+		    info("[POP3] No '%s.%s' entry from %s, disabling POP3 account #%d", Section, password, cfg_source(),
+			 i);
 		    free(x);
 		} else {
 		    node->password = x;
 		    if (cfg_number(Section, port, POP3PORT, 1, 65536, &node->port) < 1) {
-			info("[POP3] No '%s.%s' entry from %s, %d will be used for account #%d", Section, port, cfg_source(), POP3PORT, i);
+			info("[POP3] No '%s.%s' entry from %s, %d will be used for account #%d", Section, port,
+			     cfg_source(), POP3PORT, i);
 		    }
 		    check_node_add(&head, node);
 		    n++;
diff -urN lcd4linux-0.10.0/plugin_ppp.c lcd4linux-0.11.0-SVN/plugin_ppp.c
--- lcd4linux-0.10.0/plugin_ppp.c	2005-05-08 06:32:44.000000000 +0200
+++ lcd4linux-0.11.0-SVN/plugin_ppp.c	2008-12-31 08:05:54.000000000 +0100
@@ -1,8 +1,9 @@
-/* $Id: plugin_ppp.c,v 1.10 2005/05/08 04:32:44 reinelt Exp $
+/* $Id: plugin_ppp.c 840 2007-09-09 12:17:42Z michael $
+ * $URL: https://ssl.bulix.org/svn/lcd4linux/trunk/plugin_ppp.c $
  *
  * plugin for ppp throughput
  *
- * Copyright (C) 2003 Michael Reinelt <reinelt@eunet.at>
+ * Copyright (C) 2003 Michael Reinelt <michael@reinelt.co.at>
  * Copyright (C) 2004 The LCD4Linux Team <lcd4linux-devel@users.sourceforge.net>
  *
  * This file is part of LCD4Linux.
@@ -21,51 +22,6 @@
  * along with this program; if not, write to the Free Software
  * Foundation, Inc., 675 Mass Ave, Cambridge, MA 02139, USA.
  *
- *
- * $Log: plugin_ppp.c,v $
- * Revision 1.10  2005/05/08 04:32:44  reinelt
- * CodingStyle added and applied
- *
- * Revision 1.9  2005/01/18 06:30:23  reinelt
- * added (C) to all copyright statements
- *
- * Revision 1.8  2004/06/26 12:05:00  reinelt
- *
- * uh-oh... the last CVS log message messed up things a lot...
- *
- * Revision 1.7  2004/06/26 09:27:21  reinelt
- *
- * added '-W' to CFLAGS
- * changed all C++ comments to C ones
- * cleaned up a lot of signed/unsigned mistakes
- *
- * Revision 1.6  2004/06/17 06:23:43  reinelt
- *
- * hash handling rewritten to solve performance issues
- *
- * Revision 1.5  2004/05/29 15:53:28  reinelt
- *
- * M50530: reset parport signals on exit
- * plugin_ppp: ppp() has two parameters, not three
- * lcd4linux.conf.sample: diskstats() corrected
- *
- * Revision 1.4  2004/03/03 04:44:16  reinelt
- * changes (cosmetics?) to the big patch from Martin
- * hash patch un-applied
- *
- * Revision 1.3  2004/03/03 03:47:04  reinelt
- * big patch from Martin Hejl:
- * - use qprintf() where appropriate
- * - save CPU cycles on gettimeofday()
- * - add quit() functions to free allocated memory
- * - fixed lots of memory leaks
- *
- * Revision 1.2  2004/01/28 06:43:31  reinelt
- * plugin_ppp finished.
- *
- * Revision 1.1  2004/01/27 08:13:39  reinelt
- * ported PPP token to plugin_ppp
- *
  */
 
 /* 
diff -urN lcd4linux-0.10.0/plugin_proc_stat.c lcd4linux-0.11.0-SVN/plugin_proc_stat.c
--- lcd4linux-0.10.0/plugin_proc_stat.c	2005-05-08 06:32:45.000000000 +0200
+++ lcd4linux-0.11.0-SVN/plugin_proc_stat.c	2008-12-31 08:05:54.000000000 +0100
@@ -1,8 +1,9 @@
-/* $Id: plugin_proc_stat.c,v 1.26 2005/05/08 04:32:45 reinelt Exp $
+/* $Id: plugin_proc_stat.c 840 2007-09-09 12:17:42Z michael $
+ * $URL: https://ssl.bulix.org/svn/lcd4linux/trunk/plugin_proc_stat.c $
  *
  * plugin for /proc/stat parsing
  *
- * Copyright (C) 2003 Michael Reinelt <reinelt@eunet.at>
+ * Copyright (C) 2003 Michael Reinelt <michael@reinelt.co.at>
  * Copyright (C) 2004 The LCD4Linux Team <lcd4linux-devel@users.sourceforge.net>
  *
  * This file is part of LCD4Linux.
@@ -21,110 +22,6 @@
  * along with this program; if not, write to the Free Software
  * Foundation, Inc., 675 Mass Ave, Cambridge, MA 02139, USA.
  *
- *
- * $Log: plugin_proc_stat.c,v $
- * Revision 1.26  2005/05/08 04:32:45  reinelt
- * CodingStyle added and applied
- *
- * Revision 1.25  2005/01/18 06:30:23  reinelt
- * added (C) to all copyright statements
- *
- * Revision 1.24  2005/01/11 10:19:33  reinelt
- * changes to lcd4linux.conf.sample
- *
- * Revision 1.23  2004/06/26 12:05:00  reinelt
- *
- * uh-oh... the last CVS log message messed up things a lot...
- *
- * Revision 1.22  2004/06/26 09:27:21  reinelt
- *
- * added '-W' to CFLAGS
- * changed all C++ comments to C ones
- * cleaned up a lot of signed/unsigned mistakes
- *
- * Revision 1.21  2004/06/20 10:09:56  reinelt
- *
- * 'const'ified the whole source
- *
- * Revision 1.20  2004/06/17 06:23:43  reinelt
- *
- * hash handling rewritten to solve performance issues
- *
- * Revision 1.19  2004/05/27 03:39:47  reinelt
- *
- * changed function naming scheme to plugin::function
- *
- * Revision 1.18  2004/03/11 06:39:59  reinelt
- * big patch from Martin:
- * - reuse filehandles
- * - memory leaks fixed
- * - earlier busy-flag checking with HD44780
- * - reuse memory for strings in RESULT and hash
- * - netdev_fast to wavid time-consuming regex
- *
- * Revision 1.17  2004/03/03 04:44:16  reinelt
- * changes (cosmetics?) to the big patch from Martin
- * hash patch un-applied
- *
- * Revision 1.16  2004/03/03 03:47:04  reinelt
- * big patch from Martin Hejl:
- * - use qprintf() where appropriate
- * - save CPU cycles on gettimeofday()
- * - add quit() functions to free allocated memory
- * - fixed lots of memory leaks
- *
- * Revision 1.15  2004/02/04 19:10:51  reinelt
- * Crystalfontz driver nearly finished
- *
- * Revision 1.14  2004/02/01 19:37:40  reinelt
- * got rid of every strtok() incarnation.
- *
- * Revision 1.13  2004/01/29 04:40:02  reinelt
- * every .c file includes "config.h" now
- *
- * Revision 1.12  2004/01/27 08:13:39  reinelt
- * ported PPP token to plugin_ppp
- *
- * Revision 1.11  2004/01/25 05:30:09  reinelt
- * plugin_netdev for parsing /proc/net/dev added
- *
- * Revision 1.10  2004/01/22 08:55:30  reinelt
- * fixed unhandled kernel-2.6 entries in /prco/stat
- *
- * Revision 1.9  2004/01/21 14:29:03  reinelt
- * new helper 'hash_get_regex' which delivers the sum over regex matched items
- * new function 'disk()' which uses this regex matching
- *
- * Revision 1.8  2004/01/21 11:31:23  reinelt
- * two bugs with hash_age() ixed
- *
- * Revision 1.7  2004/01/21 10:48:17  reinelt
- * hash_age function added
- *
- * Revision 1.6  2004/01/20 12:45:47  reinelt
- * "Default screen" working with MatrixOrbital
- *
- * Revision 1.5  2004/01/18 09:01:45  reinelt
- * /proc/stat parsing finished
- *
- * Revision 1.4  2004/01/18 06:54:08  reinelt
- * bug in expr.c fixed (thanks to Xavier)
- * some progress with /proc/stat parsing
- *
- * Revision 1.3  2004/01/16 11:12:26  reinelt
- * some bugs in plugin_xmms fixed, parsing moved to own function
- * plugin_proc_stat nearly finished
- *
- * Revision 1.2  2004/01/16 07:26:25  reinelt
- * moved various /proc parsing to own functions
- * made some progress with /proc/stat parsing
- *
- * Revision 1.1  2004/01/16 05:04:53  reinelt
- * started plugin proc_stat which should parse /proc/stat
- * which again is a paint in the a**
- * thinking over implementation methods of delta functions
- * (CPU load, ...)
- *
  */
 
 /* 
@@ -202,7 +99,7 @@
 	    break;
 
 	if (strncmp(buffer, "cpu", 3) == 0) {
-	    char *key[] = { "user", "nice", "system", "idle" };
+	    char *key[] = { "user", "nice", "system", "idle", "iow", "irq", "sirq" };
 	    char delim[] = " \t\n";
 	    char *cpu, *beg, *end;
 	    int i;
@@ -214,7 +111,7 @@
 		*end = '\0';
 	    beg = end ? end + 1 : NULL;
 
-	    for (i = 0; i < 4 && beg != NULL; i++) {
+	    for (i = 0; i < 7 && beg != NULL; i++) {
 		while (strchr(delim, *beg))
 		    beg++;
 		if ((end = strpbrk(beg, delim)))
@@ -355,6 +252,7 @@
     int delay;
     double value;
     double cpu_user, cpu_nice, cpu_system, cpu_idle, cpu_total;
+    double cpu_iow, cpu_irq, cpu_sirq;
 
     if (parse_proc_stat() < 0) {
 	SetResult(&result, R_STRING, "");
@@ -369,7 +267,14 @@
     cpu_system = hash_get_delta(&Stat, "cpu.system", NULL, delay);
     cpu_idle = hash_get_delta(&Stat, "cpu.idle", NULL, delay);
 
-    cpu_total = cpu_user + cpu_nice + cpu_system + cpu_idle;
+    /* new fields for kernel 2.6 */
+    /* even if we dont have this param (ie kernel 2.4) */
+    /* the return is 0.0 and not change the results */
+    cpu_iow = hash_get_delta(&Stat, "cpu.iow", NULL, delay);
+    cpu_irq = hash_get_delta(&Stat, "cpu.irq", NULL, delay);
+    cpu_sirq = hash_get_delta(&Stat, "cpu.sirq", NULL, delay);
+
+    cpu_total = cpu_user + cpu_nice + cpu_system + cpu_idle + cpu_iow + cpu_irq + cpu_sirq;
 
     if (strcasecmp(key, "user") == 0)
 	value = cpu_user;
@@ -379,6 +284,12 @@
 	value = cpu_system;
     else if (strcasecmp(key, "idle") == 0)
 	value = cpu_idle;
+    else if (strcasecmp(key, "iowait") == 0)
+	value = cpu_iow;
+    else if (strcasecmp(key, "irq") == 0)
+	value = cpu_irq;
+    else if (strcasecmp(key, "softirq") == 0)
+	value = cpu_sirq;
     else if (strcasecmp(key, "busy") == 0)
 	value = cpu_total - cpu_idle;
 
diff -urN lcd4linux-0.10.0/plugin_python.c lcd4linux-0.11.0-SVN/plugin_python.c
--- lcd4linux-0.10.0/plugin_python.c	2005-05-08 06:32:45.000000000 +0200
+++ lcd4linux-0.11.0-SVN/plugin_python.c	2008-12-31 08:05:54.000000000 +0100
@@ -1,4 +1,5 @@
-/* $Id: plugin_python.c,v 1.4 2005/05/08 04:32:45 reinelt Exp $
+/* $Id: plugin_python.c 728 2007-01-14 11:14:38Z michael $
+ * $URL: https://ssl.bulix.org/svn/lcd4linux/trunk/plugin_python.c $
  *
  * Python plugin
  *
@@ -21,27 +22,6 @@
  * along with this program; if not, write to the Free Software
  * Foundation, Inc., 675 Mass Ave, Cambridge, MA 02139, USA.
  *
- *
- * $Log: plugin_python.c,v $
- * Revision 1.4  2005/05/08 04:32:45  reinelt
- * CodingStyle added and applied
- *
- * Revision 1.3  2005/05/04 05:22:12  reinelt
- * * replaced fprintf(stderr,...  with error()
- * * corrected a "dangling reference" memory problem
- * * removed some PyErr_Print() spam
- * * fixed a segmentation fault that occured when python module was not
- * found
- * * improved error messages
- *
- * Revision 1.2  2005/05/03 11:13:24  reinelt
- * rearranged autoconf a bit,
- * libX11 will be linked only if really needed (i.e. when the X11 driver has been selected)
- * plugin_python filled with life
- *
- * Revision 1.1  2005/05/02 10:29:20  reinelt
- * preparations for python bindings and python plugin
- *
  */
 
 /* 
diff -urN lcd4linux-0.10.0/plugin_sample.c lcd4linux-0.11.0-SVN/plugin_sample.c
--- lcd4linux-0.10.0/plugin_sample.c	2005-05-08 06:32:45.000000000 +0200
+++ lcd4linux-0.11.0-SVN/plugin_sample.c	2008-12-31 08:05:54.000000000 +0100
@@ -1,9 +1,10 @@
-/* $Id: plugin_sample.c,v 1.10 2005/05/08 04:32:45 reinelt Exp $
+/* $Id: plugin_sample.c 870 2008-04-10 14:55:23Z michux $
+ * $URL: https://ssl.bulix.org/svn/lcd4linux/trunk/plugin_sample.c $
  *
  * plugin template
  *
- * Copyright (C) 2003 Michael Reinelt <reinelt@eunet.at>
- * Copyright (C) 2004 The LCD4Linux Team <lcd4linux-devel@users.sourceforge.net>
+ * Copyright (C) 2003 Michael Reinelt <michael@reinelt.co.at>
+ * Copyright (C) 2004, 2005, 2006, 2007, 2008 The LCD4Linux Team <lcd4linux-devel@users.sourceforge.net>
  *
  * This file is part of LCD4Linux.
  *
@@ -21,51 +22,6 @@
  * along with this program; if not, write to the Free Software
  * Foundation, Inc., 675 Mass Ave, Cambridge, MA 02139, USA.
  *
- *
- * $Log: plugin_sample.c,v $
- * Revision 1.10  2005/05/08 04:32:45  reinelt
- * CodingStyle added and applied
- *
- * Revision 1.9  2005/01/18 06:30:23  reinelt
- * added (C) to all copyright statements
- *
- * Revision 1.8  2004/06/26 12:05:00  reinelt
- *
- * uh-oh... the last CVS log message messed up things a lot...
- *
- * Revision 1.7  2004/06/26 09:27:21  reinelt
- *
- * added '-W' to CFLAGS
- * changed all C++ comments to C ones
- * cleaned up a lot of signed/unsigned mistakes
- *
- * Revision 1.6  2004/06/01 06:04:25  reinelt
- *
- * made README.Plugins and plugin_sample up to date.
- *
- * Revision 1.5  2004/03/03 03:47:04  reinelt
- * big patch from Martin Hejl:
- * - use qprintf() where appropriate
- * - save CPU cycles on gettimeofday()
- * - add quit() functions to free allocated memory
- * - fixed lots of memory leaks
- *
- * Revision 1.4  2004/01/30 20:57:56  reinelt
- * HD44780 patch from Martin Hejl
- * dmalloc integrated
- *
- * Revision 1.3  2004/01/29 04:40:02  reinelt
- * every .c file includes "config.h" now
- *
- * Revision 1.2  2004/01/13 10:03:01  reinelt
- * new util 'hash' for associative arrays
- * new plugin 'cpuinfo'
- *
- * Revision 1.1  2004/01/06 17:33:45  reinelt
- *
- * Evaluator: functions with variable argument lists
- * Evaluator: plugin_sample.c and README.Plugins added
- *
  */
 
 /* 
@@ -246,13 +202,13 @@
     /* register all our cool functions */
     /* the second parameter is the number of arguments */
     /* -1 stands for variable argument list */
-    AddFunction("mul2", 1, my_mul2);
-    AddFunction("mul3", 1, my_mul3);
-    AddFunction("answer", 0, my_answer);
-    AddFunction("diff", 2, my_diff);
-    AddFunction("length", 1, my_length);
-    AddFunction("upcase", 1, my_upcase);
-    AddFunction("concat", -1, my_concat);
+    AddFunction("sample::mul2", 1, my_mul2);
+    AddFunction("sample::mul3", 1, my_mul3);
+    AddFunction("sample::answer", 0, my_answer);
+    AddFunction("sample::diff", 2, my_diff);
+    AddFunction("sample::length", 1, my_length);
+    AddFunction("sample::upcase", 1, my_upcase);
+    AddFunction("sample::concat", -1, my_concat);
 
     return 0;
 }
diff -urN lcd4linux-0.10.0/plugin_seti.c lcd4linux-0.11.0-SVN/plugin_seti.c
--- lcd4linux-0.10.0/plugin_seti.c	2005-05-08 06:32:45.000000000 +0200
+++ lcd4linux-0.11.0-SVN/plugin_seti.c	2008-12-31 08:05:54.000000000 +0100
@@ -1,8 +1,9 @@
-/* $Id: plugin_seti.c,v 1.7 2005/05/08 04:32:45 reinelt Exp $
+/* $Id: plugin_seti.c 840 2007-09-09 12:17:42Z michael $
+ * $URL: https://ssl.bulix.org/svn/lcd4linux/trunk/plugin_seti.c $
  *
  * plugin for seti@home status reporting
  *
- * Copyright (C) 2004 Michael Reinelt <reinelt@eunet.at>
+ * Copyright (C) 2004 Michael Reinelt <michael@reinelt.co.at>
  * Copyright (C) 2004 The LCD4Linux Team <lcd4linux-devel@users.sourceforge.net>
  *
  * based on the old seti client which is 
@@ -25,34 +26,6 @@
  * along with this program; if not, write to the Free Software
  * Foundation, Inc., 675 Mass Ave, Cambridge, MA 02139, USA.
  *
- *
- * $Log: plugin_seti.c,v $
- * Revision 1.7  2005/05/08 04:32:45  reinelt
- * CodingStyle added and applied
- *
- * Revision 1.6  2005/01/18 06:30:23  reinelt
- * added (C) to all copyright statements
- *
- * Revision 1.5  2004/06/26 12:05:00  reinelt
- *
- * uh-oh... the last CVS log message messed up things a lot...
- *
- * Revision 1.4  2004/06/26 09:27:21  reinelt
- *
- * added '-W' to CFLAGS
- * changed all C++ comments to C ones
- * cleaned up a lot of signed/unsigned mistakes
- *
- * Revision 1.3  2004/06/17 06:23:43  reinelt
- *
- * hash handling rewritten to solve performance issues
- *
- * Revision 1.2  2004/03/13 19:06:01  reinelt
- * ChangeLog and Status update; small glitch in plugin_seti fixed.
- *
- * Revision 1.1  2004/03/13 06:49:20  reinelt
- * seti@home plugin ported to NextGeneration
- *
  */
 
 /* 
diff -urN lcd4linux-0.10.0/plugins.m4 lcd4linux-0.11.0-SVN/plugins.m4
--- lcd4linux-0.10.0/plugins.m4	1970-01-01 01:00:00.000000000 +0100
+++ lcd4linux-0.11.0-SVN/plugins.m4	2009-01-13 05:54:45.000000000 +0100
@@ -0,0 +1,498 @@
+dnl $Id: plugins.m4 957 2009-01-13 04:02:35Z michael $
+dnl $URL: https://ssl.bulix.org/svn/lcd4linux/trunk/plugins.m4 $
+
+
+dnl LCD4Linux Plugins conf part
+dnl
+dnl Copyright (C) 1999, 2000, 2001, 2002, 2003 Michael Reinelt <michael@reinelt.co.at>
+dnl Copyright (C) 2004, 2005, 2006, 2007 The LCD4Linux Team <lcd4linux-devel@users.sourceforge.net>
+dnl
+dnl This file is part of LCD4Linux.
+dnl
+dnl LCD4Linux is free software; you can redistribute it and/or modify
+dnl it under the terms of the GNU General Public License as published by
+dnl the Free Software Foundation; either version 2, or (at your option)
+dnl any later version.
+dnl
+dnl LCD4Linux is distributed in the hope that it will be useful,
+dnl but WITHOUT ANY WARRANTY; without even the implied warranty of
+dnl MERCHANTABILITY or FITNESS FOR A PARTICULAR PURPOSE.  See the
+dnl GNU General Public License for more details.
+dnl
+dnl You should have received a copy of the GNU General Public License
+dnl along with this program; if not, write to the Free Software
+dnl Foundation, Inc., 675 Mass Ave, Cambridge, MA 02139, USA.
+
+AC_MSG_CHECKING([which plugins to compile])
+AC_ARG_WITH(
+  plugins, 
+  [  --with-plugins=<list>   choose which plugins to compile.]
+  [                        type --with-plugins=list for a list]	
+  [                        of avaible plugins]
+  [                        plugins may be excluded with 'all,!<plugin>',]	
+  [                        (try 'all,\!<plugin>' if your shell complains...)],
+  plugins=$withval, 
+  plugins=all
+)
+
+plugins=`echo $plugins|sed 's/,/ /g'`
+
+for plugin in $plugins; do
+
+   case $plugin in 
+      !*) 
+         val="no"
+         plugin=`echo $plugin|cut -c 2-`
+         ;;
+       *) 
+         val="yes"
+         ;;
+   esac
+	
+   case "$plugin" in
+      list)
+         AC_MSG_RESULT(
+            [available plugins:]
+            [ apm,cpuinfo,diskstats,dvb,exec,file,gps,i2c_sensors,iconv,imon,isdn,kvv,]
+            [ loadavg,meminfo,mpd,mysql,netdev,netinfo,pop3,ppp,proc_stat,sample,seti,]
+            [ statfs,uname,uptime,wireless,xmms])
+         AC_MSG_ERROR([run ./configure --with-plugins=...])
+         ;;
+      all)
+         PLUGIN_APM="yes"
+	 PLUGIN_ASTERISK="yes"
+	 PLUGIN_BUTTON_EXEC="yes"
+         PLUGIN_CPUINFO="yes"
+         PLUGIN_DISKSTATS="yes"
+         PLUGIN_DVB="yes"
+         PLUGIN_EXEC="yes"
+         PLUGIN_FIFO="yes"
+         PLUGIN_FILE="yes"
+         PLUGIN_GPS="yes"
+         PLUGIN_HDDTEMP="yes"
+         PLUGIN_I2C_SENSORS="yes"
+         PLUGIN_ICONV="yes"
+         PLUGIN_IMON="yes"
+         PLUGIN_ISDN="yes"
+         PLUGIN_KVV="yes"
+         PLUGIN_LOADAVG="yes"
+         PLUGIN_MEMINFO="yes"
+         PLUGIN_MPD="yes"
+         PLUGIN_MYSQL="yes"
+         PLUGIN_NETDEV="yes"
+         PLUGIN_NETINFO="yes"
+         PLUGIN_POP3="yes"
+         PLUGIN_PPP="yes"
+         PLUGIN_PROC_STAT="yes"
+         PLUGIN_PYTHON=$with_python
+         PLUGIN_SAMPLE="yes"
+         PLUGIN_SETI="yes"
+         PLUGIN_STATFS="yes"
+         PLUGIN_UNAME="yes"
+         PLUGIN_UPTIME="yes"
+         PLUGIN_W1RETAP="yes"    	 
+         PLUGIN_WIRELESS="yes"
+         PLUGIN_XMMS="yes"   
+         ;;
+      apm)
+         PLUGIN_APM=$val
+         ;;
+      button_exec)
+	 PLUGIN_BUTTON_EXEC=$val
+	 ;;
+      asterisk)
+         PLUGIN_ASTERISK=$val
+         ;;
+      cpuinfo)
+         PLUGIN_CPUINFO=$val
+         ;;
+      diskstats)
+         PLUGIN_DISKSTATS=$val
+         ;;
+      dvb)
+         PLUGIN_DVB=$val
+         ;;
+      exec)
+         PLUGIN_EXEC=$val
+         ;;
+      fifo)
+         PLUGIN_FIFO=$val
+         ;;
+      file)
+         PLUGIN_FILE=$val
+         ;;
+      gps)
+         PLUGIN_GPS=$val
+         ;;
+      hddtemp)
+         PLUGIN_HDDTEMP=$val
+         ;;
+      i2c_sensors)
+         PLUGIN_I2C_SENSORS=$val
+	 ;;
+      iconv)
+      	PLUGIN_ICONV=$val
+      	;;
+      imon)
+         PLUGIN_IMON=$val
+         ;;
+      isdn)
+         PLUGIN_ISDN=$val
+         ;;
+      kvv)
+         PLUGIN_KVV=$val
+         ;;
+      loadavg)
+         PLUGIN_LOADAVG=$val
+         ;;
+      meminfo)
+         PLUGIN_MEMINFO=$val
+         ;;
+      mpd)
+         PLUGIN_MPD=$val
+	 ;;
+      mysql)
+         PLUGIN_MYSQL=$val
+         ;;
+      netdev)
+         PLUGIN_NETDEV=$val
+         ;;
+      netinfo)
+         PLUGIN_NETINFO=$val
+         ;;
+      pop3)
+         PLUGIN_POP3=$val
+         ;;
+      ppp)
+         PLUGIN_PPP=$val
+         ;;
+      proc_stat)
+         PLUGIN_PROC_STAT=$val
+         ;;
+      python)
+         PLUGIN_PYTHON=$val
+         ;;
+      sample)
+         PLUGIN_SAMPLE=$val
+         ;;
+      seti)
+         PLUGIN_SETI=$val
+         ;;
+      statfs)
+         PLUGIN_STATFS=$val
+         ;;
+      uname)
+         PLUGIN_UNAME=$val
+         ;;
+      uptime)
+         PLUGIN_UPTIME=$val
+         ;;
+      w1retap)
+         PLUGIN_W1RETAP=$val
+         ;;
+      wireless)
+         PLUGIN_WIRELESS=$val
+         ;;
+      xmms)
+         PLUGIN_XMMS=$val
+         ;;         
+      *) 	
+         AC_MSG_ERROR([Unknown plugin '$plugin'])
+         ;;
+   esac
+done
+
+AC_MSG_RESULT([done])
+
+# Advanced Power Management
+if test "$PLUGIN_APM" = "yes"; then
+   AC_CHECK_HEADERS(asm/types.h, [has_asm_types="true"], [has_asm_types="false"])
+   if test "$has_asm_types" = "true"; then
+      PLUGINS="$PLUGINS plugin_apm.o"
+      AC_DEFINE(PLUGIN_APM,1,[apm plugin])
+   else
+      AC_MSG_WARN(asm/types.h header not found: apm plugin disabled)
+   fi
+fi
+
+if test "$PLUGIN_BUTTON_EXEC" = "yes"; then
+   PLUGINS="$PLUGINS plugin_button_exec.o"
+   AC_DEFINE(PLUGIN_BUTTON_EXEC,1,[button_exec plugin])
+fi
+
+if test "$PLUGIN_ASTERISK" = "yes"; then
+   PLUGINS="$PLUGINS plugin_asterisk.o"
+   AC_DEFINE(PLUGIN_ASTERISK,1,[asterisk plugin])
+fi
+
+# /proc/cpuinfo
+if test "$PLUGIN_CPUINFO" = "yes"; then
+   PLUGINS="$PLUGINS plugin_cpuinfo.o"
+   AC_DEFINE(PLUGIN_CPUINFO,1,[cpuinfo plugin])
+fi
+
+# /proc/diskstat
+if test "$PLUGIN_DISKSTATS" = "yes"; then
+   PLUGINS="$PLUGINS plugin_diskstats.o"
+   AC_DEFINE(PLUGIN_DISKSTATS,1,[diskstats plugin])
+fi
+
+# Digital Video Broadcasting
+if test "$PLUGIN_DVB" = "yes"; then
+   AC_CHECK_HEADERS(asm/types.h, [has_asm_types="true"], [has_asm_types="false"])
+   if test "$has_asm_types" = "true"; then
+       AC_CHECK_HEADERS(linux/dvb/frontend.h, [has_dvb_header="true"], [has_dvb_header="false"])
+       if test "$has_dvb_header" = "true"; then
+          PLUGINS="$PLUGINS plugin_dvb.o"
+          AC_DEFINE(PLUGIN_DVB,1,[dvb plugin])
+       else
+          PLUGINS="$PLUGINS plugin_dvb.o"
+          AC_MSG_WARN(linux/dvb/frontend.h header not found: using ioctl)
+       fi
+   else
+       AC_MSG_WARN(asm/types.h header not found: dvb plugin disabled)
+   fi
+fi
+
+# start external commands (exec)
+if test "$PLUGIN_EXEC" = "yes"; then
+   PLUGINS="$PLUGINS plugin_exec.o"
+   AC_DEFINE(PLUGIN_EXEC,1,[exec plugin])
+fi
+
+# file
+if test "$PLUGIN_FILE" = "yes"; then
+   PLUGINS="$PLUGINS plugin_file.o"
+   AC_DEFINE(PLUGIN_FILE,1,[file plugin])
+fi
+
+# FIFO
+if test "$PLUGIN_FIFO" = "yes"; then
+   PLUGINS="$PLUGINS plugin_fifo.o"
+   AC_DEFINE(PLUGIN_FIFO,1,[fifo plugin])
+fi
+
+# GPS
+if test "$PLUGIN_GPS" = "yes"; then
+   AC_CHECK_HEADERS(nmeap.h, [has_nmeap_header="true"], [has_nmeap_header="false"])
+   if test "$has_nmeap_header" = "true"; then	
+      AC_CHECK_LIB(nmeap, nmeap_init, [has_libnmeap_lib="true"], [has_libnmeap_lib="false"])
+      if test "$has_libnmeap_lib" = "true"; then
+        PLUGINS="$PLUGINS plugin_gps.o"
+        PLUGINLIBS="$PLUGINLIBS -lnmeap"
+        AC_DEFINE(PLUGIN_GPS,1,[gps plugin])
+      else
+        AC_MSG_WARN(libnmeap lib not found: gps plugin disabled)
+      fi
+   else
+      AC_MSG_WARN(nmeap.h header not found: gps plugin disabled)
+   fi 
+fi
+
+# hddtemp
+if test "$PLUGIN_HDDTEMP" = "yes"; then
+   PLUGINS="$PLUGINS plugin_hddtemp.o"
+   AC_DEFINE(PLUGIN_HDDTEMP,1,[hddtemp plugin])
+fi
+
+# I2C
+if test "$PLUGIN_I2C_SENSORS" = "yes"; then
+   PLUGINS="$PLUGINS plugin_i2c_sensors.o"
+   AC_DEFINE(PLUGIN_I2C_SENSORS,1,[i2c sensors plugin])
+fi
+
+# IConv
+if test "$PLUGIN_ICONV" = "yes"; then
+   AM_ICONV
+   if test "$am_cv_func_iconv" = "yes"; then 
+      PLUGINS="$PLUGINS plugin_iconv.o"
+      PLUGINLIBS="$PLUGINLIBS $LIBICONV"
+      AC_DEFINE(PLUGIN_ICONV,1,[iconv charset converter plugin])
+   else
+      AC_MSG_WARN(iconv not found: iconv plugin disabled)
+   fi
+fi
+
+# ISDN monitor
+if test "$PLUGIN_IMON" = "yes"; then
+   AC_CHECK_HEADERS(linux/errno.h, [has_linux_errno="true"], [has_linux_errno="false"])
+   if test "$has_linux_errno" = "true"; then
+       PLUGINS="$PLUGINS plugin_imon.o"
+       AC_DEFINE(PLUGIN_IMON,1,[imon plugin])
+   else
+       AC_MSG_WARN(linux/errno.h header not found: imon plugin disabled)
+   fi
+fi
+
+# ISDN
+if test "$PLUGIN_ISDN" = "yes"; then
+   AC_CHECK_HEADERS(linux/isdn.h, [has_isdn_header="true"], [has_isdn_header="false"])
+   if test "$has_dvb_header" = "false"; then
+      AC_MSG_WARN(linux/isdn.h header not found: isdn plugin CPS disabled)
+   fi   
+   PLUGINS="$PLUGINS plugin_isdn.o"
+   AC_DEFINE(PLUGIN_ISDN,1,[ISDN plugin])
+fi
+
+# Karlsruher Verkehrsverbund
+if test "$PLUGIN_KVV" = "yes"; then
+   PLUGINS="$PLUGINS plugin_kvv.o"
+   AC_DEFINE(PLUGIN_KVV,1,[kvv plugin])
+fi
+
+# load average
+if test "$PLUGIN_LOADAVG" = "yes"; then
+   PLUGINS="$PLUGINS plugin_loadavg.o"
+   AC_DEFINE(PLUGIN_LOADAVG,1,[loadavg plugin])
+fi
+
+# meminfo
+if test "$PLUGIN_MEMINFO" = "yes"; then
+   PLUGINS="$PLUGINS plugin_meminfo.o"
+   AC_DEFINE(PLUGIN_MEMINFO,1,[meminfo plugin])
+fi
+
+# MPD
+if test "$PLUGIN_MPD" = "yes"; then   
+   if test -f "libmpdclient.h"
+   then      
+	PLUGINS="$PLUGINS plugin_mpd.o libmpdclient.o"
+	AC_DEFINE(PLUGIN_MPD,1,[mpd plugin])      
+   else
+      AC_MSG_WARN(libmpdclient.h header not found: mpd plugin disabled)
+      AC_MSG_WARN(get libmpdclient.h from http://www.musicpd.org/libmpdclient.shtml)
+      AC_MSG_WARN(and copy those 2 files in the lcd4linux directory.)
+   fi
+fi
+
+# MySQL
+if test "$PLUGIN_MYSQL" = "yes"; then
+   AC_CHECK_HEADERS(mysql/mysql.h, [has_mysql_header="true"], [has_mysql_header="false"])
+   if test "$has_mysql_header" = "true"; then	
+      AC_CHECK_LIB(mysqlclient, mysql_init, [has_mysql_lib="true"], [has_mysql_lib="false"])
+      if test "$has_mysql_lib" = "true"; then
+        PLUGINS="$PLUGINS plugin_mysql.o"
+        PLUGINLIBS="$PLUGINLIBS -lmysqlclient"
+        AC_DEFINE(PLUGIN_MYSQL,1,[mysql plugin])
+      else
+        AC_MSG_WARN(mysqlclient lib not found: mysql plugin disabled)
+      fi
+   else
+      AC_MSG_WARN(mysql/mysql.h header not found: mysql plugin disabled)
+   fi 
+fi
+
+# /proc/net/dev
+if test "$PLUGIN_NETDEV" = "yes"; then
+   PLUGINS="$PLUGINS plugin_netdev.o"
+   AC_DEFINE(PLUGIN_NETDEV,1,[netdev plugin])
+fi
+
+# configuration of network devices
+if test "$PLUGIN_NETINFO" = "yes"; then
+   PLUGINS="$PLUGINS plugin_netinfo.o"
+   AC_DEFINE(PLUGIN_NETINFO,1,[netinfo plugin])
+fi
+
+# POP3
+if test "$PLUGIN_POP3" = "yes"; then
+   PLUGINS="$PLUGINS plugin_pop3.o"
+   AC_DEFINE(PLUGIN_POP3,1,[POP3 plugin])
+fi
+
+# PPP
+if test "$PLUGIN_PPP" = "yes"; then
+   AC_CHECK_HEADERS(net/if_ppp.h, [has_ppp_header="true"], [has_ppp_header="false"])
+   if test "$has_ppp_header" = "true"; then
+      PLUGINS="$PLUGINS plugin_ppp.o"
+      AC_DEFINE(PLUGIN_PPP,1,[ppp plugin])
+   else
+      AC_MSG_WARN(net/if_ppp.h header not found: ppp plugin disabled)
+   fi 
+fi
+
+# /proc/stat
+if test "$PLUGIN_PROC_STAT" = "yes"; then
+   PLUGINS="$PLUGINS plugin_proc_stat.o"
+   AC_DEFINE(PLUGIN_PROC_STAT,1,[proc_stat plugin])
+fi
+
+# python
+if test "$PLUGIN_PYTHON" = "yes"; then
+   if test "$with_python" != "yes"; then
+      AC_MSG_WARN(python support not enabled: python plugin disabled (use --with-python to enable))
+   else
+      if test -z "$python_path"; then
+         AC_MSG_WARN(python headers not found: python plugin disabled)
+      else
+         PLUGINS="$PLUGINS plugin_python.o"
+         CPPFLAGS="$CPPFLAGS $PYTHON_CPPFLAGS"
+         PLUGINLIBS="$PLUGINLIBS $PYTHON_LDFLAGS $PYTHON_EXTRA_LIBS"
+         AC_DEFINE(PLUGIN_PYTHON,1,[python plugin])
+      fi 
+   fi 
+fi
+
+# sample
+if test "$PLUGIN_SAMPLE" = "yes"; then
+   PLUGINS="$PLUGINS plugin_sample.o"
+   AC_DEFINE(PLUGIN_SAMPLE,1,[sample plugin])
+fi
+
+# SETI
+if test "$PLUGIN_SETI" = "yes"; then
+   PLUGINS="$PLUGINS plugin_seti.o"
+   AC_DEFINE(PLUGIN_SETI,1,[seti plugin])
+fi
+
+# statfs()
+if test "$PLUGIN_STATFS" = "yes"; then
+   AC_CHECK_HEADERS(sys/vfs.h, [has_vfs_header="true"], [has_vfs_header="false"])
+   if test "$has_vfs_header" = "true"; then
+       PLUGINS="$PLUGINS plugin_statfs.o"
+       AC_DEFINE(PLUGIN_STATFS,1,[statfs plugin])
+   else
+      AC_MSG_WARN(sys/vfs.h header not found: statfs plugin disabled)
+   fi 
+fi
+
+# uname
+if test "$PLUGIN_UNAME" = "yes"; then
+   PLUGINS="$PLUGINS plugin_uname.o"
+   AC_DEFINE(PLUGIN_UNAME,1,[uname plugin])
+fi
+
+# uptime
+if test "$PLUGIN_UPTIME" = "yes"; then
+   PLUGINS="$PLUGINS plugin_uptime.o"
+   AC_DEFINE(PLUGIN_UPTIME,1,[uptime plugin])
+fi
+
+if test "$PLUGIN_W1RETAP" = "yes"; then
+   PLUGINS="$PLUGINS plugin_w1retap.o"
+   AC_DEFINE(PLUGIN_W1RETAP,1,[w1retap plugin])
+fi
+
+# WLAN
+if test "$PLUGIN_WIRELESS" = "yes"; then
+   AC_CHECK_HEADERS(linux/wireless.h, [has_wireless_header="true"], [has_wireless_header="false"])
+   if test "$has_wireless_header" = "true"; then
+       PLUGINS="$PLUGINS plugin_wireless.o"
+       AC_DEFINE(PLUGIN_WIRELESS,1,[wireless plugin])
+   else
+      AC_MSG_WARN(linux/wireless.h header not found: wireless plugin disabled)
+   fi 
+fi
+
+# XMMS
+if test "$PLUGIN_XMMS" = "yes"; then
+   PLUGINS="$PLUGINS plugin_xmms.o"
+   AC_DEFINE(PLUGIN_XMMS,1,[xmms plugin])
+fi
+
+if test "$PLUGINS" = ""; then
+   AC_MSG_ERROR([You should include at least one plugin...])
+fi
+   
+AC_SUBST(PLUGINS)
+AC_SUBST(PLUGINLIBS)
diff -urN lcd4linux-0.10.0/plugin_statfs.c lcd4linux-0.11.0-SVN/plugin_statfs.c
--- lcd4linux-0.10.0/plugin_statfs.c	2005-05-08 06:32:45.000000000 +0200
+++ lcd4linux-0.11.0-SVN/plugin_statfs.c	2008-12-31 08:05:54.000000000 +0100
@@ -1,8 +1,9 @@
-/* $Id: plugin_statfs.c,v 1.2 2005/05/08 04:32:45 reinelt Exp $
+/* $Id: plugin_statfs.c 840 2007-09-09 12:17:42Z michael $
+ * $URL: https://ssl.bulix.org/svn/lcd4linux/trunk/plugin_statfs.c $
  *
  * plugin for statfs() syscall
  *
- * Copyright (C) 2005 Michael Reinelt <reinelt@eunet.at>
+ * Copyright (C) 2005 Michael Reinelt <michael@reinelt.co.at>
  * Copyright (C) 2005 The LCD4Linux Team <lcd4linux-devel@users.sourceforge.net>
  *
  * This file is part of LCD4Linux.
@@ -21,14 +22,6 @@
  * along with this program; if not, write to the Free Software
  * Foundation, Inc., 675 Mass Ave, Cambridge, MA 02139, USA.
  *
- *
- * $Log: plugin_statfs.c,v $
- * Revision 1.2  2005/05/08 04:32:45  reinelt
- * CodingStyle added and applied
- *
- * Revision 1.1  2005/04/03 07:07:51  reinelt
- * added statfs plugin
- *
  */
 
 /* 
diff -urN lcd4linux-0.10.0/plugin_string.c lcd4linux-0.11.0-SVN/plugin_string.c
--- lcd4linux-0.10.0/plugin_string.c	2005-05-08 06:32:45.000000000 +0200
+++ lcd4linux-0.11.0-SVN/plugin_string.c	2008-12-31 08:05:54.000000000 +0100
@@ -1,8 +1,9 @@
-/* $Id: plugin_string.c,v 1.8 2005/05/08 04:32:45 reinelt Exp $
+/* $Id: plugin_string.c 840 2007-09-09 12:17:42Z michael $
+ * $URL: https://ssl.bulix.org/svn/lcd4linux/trunk/plugin_string.c $
  *
  * string plugin
  *
- * Copyright (C) 2003, 2004 Michael Reinelt <reinelt@eunet.at>
+ * Copyright (C) 2003, 2004 Michael Reinelt <michael@reinelt.co.at>
  * Copyright (C) 2004 The LCD4Linux Team <lcd4linux-devel@users.sourceforge.net>
  *
  * This file is part of LCD4Linux.
@@ -21,40 +22,6 @@
  * along with this program; if not, write to the Free Software
  * Foundation, Inc., 675 Mass Ave, Cambridge, MA 02139, USA.
  *
- *
- * $Log: plugin_string.c,v $
- * Revision 1.8  2005/05/08 04:32:45  reinelt
- * CodingStyle added and applied
- *
- * Revision 1.7  2005/01/18 06:30:23  reinelt
- * added (C) to all copyright statements
- *
- * Revision 1.6  2004/06/26 12:05:00  reinelt
- *
- * uh-oh... the last CVS log message messed up things a lot...
- *
- * Revision 1.5  2004/06/26 09:27:21  reinelt
- *
- * added '-W' to CFLAGS
- * changed all C++ comments to C ones
- * cleaned up a lot of signed/unsigned mistakes
- *
- * Revision 1.4  2004/03/03 03:47:04  reinelt
- * big patch from Martin Hejl:
- * - use qprintf() where appropriate
- * - save CPU cycles on gettimeofday()
- * - add quit() functions to free allocated memory
- * - fixed lots of memory leaks
- *
- * Revision 1.3  2004/01/29 04:40:02  reinelt
- * every .c file includes "config.h" now
- *
- * Revision 1.2  2004/01/11 18:26:02  reinelt
- * further widget and layout processing
- *
- * Revision 1.1  2003/12/19 05:50:34  reinelt
- * added plugin_math.c and plugin_string.c
- *
  */
 
 /* 
@@ -71,6 +38,7 @@
 #include <stdlib.h>
 #include <stdio.h>
 #include <string.h>
+#include <ctype.h>
 
 #include "debug.h"
 #include "plugin.h"
@@ -82,13 +50,92 @@
     SetResult(&result, R_NUMBER, &value);
 }
 
+/* 'upcase' function (shamelessly stolen from plugin_sample.c)*/
+/* returns the string in upper case letters */
+static void my_strupper(RESULT * result, RESULT * arg1)
+{
+    char *value, *p;
+
+    value = strdup(R2S(arg1));
+
+    for (p = value; *p != '\0'; p++)
+	*p = toupper(*p);
+
+    SetResult(&result, R_STRING, value);
+    free(value);
+}
+
+static void my_strstr(RESULT * result, RESULT * arg1, RESULT * arg2)
+{
+    char *p;
+    double value;
+
+    char *haystack = R2S(arg1);
+    char *needle = R2S(arg2);
+
+    p = strstr(haystack, needle);
+
+    if (p == NULL) {
+	value = -1;
+    } else {
+	value = p - haystack;
+    }
+
+    SetResult(&result, R_NUMBER, &value);
+}
+
+static void my_substr(RESULT * result, int argc, RESULT * argv[])
+{
+    char *str, *p1, *p2;
+    int pos, len;
+
+    if (argc < 2 || argc > 3) {
+	error("substr(): wrong number of parameters");
+	SetResult(&result, R_STRING, "");
+	return;
+    }
+
+    str = strdup(R2S(argv[0]));
+
+    pos = R2N(argv[1]);
+    if (pos < 0)
+	pos = 0;
+
+    if (argc == 3) {
+	len = R2N(argv[2]);
+	if (len < 0)
+	    len = 0;
+    } else {
+	len = -1;
+    }
+
+    p1 = str;
+    while (pos > 0 && *p1 != '\0') {
+	p1++;
+	pos--;
+    }
+
+    if (len >= 0) {
+	p2 = p1;
+	while (len > 0 && *p2 != '\0') {
+	    p2++;
+	    len--;
+	}
+	*p2 = '\0';
+    }
+
+    SetResult(&result, R_STRING, p1);
+    free(str);
+}
 
 int plugin_init_string(void)
 {
 
     /* register some basic string functions */
     AddFunction("strlen", 1, my_strlen);
-
+    AddFunction("strupper", 1, my_strupper);
+    AddFunction("strstr", 2, my_strstr);
+    AddFunction("substr", -1, my_substr);
     return 0;
 }
 
diff -urN lcd4linux-0.10.0/plugin_test.c lcd4linux-0.11.0-SVN/plugin_test.c
--- lcd4linux-0.10.0/plugin_test.c	2005-05-08 06:32:45.000000000 +0200
+++ lcd4linux-0.11.0-SVN/plugin_test.c	2008-12-31 08:05:54.000000000 +0100
@@ -1,11 +1,12 @@
-/* $Id: plugin_test.c,v 1.5 2005/05/08 04:32:45 reinelt Exp $
+/* $Id: plugin_test.c 840 2007-09-09 12:17:42Z michael $
+ * $URL: https://ssl.bulix.org/svn/lcd4linux/trunk/plugin_test.c $
 *
 * Handy functions for testing displays and debugging code.
 *
 * Copyright (C) 2004 Andy Baxter.
 *
 * Based on sample plugin which is
-* Copyright (C) 2003 Michael Reinelt <reinelt@eunet.at>
+* Copyright (C) 2003 Michael Reinelt <michael@reinelt.co.at>
 * Copyright (C) 2004 The LCD4Linux Team <lcd4linux-devel@users.sourceforge.net>
 *
 * This file is part of LCD4Linux.
@@ -24,28 +25,6 @@
 * along with this program; if not, write to the Free Software
 * Foundation, Inc., 675 Mass Ave, Cambridge, MA 02139, USA.
 *
-*
-* $Log: plugin_test.c,v $
-* Revision 1.5  2005/05/08 04:32:45  reinelt
-* CodingStyle added and applied
-*
-* Revision 1.4  2005/01/18 06:30:23  reinelt
-* added (C) to all copyright statements
-*
-* Revision 1.3  2004/06/26 12:05:00  reinelt
-*
-* uh-oh... the last CVS log message messed up things a lot...
-*
-* Revision 1.2  2004/06/26 09:27:21  reinelt
-*
-* added '-W' to CFLAGS
-* changed all C++ comments to C ones
-* cleaned up a lot of signed/unsigned mistakes
-*
-* Revision 1.1  2004/06/07 06:56:55  reinelt
-*
-* added test plugin from Andy Baxter
-*
 */
 
 int plugin_init_test(void);
diff -urN lcd4linux-0.10.0/plugin_time.c lcd4linux-0.11.0-SVN/plugin_time.c
--- lcd4linux-0.10.0/plugin_time.c	2005-05-08 06:32:45.000000000 +0200
+++ lcd4linux-0.11.0-SVN/plugin_time.c	2008-12-31 08:05:54.000000000 +0100
@@ -1,8 +1,9 @@
-/* $Id: plugin_time.c,v 1.5 2005/05/08 04:32:45 reinelt Exp $
+/* $Id: plugin_time.c 897 2008-10-06 04:25:14Z michael $
+ * $URL: https://ssl.bulix.org/svn/lcd4linux/trunk/plugin_time.c $
  *
  * time plugin
  *
- * Copyright (C) 2003, 2004 Michael Reinelt <reinelt@eunet.at>
+ * Copyright (C) 2003, 2004 Michael Reinelt <michael@reinelt.co.at>
  * Copyright (C) 2004 The LCD4Linux Team <lcd4linux-devel@users.sourceforge.net>
  *
  * This file is part of LCD4Linux.
@@ -21,27 +22,6 @@
  * along with this program; if not, write to the Free Software
  * Foundation, Inc., 675 Mass Ave, Cambridge, MA 02139, USA.
  *
- *
- * $Log: plugin_time.c,v $
- * Revision 1.5  2005/05/08 04:32:45  reinelt
- * CodingStyle added and applied
- *
- * Revision 1.4  2005/01/18 06:30:23  reinelt
- * added (C) to all copyright statements
- *
- * Revision 1.3  2004/06/26 12:05:00  reinelt
- *
- * uh-oh... the last CVS log message messed up things a lot...
- *
- * Revision 1.2  2004/06/26 09:27:21  reinelt
- *
- * added '-W' to CFLAGS
- * changed all C++ comments to C ones
- * cleaned up a lot of signed/unsigned mistakes
- *
- * Revision 1.1  2004/05/20 07:47:51  reinelt
- * added plugin_time
- *
  */
 
 /* 
@@ -56,6 +36,8 @@
 #include "config.h"
 
 #include <time.h>
+#include <stdlib.h>
+#include <string.h>
 
 #include "debug.h"
 #include "plugin.h"
@@ -79,6 +61,40 @@
     SetResult(&result, R_STRING, value);
 }
 
+static void my_stftime_tz(RESULT * result, RESULT * arg1, RESULT * arg2, RESULT * arg3)
+{
+    char value[256] = "";
+    time_t t = R2N(arg2);
+    char *tz = R2S(arg3);
+    char *old_tz;
+
+    old_tz = getenv("TZ");
+
+    /*
+     * because the next setenv() call may overwrite that string, we
+     * duplicate it here
+     */
+    if (old_tz) {
+	old_tz = strdup(old_tz);
+    }
+
+    setenv("TZ", tz, 1);
+    tzset();
+
+    strftime(value, sizeof(value), R2S(arg1), localtime(&t));
+
+    if (old_tz) {
+	setenv("TZ", old_tz, 1);
+    } else {
+	unsetenv("TZ");
+    }
+    tzset();
+
+    free(old_tz);
+
+    SetResult(&result, R_STRING, value);
+}
+
 
 int plugin_init_time(void)
 {
@@ -86,6 +102,7 @@
     /* register some basic time functions */
     AddFunction("time", 0, my_time);
     AddFunction("strftime", 2, my_strftime);
+    AddFunction("strftime_tz", 3, my_stftime_tz);
 
     return 0;
 }
diff -urN lcd4linux-0.10.0/plugin_uname.c lcd4linux-0.11.0-SVN/plugin_uname.c
--- lcd4linux-0.10.0/plugin_uname.c	2005-05-08 06:32:45.000000000 +0200
+++ lcd4linux-0.11.0-SVN/plugin_uname.c	2008-12-31 08:05:54.000000000 +0100
@@ -1,8 +1,9 @@
-/* $Id: plugin_uname.c,v 1.6 2005/05/08 04:32:45 reinelt Exp $
+/* $Id: plugin_uname.c 840 2007-09-09 12:17:42Z michael $
+ * $URL: https://ssl.bulix.org/svn/lcd4linux/trunk/plugin_uname.c $
  *
  * plugin for uname() syscall
  *
- * Copyright (C) 2003 Michael Reinelt <reinelt@eunet.at>
+ * Copyright (C) 2003 Michael Reinelt <michael@reinelt.co.at>
  * Copyright (C) 2004 The LCD4Linux Team <lcd4linux-devel@users.sourceforge.net>
  *
  * This file is part of LCD4Linux.
@@ -21,33 +22,6 @@
  * along with this program; if not, write to the Free Software
  * Foundation, Inc., 675 Mass Ave, Cambridge, MA 02139, USA.
  *
- *
- * $Log: plugin_uname.c,v $
- * Revision 1.6  2005/05/08 04:32:45  reinelt
- * CodingStyle added and applied
- *
- * Revision 1.5  2005/01/18 06:30:23  reinelt
- * added (C) to all copyright statements
- *
- * Revision 1.4  2005/01/09 10:53:24  reinelt
- * small type in plugin_uname fixed
- * new homepage lcd4linux.bulix.org
- *
- * Revision 1.3  2004/03/03 03:47:04  reinelt
- * big patch from Martin Hejl:
- * - use qprintf() where appropriate
- * - save CPU cycles on gettimeofday()
- * - add quit() functions to free allocated memory
- * - fixed lots of memory leaks
- *
- * Revision 1.2  2004/01/29 04:40:02  reinelt
- * every .c file includes "config.h" now
- *
- * Revision 1.1  2004/01/14 11:33:00  reinelt
- * new plugin 'uname' which does what it's called
- * text widget nearly finished
- * first results displayed on MatrixOrbital
- *
  */
 
 /* 
@@ -94,7 +68,7 @@
 	value = utsbuf.version;
     } else if (strcasecmp(key, "machine") == 0) {
 	value = utsbuf.machine;
-#ifdef _GNU_SOURCE
+#if defined(_GNU_SOURCE) && ! defined(__APPLE__)
     } else if (strcasecmp(key, "domainname") == 0) {
 	value = utsbuf.domainname;
 #endif
diff -urN lcd4linux-0.10.0/plugin_uptime.c lcd4linux-0.11.0-SVN/plugin_uptime.c
--- lcd4linux-0.10.0/plugin_uptime.c	2005-05-08 06:32:45.000000000 +0200
+++ lcd4linux-0.11.0-SVN/plugin_uptime.c	2008-12-31 08:05:54.000000000 +0100
@@ -1,8 +1,9 @@
-/* $Id: plugin_uptime.c,v 1.6 2005/05/08 04:32:45 reinelt Exp $
+/* $Id: plugin_uptime.c 840 2007-09-09 12:17:42Z michael $
+ * $URL: https://ssl.bulix.org/svn/lcd4linux/trunk/plugin_uptime.c $
  *
  * plugin for uptime
  *
- * Copyright (C) 2003 Michael Reinelt <reinelt@eunet.at>
+ * Copyright (C) 2003 Michael Reinelt <michael@reinelt.co.at>
  * Copyright (C) 2004 The LCD4Linux Team <lcd4linux-devel@users.sourceforge.net>
  *
  * This file is part of LCD4Linux.
@@ -21,32 +22,6 @@
  * along with this program; if not, write to the Free Software
  * Foundation, Inc., 675 Mass Ave, Cambridge, MA 02139, USA.
  *
- *
- * $Log: plugin_uptime.c,v $
- * Revision 1.6  2005/05/08 04:32:45  reinelt
- * CodingStyle added and applied
- *
- * Revision 1.5  2005/01/18 06:30:23  reinelt
- * added (C) to all copyright statements
- *
- * Revision 1.4  2004/06/26 12:05:00  reinelt
- *
- * uh-oh... the last CVS log message messed up things a lot...
- *
- * Revision 1.3  2004/06/26 09:27:21  reinelt
- *
- * added '-W' to CFLAGS
- * changed all C++ comments to C ones
- * cleaned up a lot of signed/unsigned mistakes
- *
- * Revision 1.2  2004/06/20 10:09:56  reinelt
- *
- * 'const'ified the whole source
- *
- * Revision 1.1  2004/05/22 18:30:02  reinelt
- *
- * added plugin 'uptime'
- *
  */
 
 /* 
diff -urN lcd4linux-0.10.0/plugin_w1retap.c lcd4linux-0.11.0-SVN/plugin_w1retap.c
--- lcd4linux-0.10.0/plugin_w1retap.c	1970-01-01 01:00:00.000000000 +0100
+++ lcd4linux-0.11.0-SVN/plugin_w1retap.c	2008-12-31 08:05:54.000000000 +0100
@@ -0,0 +1,264 @@
+/* $Id: plugin_w1retap.c
+ *
+ * plugin to perform simple file operations for w1retap
+ *
+ * Copyright (C) 2007 Jonathan Hudson <jh+w1retap@daria.co.uk>
+ * Copyright (C) 2006 The LCD4Linux Team <lcd4linux-devel@users.sourceforge.net>
+ *
+ * This file is part of LCD4Linux.
+ *
+ * LCD4Linux is free software; you can redistribute it and/or modify
+ * it under the terms of the GNU General Public License as published by
+ * the Free Software Foundation; either version 2, or (at your option)
+ * any later version.
+ *
+ * LCD4Linux is distributed in the hope that it will be useful,
+ * but WITHOUT ANY WARRANTY; without even the implied warranty of
+ * MERCHANTABILITY or FITNESS FOR A PARTICULAR PURPOSE.  See the
+ * GNU General Public License for more details.
+ *
+ * You should have received a copy of the GNU General Public License
+ * along with this program; if not, write to the Free Software
+ * Foundation, Inc., 675 Mass Ave, Cambridge, MA 02139, USA.
+ *
+ */
+
+/*
+ * This module returns a specific value associated with a key from a
+ * file containing one or more lines formatted as KEY=VALUE.
+ *
+ * It is intended for use with the w1retap weather station logging
+ * software <http://www.daria.co.uk/wx/tech.html>, but is applicable
+ * to any similarly formatted file.
+ */
+
+/* 
+ * exported functions:
+ *
+ * int plugin_init_file (void)
+ *  adds various functions
+ *
+ */
+
+
+#include "config.h"
+
+#include <stdio.h>
+#include <string.h>
+#include <stdlib.h>
+#include <ctype.h>
+
+#include "debug.h"
+#include "plugin.h"
+
+#ifdef WITH_DMALLOC
+#include <dmalloc.h>
+#endif
+
+/* function 'my_readkey' */
+/* takes two arguments, file name and key */
+/* returns value associated with key, trimmed to suitable dec places */
+
+static void my_readkey(RESULT * result, RESULT * arg1, RESULT * arg2)
+{
+    char value[80], val2[80];
+    FILE *fp;
+    char *reqkey, *pval;
+    size_t size;
+
+    *value = 0;
+    pval = value;
+
+    reqkey = R2S(arg2);
+    fp = fopen(R2S(arg1), "r");
+
+    if (!fp) {
+	error("w1retap couldn't open file '%s'", R2S(arg1));
+	value[0] = '\0';
+    } else {
+	size = strlen(reqkey);
+	while (!feof(fp) && pval == value) {
+	    fgets(val2, sizeof(val2), fp);
+	    if (*(val2 + size) == '=') {
+		if (strncmp(val2, reqkey, size) == 0) {
+		    char *p;
+		    p = index(val2, ' ');
+		    if (p == NULL) {
+			p = index(val2, '\n');
+		    }
+
+		    if (p) {
+			*p = 0;
+			pval = val2 + size + 1;
+			{
+			    double d;
+			    char *ep;
+			    d = strtod(pval, &ep);
+			    if (ep != pval && (*ep == 0 || isspace(*ep))) {
+				if (d > 500)
+				    sprintf(val2, "%.0f", d);
+				else
+				    sprintf(val2, "%.1f", d);
+				pval = val2;
+			    }
+			}
+		    }
+		}
+	    }
+	}
+	fclose(fp);
+    }
+
+    /* store result */
+    SetResult(&result, R_STRING, pval);
+}
+
+
+/* plugin initialization */
+/* MUST NOT be declared 'static'! */
+int plugin_init_w1retap(void)
+{
+
+    /* register all our cool functions */
+    /* the second parameter is the number of arguments */
+    /* -1 stands for variable argument list */
+    AddFunction("w1retap::readkey", 2, my_readkey);
+
+    return 0;
+}
+
+void plugin_exit_w1retap(void)
+{
+    /* free any allocated memory */
+    /* close filedescriptors */
+}
+
+
+/*
+
+#Sample configuration for w1retap
+#================================
+
+Display Weather {
+   Driver   'Pertelian'
+   Port     '/dev/ttyUSB0'
+   Size     '20x4'
+   Backlight 1
+   Icons     0
+}
+
+Display XWindow {
+    Driver     'X11'
+    Size       '120x32'
+    Font       '6x8'
+    Pixel      '4+1'
+    Gap        '-1x-1'
+    Border      20
+    Foreground '000000ff'
+    Background '00000033'
+    Basecolor '70c000'
+    Buttons   6
+    Brightness 133
+}
+
+Widget LCDTimer {
+   class 'Timer'
+   active 1
+   update 10000
+   expression h=strftime('%H', time()); x=file::readline('/tmp/.lcd',1)+0; b=(h > 5 | h < 23) + x ; LCD::backlight(b)
+}
+
+
+Widget Temp {
+    class 'Text'
+    expression w1retap::readkey(file, 'OTMP0')
+    prefix 'Extr '
+    width 10
+    align 'L'
+    update tick
+}
+
+Widget GHouse {
+    class 'Text'
+    expression w1retap::readkey(file, 'GHT')
+    prefix 'GHT '
+    width 10
+    align 'L'
+    update tick
+}
+
+Widget House {
+    class 'Text'
+    expression w1retap::readkey(file, 'OTMP1')
+    prefix 'Intr '
+    width 10
+    align 'L'
+    update tick
+}
+Widget Garage {
+    class 'Text'
+    expression w1retap::readkey(file, 'OTMP2')
+    prefix 'Gge '
+    width 10
+    align 'L'
+    update tick
+}
+Widget Soil {
+    class 'Text'
+    expression w1retap::readkey(file, 'STMP1')
+    prefix 'Soil '
+    width 10
+    align 'L'
+    update tick
+}
+Widget Press {
+    class 'Text'
+    expression w1retap::readkey(file, 'OPRS')
+    prefix 'Pres '
+    width 10
+    align 'L'
+    update tick
+}
+
+Widget Rain {
+    class 'Text'
+    expression w1retap::readkey(file1, 'RAIN')
+    prefix 'Rain '
+    width 20
+    align 'L'
+    update tick
+}
+
+Layout Default {
+    Timer1 'LCDTimer'
+    Row1 {
+        Col1 'Temp'
+	Col11 'GHouse'
+    }    
+
+    Row2 {
+	Col1 'House'
+        Col11 'Garage'
+    }    
+
+    Row3 {
+        Col1 'Soil'
+	Col11 'Press'
+    }    
+
+    Row4 {
+        Col1 'Rain'
+    }
+}
+
+Variables {
+   tick 120000
+   file '/tmp/.w1retap.dat'
+   file1 '/tmp/.w1rain.txt'
+}
+
+Layout 'Default'
+
+Display 'Weather'
+
+*/
diff -urN lcd4linux-0.10.0/plugin_wireless.c lcd4linux-0.11.0-SVN/plugin_wireless.c
--- lcd4linux-0.10.0/plugin_wireless.c	2005-05-08 06:32:45.000000000 +0200
+++ lcd4linux-0.11.0-SVN/plugin_wireless.c	2008-12-31 08:05:54.000000000 +0100
@@ -1,4 +1,5 @@
-/* $Id: plugin_wireless.c,v 1.9 2005/05/08 04:32:45 reinelt Exp $
+/* $Id: plugin_wireless.c 738 2007-01-16 08:30:24Z michael $
+ * $URL: https://ssl.bulix.org/svn/lcd4linux/trunk/plugin_wireless.c $
  *
  * Wireless Extension plugin
  *
@@ -26,42 +27,6 @@
  * along with this program; if not, write to the Free Software
  * Foundation, Inc., 675 Mass Ave, Cambridge, MA 02139, USA.
  *
- *
- * $Log: plugin_wireless.c,v $
- * Revision 1.9  2005/05/08 04:32:45  reinelt
- * CodingStyle added and applied
- *
- * Revision 1.8  2005/01/18 06:30:23  reinelt
- * added (C) to all copyright statements
- *
- * Revision 1.7  2004/06/26 12:05:00  reinelt
- *
- * uh-oh... the last CVS log message messed up things a lot...
- *
- * Revision 1.6  2004/06/26 09:27:21  reinelt
- *
- * added '-W' to CFLAGS
- * changed all C++ comments to C ones
- * cleaned up a lot of signed/unsigned mistakes
- *
- * Revision 1.5  2004/06/20 10:09:56  reinelt
- *
- * 'const'ified the whole source
- *
- * Revision 1.4  2004/06/17 06:23:43  reinelt
- *
- * hash handling rewritten to solve performance issues
- *
- * Revision 1.3  2004/05/27 03:39:47  reinelt
- *
- * changed function naming scheme to plugin::function
- *
- * Revision 1.2  2004/04/17 13:05:58  nicowallmeier
- * minor bugfix
- *
- * Revision 1.1  2004/04/07 08:29:05  hejl
- * New plugin for wireless info
- *
  */
 
  /*
@@ -92,6 +57,7 @@
 
 #include <sys/ioctl.h>
 #include <net/if_arp.h>
+#include <linux/if.h>
 #include <linux/wireless.h>
 #include <math.h>
 
diff -urN lcd4linux-0.10.0/plugin_xmms.c lcd4linux-0.11.0-SVN/plugin_xmms.c
--- lcd4linux-0.10.0/plugin_xmms.c	2005-05-08 06:32:45.000000000 +0200
+++ lcd4linux-0.11.0-SVN/plugin_xmms.c	2008-12-31 08:05:54.000000000 +0100
@@ -1,4 +1,5 @@
-/* $Id: plugin_xmms.c,v 1.14 2005/05/08 04:32:45 reinelt Exp $
+/* $Id: plugin_xmms.c 728 2007-01-14 11:14:38Z michael $
+ * $URL: https://ssl.bulix.org/svn/lcd4linux/trunk/plugin_xmms.c $
  *
  * XMMS-Plugin for LCD4Linux
  * Copyright (C) 2003 Markus Keil <markus_keil@t-online.de>
@@ -19,60 +20,6 @@
  * along with this program; if not, write to the Free Software
  * Foundation, Inc., 675 Mass Ave, Cambridge, MA 02139, USA.
  *
- *
- * $Log: plugin_xmms.c,v $
- * Revision 1.14  2005/05/08 04:32:45  reinelt
- * CodingStyle added and applied
- *
- * Revision 1.13  2005/01/18 06:30:23  reinelt
- * added (C) to all copyright statements
- *
- * Revision 1.12  2004/06/26 12:05:00  reinelt
- *
- * uh-oh... the last CVS log message messed up things a lot...
- *
- * Revision 1.11  2004/06/26 09:27:21  reinelt
- *
- * added '-W' to CFLAGS
- * changed all C++ comments to C ones
- * cleaned up a lot of signed/unsigned mistakes
- *
- * Revision 1.10  2004/06/17 06:23:43  reinelt
- *
- * hash handling rewritten to solve performance issues
- *
- * Revision 1.9  2004/03/03 03:47:04  reinelt
- * big patch from Martin Hejl:
- * - use qprintf() where appropriate
- * - save CPU cycles on gettimeofday()
- * - add quit() functions to free allocated memory
- * - fixed lots of memory leaks
- *
- * Revision 1.8  2004/02/05 23:58:18  mkeil
- * Fixed/Optimized Hashage-timings
- *
- * Revision 1.7  2004/01/29 04:40:02  reinelt
- * every .c file includes "config.h" now
- *
- * Revision 1.6  2004/01/21 11:31:23  reinelt
- * two bugs with hash_age() ixed
- *
- * Revision 1.5  2004/01/21 10:48:17  reinelt
- * hash_age function added
- *
- * Revision 1.4  2004/01/16 11:12:26  reinelt
- * some bugs in plugin_xmms fixed, parsing moved to own function
- * plugin_proc_stat nearly finished
- *
- * Revision 1.3  2004/01/16 10:09:49  mkeil
- *   -include caching for values
- *
- * Revision 1.2  2004/01/06 22:33:14  reinelt
- * Copyright statements cleaned up
- *
- * Revision 1.1  2003/12/19 06:27:33  reinelt
- * added XMMS plugin from Markus Keil
- *
  */
 
 /* 
diff -urN lcd4linux-0.10.0/property.c lcd4linux-0.11.0-SVN/property.c
--- lcd4linux-0.10.0/property.c	1970-01-01 01:00:00.000000000 +0100
+++ lcd4linux-0.11.0-SVN/property.c	2008-12-31 08:06:27.000000000 +0100
@@ -0,0 +1,174 @@
+/* $Id: property.c 840 2007-09-09 12:17:42Z michael $
+ * $URL: https://ssl.bulix.org/svn/lcd4linux/trunk/property.c $
+ *
+ * dynamic properties
+ *
+ * Copyright (C) 2006 Michael Reinelt <michael@reinelt.co.at>
+ * Copyright (C) 2006 The LCD4Linux Team <lcd4linux-devel@users.sourceforge.net>
+ *
+ * This file is part of LCD4Linux.
+ *
+ * LCD4Linux is free software; you can redistribute it and/or modify
+ * it under the terms of the GNU General Public License as published by
+ * the Free Software Foundation; either version 2, or (at your option)
+ * any later version.
+ *
+ * LCD4Linux is distributed in the hope that it will be useful,
+ * but WITHOUT ANY WARRANTY; without even the implied warranty of
+ * MERCHANTABILITY or FITNESS FOR A PARTICULAR PURPOSE.  See the
+ * GNU General Public License for more details.
+ *
+ * You should have received a copy of the GNU General Public License
+ * along with this program; if not, write to the Free Software
+ * Foundation, Inc., 675 Mass Ave, Cambridge, MA 02139, USA.
+ *
+ */
+
+
+/* 
+ * exported functions:
+ *
+ * void property_load (const char *section, const char *name, const char *defval, PROPERTY *prop)
+ *   initializes and loads a property from the config file and pre-compiles it
+ *
+ * void property_free (PROPERTY *prop)
+ *   frees all property allocations
+ *
+ * int property_eval(PROPERTY * prop)
+ *   evaluates a property; returns 1 if value has changed
+ *
+ * double P2N(PROPERTY * prop)
+ *   returns a (already evaluated) property as number
+ *
+ * char *P2S(PROPERTY * prop)
+ *   returns a (already evaluated) property as string
+ *
+ */
+
+
+#include "config.h"
+
+#include <stdlib.h>
+#include <stdio.h>
+#include <string.h>
+
+#include "debug.h"
+#include "cfg.h"
+#include "evaluator.h"
+#include "property.h"
+
+#ifdef WITH_DMALLOC
+#include <dmalloc.h>
+#endif
+
+
+void property_load(const char *section, const char *name, const char *defval, PROPERTY * prop)
+{
+    char *expression;
+
+    /* initialize structure */
+    prop->valid = 0;
+    prop->name = NULL;
+    prop->expression = NULL;
+    prop->compiled = NULL;
+    DelResult(&prop->result);
+
+    /* remember the name */
+    prop->name = strdup(name);
+
+    /* load expression from config, but do not evaluate it */
+    expression = cfg_get_raw(section, name, NULL);
+
+    if (expression == NULL) {
+	if (defval != NULL && *defval != '\0')
+	    debug("Notice: using default value <%s> for property '%s.%s'", defval, section, name);
+	prop->expression = (char *) defval;
+    } else {
+	prop->valid = 1;
+	prop->expression = expression;
+    }
+
+    /* pre-compile the expression */
+    Compile(prop->expression, &prop->compiled);
+
+}
+
+
+int property_valid(PROPERTY * prop)
+{
+    return prop->valid;
+}
+
+
+int property_eval(PROPERTY * prop)
+{
+    RESULT old;
+    int update;
+
+    /* this is a bit ugly: we need to remember the old value */
+    old.type = prop->result.type;
+    old.size = prop->result.size;
+    old.number = prop->result.number;
+    old.string = prop->result.string != NULL ? strdup(prop->result.string) : NULL;
+
+    DelResult(&prop->result);
+    Eval(prop->compiled, &prop->result);
+
+    /* check if property value has changed */
+    update = 1;
+    if (prop->result.type & R_NUMBER && old.type & R_NUMBER && prop->result.number == old.number) {
+	update = 0;
+    }
+    if (prop->result.type & R_STRING && old.type & R_STRING && prop->result.size == old.size) {
+	if (prop->result.string == NULL && old.string == NULL) {
+	    update = 0;
+	} else if (prop->result.string != NULL && old.string != NULL && strcmp(prop->result.string, old.string) == 0) {
+	    update = 0;
+	}
+    }
+
+    if (old.string)
+	free(old.string);
+
+    return update;
+}
+
+
+double P2N(PROPERTY * prop)
+{
+    if (prop == NULL) {
+	error("Property: internal error: NULL property");
+	return 0.0;
+    }
+    return R2N(&prop->result);
+}
+
+
+char *P2S(PROPERTY * prop)
+{
+    if (prop == NULL) {
+	error("Property: internal error: NULL property");
+	return NULL;
+    }
+    return R2S(&prop->result);
+}
+
+void property_free(PROPERTY * prop)
+{
+    if (prop->name != NULL) {
+	free(prop->name);
+	prop->name = NULL;
+    }
+
+    if (prop->expression != NULL) {
+	/* do *not* free expression */
+	prop->expression = NULL;
+    }
+
+    if (prop->compiled != NULL) {
+	free(prop->compiled);
+	prop->compiled = NULL;
+    }
+
+    DelResult(&prop->result);
+}
diff -urN lcd4linux-0.10.0/property.h lcd4linux-0.11.0-SVN/property.h
--- lcd4linux-0.10.0/property.h	1970-01-01 01:00:00.000000000 +0100
+++ lcd4linux-0.11.0-SVN/property.h	2008-12-31 08:06:27.000000000 +0100
@@ -0,0 +1,50 @@
+/* $Id: property.h 840 2007-09-09 12:17:42Z michael $
+ * $URL: https://ssl.bulix.org/svn/lcd4linux/trunk/property.h $
+ *
+ * dynamic properties
+ *
+ * Copyright (C) 2006 Michael Reinelt <michael@reinelt.co.at>
+ * Copyright (C) 2006 The LCD4Linux Team <lcd4linux-devel@users.sourceforge.net>
+ *
+ * This file is part of LCD4Linux.
+ *
+ * LCD4Linux is free software; you can redistribute it and/or modify
+ * it under the terms of the GNU General Public License as published by
+ * the Free Software Foundation; either version 2, or (at your option)
+ * any later version.
+ *
+ * LCD4Linux is distributed in the hope that it will be useful,
+ * but WITHOUT ANY WARRANTY; without even the implied warranty of
+ * MERCHANTABILITY or FITNESS FOR A PARTICULAR PURPOSE.  See the
+ * GNU General Public License for more details.
+ *
+ * You should have received a copy of the GNU General Public License
+ * along with this program; if not, write to the Free Software
+ * Foundation, Inc., 675 Mass Ave, Cambridge, MA 02139, USA.
+ *
+ */
+
+
+#ifndef _PROPERTY_H_
+#define _PROPERTY_H_
+
+#include "evaluator.h"
+
+
+typedef struct {
+    int valid;
+    char *name;
+    char *expression;
+    void *compiled;
+    RESULT result;
+} PROPERTY;
+
+
+void property_load(const char *section, const char *name, const char *defval, PROPERTY * prop);
+int property_valid(PROPERTY * prop);
+int property_eval(PROPERTY * prop);
+double P2N(PROPERTY * prop);
+char *P2S(PROPERTY * prop);
+void property_free(PROPERTY * prop);
+
+#endif
diff -urN lcd4linux-0.10.0/qprintf.c lcd4linux-0.11.0-SVN/qprintf.c
--- lcd4linux-0.10.0/qprintf.c	2005-05-08 06:32:45.000000000 +0200
+++ lcd4linux-0.11.0-SVN/qprintf.c	2008-12-31 08:05:54.000000000 +0100
@@ -1,8 +1,9 @@
-/* $Id: qprintf.c,v 1.8 2005/05/08 04:32:45 reinelt Exp $
+/* $Id: qprintf.c 918 2008-12-31 06:07:29Z michael $
+ * $URL: https://ssl.bulix.org/svn/lcd4linux/trunk/qprintf.c $
  *
  * simple but quick snprintf() replacement
  *
- * Copyright (C) 2004 Michael Reinelt <reinelt@eunet.at>
+ * Copyright (C) 2004 Michael Reinelt <michael@reinelt.co.at>
  * Copyright (C) 2004 The LCD4Linux Team <lcd4linux-devel@users.sourceforge.net>
  *
  * derived from a patch from Martin Hejl which is
@@ -24,47 +25,15 @@
  * along with this program; if not, write to the Free Software
  * Foundation, Inc., 675 Mass Ave, Cambridge, MA 02139, USA.
  *
- *
- * $Log: qprintf.c,v $
- * Revision 1.8  2005/05/08 04:32:45  reinelt
- * CodingStyle added and applied
- *
- * Revision 1.7  2005/01/18 06:30:23  reinelt
- * added (C) to all copyright statements
- *
- * Revision 1.6  2004/06/26 12:05:00  reinelt
- *
- * uh-oh... the last CVS log message messed up things a lot...
- *
- * Revision 1.5  2004/06/26 09:27:21  reinelt
- *
- * added '-W' to CFLAGS
- * changed all C++ comments to C ones
- * cleaned up a lot of signed/unsigned mistakes
- *
- * Revision 1.4  2004/06/20 10:09:56  reinelt
- *
- * 'const'ified the whole source
- *
- * Revision 1.3  2004/04/12 11:12:26  reinelt
- * added plugin_isdn, removed old ISDN client
- * fixed some real bad bugs in the evaluator
- *
- * Revision 1.2  2004/04/08 10:48:25  reinelt
- * finished plugin_exec
- * modified thread handling
- * added '%x' format to qprintf (hexadecimal)
- *
- * Revision 1.1  2004/02/27 07:06:26  reinelt
- * new function 'qprintf()' (simple but quick snprintf() replacement)
- *
  */
 
 /* 
  * exported functions:
  * 
  * int qprintf(char *str, size_t size, const char *format, ...)
- *   works like snprintf(), but format only knows about %d and %s
+ *   works like snprintf(), but format only knows about %d, %x, %u and %s
+ *     and for the numbers an optional length like %<len>d. If <len> beginns
+ *     with '0' the free space is filled with '0's, otherwise with ' '
  */
 
 
@@ -75,7 +44,7 @@
 #include <stdarg.h>
 #include <string.h>
 
-static char *itoa(char *buffer, const size_t size, int value)
+static char *itoa(char *buffer, const size_t size, int value, unsigned int fixedlen, unsigned int fill0)
 {
     char *p;
     int sign;
@@ -88,6 +57,8 @@
     sign = 0;
     if (value < 0) {
 	sign = 1;
+	if (fill0)
+	    fixedlen -= 1;
 	value = -value;
     }
 
@@ -102,14 +73,26 @@
 	value = value / 10;
     } while (value != 0 && p > buffer);
 
-    if (sign && p > buffer)
+    if (sign && !fill0 && p > buffer)
+	*--p = '-';
+
+    /* fill fixed length */
+    while (p > buffer && strlen(p) < fixedlen) {
+	if (fill0) {
+	    *--p = '0';
+	} else {
+	    *--p = ' ';
+	}
+    }
+
+    if (sign && fill0 && p > buffer)
 	*--p = '-';
 
     return p;
 }
 
 
-static char *utoa(char *buffer, const size_t size, unsigned int value)
+static char *utoa(char *buffer, const size_t size, unsigned int value, unsigned int fixedlen, unsigned int fill0)
 {
     char *p;
 
@@ -128,11 +111,20 @@
 	value = value / 10;
     } while (value != 0 && p > buffer);
 
+    /* fill fixed length */
+    while (p > buffer && strlen(p) < fixedlen) {
+	if (fill0) {
+	    *--p = '0';
+	} else {
+	    *--p = ' ';
+	}
+    }
+
     return p;
 }
 
 
-static char *utox(char *buffer, const size_t size, unsigned int value)
+static char *utox(char *buffer, const size_t size, unsigned int value, unsigned int fixedlen, unsigned int fill0)
 {
     char *p;
     int digit;
@@ -153,10 +145,29 @@
 	*--p = (digit < 10 ? '0' : 'a' - 10) + digit;
     } while (value != 0 && p > buffer);
 
+    /* fill fixed length */
+    while (p > buffer && strlen(p) < fixedlen) {
+	if (fill0) {
+	    *--p = '0';
+	} else {
+	    *--p = ' ';
+	}
+    }
+
     return p;
 }
 
 
+/*!
+    @function   qprintf
+    @abstract   quick print values into string
+    @discussion similar to snprintf(), but only support for "%s", "%d", "%u", "%x" with optional length for the numbers
+                like "%5d" (filled with ' ') or "%05x" (filled with '0')
+    @param      str  destination
+    @param      size  maximum length of destination string
+    @param      format  (like printf() with reduced number of formats)
+    @result     length of produced string
+*/
 int qprintf(char *str, const size_t size, const char *format, ...)
 {
 
@@ -178,7 +189,17 @@
 	    char buf[12], *s;
 	    int d;
 	    unsigned int u;
-	    switch (*++src) {
+	    unsigned int fixedlen = 0;
+	    unsigned int fill0 = 0;
+
+	    if (*++src == '0')
+		fill0 = 1;
+	    while (*src >= '0' && *src <= '9') {
+		fixedlen = fixedlen * 10 + (*src - '0');
+		src++;
+	    }
+
+	    switch (*src) {
 	    case 's':
 		src++;
 		s = va_arg(ap, char *);
@@ -190,7 +211,7 @@
 	    case 'd':
 		src++;
 		d = va_arg(ap, int);
-		s = itoa(buf, sizeof(buf), d);
+		s = itoa(buf, sizeof(buf), d, fixedlen, fill0);
 		while (len < size && *s != '\0') {
 		    len++;
 		    *dst++ = *s++;
@@ -199,7 +220,7 @@
 	    case 'u':
 		src++;
 		u = va_arg(ap, unsigned int);
-		s = utoa(buf, sizeof(buf), u);
+		s = utoa(buf, sizeof(buf), u, fixedlen, fill0);
 		while (len < size - 1 && *s != '\0') {
 		    len++;
 		    *dst++ = *s++;
@@ -208,7 +229,7 @@
 	    case 'x':
 		src++;
 		u = va_arg(ap, unsigned int);
-		s = utox(buf, sizeof(buf), u);
+		s = utox(buf, sizeof(buf), u, fixedlen, fill0);
 		while (len < size - 1 && *s != '\0') {
 		    len++;
 		    *dst++ = *s++;
diff -urN lcd4linux-0.10.0/qprintf.h lcd4linux-0.11.0-SVN/qprintf.h
--- lcd4linux-0.10.0/qprintf.h	2005-05-08 06:26:50.000000000 +0200
+++ lcd4linux-0.11.0-SVN/qprintf.h	2008-12-31 08:05:54.000000000 +0100
@@ -1,8 +1,9 @@
-/* $Id: qprintf.h,v 1.5 2005/01/18 06:30:23 reinelt Exp $
+/* $Id: qprintf.h 840 2007-09-09 12:17:42Z michael $
+ * $URL: https://ssl.bulix.org/svn/lcd4linux/trunk/qprintf.h $
  *
  * simple but quick snprintf() replacement
  *
- * Copyright (C) 2004 Michael Reinelt <reinelt@eunet.at>
+ * Copyright (C) 2004 Michael Reinelt <michael@reinelt.co.at>
  * Copyright (C) 2004 The LCD4Linux Team <lcd4linux-devel@users.sourceforge.net>
  *
  * derived from a patch from Martin Hejl which is
@@ -24,27 +25,6 @@
  * along with this program; if not, write to the Free Software
  * Foundation, Inc., 675 Mass Ave, Cambridge, MA 02139, USA.
  *
- *
- * $Log: qprintf.h,v $
- * Revision 1.5  2005/01/18 06:30:23  reinelt
- * added (C) to all copyright statements
- *
- * Revision 1.4  2004/06/26 12:05:00  reinelt
- *
- * uh-oh... the last CVS log message messed up things a lot...
- *
- * Revision 1.3  2004/06/26 09:27:21  reinelt
- *
- * added '-W' to CFLAGS
- * changed all C++ comments to C ones * cleaned up a lot of signed/unsigned mistakes
- *
- * Revision 1.2  2004/03/03 04:44:16  reinelt
- * changes (cosmetics?) to the big patch from Martin
- * hash patch un-applied
- *
- * Revision 1.1  2004/02/27 07:06:26  reinelt
- * new function 'qprintf()' (simple but quick snprintf() replacement)
- *
  */
 
 #ifndef _QPRINTF_H_
diff -urN lcd4linux-0.10.0/README lcd4linux-0.11.0-SVN/README
--- lcd4linux-0.10.0/README	2005-01-09 11:53:22.000000000 +0100
+++ lcd4linux-0.11.0-SVN/README	2008-12-31 08:05:54.000000000 +0100
@@ -1,6 +1,5 @@
-#
-# $Id: README,v 1.25 2005/01/09 10:53:22 reinelt Exp $
-#
+# $Id: README 730 2007-01-14 13:50:28Z michael $
+# $URL: https://ssl.bulix.org/svn/lcd4linux/trunk/README $
 
 Sorry, there is no README anymore.
 Go to http://lcd4linux.bulix.org for all the documentation.
diff -urN lcd4linux-0.10.0/README.Drivers lcd4linux-0.11.0-SVN/README.Drivers
--- lcd4linux-0.10.0/README.Drivers	2001-03-09 14:08:11.000000000 +0100
+++ lcd4linux-0.11.0-SVN/README.Drivers	1970-01-01 01:00:00.000000000 +0100
@@ -1,58 +0,0 @@
-#
-# $Id: README.Drivers,v 1.4 2001/03/09 13:08:11 ltoetsch Exp $
-#
-
-How to write new display drivers for lcd4linux
-
-If you plan to write a new display driver for lcd4linux, you should follow
-this guidelines:
-
-* use Skeleton.c as a start point.
-  You might also have a look at Text.c
-
-* create a new sourcefile <drivername>.c and add it to the bottom of
-  Makefile.am
-
-* add an entry to configure.in
-
-* there's no need for a <drivername>.h
-
-* create one (or more) unique display names (your driver will be selected by
-  this name in the 'Display'-line of lcd4linux.conf).
-
-* include "display.h" in your driver, to get the LCD structure and various 
-  BAR_ definitions
-
-* include "cfg.h" if you need to access settings in the config file.
-
-* create a LCD table at the bottom of your driver, and fill it with the
-  appropriate values. Take care that you specify the correct bar capabilities
-  of your display or driver:
-
-  BAR_L:  horizontal bars headed left
-  BAR_R:  horizontal bars headed right
-  BAR_H2: driver supports horizontal dual-bars
-  BAR_U:  vertical bars bottom-up
-  BAR_D:  vertical bars top-down
-  BAR_V2: driver supports vertical dual-bars
-
-* edit display.c and create a reference to your LCD table:
-
-     external LCD YourDriver[];
-
-* extend the FAMILY table in display.c with your driver:
-
-     FAMILY Driver[] = {
-       { "Skeleton",      Skeleton },
-       { "MatrixOrbital", MatrixOrbital },
-       { "YourFamily",    YourDriver },
-       { "" }
-     };
-
-* write the correspondig init(), clear(), put(), bar(), quit() and
-  flush()-functions. There's no need to use a framebuffer and display its
-  contents with the flush()- call (as in MatrixOrbital.c), you can directly
-  write to the display in the put()- and bar()-functions, and use an empty
-  flush()-function. But if you have a limited number of user-defined
-  characters, and therefore you have to do some sort of 'character reduction'
-  or similar stuff, you will have to use a framebuffer and the flush()-call. 
diff -urN lcd4linux-0.10.0/README.KDE lcd4linux-0.11.0-SVN/README.KDE
--- lcd4linux-0.10.0/README.KDE	2000-04-03 08:53:09.000000000 +0200
+++ lcd4linux-0.11.0-SVN/README.KDE	1970-01-01 01:00:00.000000000 +0100
@@ -1,42 +0,0 @@
-#
-# $Id: README.KDE,v 1.1 2000/04/03 06:53:09 reinelt Exp $
-#
-
-This is the README file for the KDE integration of lcd4linux
-
-
-First: lcd4linux is  NO  KDE program!
-
-But: lcd4linux with the X11-driver can be integrated in KDE, so that it
-drives a little window in the KDE panel.
-
-This so called 'swallowing on panel' can be accomplished by using a .kdelnk
-file and a special configuration. Both files come with this package, but should
-be adopted to your needs.
-
-The KDE panel windows must have a size of 45x45 pixels. We get this size by
-using a size of 6x5 characters, each character has 6x8 pixels. By using
-a horizontal gap of 1 pixel between characters, we get a size of 
-
-horizontal: 6 chars * 6 pixels + 5 gaps = 41 pixels
-vertical:   5 chars * 8 pixels          = 40 pixels
-
-With a border size of 2 pixels this gives a size of 45 x 44 pixels. Great!
-
-I prefer using 5 vertical bars (load avg, CPU busy, CPU system, disk read+write,
-network receive+transmit, ISDN in+out), but you use any other combination you
-like.
-
-
-INSTALLATION:
-
-* download and compile lcd4linux
-* edit lcd4linux.kdelnk and copy to $KDEDIR/share/applnk/apps/System
-* copy lcd4linux.xpm to $KDEDIR/share/icons
-* copy lcd4kde.conf to /etc
-* create a /etc/lcd4X11.conf (this will be used if you start lcd4linux from the menu
-  or by clicking on the panel window
-* use "Panel/Add Application" from the K menu to create a panel entry
-* restart KPanel
-
-Enjoy!
diff -urN lcd4linux-0.10.0/README.Plugins lcd4linux-0.11.0-SVN/README.Plugins
--- lcd4linux-0.10.0/README.Plugins	2004-06-01 08:04:25.000000000 +0200
+++ lcd4linux-0.11.0-SVN/README.Plugins	1970-01-01 01:00:00.000000000 +0100
@@ -1,23 +0,0 @@
-#
-# $Id: README.Plugins,v 1.2 2004/06/01 06:04:25 reinelt Exp $
-#
-
-
-This file contains instructions for writing plugins to lcd4linux.
-
-- use the file 'plugin_sample.c' as a template
-- copy the file to 'plugin_yourname.c' and edit
-- replace the "$Id..." in the first line with "$Id\$" (without backslash)
-- add a short description what this plugin is for
-- add your copyright notice (important: your name and email)
-- replace the "$Log..." with "$Log\$" (without backslash)
-- remove all Log lines until "*/"
-- do some documentation (I know that real programmers write programs, not documentation)
-- use one or more of the example functions as templates for your own functions
-- register your new functions to the init() function, delete the sample ones
-- edit 'plugin.c', add a prototype and the call to your plugin_init_* function
-- edit 'Makefile.am' and add your 'plugin_*.c' to lcd4linux_SOURCES
-- compile and test with interactive mode ('-i')
-- send me a patch (or check in if you have developer CVS access)
-- enjoy
-
diff -urN lcd4linux-0.10.0/rgb.c lcd4linux-0.11.0-SVN/rgb.c
--- lcd4linux-0.10.0/rgb.c	1970-01-01 01:00:00.000000000 +0100
+++ lcd4linux-0.11.0-SVN/rgb.c	2008-12-31 08:06:27.000000000 +0100
@@ -0,0 +1,62 @@
+/* $Id: rgb.c 840 2007-09-09 12:17:42Z michael $
+ * $URL: https://ssl.bulix.org/svn/lcd4linux/trunk/rgb.c $
+ *
+ * generic color handling
+ *
+ * Copyright (C) 2005 Michael Reinelt <michael@reinelt.co.at>
+ * Copyright (C) 2005 The LCD4Linux Team <lcd4linux-devel@users.sourceforge.net>
+ *
+ * This file is part of LCD4Linux.
+ *
+ * LCD4Linux is free software; you can redistribute it and/or modify
+ * it under the terms of the GNU General Public License as published by
+ * the Free Software Foundation; either version 2, or (at your option)
+ * any later version.
+ *
+ * LCD4Linux is distributed in the hope that it will be useful,
+ * but WITHOUT ANY WARRANTY; without even the implied warranty of
+ * MERCHANTABILITY or FITNESS FOR A PARTICULAR PURPOSE.  See the
+ * GNU General Public License for more details.
+ *
+ * You should have received a copy of the GNU General Public License
+ * along with this program; if not, write to the Free Software
+ * Foundation, Inc., 675 Mass Ave, Cambridge, MA 02139, USA.
+ *
+ */
+
+
+#include <stdlib.h>
+#include <string.h>
+
+#include "rgb.h"
+
+
+int color2RGBA(const char *color, RGBA * C)
+{
+    char *e;
+    unsigned long l;
+
+    if (color == NULL || *color == '\0') {
+	return -1;
+    }
+
+    l = strtoul(color, &e, 16);
+    if (e != NULL && *e != '\0') {
+	return -1;
+    }
+
+    if (strlen(color) == 8) {
+	/* RGBA */
+	C->R = (l >> 24) & 0xff;
+	C->G = (l >> 16) & 0xff;
+	C->B = (l >> 8) & 0xff;
+	C->A = (l >> 0) & 0xff;
+    } else {
+	/* RGB */
+	C->R = (l >> 16) & 0xff;
+	C->G = (l >> 8) & 0xff;
+	C->B = l & 0xff;
+	C->A = 0xff;
+    }
+    return 0;
+}
diff -urN lcd4linux-0.10.0/rgb.h lcd4linux-0.11.0-SVN/rgb.h
--- lcd4linux-0.10.0/rgb.h	1970-01-01 01:00:00.000000000 +0100
+++ lcd4linux-0.11.0-SVN/rgb.h	2008-12-31 08:06:27.000000000 +0100
@@ -0,0 +1,41 @@
+/* $Id: rgb.h 840 2007-09-09 12:17:42Z michael $
+ * $URL: https://ssl.bulix.org/svn/lcd4linux/trunk/rgb.h $
+ *
+ * generic color handling
+ *
+ * Copyright (C) 2005 Michael Reinelt <michael@reinelt.co.at>
+ * Copyright (C) 2005 The LCD4Linux Team <lcd4linux-devel@users.sourceforge.net>
+ *
+ * This file is part of LCD4Linux.
+ *
+ * LCD4Linux is free software; you can redistribute it and/or modify
+ * it under the terms of the GNU General Public License as published by
+ * the Free Software Foundation; either version 2, or (at your option)
+ * any later version.
+ *
+ * LCD4Linux is distributed in the hope that it will be useful,
+ * but WITHOUT ANY WARRANTY; without even the implied warranty of
+ * MERCHANTABILITY or FITNESS FOR A PARTICULAR PURPOSE.  See the
+ * GNU General Public License for more details.
+ *
+ * You should have received a copy of the GNU General Public License
+ * along with this program; if not, write to the Free Software
+ * Foundation, Inc., 675 Mass Ave, Cambridge, MA 02139, USA.
+ *
+ */
+
+
+#ifndef _RGB_H_
+#define _RGB_H_
+
+typedef struct {
+    unsigned char R;
+    unsigned char G;
+    unsigned char B;
+    unsigned char A;
+} RGBA;
+
+
+int color2RGBA(const char *color, RGBA * C);
+
+#endif
diff -urN lcd4linux-0.10.0/stamp-h.in lcd4linux-0.11.0-SVN/stamp-h.in
--- lcd4linux-0.10.0/stamp-h.in	2005-06-11 06:14:50.000000000 +0200
+++ lcd4linux-0.11.0-SVN/stamp-h.in	1970-01-01 01:00:00.000000000 +0100
@@ -1 +0,0 @@
-timestamp
diff -urN lcd4linux-0.10.0/svn_version.h lcd4linux-0.11.0-SVN/svn_version.h
--- lcd4linux-0.10.0/svn_version.h	1970-01-01 01:00:00.000000000 +0100
+++ lcd4linux-0.11.0-SVN/svn_version.h	2009-01-14 12:20:41.000000000 +0100
@@ -0,0 +1 @@
+#define SVN_VERSION "965"
diff -urN lcd4linux-0.10.0/svn_version.sh lcd4linux-0.11.0-SVN/svn_version.sh
--- lcd4linux-0.10.0/svn_version.sh	1970-01-01 01:00:00.000000000 +0100
+++ lcd4linux-0.11.0-SVN/svn_version.sh	2008-12-31 08:06:27.000000000 +0100
@@ -0,0 +1,15 @@
+#!/bin/sh
+
+# $Id: svn_version.sh 756 2007-01-23 04:38:43Z michael $
+# $URL: https://ssl.bulix.org/svn/lcd4linux/trunk/svn_version.sh $
+
+
+OLD_VERSION=`cat svn_version.h 2>/dev/null`
+
+if [ -d .svn ]; then
+    NEW_VERSION="#define SVN_VERSION \"`svnversion -n`\""
+fi
+
+if [ "$NEW_VERSION" != "$OLD_VERSION" ]; then
+    echo $NEW_VERSION >svn_version.h
+fi
diff -urN lcd4linux-0.10.0/thread.c lcd4linux-0.11.0-SVN/thread.c
--- lcd4linux-0.10.0/thread.c	2005-05-08 06:32:45.000000000 +0200
+++ lcd4linux-0.11.0-SVN/thread.c	2008-12-31 08:05:54.000000000 +0100
@@ -1,8 +1,9 @@
-/* $Id: thread.c,v 1.7 2005/05/08 04:32:45 reinelt Exp $
+/* $Id: thread.c 840 2007-09-09 12:17:42Z michael $
+ * $URL: https://ssl.bulix.org/svn/lcd4linux/trunk/thread.c $
  *
  * thread handling (mutex, shmem, ...)
  *
- * Copyright (C) 2004 Michael Reinelt <reinelt@eunet.at>
+ * Copyright (C) 2004 Michael Reinelt <michael@reinelt.co.at>
  * Copyright (C) 2004 The LCD4Linux Team <lcd4linux-devel@users.sourceforge.net>
  *
  * parts of this code are based on the old XWindow driver which is
@@ -24,35 +25,6 @@
  * along with this program; if not, write to the Free Software
  * Foundation, Inc., 675 Mass Ave, Cambridge, MA 02139, USA.
  *
- *
- * $Log: thread.c,v $
- * Revision 1.7  2005/05/08 04:32:45  reinelt
- * CodingStyle added and applied
- *
- * Revision 1.6  2005/01/18 06:30:23  reinelt
- * added (C) to all copyright statements
- *
- * Revision 1.5  2004/06/20 10:09:56  reinelt
- *
- * 'const'ified the whole source
- *
- * Revision 1.4  2004/06/01 06:45:30  reinelt
- *
- * some Fixme's processed
- * documented some code
- *
- * Revision 1.3  2004/04/08 10:48:25  reinelt
- * finished plugin_exec
- * modified thread handling
- * added '%x' format to qprintf (hexadecimal)
- *
- * Revision 1.2  2004/03/20 07:31:33  reinelt
- * support for HD66712 (which has a different RAM layout)
- * further threading development
- *
- * Revision 1.1  2004/03/19 06:37:47  reinelt
- * asynchronous thread handling started
- *
  */
 
 /* 
@@ -105,6 +77,10 @@
 #endif
 
 
+int thread_argc;
+char **thread_argv;
+
+
 /* glibc 2.1 requires defining semun ourselves */
 #ifdef _SEM_SEMUN_UNDEFINED
 union semun {
@@ -199,6 +175,9 @@
 	return -1;
     case 0:
 	info("thread %s starting...", name);
+	if (thread_argc > 0) {
+	    strncpy(thread_argv[0], name, strlen(thread_argv[0]));
+	}
 	thread(data);
 	info("thread %s ended.", name);
 	exit(0);
@@ -208,3 +187,9 @@
 
     return pid;
 }
+
+
+int thread_destroy(const int pid)
+{
+    return kill(pid, SIGKILL);
+}
diff -urN lcd4linux-0.10.0/thread.h lcd4linux-0.11.0-SVN/thread.h
--- lcd4linux-0.10.0/thread.h	2005-05-08 06:32:45.000000000 +0200
+++ lcd4linux-0.11.0-SVN/thread.h	2008-12-31 08:05:54.000000000 +0100
@@ -1,8 +1,9 @@
-/* $Id: thread.h,v 1.6 2005/05/08 04:32:45 reinelt Exp $
+/* $Id: thread.h 840 2007-09-09 12:17:42Z michael $
+ * $URL: https://ssl.bulix.org/svn/lcd4linux/trunk/thread.h $
  *
  * thread handling (mutex, shmem, ...)
  *
- * Copyright (C) 2004 Michael Reinelt <reinelt@eunet.at>
+ * Copyright (C) 2004 Michael Reinelt <michael@reinelt.co.at>
  * Copyright (C) 2004 The LCD4Linux Team <lcd4linux-devel@users.sourceforge.net>
  *
  * parts of this code are based on the old XWindow driver which is
@@ -24,35 +25,15 @@
  * along with this program; if not, write to the Free Software
  * Foundation, Inc., 675 Mass Ave, Cambridge, MA 02139, USA.
  *
- *
- * $Log: thread.h,v $
- * Revision 1.6  2005/05/08 04:32:45  reinelt
- * CodingStyle added and applied
- *
- * Revision 1.5  2005/01/18 06:30:24  reinelt
- * added (C) to all copyright statements
- *
- * Revision 1.4  2004/06/20 10:09:56  reinelt
- *
- * 'const'ified the whole source
- *
- * Revision 1.3  2004/04/08 10:48:25  reinelt
- * finished plugin_exec
- * modified thread handling
- * added '%x' format to qprintf (hexadecimal)
- *
- * Revision 1.2  2004/03/20 07:31:33  reinelt
- * support for HD66712 (which has a different RAM layout)
- * further threading development
- *
- * Revision 1.1  2004/03/19 06:37:47  reinelt
- * asynchronous thread handling started
- *
  */
 
 #ifndef _THREAD_H_
 #define _THREAD_H_
 
+
+extern int thread_argc;
+extern char **thread_argv;
+
 int mutex_create(void);
 void mutex_lock(const int semid);
 void mutex_unlock(const int semid);
@@ -62,5 +43,6 @@
 void shm_destroy(const int shmid, const void *buffer);
 
 int thread_create(const char *name, void (*thread) (void *data), void *data);
+int thread_destroy(const int pid);
 
 #endif
diff -urN lcd4linux-0.10.0/timer.c lcd4linux-0.11.0-SVN/timer.c
--- lcd4linux-0.10.0/timer.c	2005-05-08 06:32:45.000000000 +0200
+++ lcd4linux-0.11.0-SVN/timer.c	2008-12-31 08:05:54.000000000 +0100
@@ -1,8 +1,9 @@
-/* $Id: timer.c,v 1.13 2005/05/08 04:32:45 reinelt Exp $
+/* $Id: timer.c 840 2007-09-09 12:17:42Z michael $
+ * $URL: https://ssl.bulix.org/svn/lcd4linux/trunk/timer.c $
  *
  * generic timer handling
  *
- * Copyright (C) 2003, 2004 Michael Reinelt <reinelt@eunet.at>
+ * Copyright (C) 2003, 2004 Michael Reinelt <michael@reinelt.co.at>
  * Copyright (C) 2004 The LCD4Linux Team <lcd4linux-devel@users.sourceforge.net>
  *
  * This program is free software; you can redistribute it and/or modify
@@ -19,61 +20,6 @@
  * along with this program; if not, write to the Free Software
  * Foundation, Inc., 675 Mass Ave, Cambridge, MA 02139, USA.
  *
- *
- * $Log: timer.c,v $
- * Revision 1.13  2005/05/08 04:32:45  reinelt
- * CodingStyle added and applied
- *
- * Revision 1.12  2005/01/18 06:30:24  reinelt
- * added (C) to all copyright statements
- *
- * Revision 1.11  2004/09/19 09:31:19  reinelt
- * HD44780 busy flag checking improved: fall back to busy-waiting if too many errors occur
- *
- * Revision 1.10  2004/06/26 12:05:00  reinelt
- *
- * uh-oh... the last CVS log message messed up things a lot...
- *
- * Revision 1.9  2004/06/26 09:27:21  reinelt
- *
- * added '-W' to CFLAGS
- * changed all C++ comments to C ones
- * cleaned up a lot of signed/unsigned mistakes
- *
- * Revision 1.8  2004/06/20 10:09:56  reinelt
- *
- * 'const'ified the whole source
- *
- * Revision 1.7  2004/06/01 06:45:30  reinelt
- *
- * some Fixme's processed
- * documented some code
- *
- * Revision 1.6  2004/03/03 04:44:16  reinelt
- * changes (cosmetics?) to the big patch from Martin
- * hash patch un-applied
- *
- * Revision 1.5  2004/03/03 03:47:04  reinelt
- * big patch from Martin Hejl:
- * - use qprintf() where appropriate
- * - save CPU cycles on gettimeofday()
- * - add quit() functions to free allocated memory
- * - fixed lots of memory leaks
- *
- * Revision 1.4  2004/01/30 20:57:56  reinelt
- * HD44780 patch from Martin Hejl
- * dmalloc integrated
- *
- * Revision 1.3  2004/01/29 04:40:03  reinelt
- * every .c file includes "config.h" now
- *
- * Revision 1.2  2004/01/18 09:01:45  reinelt
- * /proc/stat parsing finished
- *
- * Revision 1.1  2004/01/13 08:18:20  reinelt
- * timer queues added
- * liblcd4linux deactivated turing transformation to new layout
- *
  */
 
 /* 
diff -urN lcd4linux-0.10.0/timer.h lcd4linux-0.11.0-SVN/timer.h
--- lcd4linux-0.10.0/timer.h	2005-05-08 06:32:45.000000000 +0200
+++ lcd4linux-0.11.0-SVN/timer.h	2008-12-31 08:05:54.000000000 +0100
@@ -1,8 +1,9 @@
-/* $Id: timer.h,v 1.6 2005/05/08 04:32:45 reinelt Exp $
+/* $Id: timer.h 840 2007-09-09 12:17:42Z michael $
+ * $URL: https://ssl.bulix.org/svn/lcd4linux/trunk/timer.h $
  *
  * generic timer handling
  *
- * Copyright (C) 2003, 2004 Michael Reinelt <reinelt@eunet.at>
+ * Copyright (C) 2003, 2004 Michael Reinelt <michael@reinelt.co.at>
  * Copyright (C) 2004 The LCD4Linux Team <lcd4linux-devel@users.sourceforge.net>
  *
  * This file is part of LCD4Linux.
@@ -21,34 +22,6 @@
  * along with this program; if not, write to the Free Software
  * Foundation, Inc., 675 Mass Ave, Cambridge, MA 02139, USA.
  *
- *
- * $Log: timer.h,v $
- * Revision 1.6  2005/05/08 04:32:45  reinelt
- * CodingStyle added and applied
- *
- * Revision 1.5  2005/01/18 06:30:24  reinelt
- * added (C) to all copyright statements
- *
- * Revision 1.4  2004/06/20 10:09:56  reinelt
- *
- * 'const'ified the whole source
- *
- * Revision 1.3  2004/06/01 06:45:30  reinelt
- *
- * some Fixme's processed
- * documented some code
- *
- * Revision 1.2  2004/03/03 03:47:04  reinelt
- * big patch from Martin Hejl:
- * - use qprintf() where appropriate
- * - save CPU cycles on gettimeofday()
- * - add quit() functions to free allocated memory
- * - fixed lots of memory leaks
- *
- * Revision 1.1  2004/01/13 08:18:20  reinelt
- * timer queues added
- * liblcd4linux deactivated turing transformation to new layout
- *
  */
 
 
diff -urN lcd4linux-0.10.0/TODO lcd4linux-0.11.0-SVN/TODO
--- lcd4linux-0.10.0/TODO	2004-01-26 06:08:49.000000000 +0100
+++ lcd4linux-0.11.0-SVN/TODO	2008-12-31 08:05:54.000000000 +0100
@@ -1,177 +1,5 @@
-ToDo-List / Wishlist for lcd4linux
-
-// 2000-04-04 Michael Reinelt <reinelt@eunet.at>
-// implement some sort of 'graphs', similar to bars, but with a time axis
-// can be filled (made up of bars) or not (needs raster graphics)
-// done 2001-03-16 -lt.
-
-// 2000-04-04 Michael Reinelt <reinelt@eunet.at>
-// write a driver for PNG. This should be the first step towards a WWW-driver.
-// Done 2001-03-01 -lt.
-
-2000-04-15 Thomas Skyt Jessen <thskyt@foni.net>
-show partition information (used, free, ...)
-
-2000-04-25 Michael Mueller <m.mueller@netsystec.de>
-show process information            
-
-// 2000-12-03 Ghassan Matar <gmatar@hexapods.com>
-// show other sensors than temperature
-// we have to use libsensors instead of parsing the proc files directly
-// Refused 2003-08-01 -mr
-
-// 2000-12-03 Ghassan Matar <gmatar@hexapods.com>
-// show contents of any text file
-// the file should only contain one line, with a fixed format
-// there are two possibilities: text and numbers
-// numbers can be used for bars, too
-// Done 2000-03-08, look at %x -lt
-
-// 2000-12-03 Ghassan Matar <gmatar@hexapods.com>
-// accept data from external sources (fifo?)
-// Done 2000-03-08, look at %x -lt
-
-// 2001-02-11 Carsten Nau <info@cnau.de>
-// connect a LED to a spare pin of the parallel port and show if ISDN
-// is online
-// Done with GPO's -mr
-
-// 2001-01-27 Axel Ehnert <axel@ehnert.net>
-// - display numer of emails in a mailbox
-// - display seti@home values
-// done.
-
-// 2001-03-05 Leo Ttsch <lt@toetsch.at>
-// rename some tokens: %o->%os, %v->%ov, %r->%or, %p->%op,
-// will be done with the big config-rework
-// done with the "Next Generation Layout"
-
-// 2001-03-05 Leo Ttsch <lt@toetsch.at>
-// replace T_EXTENDED with a Flag similar to 'bar'
-// rejected, T_EXTENDED does a good job  -mr
-
-// 2001-03-07 Michael Reinelt <reinelt@eunet.at>
-// use ppdev instead of ugly outb()
-// done 2001-03-14 -mr
-
-// 2001-03-09 Michael Reinelt <reinelt@eunet.at>
-// replace udelay() assembly loop with rdtsc (read time stamp counter)
-// at least try to....
-// done 2001-03-14 -mr
-
-// 2001-03-09 Leo Ttsch <lt@toetsch.at>
-// read configuration file earlier (before forking) so that specific drivers
-// (especially 'Text') would not fork.
-// There's a reason for forking that early, but I forgot...
-// done somewhere in mid 2003 MR
-
-// 2001-03-12 Michael Reinelt <reinelt@eunet.at>
-// remove USE_OLD_UDELAY after wide testing of new udelay code
-// done with the "Next Generation Layout"
-
-// 2001-03-12 Michael Reinelt <reinelt@eunet.at>
-// create a NEWS file with changes/enhancements of every release
-// done 2001-03-13 -mr
-
-2001-03-14 Leopold Toetsch <lt@toetsch.at>
-improve unseen for mbox (check Status:)
-
-// 2001-03-14 Michael Reinelt <reinelt@eunet.at>
-// add a new Token 'nc' for 'network collisions'
-// done with the "Next Generation Layout"
-
-2001-03-14 Michael Reinelt <reinelt@eunet.at>
-add translation tables ('german umlauts' don't 
-follow any scheme on most displays)
-
-// 2001-03-15 Leopold Toetsch <lt@toetsch.at>
-// Text display has troubles with '\r'
-// done 2001-03-16, replace \r,\n with '_'  -lt
-
-// 2001-03-24 Carsten Nau <info@cnau.de>
-// change network clients to support different devices
-// at the moment the sum of all eth* devices is calculated
-// %n* should be extended tokens
-// done with the "Next Generation Layout"
-
-// 2001-03-24 Brian Cleven <lcleven@home.com>
-// support 40x4 displays with two HD44780 chips on it
-// we need another 'Enable' line for this
-// this way one could connect two displays to one parallel port, too
-// done with 0.9.11 MR
-
-// 2001-05-25 Jens Garthe <outline@xslan.de>
-// detect wether curses.h and libncurses is installed, and
-// don't include the 'Text'-driver if not.
-// _should_ work now 2001-05-31 -lt
-
-// 2001-09-11 Michael Reinelt <reinelt@eunet.at>
-// use new extended tokens to split up several data sources
-// (CPU, Net, Disk, ISDN, ...)
-// e.g. '%nw'  is 'network transmit' for _all_ devices
-//     '%n0w' is 'network transmit' for eth0
-//     '%n1w' for eth1
-// done with the "Next Generation Layout"
-
-// 2001-09-11 Michael Reinelt <reinelt@eunet.at>
-// remove bar code from drivers and create a common bar library
-// done somewhere in 2003 -mr
-
-// 2001-09-12 Carsten Nau <info@cnau.de>
-// make the output for emails shorter (at the moment up to 9999 emails)
-// done with the "Next Generation Layout" 
-
-2001-09-13 Michael Reinelt <reinelt@eunet.at>
-combine mail.c and mail2.c
-if there's an error getting mail info, display "?" instead of "0"
-
-2001-09-14 Michael Reinelt <reinelt@eunet.at>
-do not disable mail check in first error
-instead use a number of retries
-errors can occur in case of short disconnects, but normal operation 
-should resume 
-
-2002-02-15 Udo Altmann (udo.altmann@web.de)
-support for inversed/blinking text
-don't know if displays support this feature...
-
-// 2003-09-08 Michael Reinelt (reinelt@eunet.at>
-// at least one of my HD44780 displays use an inverted "P" instead of 
-// a full block. Therefore a bar my look strange. Make the ASCII code
-// of the full block configurable...
-// done with the "Next Generation Layout"
-// see the "asc255bug" attribute
-
-// 2003-09-14 Markus <markus@norad.de>
-// change %t tokens from Byte/sec to kB/sec, ith one decimal places. 
-// Either make it configurabel, or add new tokens.
-// done with the "Next Generation Layout"
-
-// 2003-10-29 Matt Thrailkill <xwred1@modestolan.com>
-// > To go off on another tangent... have you at all considered some sort of
-// > marquee support?  I toyed with the row scrolling support which was
-// > recently added, and it is nifty.  But marquees would be handy for doing
-// > something like horizontally scrolling, say, the title of the currently
-// > playing mp3.  I've toyed with trying to dive in and add it, but I'm a
-// > pretty lazy guy and haven't done it.  What do you think?
-// done with the "Next Generation Layout"
-
-2003-12-31 Stefan ???  <nef17@gmx.net>
-add support for software-controlled backlight for HD44780
-http://www.jalcds.de/images/4x20backlight.gif
-
-2004-01-25 Michael Reinelt <reinelt@eunet.at>
-add attribute "blinking" to text widgets
-
-2004-01-25 Xavier VELLO <xavier66@free.fr>
-add "inverse" attribute to text widget
-possible with Cwlinux and all graphics displays
-
-2004-01-25 Xavier VELLO <xavier66@free.fr>
-add an "image" widget
-
-2004-01-25 Xavier VELLO <xavier66@free.fr>
-icons should not only be updated regularly, but shown only when 
-a certain expression returns 1
-
+# $Id: TODO 730 2007-01-14 13:50:28Z michael $
+# $URL: https://ssl.bulix.org/svn/lcd4linux/trunk/TODO $
 
+Sorry, there is no TODO anymore.
+Go to http://lcd4linux.bulix.org for all the documentation.
diff -urN lcd4linux-0.10.0/udelay.c lcd4linux-0.11.0-SVN/udelay.c
--- lcd4linux-0.10.0/udelay.c	2005-05-08 06:32:45.000000000 +0200
+++ lcd4linux-0.11.0-SVN/udelay.c	2008-12-31 08:05:54.000000000 +0100
@@ -1,8 +1,9 @@
-/* $Id: udelay.c,v 1.20 2005/05/08 04:32:45 reinelt Exp $
+/* $Id: udelay.c 844 2007-10-01 15:49:21Z michael $
+ * $URL: https://ssl.bulix.org/svn/lcd4linux/trunk/udelay.c $
  *
  * short delays
  *
- * Copyright (C) 1999, 2000 Michael Reinelt <reinelt@eunet.at>
+ * Copyright (C) 1999, 2000 Michael Reinelt <michael@reinelt.co.at>
  * Copyright (C) 2004 The LCD4Linux Team <lcd4linux-devel@users.sourceforge.net>
  *
  * This file is part of LCD4Linux.
@@ -21,112 +22,25 @@
  * along with this program; if not, write to the Free Software
  * Foundation, Inc., 675 Mass Ave, Cambridge, MA 02139, USA.
  *
- *
- * $Log: udelay.c,v $
- * Revision 1.20  2005/05/08 04:32:45  reinelt
- * CodingStyle added and applied
- *
- * Revision 1.19  2005/01/18 06:30:24  reinelt
- * added (C) to all copyright statements
- *
- * Revision 1.18  2004/09/18 09:48:29  reinelt
- * HD44780 cleanup and prepararation for I2C backend
- * LCM-162 submodel framework
- *
- * Revision 1.17  2004/06/20 10:09:56  reinelt
- *
- * 'const'ified the whole source
- *
- * Revision 1.16  2004/04/12 05:14:42  reinelt
- * another BIG FAT WARNING on the use of raw ports instead of ppdev
- *
- * Revision 1.15  2004/04/12 04:56:00  reinelt
- * emitted a BIG FAT WARNING if msr.h could not be found (and therefore
- * the gettimeofday() delay loop would be used)
- *
- * Revision 1.14  2003/10/12 04:46:19  reinelt
- *
- *
- * first try to integrate the Evaluator into a display driver (MatrixOrbital here)
- * small warning in processor.c fixed (thanks to Zachary Giles)
- * workaround for udelay() on alpha (no msr.h avaliable) (thanks to Zachary Giles)
- *
- * Revision 1.13  2003/10/05 17:58:50  reinelt
- * libtool junk; copyright messages cleaned up
- *
- * Revision 1.12  2003/07/18 04:43:14  reinelt
- * udelay: unnecessary sanity check removed
- *
- * Revision 1.11  2003/04/04 06:02:04  reinelt
- * new parallel port abstraction scheme
- *
- * Revision 1.10  2003/02/27 07:43:11  reinelt
- *
- * asm/msr.h: included hard-coded definition of rdtscl() if msr.h cannot be found.
- *
- * autoconf/automake/autoanything: switched back to 1.4. Hope it works again.
- *
- * Revision 1.9  2002/08/21 06:09:53  reinelt
- * some T6963 fixes, ndelay wrap
- *
- * Revision 1.8  2002/08/17 14:14:21  reinelt
- *
- * USBLCD fixes
- *
- * Revision 1.7  2002/04/29 11:00:28  reinelt
- *
- * added Toshiba T6963 driver
- * added ndelay() with nanosecond resolution
- *
- * Revision 1.6  2001/08/08 05:40:24  reinelt
- *
- * renamed CLK_TCK to CLOCKS_PER_SEC
- *
- * Revision 1.5  2001/03/12 13:44:58  reinelt
- *
- * new udelay() using Time Stamp Counters
- *
- * Revision 1.4  2001/03/12 12:39:36  reinelt
- *
- * reworked autoconf a lot: drivers may be excluded, #define's went to config.h
- *
- * Revision 1.3  2001/03/01 22:33:50  reinelt
- *
- * renamed Raster_flush() to PPM_flush()
- *
- * Revision 1.2  2000/07/31 10:43:44  reinelt
- *
- * some changes to support kernel-2.4 (different layout of various files in /proc)
- *
- * Revision 1.1  2000/04/15 16:56:52  reinelt
- *
- * moved delay loops to udelay.c
- * renamed -d (debugging) switch to -v (verbose)
- * new switch -d to calibrate delay loop
- * 'Delay' entry for HD44780 back again
- * delay loops will not calibrate automatically, because this will fail with hich CPU load
- *
  */
 
 /* 
  *
  * exported fuctions:
  *
- * void udelay (unsigned long usec)
- *  delays program execution for usec microseconds
- *  uses global variable 'loops_per_usec', which has to be set before.
- *  This function does busy-waiting! so use only for delays smaller
- *  than 10 msec
- *
- * void udelay_calibrate (void) (if USE_OLD_UDELAY is defined)
- *   does a binary approximation for 'loops_per_usec'
- *   should be called several times on an otherwise idle machine
- *   the maximum value should be used
- *
  * void udelay_init (void)
  *   selects delay method (gettimeofday() ord rdtsc() according
  *   to processor features
  *
+ * unsigned long timing (const char *driver, const char *section, const char *name, const int defval, const char *unit);
+ *   returns a timing value from config or the default value
+ *
+ * void udelay (unsigned long usec)
+ *   delays program execution for usec microseconds
+ *   uses global variable 'loops_per_usec', which has to be set before.
+ *   This function does busy-waiting! so use only for delays smaller
+ *   than 10 msec
+ *
  */
 
 #include "config.h"
@@ -134,12 +48,6 @@
 #include <stdio.h>
 
 
-#ifdef USE_OLD_UDELAY
-
-#include <time.h>
-
-#else
-
 #include <math.h>
 #include <unistd.h>
 #include <fcntl.h>
@@ -147,172 +55,60 @@
 #include <string.h>
 #include <sys/time.h>
 
-#ifdef HAVE_ASM_MSR_H
-#include <asm/msr.h>
-#endif
-
-#endif
-
 
 #include "debug.h"
+#include "cfg.h"
+#include "qprintf.h"
 #include "udelay.h"
 
-#ifdef USE_OLD_UDELAY
 
-unsigned long loops_per_usec;
 
-void ndelay(const unsigned long nsec)
+void udelay_init(void)
 {
-    unsigned long loop = (nsec * loops_per_usec + 999) / 1000;
-
-  __asm__(".align 16\n" "1:\tdecl %0\n" "\tjne 1b":	/* no result */
-  :"a"(loop));
+    info("udelay: using gettimeofday() delay loop");
 }
 
-/* adopted from /usr/src/linux/init/main.c */
 
-void udelay_calibrate(void)
+unsigned long timing(const char *driver, const char *section, const char *name, const int defval, const char *unit)
 {
-    clock_t tick;
-    unsigned long bit;
+    char sec[256];
+    int fuzz, val;
 
-    loops_per_usec = 1;
-    while (loops_per_usec <<= 1) {
-	tick = clock();
-	while (clock() == tick);
-	tick = clock();
-	ndelay(1000000000 / CLOCKS_PER_SEC);
-	if (clock() > tick)
-	    break;
-    }
+    qprintf(sec, sizeof(sec), "%s.Timing", section);
 
-    loops_per_usec >>= 1;
-    bit = loops_per_usec;
-    while (bit >>= 1) {
-	loops_per_usec |= bit;
-	tick = clock();
-	while (clock() == tick);
-	tick = clock();
-	ndelay(1000000000 / CLOCKS_PER_SEC);
-	if (clock() > tick)
-	    loops_per_usec &= ~bit;
-    }
-}
+    /* fuzz all timings by given factor */
+    cfg_number(sec, "fuzz", 100, 1, -1, &fuzz);
 
-#else
+    cfg_number(sec, name, defval, 0, -1, &val);
+    val = val * fuzz / 100;
 
-static unsigned int ticks_per_usec = 0;
-
-static void getCPUinfo(int *hasTSC, double *MHz)
-{
-    int fd;
-    char buffer[4096], *p;
-
-    *hasTSC = 0;
-    *MHz = -1;
-
-    fd = open("/proc/cpuinfo", O_RDONLY);
-    if (fd == -1) {
-	error("udelay: open(/proc/cpuinfo) failed: %s", strerror(errno));
-	return;
-    }
-    if (read(fd, &buffer, sizeof(buffer) - 1) == -1) {
-	error("udelay: read(/proc/cpuinfo) failed: %s", strerror(errno));
-	close(fd);
-	return;
-    }
-    close(fd);
-
-    p = strstr(buffer, "flags");
-    if (p == NULL) {
-	info("udelay: /proc/cpuinfo has no 'flags' line");
-    } else {
-	p = strstr(p, "tsc");
-	if (p == NULL) {
-	    info("udelay: CPU does not support Time Stamp Counter");
+    if (val != defval) {
+	if (fuzz != 100) {
+	    info("%s: timing: %6s = %5d %s (default %d %s, fuzz %d)", driver, name, val, unit, defval, unit, fuzz);
 	} else {
-	    info("udelay: CPU supports Time Stamp Counter");
-	    *hasTSC = 1;
+	    info("%s: timing: %6s = %5d %s (default %d %s)", driver, name, val, unit, defval, unit);
 	}
-    }
-
-    p = strstr(buffer, "cpu MHz");
-    if (p == NULL) {
-	info("udelay: /proc/cpuinfo has no 'cpu MHz' line");
     } else {
-	if (sscanf(p + 7, " : %lf", MHz) != 1) {
-	    error("udelay: parse(/proc/cpuinfo) failed: unknown 'cpu MHz' format");
-	    *MHz = -1;
-	} else {
-	    info("udelay: CPU runs at %f MHz", *MHz);
-	}
-    }
-
-}
-
-
-void udelay_init(void)
-{
-#ifdef HAVE_ASM_MSR_H
-
-    int tsc;
-    double mhz;
-
-    getCPUinfo(&tsc, &mhz);
-
-    if (tsc && mhz > 0.0) {
-	ticks_per_usec = ceil(mhz);
-	info("udelay: using TSC delay loop, %u ticks per microsecond", ticks_per_usec);
-    } else
-#else
-    error("udelay: The file 'include/asm/msr.h' was missing at compile time.");
-    error("udelay: Even if your CPU supports TSC, it will not be used!");
-    error("udelay: You *really* should install msr.h and recompile LCD4linux!");
-#endif
-
-    {
-	ticks_per_usec = 0;
-	info("udelay: using gettimeofday() delay loop");
+	info("%s: timing: %6s = %5d %s (default)", driver, name, defval, unit);
     }
+    return val;
 }
 
 
 void ndelay(const unsigned long nsec)
 {
 
-#ifdef HAVE_ASM_MSR_H
+    struct timeval now, end;
 
-    if (ticks_per_usec) {
-
-	unsigned int t1, t2;
-	unsigned long tsc;
-
-	tsc = (nsec * ticks_per_usec + 999) / 1000;
-
-	rdtscl(t1);
-	do {
-	    rep_nop();
-	    rdtscl(t2);
-	} while ((t2 - t1) < tsc);
-
-    } else
-#endif
-
-    {
-	struct timeval now, end;
-
-	gettimeofday(&end, NULL);
-	end.tv_usec += (nsec + 999) / 1000;
-	while (end.tv_usec > 1000000) {
-	    end.tv_usec -= 1000000;
-	    end.tv_sec++;
-	}
-
-	do {
-	    rep_nop();
-	    gettimeofday(&now, NULL);
-	} while (now.tv_sec == end.tv_sec ? now.tv_usec < end.tv_usec : now.tv_sec < end.tv_sec);
+    gettimeofday(&end, NULL);
+    end.tv_usec += (nsec + 999) / 1000;
+    while (end.tv_usec > 1000000) {
+	end.tv_usec -= 1000000;
+	end.tv_sec++;
     }
-}
 
-#endif
+    do {
+	rep_nop();
+	gettimeofday(&now, NULL);
+    } while (now.tv_sec == end.tv_sec ? now.tv_usec < end.tv_usec : now.tv_sec < end.tv_sec);
+}
diff -urN lcd4linux-0.10.0/udelay.h lcd4linux-0.11.0-SVN/udelay.h
--- lcd4linux-0.10.0/udelay.h	2005-05-08 06:32:45.000000000 +0200
+++ lcd4linux-0.11.0-SVN/udelay.h	2008-12-31 08:05:54.000000000 +0100
@@ -1,8 +1,9 @@
-/* $Id: udelay.h,v 1.10 2005/05/08 04:32:45 reinelt Exp $
+/* $Id: udelay.h 840 2007-09-09 12:17:42Z michael $
+ * $URL: https://ssl.bulix.org/svn/lcd4linux/trunk/udelay.h $
  *
  * short delays 
  *
- * Copyright (C) 1999, 2000 Michael Reinelt <reinelt@eunet.at>
+ * Copyright (C) 1999, 2000 Michael Reinelt <michael@reinelt.co.at>
  * Copyright (C) 2004 The LCD4Linux Team <lcd4linux-devel@users.sourceforge.net>
  *
  * This file is part of LCD4Linux.
@@ -21,52 +22,6 @@
  * along with this program; if not, write to the Free Software
  * Foundation, Inc., 675 Mass Ave, Cambridge, MA 02139, USA.
  *
- *
- * $Log: udelay.h,v $
- * Revision 1.10  2005/05/08 04:32:45  reinelt
- * CodingStyle added and applied
- *
- * Revision 1.9  2005/01/18 06:30:24  reinelt
- * added (C) to all copyright statements
- *
- * Revision 1.8  2004/06/26 12:05:00  reinelt
- *
- * uh-oh... the last CVS log message messed up things a lot...
- *
- * Revision 1.7  2004/06/26 09:27:21  reinelt
- *
- * added '-W' to CFLAGS
- * changed all C++ comments to C ones
- * cleaned up a lot of signed/unsigned mistakes
- *
- * Revision 1.6  2004/06/20 10:09:56  reinelt
- *
- * 'const'ified the whole source
- *
- * Revision 1.5  2003/10/05 17:58:50  reinelt
- * libtool junk; copyright messages cleaned up
- *
- * Revision 1.4  2002/04/29 11:00:28  reinelt
- *
- * added Toshiba T6963 driver
- * added ndelay() with nanosecond resolution
- *
- * Revision 1.3  2001/03/12 13:44:58  reinelt
- *
- * new udelay() using Time Stamp Counters
- *
- * Revision 1.2  2001/03/12 12:39:36  reinelt
- *
- * reworked autoconf a lot: drivers may be excluded, #define's went to config.h
- *
- * Revision 1.1  2000/04/15 16:56:52  reinelt
- *
- * moved delay loops to udelay.c
- * renamed -d (debugging) switch to -v (verbose)
- * new switch -d to calibrate delay loop
- * 'Delay' entry for HD44780 back again
- * delay loops will not calibrate automatically, because this will fail with high CPU load
- *
  */
 
 #ifndef _UDELAY_H_
@@ -76,21 +31,18 @@
 /* REP NOP (PAUSE) is a good thing to insert into busy-wait loops. */
 static inline void rep_nop(void)
 {
+# if defined(__i386) || defined(__i386__) || defined(__AMD64__) || defined(__x86_64__) || defined(__amd64__)
+    /* intel or amd64 arch, the "rep" and "nop" opcodes are available */
     __asm__ __volatile__("rep; nop");
+# else
+    /* other Arch, maybe add core cooldown code here, too. */
+    do {
+    } while (0);
+# endif
 }
 
-
-#ifdef USE_OLD_UDELAY
-
-extern unsigned long loops_per_usec;
-void udelay_calibrate(void);
-
-#else
-
 void udelay_init(void);
-
-#endif
-
+unsigned long timing(const char *driver, const char *section, const char *name, const int defval, const char *unit);
 void ndelay(const unsigned long nsec);
 
 #define udelay(usec) ndelay(usec*1000)
diff -urN lcd4linux-0.10.0/widget_bar.c lcd4linux-0.11.0-SVN/widget_bar.c
--- lcd4linux-0.10.0/widget_bar.c	2005-05-08 06:32:45.000000000 +0200
+++ lcd4linux-0.11.0-SVN/widget_bar.c	2009-01-01 09:06:54.000000000 +0100
@@ -1,8 +1,9 @@
-/* $Id: widget_bar.c,v 1.16 2005/05/08 04:32:45 reinelt Exp $
+/* $Id: widget_bar.c 934 2009-01-01 08:06:54Z michael $
+ * $URL: https://ssl.bulix.org/svn/lcd4linux/trunk/widget_bar.c $
  *
  * bar widget handling
  *
- * Copyright (C) 2003, 2004 Michael Reinelt <reinelt@eunet.at>
+ * Copyright (C) 2003, 2004 Michael Reinelt <michael@reinelt.co.at>
  * Copyright (C) 2004 The LCD4Linux Team <lcd4linux-devel@users.sourceforge.net>
  *
  * This program is free software; you can redistribute it and/or modify
@@ -19,76 +20,6 @@
  * along with this program; if not, write to the Free Software
  * Foundation, Inc., 675 Mass Ave, Cambridge, MA 02139, USA.
  *
- *
- * $Log: widget_bar.c,v $
- * Revision 1.16  2005/05/08 04:32:45  reinelt
- * CodingStyle added and applied
- *
- * Revision 1.15  2005/05/06 06:37:34  reinelt
- * hollow bar patch from geronet
- *
- * Revision 1.14  2005/01/18 06:30:24  reinelt
- * added (C) to all copyright statements
- *
- * Revision 1.13  2004/11/29 04:42:07  reinelt
- * removed the 99999 msec limit on widget update time (thanks to Petri Damsten)
- *
- * Revision 1.12  2004/06/26 12:05:00  reinelt
- *
- * uh-oh... the last CVS log message messed up things a lot...
- *
- * Revision 1.11  2004/06/26 09:27:21  reinelt
- *
- * added '-W' to CFLAGS
- * changed all C++ comments to C ones
- * cleaned up a lot of signed/unsigned mistakes
- *
- * Revision 1.10  2004/03/11 06:39:59  reinelt
- * big patch from Martin:
- * - reuse filehandles
- * - memory leaks fixed
- * - earlier busy-flag checking with HD44780
- * - reuse memory for strings in RESULT and hash
- * - netdev_fast to wavid time-consuming regex
- *
- * Revision 1.9  2004/03/06 20:31:16  reinelt
- * Complete rewrite of the evaluator to get rid of the code
- * from mark Morley (because of license issues).
- * The new Evaluator does a pre-compile of expressions, and
- * stores them in trees. Therefore it should be reasonable faster...
- *
- * Revision 1.8  2004/03/03 03:47:04  reinelt
- * big patch from Martin Hejl:
- * - use qprintf() where appropriate
- * - save CPU cycles on gettimeofday()
- * - add quit() functions to free allocated memory
- * - fixed lots of memory leaks
- *
- * Revision 1.7  2004/01/30 20:57:56  reinelt
- * HD44780 patch from Martin Hejl
- * dmalloc integrated
- *
- * Revision 1.6  2004/01/29 04:40:03  reinelt
- * every .c file includes "config.h" now
- *
- * Revision 1.5  2004/01/23 04:54:00  reinelt
- * icon widget added (not finished yet!)
- *
- * Revision 1.4  2004/01/20 14:25:12  reinelt
- * some reorganization
- * moved drv_generic to drv_generic_serial
- * moved port locking stuff to drv_generic_serial
- *
- * Revision 1.3  2004/01/20 12:45:47  reinelt
- * "Default screen" working with MatrixOrbital
- *
- * Revision 1.2  2004/01/20 04:51:39  reinelt
- * moved generic stuff from drv_MatrixOrbital to drv_generic
- * implemented new-stylish bars which are nearly finished
- *
- * Revision 1.1  2004/01/18 21:25:16  reinelt
- * Framework for bar widget opened
- *
  */
 
 /* 
@@ -109,7 +40,7 @@
 
 #include "debug.h"
 #include "cfg.h"
-#include "evaluator.h"
+#include "property.h"
 #include "timer.h"
 #include "widget.h"
 #include "widget_bar.h"
@@ -123,50 +54,52 @@
 {
     WIDGET *W = (WIDGET *) Self;
     WIDGET_BAR *Bar = W->data;
-    RESULT result = { 0, 0, 0, NULL };
 
     double val1, val2;
     double min, max;
 
-    /* evaluate expressions */
-    val1 = 0.0;
-    if (Bar->tree1 != NULL) {
-	Eval(Bar->tree1, &result);
-	val1 = R2N(&result);
-	DelResult(&result);
-    }
-
-    val2 = val1;
-    if (Bar->tree2 != NULL) {
-	Eval(Bar->tree2, &result);
-	val2 = R2N(&result);
-	DelResult(&result);
+    /* evaluate properties */
+    property_eval(&Bar->expression1);
+    val1 = P2N(&Bar->expression1);
+
+    if (property_valid(&Bar->expression2)) {
+	property_eval(&Bar->expression2);
+	val2 = P2N(&Bar->expression2);
+    } else {
+	val2 = val1;
     }
 
     /* minimum: if expression is empty, do auto-scaling */
-    if (Bar->tree_min != NULL) {
-	Eval(Bar->tree_min, &result);
-	min = R2N(&result);
-	DelResult(&result);
+    if (property_valid(&Bar->expr_min)) {
+	property_eval(&Bar->expr_min);
+	min = P2N(&Bar->expr_min);
     } else {
 	min = Bar->min;
-	if (val1 < min)
+	if (val1 < min) {
 	    min = val1;
-	if (val2 < min)
+	}
+	if (val2 < min) {
 	    min = val2;
+	}
     }
 
     /* maximum: if expression is empty, do auto-scaling */
-    if (Bar->tree_max != NULL) {
-	Eval(Bar->tree_max, &result);
-	max = R2N(&result);
-	DelResult(&result);
+    if (property_valid(&Bar->expr_max)) {
+	property_eval(&Bar->expr_max);
+	max = P2N(&Bar->expr_max);
     } else {
 	max = Bar->max;
-	if (val1 > max)
+	if (val1 > max) {
 	    max = val1;
-	if (val2 > max)
+	}
+	if (val2 > max) {
 	    max = val2;
+	}
+    }
+
+    /* debugging */
+    if (Bar->min != min || Bar->max != max) {
+	debug("Bar '%s': new scale %G - %G", W->name, min, max);
     }
 
     /* calculate bar values */
@@ -202,26 +135,17 @@
     Bar = malloc(sizeof(WIDGET_BAR));
     memset(Bar, 0, sizeof(WIDGET_BAR));
 
-    /* get raw expressions (we evaluate them ourselves) */
-    Bar->expression1 = cfg_get_raw(section, "expression", NULL);
-    Bar->expression2 = cfg_get_raw(section, "expression2", NULL);
-
-    /* sanity check */
-    if (Bar->expression1 == NULL || *Bar->expression1 == '\0') {
-	error("widget %s has no expression, using '0.0'", Self->name);
-	Bar->expression1 = "0";
+    /* load properties */
+    property_load(section, "expression", NULL, &Bar->expression1);
+    property_load(section, "expression2", NULL, &Bar->expression2);
+    property_load(section, "min", NULL, &Bar->expr_min);
+    property_load(section, "max", NULL, &Bar->expr_max);
+
+    /* sanity checks */
+    if (!property_valid(&Bar->expression1)) {
+	error("Warning: widget %s has no expression", section);
     }
 
-    /* minimum and maximum value */
-    Bar->expr_min = cfg_get_raw(section, "min", NULL);
-    Bar->expr_max = cfg_get_raw(section, "max", NULL);
-
-    /* compile all expressions */
-    Compile(Bar->expression1, &Bar->tree1);
-    Compile(Bar->expression2, &Bar->tree2);
-    Compile(Bar->expr_min, &Bar->tree_min);
-    Compile(Bar->expr_max, &Bar->tree_max);
-
     /* bar length, default 1 */
     cfg_number(section, "length", 1, 0, -1, &(Bar->length));
 
@@ -241,7 +165,8 @@
 	Bar->direction = DIR_SOUTH;
 	break;
     default:
-	error("widget %s has unknown direction '%s', using 'East'", Self->name, c);
+	error("widget %s has unknown direction '%s'; known directions: 'E', 'W', 'N', 'S'; using 'E(ast)'", Self->name,
+	      c);
 	Bar->direction = DIR_EAST;
     }
     free(c);
@@ -252,11 +177,16 @@
     case 'H':
 	Bar->style = STYLE_HOLLOW;
 	if (!(Bar->direction & (DIR_EAST | DIR_WEST))) {
-	    error("widget %s with style \"hollow\" not implemented", Self->name);
+	    error("widget %s with style \"hollow\" not implemented for other directions than E(ast) or W(est)",
+		  Self->name);
 	    Bar->style = 0;
 	}
 	break;
+    case '0':
+	Bar->style = 0;
+	break;
     default:
+	error("widget %s has unknown style '%s'; known styles: '0' or 'H'; using '0'", Self->name, c);
 	Bar->style = 0;
     }
     free(c);
@@ -264,6 +194,10 @@
     /* update interval (msec), default 1 sec */
     cfg_number(section, "update", 1000, 10, -1, &(Bar->update));
 
+    /* get widget special colors */
+    Bar->color_valid[0] = widget_color(section, Self->name, "barcolor0", &Bar->color[0]);
+    Bar->color_valid[1] = widget_color(section, Self->name, "barcolor1", &Bar->color[1]);
+
     free(section);
     Self->data = Bar;
 
@@ -278,10 +212,10 @@
     if (Self) {
 	if (Self->data) {
 	    WIDGET_BAR *Bar = Self->data;
-	    DelTree(Bar->tree1);
-	    DelTree(Bar->tree2);
-	    DelTree(Bar->tree_min);
-	    DelTree(Bar->tree_max);
+	    property_free(&Bar->expression1);
+	    property_free(&Bar->expression2);
+	    property_free(&Bar->expr_min);
+	    property_free(&Bar->expr_max);
 	    free(Self->data);
 	}
 	Self->data = NULL;
@@ -295,8 +229,9 @@
 
 
 WIDGET_CLASS Widget_Bar = {
-  name:"bar",
-  init:widget_bar_init,
-  draw:NULL,
-  quit:widget_bar_quit,
+    .name = "bar",
+    .type = WIDGET_TYPE_RC,
+    .init = widget_bar_init,
+    .draw = NULL,
+    .quit = widget_bar_quit,
 };
diff -urN lcd4linux-0.10.0/widget_bar.h lcd4linux-0.11.0-SVN/widget_bar.h
--- lcd4linux-0.10.0/widget_bar.h	2005-05-08 06:32:45.000000000 +0200
+++ lcd4linux-0.11.0-SVN/widget_bar.h	2008-12-31 08:05:54.000000000 +0100
@@ -1,8 +1,9 @@
-/* $Id: widget_bar.h,v 1.8 2005/05/08 04:32:45 reinelt Exp $
+/* $Id: widget_bar.h 840 2007-09-09 12:17:42Z michael $
+ * $URL: https://ssl.bulix.org/svn/lcd4linux/trunk/widget_bar.h $
  *
  * bar widget handling
  *
- * Copyright (C) 2003, 2004 Michael Reinelt <reinelt@eunet.at>
+ * Copyright (C) 2003, 2004 Michael Reinelt <michael@reinelt.co.at>
  * Copyright (C) 2004 The LCD4Linux Team <lcd4linux-devel@users.sourceforge.net>
  *
  * This file is part of LCD4Linux.
@@ -21,58 +22,22 @@
  * along with this program; if not, write to the Free Software
  * Foundation, Inc., 675 Mass Ave, Cambridge, MA 02139, USA.
  *
- *
- * $Log: widget_bar.h,v $
- * Revision 1.8  2005/05/08 04:32:45  reinelt
- * CodingStyle added and applied
- *
- * Revision 1.7  2005/05/06 06:37:34  reinelt
- * hollow bar patch from geronet
- *
- * Revision 1.6  2005/01/18 06:30:24  reinelt
- * added (C) to all copyright statements
- *
- * Revision 1.5  2004/06/26 12:05:00  reinelt
- *
- * uh-oh... the last CVS log message messed up things a lot...
- *
- * Revision 1.4  2004/06/26 09:27:21  reinelt
- *
- * added '-W' to CFLAGS
- * changed all C++ comments to C ones
- * cleaned up a lot of signed/unsigned mistakes
- *
- * Revision 1.3  2004/03/06 20:31:16  reinelt
- * Complete rewrite of the evaluator to get rid of the code
- * from mark Morley (because of license issues).
- * The new Evaluator does a pre-compile of expressions, and
- * stores them in trees. Therefore it should be reasonable faster...
- *
- * Revision 1.2  2004/01/20 04:51:39  reinelt
- * moved generic stuff from drv_MatrixOrbital to drv_generic
- * implemented new-stylish bars which are nearly finished
- *
- * Revision 1.1  2004/01/18 21:25:16  reinelt
- * Framework for bar widget opened
- *
  */
 
 
 #ifndef _WIDGET_BAR_H_
 #define _WIDGET_BAR_H_
 
+#include "property.h"
+
 typedef enum { DIR_EAST = 1, DIR_WEST = 2, DIR_NORTH = 4, DIR_SOUTH = 8 } DIRECTION;
 typedef enum { STYLE_HOLLOW = 1, STYLE_FIRST = 2, STYLE_LAST = 4 } STYLE;
 
 typedef struct WIDGET_BAR {
-    char *expression1;		/* expression that delivers the value */
-    char *expression2;		/* expression that delivers the value */
-    char *expr_min;		/* expression that delivers the minimum value */
-    char *expr_max;		/* expression that delivers the maximum value */
-    void *tree1;		/* pre-compiled expression that delivers the value */
-    void *tree2;		/* pre-compiled expression that delivers the value */
-    void *tree_min;		/* pre-compiled expression that delivers the minimum value */
-    void *tree_max;		/* pre-compiled expression that delivers the maximum value */
+    PROPERTY expression1;	/* value (length) of upper half */
+    PROPERTY expression2;	/* value (length) of lower half */
+    PROPERTY expr_min;		/* explicit minimum value */
+    PROPERTY expr_max;		/* explicit maximum value */
     DIRECTION direction;	/* bar direction */
     STYLE style;		/* bar style (hollow) */
     int length;			/* bar length */
@@ -81,6 +46,8 @@
     double val2;		/* bar value, 0.0 ... 1.0 */
     double min;			/* minimum value */
     double max;			/* maximum value */
+    RGBA color[2];		/* bar colors */
+    int color_valid[2];		/* bar color is valid */
 } WIDGET_BAR;
 
 
diff -urN lcd4linux-0.10.0/widget.c lcd4linux-0.11.0-SVN/widget.c
--- lcd4linux-0.10.0/widget.c	2005-05-08 06:32:45.000000000 +0200
+++ lcd4linux-0.11.0-SVN/widget.c	2008-12-31 08:05:54.000000000 +0100
@@ -1,8 +1,9 @@
-/* $Id: widget.c,v 1.19 2005/05/08 04:32:45 reinelt Exp $
+/* $Id: widget.c 925 2008-12-31 06:28:11Z michael $
+ * $URL: https://ssl.bulix.org/svn/lcd4linux/trunk/widget.c $
  *
  * generic widget handling
  *
- * Copyright (C) 2003, 2004 Michael Reinelt <reinelt@eunet.at>
+ * Copyright (C) 2003, 2004 Michael Reinelt <michael@reinelt.co.at>
  * Copyright (C) 2004 The LCD4Linux Team <lcd4linux-devel@users.sourceforge.net>
  *
  * This program is free software; you can redistribute it and/or modify
@@ -19,83 +20,6 @@
  * along with this program; if not, write to the Free Software
  * Foundation, Inc., 675 Mass Ave, Cambridge, MA 02139, USA.
  *
- *
- * $Log: widget.c,v $
- * Revision 1.19  2005/05/08 04:32:45  reinelt
- * CodingStyle added and applied
- *
- * Revision 1.18  2005/01/18 06:30:24  reinelt
- * added (C) to all copyright statements
- *
- * Revision 1.17  2004/06/26 12:05:00  reinelt
- *
- * uh-oh... the last CVS log message messed up things a lot...
- *
- * Revision 1.16  2004/06/26 09:27:21  reinelt
- *
- * added '-W' to CFLAGS
- * changed all C++ comments to C ones
- * cleaned up a lot of signed/unsigned mistakes
- *
- * Revision 1.15  2004/06/20 10:09:56  reinelt
- *
- * 'const'ified the whole source
- *
- * Revision 1.14  2004/05/26 11:37:36  reinelt
- *
- * Curses driver ported.
- *
- * Revision 1.13  2004/03/03 03:47:04  reinelt
- * big patch from Martin Hejl:
- * - use qprintf() where appropriate
- * - save CPU cycles on gettimeofday()
- * - add quit() functions to free allocated memory
- * - fixed lots of memory leaks
- *
- * Revision 1.12  2004/02/18 06:39:20  reinelt
- * T6963 driver for graphic displays finished
- *
- * Revision 1.11  2004/01/30 20:57:56  reinelt
- * HD44780 patch from Martin Hejl
- * dmalloc integrated
- *
- * Revision 1.10  2004/01/29 04:40:03  reinelt
- * every .c file includes "config.h" now
- *
- * Revision 1.9  2004/01/23 04:53:57  reinelt
- * icon widget added (not finished yet!)
- *
- * Revision 1.8  2004/01/14 11:33:00  reinelt
- * new plugin 'uname' which does what it's called
- * text widget nearly finished
- * first results displayed on MatrixOrbital
- *
- * Revision 1.7  2004/01/13 08:18:20  reinelt
- * timer queues added
- * liblcd4linux deactivated turing transformation to new layout
- *
- * Revision 1.6  2004/01/11 18:26:02  reinelt
- * further widget and layout processing
- *
- * Revision 1.5  2004/01/11 09:26:15  reinelt
- * layout starts to exist...
- *
- * Revision 1.4  2004/01/10 20:22:33  reinelt
- * added new function 'cfg_list()' (not finished yet)
- * added layout.c (will replace processor.c someday)
- * added widget_text.c (will be the first and most important widget)
- * modified lcd4linux.c so that old-style configs should work, too
- *
- * Revision 1.3  2004/01/10 17:34:40  reinelt
- * further matrixOrbital changes
- * widgets initialized
- *
- * Revision 1.2  2003/10/05 17:58:50  reinelt
- * libtool junk; copyright messages cleaned up
- *
- * Revision 1.1  2003/09/19 03:51:29  reinelt
- * minor fixes, widget.c added
- *
  */
 
 /* 
@@ -165,6 +89,8 @@
     int i;
     for (i = 0; i < nWidgets; i++) {
 	Widgets[i].class->quit(&(Widgets[i]));
+	if (Widgets[i].name)
+	    free(Widgets[i].name);
     }
     free(Widgets);
 
@@ -174,14 +100,45 @@
     nClasses = 0;
 }
 
-int widget_add(const char *name, const int row, const int col)
+int widget_color(const char *section, const char *name, const char *key, RGBA * C)
+{
+    char *color;
+
+    C->R = 0;
+    C->G = 0;
+    C->B = 0;
+    C->A = 0;
+
+    color = cfg_get(section, key, NULL);
+
+    if (color == NULL)
+	return 0;
+
+    if (*color == '\0') {
+	free(color);
+	return 0;
+    }
+
+    if (color2RGBA(color, C) < 0) {
+	error("widget '%s': ignoring illegal %s color '%s'", name, key, color);
+	free(color);
+	return 0;
+    }
+    free(color);
+    return 1;
+}
+
+int widget_add(const char *name, const int type, const int layer, const int row, const int col)
 {
     int i;
     char *section;
     char *class;
+    int fg_valid, bg_valid;
+    RGBA FG, BG;
 
     WIDGET_CLASS *Class;
     WIDGET *Widget;
+    WIDGET *Parent;
 
     /* prepare config section */
     /* strlen("Widget:")=7 */
@@ -195,9 +152,16 @@
 	error("error: widget '%s' has no class!", name);
 	if (class)
 	    free(class);
+	free(section);
 	return -1;
     }
+
+    /* get widget foreground color */
+    fg_valid = widget_color(section, name, "foreground", &FG);
+    bg_valid = widget_color(section, name, "background", &BG);
+
     free(section);
+
     /* lookup widget class */
     Class = NULL;
     for (i = 0; i < nClasses; i++) {
@@ -212,9 +176,31 @@
 	    free(class);
 	return -1;
     }
+
+    /* check if widget type matches */
+    if (Class->type != type) {
+	error("widget '%s': class '%s' not applicable", name, class);
+	switch (Class->type) {
+	case WIDGET_TYPE_RC:
+	    error("  Widgetclass %s is placed by Row/Column", class);
+	    break;
+	case WIDGET_TYPE_XY:
+	    error("  Widgetclass %s is placed by X/Y", class);
+	    break;
+	case WIDGET_TYPE_GPO:
+	case WIDGET_TYPE_TIMER:
+	case WIDGET_TYPE_KEYPAD:
+	default:
+	    error("  Widgetclass %s has unknown type %d", class, Class->type);
+	}
+	free(class);
+	return -1;
+    }
+
     if (class)
 	free(class);
 
+
     /* do NOT use realloc here because there may be pointers to the old */
     /* memory area, which would point to nowhere if realloc moves the area */
     if (Widgets == NULL) {
@@ -227,21 +213,59 @@
 
     /* another sanity check */
     if (nWidgets >= MAX_WIDGETS) {
-	error("internal error: widget buffer full!");
+	error("internal error: widget buffer full! Tried to allocate %d widgets (max: %d)", nWidgets, MAX_WIDGETS);
 	return -1;
     }
 
+    /* look up parent widget (widget with the same name) */
+    Parent = NULL;
+    for (i = 0; i < nWidgets; i++) {
+	if (strcmp(name, Widgets[i].name) == 0) {
+	    Parent = &(Widgets[i]);
+	    break;
+	}
+    }
+
     Widget = &(Widgets[nWidgets]);
     nWidgets++;
 
-    Widget->name = (char *) name;
+    Widget->name = strdup(name);
     Widget->class = Class;
+    Widget->parent = Parent;
+    Widget->fg_color = FG;
+    Widget->bg_color = BG;
+    Widget->fg_valid = fg_valid;
+    Widget->bg_valid = bg_valid;
+    Widget->layer = layer;
     Widget->row = row;
     Widget->col = col;
 
-    if (Class->init != 0) {
+    info(" widget '%s': Class '%s', Parent '%s', Layer %d, %s %d, %s %d",
+	 name, (NULL == Class) ? "<none>" : Class->name,
+	 (NULL == Parent) ? "<root>" : Parent->name,
+	 layer, (WIDGET_TYPE_XY == Class->type) ? "Y" : "Row", row, (WIDGET_TYPE_XY == Class->type) ? "X" : "Col", col);
+
+    if (Class->init != NULL) {
 	Class->init(Widget);
     }
 
     return 0;
 }
+
+/* return the found widget, or else NULL */
+WIDGET *widget_find(int type, void *needle)
+{
+    WIDGET *widget = NULL;
+    int i;
+
+    for (i = 0; i < nWidgets; i++) {
+	widget = &(Widgets[i]);
+	if (widget->class->type == type) {
+	    if (widget->class->find != NULL && widget->class->find(widget, needle) == 0)
+		break;
+	}
+	widget = NULL;
+    }
+
+    return widget;
+}
diff -urN lcd4linux-0.10.0/widget_gpo.c lcd4linux-0.11.0-SVN/widget_gpo.c
--- lcd4linux-0.10.0/widget_gpo.c	1970-01-01 01:00:00.000000000 +0100
+++ lcd4linux-0.11.0-SVN/widget_gpo.c	2008-12-31 08:05:54.000000000 +0100
@@ -0,0 +1,127 @@
+/* $Id: widget_gpo.c 840 2007-09-09 12:17:42Z michael $
+ * $URL: https://ssl.bulix.org/svn/lcd4linux/trunk/widget_gpo.c $
+ *
+ * GPO widget handling
+ *
+ * Copyright (C) 2005 Michael Reinelt <michael@reinelt.co.at>
+ * Copyright (C) 2005, 2006, 2007 The LCD4Linux Team <lcd4linux-devel@users.sourceforge.net>
+ *
+ * This program is free software; you can redistribute it and/or modify
+ * it under the terms of the GNU General Public License as published by
+ * the Free Software Foundation; either version 2, or (at your option)
+ * any later version.
+ *
+ * This program is distributed in the hope that it will be useful,
+ * but WITHOUT ANY WARRANTY; without even the implied warranty of
+ * MERCHANTABILITY or FITNESS FOR A PARTICULAR PURPOSE.  See the
+ * GNU General Public License for more details.
+ *
+ * You should have received a copy of the GNU General Public License
+ * along with this program; if not, write to the Free Software
+ * Foundation, Inc., 675 Mass Ave, Cambridge, MA 02139, USA.
+ *
+ */
+
+/* 
+ * exported functions:
+ *
+ * WIDGET_CLASS Widget_GPO
+ *   the GPO widget
+ *
+ */
+
+
+#include "config.h"
+
+#include <stdlib.h>
+#include <stdio.h>
+#include <string.h>
+#include <ctype.h>
+
+#include "debug.h"
+#include "cfg.h"
+#include "property.h"
+#include "timer.h"
+#include "widget.h"
+#include "widget_gpo.h"
+
+#ifdef WITH_DMALLOC
+#include <dmalloc.h>
+#endif
+
+
+void widget_gpo_update(void *Self)
+{
+    WIDGET *W = (WIDGET *) Self;
+    WIDGET_GPO *GPO = W->data;
+
+    /* evaluate properties */
+    property_eval(&GPO->expression);
+    property_eval(&GPO->update);
+
+    /* finally, draw it! */
+    if (W->class->draw)
+	W->class->draw(W);
+
+    /* add a new one-shot timer */
+    if (P2N(&GPO->update) > 0) {
+	timer_add(widget_gpo_update, Self, P2N(&GPO->update), 1);
+    }
+
+}
+
+
+int widget_gpo_init(WIDGET * Self)
+{
+    char *section;
+    WIDGET_GPO *GPO;
+
+    /* prepare config section */
+    /* strlen("Widget:")=7 */
+    section = malloc(strlen(Self->name) + 8);
+    strcpy(section, "Widget:");
+    strcat(section, Self->name);
+
+    GPO = malloc(sizeof(WIDGET_GPO));
+    memset(GPO, 0, sizeof(WIDGET_GPO));
+
+    /* load properties */
+    property_load(section, "expression", NULL, &GPO->expression);
+    property_load(section, "update", "1000", &GPO->update);
+
+    /* sanity checks */
+    if (!property_valid(&GPO->expression)) {
+	error("Warning: widget %s has no expression", section);
+    }
+
+    free(section);
+    Self->data = GPO;
+
+    /* fire it the first time */
+    widget_gpo_update(Self);
+
+    return 0;
+}
+
+
+int widget_gpo_quit(WIDGET * Self)
+{
+    if (Self && Self->data) {
+	WIDGET_GPO *GPO = Self->data;
+	property_free(&GPO->expression);
+	property_free(&GPO->update);
+	free(Self->data);
+	Self->data = NULL;
+    }
+    return 0;
+}
+
+
+
+WIDGET_CLASS Widget_GPO = {
+    .name = "gpo",
+    .type = WIDGET_TYPE_GPO,
+    .init = widget_gpo_init,
+    .draw = NULL,
+    .quit = widget_gpo_quit,
+};
diff -urN lcd4linux-0.10.0/widget_gpo.h lcd4linux-0.11.0-SVN/widget_gpo.h
--- lcd4linux-0.10.0/widget_gpo.h	1970-01-01 01:00:00.000000000 +0100
+++ lcd4linux-0.11.0-SVN/widget_gpo.h	2008-12-31 08:05:54.000000000 +0100
@@ -0,0 +1,41 @@
+/* $Id: widget_gpo.h 840 2007-09-09 12:17:42Z michael $
+ * $URL: https://ssl.bulix.org/svn/lcd4linux/trunk/widget_gpo.h $
+ *
+ * GPO widget handling
+ *
+ * Copyright (C) 2005 Michael Reinelt <michael@reinelt.co.at>
+ * Copyright (C) 2005, 2006, 2007 The LCD4Linux Team <lcd4linux-devel@users.sourceforge.net>
+ *
+ * This file is part of LCD4Linux.
+ *
+ * LCD4Linux is free software; you can redistribute it and/or modify
+ * it under the terms of the GNU General Public License as published by
+ * the Free Software Foundation; either version 2, or (at your option)
+ * any later version.
+ *
+ * LCD4Linux is distributed in the hope that it will be useful,
+ * but WITHOUT ANY WARRANTY; without even the implied warranty of
+ * MERCHANTABILITY or FITNESS FOR A PARTICULAR PURPOSE.  See the
+ * GNU General Public License for more details.
+ *
+ * You should have received a copy of the GNU General Public License
+ * along with this program; if not, write to the Free Software
+ * Foundation, Inc., 675 Mass Ave, Cambridge, MA 02139, USA.
+ *
+ */
+
+
+#ifndef _WIDGET_GPO_H_
+#define _WIDGET_GPO_H_
+
+#include "property.h"
+
+typedef struct WIDGET_GPO {
+    PROPERTY expression;	/* main GPO expression */
+    PROPERTY update;		/* update interval (msec) */
+} WIDGET_GPO;
+
+
+extern WIDGET_CLASS Widget_GPO;
+
+#endif
diff -urN lcd4linux-0.10.0/widget.h lcd4linux-0.11.0-SVN/widget.h
--- lcd4linux-0.10.0/widget.h	2005-05-08 06:32:45.000000000 +0200
+++ lcd4linux-0.11.0-SVN/widget.h	2008-12-31 08:05:54.000000000 +0100
@@ -1,8 +1,9 @@
-/* $Id: widget.h,v 1.13 2005/05/08 04:32:45 reinelt Exp $
+/* $Id: widget.h 840 2007-09-09 12:17:42Z michael $
+ * $URL: https://ssl.bulix.org/svn/lcd4linux/trunk/widget.h $
  *
  * generic widget handling
  *
- * Copyright (C) 2003, 2004 Michael Reinelt <reinelt@eunet.at>
+ * Copyright (C) 2003, 2004 Michael Reinelt <michael@reinelt.co.at>
  * Copyright (C) 2004 The LCD4Linux Team <lcd4linux-devel@users.sourceforge.net>
  *
  * This file is part of LCD4Linux.
@@ -21,77 +22,24 @@
  * along with this program; if not, write to the Free Software
  * Foundation, Inc., 675 Mass Ave, Cambridge, MA 02139, USA.
  *
- *
- * $Log: widget.h,v $
- * Revision 1.13  2005/05/08 04:32:45  reinelt
- * CodingStyle added and applied
- *
- * Revision 1.12  2005/01/18 06:30:24  reinelt
- * added (C) to all copyright statements
- *
- * Revision 1.11  2004/06/26 12:05:00  reinelt
- *
- * uh-oh... the last CVS log message messed up things a lot...
- *
- * Revision 1.10  2004/06/26 09:27:21  reinelt
- *
- * added '-W' to CFLAGS
- * changed all C++ comments to C ones
- * cleaned up a lot of signed/unsigned mistakes
- *
- * Revision 1.9  2004/06/20 10:09:56  reinelt
- *
- * 'const'ified the whole source
- *
- * Revision 1.8  2004/03/03 03:47:04  reinelt
- * big patch from Martin Hejl:
- * - use qprintf() where appropriate
- * - save CPU cycles on gettimeofday()
- * - add quit() functions to free allocated memory
- * - fixed lots of memory leaks
- *
- * Revision 1.7  2004/01/14 11:33:00  reinelt
- * new plugin 'uname' which does what it's called
- * text widget nearly finished
- * first results displayed on MatrixOrbital
- *
- * Revision 1.6  2004/01/13 08:18:20  reinelt
- * timer queues added
- * liblcd4linux deactivated turing transformation to new layout
- *
- * Revision 1.5  2004/01/11 18:26:02  reinelt
- * further widget and layout processing
- *
- * Revision 1.4  2004/01/10 20:22:33  reinelt
- * added new function 'cfg_list()' (not finished yet)
- * added layout.c (will replace processor.c someday)
- * added widget_text.c (will be the first and most important widget)
- * modified lcd4linux.c so that old-style configs should work, too
- *
- * Revision 1.3  2004/01/10 17:34:40  reinelt
- * further matrixOrbital changes
- * widgets initialized
- *
- * Revision 1.2  2003/10/05 17:58:50  reinelt
- * libtool junk; copyright messages cleaned up
- *
- * Revision 1.1  2003/09/19 03:51:29  reinelt
- * minor fixes, widget.c added
- *
  */
 
 
 #ifndef _WIDGET_H_
 #define _WIDGET_H_
 
+#include "rgb.h"
+
 
 struct WIDGET;			/* forward declaration */
 
 
 typedef struct WIDGET_CLASS {
     char *name;
+    int type;
     int (*init) (struct WIDGET * Self);
     int (*draw) (struct WIDGET * Self);
+    int (*find) (struct WIDGET * Self, void *needle);
     int (*quit) (struct WIDGET * Self);
 } WIDGET_CLASS;
 
@@ -99,15 +47,29 @@
 typedef struct WIDGET {
     char *name;
     WIDGET_CLASS *class;
+    struct WIDGET *parent;
+    RGBA fg_color;
+    RGBA bg_color;
+    int fg_valid;
+    int bg_valid;
+    int layer;
     int row;
     int col;
     void *data;
 } WIDGET;
 
 
+#define WIDGET_TYPE_RC 1
+#define WIDGET_TYPE_XY 2
+#define WIDGET_TYPE_GPO 3
+#define WIDGET_TYPE_TIMER 4
+#define WIDGET_TYPE_KEYPAD 5
+
 
 int widget_register(WIDGET_CLASS * widget);
 void widget_unregister(void);
-int widget_add(const char *name, const int row, const int col);
+int widget_add(const char *name, const int type, const int layer, const int row, const int col);
+WIDGET *widget_find(int type, void *needle);
+int widget_color(const char *section, const char *name, const char *key, RGBA * C);
 
 #endif
diff -urN lcd4linux-0.10.0/widget_icon.c lcd4linux-0.11.0-SVN/widget_icon.c
--- lcd4linux-0.10.0/widget_icon.c	2005-05-08 06:32:45.000000000 +0200
+++ lcd4linux-0.11.0-SVN/widget_icon.c	2008-12-31 08:05:54.000000000 +0100
@@ -1,8 +1,9 @@
-/* $Id: widget_icon.c,v 1.17 2005/05/08 04:32:45 reinelt Exp $
+/* $Id: widget_icon.c 840 2007-09-09 12:17:42Z michael $
+ * $URL: https://ssl.bulix.org/svn/lcd4linux/trunk/widget_icon.c $
  *
  * icon widget handling
  *
- * Copyright (C) 2003, 2004 Michael Reinelt <reinelt@eunet.at>
+ * Copyright (C) 2003, 2004 Michael Reinelt <michael@reinelt.co.at>
  * Copyright (C) 2004 The LCD4Linux Team <lcd4linux-devel@users.sourceforge.net>
  *
  * This program is free software; you can redistribute it and/or modify
@@ -19,81 +20,6 @@
  * along with this program; if not, write to the Free Software
  * Foundation, Inc., 675 Mass Ave, Cambridge, MA 02139, USA.
  *
- *
- * $Log: widget_icon.c,v $
- * Revision 1.17  2005/05/08 04:32:45  reinelt
- * CodingStyle added and applied
- *
- * Revision 1.16  2005/01/18 06:30:24  reinelt
- * added (C) to all copyright statements
- *
- * Revision 1.15  2004/11/28 15:50:24  reinelt
- * Cwlinux fixes (invalidation of user-defined chars)
- *
- * Revision 1.14  2004/06/26 12:05:00  reinelt
- *
- * uh-oh... the last CVS log message messed up things a lot...
- *
- * Revision 1.13  2004/06/26 09:27:21  reinelt
- *
- * added '-W' to CFLAGS
- * changed all C++ comments to C ones
- * cleaned up a lot of signed/unsigned mistakes
- *
- * Revision 1.12  2004/06/20 10:09:56  reinelt
- *
- * 'const'ified the whole source
- *
- * Revision 1.11  2004/03/11 06:39:59  reinelt
- * big patch from Martin:
- * - reuse filehandles
- * - memory leaks fixed
- * - earlier busy-flag checking with HD44780
- * - reuse memory for strings in RESULT and hash
- * - netdev_fast to wavid time-consuming regex
- *
- * Revision 1.10  2004/03/06 20:31:16  reinelt
- * Complete rewrite of the evaluator to get rid of the code
- * from mark Morley (because of license issues).
- * The new Evaluator does a pre-compile of expressions, and
- * stores them in trees. Therefore it should be reasonable faster...
- *
- * Revision 1.9  2004/03/03 04:44:16  reinelt
- * changes (cosmetics?) to the big patch from Martin
- * hash patch un-applied
- *
- * Revision 1.8  2004/03/03 03:47:04  reinelt
- * big patch from Martin Hejl:
- * - use qprintf() where appropriate
- * - save CPU cycles on gettimeofday()
- * - add quit() functions to free allocated memory
- * - fixed lots of memory leaks
- *
- * Revision 1.7  2004/02/15 21:43:43  reinelt
- * T6963 driver nearly finished
- * framework for graphic displays done
- * i2c_sensors patch from Xavier
- * some more old generation files removed
- *
- * Revision 1.6  2004/02/07 13:45:23  reinelt
- * icon visibility patch #2 from Xavier
- *
- * Revision 1.5  2004/02/04 19:11:44  reinelt
- * icon visibility patch from Xavier
- *
- * Revision 1.4  2004/01/30 20:57:56  reinelt
- * HD44780 patch from Martin Hejl
- * dmalloc integrated
- *
- * Revision 1.3  2004/01/29 04:40:03  reinelt
- * every .c file includes "config.h" now
- *
- * Revision 1.2  2004/01/23 07:04:39  reinelt
- * icons finished!
- *
- * Revision 1.1  2004/01/23 04:54:03  reinelt
- * icon widget added (not finished yet!)
- *
  */
 
 /* 
@@ -115,7 +41,7 @@
 #include "debug.h"
 #include "cfg.h"
 #include "qprintf.h"
-#include "evaluator.h"
+#include "property.h"
 #include "timer.h"
 #include "widget.h"
 #include "widget_icon.h"
@@ -124,8 +50,8 @@
 #include <dmalloc.h>
 #endif
 
-/* icons always are 8 pixels high  */
-#define YRES 8
+/* icons size is same as char size */
+extern int XRES, YRES;
 
 static void widget_icon_read_bitmap(const char *section, WIDGET_ICON * Icon)
 {
@@ -168,39 +94,28 @@
 {
     WIDGET *W = (WIDGET *) Self;
     WIDGET_ICON *Icon = W->data;
-    RESULT result = { 0, 0, 0, NULL };
 
-    /* evaluate expressions */
-    Icon->speed = 100;
-    if (Icon->speed_tree != NULL) {
-	Eval(Icon->speed_tree, &result);
-	Icon->speed = R2N(&result);
-	if (Icon->speed < 10)
-	    Icon->speed = 10;
-	DelResult(&result);
-    }
+    /* process the parent only */
+    if (W->parent == NULL) {
 
-    Icon->visible = 1;
-    if (Icon->visible_tree != NULL) {
-	Eval(Icon->visible_tree, &result);
-	Icon->visible = R2N(&result);
-	if (Icon->visible < 1)
-	    Icon->visible = 0;
-	DelResult(&result);
+	/* evaluate properties */
+	property_eval(&Icon->speed);
+	property_eval(&Icon->visible);
+
+	/* rotate icon bitmap */
+	Icon->curmap++;
+	if (Icon->curmap >= Icon->maxmap)
+	    Icon->curmap = 0;
     }
 
-    /* rotate icon bitmap */
-    Icon->curmap++;
-    if (Icon->curmap >= Icon->maxmap)
-	Icon->curmap = 0;
-
     /* finally, draw it! */
     if (W->class->draw)
 	W->class->draw(W);
 
     /* add a new one-shot timer */
-    timer_add(widget_icon_update, Self, Icon->speed, 1);
-
+    if (P2N(&Icon->speed) > 0) {
+	timer_add(widget_icon_update, Self, P2N(&Icon->speed), 1);
+    }
 }
 
 
@@ -210,42 +125,42 @@
     char *section;
     WIDGET_ICON *Icon;
 
-    /* prepare config section */
-    /* strlen("Widget:")=7 */
-    section = malloc(strlen(Self->name) + 8);
-    strcpy(section, "Widget:");
-    strcat(section, Self->name);
-
-    Icon = malloc(sizeof(WIDGET_ICON));
-    memset(Icon, 0, sizeof(WIDGET_ICON));
-
-    /* get raw expressions (we evaluate them ourselves) */
-    Icon->speed_expr = cfg_get_raw(section, "speed", NULL);
-    Icon->visible_expr = cfg_get_raw(section, "visible", NULL);
-
-    /* compile'em */
-    Compile(Icon->speed_expr, &Icon->speed_tree);
-    Compile(Icon->visible_expr, &Icon->visible_tree);
-
-    /* sanity check */
-    if (Icon->speed_expr == NULL || *Icon->speed_expr == '\0') {
-	error("Icon %s has no speed, using '100'", Self->name);
-	Icon->speed_expr = "100";
-    }
+    /* re-use the parent if one exists */
+    if (Self->parent == NULL) {
 
-    /* read bitmap */
-    widget_icon_read_bitmap(section, Icon);
+	/* prepare config section */
+	/* strlen("Widget:")=7 */
+	section = malloc(strlen(Self->name) + 8);
+	strcpy(section, "Widget:");
+	strcat(section, Self->name);
 
-    free(section);
-    Self->data = Icon;
+	Icon = malloc(sizeof(WIDGET_ICON));
+	memset(Icon, 0, sizeof(WIDGET_ICON));
 
-    /* as the speed is evaluatod on every call, we use 'one-shot'-timers.  */
-    /* The timer will be reactivated on every call to widget_icon_update().  */
-    /* We do the initial call here... */
-    Icon->prvmap = -1;
+	/* load properties */
+	property_load(section, "speed", "100", &Icon->speed);
+	property_load(section, "visible", "1", &Icon->visible);
 
-    /* reset ascii  */
-    Icon->ascii = -1;
+	/* read bitmap */
+	widget_icon_read_bitmap(section, Icon);
+
+	free(section);
+	Self->data = Icon;
+
+	/* as the speed is evaluatod on every call, we use 'one-shot'-timers.  */
+	/* The timer will be reactivated on every call to widget_icon_update().  */
+	/* We do the initial call here... */
+	Icon->prvmap = -1;
+
+	/* reset ascii  */
+	Icon->ascii = -1;
+
+    } else {
+
+	/* re-use the parent */
+	Self->data = Self->parent->data;
+
+    }
 
     /* just do it! */
     widget_icon_update(Self);
@@ -257,14 +172,17 @@
 int widget_icon_quit(WIDGET * Self)
 {
     if (Self) {
-	if (Self->data) {
-	    WIDGET_ICON *Icon = Self->data;
-	    DelTree(Icon->speed_tree);
-	    DelTree(Icon->visible_tree);
-	    if (Icon->bitmap)
-		free(Icon->bitmap);
-	    free(Self->data);
-	    Self->data = NULL;
+	/* do not deallocate child widget! */
+	if (Self->parent == NULL) {
+	    if (Self->data) {
+		WIDGET_ICON *Icon = Self->data;
+		property_free(&Icon->speed);
+		property_free(&Icon->visible);
+		if (Icon->bitmap)
+		    free(Icon->bitmap);
+		free(Self->data);
+		Self->data = NULL;
+	    }
 	}
     }
 
@@ -275,8 +193,9 @@
 
 
 WIDGET_CLASS Widget_Icon = {
-  name:"icon",
-  init:widget_icon_init,
-  draw:NULL,
-  quit:widget_icon_quit,
+    .name = "icon",
+    .type = WIDGET_TYPE_RC,
+    .init = widget_icon_init,
+    .draw = NULL,
+    .quit = widget_icon_quit,
 };
diff -urN lcd4linux-0.10.0/widget_icon.h lcd4linux-0.11.0-SVN/widget_icon.h
--- lcd4linux-0.10.0/widget_icon.h	2005-05-08 06:32:45.000000000 +0200
+++ lcd4linux-0.11.0-SVN/widget_icon.h	2008-12-31 08:05:54.000000000 +0100
@@ -1,8 +1,9 @@
-/* $Id: widget_icon.h,v 1.9 2005/05/08 04:32:45 reinelt Exp $
+/* $Id: widget_icon.h 840 2007-09-09 12:17:42Z michael $
+ * $URL: https://ssl.bulix.org/svn/lcd4linux/trunk/widget_icon.h $
  *
  * icon widget handling
  *
- * Copyright (C) 2003, 2004 Michael Reinelt <reinelt@eunet.at>
+ * Copyright (C) 2003, 2004 Michael Reinelt <michael@reinelt.co.at>
  * Copyright (C) 2004 The LCD4Linux Team <lcd4linux-devel@users.sourceforge.net>
  *
  * This file is part of LCD4Linux.
@@ -21,58 +22,17 @@
  * along with this program; if not, write to the Free Software
  * Foundation, Inc., 675 Mass Ave, Cambridge, MA 02139, USA.
  *
- *
- * $Log: widget_icon.h,v $
- * Revision 1.9  2005/05/08 04:32:45  reinelt
- * CodingStyle added and applied
- *
- * Revision 1.8  2005/01/18 06:30:24  reinelt
- * added (C) to all copyright statements
- *
- * Revision 1.7  2004/06/26 12:05:00  reinelt
- *
- * uh-oh... the last CVS log message messed up things a lot...
- *
- * Revision 1.6  2004/06/26 09:27:21  reinelt
- *
- * added '-W' to CFLAGS
- * changed all C++ comments to C ones
- * cleaned up a lot of signed/unsigned mistakes
- *
- * Revision 1.5  2004/03/06 20:31:16  reinelt
- * Complete rewrite of the evaluator to get rid of the code
- * from mark Morley (because of license issues).
- * The new Evaluator does a pre-compile of expressions, and
- * stores them in trees. Therefore it should be reasonable faster...
- *
- * Revision 1.4  2004/02/15 21:43:43  reinelt
- * T6963 driver nearly finished
- * framework for graphic displays done
- * i2c_sensors patch from Xavier
- * some more old generation files removed
- *
- * Revision 1.3  2004/02/04 19:11:44  reinelt
- * icon visibility patch from Xavier
- *
- * Revision 1.2  2004/01/23 07:04:39  reinelt
- * icons finished!
- *
- * Revision 1.1  2004/01/23 04:54:04  reinelt
- * icon widget added (not finished yet!)
- *
  */
 
 
 #ifndef _WIDGET_ICON_H_
 #define _WIDGET_ICON_H_
 
+#include "property.h"
+
 typedef struct WIDGET_ICON {
-    char *speed_expr;		/* expression for update interval */
-    void *speed_tree;		/* pre-compiled expression for update interval */
-    int speed;			/* update interval (msec) */
-    char *visible_expr;		/* expression for visibility */
-    void *visible_tree;		/* pre-compiled expression for visibility */
-    int visible;		/* icon visible? */
+    PROPERTY speed;		/* update interval (msec) */
+    PROPERTY visible;		/* icon visible? */
     int ascii;			/* ascii code of icon (depends on the driver) */
     int curmap;			/* current bitmap sequence */
     int prvmap;			/* previous bitmap sequence  */
@@ -80,6 +40,7 @@
     unsigned char *bitmap;	/* bitmaps of (animated) icon */
 } WIDGET_ICON;
 
+
 extern WIDGET_CLASS Widget_Icon;
 
 #endif
diff -urN lcd4linux-0.10.0/widget_image.c lcd4linux-0.11.0-SVN/widget_image.c
--- lcd4linux-0.10.0/widget_image.c	1970-01-01 01:00:00.000000000 +0100
+++ lcd4linux-0.11.0-SVN/widget_image.c	2008-12-31 08:05:54.000000000 +0100
@@ -0,0 +1,290 @@
+/* $Id: widget_image.c 840 2007-09-09 12:17:42Z michael $
+ * $URL: https://ssl.bulix.org/svn/lcd4linux/trunk/widget_image.c $
+ *
+ * image widget handling
+ *
+ * Copyright (C) 2006 Michael Reinelt <michael@reinelt.co.at>
+ * Copyright (C) 2006 The LCD4Linux Team <lcd4linux-devel@users.sourceforge.net>
+ *
+ * This program is free software; you can redistribute it and/or modify
+ * it under the terms of the GNU General Public License as published by
+ * the Free Software Foundation; either version 2, or (at your option)
+ * any later version.
+ *
+ * This program is distributed in the hope that it will be useful,
+ * but WITHOUT ANY WARRANTY; without even the implied warranty of
+ * MERCHANTABILITY or FITNESS FOR A PARTICULAR PURPOSE.  See the
+ * GNU General Public License for more details.
+ *
+ * You should have received a copy of the GNU General Public License
+ * along with this program; if not, write to the Free Software
+ * Foundation, Inc., 675 Mass Ave, Cambridge, MA 02139, USA.
+ *
+ */
+
+/* 
+ * exported functions:
+ *
+ * WIDGET_CLASS Widget_Image
+ *   the image widget
+ *
+ */
+
+
+#include "config.h"
+
+#include <stdlib.h>
+#include <stdio.h>
+#include <string.h>
+#include <ctype.h>
+#include <errno.h>
+
+#ifdef HAVE_GD_GD_H
+#include <gd/gd.h>
+#else
+#ifdef HAVE_GD_H
+#include <gd.h>
+#else
+#error "gd.h not found!"
+#error "cannot compile image widget"
+#endif
+#endif
+
+#if GD2_VERS != 2
+#error "lcd4linux requires libgd version 2"
+#error "cannot compile image widget"
+#endif
+
+#include "debug.h"
+#include "cfg.h"
+#include "qprintf.h"
+#include "property.h"
+#include "timer.h"
+#include "widget.h"
+#include "widget_image.h"
+#include "rgb.h"
+
+#ifdef WITH_DMALLOC
+#include <dmalloc.h>
+#endif
+
+
+static void widget_image_render(const char *Name, WIDGET_IMAGE * Image)
+{
+    int x, y;
+    int inverted;
+    gdImagePtr gdImage;
+
+    /* clear bitmap */
+    if (Image->bitmap) {
+	int i;
+	for (i = 0; i < Image->height * Image->width; i++) {
+	    RGBA empty = {.R = 0x00,.G = 0x00,.B = 0x00,.A = 0x00 };
+	    Image->bitmap[i] = empty;
+	}
+    }
+
+    /* reload image only on first call or on explicit reload request */
+    if (Image->gdImage == NULL || P2N(&Image->reload)) {
+
+	char *file;
+	FILE *fd;
+
+	/* free previous image */
+	if (Image->gdImage) {
+	    gdImageDestroy(Image->gdImage);
+	    Image->gdImage = NULL;
+	}
+
+	file = P2S(&Image->file);
+	if (file == NULL || file[0] == '\0') {
+	    error("Warning: Image %s has no file", Name);
+	    return;
+	}
+
+	fd = fopen(file, "rb");
+	if (fd == NULL) {
+	    error("Warning: Image %s: fopen(%s) failed: %s", Name, file, strerror(errno));
+	    return;
+	}
+
+	Image->gdImage = gdImageCreateFromPng(fd);
+	fclose(fd);
+
+	if (Image->gdImage == NULL) {
+	    error("Warning: Image %s: CreateFromPng(%s) failed!", Name, file);
+	    return;
+	}
+
+    }
+
+    /* maybe resize bitmap */
+    gdImage = Image->gdImage;
+    if (gdImage->sx > Image->width) {
+	Image->width = gdImage->sx;
+	free(Image->bitmap);
+	Image->bitmap = NULL;
+    }
+    if (gdImage->sy > Image->height) {
+	Image->height = gdImage->sy;
+	free(Image->bitmap);
+	Image->bitmap = NULL;
+    }
+    if (Image->bitmap == NULL && Image->width > 0 && Image->height > 0) {
+	int i = Image->width * Image->height * sizeof(Image->bitmap[0]);
+	Image->bitmap = malloc(i);
+	if (Image->bitmap == NULL) {
+	    error("Warning: Image %s: malloc(%d) failed: %s", Name, i, strerror(errno));
+	    return;
+	}
+	for (i = 0; i < Image->height * Image->width; i++) {
+	    RGBA empty = {.R = 0x00,.G = 0x00,.B = 0x00,.A = 0x00 };
+	    Image->bitmap[i] = empty;
+	}
+    }
+
+
+    /* finally really render it */
+    inverted = P2N(&Image->inverted);
+    if (P2N(&Image->visible)) {
+	for (x = 0; x < gdImage->sx; x++) {
+	    for (y = 0; y < gdImage->sy; y++) {
+		int p = gdImageGetTrueColorPixel(gdImage, x, y);
+		int a = gdTrueColorGetAlpha(p);
+		int i = y * Image->width + x;
+		Image->bitmap[i].R = gdTrueColorGetRed(p);
+		Image->bitmap[i].G = gdTrueColorGetGreen(p);
+		Image->bitmap[i].B = gdTrueColorGetBlue(p);
+		/* GD's alpha is 0 (opaque) to 127 (tranparanet) */
+		/* our alpha is 0 (transparent) to 255 (opaque) */
+		Image->bitmap[i].A = (a == 127) ? 0 : 255 - 2 * a;
+		if (inverted) {
+		    Image->bitmap[i].R = 255 - Image->bitmap[i].R;
+		    Image->bitmap[i].G = 255 - Image->bitmap[i].G;
+		    Image->bitmap[i].B = 255 - Image->bitmap[i].B;
+		}
+	    }
+	}
+    }
+}
+
+
+static void widget_image_update(void *Self)
+{
+    WIDGET *W = (WIDGET *) Self;
+    WIDGET_IMAGE *Image = W->data;
+
+    /* process the parent only */
+    if (W->parent == NULL) {
+
+	/* evaluate properties */
+	property_eval(&Image->file);
+	property_eval(&Image->update);
+	property_eval(&Image->reload);
+	property_eval(&Image->visible);
+	property_eval(&Image->inverted);
+
+	/* render image into bitmap */
+	widget_image_render(W->name, Image);
+
+    }
+
+    /* finally, draw it! */
+    if (W->class->draw)
+	W->class->draw(W);
+
+    /* add a new one-shot timer */
+    if (P2N(&Image->update) > 0) {
+	timer_add(widget_image_update, Self, P2N(&Image->update), 1);
+    }
+}
+
+
+
+int widget_image_init(WIDGET * Self)
+{
+    char *section;
+    WIDGET_IMAGE *Image;
+
+    /* re-use the parent if one exists */
+    if (Self->parent == NULL) {
+
+	/* prepare config section */
+	/* strlen("Widget:")=7 */
+	section = malloc(strlen(Self->name) + 8);
+	strcpy(section, "Widget:");
+	strcat(section, Self->name);
+
+	Image = malloc(sizeof(WIDGET_IMAGE));
+	memset(Image, 0, sizeof(WIDGET_IMAGE));
+
+	/* initial size */
+	Image->width = 0;
+	Image->height = 0;
+	Image->bitmap = NULL;
+
+	/* load properties */
+	property_load(section, "file", NULL, &Image->file);
+	property_load(section, "update", "100", &Image->update);
+	property_load(section, "reload", "0", &Image->reload);
+	property_load(section, "visible", "1", &Image->visible);
+	property_load(section, "inverted", "0", &Image->inverted);
+
+	/* sanity checks */
+	if (!property_valid(&Image->file)) {
+	    error("Warning: widget %s has no file", section);
+	}
+
+	free(section);
+	Self->data = Image;
+
+    } else {
+
+	/* re-use the parent */
+	Self->data = Self->parent->data;
+
+    }
+
+    /* just do it! */
+    widget_image_update(Self);
+
+    return 0;
+}
+
+
+int widget_image_quit(WIDGET * Self)
+{
+    if (Self) {
+	/* do not deallocate child widget! */
+	if (Self->parent == NULL) {
+	    if (Self->data) {
+		WIDGET_IMAGE *Image = Self->data;
+		if (Image->gdImage) {
+		    gdImageDestroy(Image->gdImage);
+		    Image->gdImage = NULL;
+		}
+		free(Image->bitmap);
+		property_free(&Image->file);
+		property_free(&Image->update);
+		property_free(&Image->reload);
+		property_free(&Image->visible);
+		property_free(&Image->inverted);
+		free(Self->data);
+		Self->data = NULL;
+	    }
+	}
+    }
+
+    return 0;
+
+}
+
+
+
+WIDGET_CLASS Widget_Image = {
+    .name = "image",
+    .type = WIDGET_TYPE_XY,
+    .init = widget_image_init,
+    .draw = NULL,
+    .quit = widget_image_quit,
+};
diff -urN lcd4linux-0.10.0/widget_image.h lcd4linux-0.11.0-SVN/widget_image.h
--- lcd4linux-0.10.0/widget_image.h	1970-01-01 01:00:00.000000000 +0100
+++ lcd4linux-0.11.0-SVN/widget_image.h	2008-12-31 08:05:54.000000000 +0100
@@ -0,0 +1,47 @@
+/* $Id: widget_image.h 840 2007-09-09 12:17:42Z michael $
+ * $URL: https://ssl.bulix.org/svn/lcd4linux/trunk/widget_image.h $
+ *
+ * image widget handling
+ *
+ * Copyright (C) 2006 Michael Reinelt <michael@reinelt.co.at>
+ * Copyright (C) 2006 The LCD4Linux Team <lcd4linux-devel@users.sourceforge.net>
+ *
+ * This file is part of LCD4Linux.
+ *
+ * LCD4Linux is free software; you can redistribute it and/or modify
+ * it under the terms of the GNU General Public License as published by
+ * the Free Software Foundation; either version 2, or (at your option)
+ * any later version.
+ *
+ * LCD4Linux is distributed in the hope that it will be useful,
+ * but WITHOUT ANY WARRANTY; without even the implied warranty of
+ * MERCHANTABILITY or FITNESS FOR A PARTICULAR PURPOSE.  See the
+ * GNU General Public License for more details.
+ *
+ * You should have received a copy of the GNU General Public License
+ * along with this program; if not, write to the Free Software
+ * Foundation, Inc., 675 Mass Ave, Cambridge, MA 02139, USA.
+ *
+ */
+
+
+#ifndef _WIDGET_IMAGE_H_
+#define _WIDGET_IMAGE_H_
+
+#include "property.h"
+#include "rgb.h"
+
+typedef struct WIDGET_IMAGE {
+    void *gdImage;		/* raw gd image */
+    RGBA *bitmap;		/* image bitmap */
+    int width, height;		/* size of the image */
+    PROPERTY file;		/* image filename */
+    PROPERTY update;		/* update interval */
+    PROPERTY reload;		/* reload image on update? */
+    PROPERTY visible;		/* image visible? */
+    PROPERTY inverted;		/* image inverted? */
+} WIDGET_IMAGE;
+
+extern WIDGET_CLASS Widget_Image;
+
+#endif
diff -urN lcd4linux-0.10.0/widget_keypad.c lcd4linux-0.11.0-SVN/widget_keypad.c
--- lcd4linux-0.10.0/widget_keypad.c	1970-01-01 01:00:00.000000000 +0100
+++ lcd4linux-0.11.0-SVN/widget_keypad.c	2008-12-31 08:05:54.000000000 +0100
@@ -0,0 +1,144 @@
+/* $Id: widget_keypad.c 771 2007-02-25 12:27:26Z michael $
+ * $URL: https://ssl.bulix.org/svn/lcd4linux/trunk/widget_keypad.c $
+ *
+ * keypad widget handling
+ *
+ * Copyright (C) 2006 Chris Maj <cmaj@freedomcorpse.com>
+ * Copyright (C) 2006 The LCD4Linux Team <lcd4linux-devel@users.sourceforge.net>
+ *
+ * This program is free software; you can redistribute it and/or modify
+ * it under the terms of the GNU General Public License as published by
+ * the Free Software Foundation; either version 2, or (at your option)
+ * any later version.
+ *
+ * This program is distributed in the hope that it will be useful,
+ * but WITHOUT ANY WARRANTY; without even the implied warranty of
+ * MERCHANTABILITY or FITNESS FOR A PARTICULAR PURPOSE.  See the
+ * GNU General Public License for more details.
+ *
+ * You should have received a copy of the GNU General Public License
+ * along with this program; if not, write to the Free Software
+ * Foundation, Inc., 675 Mass Ave, Cambridge, MA 02139, USA.
+ *
+ */
+
+/* 
+ * exported functions:
+ *
+ * WIDGET_CLASS Widget_Keypad
+ *   the keypad widget
+ *
+ */
+
+
+#include "config.h"
+
+#include <stdlib.h>
+#include <stdio.h>
+#include <string.h>
+#include <ctype.h>
+
+#include "debug.h"
+#include "cfg.h"
+#include "property.h"
+#include "timer.h"
+#include "widget.h"
+#include "widget_keypad.h"
+
+#ifdef WITH_DMALLOC
+#include <dmalloc.h>
+#endif
+
+
+int widget_keypad_draw(WIDGET * Self)
+{
+    WIDGET_KEYPAD *keypad = Self->data;
+
+    /* evaluate properties */
+    property_eval(&keypad->expression);
+
+    return P2N(&keypad->expression);
+}
+
+
+int widget_keypad_init(WIDGET * Self)
+{
+    char *section;
+    char *c;
+    WIDGET_KEYPAD *keypad;
+
+    /* prepare config section */
+    /* strlen("Widget:")=7 */
+    section = malloc(strlen(Self->name) + 8);
+    strcpy(section, "Widget:");
+    strcat(section, Self->name);
+
+    keypad = malloc(sizeof(WIDGET_KEYPAD));
+    memset(keypad, 0, sizeof(WIDGET_KEYPAD));
+
+    /* load properties */
+    property_load(section, "expression", NULL, &keypad->expression);
+
+    /* state: pressed (default), released */
+    c = cfg_get(section, "state", "pressed");
+    if (!strcasecmp(c, "released"))
+	keypad->key = WIDGET_KEY_RELEASED;
+    else
+	keypad->key = WIDGET_KEY_PRESSED;
+
+    /* position: confirm (default), up, down, left, right, cancel */
+    c = cfg_get(section, "position", "confirm");
+    if (!strcasecmp(c, "up"))
+	keypad->key += WIDGET_KEY_UP;
+    else if (!strcasecmp(c, "down"))
+	keypad->key += WIDGET_KEY_DOWN;
+    else if (!strcasecmp(c, "left"))
+	keypad->key += WIDGET_KEY_LEFT;
+    else if (!strcasecmp(c, "right"))
+	keypad->key += WIDGET_KEY_RIGHT;
+    else if (!strcasecmp(c, "cancel"))
+	keypad->key += WIDGET_KEY_CANCEL;
+    else
+	keypad->key += WIDGET_KEY_CONFIRM;
+
+    free(section);
+    Self->data = keypad;
+
+    return 0;
+}
+
+int widget_keypad_find(WIDGET * Self, void *needle)
+{
+    WIDGET_KEYPAD *keypad;
+    KEYPADKEY key = *(KEYPADKEY *) needle;
+
+    if (Self && Self->data) {
+	keypad = Self->data;
+	if (keypad->key == key)
+	    return 0;
+    }
+
+    return -1;
+}
+
+int widget_keypad_quit(WIDGET * Self)
+{
+    if (Self && Self->data) {
+	WIDGET_KEYPAD *keypad = Self->data;
+	property_free(&keypad->expression);
+	free(Self->data);
+	Self->data = NULL;
+    }
+    return 0;
+}
+
+
+
+WIDGET_CLASS Widget_Keypad = {
+    .name = "keypad",
+    .type = WIDGET_TYPE_KEYPAD,
+    .init = widget_keypad_init,
+    .draw = widget_keypad_draw,
+    .find = widget_keypad_find,
+    .quit = widget_keypad_quit,
+};
diff -urN lcd4linux-0.10.0/widget_keypad.h lcd4linux-0.11.0-SVN/widget_keypad.h
--- lcd4linux-0.10.0/widget_keypad.h	1970-01-01 01:00:00.000000000 +0100
+++ lcd4linux-0.11.0-SVN/widget_keypad.h	2008-12-31 08:05:54.000000000 +0100
@@ -0,0 +1,52 @@
+/* $Id: widget_keypad.h 748 2007-01-20 05:00:06Z michael $
+ * $URL: https://ssl.bulix.org/svn/lcd4linux/trunk/widget_keypad.h $
+ *
+ * keypad widget handling
+ *
+ * Copyright (C) 2006 Chris Maj <cmaj@freedomcorpse.com>
+ * Copyright (C) 2006 The LCD4Linux Team <lcd4linux-devel@users.sourceforge.net>
+ *
+ * This file is part of LCD4Linux.
+ *
+ * LCD4Linux is free software; you can redistribute it and/or modify
+ * it under the terms of the GNU General Public License as published by
+ * the Free Software Foundation; either version 2, or (at your option)
+ * any later version.
+ *
+ * LCD4Linux is distributed in the hope that it will be useful,
+ * but WITHOUT ANY WARRANTY; without even the implied warranty of
+ * MERCHANTABILITY or FITNESS FOR A PARTICULAR PURPOSE.  See the
+ * GNU General Public License for more details.
+ *
+ * You should have received a copy of the GNU General Public License
+ * along with this program; if not, write to the Free Software
+ * Foundation, Inc., 675 Mass Ave, Cambridge, MA 02139, USA.
+ *
+ */
+
+
+#ifndef _WIDGET_KEYPAD_H_
+#define _WIDGET_KEYPAD_H_
+
+#include "property.h"
+
+typedef enum {
+    WIDGET_KEY_UP = 1,
+    WIDGET_KEY_DOWN = 2,
+    WIDGET_KEY_LEFT = 4,
+    WIDGET_KEY_RIGHT = 8,
+    WIDGET_KEY_CONFIRM = 16,
+    WIDGET_KEY_CANCEL = 32,
+    WIDGET_KEY_PRESSED = 64,
+    WIDGET_KEY_RELEASED = 128
+} KEYPADKEY;
+
+typedef struct WIDGET_KEYPAD {
+    PROPERTY expression;	/* expression that delivers the value */
+    KEYPADKEY key;		/* which key */
+} WIDGET_KEYPAD;
+
+
+extern WIDGET_CLASS Widget_Keypad;
+
+#endif
diff -urN lcd4linux-0.10.0/widget_text.c lcd4linux-0.11.0-SVN/widget_text.c
--- lcd4linux-0.10.0/widget_text.c	2005-05-08 06:32:45.000000000 +0200
+++ lcd4linux-0.11.0-SVN/widget_text.c	2008-12-31 08:05:54.000000000 +0100
@@ -1,9 +1,11 @@
-/* $Id: widget_text.c,v 1.22 2005/05/08 04:32:45 reinelt Exp $
+/* $Id: widget_text.c 860 2008-03-03 17:03:00Z michux $
+ * $URL: https://ssl.bulix.org/svn/lcd4linux/trunk/widget_text.c $
  *
  * simple text widget handling
  *
- * Copyright (C) 2003, 2004 Michael Reinelt <reinelt@eunet.at>
+ * Copyright (C) 2003, 2004 Michael Reinelt <michael@reinelt.co.at>
  * Copyright (C) 2004 The LCD4Linux Team <lcd4linux-devel@users.sourceforge.net>
+ * Copyright (C) 2008 Michael Vogt <michu@neophob.com> 
  *
  * This program is free software; you can redistribute it and/or modify
  * it under the terms of the GNU General Public License as published by
@@ -19,106 +21,6 @@
  * along with this program; if not, write to the Free Software
  * Foundation, Inc., 675 Mass Ave, Cambridge, MA 02139, USA.
  *
- *
- * $Log: widget_text.c,v $
- * Revision 1.22  2005/05/08 04:32:45  reinelt
- * CodingStyle added and applied
- *
- * Revision 1.21  2005/01/18 06:30:24  reinelt
- * added (C) to all copyright statements
- *
- * Revision 1.20  2004/11/29 04:42:07  reinelt
- * removed the 99999 msec limit on widget update time (thanks to Petri Damsten)
- *
- * Revision 1.19  2004/06/26 12:05:00  reinelt
- *
- * uh-oh... the last CVS log message messed up things a lot...
- *
- * Revision 1.18  2004/06/26 09:27:21  reinelt
- *
- * added '-W' to CFLAGS
- * changed all C++ comments to C ones
- * cleaned up a lot of signed/unsigned mistakes
- *
- * Revision 1.17  2004/03/11 06:39:59  reinelt
- * big patch from Martin:
- * - reuse filehandles
- * - memory leaks fixed
- * - earlier busy-flag checking with HD44780
- * - reuse memory for strings in RESULT and hash
- * - netdev_fast to wavid time-consuming regex
- *
- * Revision 1.16  2004/03/08 16:26:26  reinelt
- * re-introduced \nnn (octal) characters in strings
- * text widgets can have a 'update' speed of 0 which means 'never'
- * (may be used for static content)
- *
- * Revision 1.15  2004/03/06 20:31:16  reinelt
- * Complete rewrite of the evaluator to get rid of the code
- * from mark Morley (because of license issues).
- * The new Evaluator does a pre-compile of expressions, and
- * stores them in trees. Therefore it should be reasonable faster...
- *
- * Revision 1.14  2004/03/03 03:47:04  reinelt
- * big patch from Martin Hejl:
- * - use qprintf() where appropriate
- * - save CPU cycles on gettimeofday()
- * - add quit() functions to free allocated memory
- * - fixed lots of memory leaks
- *
- * Revision 1.13  2004/02/18 06:39:20  reinelt
- * T6963 driver for graphic displays finished
- *
- * Revision 1.12  2004/02/09 19:49:38  nicowallmeier
- * Minor bugfix
- *
- * Revision 1.11  2004/01/30 20:57:56  reinelt
- * HD44780 patch from Martin Hejl
- * dmalloc integrated
- *
- * Revision 1.10  2004/01/29 04:40:03  reinelt
- * every .c file includes "config.h" now
- *
- * Revision 1.9  2004/01/23 04:54:04  reinelt
- * icon widget added (not finished yet!)
- *
- * Revision 1.8  2004/01/22 07:57:45  reinelt
- * several bugs fixed where segfaulting on layout>display
- * Crystalfontz driver optimized, 632 display already works
- *
- * Revision 1.7  2004/01/20 04:51:39  reinelt
- * moved generic stuff from drv_MatrixOrbital to drv_generic
- * implemented new-stylish bars which are nearly finished
- *
- * Revision 1.6  2004/01/15 07:47:02  reinelt
- * debian/ postinst and watch added (did CVS forget about them?)
- * evaluator: conditional expressions (a?b:c) added
- * text widget nearly finished
- *
- * Revision 1.5  2004/01/15 04:29:45  reinelt
- * moved lcd4linux.conf.sample to *.old
- * lcd4linux.conf.sample with new layout
- * new plugins 'loadavg' and 'meminfo'
- * text widget have pre- and postfix
- *
- * Revision 1.4  2004/01/14 11:33:00  reinelt
- * new plugin 'uname' which does what it's called
- * text widget nearly finished
- * first results displayed on MatrixOrbital
- *
- * Revision 1.3  2004/01/13 08:18:20  reinelt
- * timer queues added
- * liblcd4linux deactivated turing transformation to new layout
- *
- * Revision 1.2  2004/01/11 18:26:02  reinelt
- * further widget and layout processing
- *
- * Revision 1.1  2004/01/10 20:22:33  reinelt
- * added new function 'cfg_list()' (not finished yet)
- * added layout.c (will replace processor.c someday)
- * added widget_text.c (will be the first and most important widget)
- * modified lcd4linux.c so that old-style configs should work, too
- *
  */
 
 /* 
@@ -141,10 +43,11 @@
 #include "debug.h"
 #include "cfg.h"
 #include "evaluator.h"
+#include "property.h"
 #include "timer.h"
 #include "widget.h"
 #include "widget_text.h"
-
+#
 #ifdef WITH_DMALLOC
 #include <dmalloc.h>
 #endif
@@ -155,12 +58,17 @@
     WIDGET *W = (WIDGET *) Self;
     WIDGET_TEXT *T = W->data;
 
+    char *prefix = P2S(&T->prefix);
+    char *postfix = P2S(&T->postfix);
+
+    char *string = T->string;
+
     int num, len, width, pad;
     char *src, *dst;
 
     num = 0;
-    len = strlen(T->value);
-    width = T->width - strlen(T->preval) - strlen(T->postval);
+    len = strlen(string);
+    width = T->width - strlen(prefix) - strlen(postfix);
     if (width < 0)
 	width = 0;
 
@@ -178,12 +86,50 @@
 	if (pad < 0)
 	    pad = 0;
 	break;
+    case ALIGN_AUTOMATIC:
+	if (len <= width) {
+	    pad = 0;
+	    break;
+	}
     case ALIGN_MARQUEE:
 	pad = width - T->scroll;
 	T->scroll++;
 	if (T->scroll >= width + len)
 	    T->scroll = 0;
 	break;
+    case ALIGN_PINGPONG:
+#define PINGPONGWAIT 2
+
+	/* scrolling is not necessary - center the string */
+	if (len <= width) {
+	    pad = (width - len) / 2;
+	} else {
+	    if (T->direction == 1)
+		T->scroll++;	/* scroll right */
+	    else
+		T->scroll--;	/* scroll left */
+
+	    /*pad = if positive, add leading space characters, else offset of string begin */
+	    pad = 0 - T->scroll;
+
+	    if (pad < 0 - (len - width)) {
+		if (T->delay-- < 1) {	/* wait before switch direction */
+		    T->direction = 0;	/* change scroll direction */
+		    T->delay = PINGPONGWAIT;
+		    T->scroll -= PINGPONGWAIT;
+		}		/* else debug("wait1"); */
+		pad = 0 - (len - width);
+	    } else if (pad > 0) {
+		if (T->delay-- < 1) {
+		    T->direction = 1;
+		    T->delay = PINGPONGWAIT;
+		    T->scroll += PINGPONGWAIT;
+		}		/* else debug("wait2"); */
+		pad = 0;
+	    }
+
+	}
+	break;
     default:			/* not reached  */
 	pad = 0;
     }
@@ -191,7 +137,7 @@
     dst = T->buffer;
 
     /* process prefix */
-    src = T->preval;
+    src = prefix;
     while (num < T->width) {
 	if (*src == '\0')
 	    break;
@@ -199,7 +145,7 @@
 	num++;
     }
 
-    src = T->value;
+    src = string;
 
     /* pad blanks on the beginning */
     while (pad > 0 && num < T->width) {
@@ -223,7 +169,7 @@
     }
 
     /* pad blanks on the end */
-    src = T->postval;
+    src = postfix;
     len = strlen(src);
     while (num < T->width - len) {
 	*(dst++) = ' ';
@@ -251,37 +197,23 @@
 {
     WIDGET *W = (WIDGET *) Self;
     WIDGET_TEXT *T = W->data;
-    RESULT result = { 0, 0, 0, NULL };
-    char *preval, *postval, *value;
-    int update;
-
-    /* evaluate prefix */
-    if (T->pretree != NULL) {
-	Eval(T->pretree, &result);
-	preval = strdup(R2S(&result));
-	DelResult(&result);
-    } else {
-	preval = strdup("");
-    }
+    char *string;
+    int update = 0;
 
-    /* evaluate postfix */
-    if (T->posttree != NULL) {
-	Eval(T->posttree, &result);
-	postval = strdup(R2S(&result));
-	DelResult(&result);
-    } else {
-	postval = strdup("");
-    }
+    /* evaluate properties */
+    update += property_eval(&T->prefix);
+    update += property_eval(&T->postfix);
+    update += property_eval(&T->style);
 
-    /* evaluate expression */
-    Eval(T->tree, &result);
+    /* evaluate value */
+    property_eval(&T->value);
 
     /* string or number? */
-    if (T->precision == 0xC0DE) {
-	value = strdup(R2S(&result));
+    if (T->precision == 0xDEAD) {
+	string = strdup(P2S(&T->value));
     } else {
-	double number = R2N(&result);
-	int width = T->width - strlen(preval) - strlen(postval);
+	double number = P2N(&T->value);
+	int width = T->width - strlen(P2S(&T->prefix)) - strlen(P2S(&T->postfix));
 	int precision = T->precision;
 	/* print zero bytes so we can specify NULL as target  */
 	/* and get the length of the resulting string */
@@ -301,58 +233,38 @@
 	}
 	/* number still doesn't fit: display '*****'  */
 	if (size > width) {
-	    value = malloc(width + 1);
-	    memset(value, '*', width);
-	    *(value + width) = '\0';
+	    string = malloc(width + 1);
+	    memset(string, '*', width);
+	    *(string + width) = '\0';
 	} else {
-	    value = malloc(size + 1);
-	    snprintf(value, size + 1, "%.*f", precision, number);
+	    string = malloc(size + 1);
+	    snprintf(string, size + 1, "%.*f", precision, number);
 	}
     }
 
-    DelResult(&result);
-
-    update = 0;
-
-    /* prefix changed? */
-    if (T->preval == NULL || strcmp(T->preval, preval) != 0) {
-	update = 1;
-	if (T->preval)
-	    free(T->preval);
-	T->preval = preval;
-	T->scroll = 0;		/* reset marquee counter */
+    /* did the formatted string change? */
+    if (T->string == NULL || strcmp(T->string, string) != 0) {
+	update++;
+	free(T->string);
+	T->string = string;
     } else {
-	free(preval);
-    }
-
-    /* postfix changed? */
-    if (T->postval == NULL || strcmp(T->postval, postval) != 0) {
-	update = 1;
-	if (T->postval)
-	    free(T->postval);
-	T->postval = postval;
-	T->scroll = 0;		/* reset marquee counter */
-    } else {
-	free(postval);
-    }
-
-    /* value changed? */
-    if (T->value == NULL || strcmp(T->value, value) != 0) {
-	update = 1;
-	if (T->value)
-	    free(T->value);
-	T->value = value;
-	T->scroll = 0;		/* reset marquee counter */
-    } else {
-	free(value);
+	free(string);
     }
 
     /* something has changed and should be updated */
     if (update) {
+	/* reset marquee counter if content has changed */
+	T->scroll = 0;
+
+	/* Init pingpong scroller. start scrolling left (wrong way) to get a delay */
+	if (T->align == ALIGN_PINGPONG) {
+	    T->direction = 0;
+	    T->delay = PINGPONGWAIT;
+	}
 	/* if there's a marquee scroller active, it has its own */
 	/* update callback timer, so we do nothing here; otherwise */
 	/* we simply call this scroll callback directly */
-	if (T->align != ALIGN_MARQUEE) {
+	if (T->align != ALIGN_MARQUEE || T->align != ALIGN_AUTOMATIC || T->align != ALIGN_PINGPONG) {
 	    widget_text_scroll(Self);
 	}
     }
@@ -375,17 +287,16 @@
     Text = malloc(sizeof(WIDGET_TEXT));
     memset(Text, 0, sizeof(WIDGET_TEXT));
 
-    /* get raw pre- and postfix (we evaluate it ourselves) */
-    Text->prefix = cfg_get_raw(section, "prefix", NULL);
-    Text->postfix = cfg_get_raw(section, "postfix", NULL);
-
-    /* compile pre- and postfix */
-    Compile(Text->prefix, &Text->pretree);
-    Compile(Text->postfix, &Text->posttree);
-
-    /* get raw expression (we evaluate it ourselves) */
-    Text->expression = cfg_get_raw(section, "expression", "''");
-    Compile(Text->expression, &Text->tree);
+    /* load properties */
+    property_load(section, "prefix", NULL, &Text->prefix);
+    property_load(section, "expression", "", &Text->value);
+    property_load(section, "postfix", NULL, &Text->postfix);
+    property_load(section, "style", NULL, &Text->style);
+
+    /* sanity checks */
+    if (!property_valid(&Text->value)) {
+	error("Warning: widget %s has no expression", section);
+    }
 
     /* field width, default 10 */
     cfg_number(section, "width", 10, 0, -1, &(Text->width));
@@ -393,10 +304,10 @@
     /* precision: number of digits after the decimal point (default: none) */
     /* Note: this is the *maximum* precision on small values, */
     /* for larger values the precision may be reduced to fit into the field width. */
-    /* The default value 0xC0DE is used to distinguish between numbers and strings: */
+    /* The default value 0xDEAD is used to distinguish between numbers and strings: */
     /* if no precision is given, the result is always treated as a string. If a */
     /* precision is specified, the result is treated as a number. */
-    cfg_number(section, "precision", 0xC0DE, 0, 80, &(Text->precision));
+    cfg_number(section, "precision", 0xDEAD, 0, 80, &(Text->precision));
 
     /* field alignment: Left (default), Center, Right or Marquee */
     c = cfg_get(section, "align", "L");
@@ -413,6 +324,12 @@
     case 'M':
 	Text->align = ALIGN_MARQUEE;
 	break;
+    case 'A':
+	Text->align = ALIGN_AUTOMATIC;
+	break;
+    case 'P':
+	Text->align = ALIGN_PINGPONG;
+	break;
     default:
 	error("widget %s has unknown alignment '%s', using 'Left'", section, c);
 	Text->align = ALIGN_LEFT;
@@ -426,7 +343,7 @@
 	Text->update = 10;
 
     /* marquee scroller speed: interval (msec), default 500msec */
-    if (Text->align == ALIGN_MARQUEE) {
+    if (Text->align == ALIGN_MARQUEE || Text->align == ALIGN_AUTOMATIC || Text->align == ALIGN_PINGPONG) {
 	cfg_number(section, "speed", 500, 10, -1, &(Text->speed));
     }
 
@@ -440,7 +357,7 @@
     timer_add(widget_text_update, Self, Text->update, Text->update == 0);
 
     /* a marquee scroller has its own timer and callback */
-    if (Text->align == ALIGN_MARQUEE) {
+    if (Text->align == ALIGN_MARQUEE || Text->align == ALIGN_AUTOMATIC || Text->align == ALIGN_PINGPONG) {
 	timer_add(widget_text_scroll, Self, Text->speed, 0);
     }
 
@@ -454,17 +371,12 @@
     if (Self) {
 	Text = Self->data;
 	if (Self->data) {
-	    DelTree(Text->pretree);
-	    DelTree(Text->posttree);
-	    DelTree(Text->tree);
-	    if (Text->preval)
-		free(Text->preval);
-	    if (Text->postval)
-		free(Text->postval);
-	    if (Text->value)
-		free(Text->value);
-	    if (Text->buffer)
-		free(Text->buffer);
+	    property_free(&Text->prefix);
+	    property_free(&Text->value);
+	    property_free(&Text->postfix);
+	    property_free(&Text->style);
+	    free(Text->string);
+	    free(Text->buffer);
 	    free(Self->data);
 	    Self->data = NULL;
 	}
@@ -477,8 +389,9 @@
 
 
 WIDGET_CLASS Widget_Text = {
-  name:"text",
-  init:widget_text_init,
-  draw:NULL,
-  quit:widget_text_quit,
+    .name = "text",
+    .type = WIDGET_TYPE_RC,
+    .init = widget_text_init,
+    .draw = NULL,
+    .quit = widget_text_quit,
 };
diff -urN lcd4linux-0.10.0/widget_text.h lcd4linux-0.11.0-SVN/widget_text.h
--- lcd4linux-0.10.0/widget_text.h	2005-05-08 06:32:45.000000000 +0200
+++ lcd4linux-0.11.0-SVN/widget_text.h	2008-12-31 08:05:54.000000000 +0100
@@ -1,8 +1,9 @@
-/* $Id: widget_text.h,v 1.7 2005/05/08 04:32:45 reinelt Exp $
+/* $Id: widget_text.h 849 2008-01-28 17:03:27Z michux $
+ * $URL: https://ssl.bulix.org/svn/lcd4linux/trunk/widget_text.h $
  *
  * simple text widget handling
  *
- * Copyright (C) 2003, 2004 Michael Reinelt <reinelt@eunet.at>
+ * Copyright (C) 2003, 2004 Michael Reinelt <michael@reinelt.co.at>
  * Copyright (C) 2004 The LCD4Linux Team <lcd4linux-devel@users.sourceforge.net>
  *
  * This file is part of LCD4Linux.
@@ -21,66 +22,31 @@
  * along with this program; if not, write to the Free Software
  * Foundation, Inc., 675 Mass Ave, Cambridge, MA 02139, USA.
  *
- *
- * $Log: widget_text.h,v $
- * Revision 1.7  2005/05/08 04:32:45  reinelt
- * CodingStyle added and applied
- *
- * Revision 1.6  2005/01/18 06:30:24  reinelt
- * added (C) to all copyright statements
- *
- * Revision 1.5  2004/06/26 12:05:00  reinelt
- *
- * uh-oh... the last CVS log message messed up things a lot...
- *
- * Revision 1.4  2004/06/26 09:27:21  reinelt
- *
- * added '-W' to CFLAGS
- * changed all C++ comments to C ones
- * cleaned up a lot of signed/unsigned mistakes
- *
- * Revision 1.3  2004/03/06 20:31:16  reinelt
- * Complete rewrite of the evaluator to get rid of the code
- * from mark Morley (because of license issues).
- * The new Evaluator does a pre-compile of expressions, and
- * stores them in trees. Therefore it should be reasonable faster...
- *
- * Revision 1.2  2004/01/15 07:47:03  reinelt
- * debian/ postinst and watch added (did CVS forget about them?)
- * evaluator: conditional expressions (a?b:c) added
- * text widget nearly finished
- *
- * Revision 1.1  2004/01/15 04:29:45  reinelt
- * moved lcd4linux.conf.sample to *.old
- * lcd4linux.conf.sample with new layout
- * new plugins 'loadavg' and 'meminfo'
- * text widget have pre- and postfix
- *
  */
 
 
 #ifndef _WIDGET_TEXT_H_
 #define _WIDGET_TEXT_H_
 
-typedef enum { ALIGN_LEFT, ALIGN_CENTER, ALIGN_RIGHT, ALIGN_MARQUEE } ALIGN;
+#include "property.h"
+
+typedef enum { ALIGN_LEFT, ALIGN_CENTER, ALIGN_RIGHT, ALIGN_MARQUEE, ALIGN_AUTOMATIC, ALIGN_PINGPONG } TEXT_ALIGN;
 
 typedef struct WIDGET_TEXT {
-    char *prefix;		/* expression for label on the left side */
-    void *pretree;		/* pre-compiled expression for label on the left side */
-    char *preval;		/* value for label on the left side */
-    char *postfix;		/* expression for label on the right side */
-    void *posttree;		/* pre-compiled expression for label on the right side */
-    char *postval;		/* value for label on the right side */
-    char *expression;		/* expression that delivers the value */
-    void *tree;			/* pre-compiled expression that delivers the value */
-    char *value;		/* evaluated value from expression */
+    PROPERTY prefix;		/* label on the left side */
+    PROPERTY postfix;		/* label on the right side */
+    PROPERTY value;		/* value of text widget */
+    PROPERTY style;		/* text style (plain/bold/slant) */
+    char *string;		/* formatted value */
     char *buffer;		/* string with 'width+1' bytes allocated  */
     int width;			/* field width */
     int precision;		/* number of digits after the decimal point */
-    ALIGN align;		/* alignment: L, C, R, M(arquee) */
+    TEXT_ALIGN align;		/* alignment: L(eft), C(enter), R(ight), M(arquee), A(utomatic) */
     int update;			/* update interval */
     int scroll;			/* marquee starting point */
     int speed;			/* marquee scrolling speed */
+    int direction;		/* pingpong direction, 0=right, 1=left */
+    int delay;			/* pingpong scrolling, wait before switch direction */
 } WIDGET_TEXT;
 
 
diff -urN lcd4linux-0.10.0/widget_timer.c lcd4linux-0.11.0-SVN/widget_timer.c
--- lcd4linux-0.10.0/widget_timer.c	1970-01-01 01:00:00.000000000 +0100
+++ lcd4linux-0.11.0-SVN/widget_timer.c	2008-12-31 08:06:27.000000000 +0100
@@ -0,0 +1,145 @@
+/* $Id: widget_timer.c 840 2007-09-09 12:17:42Z michael $
+ * $URL: https://ssl.bulix.org/svn/lcd4linux/trunk/widget_timer.c $
+ *
+ * timer widget handling
+ *
+ * Copyright (C) 2006 Michael Reinelt <michael@reinelt.co.at>
+ * Copyright (C) 2006 The LCD4Linux Team <lcd4linux-devel@users.sourceforge.net>
+ *
+ * This program is free software; you can redistribute it and/or modify
+ * it under the terms of the GNU General Public License as published by
+ * the Free Software Foundation; either version 2, or (at your option)
+ * any later version.
+ *
+ * This program is distributed in the hope that it will be useful,
+ * but WITHOUT ANY WARRANTY; without even the implied warranty of
+ * MERCHANTABILITY or FITNESS FOR A PARTICULAR PURPOSE.  See the
+ * GNU General Public License for more details.
+ *
+ * You should have received a copy of the GNU General Public License
+ * along with this program; if not, write to the Free Software
+ * Foundation, Inc., 675 Mass Ave, Cambridge, MA 02139, USA.
+ *
+ */
+
+/* 
+ * exported functions:
+ *
+ * WIDGET_CLASS Widget_Timer
+ *   the timer widget
+ *
+ */
+
+
+#include "config.h"
+
+#include <stdlib.h>
+#include <stdio.h>
+#include <string.h>
+#include <ctype.h>
+
+#include "debug.h"
+#include "cfg.h"
+#include "qprintf.h"
+#include "property.h"
+#include "timer.h"
+#include "widget.h"
+#include "widget_timer.h"
+
+#ifdef WITH_DMALLOC
+#include <dmalloc.h>
+#endif
+
+void widget_timer_update(void *Self)
+{
+    WIDGET *W = (WIDGET *) Self;
+    WIDGET_TIMER *Timer = W->data;
+    int update, active;
+
+    /* evaluate expressions */
+    property_eval(&Timer->update);
+    property_eval(&Timer->active);
+
+    /* get new update interval */
+    update = P2N(&Timer->update);
+    if (update < 10)
+	update = 10;
+
+    /* finally, fire it! */
+    active = P2N(&Timer->active);
+    if (active > 0) {
+	property_eval(&Timer->expression);
+    }
+
+    /* add a new one-shot timer */
+    timer_add(widget_timer_update, Self, update, 1);
+}
+
+
+
+int widget_timer_init(WIDGET * Self)
+{
+    char *section;
+    WIDGET_TIMER *Timer;
+
+    /* prepare config section */
+    /* strlen("Widget:")=7 */
+    section = malloc(strlen(Self->name) + 8);
+    strcpy(section, "Widget:");
+    strcat(section, Self->name);
+
+    Timer = malloc(sizeof(WIDGET_TIMER));
+    memset(Timer, 0, sizeof(WIDGET_TIMER));
+
+    /* load properties */
+    property_load(section, "expression", NULL, &Timer->expression);
+    property_load(section, "update", "100", &Timer->update);
+    property_load(section, "active", "1", &Timer->active);
+
+    free(section);
+    Self->data = Timer;
+
+    /* just do it! */
+    widget_timer_update(Self);
+
+    return 0;
+}
+
+
+int widget_timer_quit(WIDGET * Self)
+{
+    if (Self) {
+	/* do not deallocate child widget! */
+	if (Self->parent == NULL) {
+	    if (Self->data) {
+		WIDGET_TIMER *Timer = Self->data;
+		property_free(&Timer->expression);
+		property_free(&Timer->update);
+		property_free(&Timer->active);
+		free(Self->data);
+		Self->data = NULL;
+	    }
+	}
+    }
+
+    return 0;
+
+}
+
+
+int widget_timer_register(void)
+{
+    WIDGET_CLASS wc;
+    wc = Widget_Timer;
+    widget_register(&wc);
+    return 0;
+}
+
+
+WIDGET_CLASS Widget_Timer = {
+    .name = "timer",
+    .type = WIDGET_TYPE_TIMER,
+    .init = widget_timer_init,
+    .draw = NULL,
+    .quit = widget_timer_quit,
+};
diff -urN lcd4linux-0.10.0/widget_timer.h lcd4linux-0.11.0-SVN/widget_timer.h
--- lcd4linux-0.10.0/widget_timer.h	1970-01-01 01:00:00.000000000 +0100
+++ lcd4linux-0.11.0-SVN/widget_timer.h	2008-12-31 08:06:27.000000000 +0100
@@ -0,0 +1,43 @@
+/* $Id: widget_timer.h 840 2007-09-09 12:17:42Z michael $
+ * $URL: https://ssl.bulix.org/svn/lcd4linux/trunk/widget_timer.h $
+ *
+ * timer widget handling
+ *
+ * Copyright (C) 2006 Michael Reinelt <michael@reinelt.co.at>
+ * Copyright (C) 2006 The LCD4Linux Team <lcd4linux-devel@users.sourceforge.net>
+ *
+ * This file is part of LCD4Linux.
+ *
+ * LCD4Linux is free software; you can redistribute it and/or modify
+ * it under the terms of the GNU General Public License as published by
+ * the Free Software Foundation; either version 2, or (at your option)
+ * any later version.
+ *
+ * LCD4Linux is distributed in the hope that it will be useful,
+ * but WITHOUT ANY WARRANTY; without even the implied warranty of
+ * MERCHANTABILITY or FITNESS FOR A PARTICULAR PURPOSE.  See the
+ * GNU General Public License for more details.
+ *
+ * You should have received a copy of the GNU General Public License
+ * along with this program; if not, write to the Free Software
+ * Foundation, Inc., 675 Mass Ave, Cambridge, MA 02139, USA.
+ *
+ */
+
+
+#ifndef _WIDGET_TIMER_H_
+#define _WIDGET_TIMER_H_
+
+#include "property.h"
+
+typedef struct WIDGET_TIMER {
+    PROPERTY expression;	/* main timer expression */
+    PROPERTY update;		/* update interval (msec) */
+    PROPERTY active;		/* timer active? */
+} WIDGET_TIMER;
+
+extern WIDGET_CLASS Widget_Timer;
+
+int widget_timer_register(void);
+
+#endif
