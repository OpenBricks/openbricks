#!/bin/sh

. config/options

mkdir $INSTALL/bin
mkdir $INSTALL/etc
mkdir $INSTALL/etc/ndiswrapper
mkdir $INSTALL/sbin
mkdir $INSTALL/usr
mkdir $INSTALL/usr/bin
mkdir $INSTALL/usr/sbin
mkdir $INSTALL/usr/lib
mkdir $INSTALL/lib
mkdir $INSTALL/dev
mkdir $INSTALL/mnt
mkdir $INSTALL/tmp
mkdir $INSTALL/root
mkdir $INSTALL/var
mkdir $INSTALL/var/run
mkdir $INSTALL/var/log
mkdir $INSTALL/var/lock
mkdir $INSTALL/proc
mkdir $INSTALL/sys
mkdir -p $INSTALL/codecs
mkdir -p $INSTALL/firmware

if [ $TARGET_ARCH = x86_64 -o $TARGET_ARCH = powerpc64 ]; then
  ln -s /lib $INSTALL/lib64
  ln -s lib $INSTALL/usr/lib64
fi

echo -n "" > $INSTALL/etc/mtab
echo -n "" > $INSTALL/etc/fstab
echo -n "" > $INSTALL/var/mnts

# copy system and config files
cp $PACKAGES/$1/scripts/linuxrc $INSTALL
cp $PACKAGES/$1/scripts/console $INSTALL/sbin
cp $PACKAGES/$1/scripts/r[ow] $INSTALL/usr/bin

ln -s /firmware $INSTALL/lib
echo $TARGET_ARCH > $INSTALL/etc/arch

if [ -n "$TARGET_PLATFORM" ]; then
  echo "${DISTRO_VERSION}-${TARGET_PLATFORM}" > $INSTALL/etc/version
else
  echo "${DISTRO_VERSION}" > $INSTALL/etc/version
fi

cat > $INSTALL/etc/lsb-release <<EOF
DISTRIB_ID=$DISTRONAME
DISTRIB_RELEASE=$DISTRO_VERSION
EOF

cat > $INSTALL/etc/os-release <<EOF
NAME=$DISTRONAME
ID=$DISTRONAME_LC
PRETTY_NAME=$DISTRONAME $DISTRO_VERSION
ANSI_COLOR=1;33
EOF

echo "$DISTRONAME_LC" > $INSTALL/etc/hostname

cp $PACKAGES/$1/config/video $INSTALL/etc
